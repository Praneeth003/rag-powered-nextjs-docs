[
  {
    "id": "01-installation.mdx#0",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "---\ntitle: Installation\ndescription: Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n<AppOnly>\n\nCreate a new Next.js app and run it locally.\n\n## Quick start\n\n1. Create a new Next.js app named `my-app`\n2. `cd my-app` and start the dev server.\n3. Visit `http://localhost:3000`.\n\n```bash package=\"pnpm\"\npnpm create next-app@latest my-app --yes\ncd my-app\npnpm dev\n```\n\n```bash package=\"npm\"\nnpx create-next-app@latest my-app --yes\ncd my-app\nnpm run dev\n```\n\n```bash package=\"yarn\"\nyarn create next-app@latest my-app --yes\ncd my-app\nyarn dev\n```\n\n```bash package=\"bun\"\nbun create next-app@latest my-app --yes\ncd my-app\nbun dev\n```\n\n- `--yes` skips prompts using saved preferences or defaults. The default setup enables TypeScript, Tailwind, ESLint, App Router, and Turbopack, with import alias `@/*`.\n\n</AppOnly>"
  },
  {
    "id": "01-installation.mdx#1",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "## System requirements\n\nBefore you begin, make sure your development environment meets the following requirements:\n\n- Minimum Node.js version: [20.9](https://nodejs.org/)\n- Operating systems: macOS, Windows (including WSL), and Linux.\n\n## Supported browsers\n\nNext.js supports modern browsers with zero configuration.\n\n- Chrome 111+\n- Edge 111+\n- Firefox 111+\n- Safari 16.4+\n\nLearn more about [browser support](/docs/architecture/supported-browsers), including how to configure polyfills and target specific browsers."
  },
  {
    "id": "01-installation.mdx#2",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "## Create with the CLI\n\nThe quickest way to create a new Next.js app is using [`create-next-app`](/docs/app/api-reference/cli/create-next-app), which sets up everything automatically for you. To create a project, run:\n\n```bash filename=\"Terminal\"\nnpx create-next-app@latest\n```\n\nOn installation, you'll see the following prompts:\n\n```txt filename=\"Terminal\"\nWhat is your project named? my-app\nWould you like to use the recommended Next.js defaults?\n    Yes, use recommended defaults - TypeScript, ESLint, Tailwind CSS, App Router, Turbopack\n    No, reuse previous settings\n    No, customize settings - Choose your own preferences\n```\n\nIf you choose to `customize settings`, you'll see the following prompts:\n\n```txt filename=\"Terminal\"\nWould you like to use TypeScript? No / Yes\nWhich linter would you like to use? ESLint / Biome / None\nWould you like to use React Compiler? No / Yes\nWould you like to use Tailwind CSS? No / Yes\nWould you like your code inside a `src/` directory? No / Yes\nWould you like to use App Router? (recommended) No / Yes\nWould you like to customize the import alias (`@/*` by default)? No / Yes\nWhat import alias would you like configured? @/*"
  },
  {
    "id": "01-installation.mdx#3",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "```\n\nAfter the prompts, [`create-next-app`](/docs/app/api-reference/cli/create-next-app) will create a folder with your project name and install the required dependencies."
  },
  {
    "id": "01-installation.mdx#4",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "## Manual installation\n\nTo manually create a new Next.js app, install the required packages:\n\n```bash package=\"pnpm\"\npnpm i next@latest react@latest react-dom@latest\n```\n\n```bash package=\"npm\"\nnpm i next@latest react@latest react-dom@latest\n```\n\n```bash package=\"yarn\"\nyarn add next@latest react@latest react-dom@latest\n```\n\n```bash package=\"bun\"\nbun add next@latest react@latest react-dom@latest\n```\n\n> **Good to know**: The App Router uses [React canary releases](https://react.dev/blog/2023/05/03/react-canaries) built-in, which include all the stable React 19 changes, as well as newer features being validated in frameworks. The Pages Router uses the React version you install in `package.json`.\n\nThen, add the following scripts to your `package.json` file:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"eslint\",\n    \"lint:fix\": \"eslint --fix\"\n  }\n}"
  },
  {
    "id": "01-installation.mdx#5",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "```\n\nThese scripts refer to the different stages of developing an application:\n\n- `next dev`: Starts the development server using Turbopack (default bundler).\n- `next build`: Builds the application for production.\n- `next start`: Starts the production server.\n- `eslint`: Runs ESLint.\n\nTurbopack is now the default bundler. To use Webpack run `next dev --webpack` or `next build --webpack`. See the [Turbopack docs](/docs/app/api-reference/turbopack) for configuration details.\n\n<AppOnly>"
  },
  {
    "id": "01-installation.mdx#6",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "### Create the `app` directory\n\nNext.js uses file-system routing, which means the routes in your application are determined by how you structure your files.\n\nCreate an `app` folder. Then, inside `app`, create a `layout.tsx` file. This file is the [root layout](/docs/app/api-reference/file-conventions/layout#root-layout). It's required and must contain the `<html>` and `<body>` tags.\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\nCreate a home page `app/page.tsx` with some initial content:\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default function Page() {\n  return <h1>Hello, Next.js!</h1>\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nexport default function Page() {\n  return <h1>Hello, Next.js!</h1>\n}"
  },
  {
    "id": "01-installation.mdx#7",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nexport default function Page() {\n  return <h1>Hello, Next.js!</h1>\n}\n```\n\nBoth `layout.tsx` and `page.tsx` will be rendered when the user visits the root of your application (`/`).\n\n<Image\n  alt=\"App Folder Structure\"\n  srcLight=\"/docs/light/app-getting-started.png\"\n  srcDark=\"/docs/dark/app-getting-started.png\"\n  width=\"1600\"\n  height=\"363\"\n/>\n\n> **Good to know**:\n>\n> - If you forget to create the root layout, Next.js will automatically create this file when running the development server with `next dev`.\n> - You can optionally use a [`src` folder](/docs/app/api-reference/file-conventions/src-folder) in the root of your project to separate your application's code from configuration files.\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "01-installation.mdx#8",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "### Create the `pages` directory\n\nNext.js uses file-system routing, which means the routes in your application are determined by how you structure your files.\n\nCreate a `pages` directory at the root of your project. Then, add an `index.tsx` file inside your `pages` folder. This will be your home page (`/`):\n\n```tsx filename=\"pages/index.tsx\" switcher\nexport default function Page() {\n  return <h1>Hello, Next.js!</h1>\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nexport default function Page() {\n  return <h1>Hello, Next.js!</h1>\n}\n```\n\nNext, add an `_app.tsx` file inside `pages/` to define the global layout. Learn more about the [custom App file](/docs/pages/building-your-application/routing/custom-app).\n\n```tsx filename=\"pages/_app.tsx\" switcher\nimport type { AppProps } from 'next/app'\n\nexport default function App({ Component, pageProps }: AppProps) {\n  return <Component {...pageProps} />\n}\n```\n\n```jsx filename=\"pages/_app.js\" switcher\nexport default function App({ Component, pageProps }) {\n  return <Component {...pageProps} />\n}"
  },
  {
    "id": "01-installation.mdx#9",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "```\n\n```jsx filename=\"pages/_app.js\" switcher\nexport default function App({ Component, pageProps }) {\n  return <Component {...pageProps} />\n}\n```\n\nFinally, add a `_document.tsx` file inside `pages/` to control the initial response from the server. Learn more about the [custom Document file](/docs/pages/building-your-application/routing/custom-document).\n\n```tsx filename=\"pages/_document.tsx\" switcher\nimport { Html, Head, Main, NextScript } from 'next/document'\n\nexport default function Document() {\n  return (\n    <Html>\n      <Head />\n      <body>\n        <Main />\n        <NextScript />\n      </body>\n    </Html>\n  )\n}\n```\n\n```jsx filename=\"pages/_document.js\" switcher\nimport { Html, Head, Main, NextScript } from 'next/document'\n\nexport default function Document() {\n  return (\n    <Html>\n      <Head />\n      <body>\n        <Main />\n        <NextScript />\n      </body>\n    </Html>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "01-installation.mdx#10",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "### Create the `public` folder (optional)\n\nCreate a [`public` folder](/docs/app/api-reference/file-conventions/public-folder) at the root of your project to store static assets such as images, fonts, etc. Files inside `public` can then be referenced by your code starting from the base URL (`/`).\n\nYou can then reference these assets using the root path (`/`). For example, `public/profile.png` can be referenced as `/profile.png`:\n\n```tsx filename=\"app/page.tsx\" highlight={4} switcher\nimport Image from 'next/image'\n\nexport default function Page() {\n  return <Image src=\"/profile.png\" alt=\"Profile\" width={100} height={100} />\n}\n```\n\n```jsx filename=\"app/page.js\" highlight={4} switcher\nimport Image from 'next/image'\n\nexport default function Page() {\n  return <Image src=\"/profile.png\" alt=\"Profile\" width={100} height={100} />\n}\n```"
  },
  {
    "id": "01-installation.mdx#11",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "## Run the development server\n\n1. Run `npm run dev` to start the development server.\n2. Visit `http://localhost:3000` to view your application.\n3. Edit the <AppOnly>`app/page.tsx`</AppOnly><PagesOnly>`pages/index.tsx`</PagesOnly> file and save it to see the updated result in your browser."
  },
  {
    "id": "01-installation.mdx#12",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "## Set up TypeScript\n\n> Minimum TypeScript version: `v5.1.0`\n\nNext.js comes with built-in TypeScript support. To add TypeScript to your project, rename a file to `.ts` / `.tsx` and run `next dev`. Next.js will automatically install the necessary dependencies and add a `tsconfig.json` file with the recommended config options.\n\n<AppOnly>\n\n### IDE Plugin\n\nNext.js includes a custom TypeScript plugin and type checker, which VSCode and other code editors can use for advanced type-checking and auto-completion.\n\nYou can enable the plugin in VS Code by:\n\n1. Opening the command palette (`Ctrl/⌘` + `Shift` + `P`)\n2. Searching for \"TypeScript: Select TypeScript Version\"\n3. Selecting \"Use Workspace Version\"\n\n<Image\n  alt=\"TypeScript Command Palette\"\n  srcLight=\"/docs/light/typescript-command-palette.png\"\n  srcDark=\"/docs/dark/typescript-command-palette.png\"\n  width=\"1600\"\n  height=\"637\"\n/>\n\n</AppOnly>\n\nSee the [TypeScript reference](/docs/app/api-reference/config/next-config-js/typescript) page for more information."
  },
  {
    "id": "01-installation.mdx#13",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "## Set up linting\n\nNext.js supports linting with either ESLint or Biome. Choose a linter and run it directly via `package.json` scripts.\n\n- Use **ESLint** (comprehensive rules):\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"lint\": \"eslint\",\n    \"lint:fix\": \"eslint --fix\"\n  }\n}\n```\n\n- Or use **Biome** (fast linter + formatter):\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"lint\": \"biome check\",\n    \"format\": \"biome format --write\"\n  }\n}\n```\n\nIf your project previously used `next lint`, migrate your scripts to the ESLint CLI with the codemod:\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@canary next-lint-to-eslint-cli ."
  },
  {
    "id": "01-installation.mdx#14",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "```\n\nIf your project previously used `next lint`, migrate your scripts to the ESLint CLI with the codemod:\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@canary next-lint-to-eslint-cli .\n```\n\nIf you use ESLint, create an explicit config (recommended `eslint.config.mjs`). ESLint supports both [the legacy `.eslintrc.*` and the newer `eslint.config.mjs` formats](https://eslint.org/docs/latest/use/configure/configuration-files#configuring-eslint). See the [ESLint API reference](/docs/app/api-reference/config/eslint#with-core-web-vitals) for a recommended setup.\n\n> **Good to know**: Starting with Next.js 16, `next build` no longer runs the linter automatically. Instead, you can run your linter through NPM scripts.\n\nSee the [ESLint Plugin](/docs/app/api-reference/config/eslint) page for more information."
  },
  {
    "id": "01-installation.mdx#15",
    "metadata": {
      "title": "Installation",
      "description": "Learn how to create a new Next.js application with the `create-next-app` CLI, and set up TypeScript, ESLint, and Module Path Aliases."
    },
    "content": "## Set up Absolute Imports and Module Path Aliases\n\nNext.js has in-built support for the `\"paths\"` and `\"baseUrl\"` options of `tsconfig.json` and `jsconfig.json` files.\n\nThese options allow you to alias project directories to absolute paths, making it easier and cleaner to import modules. For example:\n\n```jsx\n// Before\nimport { Button } from '../../../components/button'\n\n// After\nimport { Button } from '@/components/button'\n```\n\nTo configure absolute imports, add the `baseUrl` configuration option to your `tsconfig.json` or `jsconfig.json` file. For example:\n\n```json filename=\"tsconfig.json or jsconfig.json\"\n{\n  \"compilerOptions\": {\n    \"baseUrl\": \"src/\"\n  }\n}\n```\n\nIn addition to configuring the `baseUrl` path, you can use the `\"paths\"` option to `\"alias\"` module paths.\n\nFor example, the following configuration maps `@/components/*` to `components/*`:\n\n```json filename=\"tsconfig.json or jsconfig.json\"\n{\n  \"compilerOptions\": {\n    \"baseUrl\": \"src/\",\n    \"paths\": {\n      \"@/styles/*\": [\"styles/*\"],\n      \"@/components/*\": [\"components/*\"]\n    }\n  }\n}\n```\n\nEach of the `\"paths\"` are relative to the `baseUrl` location."
  },
  {
    "id": "02-project-structure.mdx#0",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "---\ntitle: Project structure and organization\nnav_title: Project Structure\ndescription: Learn the folder and file conventions in Next.js, and how to organize your project.\n---\n\nThis page provides an overview of **all** the folder and file conventions in Next.js, and recommendations for organizing your project."
  },
  {
    "id": "02-project-structure.mdx#1",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "## Folder and file conventions\n\n### Top-level folders\n\nTop-level folders are used to organize your application's code and static assets.\n\n<Image\n  alt=\"Route segments to path segments\"\n  srcLight=\"/docs/light/top-level-folders.png\"\n  srcDark=\"/docs/dark/top-level-folders.png\"\n  width=\"1600\"\n  height=\"525\"\n/>\n\n|                                                                    |                                    |\n| ------------------------------------------------------------------ | ---------------------------------- |\n| [`app`](/docs/app)                                                 | App Router                         |\n| [`pages`](/docs/pages/building-your-application/routing)           | Pages Router                       |\n| [`public`](/docs/app/api-reference/file-conventions/public-folder) | Static assets to be served         |\n| [`src`](/docs/app/api-reference/file-conventions/src-folder)       | Optional application source folder |"
  },
  {
    "id": "02-project-structure.mdx#2",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Top-level files\n\nTop-level files are used to configure your application, manage dependencies, run proxy, integrate monitoring tools, and define environment variables."
  },
  {
    "id": "02-project-structure.mdx#3",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "|                                                                              |                                         |\n| ---------------------------------------------------------------------------- | --------------------------------------- |\n| **Next.js**                                                                  |                                         |\n| [`next.config.js`](/docs/app/api-reference/config/next-config-js)            | Configuration file for Next.js          |\n| [`package.json`](/docs/app/getting-started/installation#manual-installation) | Project dependencies and scripts        |\n| [`instrumentation.ts`](/docs/app/guides/instrumentation)                     | OpenTelemetry and Instrumentation file  |\n| [`proxy.ts`](/docs/app/api-reference/file-conventions/proxy)                 | Next.js request proxy                   |\n| [`.env`](/docs/app/guides/environment-variables)                             | Environment variables                   |\n| [`.env.local`](/docs/app/guides/environment-variables)                       | Local environment variables             |"
  },
  {
    "id": "02-project-structure.mdx#4",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "| [`.env.local`](/docs/app/guides/environment-variables)                       | Local environment variables             |\n| [`.env.production`](/docs/app/guides/environment-variables)                  | Production environment variables        |\n| [`.env.development`](/docs/app/guides/environment-variables)                 | Development environment variables       |\n| [`eslint.config.mjs`](/docs/app/api-reference/config/eslint)                 | Configuration file for ESLint           |\n| `.gitignore`                                                                 | Git files and folders to ignore         |\n| `next-env.d.ts`                                                              | TypeScript declaration file for Next.js |\n| `tsconfig.json`                                                              | Configuration file for TypeScript       |\n| `jsconfig.json`                                                              | Configuration file for JavaScript       |"
  },
  {
    "id": "02-project-structure.mdx#5",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "<AppOnly>"
  },
  {
    "id": "02-project-structure.mdx#6",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Routing Files\n\nAdd `page` to expose a route, `layout` for shared UI such as header, nav, or footer, `loading` for skeletons, `error` for error boundaries, and `route` for APIs."
  },
  {
    "id": "02-project-structure.mdx#7",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "|                                                                               |                     |                              |\n| ----------------------------------------------------------------------------- | ------------------- | ---------------------------- |\n| [`layout`](/docs/app/api-reference/file-conventions/layout)                   | `.js` `.jsx` `.tsx` | Layout                       |\n| [`page`](/docs/app/api-reference/file-conventions/page)                       | `.js` `.jsx` `.tsx` | Page                         |\n| [`loading`](/docs/app/api-reference/file-conventions/loading)                 | `.js` `.jsx` `.tsx` | Loading UI                   |\n| [`not-found`](/docs/app/api-reference/file-conventions/not-found)             | `.js` `.jsx` `.tsx` | Not found UI                 |\n| [`error`](/docs/app/api-reference/file-conventions/error)                     | `.js` `.jsx` `.tsx` | Error UI                     |\n| [`global-error`](/docs/app/api-reference/file-conventions/error#global-error) | `.js` `.jsx` `.tsx` | Global error UI              |"
  },
  {
    "id": "02-project-structure.mdx#8",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "| [`global-error`](/docs/app/api-reference/file-conventions/error#global-error) | `.js` `.jsx` `.tsx` | Global error UI              |\n| [`route`](/docs/app/api-reference/file-conventions/route)                     | `.js` `.ts`         | API endpoint                 |\n| [`template`](/docs/app/api-reference/file-conventions/template)               | `.js` `.jsx` `.tsx` | Re-rendered layout           |\n| [`default`](/docs/app/api-reference/file-conventions/default)                 | `.js` `.jsx` `.tsx` | Parallel route fallback page |"
  },
  {
    "id": "02-project-structure.mdx#9",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Nested routes\n\nFolders define URL segments. Nesting folders nests segments. Layouts at any level wrap their child segments. A route becomes public when a `page` or `route` file exists.\n\n| Path                        | URL pattern     | Notes                         |\n| --------------------------- | --------------- | ----------------------------- |\n| `app/layout.tsx`            | —               | Root layout wraps all routes  |\n| `app/blog/layout.tsx`       | —               | Wraps `/blog` and descendants |\n| `app/page.tsx`              | `/`             | Public route                  |\n| `app/blog/page.tsx`         | `/blog`         | Public route                  |\n| `app/blog/authors/page.tsx` | `/blog/authors` | Public route                  |"
  },
  {
    "id": "02-project-structure.mdx#10",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Dynamic routes\n\nParameterize segments with square brackets. Use `[segment]` for a single param, `[...segment]` for catch‑all, and `[[...segment]]` for optional catch‑all. Access values via the [`params`](/docs/app/api-reference/file-conventions/page#params-optional) prop.\n\n| Path                            | URL pattern                                                          |\n| ------------------------------- | -------------------------------------------------------------------- |\n| `app/blog/[slug]/page.tsx`      | `/blog/my-first-post`                                                |\n| `app/shop/[...slug]/page.tsx`   | `/shop/clothing`, `/shop/clothing/shirts`                            |\n| `app/docs/[[...slug]]/page.tsx` | `/docs`, `/docs/layouts-and-pages`, `/docs/api-reference/use-router` |"
  },
  {
    "id": "02-project-structure.mdx#11",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Route groups and private folders\n\nOrganize code without changing URLs with route groups [`(group)`](/docs/app/api-reference/file-conventions/route-groups#convention), and colocate non-routable files with private folders [`_folder`](#private-folders).\n\n| Path                            | URL pattern | Notes                                     |\n| ------------------------------- | ----------- | ----------------------------------------- |\n| `app/(marketing)/page.tsx`      | `/`         | Group omitted from URL                    |\n| `app/(shop)/cart/page.tsx`      | `/cart`     | Share layouts within `(shop)`             |\n| `app/blog/_components/Post.tsx` | —           | Not routable; safe place for UI utilities |\n| `app/blog/_lib/data.ts`         | —           | Not routable; safe place for utils        |"
  },
  {
    "id": "02-project-structure.mdx#12",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Parallel and Intercepted Routes\n\nThese features fit specific UI patterns, such as slot-based layouts or modal routing.\n\nUse `@slot` for named slots rendered by a parent layout. Use intercept patterns to render another route inside the current layout without changing the URL, for example, to show a details view as a modal over a list."
  },
  {
    "id": "02-project-structure.mdx#13",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "| Pattern (docs)                                                                              | Meaning              | Typical use case                         |\n| ------------------------------------------------------------------------------------------- | -------------------- | ---------------------------------------- |\n| [`@folder`](/docs/app/api-reference/file-conventions/parallel-routes#slots)                 | Named slot           | Sidebar + main content                   |\n| [`(.)folder`](/docs/app/api-reference/file-conventions/intercepting-routes#convention)      | Intercept same level | Preview sibling route in a modal         |\n| [`(..)folder`](/docs/app/api-reference/file-conventions/intercepting-routes#convention)     | Intercept parent     | Open a child of the parent as an overlay |\n| [`(..)(..)folder`](/docs/app/api-reference/file-conventions/intercepting-routes#convention) | Intercept two levels | Deeply nested overlay                    |\n| [`(...)folder`](/docs/app/api-reference/file-conventions/intercepting-routes#convention)    | Intercept from root  | Show arbitrary route in current view     |"
  },
  {
    "id": "02-project-structure.mdx#14",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Metadata file conventions"
  },
  {
    "id": "02-project-structure.mdx#15",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "#### App icons"
  },
  {
    "id": "02-project-structure.mdx#16",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "|                                                                                                                 |                                     |                          |\n| --------------------------------------------------------------------------------------------------------------- | ----------------------------------- | ------------------------ |\n| [`favicon`](/docs/app/api-reference/file-conventions/metadata/app-icons#favicon)                                | `.ico`                              | Favicon file             |\n| [`icon`](/docs/app/api-reference/file-conventions/metadata/app-icons#icon)                                      | `.ico` `.jpg` `.jpeg` `.png` `.svg` | App Icon file            |\n| [`icon`](/docs/app/api-reference/file-conventions/metadata/app-icons#generate-icons-using-code-js-ts-tsx)       | `.js` `.ts` `.tsx`                  | Generated App Icon       |\n| [`apple-icon`](/docs/app/api-reference/file-conventions/metadata/app-icons#apple-icon)                          | `.jpg` `.jpeg`, `.png`              | Apple App Icon file      |"
  },
  {
    "id": "02-project-structure.mdx#17",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "| [`apple-icon`](/docs/app/api-reference/file-conventions/metadata/app-icons#apple-icon)                          | `.jpg` `.jpeg`, `.png`              | Apple App Icon file      |\n| [`apple-icon`](/docs/app/api-reference/file-conventions/metadata/app-icons#generate-icons-using-code-js-ts-tsx) | `.js` `.ts` `.tsx`                  | Generated Apple App Icon |"
  },
  {
    "id": "02-project-structure.mdx#18",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "#### Open Graph and Twitter images\n\n|                                                                                                                             |                              |                            |\n| --------------------------------------------------------------------------------------------------------------------------- | ---------------------------- | -------------------------- |\n| [`opengraph-image`](/docs/app/api-reference/file-conventions/metadata/opengraph-image#opengraph-image)                      | `.jpg` `.jpeg` `.png` `.gif` | Open Graph image file      |\n| [`opengraph-image`](/docs/app/api-reference/file-conventions/metadata/opengraph-image#generate-images-using-code-js-ts-tsx) | `.js` `.ts` `.tsx`           | Generated Open Graph image |\n| [`twitter-image`](/docs/app/api-reference/file-conventions/metadata/opengraph-image#twitter-image)                          | `.jpg` `.jpeg` `.png` `.gif` | Twitter image file         |\n| [`twitter-image`](/docs/app/api-reference/file-conventions/metadata/opengraph-image#generate-images-using-code-js-ts-tsx)   | `.js` `.ts` `.tsx`           | Generated Twitter image    |"
  },
  {
    "id": "02-project-structure.mdx#19",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "#### SEO\n\n|                                                                                                              |             |                       |\n| ------------------------------------------------------------------------------------------------------------ | ----------- | --------------------- |\n| [`sitemap`](/docs/app/api-reference/file-conventions/metadata/sitemap#sitemap-files-xml)                     | `.xml`      | Sitemap file          |\n| [`sitemap`](/docs/app/api-reference/file-conventions/metadata/sitemap#generating-a-sitemap-using-code-js-ts) | `.js` `.ts` | Generated Sitemap     |\n| [`robots`](/docs/app/api-reference/file-conventions/metadata/robots#static-robotstxt)                        | `.txt`      | Robots file           |\n| [`robots`](/docs/app/api-reference/file-conventions/metadata/robots#generate-a-robots-file)                  | `.js` `.ts` | Generated Robots file |\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "02-project-structure.mdx#20",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### File conventions\n\n|                                                                                                             |                     |                   |\n| ----------------------------------------------------------------------------------------------------------- | ------------------- | ----------------- |\n| [`_app`](/docs/pages/building-your-application/routing/custom-app)                                          | `.js` `.jsx` `.tsx` | Custom App        |\n| [`_document`](/docs/pages/building-your-application/routing/custom-document)                                | `.js` `.jsx` `.tsx` | Custom Document   |\n| [`_error`](/docs/pages/building-your-application/routing/custom-error#more-advanced-error-page-customizing) | `.js` `.jsx` `.tsx` | Custom Error Page |\n| [`404`](/docs/pages/building-your-application/routing/custom-error#404-page)                                | `.js` `.jsx` `.tsx` | 404 Error Page    |\n| [`500`](/docs/pages/building-your-application/routing/custom-error#500-page)                                | `.js` `.jsx` `.tsx` | 500 Error Page    |"
  },
  {
    "id": "02-project-structure.mdx#21",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Routes\n\n|                                                                                                |                     |             |\n| ---------------------------------------------------------------------------------------------- | ------------------- | ----------- |\n| **Folder convention**                                                                          |                     |             |\n| [`index`](/docs/pages/building-your-application/routing/pages-and-layouts#index-routes)        | `.js` `.jsx` `.tsx` | Home page   |\n| [`folder/index`](/docs/pages/building-your-application/routing/pages-and-layouts#index-routes) | `.js` `.jsx` `.tsx` | Nested page |\n| **File convention**                                                                            |                     |             |\n| [`index`](/docs/pages/building-your-application/routing/pages-and-layouts#index-routes)        | `.js` `.jsx` `.tsx` | Home page   |\n| [`file`](/docs/pages/building-your-application/routing/pages-and-layouts)                      | `.js` `.jsx` `.tsx` | Nested page |"
  },
  {
    "id": "02-project-structure.mdx#22",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Dynamic routes"
  },
  {
    "id": "02-project-structure.mdx#23",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "|                                                                                                                   |                     |                                  |\n| ----------------------------------------------------------------------------------------------------------------- | ------------------- | -------------------------------- |\n| **Folder convention**                                                                                             |                     |                                  |\n| [`[folder]/index`](/docs/pages/building-your-application/routing/dynamic-routes)                                  | `.js` `.jsx` `.tsx` | Dynamic route segment            |\n| [`[...folder]/index`](/docs/pages/building-your-application/routing/dynamic-routes#catch-all-segments)            | `.js` `.jsx` `.tsx` | Catch-all route segment          |\n| [`[[...folder]]/index`](/docs/pages/building-your-application/routing/dynamic-routes#optional-catch-all-segments) | `.js` `.jsx` `.tsx` | Optional catch-all route segment |"
  },
  {
    "id": "02-project-structure.mdx#24",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "| [`[[...folder]]/index`](/docs/pages/building-your-application/routing/dynamic-routes#optional-catch-all-segments) | `.js` `.jsx` `.tsx` | Optional catch-all route segment |\n| **File convention**                                                                                               |                     |                                  |\n| [`[file]`](/docs/pages/building-your-application/routing/dynamic-routes)                                          | `.js` `.jsx` `.tsx` | Dynamic route segment            |\n| [`[...file]`](/docs/pages/building-your-application/routing/dynamic-routes#catch-all-segments)                    | `.js` `.jsx` `.tsx` | Catch-all route segment          |\n| [`[[...file]]`](/docs/pages/building-your-application/routing/dynamic-routes#optional-catch-all-segments)         | `.js` `.jsx` `.tsx` | Optional catch-all route segment |"
  },
  {
    "id": "02-project-structure.mdx#25",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "</PagesOnly>\n\n<AppOnly>"
  },
  {
    "id": "02-project-structure.mdx#26",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "## Organizing your project\n\nNext.js is **unopinionated** about how you organize and colocate your project files. But it does provide several features to help you organize your project.\n\n### Component hierarchy\n\nThe components defined in special files are rendered in a specific hierarchy:\n\n- `layout.js`\n- `template.js`\n- `error.js` (React error boundary)\n- `loading.js` (React suspense boundary)\n- `not-found.js` (React error boundary for \"not found\" UI)\n- `page.js` or nested `layout.js`\n\n<Image\n  alt=\"Component Hierarchy for File Conventions\"\n  srcLight=\"/docs/light/file-conventions-component-hierarchy.png\"\n  srcDark=\"/docs/dark/file-conventions-component-hierarchy.png\"\n  width=\"1600\"\n  height=\"643\"\n/>\n\nThe components are rendered recursively in nested routes, meaning the components of a route segment will be nested **inside** the components of its parent segment.\n\n<Image\n  alt=\"Nested File Conventions Component Hierarchy\"\n  srcLight=\"/docs/light/nested-file-conventions-component-hierarchy.png\"\n  srcDark=\"/docs/dark/nested-file-conventions-component-hierarchy.png\"\n  width=\"1600\"\n  height=\"863\"\n/>"
  },
  {
    "id": "02-project-structure.mdx#27",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Colocation\n\nIn the `app` directory, nested folders define route structure. Each folder represents a route segment that is mapped to a corresponding segment in a URL path.\n\nHowever, even though route structure is defined through folders, a route is **not publicly accessible** until a `page.js` or `route.js` file is added to a route segment.\n\n<Image\n  alt=\"A diagram showing how a route is not publicly accessible until a page.js or route.js file is added to a route segment.\"\n  srcLight=\"/docs/light/project-organization-not-routable.png\"\n  srcDark=\"/docs/dark/project-organization-not-routable.png\"\n  width=\"1600\"\n  height=\"444\"\n/>\n\nAnd, even when a route is made publicly accessible, only the **content returned** by `page.js` or `route.js` is sent to the client.\n\n<Image\n  alt=\"A diagram showing how page.js and route.js files make routes publicly accessible.\"\n  srcLight=\"/docs/light/project-organization-routable.png\"\n  srcDark=\"/docs/dark/project-organization-routable.png\"\n  width=\"1600\"\n  height=\"687\"\n/>\n\nThis means that **project files** can be **safely colocated** inside route segments in the `app` directory without accidentally being routable."
  },
  {
    "id": "02-project-structure.mdx#28",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "This means that **project files** can be **safely colocated** inside route segments in the `app` directory without accidentally being routable.\n\n<Image\n  alt=\"A diagram showing colocated project files are not routable even when a segment contains a page.js or route.js file.\"\n  srcLight=\"/docs/light/project-organization-colocation.png\"\n  srcDark=\"/docs/dark/project-organization-colocation.png\"\n  width=\"1600\"\n  height=\"1011\"\n/>\n\n> **Good to know**: While you **can** colocate your project files in `app` you don't **have** to. If you prefer, you can [keep them outside the `app` directory](#store-project-files-outside-of-app)."
  },
  {
    "id": "02-project-structure.mdx#29",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Private folders\n\nPrivate folders can be created by prefixing a folder with an underscore: `_folderName`\n\nThis indicates the folder is a private implementation detail and should not be considered by the routing system, thereby **opting the folder and all its subfolders** out of routing.\n\n<Image\n  alt=\"An example folder structure using private folders\"\n  srcLight=\"/docs/light/project-organization-private-folders.png\"\n  srcDark=\"/docs/dark/project-organization-private-folders.png\"\n  width=\"1600\"\n  height=\"849\"\n/>\n\nSince files in the `app` directory can be [safely colocated by default](#colocation), private folders are not required for colocation. However, they can be useful for:\n\n- Separating UI logic from routing logic.\n- Consistently organizing internal files across a project and the Next.js ecosystem.\n- Sorting and grouping files in code editors.\n- Avoiding potential naming conflicts with future Next.js file conventions."
  },
  {
    "id": "02-project-structure.mdx#30",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "> **Good to know**:\n>\n> - While not a framework convention, you might also consider marking files outside private folders as \"private\" using the same underscore pattern.\n> - You can create URL segments that start with an underscore by prefixing the folder name with `%5F` (the URL-encoded form of an underscore): `%5FfolderName`.\n> - If you don't use private folders, it would be helpful to know Next.js [special file conventions](/docs/app/getting-started/project-structure#routing-files) to prevent unexpected naming conflicts."
  },
  {
    "id": "02-project-structure.mdx#31",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Route groups\n\nRoute groups can be created by wrapping a folder in parenthesis: `(folderName)`\n\nThis indicates the folder is for organizational purposes and should **not be included** in the route's URL path.\n\n<Image\n  alt=\"An example folder structure using route groups\"\n  srcLight=\"/docs/light/project-organization-route-groups.png\"\n  srcDark=\"/docs/dark/project-organization-route-groups.png\"\n  width=\"1600\"\n  height=\"849\"\n/>\n\nRoute groups are useful for:\n\n- Organizing routes by site section, intent, or team. e.g. marketing pages, admin pages, etc.\n- Enabling nested layouts in the same route segment level:\n  - [Creating multiple nested layouts in the same segment, including multiple root layouts](#creating-multiple-root-layouts)\n  - [Adding a layout to a subset of routes in a common segment](#opting-specific-segments-into-a-layout)"
  },
  {
    "id": "02-project-structure.mdx#32",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### `src` folder\n\nNext.js supports storing application code (including `app`) inside an optional [`src` folder](/docs/app/api-reference/file-conventions/src-folder). This separates application code from project configuration files which mostly live in the root of a project.\n\n<Image\n  alt=\"An example folder structure with the `src` folder\"\n  srcLight=\"/docs/light/project-organization-src-directory.png\"\n  srcDark=\"/docs/dark/project-organization-src-directory.png\"\n  width=\"1600\"\n  height=\"687\"\n/>"
  },
  {
    "id": "02-project-structure.mdx#33",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "## Examples\n\nThe following section lists a very high-level overview of common strategies. The simplest takeaway is to choose a strategy that works for you and your team and be consistent across the project.\n\n> **Good to know**: In our examples below, we're using `components` and `lib` folders as generalized placeholders, their naming has no special framework significance and your projects might use other folders like `ui`, `utils`, `hooks`, `styles`, etc.\n\n### Store project files outside of `app`\n\nThis strategy stores all application code in shared folders in the **root of your project** and keeps the `app` directory purely for routing purposes.\n\n<Image\n  alt=\"An example folder structure with project files outside of app\"\n  srcLight=\"/docs/light/project-organization-project-root.png\"\n  srcDark=\"/docs/dark/project-organization-project-root.png\"\n  width=\"1600\"\n  height=\"849\"\n/>"
  },
  {
    "id": "02-project-structure.mdx#34",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Store project files in top-level folders inside of `app`\n\nThis strategy stores all application code in shared folders in the **root of the `app` directory**.\n\n<Image\n  alt=\"An example folder structure with project files inside app\"\n  srcLight=\"/docs/light/project-organization-app-root.png\"\n  srcDark=\"/docs/dark/project-organization-app-root.png\"\n  width=\"1600\"\n  height=\"849\"\n/>\n\n### Split project files by feature or route\n\nThis strategy stores globally shared application code in the root `app` directory and **splits** more specific application code into the route segments that use them.\n\n<Image\n  alt=\"An example folder structure with project files split by feature or route\"\n  srcLight=\"/docs/light/project-organization-app-root-split.png\"\n  srcDark=\"/docs/dark/project-organization-app-root-split.png\"\n  width=\"1600\"\n  height=\"1011\"\n/>"
  },
  {
    "id": "02-project-structure.mdx#35",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Organize routes without affecting the URL path\n\nTo organize routes without affecting the URL, create a group to keep related routes together. The folders in parenthesis will be omitted from the URL (e.g. `(marketing)` or `(shop)`).\n\n<Image\n  alt=\"Organizing Routes with Route Groups\"\n  srcLight=\"/docs/light/route-group-organisation.png\"\n  srcDark=\"/docs/dark/route-group-organisation.png\"\n  width=\"1600\"\n  height=\"930\"\n/>\n\nEven though routes inside `(marketing)` and `(shop)` share the same URL hierarchy, you can create a different layout for each group by adding a `layout.js` file inside their folders.\n\n<Image\n  alt=\"Route Groups with Multiple Layouts\"\n  srcLight=\"/docs/light/route-group-multiple-layouts.png\"\n  srcDark=\"/docs/dark/route-group-multiple-layouts.png\"\n  width=\"1600\"\n  height=\"768\"\n/>"
  },
  {
    "id": "02-project-structure.mdx#36",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Opting specific segments into a layout\n\nTo opt specific routes into a layout, create a new route group (e.g. `(shop)`) and move the routes that share the same layout into the group (e.g. `account` and `cart`). The routes outside of the group will not share the layout (e.g. `checkout`).\n\n<Image\n  alt=\"Route Groups with Opt-in Layouts\"\n  srcLight=\"/docs/light/route-group-opt-in-layouts.png\"\n  srcDark=\"/docs/dark/route-group-opt-in-layouts.png\"\n  width=\"1600\"\n  height=\"930\"\n/>\n\n### Opting for loading skeletons on a specific route\n\nTo apply a [loading skeleton](/docs/app/api-reference/file-conventions/loading) via a `loading.js` file to a specific route, create a new route group (e.g., `/(overview)`) and then move your `loading.tsx` inside that route group.\n\n<Image\n  alt=\"Folder structure showing a loading.tsx and a page.tsx inside the route group\"\n  srcLight=\"/docs/light/route-group-loading.png\"\n  srcDark=\"/docs/dark/route-group-loading.png\"\n  width=\"1600\"\n  height=\"444\"\n/>\n\nNow, the `loading.tsx` file will only apply to your dashboard → overview page instead of all your dashboard pages without affecting the URL path structure."
  },
  {
    "id": "02-project-structure.mdx#37",
    "metadata": {
      "title": "Project structure and organization",
      "description": "Learn the folder and file conventions in Next.js, and how to organize your project."
    },
    "content": "### Creating multiple root layouts\n\nTo create multiple [root layouts](/docs/app/api-reference/file-conventions/layout#root-layout), remove the top-level `layout.js` file, and add a `layout.js` file inside each route group. This is useful for partitioning an application into sections that have a completely different UI or experience. The `<html>` and `<body>` tags need to be added to each root layout.\n\n<Image\n  alt=\"Route Groups with Multiple Root Layouts\"\n  srcLight=\"/docs/light/route-group-multiple-root-layouts.png\"\n  srcDark=\"/docs/dark/route-group-multiple-root-layouts.png\"\n  width=\"1600\"\n  height=\"687\"\n/>\n\nIn the example above, both `(marketing)` and `(shop)` have their own root layout.\n\n</AppOnly>"
  },
  {
    "id": "03-layouts-and-pages.mdx#0",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "---\ntitle: Layouts and Pages\ndescription: Learn how to create your first pages and layouts, and link between them with the Link component.\nrelated:\n  title: API Reference\n  description: Learn more about the features mentioned in this page by reading the API Reference.\n  links:\n    - app/getting-started/linking-and-navigating\n    - app/api-reference/file-conventions/layout\n    - app/api-reference/file-conventions/page\n    - app/api-reference/components/link\n    - app/api-reference/file-conventions/dynamic-routes\n---\n\nNext.js uses **file-system based routing**, meaning you can use folders and files to define routes. This page will guide you through how to create layouts and pages, and link between them."
  },
  {
    "id": "03-layouts-and-pages.mdx#1",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "## Creating a page\n\nA **page** is UI that is rendered on a specific route. To create a page, add a [`page` file](/docs/app/api-reference/file-conventions/page) inside the `app` directory and default export a React component. For example, to create an index page (`/`):\n\n<Image\n  alt=\"page.js special file\"\n  srcLight=\"/docs/light/page-special-file.png\"\n  srcDark=\"/docs/dark/page-special-file.png\"\n  width=\"1600\"\n  height=\"282\"\n/>\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default function Page() {\n  return <h1>Hello Next.js!</h1>\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nexport default function Page() {\n  return <h1>Hello Next.js!</h1>\n}\n```"
  },
  {
    "id": "03-layouts-and-pages.mdx#2",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "## Creating a layout\n\nA layout is UI that is **shared** between multiple pages. On navigation, layouts preserve state, remain interactive, and do not rerender.\n\nYou can define a layout by default exporting a React component from a [`layout` file](/docs/app/api-reference/file-conventions/layout). The component should accept a `children` prop which can be a page or another [layout](#nesting-layouts).\n\nFor example, to create a layout that accepts your index page as child, add a `layout` file inside the `app` directory:\n\n<Image\n  alt=\"layout.js special file\"\n  srcLight=\"/docs/light/layout-special-file.png\"\n  srcDark=\"/docs/dark/layout-special-file.png\"\n  width=\"1600\"\n  height=\"363\"\n/>\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function DashboardLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>\n        {/* Layout UI */}\n        {/* Place children where you want to render a page or nested layout */}\n        <main>{children}</main>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "03-layouts-and-pages.mdx#3",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function DashboardLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        {/* Layout UI */}\n        {/* Place children where you want to render a page or nested layout */}\n        <main>{children}</main>\n      </body>\n    </html>\n  )\n}\n```\n\nThe layout above is called a [root layout](/docs/app/api-reference/file-conventions/layout#root-layout) because it's defined at the root of the `app` directory. The root layout is **required** and must contain `html` and `body` tags."
  },
  {
    "id": "03-layouts-and-pages.mdx#4",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "## Creating a nested route\n\nA nested route is a route composed of multiple URL segments. For example, the `/blog/[slug]` route is composed of three segments:\n\n- `/` (Root Segment)\n- `blog` (Segment)\n- `[slug]` (Leaf Segment)\n\nIn Next.js:\n\n- **Folders** are used to define the route segments that map to URL segments.\n- **Files** (like `page` and `layout`) are used to create UI that is shown for a segment.\n\nTo create nested routes, you can nest folders inside each other. For example, to add a route for `/blog`, create a folder called `blog` in the `app` directory. Then, to make `/blog` publicly accessible, add a `page.tsx` file:\n\n<Image\n  alt=\"File hierarchy showing blog folder and a page.js file\"\n  srcLight=\"/docs/light/blog-nested-route.png\"\n  srcDark=\"/docs/dark/blog-nested-route.png\"\n  width=\"1600\"\n  height=\"525\"\n/>\n\n```tsx filename=\"app/blog/page.tsx\" switcher\n// Dummy imports\nimport { getPosts } from '@/lib/posts'\nimport { Post } from '@/ui/post'\n\nexport default async function Page() {\n  const posts = await getPosts()\n\n  return (\n    <ul>\n      {posts.map((post) => (\n        <Post key={post.id} post={post} />\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "03-layouts-and-pages.mdx#5",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\n// Dummy imports\nimport { getPosts } from '@/lib/posts'\nimport { Post } from '@/ui/post'\n\nexport default async function Page() {\n  const posts = await getPosts()\n\n  return (\n    <ul>\n      {posts.map((post) => (\n        <Post key={post.id} post={post} />\n      ))}\n    </ul>\n  )\n}\n```\n\nYou can continue nesting folders to create nested routes. For example, to create a route for a specific blog post, create a new `[slug]` folder inside `blog` and add a `page` file:\n\n<Image\n  alt=\"File hierarchy showing blog folder with a nested slug folder and a page.js file\"\n  srcLight=\"/docs/light/blog-post-nested-route.png\"\n  srcDark=\"/docs/dark/blog-post-nested-route.png\"\n  width=\"1600\"\n  height=\"687\"\n/>\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nfunction generateStaticParams() {}\n\nexport default function Page() {\n  return <h1>Hello, Blog Post Page!</h1>\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nfunction generateStaticParams() {}\n\nexport default function Page() {\n  return <h1>Hello, Blog Post Page!</h1>\n}"
  },
  {
    "id": "03-layouts-and-pages.mdx#6",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nfunction generateStaticParams() {}\n\nexport default function Page() {\n  return <h1>Hello, Blog Post Page!</h1>\n}\n```\n\nWrapping a folder name in square brackets (e.g. `[slug]`) creates a [dynamic route segment](/docs/app/api-reference/file-conventions/dynamic-routes) which is used to generate multiple pages from data. e.g. blog posts, product pages, etc."
  },
  {
    "id": "03-layouts-and-pages.mdx#7",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "## Nesting layouts\n\nBy default, layouts in the folder hierarchy are also nested, which means they wrap child layouts via their `children` prop. You can nest layouts by adding `layout` inside specific route segments (folders).\n\nFor example, to create a layout for the `/blog` route, add a new `layout` file inside the `blog` folder.\n\n<Image\n  alt=\"File hierarchy showing root layout wrapping the blog layout\"\n  srcLight=\"/docs/light/nested-layouts.png\"\n  srcDark=\"/docs/dark/nested-layouts.png\"\n  width=\"1600\"\n  height=\"768\"\n/>\n\n```tsx filename=\"app/blog/layout.tsx\" switcher\nexport default function BlogLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return <section>{children}</section>\n}\n```\n\n```jsx filename=\"app/blog/layout.js\" switcher\nexport default function BlogLayout({ children }) {\n  return <section>{children}</section>\n}\n```\n\nIf you were to combine the two layouts above, the root layout (`app/layout.js`) would wrap the blog layout (`app/blog/layout.js`), which would wrap the blog (`app/blog/page.js`) and blog post page (`app/blog/[slug]/page.js`)."
  },
  {
    "id": "03-layouts-and-pages.mdx#8",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "## Creating a dynamic segment\n\n[Dynamic segments](/docs/app/api-reference/file-conventions/dynamic-routes) allow you to create routes that are generated from data. For example, instead of manually creating a route for each individual blog post, you can create a dynamic segment to generate the routes based on blog post data.\n\nTo create a dynamic segment, wrap the segment (folder) name in square brackets: `[segmentName]`. For example, in the `app/blog/[slug]/page.tsx` route, the `[slug]` is the dynamic segment.\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nexport default async function BlogPostPage({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = await params\n  const post = await getPost(slug)\n\n  return (\n    <div>\n      <h1>{post.title}</h1>\n      <p>{post.content}</p>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nexport default async function BlogPostPage({ params }) {\n  const { slug } = await params\n  const post = await getPost(slug)\n\n  return (\n    <div>\n      <h1>{post.title}</h1>\n      <p>{post.content}</p>\n    </div>\n  )\n}"
  },
  {
    "id": "03-layouts-and-pages.mdx#9",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "```\n\nLearn more about [Dynamic Segments](/docs/app/api-reference/file-conventions/dynamic-routes) and the [`params`](/docs/app/api-reference/file-conventions/page#params-optional) props.\n\nNested [layouts within Dynamic Segments](/docs/app/api-reference/file-conventions/layout#params-optional), can also access the `params` props."
  },
  {
    "id": "03-layouts-and-pages.mdx#10",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "## Rendering with search params\n\nIn a Server Component **page**, you can access search parameters using the [`searchParams`](/docs/app/api-reference/file-conventions/page#searchparams-optional) prop:\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default async function Page({\n  searchParams,\n}: {\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}) {\n  const filters = (await searchParams).filters\n}\n```\n\n```jsx filename=\"app/page.jsx\" switcher\nexport default async function Page({ searchParams }) {\n  const filters = (await searchParams).filters\n}\n```\n\nUsing `searchParams` opts your page into [**dynamic rendering**](/docs/app/guides/caching#dynamic-rendering) because it requires an incoming request to read the search parameters from.\n\nClient Components can read search params using the [`useSearchParams`](/docs/app/api-reference/functions/use-search-params) hook.\n\nLearn more about `useSearchParams` in [statically rendered](/docs/app/api-reference/functions/use-search-params#static-rendering) and [dynamically rendered](/docs/app/api-reference/functions/use-search-params#dynamic-rendering) routes."
  },
  {
    "id": "03-layouts-and-pages.mdx#11",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "### What to use and when\n\n- Use the `searchParams` prop when you need search parameters to **load data for the page** (e.g. pagination, filtering from a database).\n- Use `useSearchParams` when search parameters are used **only on the client** (e.g. filtering a list already loaded via props).\n- As a small optimization, you can use `new URLSearchParams(window.location.search)` in **callbacks or event handlers** to read search params without triggering re-renders."
  },
  {
    "id": "03-layouts-and-pages.mdx#12",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "## Linking between pages\n\nYou can use the [`<Link>` component](/docs/app/api-reference/components/link) to navigate between routes. `<Link>` is a built-in Next.js component that extends the HTML `<a>` tag to provide [prefetching](/docs/app/getting-started/linking-and-navigating#prefetching) and [client-side navigation](/docs/app/getting-started/linking-and-navigating#client-side-transitions).\n\nFor example, to generate a list of blog posts, import `<Link>` from `next/link` and pass a `href` prop to the component:\n\n```tsx filename=\"app/ui/post.tsx\" highlight={1,10} switcher\nimport Link from 'next/link'\n\nexport default async function Post({ post }) {\n  const posts = await getPosts()\n\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.slug}>\n          <Link href={`/blog/${post.slug}`}>{post.title}</Link>\n        </li>\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "03-layouts-and-pages.mdx#13",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "```\n\n```jsx filename=\"app/ui/post.js\" highlight={1,10}  switcher\nimport Link from 'next/link'\n\nexport default async function Post({ post }) {\n  const posts = await getPosts()\n\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.slug}>\n          <Link href={`/blog/${post.slug}`}>{post.title}</Link>\n        </li>\n      ))}\n    </ul>\n  )\n}\n```\n\n> **Good to know**: `<Link>` is the primary way to navigate between routes in Next.js. You can also use the [`useRouter` hook](/docs/app/api-reference/functions/use-router) for more advanced navigation."
  },
  {
    "id": "03-layouts-and-pages.mdx#14",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "## Route Props Helpers\n\nNext.js exposes utility types that infer `params` and named slots from your route structure:\n\n- [**PageProps**](/docs/app/api-reference/file-conventions/page#page-props-helper): Props for `page` components, including `params` and `searchParams`.\n- [**LayoutProps**](/docs/app/api-reference/file-conventions/layout#layout-props-helper): Props for `layout` components, including `children` and any named slots (e.g. folders like `@analytics`).\n\nThese are globally available helpers, generated when running either `next dev`, `next build` or [`next typegen`](/docs/app/api-reference/cli/next#next-typegen-options).\n\n```tsx filename=\"app/blog/[slug]/page.tsx\"\nexport default async function Page(props: PageProps<'/blog/[slug]'>) {\n  const { slug } = await props.params\n  return <h1>Blog post: {slug}</h1>\n}\n```\n\n```tsx filename=\"app/dashboard/layout.tsx\"\nexport default function Layout(props: LayoutProps<'/dashboard'>) {\n  return (\n    <section>\n      {props.children}\n      {/* If you have app/dashboard/@analytics, it appears as a typed slot: */}\n      {/* {props.analytics} */}\n    </section>\n  )\n}"
  },
  {
    "id": "03-layouts-and-pages.mdx#15",
    "metadata": {
      "title": "Layouts and Pages",
      "description": "Learn how to create your first pages and layouts, and link between them with the Link component."
    },
    "content": "```\n\n> **Good to know**\n>\n> - Static routes resolve `params` to `{}`.\n> - `PageProps`, `LayoutProps` are global helpers — no imports required.\n> - Types are generated during `next dev`, `next build` or `next typegen`."
  },
  {
    "id": "04-linking-and-navigating.mdx#0",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "---\ntitle: Linking and Navigating\ndescription: Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks.\nrelated:\n  links:\n    - app/api-reference/components/link\n    - app/api-reference/file-conventions/loading\n    - app/guides/prefetching\n---\n\nIn Next.js, routes are rendered on the server by default. This often means the client has to wait for a server response before a new route can be shown. Next.js comes with built-in [prefetching](#prefetching), [streaming](#streaming), and [client-side transitions](#client-side-transitions) ensuring navigation stays fast and responsive.\n\nThis guide explains how navigation works in Next.js and how you can optimize it for [dynamic routes](#dynamic-routes-without-loadingtsx) and [slow networks](#slow-networks)."
  },
  {
    "id": "04-linking-and-navigating.mdx#1",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "## How navigation works\n\nTo understand how navigation works in Next.js, it helps to be familiar with the following concepts:\n\n- [Server Rendering](#server-rendering)\n- [Prefetching](#prefetching)\n- [Streaming](#streaming)\n- [Client-side transitions](#client-side-transitions)"
  },
  {
    "id": "04-linking-and-navigating.mdx#2",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "### Server Rendering\n\nIn Next.js, [Layouts and Pages](/docs/app/getting-started/layouts-and-pages) are [React Server Components](https://react.dev/reference/rsc/server-components) by default. On initial and subsequent navigations, the [Server Component Payload](/docs/app/getting-started/server-and-client-components#how-do-server-and-client-components-work-in-nextjs) is generated on the server before being sent to the client.\n\nThere are two types of server rendering, based on _when_ it happens:\n\n- **Static Rendering (or Prerendering)** happens at build time or during [revalidation](/docs/app/getting-started/caching-and-revalidating) and the result is cached.\n- **Dynamic Rendering** happens at request time in response to a client request.\n\nThe trade-off of server rendering is that the client must wait for the server to respond before the new route can be shown. Next.js addresses this delay by [prefetching](#prefetching) routes the user is likely to visit and performing [client-side transitions](#client-side-transitions).\n\n> **Good to know**: HTML is also generated for the initial visit."
  },
  {
    "id": "04-linking-and-navigating.mdx#3",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "### Prefetching\n\nPrefetching is the process of loading a route in the background before the user navigates to it. This makes navigation between routes in your application feel instant, because by the time a user clicks on a link, the data to render the next route is already available client side.\n\nNext.js automatically prefetches routes linked with the [`<Link>` component](/docs/app/api-reference/components/link) when they enter the user's viewport.\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    <html>\n      <body>\n        <nav>\n          {/* Prefetched when the link is hovered or enters the viewport */}\n          <Link href=\"/blog\">Blog</Link>\n          {/* No prefetching */}\n          <a href=\"/contact\">Contact</a>\n        </nav>\n        {children}\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "04-linking-and-navigating.mdx#4",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nimport Link from 'next/link'\n\nexport default function Layout() {\n  return (\n    <html>\n      <body>\n        <nav>\n          {/* Prefetched when the link is hovered or enters the viewport */}\n          <Link href=\"/blog\">Blog</Link>\n          {/* No prefetching */}\n          <a href=\"/contact\">Contact</a>\n        </nav>\n        {children}\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "04-linking-and-navigating.mdx#5",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "```\n\nHow much of the route is prefetched depends on whether it's static or dynamic:\n\n- **Static Route**: the full route is prefetched.\n- **Dynamic Route**: prefetching is skipped, or the route is partially prefetched if [`loading.tsx`](/docs/app/api-reference/file-conventions/loading) is present.\n\nBy skipping or partially prefetching dynamic routes, Next.js avoids unnecessary work on the server for routes the users may never visit. However, waiting for a server response before navigation can give the users the impression that the app is not responding.\n\n<Image\n  alt=\"Server Rendering without Streaming\"\n  srcLight=\"/docs/light/server-rendering-without-streaming.png\"\n  srcDark=\"/docs/dark/server-rendering-without-streaming.png\"\n  width=\"1600\"\n  height=\"748\"\n/>\n\nTo improve the navigation experience to dynamic routes, you can use [streaming](#streaming)."
  },
  {
    "id": "04-linking-and-navigating.mdx#6",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "### Streaming\n\nStreaming allows the server to send parts of a dynamic route to the client as soon as they're ready, rather than waiting for the entire route to be rendered. This means users see something sooner, even if parts of the page are still loading.\n\nFor dynamic routes, it means they can be **partially prefetched**. That is, shared layouts and loading skeletons can be requested ahead of time.\n\n<Image\n  alt=\"How Server Rendering with Streaming Works\"\n  srcLight=\"/docs/light/server-rendering-with-streaming.png\"\n  srcDark=\"/docs/dark/server-rendering-with-streaming.png\"\n  width=\"1600\"\n  height=\"785\"\n/>\n\nTo use streaming, create a `loading.tsx` in your route folder:\n\n<Image\n  alt=\"loading.js special file\"\n  srcLight=\"/docs/light/loading-special-file.png\"\n  srcDark=\"/docs/dark/loading-special-file.png\"\n  width=\"1600\"\n  height=\"606\"\n/>\n\n```tsx filename=\"app/dashboard/loading.tsx\" switcher\nexport default function Loading() {\n  // Add fallback UI that will be shown while the route is loading.\n  return <LoadingSkeleton />\n}"
  },
  {
    "id": "04-linking-and-navigating.mdx#7",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/loading.js\" switcher\nexport default function Loading() {\n  // Add fallback UI that will be shown while the route is loading.\n  return <LoadingSkeleton />\n}\n```\n\nBehind the scenes, Next.js will automatically wrap the `page.tsx` contents in a `<Suspense>` boundary. The prefetched fallback UI will be shown while the route is loading, and swapped for the actual content once ready.\n\n> **Good to know**: You can also use [`<Suspense>`](https://react.dev/reference/react/Suspense) to create loading UI for nested components.\n\nBenefits of `loading.tsx`:\n\n- Immediate navigation and visual feedback for the user.\n- Shared layouts remain interactive and navigation is interruptible.\n- Improved Core Web Vitals: [TTFB](https://web.dev/articles/ttfb), [FCP](https://web.dev/articles/fcp), and [TTI](https://web.dev/articles/tti).\n\nTo further improve the navigation experience, Next.js performs a [client-side transition](#client-side-transitions) with the `<Link>` component."
  },
  {
    "id": "04-linking-and-navigating.mdx#8",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "### Client-side transitions\n\nTraditionally, navigation to a server-rendered page triggers a full page load. This clears state, resets scroll position, and blocks interactivity.\n\nNext.js avoids this with client-side transitions using the `<Link>` component. Instead of reloading the page, it updates the content dynamically by:\n\n- Keeping any shared layouts and UI.\n- Replacing the current page with the prefetched loading state or a new page if available.\n\nClient-side transitions are what makes a server-rendered apps _feel_ like client-rendered apps. And when paired with [prefetching](#prefetching) and [streaming](#streaming), it enables fast transitions, even for dynamic routes."
  },
  {
    "id": "04-linking-and-navigating.mdx#9",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "## What can make transitions slow?\n\nThese Next.js optimizations make navigation fast and responsive. However, under certain conditions, transitions can still _feel_ slow. Here are some common causes and how to improve the user experience:\n\n### Dynamic routes without `loading.tsx`\n\nWhen navigating to a dynamic route, the client must wait for the server response before showing the result. This can give the users the impression that the app is not responding.\n\nWe recommend adding `loading.tsx` to dynamic routes to enable partial prefetching, trigger immediate navigation, and display a loading UI while the route renders.\n\n```tsx filename=\"app/blog/[slug]/loading.tsx\" switcher\nexport default function Loading() {\n  return <LoadingSkeleton />\n}\n```\n\n```jsx filename=\"app/blog/[slug]/loading.js\" switcher\nexport default function Loading() {\n  return <LoadingSkeleton />\n}\n```\n\n> **Good to know**: In development mode, you can use the Next.js Devtools to identify if the route is static or dynamic. See [`devIndicators`](/docs/app/api-reference/config/next-config-js/devIndicators) for more information."
  },
  {
    "id": "04-linking-and-navigating.mdx#10",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "### Dynamic segments without `generateStaticParams`\n\nIf a [dynamic segment](/docs/app/api-reference/file-conventions/dynamic-routes) could be prerendered but isn't because it's missing [`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params), the route will fallback to dynamic rendering at request time.\n\nEnsure the route is statically generated at build time by adding `generateStaticParams`:\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  return posts.map((post) => ({\n    slug: post.slug,\n  }))\n}\n\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = await params\n  // ...\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  return posts.map((post) => ({\n    slug: post.slug,\n  }))\n\nexport default async function Page({ params }) {\n  const { slug } = await params\n  // ...\n}\n```"
  },
  {
    "id": "04-linking-and-navigating.mdx#11",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "### Slow networks\n\nOn slow or unstable networks, prefetching may not finish before the user clicks a link. This can affect both static and dynamic routes. In these cases, the `loading.js` fallback may not appear immediately because it hasn't been prefetched yet.\n\nTo improve perceived performance, you can use the [`useLinkStatus` hook](/docs/app/api-reference/functions/use-link-status) to show immediate feedback while the transition is in progress.\n\n```tsx filename=\"app/ui/loading-indicator.tsx\" switcher\n'use client'\n\nimport { useLinkStatus } from 'next/link'\n\nexport default function LoadingIndicator() {\n  const { pending } = useLinkStatus()\n  return (\n    <span aria-hidden className={`link-hint ${pending ? 'is-pending' : ''}`} />\n  )\n}\n```\n\n```jsx filename=\"app/ui/loading-indicator.js\" switcher\n'use client'\n\nimport { useLinkStatus } from 'next/link'\n\nexport default function LoadingIndicator() {\n  const { pending } = useLinkStatus()\n  return (\n    <span aria-hidden className={`link-hint ${pending ? 'is-pending' : ''}`} />\n  )\n}"
  },
  {
    "id": "04-linking-and-navigating.mdx#12",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "```\n\nYou can \"debounce\" the hint by adding an initial animation delay (e.g. 100ms) and starting as invisible (e.g. `opacity: 0`). This means the loading indicator will only be shown if the navigation takes longer than the specified delay. See the [`useLinkStatus` reference](/docs/app/api-reference/functions/use-link-status#gracefully-handling-fast-navigation) for a CSS example.\n\n> **Good to know**: You can use other visual feedback patterns like a progress bar. View an example [here](https://github.com/vercel/react-transition-progress)."
  },
  {
    "id": "04-linking-and-navigating.mdx#13",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "### Disabling prefetching\n\nYou can opt out of prefetching by setting the `prefetch` prop to `false` on the `<Link>` component. This is useful to avoid unnecessary usage of resources when rendering large lists of links (e.g. an infinite scroll table).\n\n```tsx\n<Link prefetch={false} href=\"/blog\">\n  Blog\n</Link>\n```\n\nHowever, disabling prefetching comes with trade-offs:\n\n- **Static routes** will only be fetched when the user clicks the link.\n- **Dynamic routes** will need to be rendered on the server first before the client can navigate to it.\n\nTo reduce resource usage without fully disabling prefetch, you can prefetch only on hover. This limits prefetching to routes the user is more _likely_ to visit, rather than all links in the viewport.\n\n```tsx filename=\"app/ui/hover-prefetch-link.tsx\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useState } from 'react'\n\nfunction HoverPrefetchLink({\n  href,\n  children,\n}: {\n  href: string\n  children: React.ReactNode\n}) {\n  const [active, setActive] = useState(false)\n\n  return (\n    <Link\n      href={href}\n      prefetch={active ? null : false}\n      onMouseEnter={() => setActive(true)}\n    >\n      {children}\n    </Link>\n  )\n}"
  },
  {
    "id": "04-linking-and-navigating.mdx#14",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "```\n\n```jsx filename=\"app/ui/hover-prefetch-link.js\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useState } from 'react'\n\nfunction HoverPrefetchLink({ href, children }) {\n  const [active, setActive] = useState(false)\n\n  return (\n    <Link\n      href={href}\n      prefetch={active ? null : false}\n      onMouseEnter={() => setActive(true)}\n    >\n      {children}\n    </Link>\n  )\n}\n```"
  },
  {
    "id": "04-linking-and-navigating.mdx#15",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "### Hydration not completed\n\n`<Link>` is a Client Component and must be hydrated before it can prefetch routes. On the initial visit, large JavaScript bundles can delay hydration, preventing prefetching from starting right away.\n\nReact mitigates this with Selective Hydration and you can further improve this by:\n\n- Using the [`@next/bundle-analyzer`](/docs/app/guides/package-bundling#analyzing-javascript-bundles) plugin to identify and reduce bundle size by removing large dependencies.\n- Moving logic from the client to the server where possible. See the [Server and Client Components](/docs/app/getting-started/server-and-client-components) docs for guidance."
  },
  {
    "id": "04-linking-and-navigating.mdx#16",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "## Examples"
  },
  {
    "id": "04-linking-and-navigating.mdx#17",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "### Native History API\n\nNext.js allows you to use the native [`window.history.pushState`](https://developer.mozilla.org/en-US/docs/Web/API/History/pushState) and [`window.history.replaceState`](https://developer.mozilla.org/en-US/docs/Web/API/History/replaceState) methods to update the browser's history stack without reloading the page.\n\n`pushState` and `replaceState` calls integrate into the Next.js Router, allowing you to sync with [`usePathname`](/docs/app/api-reference/functions/use-pathname) and [`useSearchParams`](/docs/app/api-reference/functions/use-search-params)."
  },
  {
    "id": "04-linking-and-navigating.mdx#18",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "#### `window.history.pushState`\n\nUse it to add a new entry to the browser's history stack. The user can navigate back to the previous state. For example, to sort a list of products:\n\n```tsx fileName=\"app/ui/sort-products.tsx\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function SortProducts() {\n  const searchParams = useSearchParams()\n\n  function updateSorting(sortOrder: string) {\n    const params = new URLSearchParams(searchParams.toString())\n    params.set('sort', sortOrder)\n    window.history.pushState(null, '', `?${params.toString()}`)\n  }\n\n  return (\n    <>\n      <button onClick={() => updateSorting('asc')}>Sort Ascending</button>\n      <button onClick={() => updateSorting('desc')}>Sort Descending</button>\n    </>\n  )\n}"
  },
  {
    "id": "04-linking-and-navigating.mdx#19",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "```\n\n```jsx fileName=\"app/ui/sort-products.js\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function SortProducts() {\n  const searchParams = useSearchParams()\n\n  function updateSorting(sortOrder) {\n    const params = new URLSearchParams(searchParams.toString())\n    params.set('sort', sortOrder)\n    window.history.pushState(null, '', `?${params.toString()}`)\n  }\n\n  return (\n    <>\n      <button onClick={() => updateSorting('asc')}>Sort Ascending</button>\n      <button onClick={() => updateSorting('desc')}>Sort Descending</button>\n    </>\n  )\n}\n```"
  },
  {
    "id": "04-linking-and-navigating.mdx#20",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "#### `window.history.replaceState`\n\nUse it to replace the current entry on the browser's history stack. The user is not able to navigate back to the previous state. For example, to switch the application's locale:\n\n```tsx fileName=\"app/ui/locale-switcher.tsx\" switcher\n'use client'\n\nimport { usePathname } from 'next/navigation'\n\nexport function LocaleSwitcher() {\n  const pathname = usePathname()\n\n  function switchLocale(locale: string) {\n    // e.g. '/en/about' or '/fr/contact'\n    const newPath = `/${locale}${pathname}`\n    window.history.replaceState(null, '', newPath)\n  }\n\n  return (\n    <>\n      <button onClick={() => switchLocale('en')}>English</button>\n      <button onClick={() => switchLocale('fr')}>French</button>\n    </>\n  )\n}"
  },
  {
    "id": "04-linking-and-navigating.mdx#21",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how the built-in navigation optimizations work, including prefetching, prerendering, and client-side navigation, and how to optimize navigation for dynamic routes and slow networks."
    },
    "content": "```\n\n```jsx fileName=\"app/ui/locale-switcher.js\" switcher\n'use client'\n\nimport { usePathname } from 'next/navigation'\n\nexport function LocaleSwitcher() {\n  const pathname = usePathname()\n\n  function switchLocale(locale) {\n    // e.g. '/en/about' or '/fr/contact'\n    const newPath = `/${locale}${pathname}`\n    window.history.replaceState(null, '', newPath)\n  }\n\n  return (\n    <>\n      <button onClick={() => switchLocale('en')}>English</button>\n      <button onClick={() => switchLocale('fr')}>French</button>\n    </>\n  )\n}\n```"
  },
  {
    "id": "05-server-and-client-components.mdx#0",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "---\ntitle: Server and Client Components\ndescription: Learn how you can use React Server and Client Components to render parts of your application on the server or the client.\nrelated:\n  title: Next Steps\n  description: Learn more about the APIs mentioned in this page.\n  links:\n    - app/api-reference/directives/use-client\n---\n\nBy default, layouts and pages are [Server Components](https://react.dev/reference/rsc/server-components), which lets you fetch data and render parts of your UI on the server, optionally cache the result, and stream it to the client. When you need interactivity or browser APIs, you can use [Client Components](https://react.dev/reference/rsc/use-client) to layer in functionality.\n\nThis page explains how Server and Client Components work in Next.js and when to use them, with examples of how to compose them together in your application."
  },
  {
    "id": "05-server-and-client-components.mdx#1",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "## When to use Server and Client Components?\n\nThe client and server environments have different capabilities. Server and Client components allow you to run logic in each environment depending on your use case.\n\nUse **Client Components** when you need:\n\n- [State](https://react.dev/learn/managing-state) and [event handlers](https://react.dev/learn/responding-to-events). E.g. `onClick`, `onChange`.\n- [Lifecycle logic](https://react.dev/learn/lifecycle-of-reactive-effects). E.g. `useEffect`.\n- Browser-only APIs. E.g. `localStorage`, `window`, `Navigator.geolocation`, etc.\n- [Custom hooks](https://react.dev/learn/reusing-logic-with-custom-hooks).\n\nUse **Server Components** when you need:\n\n- Fetch data from databases or APIs close to the source.\n- Use API keys, tokens, and other secrets without exposing them to the client.\n- Reduce the amount of JavaScript sent to the browser.\n- Improve the [First Contentful Paint (FCP)](https://web.dev/fcp/), and stream content progressively to the client.\n\nFor example, the `<Page>` component is a Server Component that fetches data about a post, and passes it as props to the `<LikeButton>` which handles client-side interactivity."
  },
  {
    "id": "05-server-and-client-components.mdx#2",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "For example, the `<Page>` component is a Server Component that fetches data about a post, and passes it as props to the `<LikeButton>` which handles client-side interactivity.\n\n```tsx filename=\"app/[id]/page.tsx\" highlight={1,12} switcher\nimport LikeButton from '@/app/ui/like-button'\nimport { getPost } from '@/lib/data'\n\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n  const post = await getPost(id)\n\n  return (\n    <div>\n      <main>\n        <h1>{post.title}</h1>\n        {/* ... */}\n        <LikeButton likes={post.likes} />\n      </main>\n    </div>\n  )\n}"
  },
  {
    "id": "05-server-and-client-components.mdx#3",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "```\n\n```jsx filename=\"app/[id]/page.js\" highlight={1,12} switcher\nimport LikeButton from '@/app/ui/like-button'\nimport { getPost } from '@/lib/data'\n\nexport default async function Page({ params }) {\n  const post = await getPost(params.id)\n\n  return (\n    <div>\n      <main>\n        <h1>{post.title}</h1>\n        {/* ... */}\n        <LikeButton likes={post.likes} />\n      </main>\n    </div>\n  )\n}\n```\n\n```tsx filename=\"app/ui/like-button.tsx\" highlight={1} switcher\n'use client'\n\nimport { useState } from 'react'\n\nexport default function LikeButton({ likes }: { likes: number }) {\n  // ...\n}\n```\n\n```jsx filename=\"app/ui/like-button.js\" highlight={1} switcher\n'use client'\n\nimport { useState } from 'react'\n\nexport default function LikeButton({ likes }) {\n  // ...\n}\n```"
  },
  {
    "id": "05-server-and-client-components.mdx#4",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "## How do Server and Client Components work in Next.js?\n\n### On the server\n\nOn the server, Next.js uses React's APIs to orchestrate rendering. The rendering work is split into chunks, by individual route segments ([layouts and pages](/docs/app/getting-started/layouts-and-pages)):\n\n- **Server Components** are rendered into a special data format called the React Server Component Payload (RSC Payload).\n- **Client Components** and the RSC Payload are used to [pre-render](/docs/app/guides/caching#rendering-strategies) HTML.\n\n> **What is the React Server Component Payload (RSC)?**\n>\n> The RSC Payload is a compact binary representation of the rendered React Server Components tree. It's used by React on the client to update the browser's DOM. The RSC Payload contains:\n>\n> - The rendered result of Server Components\n> - Placeholders for where Client Components should be rendered and references to their JavaScript files\n> - Any props passed from a Server Component to a Client Component"
  },
  {
    "id": "05-server-and-client-components.mdx#5",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "### On the client (first load)\n\nThen, on the client:\n\n1. **HTML** is used to immediately show a fast non-interactive preview of the route to the user.\n2. **RSC Payload** is used to reconcile the Client and Server Component trees.\n3. **JavaScript** is used to hydrate Client Components and make the application interactive.\n\n> **What is hydration?**\n>\n> Hydration is React's process for attaching [event handlers](https://react.dev/learn/responding-to-events) to the DOM, to make the static HTML interactive.\n\n### Subsequent Navigations\n\nOn subsequent navigations:\n\n- The **RSC Payload** is prefetched and cached for instant navigation.\n- **Client Components** are rendered entirely on the client, without the server-rendered HTML."
  },
  {
    "id": "05-server-and-client-components.mdx#6",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "## Examples\n\n### Using Client Components\n\nYou can create a Client Component by adding the [`\"use client\"`](https://react.dev/reference/react/use-client) directive at the top of the file, above your imports.\n\n```tsx filename=\"app/ui/counter.tsx\" highlight={1} switcher\n'use client'\n\nimport { useState } from 'react'\n\nexport default function Counter() {\n  const [count, setCount] = useState(0)\n\n  return (\n    <div>\n      <p>{count} likes</p>\n      <button onClick={() => setCount(count + 1)}>Click me</button>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/ui/counter.js\" highlight={1} switcher\n'use client'\n\nimport { useState } from 'react'\n\nexport default function Counter() {\n  const [count, setCount] = useState(0)\n\n  return (\n    <div>\n      <p>{count} likes</p>\n      <button onClick={() => setCount(count + 1)}>Click me</button>\n    </div>\n  )\n}\n```\n\n`\"use client\"` is used to declare a **boundary** between the Server and Client module graphs (trees).\n\nOnce a file is marked with `\"use client\"`, **all its imports and child components are considered part of the client bundle**. This means you don't need to add the directive to every component that is intended for the client."
  },
  {
    "id": "05-server-and-client-components.mdx#7",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "### Reducing JS bundle size\n\nTo reduce the size of your client JavaScript bundles, add `'use client'` to specific interactive components instead of marking large parts of your UI as Client Components.\n\nFor example, the `<Layout>` component contains mostly static elements like a logo and navigation links, but includes an interactive search bar. `<Search />` is interactive and needs to be a Client Component, however, the rest of the layout can remain a Server Component.\n\n```tsx filename=\"app/layout.tsx\" highlight={12} switcher\n// Client Component\nimport Search from './search'\n// Server Component\nimport Logo from './logo'\n\n// Layout is a Server Component by default\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    <>\n      <nav>\n        <Logo />\n        <Search />\n      </nav>\n      <main>{children}</main>\n    </>\n  )\n}"
  },
  {
    "id": "05-server-and-client-components.mdx#8",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" highlight={12} switcher\n// Client Component\nimport Search from './search'\n// Server Component\nimport Logo from './logo'\n\n// Layout is a Server Component by default\nexport default function Layout({ children }) {\n  return (\n    <>\n      <nav>\n        <Logo />\n        <Search />\n      </nav>\n      <main>{children}</main>\n    </>\n  )\n}\n```\n\n```tsx filename=\"app/ui/search.tsx\" highlight={1} switcher\n'use client'\n\nexport default function Search() {\n  // ...\n}\n```\n\n```jsx filename=\"app/ui/search.js\" highlight={1} switcher\n'use client'\n\nexport default function Search() {\n  // ...\n}\n```"
  },
  {
    "id": "05-server-and-client-components.mdx#9",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "### Passing data from Server to Client Components\n\nYou can pass data from Server Components to Client Components using props.\n\n```tsx filename=\"app/[id]/page.tsx\" highlight={1,7} switcher\nimport LikeButton from '@/app/ui/like-button'\nimport { getPost } from '@/lib/data'\n\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n  const post = await getPost(id)\n\n  return <LikeButton likes={post.likes} />\n}\n```\n\n```jsx filename=\"app/[id]/page.js\" highlight={1,7} switcher\nimport LikeButton from '@/app/ui/like-button'\nimport { getPost } from '@/lib/data'\n\nexport default async function Page({ params }) {\n  const post = await getPost(params.id)\n\n  return <LikeButton likes={post.likes} />\n}\n```\n\n```tsx filename=\"app/ui/like-button.tsx\" highlight={1} switcher\n'use client'\n\nexport default function LikeButton({ likes }: { likes: number }) {\n  // ...\n}\n```\n\n```jsx filename=\"app/ui/like-button.js\" highlight={1} switcher\n'use client'\n\nexport default function LikeButton({ likes }) {\n  // ...\n}"
  },
  {
    "id": "05-server-and-client-components.mdx#10",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "```\n\n```jsx filename=\"app/ui/like-button.js\" highlight={1} switcher\n'use client'\n\nexport default function LikeButton({ likes }) {\n  // ...\n}\n```\n\nAlternatively, you can stream data from a Server Component to a Client Component with the [`use` Hook](https://react.dev/reference/react/use). See an [example](/docs/app/getting-started/fetching-data#streaming-data-with-the-use-hook).\n\n> **Good to know**: Props passed to Client Components need to be [serializable](https://react.dev/reference/react/use-server#serializable-parameters-and-return-values) by React."
  },
  {
    "id": "05-server-and-client-components.mdx#11",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "### Interleaving Server and Client Components\n\nYou can pass Server Components as a prop to a Client Component. This allows you to visually nest server-rendered UI within Client components.\n\nA common pattern is to use `children` to create a _slot_ in a `<ClientComponent>`. For example, a `<Cart>` component that fetches data on the server, inside a `<Modal>` component that uses client state to toggle visibility.\n\n```tsx filename=\"app/ui/modal.tsx\" switcher\n'use client'\n\nexport default function Modal({ children }: { children: React.ReactNode }) {\n  return <div>{children}</div>\n}\n```\n\n```jsx filename=\"app/ui/modal.js\" switcher\n'use client'\n\nexport default function Modal({ children }) {\n  return <div>{children}</div>\n}\n```\n\nThen, in a parent Server Component (e.g.`<Page>`), you can pass a `<Cart>` as the child of the `<Modal>`:\n\n```tsx filename=\"app/page.tsx\"  highlight={7} switcher\nimport Modal from './ui/modal'\nimport Cart from './ui/cart'\n\nexport default function Page() {\n  return (\n    <Modal>\n      <Cart />\n    </Modal>\n  )\n}"
  },
  {
    "id": "05-server-and-client-components.mdx#12",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" highlight={7} switcher\nimport Modal from './ui/modal'\nimport Cart from './ui/cart'\n\nexport default function Page() {\n  return (\n    <Modal>\n      <Cart />\n    </Modal>\n  )\n}\n```\n\nIn this pattern, all Server Components will be rendered on the server ahead of time, including those as props. The resulting RSC payload will contain references of where Client Components should be rendered within the component tree."
  },
  {
    "id": "05-server-and-client-components.mdx#13",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "### Context providers\n\n[React context](https://react.dev/learn/passing-data-deeply-with-context) is commonly used to share global state like the current theme. However, React context is not supported in Server Components.\n\nTo use context, create a Client Component that accepts `children`:\n\n```tsx filename=\"app/theme-provider.tsx\" switcher\n'use client'\n\nimport { createContext } from 'react'\n\nexport const ThemeContext = createContext({})\n\nexport default function ThemeProvider({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return <ThemeContext.Provider value=\"dark\">{children}</ThemeContext.Provider>\n}\n```\n\n```jsx filename=\"app/theme-provider.js\" switcher\n'use client'\n\nimport { createContext } from 'react'\n\nexport const ThemeContext = createContext({})\n\nexport default function ThemeProvider({ children }) {\n  return <ThemeContext.Provider value=\"dark\">{children}</ThemeContext.Provider>\n}"
  },
  {
    "id": "05-server-and-client-components.mdx#14",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "```\n\nThen, import it into a Server Component (e.g. `layout`):\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport ThemeProvider from './theme-provider'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html>\n      <body>\n        <ThemeProvider>{children}</ThemeProvider>\n      </body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport ThemeProvider from './theme-provider'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html>\n      <body>\n        <ThemeProvider>{children}</ThemeProvider>\n      </body>\n    </html>\n  )\n}\n```\n\nYour Server Component will now be able to directly render your provider, and all other Client Components throughout your app will be able to consume this context.\n\n> **Good to know**: You should render providers as deep as possible in the tree – notice how `ThemeProvider` only wraps `{children}` instead of the entire `<html>` document. This makes it easier for Next.js to optimize the static parts of your Server Components."
  },
  {
    "id": "05-server-and-client-components.mdx#15",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "### Third-party components\n\nWhen using a third-party component that relies on client-only features, you can wrap it in a Client Component to ensure it works as expected.\n\nFor example, the `<Carousel />` can be imported from the `acme-carousel` package. This component uses `useState`, but it doesn't yet have the `\"use client\"` directive.\n\nIf you use `<Carousel />` within a Client Component, it will work as expected:\n\n```tsx filename=\"app/gallery.tsx\" switcher\n'use client'\n\nimport { useState } from 'react'\nimport { Carousel } from 'acme-carousel'\n\nexport default function Gallery() {\n  const [isOpen, setIsOpen] = useState(false)\n\n  return (\n    <div>\n      <button onClick={() => setIsOpen(true)}>View pictures</button>\n      {/* Works, since Carousel is used within a Client Component */}\n      {isOpen && <Carousel />}\n    </div>\n  )\n}"
  },
  {
    "id": "05-server-and-client-components.mdx#16",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "```\n\n```jsx filename=\"app/gallery.js\" switcher\n'use client'\n\nimport { useState } from 'react'\nimport { Carousel } from 'acme-carousel'\n\nexport default function Gallery() {\n  const [isOpen, setIsOpen] = useState(false)\n\n  return (\n    <div>\n      <button onClick={() => setIsOpen(true)}>View pictures</button>\n      {/*  Works, since Carousel is used within a Client Component */}\n      {isOpen && <Carousel />}\n    </div>\n  )\n}\n```\n\nHowever, if you try to use it directly within a Server Component, you'll see an error. This is because Next.js doesn't know `<Carousel />` is using client-only features.\n\nTo fix this, you can wrap third-party components that rely on client-only features in your own Client Components:\n\n```tsx filename=\"app/carousel.tsx\" switcher\n'use client'\n\nimport { Carousel } from 'acme-carousel'\n\nexport default Carousel\n```\n\n```jsx filename=\"app/carousel.js\" switcher\n'use client'\n\nimport { Carousel } from 'acme-carousel'\n\nexport default Carousel"
  },
  {
    "id": "05-server-and-client-components.mdx#17",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "```\n\n```jsx filename=\"app/carousel.js\" switcher\n'use client'\n\nimport { Carousel } from 'acme-carousel'\n\nexport default Carousel\n```\n\nNow, you can use `<Carousel />` directly within a Server Component:\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Carousel from './carousel'\n\nexport default function Page() {\n  return (\n    <div>\n      <p>View pictures</p>\n      {/*  Works, since Carousel is a Client Component */}\n      <Carousel />\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport Carousel from './carousel'\n\nexport default function Page() {\n  return (\n    <div>\n      <p>View pictures</p>\n      {/*  Works, since Carousel is a Client Component */}\n      <Carousel />\n    </div>\n  )\n}"
  },
  {
    "id": "05-server-and-client-components.mdx#18",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "```\n\n> **Advice for Library Authors**\n>\n> If you’re building a component library, add the `\"use client\"` directive to entry points that rely on client-only features. This lets your users import components into Server Components without needing to create wrappers.\n>\n> It's worth noting some bundlers might strip out `\"use client\"` directives. You can find an example of how to configure esbuild to include the `\"use client\"` directive in the [React Wrap Balancer](https://github.com/shuding/react-wrap-balancer/blob/main/tsup.config.ts#L10-L13) and [Vercel Analytics](https://github.com/vercel/analytics/blob/main/packages/web/tsup.config.js#L26-L30) repositories."
  },
  {
    "id": "05-server-and-client-components.mdx#19",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "### Preventing environment poisoning\n\nJavaScript modules can be shared between both Server and Client Components modules. This means it's possible to accidentally import server-only code into the client. For example, consider the following function:\n\n```ts filename=\"lib/data.ts\" switcher\nexport async function getData() {\n  const res = await fetch('https://external-service.com/data', {\n    headers: {\n      authorization: process.env.API_KEY,\n    },\n  })\n\n  return res.json()\n}\n```\n\n```js filename=\"lib/data.js\" switcher\nexport async function getData() {\n  const res = await fetch('https://external-service.com/data', {\n    headers: {\n      authorization: process.env.API_KEY,\n    },\n  })\n\n  return res.json()\n}"
  },
  {
    "id": "05-server-and-client-components.mdx#20",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "```\n\nThis function contains an `API_KEY` that should never be exposed to the client.\n\nIn Next.js, only environment variables prefixed with `NEXT_PUBLIC_` are included in the client bundle. If variables are not prefixed, Next.js replaces them with an empty string.\n\nAs a result, even though `getData()` can be imported and executed on the client, it won't work as expected.\n\nTo prevent accidental usage in Client Components, you can use the [`server-only` package](https://www.npmjs.com/package/server-only).\n\nThen, import the package into a file that contains server-only code:\n\n```js filename=\"lib/data.js\"\nimport 'server-only'\n\nexport async function getData() {\n  const res = await fetch('https://external-service.com/data', {\n    headers: {\n      authorization: process.env.API_KEY,\n    },\n  })\n\n  return res.json()\n}"
  },
  {
    "id": "05-server-and-client-components.mdx#21",
    "metadata": {
      "title": "Server and Client Components",
      "description": "Learn how you can use React Server and Client Components to render parts of your application on the server or the client."
    },
    "content": "```\n\nNow, if you try to import the module into a Client Component, there will be a build-time error.\n\nThe corresponding [`client-only` package](https://www.npmjs.com/package/client-only) can be used to mark modules that contain client-only logic like code that accesses the `window` object.\n\nIn Next.js, installing `server-only` or `client-only` is **optional**. However, if your linting rules flag extraneous dependencies, you may install them to avoid issues.\n\n```bash package=\"npm\"\nnpm install server-only\n```\n\n```bash package=\"yarn\"\nyarn add server-only\n```\n\n```bash package=\"pnpm\"\npnpm add server-only\n```\n\n```bash package=\"bun\"\nbun add server-only\n```\n\nNext.js handles `server-only` and `client-only` imports internally to provide clearer error messages when a module is used in the wrong environment. The contents of these packages from NPM are not used by Next.js.\n\nNext.js also provides its own type declarations for `server-only` and `client-only`, for TypeScript configurations where [`noUncheckedSideEffectImports`](https://www.typescriptlang.org/tsconfig/#noUncheckedSideEffectImports) is active."
  },
  {
    "id": "06-cache-components.mdx#0",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "---\ntitle: Cache Components\ndescription: Learn how to use Cache Components and combine the benefits of static and dynamic rendering.\nrelated:\n  title: Next Steps\n  description: Learn more about the config option for Cache Components.\n  links:\n    - app/api-reference/config/next-config-js/cacheComponents\n    - app/api-reference/directives/use-cache\n    - app/api-reference/functions/cacheLife\n    - app/api-reference/functions/cacheTag\n    - app/api-reference/functions/revalidateTag\n    - app/api-reference/functions/updateTag\n---\n\n> **Good to know:** Cache Components is an opt-in feature. Enable it by setting the `cacheComponents` flag to `true` in your Next config file. See [Enabling Cache Components](#enabling-cache-components) for more details.\n\nCache Components lets you mix static, cached, and dynamic content in a single route, giving you the speed of static sites with the flexibility of dynamic rendering.\n\nServer-rendered applications typically force a choice between static pages (fast but stale) and dynamic pages (fresh but slow). Moving this work to the client trades server load for larger bundles and slower initial rendering."
  },
  {
    "id": "06-cache-components.mdx#1",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "Cache Components eliminates these tradeoffs by prerendering routes into a **static HTML shell** that's immediately sent to the browser, with dynamic content updating the UI as it becomes ready.\n\n<Image\n  alt=\"Partially re-rendered Product Page showing static nav and product information, and dynamic cart and recommended products\"\n  srcLight=\"/learn/light/thinking-in-ppr.png\"\n  srcDark=\"/learn/dark/thinking-in-ppr.png\"\n  width=\"1600\"\n  height=\"632\"\n/>"
  },
  {
    "id": "06-cache-components.mdx#2",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "## How rendering works with Cache Components\n\nAt build time, Next.js renders your route's component tree. As long as components don't access network resources, certain system APIs, or require an incoming request to render, their output is **automatically added to the static shell**. Otherwise, you must choose how to handle them:\n\n- Defer rendering to request time by wrapping components in React's [`<Suspense>`](https://react.dev/reference/react/Suspense), [showing fallback UI](#defer-rendering-to-request-time) until the content is ready, or\n- Cache the result using the [`use cache`](/docs/app/api-reference/directives/use-cache) directive to [include it in the static shell](#using-use-cache) (if no request data is needed)\n\nBecause this happens ahead of time, before a request arrives, we refer to it as prerendering. This generates a static shell consisting of HTML for initial page loads and a serialized [RSC Payload](/docs/app/getting-started/server-and-client-components#on-the-server) for client-side navigation, ensuring the browser receives fully rendered content instantly whether users navigate directly to the URL or transition from another page."
  },
  {
    "id": "06-cache-components.mdx#3",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "Next.js requires you to explicitly handle components that can't complete during prerendering. If they aren't wrapped in `<Suspense>` or marked with `use cache`, you'll see an [`Uncached data was accessed outside of <Suspense>`](https://nextjs.org/docs/messages/blocking-route) error during development and build time.\n\n> **Good to know**: Caching can be applied at the component or function level, while fallback UI can be defined around any subtree, which means you can compose static, cached, and dynamic content within a single route.\n\n<Image\n  alt=\"Diagram showing partially rendered page on the client, with loading UI for chunks that are being streamed.\"\n  srcLight=\"/docs/light/server-rendering-with-streaming.png\"\n  srcDark=\"/docs/dark/server-rendering-with-streaming.png\"\n  width=\"1600\"\n  height=\"785\"\n/>\n\nThis rendering approach is called **Partial Prerendering**, and it's the default behavior with Cache Components. For the rest of this document, we simply refer to it as \"prerendering\" which can produce a partial or complete output.\n\n> **🎥 Watch:** Why Partial Prerendering and how it works → [YouTube (10 minutes)](https://www.youtube.com/watch?v=MTcPrTIBkpA)."
  },
  {
    "id": "06-cache-components.mdx#4",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "## Automatically prerendered content\n\nOperations like synchronous I/O, module imports, and pure computations can complete during prerendering. Components using only these operations have their rendered output included in the static HTML shell.\n\nBecause all operations in the `Page` component below complete during rendering, its rendered output is automatically included in the static shell. When both the layout and page prerender successfully, the entire route is the static shell.\n\n```tsx filename=\"page.tsx\"\nimport fs from 'node:fs'\n\nexport default async function Page() {\n  // Synchronous file system read\n  const content = fs.readFileSync('./config.json', 'utf-8')\n\n  // Module imports\n  const constants = await import('./constants.json')\n\n  // Pure computations\n  const processed = JSON.parse(content).items.map((item) => item.value * 2)\n\n  return (\n    <div>\n      <h1>{constants.appName}</h1>\n      <ul>\n        {processed.map((value, i) => (\n          <li key={i}>{value}</li>\n        ))}\n      </ul>\n    </div>\n  )\n}"
  },
  {
    "id": "06-cache-components.mdx#5",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "```\n\n> **Good to know**: You can verify that a route was fully prerendered by checking the build output summary. Alternatively see what content was added to the static shell of any page by viewing the page source in your browser."
  },
  {
    "id": "06-cache-components.mdx#6",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "## Defer rendering to request time\n\nDuring prerendering, when Next.js encounters work it can't complete (like network requests, accessing request data, or async operations), it requires you to explicitly handle it. To defer rendering to request time, a parent component must provide fallback UI using a Suspense boundary. The fallback becomes part of the static shell while the actual content resolves at request time.\n\nPlace Suspense boundaries as close as possible to the components that need them. This maximizes the amount of content in the static shell, since everything outside the boundary can still prerender normally.\n\n> **Good to know**: With Suspense boundaries, multiple dynamic sections can render in parallel rather than blocking each other, reducing total load time."
  },
  {
    "id": "06-cache-components.mdx#7",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "### Dynamic content\n\nExternal systems provide content asynchronously, which often takes an unpredictable time to resolve and may even fail. This is why prerendering doesn't execute them automatically.\n\nIn general, when you need the latest data from the source on each request (like real-time feeds or personalized content), defer rendering by providing fallback UI with a Suspense boundary.\n\nFor example the `DynamicContent` component below uses multiple operations that are not automatically prerendered.\n\n```tsx filename=\"page.tsx\"\nimport { Suspense } from 'react'\nimport fs from 'node:fs/promises'\nimport { setTimeout } from 'node:timers/promises'\n\nasync function DynamicContent() {\n  // Network request\n  const data = await fetch('https://api.example.com/data')\n\n  // Database query\n  const users = await db.query('SELECT * FROM users')\n\n  // Async file system operation\n  const file = await fs.readFile('..', 'utf-8')\n\n  // Simulating external system delay\n  await setTimeout(100) // from 'node:timers/promises'\n\n  return <div>Not in the static shell</div>\n}"
  },
  {
    "id": "06-cache-components.mdx#8",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "```\n\nTo use `DynamicContent` within a page, wrap it in `<Suspense>` to define fallback UI:\n\n```tsx filename=\"page.tsx\"\nexport default async function Page(props) {\n  return (\n    <>\n      <h1>Part of the static shell</h1>\n      {/* <p>Loading..</p> is part of the static shell */}\n      <Suspense fallback={<p>Loading..</p>}>\n        <DynamicContent />\n        <div>Sibling excluded from static shell</div>\n      </Suspense>\n    </>\n  )\n}\n```\n\nPrerendering stops at the `fetch` request. The request itself is not started, and any code after it is not executed.\n\nThe fallback (`<p>Loading...</p>`) is included in the static shell, while the component's content streams at request time.\n\nIn this example, since all operations (network request, database query, file read, and timeout) run sequentially within the same component, the content won't appear until they all complete.\n\n> **Good to know**: For dynamic content that doesn't change frequently, you can use `use cache` to include the dynamic data in the static shell instead of streaming it. See the [during prerendering](#during-prerendering) section for an example."
  },
  {
    "id": "06-cache-components.mdx#9",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "### Runtime data\n\nA specific type of dynamic data that requires request context, only available when a user makes a request.\n\n- [`cookies()`](/docs/app/api-reference/functions/cookies) - User's cookie data\n- [`headers()`](/docs/app/api-reference/functions/headers) - Request headers\n- [`searchParams`](/docs/app/api-reference/file-conventions/page#searchparams-optional) - URL query parameters\n- [`params`](/docs/app/api-reference/file-conventions/page#params-optional) - Dynamic route parameters (unless at least one sample is provided via [`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params))\n\n```tsx filename=\"page.tsx\"\nimport { cookies, headers } from 'next/headers'\nimport { Suspense } from 'react'\n\nasync function RuntimeData({ searchParams }) {\n  // Accessing request data\n  const cookieStore = await cookies()\n  const headerStore = await headers()\n  const search = await searchParams\n\n  return <div>Not in the static shell</div>\n}"
  },
  {
    "id": "06-cache-components.mdx#10",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "```\n\nTo use the `RuntimeData` component in, wrap it in a `<Suspense>` boundary:\n\n```tsx filename=\"page.tsx\"\nexport default async function Page(props) {\n  return (\n    <>\n      <h1>Part of the static shell</h1>\n      {/* <p>Loading..</p> is part of the static shell */}\n      <Suspense fallback={<p>Loading..</p>}>\n        <RuntimeData searchParams={props.searchParams} />\n        <div>Sibling excluded from static shell</div>\n      </Suspense>\n    </>\n  )\n}\n```\n\nUse [`connection()`](/docs/app/api-reference/functions/connection) if you need to defer to request time without accessing any of the runtime APIs above.\n\n> **Good to know**: Runtime data cannot be cached with `use cache` because it requires request context. Components that access runtime APIs must always be wrapped in `<Suspense>`. However, you can extract values from runtime data and pass them as arguments to cached functions. See the [with runtime data](#with-runtime-data) section for an example."
  },
  {
    "id": "06-cache-components.mdx#11",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "### Non-deterministic operations\n\nOperations like `Math.random()`, `Date.now()`, or `crypto.randomUUID()` produce different values each time they execute. To ensure these run at request time (generating unique values per request), Cache Components requires you to explicitly signal this intent by calling these operations after dynamic or runtime data access.\n\n```tsx\nimport { connection } from 'next/server'\nimport { Suspense } from 'react'\n\nasync function UniqueContent() {\n  // Explicitly defer to request time\n  await connection()\n\n  // Non-deterministic operations\n  const random = Math.random()\n  const now = Date.now()\n  const date = new Date()\n  const uuid = crypto.randomUUID()\n  const bytes = crypto.getRandomValues(new Uint8Array(16))\n\n  return (\n    <div>\n      <p>{random}</p>\n      <p>{now}</p>\n      <p>{date.getTime()}</p>\n      <p>{uuid}</p>\n      <p>{bytes}</p>\n    </div>\n  )\n}"
  },
  {
    "id": "06-cache-components.mdx#12",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "```\n\nBecause the `UniqueContent` component defers to request time, to use it within a route, it must be wrapped in `<Suspense>`:\n\n```tsx filename=\"page.tsx\"\nexport default async function Page() {\n  return (\n    // <p>Loading..</p> is part of the static shell\n    <Suspense fallback={<p>Loading..</p>}>\n      <UniqueContent />\n    </Suspense>\n  )\n}\n```\n\nEvery incoming request would see different random numbers, date, etc.\n\n> **Good to know**: You can cache non-deterministic operations with `use cache`. See the [with non-deterministic operations](#with-non-deterministic-operations) section for examples."
  },
  {
    "id": "06-cache-components.mdx#13",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "## Using `use cache`\n\nThe [`use cache`](/docs/app/api-reference/directives/use-cache) directive caches the return value of async functions and components. You can apply it at the function, component, or file level.\n\nArguments and any closed-over values from parent scopes automatically become part of the [cache key](/docs/app/api-reference/directives/use-cache#cache-keys), which means different inputs produce separate cache entries. This enables personalized or parameterized cached content.\n\nWhen [dynamic content](#dynamic-content) doesn't need to be fetched fresh from the source on every request, caching it lets you include the content in the static shell during prerendering, or reuse the result at runtime across multiple requests.\n\nCached content can be revalidated in two ways: automatically based on the cache lifetime, or on-demand using tags with [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) or [`updateTag`](/docs/app/api-reference/functions/updateTag).\n\n> **Good to know**: See [serialization requirements and constraints](/docs/app/api-reference/directives/use-cache#constraints) for details on what can be cached and how arguments work."
  },
  {
    "id": "06-cache-components.mdx#14",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "### During prerendering\n\nWhile [dynamic content](#dynamic-content) is fetched from external sources, it's often unlikely to change between accesses. Product catalog data updates with inventory changes, blog post content rarely changes after publishing, and analytics reports for past dates remain static.\n\nIf this data doesn't depend on [runtime data](#runtime-data), you can use the `use cache` directive to include it in the static HTML shell. Use [`cacheLife`](/docs/app/api-reference/functions/cacheLife) to define how long to use the cached data.\n\nWhen revalidation occurs, the static shell is updated with fresh content. See [Tagging and revalidating](#tagging-and-revalidating) for details on on-demand revalidation.\n\n```tsx filename=\"app/page.tsx\" highlight={1,4,5}\nimport { cacheLife } from 'next/cache'\n\nexport default async function Page() {\n  'use cache'\n  cacheLife('hours')\n\n  const users = await db.query('SELECT * FROM users')\n\n  return (\n    <ul>\n      {users.map((user) => (\n        <li key={user.id}>{user.name}</li>\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "06-cache-components.mdx#15",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "```\n\nThe `cacheLife` function accepts a cache profile name (like `'hours'`, `'days'`, or `'weeks'`) or a custom configuration object to control cache behavior:\n\n```tsx filename=\"app/page.tsx\" highlight={1,4-8}\nimport { cacheLife } from 'next/cache'\n\nexport default async function Page() {\n  'use cache'\n  cacheLife({\n    stale: 3600, // 1 hour until considered stale\n    revalidate: 7200, // 2 hours until revalidated\n    expire: 86400, // 1 day until expired\n  })\n\n  const users = await db.query('SELECT * FROM users')\n\n  return (\n    <ul>\n      {users.map((user) => (\n        <li key={user.id}>{user.name}</li>\n      ))}\n    </ul>\n  )\n}\n```\n\nSee the [`cacheLife` API reference](/docs/app/api-reference/functions/cacheLife) for available profiles and custom configuration options."
  },
  {
    "id": "06-cache-components.mdx#16",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "### With runtime data\n\nRuntime data and [`use cache`](/docs/app/api-reference/directives/use-cache) cannot be used in the same scope. However, you can extract values from runtime APIs and pass them as arguments to cached functions.\n\n```tsx filename=\"app/profile/page.tsx\"\nimport { cookies } from 'next/headers'\nimport { Suspense } from 'react'\n\nexport default function Page() {\n  // Page itself creates the dynamic boundary\n  return (\n    <Suspense fallback={<div>Loading...</div>}>\n      <ProfileContent />\n    </Suspense>\n  )\n}\n\n// Component (not cached) reads runtime data\nasync function ProfileContent() {\n  const session = (await cookies()).get('session')?.value\n\n  return <CachedContent sessionId={session} />\n}\n\n// Cached component/function receives data as props\nasync function CachedContent({ sessionId }: { sessionId: string }) {\n  'use cache'\n  // sessionId becomes part of cache key\n  const data = await fetchUserData(sessionId)\n  return <div>{data}</div>\n}\n```\n\nAt request time, `CachedContent` executes if no matching cache entry is found, and stores the result for future requests."
  },
  {
    "id": "06-cache-components.mdx#17",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "### With non-deterministic operations\n\nWithin a `use cache` scope, non-deterministic operations execute during prerendering. This is useful when you want the same rendered output served to all users:\n\n```tsx\nexport default async function Page() {\n  'use cache'\n\n  // Execute once, then cached for all requests\n  const random = Math.random()\n  const random2 = Math.random()\n  const now = Date.now()\n  const date = new Date()\n  const uuid = crypto.randomUUID()\n  const bytes = crypto.getRandomValues(new Uint8Array(16))\n\n  return (\n    <div>\n      <p>\n        {random} and {random2}\n      </p>\n      <p>{now}</p>\n      <p>{date.getTime()}</p>\n      <p>{uuid}</p>\n      <p>{bytes}</p>\n    </div>\n  )\n}\n```\n\nAll requests will be served a route containing same random numbers, timestamp, and UUID until the cache is revalidated."
  },
  {
    "id": "06-cache-components.mdx#18",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "### Tagging and revalidating\n\nTag cached data with [`cacheTag`](/docs/app/api-reference/functions/cacheTag) and revalidate it after mutations using [`updateTag`](/docs/app/api-reference/functions/updateTag) in Server Actions for immediate updates, or [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) when delays in updates are acceptable.\n\n#### With `updateTag`\n\nUse `updateTag` when you need to expire and immediately refresh cached data within the same request:\n\n```tsx filename=\"app/actions.ts\" highlight={1,4,5,13}\nimport { cacheTag, updateTag } from 'next/cache'\n\nexport async function getCart() {\n  'use cache'\n  cacheTag('cart')\n  // fetch data\n}\n\nexport async function updateCart(itemId: string) {\n  'use server'\n  // write data using the itemId\n  // update the user cart\n  updateTag('cart')\n}\n```"
  },
  {
    "id": "06-cache-components.mdx#19",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "#### With `revalidateTag`\n\nUse `revalidateTag` when you want to invalidate only properly tagged cached entries with stale-while-revalidate behavior. This is ideal for static content that can tolerate eventual consistency.\n\n```tsx filename=\"app/actions.ts\" highlight={1,4,5,12}\nimport { cacheTag, revalidateTag } from 'next/cache'\n\nexport async function getPosts() {\n  'use cache'\n  cacheTag('posts')\n  // fetch data\n}\n\nexport async function createPost(post: FormData) {\n  'use server'\n  // write data using the FormData\n  revalidateTag('posts', 'max')\n}\n```\n\nFor more detailed explanation and usage examples, see the [`use cache` API reference](/docs/app/api-reference/directives/use-cache)."
  },
  {
    "id": "06-cache-components.mdx#20",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "### What should I cache?\n\nWhat you cache should be a function of what you want your UI loading states to be. If data doesn't depend on runtime data and you're okay with a cached value being served for multiple requests over a period of time, use `use cache` with `cacheLife` to describe that behavior.\n\nFor content management systems with update mechanisms, consider using tags with longer cache durations and rely on `revalidateTag` to mark static initial UI as ready for revalidation. This pattern allows you to serve fast, cached responses while still updating content when it actually changes, rather than expiring the cache preemptively."
  },
  {
    "id": "06-cache-components.mdx#21",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "## Putting it all together\n\nHere's a complete example showing static content, cached dynamic content, and streaming dynamic content working together on a single page:\n\n```tsx filename=\"app/blog/page.tsx\"\nimport { Suspense } from 'react'\nimport { cookies } from 'next/headers'\nimport { cacheLife } from 'next/cache'\nimport Link from 'next/link'\n\nexport default function BlogPage() {\n  return (\n    <>\n      {/* Static content - prerendered automatically */}\n      <header>\n        <h1>Our Blog</h1>\n        <nav>\n          <Link href=\"/\">Home</Link> | <Link href=\"/about\">About</Link>\n        </nav>\n      </header>\n\n      {/* Cached dynamic content - included in the static shell */}\n      <BlogPosts />\n\n      {/* Runtime dynamic content - streams at request time */}\n      <Suspense fallback={<p>Loading your preferences...</p>}>\n        <UserPreferences />\n      </Suspense>\n    </>\n  )\n}\n\n// Everyone sees the same blog posts (revalidated every hour)\nasync function BlogPosts() {\n  'use cache'\n  cacheLife('hours')\n\n  const res = await fetch('https://api.vercel.app/blog')\n  const posts = await res.json()"
  },
  {
    "id": "06-cache-components.mdx#22",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "const res = await fetch('https://api.vercel.app/blog')\n  const posts = await res.json()\n\n  return (\n    <section>\n      <h2>Latest Posts</h2>\n      <ul>\n        {posts.slice(0, 5).map((post: any) => (\n          <li key={post.id}>\n            <h3>{post.title}</h3>\n            <p>\n              By {post.author} on {post.date}\n            </p>\n          </li>\n        ))}\n      </ul>\n    </section>\n  )\n}\n\n// Personalized per user based on their cookie\nasync function UserPreferences() {\n  const theme = (await cookies()).get('theme')?.value || 'light'\n  const favoriteCategory = (await cookies()).get('category')?.value\n\n  return (\n    <aside>\n      <p>Your theme: {theme}</p>\n      {favoriteCategory && <p>Favorite category: {favoriteCategory}</p>}\n    </aside>\n  )\n}"
  },
  {
    "id": "06-cache-components.mdx#23",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "```\n\nDuring prerendering the header (static) and the blog posts fetched from the API (cached with `use cache`), both become part of the static shell along with the fallback UI for user preferences.\n\nWhen a user visits the page, they instantly see this prerendered shell with the header and blog posts. Only the personalized preferences need to stream in at request time since they depend on the user's cookies. This ensures fast initial page loads while still providing personalized content."
  },
  {
    "id": "06-cache-components.mdx#24",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "## Enabling Cache Components\n\nYou can enable Cache Components (which includes PPR) by adding the [`cacheComponents`](/docs/app/api-reference/config/next-config-js/cacheComponents) option to your Next config file:\n\n```ts filename=\"next.config.ts\" highlight={4} switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  cacheComponents: true,\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" highlight={3} switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  cacheComponents: true,\n}\n\nmodule.exports = nextConfig\n```\n\n> **Good to know:** When Cache Components is enabled, `GET` Route Handlers follow the same prerendering model as pages. See [Route Handlers with Cache Components](/docs/app/getting-started/route-handlers#with-cache-components) for details."
  },
  {
    "id": "06-cache-components.mdx#25",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "## Navigation uses Activity\n\nWhen the [`cacheComponents`](/docs/app/api-reference/config/next-config-js/cacheComponents) flag is enabled, Next.js uses React's [`<Activity>`](https://react.dev/reference/react/Activity) component to preserve component state during client-side navigation.\n\nRather than unmounting the previous route when you navigate away, Next.js sets the Activity mode to [`\"hidden\"`](https://react.dev/reference/react/Activity#activity). This means:\n\n- Component state is preserved when navigating between routes\n- When you navigate back, the previous route reappears with its state intact\n- Effects are cleaned up when a route is hidden, and recreated when it becomes visible again\n\nThis behavior improves the navigation experience by maintaining UI state (form inputs, or expanded sections) when users navigate back and forth between routes.\n\n> **Good to know**: Next.js uses heuristics to keep a few recently visited routes `\"hidden\"`, while older routes are removed from the DOM to prevent excessive growth."
  },
  {
    "id": "06-cache-components.mdx#26",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "## Migrating route segment configs\n\nWhen Cache Components is enabled, several route segment config options are no longer needed or supported:\n\n### `dynamic = \"force-dynamic\"`\n\n**Not needed.** All pages are dynamic by default.\n\n```tsx filename=\"app/page.tsx\"\n// Before - No longer needed\nexport const dynamic = 'force-dynamic'\n\nexport default function Page() {\n  return <div>...</div>\n}\n```\n\n```tsx filename=\"app/page.tsx\"\n// After - Just remove it\nexport default function Page() {\n  return <div>...</div>\n}\n```"
  },
  {
    "id": "06-cache-components.mdx#27",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "### `dynamic = \"force-static\"`\n\nStart by removing it. When unhandled dynamic or runtime data access is detected during development and built time, Next.js raises an error. Otherwise, the [prerendering](#automatically-prerendered-content) step automatically extracts the static HTML shell.\n\nFor dynamic data access, add [`use cache`](#using-use-cache) as close to the data access as possible with a long [`cacheLife`](/docs/app/api-reference/functions/cacheLife) like `'max'` to maintain cached behavior. If needed, add it at the top of the page or layout.\n\nFor runtime data access (`cookies()`, `headers()`, etc.), errors will direct you to [wrap it with `Suspense`](#runtime-data). Since you started by using `force-static`, you must remove the runtime data access to prevent any request time work.\n\n```tsx filename=\"app/page.tsx\"\n// Before\nexport const dynamic = 'force-static'\n\nexport default async function Page() {\n  const data = await fetch('https://api.example.com/data')\n  return <div>...</div>\n}"
  },
  {
    "id": "06-cache-components.mdx#28",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "```\n\n```tsx filename=\"app/page.tsx\"\nimport { cacheLife } from 'next/cache'\n\n// After - Use 'use cache' instead\nexport default async function Page() {\n  'use cache'\n  cacheLife('max')\n  const data = await fetch('https://api.example.com/data')\n  return <div>...</div>\n}\n```"
  },
  {
    "id": "06-cache-components.mdx#29",
    "metadata": {
      "title": "Cache Components",
      "description": "Learn how to use Cache Components and combine the benefits of static and dynamic rendering."
    },
    "content": "### `revalidate`\n\n**Replace with `cacheLife`.** Use the `cacheLife` function to define cache duration instead of the route segment config.\n\n```tsx\n// Before\nexport const revalidate = 3600 // 1 hour\n\nexport default async function Page() {\n  return <div>...</div>\n}\n```\n\n```tsx filename=\"app/page.tsx\"\n// After - Use cacheLife\nimport { cacheLife } from 'next/cache'\n\nexport default async function Page() {\n  'use cache'\n  cacheLife('hours')\n  return <div>...</div>\n}\n```\n\n### `fetchCache`\n\n**Not needed.** With `use cache`, all data fetching within a cached scope is automatically cached, making `fetchCache` unnecessary.\n\n```tsx filename=\"app/page.tsx\"\n// Before\nexport const fetchCache = 'force-cache'\n```\n\n```tsx filename=\"app/page.tsx\"\n// After - Use 'use cache' to control caching behavior\nexport default async function Page() {\n  'use cache'\n  // All fetches here are cached\n  return <div>...</div>\n}\n```\n\n### `runtime = 'edge'`\n\n**Not supported.** Cache Components requires Node.js runtime and will throw errors with [Edge Runtime](/docs/app/api-reference/edge)."
  },
  {
    "id": "07-fetching-data.mdx#0",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "---\ntitle: Fetching Data\ndescription: Learn how to fetch data and stream content that depends on data.\nrelated:\n  title: API Reference\n  description: Learn more about the features mentioned in this page by reading the API Reference.\n  links:\n    - app/guides/data-security\n    - app/api-reference/functions/fetch\n    - app/api-reference/file-conventions/loading\n    - app/api-reference/config/next-config-js/logging\n    - app/api-reference/config/next-config-js/taint\n---\n\nThis page will walk you through how you can fetch data in [Server and Client Components](/docs/app/getting-started/server-and-client-components), and how to [stream](#streaming) components that depend on data."
  },
  {
    "id": "07-fetching-data.mdx#1",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "## Fetching data"
  },
  {
    "id": "07-fetching-data.mdx#2",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "### Server Components\n\nYou can fetch data in Server Components using any asynchronous I/O, such as:\n\n1. The [`fetch` API](#with-the-fetch-api)\n2. An [ORM or database](#with-an-orm-or-database)\n3. Reading from the filesystem using Node.js APIs like `fs`"
  },
  {
    "id": "07-fetching-data.mdx#3",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "#### With the `fetch` API\n\nTo fetch data with the `fetch` API, turn your component into an asynchronous function, and await the `fetch` call. For example:\n\n```tsx filename=\"app/blog/page.tsx\" switcher\nexport default async function Page() {\n  const data = await fetch('https://api.vercel.app/blog')\n  const posts = await data.json()\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.id}>{post.title}</li>\n      ))}\n    </ul>\n  )\n}\n```\n\n```jsx filename=\"app/blog/page.js\" switcher\nexport default async function Page() {\n  const data = await fetch('https://api.vercel.app/blog')\n  const posts = await data.json()\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.id}>{post.title}</li>\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "07-fetching-data.mdx#4",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\n> **Good to know:**\n>\n> - `fetch` responses are not cached by default. However, Next.js will [pre-render](/docs/app/guides/caching#static-rendering) the route and the output will be cached for improved performance. If you'd like to opt into [dynamic rendering](/docs/app/guides/caching#dynamic-rendering), use the `{ cache: 'no-store' }` option. See the [`fetch` API Reference](/docs/app/api-reference/functions/fetch).\n> - During development, you can log `fetch` calls for better visibility and debugging. See the [`logging` API reference](/docs/app/api-reference/config/next-config-js/logging)."
  },
  {
    "id": "07-fetching-data.mdx#5",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "#### With an ORM or database\n\nSince Server Components are rendered on the server, you can safely make database queries using an ORM or database client. Turn your component into an asynchronous function, and await the call:\n\n```tsx filename=\"app/blog/page.tsx\" switcher\nimport { db, posts } from '@/lib/db'\n\nexport default async function Page() {\n  const allPosts = await db.select().from(posts)\n  return (\n    <ul>\n      {allPosts.map((post) => (\n        <li key={post.id}>{post.title}</li>\n      ))}\n    </ul>\n  )\n}\n```\n\n```jsx filename=\"app/blog/page.js\" switcher\nimport { db, posts } from '@/lib/db'\n\nexport default async function Page() {\n  const allPosts = await db.select().from(posts)\n  return (\n    <ul>\n      {allPosts.map((post) => (\n        <li key={post.id}>{post.title}</li>\n      ))}\n    </ul>\n  )\n}\n```"
  },
  {
    "id": "07-fetching-data.mdx#6",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "### Client Components\n\nThere are two ways to fetch data in Client Components, using:\n\n1. React's [`use` hook](https://react.dev/reference/react/use)\n2. A community library like [SWR](https://swr.vercel.app/) or [React Query](https://tanstack.com/query/latest)"
  },
  {
    "id": "07-fetching-data.mdx#7",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "#### Streaming data with the `use` hook\n\nYou can use React's [`use` hook](https://react.dev/reference/react/use) to [stream](#streaming) data from the server to client. Start by fetching data in your Server component, and pass the promise to your Client Component as prop:\n\n```tsx filename=\"app/blog/page.tsx\" switcher\nimport Posts from '@/app/ui/posts'\nimport { Suspense } from 'react'\n\nexport default function Page() {\n  // Don't await the data fetching function\n  const posts = getPosts()\n\n  return (\n    <Suspense fallback={<div>Loading...</div>}>\n      <Posts posts={posts} />\n    </Suspense>\n  )\n}\n```\n\n```jsx filename=\"app/blog/page.js\" switcher\nimport Posts from '@/app/ui/posts'\nimport { Suspense } from 'react'\n\nexport default function Page() {\n  // Don't await the data fetching function\n  const posts = getPosts()\n\n  return (\n    <Suspense fallback={<div>Loading...</div>}>\n      <Posts posts={posts} />\n    </Suspense>\n  )\n}"
  },
  {
    "id": "07-fetching-data.mdx#8",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\nThen, in your Client Component, use the `use` hook to read the promise:\n\n```tsx filename=\"app/ui/posts.tsx\" switcher\n'use client'\nimport { use } from 'react'\n\nexport default function Posts({\n  posts,\n}: {\n  posts: Promise<{ id: string; title: string }[]>\n}) {\n  const allPosts = use(posts)\n\n  return (\n    <ul>\n      {allPosts.map((post) => (\n        <li key={post.id}>{post.title}</li>\n      ))}\n    </ul>\n  )\n}\n```\n\n```jsx filename=\"app/ui/posts.js\" switcher\n'use client'\nimport { use } from 'react'\n\nexport default function Posts({ posts }) {\n  const allPosts = use(posts)\n\n  return (\n    <ul>\n      {allPosts.map((post) => (\n        <li key={post.id}>{post.title}</li>\n      ))}\n    </ul>\n  )\n}\n```\n\nIn the example above, the `<Posts>` component is wrapped in a [`<Suspense>` boundary](https://react.dev/reference/react/Suspense). This means the fallback will be shown while the promise is being resolved. Learn more about [streaming](#streaming)."
  },
  {
    "id": "07-fetching-data.mdx#9",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "#### Community libraries\n\nYou can use a community library like [SWR](https://swr.vercel.app/) or [React Query](https://tanstack.com/query/latest) to fetch data in Client Components. These libraries have their own semantics for caching, streaming, and other features. For example, with SWR:\n\n```tsx filename=\"app/blog/page.tsx\" switcher\n'use client'\nimport useSWR from 'swr'\n\nconst fetcher = (url) => fetch(url).then((r) => r.json())\n\nexport default function BlogPage() {\n  const { data, error, isLoading } = useSWR(\n    'https://api.vercel.app/blog',\n    fetcher\n  )\n\n  if (isLoading) return <div>Loading...</div>\n  if (error) return <div>Error: {error.message}</div>\n\n  return (\n    <ul>\n      {data.map((post: { id: string; title: string }) => (\n        <li key={post.id}>{post.title}</li>\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "07-fetching-data.mdx#10",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\n```jsx filename=\"app/blog/page.js\" switcher\n'use client'\n\nimport useSWR from 'swr'\n\nconst fetcher = (url) => fetch(url).then((r) => r.json())\n\nexport default function BlogPage() {\n  const { data, error, isLoading } = useSWR(\n    'https://api.vercel.app/blog',\n    fetcher\n  )\n\n  if (isLoading) return <div>Loading...</div>\n  if (error) return <div>Error: {error.message}</div>\n\n  return (\n    <ul>\n      {data.map((post) => (\n        <li key={post.id}>{post.title}</li>\n      ))}\n    </ul>\n  )\n}\n```"
  },
  {
    "id": "07-fetching-data.mdx#11",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "## Deduplicate requests and cache data\n\nOne way to deduplicate `fetch` requests is with [request memoization](/docs/app/guides/caching#request-memoization). With this mechanism, `fetch` calls using `GET` or `HEAD` with the same URL and options in a single render pass are combined into one request. This happens automatically, and you can [opt out](/docs/app/guides/caching#opting-out) by passing an Abort signal to `fetch`.\n\nRequest memoization is scoped to the lifetime of a request.\n\nYou can also deduplicate `fetch` requests by using Next.js’ [Data Cache](/docs/app/guides/caching#data-cache), for example by setting `cache: 'force-cache'` in your `fetch` options.\n\nData Cache allows sharing data across the current render pass and incoming requests.\n\nIf you are _not_ using `fetch`, and instead using an ORM or database directly, you can wrap your data access with the [React `cache`](https://react.dev/reference/react/cache) function.\n\n```tsx filename=\"app/lib/data.ts\" switcher\nimport { cache } from 'react'\nimport { db, posts, eq } from '@/lib/db'"
  },
  {
    "id": "07-fetching-data.mdx#12",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```tsx filename=\"app/lib/data.ts\" switcher\nimport { cache } from 'react'\nimport { db, posts, eq } from '@/lib/db'\n\nexport const getPost = cache(async (id: string) => {\n  const post = await db.query.posts.findFirst({\n    where: eq(posts.id, parseInt(id)),\n  })\n})"
  },
  {
    "id": "07-fetching-data.mdx#13",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\n```jsx filename=\"app/lib/data.js\" switcher\nimport { cache } from 'react'\nimport { db, posts, eq } from '@/lib/db'\nimport { notFound } from 'next/navigation'\n\nexport const getPost = cache(async (id) => {\n  const post = await db.query.posts.findFirst({\n    where: eq(posts.id, parseInt(id)),\n  })\n})\n```"
  },
  {
    "id": "07-fetching-data.mdx#14",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "## Streaming\n\n> **Warning:** The content below assumes the [`cacheComponents` config option](/docs/app/api-reference/config/next-config-js/cacheComponents) is enabled in your application. The flag was introduced in Next.js 15 canary.\n\nWhen you fetch data in Server Components, the data is fetched and rendered on the server for each request. If you have any slow data requests, the whole route will be blocked from rendering until all the data is fetched.\n\nTo improve the initial load time and user experience, you can use streaming to break up the page's HTML into smaller chunks and progressively send those chunks from the server to the client.\n\n<Image\n  alt=\"How Server Rendering with Streaming Works\"\n  srcLight=\"/docs/light/server-rendering-with-streaming.png\"\n  srcDark=\"/docs/dark/server-rendering-with-streaming.png\"\n  width=\"1600\"\n  height=\"785\"\n/>\n\nThere are two ways you can leverage streaming in your application:\n\n1. Wrapping a page with a [`loading.js` file](#with-loadingjs)\n2. Wrapping a component with [`<Suspense>`](#with-suspense)"
  },
  {
    "id": "07-fetching-data.mdx#15",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "### With `loading.js`\n\nYou can create a `loading.js` file in the same folder as your page to stream the **entire page** while the data is being fetched. For example, to stream `app/blog/page.js`, add the file inside the `app/blog` folder.\n\n<Image\n  alt=\"Blog folder structure with loading.js file\"\n  srcLight=\"/docs/light/loading-file.png\"\n  srcDark=\"/docs/dark/loading-file.png\"\n  width=\"1600\"\n  height=\"525\"\n/>\n\n```tsx filename=\"app/blog/loading.tsx\" switcher\nexport default function Loading() {\n  // Define the Loading UI here\n  return <div>Loading...</div>\n}\n```\n\n```jsx filename=\"app/blog/loading.js\" switcher\nexport default function Loading() {\n  // Define the Loading UI here\n  return <div>Loading...</div>\n}"
  },
  {
    "id": "07-fetching-data.mdx#16",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\n```jsx filename=\"app/blog/loading.js\" switcher\nexport default function Loading() {\n  // Define the Loading UI here\n  return <div>Loading...</div>\n}\n```\n\nOn navigation, the user will immediately see the layout and a [loading state](#creating-meaningful-loading-states) while the page is being rendered. The new content will then be automatically swapped in once rendering is complete.\n\n<Image\n  alt=\"Loading UI\"\n  srcLight=\"/docs/light/loading-ui.png\"\n  srcDark=\"/docs/dark/loading-ui.png\"\n  width=\"1600\"\n  height=\"691\"\n/>\n\nBehind-the-scenes, `loading.js` will be nested inside `layout.js`, and will automatically wrap the `page.js` file and any children below in a `<Suspense>` boundary.\n\n<Image\n  alt=\"loading.js overview\"\n  srcLight=\"/docs/light/loading-overview.png\"\n  srcDark=\"/docs/dark/loading-overview.png\"\n  width=\"1600\"\n  height=\"768\"\n/>\n\nThis approach works well for route segments (layouts and pages), but for more granular streaming, you can use `<Suspense>`."
  },
  {
    "id": "07-fetching-data.mdx#17",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "### With `<Suspense>`\n\n`<Suspense>` allows you to be more granular about what parts of the page to stream. For example, you can immediately show any page content that falls outside of the `<Suspense>` boundary, and stream in the list of blog posts inside the boundary.\n\n```tsx filename=\"app/blog/page.tsx\" switcher\nimport { Suspense } from 'react'\nimport BlogList from '@/components/BlogList'\nimport BlogListSkeleton from '@/components/BlogListSkeleton'\n\nexport default function BlogPage() {\n  return (\n    <div>\n      {/* This content will be sent to the client immediately */}\n      <header>\n        <h1>Welcome to the Blog</h1>\n        <p>Read the latest posts below.</p>\n      </header>\n      <main>\n        {/* If there's any dynamic content inside this boundary, it will be streamed in */}\n        <Suspense fallback={<BlogListSkeleton />}>\n          <BlogList />\n        </Suspense>\n      </main>\n    </div>\n  )\n}"
  },
  {
    "id": "07-fetching-data.mdx#18",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\n```jsx filename=\"app/blog/page.js\" switcher\nimport { Suspense } from 'react'\nimport BlogList from '@/components/BlogList'\nimport BlogListSkeleton from '@/components/BlogListSkeleton'\n\nexport default function BlogPage() {\n  return (\n    <div>\n      {/* This content will be sent to the client immediately */}\n      <header>\n        <h1>Welcome to the Blog</h1>\n        <p>Read the latest posts below.</p>\n      </header>\n      <main>\n        {/* If there's any dynamic content inside this boundary, it will be streamed in */}\n        <Suspense fallback={<BlogListSkeleton />}>\n          <BlogList />\n        </Suspense>\n      </main>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "07-fetching-data.mdx#19",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "### Creating meaningful loading states\n\nAn instant loading state is fallback UI that is shown immediately to the user after navigation. For the best user experience, we recommend designing loading states that are meaningful and help users understand the app is responding. For example, you can use skeletons and spinners, or a small but meaningful part of future screens such as a cover photo, title, etc.\n\nIn development, you can preview and inspect the loading state of your components using the [React Devtools](https://react.dev/learn/react-developer-tools)."
  },
  {
    "id": "07-fetching-data.mdx#20",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "## Examples"
  },
  {
    "id": "07-fetching-data.mdx#21",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "### Sequential data fetching\n\nSequential data fetching happens when one request depends on data from another.\n\nFor example, `<Playlists>` can only fetch data after `<Artist>` completes because it needs the `artistID`:\n\n```tsx filename=\"app/artist/[username]/page.tsx\" switcher\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ username: string }>\n}) {\n  const { username } = await params\n  // Get artist information\n  const artist = await getArtist(username)\n\n  return (\n    <>\n      <h1>{artist.name}</h1>\n      {/* Show fallback UI while the Playlists component is loading */}\n      <Suspense fallback={<div>Loading...</div>}>\n        {/* Pass the artist ID to the Playlists component */}\n        <Playlists artistID={artist.id} />\n      </Suspense>\n    </>\n  )\n}\n\nasync function Playlists({ artistID }: { artistID: string }) {\n  // Use the artist ID to fetch playlists\n  const playlists = await getArtistPlaylists(artistID)\n\n  return (\n    <ul>\n      {playlists.map((playlist) => (\n        <li key={playlist.id}>{playlist.name}</li>\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "07-fetching-data.mdx#22",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\n```jsx filename=\"app/artist/[username]/page.js\" switcher\nexport default async function Page({ params }) {\n  const { username } = await params\n  // Get artist information\n  const artist = await getArtist(username)\n\n  return (\n    <>\n      <h1>{artist.name}</h1>\n      {/* Show fallback UI while the Playlists component is loading */}\n      <Suspense fallback={<div>Loading...</div>}>\n        {/* Pass the artist ID to the Playlists component */}\n        <Playlists artistID={artist.id} />\n      </Suspense>\n    </>\n  )\n}\n\nasync function Playlists({ artistID }) {\n  // Use the artist ID to fetch playlists\n  const playlists = await getArtistPlaylists(artistID)\n\n  return (\n    <ul>\n      {playlists.map((playlist) => (\n        <li key={playlist.id}>{playlist.name}</li>\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "07-fetching-data.mdx#23",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\nIn this example, `<Suspense>` allows the playlists to stream in after the artist data loads. However, the page still waits for the artist data before displaying anything. To prevent this, you can wrap the entire page component in a `<Suspense>` boundary (for example, using a [`loading.js` file](#with-loadingjs)) to show a loading state immediately.\n\nEnsure your data source can resolve the first request quickly, as it blocks everything else. If you can't optimize the request further, consider [caching](#deduplicate-requests-and-cache-data) the result if the data changes infrequently."
  },
  {
    "id": "07-fetching-data.mdx#24",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "### Parallel data fetching\n\nParallel data fetching happens when data requests in a route are eagerly initiated and start at the same time.\n\nBy default, [layouts and pages](/docs/app/getting-started/layouts-and-pages) are rendered in parallel. So each segment starts fetching data as soon as possible.\n\nHowever, within _any_ component, multiple `async`/`await` requests can still be sequential if placed after the other. For example, `getAlbums` will be blocked until `getArtist` is resolved:\n\n```tsx filename=\"app/artist/[username]/page.tsx\" switcher\nimport { getArtist, getAlbums } from '@/app/lib/data'\n\nexport default async function Page({ params }) {\n  // These requests will be sequential\n  const { username } = await params\n  const artist = await getArtist(username)\n  const albums = await getAlbums(username)\n  return <div>{artist.name}</div>\n}"
  },
  {
    "id": "07-fetching-data.mdx#25",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\nStart multiple requests by calling `fetch`, then await them with [`Promise.all`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all). Requests begin as soon as `fetch` is called.\n\n```tsx filename=\"app/artist/[username]/page.tsx\" highlight={3,8,23} switcher\nimport Albums from './albums'\n\nasync function getArtist(username: string) {\n  const res = await fetch(`https://api.example.com/artist/${username}`)\n  return res.json()\n}\n\nasync function getAlbums(username: string) {\n  const res = await fetch(`https://api.example.com/artist/${username}/albums`)\n  return res.json()\n}\n\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ username: string }>\n}) {\n  const { username } = await params\n\n  // Initiate requests\n  const artistData = getArtist(username)\n  const albumsData = getAlbums(username)\n\n  const [artist, albums] = await Promise.all([artistData, albumsData])\n\n  return (\n    <>\n      <h1>{artist.name}</h1>\n      <Albums list={albums} />\n    </>\n  )\n}"
  },
  {
    "id": "07-fetching-data.mdx#26",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\n```jsx filename=\"app/artist/[username]/page.js\" highlight={3,8,19} switcher\nimport Albums from './albums'\n\nasync function getArtist(username) {\n  const res = await fetch(`https://api.example.com/artist/${username}`)\n  return res.json()\n}\n\nasync function getAlbums(username) {\n  const res = await fetch(`https://api.example.com/artist/${username}/albums`)\n  return res.json()\n}\n\nexport default async function Page({ params }) {\n  const { username } = await params\n\n  // Initiate requests\n  const artistData = getArtist(username)\n  const albumsData = getAlbums(username)\n\n  const [artist, albums] = await Promise.all([artistData, albumsData])\n\n  return (\n    <>\n      <h1>{artist.name}</h1>\n      <Albums list={albums} />\n    </>\n  )\n}\n```\n\n> **Good to know:** If one request fails when using `Promise.all`, the entire operation will fail. To handle this, you can use the [`Promise.allSettled`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/allSettled) method instead."
  },
  {
    "id": "07-fetching-data.mdx#27",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "### Preloading data\n\nYou can preload data by creating an utility function that you eagerly call above blocking requests. `<Item>` conditionally renders based on the `checkIsAvailable()` function.\n\nYou can call `preload()` before `checkIsAvailable()` to eagerly initiate `<Item/>` data dependencies. By the time `<Item/>` is rendered, its data has already been fetched.\n\n```tsx filename=\"app/item/[id]/page.tsx\" switcher\nimport { getItem, checkIsAvailable } from '@/lib/data'\n\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n  // starting loading item data\n  preload(id)\n  // perform another asynchronous task\n  const isAvailable = await checkIsAvailable()\n\n  return isAvailable ? <Item id={id} /> : null\n}\n\nconst preload = (id: string) => {\n  // void evaluates the given expression and returns undefined\n  // https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/void\n  void getItem(id)\n}\n\nexport async function Item({ id }: { id: string }) {\n  const result = await getItem(id)\n  // ...\n}"
  },
  {
    "id": "07-fetching-data.mdx#28",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\n```jsx filename=\"app/item/[id]/page.js\" switcher\nimport { getItem, checkIsAvailable } from '@/lib/data'\n\nexport default async function Page({ params }) {\n  const { id } = await params\n  // starting loading item data\n  preload(id)\n  // perform another asynchronous task\n  const isAvailable = await checkIsAvailable()\n\n  return isAvailable ? <Item id={id} /> : null\n}\n\nconst preload = (id) => {\n  // void evaluates the given expression and returns undefined\n  // https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/void\n  void getItem(id)\n}\n\nexport async function Item({ id }) {\n  const result = await getItem(id)\n  // ..."
  },
  {
    "id": "07-fetching-data.mdx#29",
    "metadata": {
      "title": "Fetching Data",
      "description": "Learn how to fetch data and stream content that depends on data."
    },
    "content": "```\n\nAdditionally, you can use React's [`cache` function](https://react.dev/reference/react/cache) and the [`server-only` package](https://www.npmjs.com/package/server-only) to create a reusable utility function. This approach allows you to cache the data fetching function and ensure that it's only executed on the server.\n\n```ts filename=\"utils/get-item.ts\" switcher\nimport { cache } from 'react'\nimport 'server-only'\nimport { getItem } from '@/lib/data'\n\nexport const preload = (id: string) => {\n  void getItem(id)\n}\n\nexport const getItem = cache(async (id: string) => {\n  // ...\n})\n```\n\n```js filename=\"utils/get-item.js\" switcher\nimport { cache } from 'react'\nimport 'server-only'\nimport { getItem } from '@/lib/data'\n\nexport const preload = (id) => {\n  void getItem(id)\n}\n\nexport const getItem = cache(async (id) => {\n  // ...\n})\n```"
  },
  {
    "id": "08-updating-data.mdx#0",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "---\ntitle: Updating Data\ndescription: Learn how to mutate data using Server Functions.\nrelated:\n  title: API Reference\n  description: Learn more about the features mentioned in this page by reading the API Reference.\n  links:\n    - app/api-reference/functions/revalidatePath\n    - app/api-reference/functions/revalidateTag\n    - app/api-reference/functions/redirect\n---\n\nYou can update data in Next.js using React's [Server Functions](https://react.dev/reference/rsc/server-functions). This page will go through how you can [create](#creating-server-functions) and [invoke](#invoking-server-functions) Server Functions."
  },
  {
    "id": "08-updating-data.mdx#1",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "## What are Server Functions?\n\nA **Server Function** is an asynchronous function that runs on the server. They can be called from the client through a network request, which is why they must be asynchronous.\n\nIn an `action` or mutation context, they are also called **Server Actions**.\n\nBy convention, a Server Action is an async function used with [`startTransition`](https://react.dev/reference/react/startTransition). This happens automatically when the function is:\n\n- Passed to a `<form>` using the `action` prop.\n- Passed to a `<button>` using the `formAction` prop.\n\nIn Next.js, Server Actions integrate with the framework's [caching](/docs/app/guides/caching) architecture. When an action is invoked, Next.js can return both the updated UI and new data in a single server roundtrip.\n\nBehind the scenes, actions use the `POST` method, and only this HTTP method can invoke them."
  },
  {
    "id": "08-updating-data.mdx#2",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "## Creating Server Functions\n\nA Server Function can be defined by using the [`use server`](https://react.dev/reference/rsc/use-server) directive. You can place the directive at the top of an **asynchronous** function to mark the function as a Server Function, or at the top of a separate file to mark all exports of that file.\n\n```ts filename=\"app/lib/actions.ts\" switcher\nexport async function createPost(formData: FormData) {\n  'use server'\n  const title = formData.get('title')\n  const content = formData.get('content')\n\n  // Update data\n  // Revalidate cache\n}\n\nexport async function deletePost(formData: FormData) {\n  'use server'\n  const id = formData.get('id')\n\n  // Update data\n  // Revalidate cache\n}\n```\n\n```js filename=\"app/lib/actions.js\" switcher\nexport async function createPost(formData) {\n  'use server'\n  const title = formData.get('title')\n  const content = formData.get('content')\n\n  // Update data\n  // Revalidate cache\n}\n\nexport async function deletePost(formData) {\n  'use server'\n  const id = formData.get('id')\n\n  // Update data\n  // Revalidate cache\n}\n```"
  },
  {
    "id": "08-updating-data.mdx#3",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "### Server Components\n\nServer Functions can be inlined in Server Components by adding the `\"use server\"` directive to the top of the function body:\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default function Page() {\n  // Server Action\n  async function createPost(formData: FormData) {\n    'use server'\n    // ...\n  }\n\n  return <></>\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nexport default function Page() {\n  // Server Action\n  async function createPost(formData: FormData) {\n    'use server'\n    // ...\n  }\n\n  return <></>\n}\n```\n\n> **Good to know:** Server Components support progressive enhancement by default, meaning forms that call Server Actions will be submitted even if JavaScript hasn't loaded yet or is disabled."
  },
  {
    "id": "08-updating-data.mdx#4",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "### Client Components\n\nIt's not possible to define Server Functions in Client Components. However, you can invoke them in Client Components by importing them from a file that has the `\"use server\"` directive at the top of it:\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nexport async function createPost() {}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nexport async function createPost() {}\n```\n\n```tsx filename=\"app/ui/button.tsx\" switcher\n'use client'\n\nimport { createPost } from '@/app/actions'\n\nexport function Button() {\n  return <button formAction={createPost}>Create</button>\n}\n```\n\n```jsx filename=\"app/ui/button.js\" switcher\n'use client'\n\nimport { createPost } from '@/app/actions'\n\nexport function Button() {\n  return <button formAction={createPost}>Create</button>\n}\n```\n\n> **Good to know:** In Client Components, forms invoking Server Actions will queue submissions if JavaScript isn't loaded yet, and will be prioritized for hydration. After hydration, the browser does not refresh on form submission."
  },
  {
    "id": "08-updating-data.mdx#5",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "### Passing actions as props\n\nYou can also pass an action to a Client Component as a prop:\n\n```jsx\n<ClientComponent updateItemAction={updateItem} />\n```\n\n```tsx filename=\"app/client-component.tsx\" switcher\n'use client'\n\nexport default function ClientComponent({\n  updateItemAction,\n}: {\n  updateItemAction: (formData: FormData) => void\n}) {\n  return <form action={updateItemAction}>{/* ... */}</form>\n}\n```\n\n```jsx filename=\"app/client-component.js\" switcher\n'use client'\n\nexport default function ClientComponent({ updateItemAction }) {\n  return <form action={updateItemAction}>{/* ... */}</form>\n}\n```"
  },
  {
    "id": "08-updating-data.mdx#6",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "## Invoking Server Functions\n\nThere are two main ways you can invoke a Server Function:\n\n1. [Forms](#forms) in Server and Client Components\n2. [Event Handlers](#event-handlers) and [useEffect](#useeffect) in Client Components\n\n> **Good to know:** Server Functions are designed for server-side mutations. The client currently dispatches and awaits them one at a time. This is an implementation detail and may change. If you need parallel data fetching, use [data fetching](/docs/app/getting-started/fetching-data#server-components) in Server Components, or perform parallel work inside a single Server Function or [Route Handler](/docs/app/guides/backend-for-frontend#manipulating-data)."
  },
  {
    "id": "08-updating-data.mdx#7",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "### Forms\n\nReact extends the HTML [`<form>`](https://react.dev/reference/react-dom/components/form) element to allow a Server Function to be invoked with the HTML `action` prop.\n\nWhen invoked in a form, the function automatically receives the [`FormData`](https://developer.mozilla.org/docs/Web/API/FormData/FormData) object. You can extract the data using the native [`FormData` methods](https://developer.mozilla.org/en-US/docs/Web/API/FormData#instance_methods):\n\n```tsx filename=\"app/ui/form.tsx\" switcher\nimport { createPost } from '@/app/actions'\n\nexport function Form() {\n  return (\n    <form action={createPost}>\n      <input type=\"text\" name=\"title\" />\n      <input type=\"text\" name=\"content\" />\n      <button type=\"submit\">Create</button>\n    </form>\n  )\n}\n```\n\n```jsx filename=\"app/ui/form.js\" switcher\nimport { createPost } from '@/app/actions'\n\nexport function Form() {\n  return (\n    <form action={createPost}>\n      <input type=\"text\" name=\"title\" />\n      <input type=\"text\" name=\"content\" />\n      <button type=\"submit\">Create</button>\n    </form>\n  )\n}"
  },
  {
    "id": "08-updating-data.mdx#8",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "```\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nexport async function createPost(formData: FormData) {\n  const title = formData.get('title')\n  const content = formData.get('content')\n\n  // Update data\n  // Revalidate cache\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nexport async function createPost(formData) {\n  const title = formData.get('title')\n  const content = formData.get('content')\n\n  // Update data\n  // Revalidate cache\n}\n```"
  },
  {
    "id": "08-updating-data.mdx#9",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "### Event Handlers\n\nYou can invoke a Server Function in a Client Component by using event handlers such as `onClick`.\n\n```tsx filename=\"app/like-button.tsx\" switcher\n'use client'\n\nimport { incrementLike } from './actions'\nimport { useState } from 'react'\n\nexport default function LikeButton({ initialLikes }: { initialLikes: number }) {\n  const [likes, setLikes] = useState(initialLikes)\n\n  return (\n    <>\n      <p>Total Likes: {likes}</p>\n      <button\n        onClick={async () => {\n          const updatedLikes = await incrementLike()\n          setLikes(updatedLikes)\n        }}\n      >\n        Like\n      </button>\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/like-button.js\" switcher\n'use client'\n\nimport { incrementLike } from './actions'\nimport { useState } from 'react'\n\nexport default function LikeButton({ initialLikes }) {\n  const [likes, setLikes] = useState(initialLikes)\n\n  return (\n    <>\n      <p>Total Likes: {likes}</p>\n      <button\n        onClick={async () => {\n          const updatedLikes = await incrementLike()\n          setLikes(updatedLikes)\n        }}\n      >\n        Like\n      </button>\n    </>\n  )\n}\n```"
  },
  {
    "id": "08-updating-data.mdx#10",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "## Examples\n\n### Showing a pending state\n\nWhile executing a Server Function, you can show a loading indicator with React's [`useActionState`](https://react.dev/reference/react/useActionState) hook. This hook returns a `pending` boolean:\n\n```tsx filename=\"app/ui/button.tsx\" switcher\n'use client'\n\nimport { useActionState, startTransition } from 'react'\nimport { createPost } from '@/app/actions'\nimport { LoadingSpinner } from '@/app/ui/loading-spinner'\n\nexport function Button() {\n  const [state, action, pending] = useActionState(createPost, false)\n\n  return (\n    <button onClick={() => startTransition(action)}>\n      {pending ? <LoadingSpinner /> : 'Create Post'}\n    </button>\n  )\n}\n```\n\n```jsx filename=\"app/ui/button.js\" switcher\n'use client'\n\nimport { useActionState, startTransition } from 'react'\nimport { createPost } from '@/app/actions'\nimport { LoadingSpinner } from '@/app/ui/loading-spinner'\n\nexport function Button() {\n  const [state, action, pending] = useActionState(createPost, false)\n\n  return (\n    <button onClick={() => startTransition(action)}>\n      {pending ? <LoadingSpinner /> : 'Create Post'}\n    </button>\n  )\n}\n```"
  },
  {
    "id": "08-updating-data.mdx#11",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "### Refreshing\n\nAfter a mutation, you may want to refresh the current page to show the latest data. You can do this by calling [`refresh`](/docs/app/api-reference/functions/refresh) from `next/cache` in a Server Action:\n\n```ts filename=\"app/lib/actions.ts\" switcher\n'use server'\n\nimport { refresh } from 'next/cache'\n\nexport async function updatePost(formData: FormData) {\n  // Update data\n  // ...\n\n  refresh()\n}\n```\n\n```js filename=\"app/lib/actions.js\" switcher\n'use server'\n\nimport { refresh } from 'next/cache'\n\nexport async function updatePost(formData) {\n  // Update data\n  // ...\n\n  refresh()\n}\n```\n\nThis refreshes the client router, ensuring the UI reflects the latest state. The `refresh()` function does not revalidate tagged data. To revalidate tagged data, use [`updateTag`](/docs/app/api-reference/functions/updateTag) or [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) instead."
  },
  {
    "id": "08-updating-data.mdx#12",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "### Revalidating\n\nAfter performing an update, you can revalidate the Next.js cache and show the updated data by calling [`revalidatePath`](/docs/app/api-reference/functions/revalidatePath) or [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) within the Server Function:\n\n```ts filename=\"app/lib/actions.ts\" switcher\nimport { revalidatePath } from 'next/cache'\n\nexport async function createPost(formData: FormData) {\n  'use server'\n  // Update data\n  // ...\n\n  revalidatePath('/posts')\n}\n```\n\n```js filename=\"app/actions.js\" switcher\nimport { revalidatePath } from 'next/cache'\n\nexport async function createPost(formData) {\n  'use server'\n  // Update data\n  // ...\n  revalidatePath('/posts')\n}\n```"
  },
  {
    "id": "08-updating-data.mdx#13",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "### Redirecting\n\nYou may want to redirect the user to a different page after performing an update. You can do this by calling [`redirect`](/docs/app/api-reference/functions/redirect) within the Server Function.\n\n```ts filename=\"app/lib/actions.ts\" switcher\n'use server'\n\nimport { revalidatePath } from 'next/cache'\nimport { redirect } from 'next/navigation'\n\nexport async function createPost(formData: FormData) {\n  // Update data\n  // ...\n\n  revalidatePath('/posts')\n  redirect('/posts')\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { revalidatePath } from 'next/cache'\nimport { redirect } from 'next/navigation'\n\nexport async function createPost(formData) {\n  // Update data\n  // ...\n\n  revalidatePath('/posts')\n  redirect('/posts')\n}\n```\n\nCalling `redirect` [throws](/docs/app/api-reference/functions/redirect#behavior) a framework handled control-flow exception. Any code after it won't execute. If you need fresh data, call [`revalidatePath`](/docs/app/api-reference/functions/revalidatePath) or [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) beforehand."
  },
  {
    "id": "08-updating-data.mdx#14",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "### Cookies\n\nYou can `get`, `set`, and `delete` cookies inside a Server Action using the [`cookies`](/docs/app/api-reference/functions/cookies) API.\n\nWhen you [set or delete](/docs/app/api-reference/functions/cookies#understanding-cookie-behavior-in-server-actions) a cookie in a Server Action, Next.js re-renders the current page and its layouts on the server so the **UI reflects the new cookie value**.\n\n> **Good to know**: The server update applies to the current React tree, re-rendering, mounting, or unmounting components, as needed. Client state is preserved for re-rendered components, and effects re-run if their dependencies changed.\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { cookies } from 'next/headers'\n\nexport async function exampleAction() {\n  const cookieStore = await cookies()\n\n  // Get cookie\n  cookieStore.get('name')?.value\n\n  // Set cookie\n  cookieStore.set('name', 'Delba')\n\n  // Delete cookie\n  cookieStore.delete('name')\n}"
  },
  {
    "id": "08-updating-data.mdx#15",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { cookies } from 'next/headers'\n\nexport async function exampleAction() {\n  // Get cookie\n  const cookieStore = await cookies()\n\n  // Get cookie\n  cookieStore.get('name')?.value\n\n  // Set cookie\n  cookieStore.set('name', 'Delba')\n\n  // Delete cookie\n  cookieStore.delete('name')\n}\n```"
  },
  {
    "id": "08-updating-data.mdx#16",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "### useEffect\n\nYou can use the React [`useEffect`](https://react.dev/reference/react/useEffect) hook to invoke a Server Action when the component mounts or a dependency changes. This is useful for mutations that depend on global events or need to be triggered automatically. For example, `onKeyDown` for app shortcuts, an intersection observer hook for infinite scrolling, or when the component mounts to update a view count:\n\n```tsx filename=\"app/view-count.tsx\" switcher\n'use client'\n\nimport { incrementViews } from './actions'\nimport { useState, useEffect, useTransition } from 'react'\n\nexport default function ViewCount({ initialViews }: { initialViews: number }) {\n  const [views, setViews] = useState(initialViews)\n  const [isPending, startTransition] = useTransition()\n\n  useEffect(() => {\n    startTransition(async () => {\n      const updatedViews = await incrementViews()\n      setViews(updatedViews)\n    })\n  }, [])\n\n  // You can use `isPending` to give users feedback\n  return <p>Total Views: {views}</p>\n}"
  },
  {
    "id": "08-updating-data.mdx#17",
    "metadata": {
      "title": "Updating Data",
      "description": "Learn how to mutate data using Server Functions."
    },
    "content": "```\n\n```jsx filename=\"app/view-count.js\" switcher\n'use client'\n\nimport { incrementViews } from './actions'\nimport { useState, useEffect, useTransition } from 'react'\n\nexport default function ViewCount({ initialViews }) {\n  const [views, setViews] = useState(initialViews)\n  const [isPending, startTransition] = useTransition()\n\n  useEffect(() => {\n    startTransition(async () => {\n      const updatedViews = await incrementViews()\n      setViews(updatedViews)\n    })\n  }, [])\n\n  // You can use `isPending` to give users feedback\n  return <p>Total Views: {views}</p>\n}\n```"
  },
  {
    "id": "09-caching-and-revalidating.mdx#0",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "---\ntitle: Caching and Revalidating\ndescription: Learn how to cache and revalidate data in your application.\nrelated:\n  title: API Reference\n  description: Learn more about the features mentioned in this page by reading the API Reference.\n  links:\n    - app/api-reference/functions/fetch\n    - app/api-reference/functions/cacheTag\n    - app/api-reference/functions/revalidateTag\n    - app/api-reference/functions/updateTag\n    - app/api-reference/functions/revalidatePath\n    - app/api-reference/functions/unstable_cache\n---\n\nCaching is a technique for storing the result of data fetching and other computations so that future requests for the same data can be served faster, without doing the work again. While revalidation allows you to update cache entries without having to rebuild your entire application.\n\nNext.js provides a few APIs to handle caching and revalidation. This guide will walk you through when and how to use them.\n\n- [`fetch`](#fetch)\n- [`cacheTag`](#cachetag)\n- [`revalidateTag`](#revalidatetag)\n- [`updateTag`](#updatetag)\n- [`revalidatePath`](#revalidatepath)\n- [`unstable_cache`](#unstable_cache) (Legacy)"
  },
  {
    "id": "09-caching-and-revalidating.mdx#1",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "## `fetch`\n\nBy default, [`fetch`](/docs/app/api-reference/functions/fetch) requests are not cached. You can cache individual requests by setting the `cache` option to `'force-cache'`.\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default async function Page() {\n  const data = await fetch('https://...', { cache: 'force-cache' })\n}\n```\n\n```jsx filename=\"app/page.jsx\" switcher\nexport default async function Page() {\n  const data = await fetch('https://...', { cache: 'force-cache' })\n}\n```\n\n> **Good to know**: Although `fetch` requests are not cached by default, Next.js will [pre-render](/docs/app/guides/caching#static-rendering) routes that have `fetch` requests and cache the HTML. If you want to guarantee a route is [dynamic](/docs/app/guides/caching#dynamic-rendering), use the [`connection` API](/docs/app/api-reference/functions/connection).\n\nTo revalidate the data returned by a `fetch` request, you can use the `next.revalidate` option.\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default async function Page() {\n  const data = await fetch('https://...', { next: { revalidate: 3600 } })\n}"
  },
  {
    "id": "09-caching-and-revalidating.mdx#2",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "```\n\n```jsx filename=\"app/page.jsx\" switcher\nexport default async function Page() {\n  const data = await fetch('https://...', { next: { revalidate: 3600 } })\n}\n```\n\nThis will revalidate the data after a specified amount of seconds.\n\nYou can also tag `fetch` requests to enable on-demand cache invalidation:\n\n```tsx filename=\"app/lib/data.ts\" switcher\nexport async function getUserById(id: string) {\n  const data = await fetch(`https://...`, {\n    next: {\n      tags: ['user'],\n    },\n  })\n}\n```\n\n```jsx filename=\"app/lib/data.js\" switcher\nexport async function getUserById(id) {\n  const data = await fetch(`https://...`, {\n    next: {\n      tags: ['user'],\n    },\n  })\n}\n```\n\nSee the [`fetch` API reference](/docs/app/api-reference/functions/fetch) to learn more."
  },
  {
    "id": "09-caching-and-revalidating.mdx#3",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "## `cacheTag`\n\n[`cacheTag`](/docs/app/api-reference/functions/cacheTag) allows you to tag cached data in [Cache Components](/docs/app/getting-started/cache-components) so it can be revalidated on-demand. Previously, cache tagging was limited to `fetch` requests, and caching other work required the experimental `unstable_cache` API.\n\nWith Cache Components, you can use the [`use cache`](/docs/app/api-reference/directives/use-cache) directive to cache any computation, and `cacheTag` to tag it. This works with database queries, file system operations, and other server-side work.\n\n```tsx filename=\"app/lib/data.ts\" switcher\nimport { cacheTag } from 'next/cache'\n\nexport async function getProducts() {\n  'use cache'\n  cacheTag('products')\n\n  const products = await db.query('SELECT * FROM products')\n  return products\n}\n```\n\n```jsx filename=\"app/lib/data.js\" switcher\nimport { cacheTag } from 'next/cache'\n\nexport async function getProducts() {\n  'use cache'\n  cacheTag('products')\n\n  const products = await db.query('SELECT * FROM products')\n  return products\n}"
  },
  {
    "id": "09-caching-and-revalidating.mdx#4",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "```\n\nOnce tagged, you can use [`revalidateTag`](#revalidatetag) or [`updateTag`](#updatetag) to invalidate the cache entry for products.\n\n> **Good to know**: `cacheTag` is used with [Cache Components](/docs/app/getting-started/cache-components) and the [`use cache`](/docs/app/api-reference/directives/use-cache) directive. It expands the caching and revalidation story beyond `fetch`.\n\nSee the [`cacheTag` API reference](/docs/app/api-reference/functions/cacheTag) to learn more."
  },
  {
    "id": "09-caching-and-revalidating.mdx#5",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "## `revalidateTag`\n\n`revalidateTag` is used to revalidate cache entries based on a tag and following an event. The function now supports two behaviors:\n\n- **With `profile=\"max\"`**: Uses stale-while-revalidate semantics, serving stale content while fetching fresh content in the background\n- **Without the second argument**: Legacy behavior that immediately expires the cache (deprecated)\n\nAfter tagging your cached data, using [`fetch`](#fetch) with `next.tags`, or the [`cacheTag`](#cachetag) function, you may call `revalidateTag` in a [Route Handler](/docs/app/api-reference/file-conventions/route) or Server Action:\n\n```tsx filename=\"app/lib/actions.ts\" highlight={1,5} switcher\nimport { revalidateTag } from 'next/cache'\n\nexport async function updateUser(id: string) {\n  // Mutate data\n  revalidateTag('user', 'max') // Recommended: Uses stale-while-revalidate\n}\n```\n\n```jsx filename=\"app/lib/actions.js\" highlight={1,5} switcher\nimport { revalidateTag } from 'next/cache'\n\nexport async function updateUser(id) {\n  // Mutate data\n  revalidateTag('user', 'max') // Recommended: Uses stale-while-revalidate\n}"
  },
  {
    "id": "09-caching-and-revalidating.mdx#6",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "```\n\nYou can reuse the same tag in multiple functions to revalidate them all at once.\n\nSee the [`revalidateTag` API reference](/docs/app/api-reference/functions/revalidateTag) to learn more."
  },
  {
    "id": "09-caching-and-revalidating.mdx#7",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "## `updateTag`\n\n`updateTag` is specifically designed for Server Actions to immediately expire cached data for read-your-own-writes scenarios. Unlike `revalidateTag`, it can only be used within Server Actions and immediately expires the cache entry.\n\n```tsx filename=\"app/lib/actions.ts\" highlight={1,6} switcher\nimport { updateTag } from 'next/cache'\nimport { redirect } from 'next/navigation'\n\nexport async function createPost(formData: FormData) {\n  // Create post in database\n  const post = await db.post.create({\n    data: {\n      title: formData.get('title'),\n      content: formData.get('content'),\n    },\n  })\n\n  // Immediately expire cache so the new post is visible\n  updateTag('posts')\n  updateTag(`post-${post.id}`)\n\n  redirect(`/posts/${post.id}`)\n}"
  },
  {
    "id": "09-caching-and-revalidating.mdx#8",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "```\n\n```jsx filename=\"app/lib/actions.js\" highlight={1,6} switcher\nimport { updateTag } from 'next/cache'\nimport { redirect } from 'next/navigation'\n\nexport async function createPost(formData) {\n  // Create post in database\n  const post = await db.post.create({\n    data: {\n      title: formData.get('title'),\n      content: formData.get('content'),\n    },\n  })\n\n  // Immediately expire cache so the new post is visible\n  updateTag('posts')\n  updateTag(`post-${post.id}`)\n\n  redirect(`/posts/${post.id}`)\n}\n```\n\nThe key differences between `revalidateTag` and `updateTag`:\n\n- **`updateTag`**: Only in Server Actions, immediately expires cache, for read-your-own-writes\n- **`revalidateTag`**: In Server Actions and Route Handlers, supports stale-while-revalidate with `profile=\"max\"`\n\nSee the [`updateTag` API reference](/docs/app/api-reference/functions/updateTag) to learn more."
  },
  {
    "id": "09-caching-and-revalidating.mdx#9",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "## `revalidatePath`\n\n`revalidatePath` is used to revalidate a route and following an event. To use it, call it in a [Route Handler](/docs/app/api-reference/file-conventions/route) or Server Action:\n\n```tsx filename=\"app/lib/actions.ts\" highlight={1} switcher\nimport { revalidatePath } from 'next/cache'\n\nexport async function updateUser(id: string) {\n  // Mutate data\n  revalidatePath('/profile')\n```\n\n```jsx filename=\"app/lib/actions.js\" highlight={1} switcher\nimport { revalidatePath } from 'next/cache'\n\nexport async function updateUser(id) {\n  // Mutate data\n  revalidatePath('/profile')\n```\n\nSee the [`revalidatePath` API reference](/docs/app/api-reference/functions/revalidatePath) to learn more."
  },
  {
    "id": "09-caching-and-revalidating.mdx#10",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "## `unstable_cache`\n\n> **Good to know**: `unstable_cache` is an experimental API. We recommend opting into [Cache Components](/docs/app/getting-started/cache-components) and replacing `unstable_cache` with the [`use cache`](/docs/app/api-reference/directives/use-cache) directive. See the [Cache Components documentation](/docs/app/getting-started/cache-components) for more details.\n\n`unstable_cache` allows you to cache the result of database queries and other async functions. To use it, wrap `unstable_cache` around the function. For example:\n\n```ts filename=\"app/lib/data.ts\" switcher\nimport { db } from '@/lib/db'\nexport async function getUserById(id: string) {\n  return db\n    .select()\n    .from(users)\n    .where(eq(users.id, id))\n    .then((res) => res[0])\n}\n```\n\n```jsx filename=\"app/lib/data.js\" switcher\nimport { db } from '@/lib/db'\n\nexport async function getUserById(id) {\n  return db\n    .select()\n    .from(users)\n    .where(eq(users.id, id))\n    .then((res) => res[0])\n}"
  },
  {
    "id": "09-caching-and-revalidating.mdx#11",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "```\n\n```tsx filename=\"app/page.tsx\" highlight={2,11,13} switcher\nimport { unstable_cache } from 'next/cache'\nimport { getUserById } from '@/app/lib/data'\n\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ userId: string }>\n}) {\n  const { userId } = await params\n\n  const getCachedUser = unstable_cache(\n    async () => {\n      return getUserById(userId)\n    },\n    [userId] // add the user ID to the cache key\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" highlight={2,7,9} switcher\nimport { unstable_cache } from 'next/cache'\nimport { getUserById } from '@/app/lib/data'\n\nexport default async function Page({ params }) {\n  const { userId } = await params\n\n  const getCachedUser = unstable_cache(\n    async () => {\n      return getUserById(userId)\n    },\n    [userId] // add the user ID to the cache key\n  )\n}"
  },
  {
    "id": "09-caching-and-revalidating.mdx#12",
    "metadata": {
      "title": "Caching and Revalidating",
      "description": "Learn how to cache and revalidate data in your application."
    },
    "content": "```\n\nThe function accepts a third optional object to define how the cache should be revalidated. It accepts:\n\n- `tags`: an array of tags used by Next.js to revalidate the cache.\n- `revalidate`: the number of seconds after cache should be revalidated.\n\n```tsx filename=\"app/page.tsx\" highlight={6-9} switcher\nconst getCachedUser = unstable_cache(\n  async () => {\n    return getUserById(userId)\n  },\n  [userId],\n  {\n    tags: ['user'],\n    revalidate: 3600,\n  }\n)\n```\n\n```jsx filename=\"app/page.js\" highlight={6-9} switcher\nconst getCachedUser = unstable_cache(\n  async () => {\n    return getUserById(userId)\n  },\n  [userId],\n  {\n    tags: ['user'],\n    revalidate: 3600,\n  }\n)\n```\n\nSee the [`unstable_cache` API reference](/docs/app/api-reference/functions/unstable_cache) to learn more."
  },
  {
    "id": "10-error-handling.mdx#0",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "---\ntitle: Error Handling\ndescription: Learn how to display expected errors and handle uncaught exceptions.\nrelated:\n  title: API Reference\n  description: Learn more about the features mentioned in this page by reading the API Reference.\n  links:\n    - app/api-reference/functions/redirect\n    - app/api-reference/file-conventions/error\n    - app/api-reference/functions/not-found\n    - app/api-reference/file-conventions/not-found\n---\n\nErrors can be divided into two categories: [expected errors](#handling-expected-errors) and [uncaught exceptions](#handling-uncaught-exceptions). This page will walk you through how you can handle these errors in your Next.js application."
  },
  {
    "id": "10-error-handling.mdx#1",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "## Handling expected errors\n\nExpected errors are those that can occur during the normal operation of the application, such as those from [server-side form validation](/docs/app/guides/forms) or failed requests. These errors should be handled explicitly and returned to the client."
  },
  {
    "id": "10-error-handling.mdx#2",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "### Server Functions\n\nYou can use the [`useActionState`](https://react.dev/reference/react/useActionState) hook to handle expected errors in [Server Functions](https://react.dev/reference/rsc/server-functions).\n\nFor these errors, avoid using `try`/`catch` blocks and throw errors. Instead, model expected errors as return values.\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nexport async function createPost(prevState: any, formData: FormData) {\n  const title = formData.get('title')\n  const content = formData.get('content')\n\n  const res = await fetch('https://api.vercel.app/posts', {\n    method: 'POST',\n    body: { title, content },\n  })\n  const json = await res.json()\n\n  if (!res.ok) {\n    return { message: 'Failed to create post' }\n  }\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nexport async function createPost(prevState, formData) {\n  const title = formData.get('title')\n  const content = formData.get('content')\n\n  const res = await fetch('https://api.vercel.app/posts', {\n    method: 'POST',\n    body: { title, content },\n  })\n  const json = await res.json()\n\n  if (!res.ok) {\n    return { message: 'Failed to create post' }\n  }\n}"
  },
  {
    "id": "10-error-handling.mdx#3",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "```\n\nYou can pass your action to the `useActionState` hook and use the returned `state` to display an error message.\n\n```tsx filename=\"app/ui/form.tsx\" highlight={11,19} switcher\n'use client'\n\nimport { useActionState } from 'react'\nimport { createPost } from '@/app/actions'\n\nconst initialState = {\n  message: '',\n}\n\nexport function Form() {\n  const [state, formAction, pending] = useActionState(createPost, initialState)\n\n  return (\n    <form action={formAction}>\n      <label htmlFor=\"title\">Title</label>\n      <input type=\"text\" id=\"title\" name=\"title\" required />\n      <label htmlFor=\"content\">Content</label>\n      <textarea id=\"content\" name=\"content\" required />\n      {state?.message && <p aria-live=\"polite\">{state.message}</p>}\n      <button disabled={pending}>Create Post</button>\n    </form>\n  )\n}"
  },
  {
    "id": "10-error-handling.mdx#4",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "```\n\n```jsx filename=\"app/ui/form.js\" highlight={11,19} switcher\n'use client'\n\nimport { useActionState } from 'react'\nimport { createPost } from '@/app/actions'\n\nconst initialState = {\n  message: '',\n}\n\nexport function Form() {\n  const [state, formAction, pending] = useActionState(createPost, initialState)\n\n  return (\n    <form action={formAction}>\n      <label htmlFor=\"title\">Title</label>\n      <input type=\"text\" id=\"title\" name=\"title\" required />\n      <label htmlFor=\"content\">Content</label>\n      <textarea id=\"content\" name=\"content\" required />\n      {state?.message && <p aria-live=\"polite\">{state.message}</p>}\n      <button disabled={pending}>Create Post</button>\n    </form>\n  )\n}\n```"
  },
  {
    "id": "10-error-handling.mdx#5",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "### Server Components\n\nWhen fetching data inside of a Server Component, you can use the response to conditionally render an error message or [`redirect`](/docs/app/api-reference/functions/redirect).\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default async function Page() {\n  const res = await fetch(`https://...`)\n  const data = await res.json()\n\n  if (!res.ok) {\n    return 'There was an error.'\n  }\n\n  return '...'\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nexport default async function Page() {\n  const res = await fetch(`https://...`)\n  const data = await res.json()\n\n  if (!res.ok) {\n    return 'There was an error.'\n  }\n\n  return '...'\n}\n```"
  },
  {
    "id": "10-error-handling.mdx#6",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "### Not found\n\nYou can call the [`notFound`](/docs/app/api-reference/functions/not-found) function within a route segment and use the [`not-found.js`](/docs/app/api-reference/file-conventions/not-found) file to show a 404 UI.\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nimport { getPostBySlug } from '@/lib/posts'\n\nexport default async function Page({ params }: { params: { slug: string } }) {\n  const { slug } = await params\n  const post = getPostBySlug(slug)\n\n  if (!post) {\n    notFound()\n  }\n\n  return <div>{post.title}</div>\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nimport { getPostBySlug } from '@/lib/posts'\n\nexport default async function Page({ params }) {\n  const { slug } = await params\n  const post = getPostBySlug(slug)\n\n  if (!post) {\n    notFound()\n  }\n\n  return <div>{post.title}</div>\n}\n```\n\n```tsx filename=\"app/blog/[slug]/not-found.tsx\" switcher\nexport default function NotFound() {\n  return <div>404 - Page Not Found</div>\n}\n```\n\n```jsx filename=\"app/blog/[slug]/not-found.js\" switcher\nexport default function NotFound() {\n  return <div>404 - Page Not Found</div>\n}\n```"
  },
  {
    "id": "10-error-handling.mdx#7",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "## Handling uncaught exceptions\n\nUncaught exceptions are unexpected errors that indicate bugs or issues that should not occur during the normal flow of your application. These should be handled by throwing errors, which will then be caught by error boundaries."
  },
  {
    "id": "10-error-handling.mdx#8",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "### Nested error boundaries\n\nNext.js uses error boundaries to handle uncaught exceptions. Error boundaries catch errors in their child components and display a fallback UI instead of the component tree that crashed.\n\nCreate an error boundary by adding an [`error.js`](/docs/app/api-reference/file-conventions/error) file inside a route segment and exporting a React component:\n\n```tsx filename=\"app/dashboard/error.tsx\" switcher\n'use client' // Error boundaries must be Client Components\n\nimport { useEffect } from 'react'\n\nexport default function Error({\n  error,\n  reset,\n}: {\n  error: Error & { digest?: string }\n  reset: () => void\n}) {\n  useEffect(() => {\n    // Log the error to an error reporting service\n    console.error(error)\n  }, [error])\n\n  return (\n    <div>\n      <h2>Something went wrong!</h2>\n      <button\n        onClick={\n          // Attempt to recover by trying to re-render the segment\n          () => reset()\n        }\n      >\n        Try again\n      </button>\n    </div>\n  )\n}"
  },
  {
    "id": "10-error-handling.mdx#9",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/error.js\" switcher\n'use client' // Error boundaries must be Client Components\n\nimport { useEffect } from 'react'\n\nexport default function Error({ error, reset }) {\n  useEffect(() => {\n    // Log the error to an error reporting service\n    console.error(error)\n  }, [error])\n\n  return (\n    <div>\n      <h2>Something went wrong!</h2>\n      <button\n        onClick={\n          // Attempt to recover by trying to re-render the segment\n          () => reset()\n        }\n      >\n        Try again\n      </button>\n    </div>\n  )\n}"
  },
  {
    "id": "10-error-handling.mdx#10",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "```\n\nErrors will bubble up to the nearest parent error boundary. This allows for granular error handling by placing `error.tsx` files at different levels in the [route hierarchy](/docs/app/getting-started/project-structure#component-hierarchy).\n\n<Image\n  alt=\"Nested Error Component Hierarchy\"\n  srcLight=\"/docs/light/nested-error-component-hierarchy.png\"\n  srcDark=\"/docs/dark/nested-error-component-hierarchy.png\"\n  width=\"1600\"\n  height=\"687\"\n/>\n\nError boundaries don’t catch errors inside event handlers. They’re designed to catch errors [during rendering](https://react.dev/reference/react/Component#static-getderivedstatefromerror) to show a **fallback UI** instead of crashing the whole app.\n\nIn general, errors in event handlers or async code aren’t handled by error boundaries because they run after rendering.\n\nTo handle these cases, catch the error manually and store it using `useState` or `useReducer`, then update the UI to inform the user.\n\n```tsx\n'use client'\n\nimport { useState } from 'react'\n\nexport function Button() {\n  const [error, setError] = useState(null)"
  },
  {
    "id": "10-error-handling.mdx#11",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "```tsx\n'use client'\n\nimport { useState } from 'react'\n\nexport function Button() {\n  const [error, setError] = useState(null)\n\n  const handleClick = () => {\n    try {\n      // do some work that might fail\n      throw new Error('Exception')\n    } catch (reason) {\n      setError(reason)\n    }\n  }\n\n  if (error) {\n    /* render fallback UI */\n  }\n\n  return (\n    <button type=\"button\" onClick={handleClick}>\n      Click me\n    </button>\n  )\n}"
  },
  {
    "id": "10-error-handling.mdx#12",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "```\n\nNote that unhandled errors inside `startTransition` from `useTransition`, will bubble up to the nearest error boundary.\n\n```tsx\n'use client'\n\nimport { useTransition } from 'react'\n\nexport function Button() {\n  const [pending, startTransition] = useTransition()\n\n  const handleClick = () =>\n    startTransition(() => {\n      throw new Error('Exception')\n    })\n\n  return (\n    <button type=\"button\" onClick={handleClick}>\n      Click me\n    </button>\n  )\n}\n```"
  },
  {
    "id": "10-error-handling.mdx#13",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "### Global errors\n\nWhile less common, you can handle errors in the root layout using the [`global-error.js`](/docs/app/api-reference/file-conventions/error#global-error) file, located in the root app directory, even when leveraging [internationalization](/docs/app/guides/internationalization). Global error UI must define its own `<html>` and `<body>` tags, since it is replacing the root layout or template when active.\n\n```tsx filename=\"app/global-error.tsx\" switcher\n'use client' // Error boundaries must be Client Components\n\nexport default function GlobalError({\n  error,\n  reset,\n}: {\n  error: Error & { digest?: string }\n  reset: () => void\n}) {\n  return (\n    // global-error must include html and body tags\n    <html>\n      <body>\n        <h2>Something went wrong!</h2>\n        <button onClick={() => reset()}>Try again</button>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "10-error-handling.mdx#14",
    "metadata": {
      "title": "Error Handling",
      "description": "Learn how to display expected errors and handle uncaught exceptions."
    },
    "content": "```\n\n```jsx filename=\"app/global-error.js\" switcher\n'use client' // Error boundaries must be Client Components\n\nexport default function GlobalError({ error, reset }) {\n  return (\n    // global-error must include html and body tags\n    <html>\n      <body>\n        <h2>Something went wrong!</h2>\n        <button onClick={() => reset()}>Try again</button>\n      </body>\n    </html>\n  )\n}\n```"
  },
  {
    "id": "11-css.mdx#0",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "---\ntitle: CSS\ndescription: Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more.\nrelated:\n  title: Next Steps\n  description: Learn more about the alternatives ways you can use CSS in your application.\n  links:\n    - app/guides/tailwind-v3-css\n    - app/guides/sass\n    - app/guides/css-in-js\n---\n\nNext.js provides several ways to style your application using CSS, including:\n\n- [Tailwind CSS](#tailwind-css)\n- [CSS Modules](#css-modules)\n- [Global CSS](#global-css)\n- [External Stylesheets](#external-stylesheets)\n- [Sass](/docs/app/guides/sass)\n- [CSS-in-JS](/docs/app/guides/css-in-js)"
  },
  {
    "id": "11-css.mdx#1",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "## Tailwind CSS\n\n[Tailwind CSS](https://tailwindcss.com/) is a utility-first CSS framework that provides low-level utility classes to build custom designs.\n\n<AppOnly>\n\nInstall Tailwind CSS:\n\n```bash package=\"pnpm\"\npnpm add -D tailwindcss @tailwindcss/postcss\n```\n\n```bash package=\"npm\"\nnpm install -D tailwindcss @tailwindcss/postcss\n```\n\n```bash package=\"yarn\"\nyarn add -D tailwindcss @tailwindcss/postcss\n```\n\n```bash package=\"bun\"\nbun add -D tailwindcss @tailwindcss/postcss\n```\n\nAdd the PostCSS plugin to your `postcss.config.mjs` file:\n\n```js filename=\"postcss.config.mjs\"\nexport default {\n  plugins: {\n    '@tailwindcss/postcss': {},\n  },\n}\n```\n\nImport Tailwind in your global CSS file:\n\n```css filename=\"app/globals.css\"\n@import 'tailwindcss';\n```\n\nImport the CSS file in your root layout:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport './globals.css'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "11-css.mdx#2",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nimport './globals.css'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\nNow you can start using Tailwind's utility classes in your application:\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default function Page() {\n  return (\n    <main className=\"flex min-h-screen flex-col items-center justify-between p-24\">\n      <h1 className=\"text-4xl font-bold\">Welcome to Next.js!</h1>\n    </main>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nexport default function Page() {\n  return (\n    <main className=\"flex min-h-screen flex-col items-center justify-between p-24\">\n      <h1 className=\"text-4xl font-bold\">Welcome to Next.js!</h1>\n    </main>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nInstall Tailwind CSS:\n\n```bash package=\"pnpm\"\npnpm add -D tailwindcss @tailwindcss/postcss\n```\n\n```bash package=\"npm\"\nnpm install -D tailwindcss @tailwindcss/postcss\n```\n\n```bash package=\"yarn\"\nyarn add -D tailwindcss @tailwindcss/postcss\n```\n\n```bash package=\"bun\"\nbun add -D tailwindcss @tailwindcss/postcss"
  },
  {
    "id": "11-css.mdx#3",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "```\n\n```bash package=\"yarn\"\nyarn add -D tailwindcss @tailwindcss/postcss\n```\n\n```bash package=\"bun\"\nbun add -D tailwindcss @tailwindcss/postcss\n```\n\nAdd the PostCSS plugin to your `postcss.config.mjs` file:\n\n```js filename=\"postcss.config.mjs\"\nexport default {\n  plugins: {\n    '@tailwindcss/postcss': {},\n  },\n}\n```\n\nImport Tailwind in your global CSS file:\n\n```css filename=\"styles/globals.css\"\n@import 'tailwindcss';\n```\n\nImport the CSS file in your `pages/_app.js` file:\n\n```jsx filename=\"pages/_app.js\"\nimport '@/styles/globals.css'\n\nexport default function MyApp({ Component, pageProps }) {\n  return <Component {...pageProps} />\n}\n```\n\nNow you can start using Tailwind's utility classes in your application:\n\n```tsx filename=\"pages/index.tsx\" switcher\nexport default function Home() {\n  return (\n    <main className=\"flex min-h-screen flex-col items-center justify-between p-24\">\n      <h1 className=\"text-4xl font-bold\">Welcome to Next.js!</h1>\n    </main>\n  )\n}"
  },
  {
    "id": "11-css.mdx#4",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "```\n\n```jsx filename=\"pages/index.js\" switcher\nexport default function Home() {\n  return (\n    <main className=\"flex min-h-screen flex-col items-center justify-between p-24\">\n      <h1 className=\"text-4xl font-bold\">Welcome to Next.js!</h1>\n    </main>\n  )\n}\n```\n\n</PagesOnly>\n\n> **Good to know:** If you need broader browser support for very old browsers, see the [Tailwind CSS v3 setup instructions](/docs/app/guides/tailwind-v3-css)."
  },
  {
    "id": "11-css.mdx#5",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "## CSS Modules\n\nCSS Modules locally scope CSS by generating unique class names. This allows you to use the same class in different files without worrying about naming collisions.\n\n<AppOnly>\n\nTo start using CSS Modules, create a new file with the extension `.module.css` and import it into any component inside the `app` directory:\n\n```css filename=\"app/blog/blog.module.css\"\n.blog {\n  padding: 24px;\n}\n```\n\n```tsx filename=\"app/blog/page.tsx\" switcher\nimport styles from './blog.module.css'\n\nexport default function Page() {\n  return <main className={styles.blog}></main>\n}\n```\n\n```jsx filename=\"app/blog/page.js\" switcher\nimport styles from './blog.module.css'\n\nexport default function Layout() {\n  return <main className={styles.blog}></main>\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nTo start using CSS Modules, create a new file with the extension `.module.css` and import it into any component inside the `pages` directory:\n\n```css filename=\"/styles/blog.module.css\"\n.blog {\n  padding: 24px;\n}\n```\n\n```tsx filename=\"pages/blog/index.tsx\" switcher\nimport styles from './blog.module.css'\n\nexport default function Page() {\n  return <main className={styles.blog}></main>\n}"
  },
  {
    "id": "11-css.mdx#6",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "```\n\n```tsx filename=\"pages/blog/index.tsx\" switcher\nimport styles from './blog.module.css'\n\nexport default function Page() {\n  return <main className={styles.blog}></main>\n}\n```\n\n```jsx filename=\"pages/blog/index.js\" switcher\nimport styles from './blog.module.css'\n\nexport default function Page() {\n  return <main className={styles.blog}></main>\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "11-css.mdx#7",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "## Global CSS\n\nYou can use global CSS to apply styles across your application.\n\n<AppOnly>\n\nCreate a `app/global.css` file and import it in the root layout to apply the styles to **every route** in your application:\n\n```css filename=\"app/global.css\"\nbody {\n  padding: 20px 20px 60px;\n  max-width: 680px;\n  margin: 0 auto;\n}\n```\n\n```tsx filename=\"app/layout.tsx\" switcher\n// These styles apply to every route in the application\nimport './global.css'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\n// These styles apply to every route in the application\nimport './global.css'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "11-css.mdx#8",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "```\n\n> **Good to know:** Global styles can be imported into any layout, page, or component inside the `app` directory. However, since Next.js uses React's built-in support for stylesheets to integrate with Suspense, this currently does not remove stylesheets as you navigate between routes which can lead to conflicts. We recommend using global styles for _truly_ global CSS (like Tailwind's base styles), [Tailwind CSS](#tailwind-css) for component styling, and [CSS Modules](#css-modules) for custom scoped CSS when needed.\n\n</AppOnly>\n\n<PagesOnly>\n\nImport the stylesheet in the `pages/_app.js` file to apply the styles to **every route** in your application:\n\n```tsx filename=\"pages/_app.js\"\nimport '@/styles/global.css'\n\nexport default function MyApp({ Component, pageProps }) {\n  return <Component {...pageProps} />\n}\n```\n\nDue to the global nature of stylesheets, and to avoid conflicts, you should import them inside [`pages/_app.js`](/docs/pages/building-your-application/routing/custom-app).\n\n</PagesOnly>"
  },
  {
    "id": "11-css.mdx#9",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "## External stylesheets\n\n<AppOnly>\n\nStylesheets published by external packages can be imported anywhere in the `app` directory, including colocated components:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport 'bootstrap/dist/css/bootstrap.css'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body className=\"container\">{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport 'bootstrap/dist/css/bootstrap.css'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body className=\"container\">{children}</body>\n    </html>\n  )\n}\n```\n\n> **Good to know:** In React 19, `<link rel=\"stylesheet\" href=\"...\" />` can also be used. See the [React `link` documentation](https://react.dev/reference/react-dom/components/link) for more information.\n\n</AppOnly>\n\n<PagesOnly>\n\nNext.js allows you to import CSS files from a JavaScript file. This is possible because Next.js extends the concept of [`import`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/import) beyond JavaScript."
  },
  {
    "id": "11-css.mdx#10",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "### Import styles from `node_modules`\n\nSince Next.js **9.5.4**, importing a CSS file from `node_modules` is permitted anywhere in your application.\n\nFor global stylesheets, like `bootstrap` or `nprogress`, you should import the file inside `pages/_app.js`. For example:\n\n```jsx filename=\"pages/_app.js\"\nimport 'bootstrap/dist/css/bootstrap.css'\n\nexport default function MyApp({ Component, pageProps }) {\n  return <Component {...pageProps} />\n}"
  },
  {
    "id": "11-css.mdx#11",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "```\n\nTo import CSS required by a third-party component, you can do so in your component. For example:\n\n```jsx filename=\"components/example-dialog.js\"\nimport { useState } from 'react'\nimport { Dialog } from '@reach/dialog'\nimport VisuallyHidden from '@reach/visually-hidden'\nimport '@reach/dialog/styles.css'\n\nfunction ExampleDialog(props) {\n  const [showDialog, setShowDialog] = useState(false)\n  const open = () => setShowDialog(true)\n  const close = () => setShowDialog(false)\n\n  return (\n    <div>\n      <button onClick={open}>Open Dialog</button>\n      <Dialog isOpen={showDialog} onDismiss={close}>\n        <button className=\"close-button\" onClick={close}>\n          <VisuallyHidden>Close</VisuallyHidden>\n          <span aria-hidden>×</span>\n        </button>\n        <p>Hello there. I am a dialog</p>\n      </Dialog>\n    </div>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "11-css.mdx#12",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "## Ordering and Merging\n\nNext.js optimizes CSS during production builds by automatically chunking (merging) stylesheets. The **order of your CSS** depends on the **order you import styles in your code**.\n\nFor example, `base-button.module.css` will be ordered before `page.module.css` since `<BaseButton>` is imported before `page.module.css`:\n\n```tsx filename=\"page.tsx\" switcher\nimport { BaseButton } from './base-button'\nimport styles from './page.module.css'\n\nexport default function Page() {\n  return <BaseButton className={styles.primary} />\n}\n```\n\n```jsx filename=\"page.js\" switcher\nimport { BaseButton } from './base-button'\nimport styles from './page.module.css'\n\nexport default function Page() {\n  return <BaseButton className={styles.primary} />\n}\n```\n\n```tsx filename=\"base-button.tsx\" switcher\nimport styles from './base-button.module.css'\n\nexport function BaseButton() {\n  return <button className={styles.primary} />\n}\n```\n\n```jsx filename=\"base-button.js\" switcher\nimport styles from './base-button.module.css'\n\nexport function BaseButton() {\n  return <button className={styles.primary} />\n}\n```"
  },
  {
    "id": "11-css.mdx#13",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "### Recommendations\n\nTo keep CSS ordering predictable:\n\n- Try to contain CSS imports to a single JavaScript or TypeScript entry file\n- Import global styles and Tailwind stylesheets in the root of your application.\n- **Use Tailwind CSS** for most styling needs as it covers common design patterns with utility classes.\n- Use CSS Modules for component-specific styles when Tailwind utilities aren't sufficient.\n- Use a consistent naming convention for your CSS modules. For example, using `<name>.module.css` over `<name>.tsx`.\n- Extract shared styles into shared components to avoid duplicate imports.\n- Turn off linters or formatters that auto-sort imports like ESLint’s [`sort-imports`](https://eslint.org/docs/latest/rules/sort-imports).\n- You can use the [`cssChunking`](/docs/app/api-reference/config/next-config-js/cssChunking) option in `next.config.js` to control how CSS is chunked."
  },
  {
    "id": "11-css.mdx#14",
    "metadata": {
      "title": "CSS",
      "description": "Learn about the different ways to add CSS to your application, including Tailwind CSS, CSS Modules, Global CSS, and more."
    },
    "content": "## Development vs Production\n\n- In development (`next dev`), CSS updates apply instantly with [Fast Refresh](/docs/architecture/fast-refresh).\n- In production (`next build`), all CSS files are automatically concatenated into **many minified and code-split** `.css` files, ensuring the minimal amount of CSS is loaded for a route.\n- CSS still loads with JavaScript disabled in production, but JavaScript is required in development for Fast Refresh.\n- CSS ordering can behave differently in development, always ensure to check the build (`next build`) to verify the final CSS order."
  },
  {
    "id": "12-images.mdx#0",
    "metadata": {
      "title": "Image Optimization",
      "description": "Learn how to optimize images in Next.js"
    },
    "content": "---\ntitle: Image Optimization\ndescription: Learn how to optimize images in Next.js\nrelated:\n  title: API Reference\n  description: See the API Reference for the full feature set of Next.js Image.\n  links:\n    - app/api-reference/components/image\n---\n\nThe Next.js [`<Image>`](/docs/app/api-reference/components/image) component extends the HTML `<img>` element to provide:\n\n- **Size optimization:** Automatically serving correctly sized images for each device, using modern image formats like WebP.\n- **Visual stability:** Preventing [layout shift](https://web.dev/articles/cls) automatically when images are loading.\n- **Faster page loads:** Only loading images when they enter the viewport using native browser lazy loading, with optional blur-up placeholders.\n- **Asset flexibility:** Resizing images on-demand, even images stored on remote servers.\n\nTo start using `<Image>`, import it from `next/image` and render it within your component.\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Image from 'next/image'\n\nexport default function Page() {\n  return <Image src=\"\" alt=\"\" />\n}"
  },
  {
    "id": "12-images.mdx#1",
    "metadata": {
      "title": "Image Optimization",
      "description": "Learn how to optimize images in Next.js"
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nimport Image from 'next/image'\n\nexport default function Page() {\n  return <Image src=\"\" alt=\"\" />\n}\n```\n\nThe `src` property can be a [local](#local-images) or [remote](#remote-images) image.\n\n> **🎥 Watch:** Learn more about how to use `next/image` → [YouTube (9 minutes)](https://youtu.be/IU_qq_c_lKA)."
  },
  {
    "id": "12-images.mdx#2",
    "metadata": {
      "title": "Image Optimization",
      "description": "Learn how to optimize images in Next.js"
    },
    "content": "## Local images\n\nYou can store static files, like images and fonts, under a folder called [`public`](/docs/app/api-reference/file-conventions/public-folder) in the root directory. Files inside `public` can then be referenced by your code starting from the base URL (`/`).\n\n<Image\n  alt=\"Folder structure showing app and public folders\"\n  srcLight=\"/docs/light/public-folder.png\"\n  srcDark=\"/docs/dark/public-folder.png\"\n  width=\"1600\"\n  height=\"282\"\n/>\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Image from 'next/image'\n\nexport default function Page() {\n  return (\n    <Image\n      src=\"/profile.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    />\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport Image from 'next/image'\n\nexport default function Page() {\n  return (\n    <Image\n      src=\"/profile.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    />\n  )\n}"
  },
  {
    "id": "12-images.mdx#3",
    "metadata": {
      "title": "Image Optimization",
      "description": "Learn how to optimize images in Next.js"
    },
    "content": "```\n\nIf the image is statically imported, Next.js will automatically determine the intrinsic [`width`](/docs/app/api-reference/components/image#width-and-height) and [`height`](/docs/app/api-reference/components/image#width-and-height). These values are used to determine the image ratio and prevent [Cumulative Layout Shift](https://web.dev/articles/cls) while your image is loading.\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Image from 'next/image'\nimport ProfileImage from './profile.png'\n\nexport default function Page() {\n  return (\n    <Image\n      src={ProfileImage}\n      alt=\"Picture of the author\"\n      // width={500} automatically provided\n      // height={500} automatically provided\n      // blurDataURL=\"data:...\" automatically provided\n      // placeholder=\"blur\" // Optional blur-up while loading\n    />\n  )\n}"
  },
  {
    "id": "12-images.mdx#4",
    "metadata": {
      "title": "Image Optimization",
      "description": "Learn how to optimize images in Next.js"
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nimport Image from 'next/image'\nimport ProfileImage from './profile.png'\n\nexport default function Page() {\n  return (\n    <Image\n      src={ProfileImage}\n      alt=\"Picture of the author\"\n      // width={500} automatically provided\n      // height={500} automatically provided\n      // blurDataURL=\"data:...\" automatically provided\n      // placeholder=\"blur\" // Optional blur-up while loading\n    />\n  )\n}\n```"
  },
  {
    "id": "12-images.mdx#5",
    "metadata": {
      "title": "Image Optimization",
      "description": "Learn how to optimize images in Next.js"
    },
    "content": "## Remote images\n\nTo use a remote image, you can provide a URL string for the `src` property.\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Image from 'next/image'\n\nexport default function Page() {\n  return (\n    <Image\n      src=\"https://s3.amazonaws.com/my-bucket/profile.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    />\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport Image from 'next/image'\n\nexport default function Page() {\n  return (\n    <Image\n      src=\"https://s3.amazonaws.com/my-bucket/profile.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    />\n  )\n}"
  },
  {
    "id": "12-images.mdx#6",
    "metadata": {
      "title": "Image Optimization",
      "description": "Learn how to optimize images in Next.js"
    },
    "content": "```\n\nSince Next.js does not have access to remote files during the build process, you'll need to provide the [`width`](/docs/app/api-reference/components/image#width-and-height), [`height`](/docs/app/api-reference/components/image#width-and-height) and optional [`blurDataURL`](/docs/app/api-reference/components/image#blurdataurl) props manually. The `width` and `height` are used to infer the correct aspect ratio of image and avoid layout shift from the image loading in. Alternatively, you can use the [`fill` property](/docs/app/api-reference/components/image#fill) to make the image fill the size of the parent element.\n\nTo safely allow images from remote servers, you need to define a list of supported URL patterns in [`next.config.js`](/docs/app/api-reference/config/next-config-js). Be as specific as possible to prevent malicious usage. For example, the following configuration will only allow images from a specific AWS S3 bucket:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'"
  },
  {
    "id": "12-images.mdx#7",
    "metadata": {
      "title": "Image Optimization",
      "description": "Learn how to optimize images in Next.js"
    },
    "content": "```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst config: NextConfig = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 's3.amazonaws.com',\n        port: '',\n        pathname: '/my-bucket/**',\n        search: '',\n      },\n    ],\n  },\n}\n\nexport default config"
  },
  {
    "id": "12-images.mdx#8",
    "metadata": {
      "title": "Image Optimization",
      "description": "Learn how to optimize images in Next.js"
    },
    "content": "```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 's3.amazonaws.com',\n        port: '',\n        pathname: '/my-bucket/**',\n        search: '',\n      },\n    ],\n  },\n}\n```"
  },
  {
    "id": "13-fonts.mdx#0",
    "metadata": {
      "title": "Font Optimization",
      "description": "Learn how to optimize fonts in Next.js"
    },
    "content": "---\ntitle: Font Optimization\ndescription: Learn how to optimize fonts in Next.js\nrelated:\n  title: API Reference\n  description: See the API Reference for the full feature set of Next.js Font\n  links:\n    - app/api-reference/components/font\n---\n\nThe [`next/font`](/docs/app/api-reference/components/font) module automatically optimizes your fonts and removes external network requests for improved privacy and performance.\n\nIt includes **built-in self-hosting** for any font file. This means you can optimally load web fonts with no layout shift.\n\nTo start using `next/font`, import it from [`next/font/local`](#local-fonts) or [`next/font/google`](#google-fonts), call it as a function with the appropriate options, and set the `className` of the element you want to apply the font to. For example:\n\n```tsx filename=\"app/layout.tsx\" highlight={1,3-5,9} switcher\nimport { Geist } from 'next/font/google'\n\nconst geist = Geist({\n  subsets: ['latin'],\n})\n\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    <html lang=\"en\" className={geist.className}>\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "13-fonts.mdx#1",
    "metadata": {
      "title": "Font Optimization",
      "description": "Learn how to optimize fonts in Next.js"
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" highlight={1,3-5,9} switcher\nimport { Geist } from 'next/font/google'\n\nconst geist = Geist({\n  subsets: ['latin'],\n})\n\nexport default function Layout({ children }) {\n  return (\n    <html className={geist.className}>\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\nFonts are scoped to the component they're used in. To apply a font to your entire application, add it to the [Root Layout](/docs/app/api-reference/file-conventions/layout#root-layout)."
  },
  {
    "id": "13-fonts.mdx#2",
    "metadata": {
      "title": "Font Optimization",
      "description": "Learn how to optimize fonts in Next.js"
    },
    "content": "## Google fonts\n\nYou can automatically self-host any Google Font. Fonts are included stored as static assets and served from the same domain as your deployment, meaning no requests are sent to Google by the browser when the user visits your site.\n\nTo start using a Google Font, import your chosen font from `next/font/google`:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { Geist } from 'next/font/google'\n\nconst geist = Geist({\n  subsets: ['latin'],\n})\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\" className={geist.className}>\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { Geist } from 'next/font/google'\n\nconst geist = Geist({\n  subsets: ['latin'],\n})\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\" className={geist.className}>\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "13-fonts.mdx#3",
    "metadata": {
      "title": "Font Optimization",
      "description": "Learn how to optimize fonts in Next.js"
    },
    "content": "```\n\nWe recommend using [variable fonts](https://fonts.google.com/variablefonts) for the best performance and flexibility. But if you can't use a variable font, you will need to specify a weight:\n\n```tsx filename=\"app/layout.tsx\" highlight={4} switcher\nimport { Roboto } from 'next/font/google'\n\nconst roboto = Roboto({\n  weight: '400',\n  subsets: ['latin'],\n})\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\" className={roboto.className}>\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\"  highlight={4} switcher\nimport { Roboto } from 'next/font/google'\n\nconst roboto = Roboto({\n  weight: '400',\n  subsets: ['latin'],\n})\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\" className={roboto.className}>\n      <body>{children}</body>\n    </html>\n  )\n}\n```"
  },
  {
    "id": "13-fonts.mdx#4",
    "metadata": {
      "title": "Font Optimization",
      "description": "Learn how to optimize fonts in Next.js"
    },
    "content": "## Local fonts\n\nTo use a local font, import your font from `next/font/local` and specify the [`src`](/docs/app/api-reference/components/font#src) of your local font file. Fonts can be stored in the [`public`](/docs/app/api-reference/file-conventions/public-folder) folder or co-located inside the `app` folder. For example:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport localFont from 'next/font/local'\n\nconst myFont = localFont({\n  src: './my-font.woff2',\n})\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\" className={myFont.className}>\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport localFont from 'next/font/local'\n\nconst myFont = localFont({\n  src: './my-font.woff2',\n})\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\" className={myFont.className}>\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "13-fonts.mdx#5",
    "metadata": {
      "title": "Font Optimization",
      "description": "Learn how to optimize fonts in Next.js"
    },
    "content": "```\n\nIf you want to use multiple files for a single font family, `src` can be an array:\n\n```js\nconst roboto = localFont({\n  src: [\n    {\n      path: './Roboto-Regular.woff2',\n      weight: '400',\n      style: 'normal',\n    },\n    {\n      path: './Roboto-Italic.woff2',\n      weight: '400',\n      style: 'italic',\n    },\n    {\n      path: './Roboto-Bold.woff2',\n      weight: '700',\n      style: 'normal',\n    },\n    {\n      path: './Roboto-BoldItalic.woff2',\n      weight: '700',\n      style: 'italic',\n    },\n  ],\n})\n```"
  },
  {
    "id": "14-metadata-and-og-images.mdx#0",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "---\ntitle: Metadata and OG images\ndescription: Learn how to add metadata to your pages and create dynamic OG images.\nrelated:\n  title: API Reference\n  description: Learn more about the Metadata APIs mentioned in this page.\n  links:\n    - app/api-reference/functions/generate-metadata\n    - app/api-reference/functions/generate-viewport\n    - app/api-reference/functions/image-response\n    - app/api-reference/file-conventions/metadata\n    - app/api-reference/file-conventions/metadata/app-icons\n    - app/api-reference/file-conventions/metadata/opengraph-image\n    - app/api-reference/file-conventions/metadata/robots\n    - app/api-reference/file-conventions/metadata/sitemap\n    - app/api-reference/config/next-config-js/htmlLimitedBots\n---\n\nThe Metadata APIs can be used to define your application metadata for improved SEO and web shareability and include:\n\n1. [The static `metadata` object](#static-metadata)\n2. [The dynamic `generateMetadata` function](#generated-metadata)\n3. Special [file conventions](/docs/app/api-reference/file-conventions/metadata) that can be used to add static or dynamically generated [favicons](#favicons) and [OG images](#static-open-graph-images)."
  },
  {
    "id": "14-metadata-and-og-images.mdx#1",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "With all the options above, Next.js will automatically generate the relevant `<head>` tags for your page, which can be inspected in the browser's developer tools.\n\nThe `metadata` object and `generateMetadata` function exports are only supported in Server Components."
  },
  {
    "id": "14-metadata-and-og-images.mdx#2",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "## Default fields\n\nThere are two default `meta` tags that are always added even if a route doesn't define metadata:\n\n- The [meta charset tag](https://developer.mozilla.org/docs/Web/HTML/Element/meta#attr-charset) sets the character encoding for the website.\n- The [meta viewport tag](https://developer.mozilla.org/docs/Web/HTML/Viewport_meta_tag) sets the viewport width and scale for the website to adjust for different devices.\n\n```html\n<meta charset=\"utf-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n```\n\nThe other metadata fields can be defined with the `Metadata` object (for [static metadata](#static-metadata)) or the `generateMetadata` function (for [generated metadata](#generated-metadata))."
  },
  {
    "id": "14-metadata-and-og-images.mdx#3",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "## Static metadata\n\nTo define static metadata, export a [`Metadata` object](/docs/app/api-reference/functions/generate-metadata#metadata-object) from a static [`layout.js`](/docs/app/api-reference/file-conventions/layout) or [`page.js`](/docs/app/api-reference/file-conventions/page) file. For example, to add a title and description to the blog route:\n\n```tsx filename=\"app/blog/layout.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: 'My Blog',\n  description: '...',\n}\n\nexport default function Layout() {}\n```\n\n```jsx filename=\"app/blog/layout.js\" switcher\nexport const metadata = {\n  title: 'My Blog',\n  description: '...',\n}\n\nexport default function Layout() {}\n```\n\nYou can view a full list of available options, in the [`generateMetadata` documentation](/docs/app/api-reference/functions/generate-metadata#metadata-fields)."
  },
  {
    "id": "14-metadata-and-og-images.mdx#4",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "## Generated metadata\n\nYou can use [`generateMetadata`](/docs/app/api-reference/functions/generate-metadata) function to `fetch` metadata that depends on data. For example, to fetch the title and description for a specific blog post:\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nimport type { Metadata, ResolvingMetadata } from 'next'\n\ntype Props = {\n  params: Promise<{ slug: string }>\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}\n\nexport async function generateMetadata(\n  { params, searchParams }: Props,\n  parent: ResolvingMetadata\n): Promise<Metadata> {\n  const slug = (await params).slug\n\n  // fetch post information\n  const post = await fetch(`https://api.vercel.app/blog/${slug}`).then((res) =>\n    res.json()\n  )\n\n  return {\n    title: post.title,\n    description: post.description,\n  }\n}\n\nexport default function Page({ params, searchParams }: Props) {}"
  },
  {
    "id": "14-metadata-and-og-images.mdx#5",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nexport async function generateMetadata({ params, searchParams }, parent) {\n  const slug = (await params).slug\n\n  // fetch post information\n  const post = await fetch(`https://api.vercel.app/blog/${slug}`).then((res) =>\n    res.json()\n  )\n\n  return {\n    title: post.title,\n    description: post.description,\n  }\n}\n\nexport default function Page({ params, searchParams }) {}\n```"
  },
  {
    "id": "14-metadata-and-og-images.mdx#6",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "### Streaming metadata\n\nFor dynamically rendered pages, Next.js streams metadata separately, injecting it into the HTML once `generateMetadata` resolves, without blocking UI rendering.\n\nStreaming metadata improves perceived performance by allowing visual content to stream first.\n\nStreaming metadata is **disabled for bots and crawlers** that expect metadata to be in the `<head>` tag (e.g. `Twitterbot`, `Slackbot`, `Bingbot`). These are detected by using the User Agent header from the incoming request.\n\nYou can customize or **disable** streaming metadata completely, with the [`htmlLimitedBots`](/docs/app/api-reference/config/next-config-js/htmlLimitedBots#disabling) option in your Next.js config file.\n\nStatically rendered pages don’t use streaming since metadata is resolved at build time.\n\nLearn more about [streaming metadata](/docs/app/api-reference/functions/generate-metadata#streaming-metadata)."
  },
  {
    "id": "14-metadata-and-og-images.mdx#7",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "### Memoizing data requests\n\nThere may be cases where you need to fetch the **same** data for metadata and the page itself. To avoid duplicate requests, you can use React's [`cache` function](https://react.dev/reference/react/cache) to memoize the return value and only fetch the data once. For example, to fetch the blog post information for both the metadata and the page:\n\n```ts filename=\"app/lib/data.ts\" highlight={5} switcher\nimport { cache } from 'react'\nimport { db } from '@/app/lib/db'\n\n// getPost will be used twice, but execute only once\nexport const getPost = cache(async (slug: string) => {\n  const res = await db.query.posts.findFirst({ where: eq(posts.slug, slug) })\n  return res\n})\n```\n\n```js filename=\"app/lib/data.js\" highlight={5} switcher\nimport { cache } from 'react'\nimport { db } from '@/app/lib/db'\n\n// getPost will be used twice, but execute only once\nexport const getPost = cache(async (slug) => {\n  const res = await db.query.posts.findFirst({ where: eq(posts.slug, slug) })\n  return res\n})"
  },
  {
    "id": "14-metadata-and-og-images.mdx#8",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "```\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nimport { getPost } from '@/app/lib/data'\n\nexport async function generateMetadata({\n  params,\n}: {\n  params: { slug: string }\n}) {\n  const post = await getPost(params.slug)\n  return {\n    title: post.title,\n    description: post.description,\n  }\n}\n\nexport default async function Page({ params }: { params: { slug: string } }) {\n  const post = await getPost(params.slug)\n  return <div>{post.title}</div>\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nimport { getPost } from '@/app/lib/data'\n\nexport async function generateMetadata({ params }) {\n  const post = await getPost(params.slug)\n  return {\n    title: post.title,\n    description: post.description,\n  }\n}\n\nexport default async function Page({ params }) {\n  const post = await getPost(params.slug)\n  return <div>{post.title}</div>\n}\n```"
  },
  {
    "id": "14-metadata-and-og-images.mdx#9",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "## File-based metadata\n\nThe following special files are available for metadata:\n\n- [favicon.ico, apple-icon.jpg, and icon.jpg](/docs/app/api-reference/file-conventions/metadata/app-icons)\n- [opengraph-image.jpg and twitter-image.jpg](/docs/app/api-reference/file-conventions/metadata/opengraph-image)\n- [robots.txt](/docs/app/api-reference/file-conventions/metadata/robots)\n- [sitemap.xml](/docs/app/api-reference/file-conventions/metadata/sitemap)\n\nYou can use these for static metadata, or you can programmatically generate these files with code.\n\n## Favicons\n\nFavicons are small icons that represent your site in bookmarks and search results. To add a favicon to your application, create a `favicon.ico` and add to the root of the app folder.\n\n<Image\n  alt=\"Favicon Special File inside the App Folder with sibling layout and page files\"\n  srcLight=\"/docs/light/favicon-ico.png\"\n  srcDark=\"/docs/dark/favicon-ico.png\"\n  width=\"1600\"\n  height=\"444\"\n/>\n\n> You can also programmatically generate favicons using code. See the [favicon docs](/docs/app/api-reference/file-conventions/metadata/app-icons) for more information."
  },
  {
    "id": "14-metadata-and-og-images.mdx#10",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "## Static Open Graph images\n\nOpen Graph (OG) images are images that represent your site in social media. To add a static OG image to your application, create a `opengraph-image.jpg` file in the root of the app folder.\n\n<Image\n  alt=\"OG image special file inside the App folder with sibling layout and page files\"\n  srcLight=\"/docs/light/opengraph-image.png\"\n  srcDark=\"/docs/dark/opengraph-image.png\"\n  width=\"1600\"\n  height=\"444\"\n/>\n\nYou can also add OG images for specific routes by creating a `opengraph-image.jpg` deeper down the folder structure. For example, to create an OG image specific to the `/blog` route, add a `opengraph-image.jpg` file inside the `blog` folder.\n\n<Image\n  alt=\"OG image special file inside the blog folder\"\n  srcLight=\"/docs/light/opengraph-image-blog.png\"\n  srcDark=\"/docs/dark/opengraph-image-blog.png\"\n  width=\"1600\"\n  height=\"525\"\n/>\n\nThe more specific image will take precedence over any OG images above it in the folder structure.\n\n> Other image formats such as `jpeg`, `png`, and `gif` are also supported. See the [Open Graph Image docs](/docs/app/api-reference/file-conventions/metadata/opengraph-image) for more information."
  },
  {
    "id": "14-metadata-and-og-images.mdx#11",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "## Generated Open Graph images\n\nThe [`ImageResponse` constructor](/docs/app/api-reference/functions/image-response) allows you to generate dynamic images using JSX and CSS. This is useful for OG images that depend on data.\n\nFor example, to generate a unique OG image for each blog post, add a `opengraph-image.tsx` file inside the `blog` folder, and import the `ImageResponse` constructor from `next/og`:\n\n```tsx filename=\"app/blog/[slug]/opengraph-image.tsx\" switcher\nimport { ImageResponse } from 'next/og'\nimport { getPost } from '@/app/lib/data'\n\n// Image metadata\nexport const size = {\n  width: 1200,\n  height: 630,\n}\n\nexport const contentType = 'image/png'\n\n// Image generation\nexport default async function Image({ params }: { params: { slug: string } }) {\n  const post = await getPost(params.slug)\n\n  return new ImageResponse(\n    (\n      // ImageResponse JSX element\n      <div\n        style={{\n          fontSize: 128,\n          background: 'white',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        {post.title}\n      </div>\n    )\n  )\n}"
  },
  {
    "id": "14-metadata-and-og-images.mdx#12",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "```\n\n```jsx filename=\"app/blog/[slug]/opengraph-image.js\" switcher\nimport { ImageResponse } from 'next/og'\nimport { getPost } from '@/app/lib/data'\n\n// Image metadata\nexport const size = {\n  width: 1200,\n  height: 630,\n}\n\nexport const contentType = 'image/png'\n\n// Image generation\nexport default async function Image({ params }) {\n  const post = await getPost(params.slug)\n\n  return new ImageResponse(\n    (\n      // ImageResponse JSX element\n      <div\n        style={{\n          fontSize: 128,\n          background: 'white',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        {post.title}\n      </div>\n    )\n  )\n}"
  },
  {
    "id": "14-metadata-and-og-images.mdx#13",
    "metadata": {
      "title": "Metadata and OG images",
      "description": "Learn how to add metadata to your pages and create dynamic OG images."
    },
    "content": "```\n\n`ImageResponse` supports common CSS properties including flexbox and absolute positioning, custom fonts, text wrapping, centering, and nested images. [See the full list of supported CSS properties](/docs/app/api-reference/functions/image-response).\n\n> **Good to know**:\n>\n> - Examples are available in the [Vercel OG Playground](https://og-playground.vercel.app/).\n> - `ImageResponse` uses [`@vercel/og`](https://vercel.com/docs/og-image-generation), [`satori`](https://github.com/vercel/satori), and `resvg` to convert HTML and CSS into PNG.\n> - Only flexbox and a subset of CSS properties are supported. Advanced layouts (e.g. `display: grid`) will not work."
  },
  {
    "id": "15-route-handlers.mdx#0",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "---\ntitle: Route Handlers\nnav_title: Route Handlers\ndescription: Learn how to use Route Handlers\nrelated:\n  title: API Reference\n  description: Learn more about Route Handlers\n  links:\n    - app/api-reference/file-conventions/route\n    - app/guides/backend-for-frontend\n---"
  },
  {
    "id": "15-route-handlers.mdx#1",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "## Route Handlers\n\nRoute Handlers allow you to create custom request handlers for a given route using the Web [Request](https://developer.mozilla.org/docs/Web/API/Request) and [Response](https://developer.mozilla.org/docs/Web/API/Response) APIs.\n\n<Image\n  alt=\"Route.js Special File\"\n  srcLight=\"/docs/light/route-special-file.png\"\n  srcDark=\"/docs/dark/route-special-file.png\"\n  width=\"1600\"\n  height=\"444\"\n/>\n\n> **Good to know**: Route Handlers are only available inside the `app` directory. They are the equivalent of [API Routes](/docs/pages/building-your-application/routing/api-routes) inside the `pages` directory meaning you **do not** need to use API Routes and Route Handlers together."
  },
  {
    "id": "15-route-handlers.mdx#2",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "### Convention\n\nRoute Handlers are defined in a [`route.js|ts` file](/docs/app/api-reference/file-conventions/route) inside the `app` directory:\n\n```ts filename=\"app/api/route.ts\" switcher\nexport async function GET(request: Request) {}\n```\n\n```js filename=\"app/api/route.js\" switcher\nexport async function GET(request) {}\n```\n\nRoute Handlers can be nested anywhere inside the `app` directory, similar to `page.js` and `layout.js`. But there **cannot** be a `route.js` file at the same route segment level as `page.js`.\n\n### Supported HTTP Methods\n\nThe following [HTTP methods](https://developer.mozilla.org/docs/Web/HTTP/Methods) are supported: `GET`, `POST`, `PUT`, `PATCH`, `DELETE`, `HEAD`, and `OPTIONS`. If an unsupported method is called, Next.js will return a `405 Method Not Allowed` response."
  },
  {
    "id": "15-route-handlers.mdx#3",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "### Extended `NextRequest` and `NextResponse` APIs\n\nIn addition to supporting the native [Request](https://developer.mozilla.org/docs/Web/API/Request) and [Response](https://developer.mozilla.org/docs/Web/API/Response) APIs, Next.js extends them with [`NextRequest`](/docs/app/api-reference/functions/next-request) and [`NextResponse`](/docs/app/api-reference/functions/next-response) to provide convenient helpers for advanced use cases."
  },
  {
    "id": "15-route-handlers.mdx#4",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "### Caching\n\nRoute Handlers are not cached by default. You can, however, opt into caching for `GET` methods. Other supported HTTP methods are **not** cached. To cache a `GET` method, use a [route config option](/docs/app/api-reference/file-conventions/route-segment-config#dynamic) such as `export const dynamic = 'force-static'` in your Route Handler file.\n\n```ts filename=\"app/items/route.ts\" switcher\nexport const dynamic = 'force-static'\n\nexport async function GET() {\n  const res = await fetch('https://data.mongodb-api.com/...', {\n    headers: {\n      'Content-Type': 'application/json',\n      'API-Key': process.env.DATA_API_KEY,\n    },\n  })\n  const data = await res.json()\n\n  return Response.json({ data })\n}\n```\n\n```js filename=\"app/items/route.js\" switcher\nexport const dynamic = 'force-static'\n\nexport async function GET() {\n  const res = await fetch('https://data.mongodb-api.com/...', {\n    headers: {\n      'Content-Type': 'application/json',\n      'API-Key': process.env.DATA_API_KEY,\n    },\n  })\n  const data = await res.json()\n\n  return Response.json({ data })\n}"
  },
  {
    "id": "15-route-handlers.mdx#5",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "```\n\n> **Good to know**: Other supported HTTP methods are **not** cached, even if they are placed alongside a `GET` method that is cached, in the same file."
  },
  {
    "id": "15-route-handlers.mdx#6",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "#### With Cache Components\n\nWhen [Cache Components](/docs/app/getting-started/cache-components) is enabled, `GET` Route Handlers follow the same model as normal UI routes in your application. They run at request time by default, can be prerendered when they don't access dynamic or runtime data, and you can use `use cache` to include dynamic data in the static response.\n\n**Static example** - doesn't access dynamic or runtime data, so it will be prerendered at build time:\n\n```tsx filename=\"app/api/project-info/route.ts\"\nexport async function GET() {\n  return Response.json({\n    projectName: 'Next.js',\n  })\n}\n```\n\n**Dynamic example** - accesses non-deterministic operations. During the build, prerendering stops when `Math.random()` is called, deferring to request-time rendering:\n\n```tsx filename=\"app/api/random-number/route.ts\"\nexport async function GET() {\n  return Response.json({\n    randomNumber: Math.random(),\n  })\n}"
  },
  {
    "id": "15-route-handlers.mdx#7",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "```\n\n**Runtime data example** - accesses request-specific data. Prerendering terminates when runtime APIs like `headers()` are called:\n\n```tsx filename=\"app/api/user-agent/route.ts\"\nimport { headers } from 'next/headers'\n\nexport async function GET() {\n  const headersList = await headers()\n  const userAgent = headersList.get('user-agent')\n\n  return Response.json({ userAgent })\n}"
  },
  {
    "id": "15-route-handlers.mdx#8",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "```\n\n> **Good to know**: Prerendering stops if the `GET` handler accesses network requests, database queries, async file system operations, request object properties (like `req.url`, `request.headers`, `request.cookies`, `request.body`), runtime APIs like [`cookies()`](/docs/app/api-reference/functions/cookies), [`headers()`](/docs/app/api-reference/functions/headers), [`connection()`](/docs/app/api-reference/functions/connection), or non-deterministic operations.\n\n**Cached example** - accesses dynamic data (database query) but caches it with `use cache`, allowing it to be included in the prerendered response:\n\n```tsx filename=\"app/api/products/route.ts\"\nimport { cacheLife } from 'next/cache'\n\nexport async function GET() {\n  const products = await getProducts()\n  return Response.json(products)\n}\n\nasync function getProducts() {\n  'use cache'\n  cacheLife('hours')\n\n  return await db.query('SELECT * FROM products')\n}\n```\n\n> **Good to know**: `use cache` cannot be used directly inside a Route Handler body; extract it to a helper function. Cached responses revalidate according to `cacheLife` when a new request arrives."
  },
  {
    "id": "15-route-handlers.mdx#9",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "### Special Route Handlers\n\nSpecial Route Handlers like [`sitemap.ts`](/docs/app/api-reference/file-conventions/metadata/sitemap), [`opengraph-image.tsx`](/docs/app/api-reference/file-conventions/metadata/opengraph-image), and [`icon.tsx`](/docs/app/api-reference/file-conventions/metadata/app-icons), and other [metadata files](/docs/app/api-reference/file-conventions/metadata) remain static by default unless they use Dynamic APIs or dynamic config options."
  },
  {
    "id": "15-route-handlers.mdx#10",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "### Route Resolution\n\nYou can consider a `route` the lowest level routing primitive.\n\n- They **do not** participate in layouts or client-side navigations like `page`.\n- There **cannot** be a `route.js` file at the same route as `page.js`.\n\n| Page                 | Route              | Result                       |\n| -------------------- | ------------------ | ---------------------------- |\n| `app/page.js`        | `app/route.js`     | <Cross size={18} /> Conflict |\n| `app/page.js`        | `app/api/route.js` | <Check size={18} /> Valid    |\n| `app/[user]/page.js` | `app/api/route.js` | <Check size={18} /> Valid    |\n\nEach `route.js` or `page.js` file takes over all HTTP verbs for that route.\n\n```ts filename=\"app/page.ts\" switcher\nexport default function Page() {\n  return <h1>Hello, Next.js!</h1>\n}\n\n// Conflict\n// `app/route.ts`\nexport async function POST(request: Request) {}\n```\n\n```js filename=\"app/page.js\" switcher\nexport default function Page() {\n  return <h1>Hello, Next.js!</h1>\n}\n\n// Conflict\n// `app/route.js`\nexport async function POST(request) {}"
  },
  {
    "id": "15-route-handlers.mdx#11",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "```\n\n```js filename=\"app/page.js\" switcher\nexport default function Page() {\n  return <h1>Hello, Next.js!</h1>\n}\n\n// Conflict\n// `app/route.js`\nexport async function POST(request) {}\n```\n\nRead more about how Route Handlers [complement your frontend application](/docs/app/guides/backend-for-frontend), or explore the Route Handlers [API Reference](/docs/app/api-reference/file-conventions/route)."
  },
  {
    "id": "15-route-handlers.mdx#12",
    "metadata": {
      "title": "Route Handlers",
      "description": "Learn how to use Route Handlers"
    },
    "content": "### Route Context Helper\n\nIn TypeScript, you can type the `context` parameter for Route Handlers with the globally available [`RouteContext`](/docs/app/api-reference/file-conventions/route#route-context-helper) helper:\n\n```ts filename=\"app/users/[id]/route.ts\" switcher\nimport type { NextRequest } from 'next/server'\n\nexport async function GET(_req: NextRequest, ctx: RouteContext<'/users/[id]'>) {\n  const { id } = await ctx.params\n  return Response.json({ id })\n}\n```\n\n> **Good to know**\n>\n> - Types are generated during `next dev`, `next build` or `next typegen`."
  },
  {
    "id": "16-proxy.mdx#0",
    "metadata": {
      "title": "Proxy",
      "description": "Learn how to use Proxy"
    },
    "content": "---\ntitle: Proxy\nnav_title: Proxy\ndescription: Learn how to use Proxy\nrelated:\n  title: API Reference\n  description: Learn more about Proxy\n  links:\n    - app/api-reference/file-conventions/proxy\n    - app/guides/backend-for-frontend\n---"
  },
  {
    "id": "16-proxy.mdx#1",
    "metadata": {
      "title": "Proxy",
      "description": "Learn how to use Proxy"
    },
    "content": "## Proxy\n\n> **Good to know**: Starting with Next.js 16, Middleware is now called Proxy to better reflect its purpose. The functionality remains the same.\n\nProxy allows you to run code before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly."
  },
  {
    "id": "16-proxy.mdx#2",
    "metadata": {
      "title": "Proxy",
      "description": "Learn how to use Proxy"
    },
    "content": "### Use cases\n\nSome common scenarios where Proxy is effective include:\n\n- Modifying headers for all pages or a subset of pages\n- Rewriting to different pages based on A/B tests or experiments\n- Programmatic redirects based on incoming request properties\n\nFor simple redirects, consider using the [`redirects`](/docs/app/api-reference/config/next-config-js/redirects) configuration in `next.config.ts` first. Proxy should be used when you need access to request data or more complex logic.\n\nProxy is _not_ intended for slow data fetching. While Proxy can be helpful for [optimistic checks](/docs/app/guides/authentication#optimistic-checks-with-proxy-optional) such as permission-based redirects, it should not be used as a full session management or authorization solution.\n\nUsing fetch with `options.cache`, `options.next.revalidate`, or `options.next.tags`, has no effect in Proxy."
  },
  {
    "id": "16-proxy.mdx#3",
    "metadata": {
      "title": "Proxy",
      "description": "Learn how to use Proxy"
    },
    "content": "### Convention\n\nCreate a `proxy.ts` (or `.js`) file in the project root, or inside `src` if applicable, so that it is located at the same level as `pages` or `app`.\n\n> **Note**: While only one `proxy.ts` file is supported per project, you can still organize your proxy logic into modules. Break out proxy functionalities into separate `.ts` or `.js` files and import them into your main `proxy.ts` file. This allows for cleaner management of route-specific proxy, aggregated in the `proxy.ts` for centralized control. By enforcing a single proxy file, it simplifies configuration, prevents potential conflicts, and optimizes performance by avoiding multiple proxy layers."
  },
  {
    "id": "16-proxy.mdx#4",
    "metadata": {
      "title": "Proxy",
      "description": "Learn how to use Proxy"
    },
    "content": "### Example\n\nYou can export your proxy function as either a default export or a named `proxy` export:\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n\n// This function can be marked `async` if using `await` inside\nexport function proxy(request: NextRequest) {\n  return NextResponse.redirect(new URL('/home', request.url))\n}\n\n// Alternatively, you can use a default export:\n// export default function proxy(request: NextRequest) { ... }\n\n// See \"Matching Paths\" below to learn more\nexport const config = {\n  matcher: '/about/:path*',\n}\n```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\n\n// This function can be marked `async` if using `await` inside\nexport function proxy(request) {\n  return NextResponse.redirect(new URL('/home', request.url))\n}\n\n// Alternatively, you can use a default export:\n// export default function proxy(request) { ... }\n\n// See \"Matching Paths\" below to learn more\nexport const config = {\n  matcher: '/about/:path*',\n}"
  },
  {
    "id": "16-proxy.mdx#5",
    "metadata": {
      "title": "Proxy",
      "description": "Learn how to use Proxy"
    },
    "content": "```\n\nRead more about [using `proxy`](/docs/app/guides/backend-for-frontend#proxy), or refer to the `proxy` [API reference](/docs/app/api-reference/file-conventions/proxy)."
  },
  {
    "id": "17-deploying.mdx#0",
    "metadata": {
      "title": "Deploying",
      "description": "Learn how to deploy your Next.js application."
    },
    "content": "---\ntitle: Deploying\ndescription: Learn how to deploy your Next.js application.\n---\n\nNext.js can be deployed as a Node.js server, Docker container, static export, or adapted to run on different platforms.\n\n| Deployment Option                | Feature Support   |\n| -------------------------------- | ----------------- |\n| [Node.js server](#nodejs-server) | All               |\n| [Docker container](#docker)      | All               |\n| [Static export](#static-export)  | Limited           |\n| [Adapters](#adapters)            | Platform-specific |"
  },
  {
    "id": "17-deploying.mdx#1",
    "metadata": {
      "title": "Deploying",
      "description": "Learn how to deploy your Next.js application."
    },
    "content": "## Node.js server\n\nNext.js can be deployed to any provider that supports Node.js. Ensure your `package.json` has the `\"build\"` and `\"start\"` scripts:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\"\n  }\n}\n```\n\nThen, run `npm run build` to build your application and `npm run start` to start the Node.js server. This server supports all Next.js features. If needed, you can also eject to a [custom server](/docs/app/guides/custom-server).\n\nNode.js deployments support all Next.js features. Learn how to [configure them](/docs/app/guides/self-hosting) for your infrastructure.\n\n### Templates\n\n- [Flightcontrol](https://github.com/nextjs/deploy-flightcontrol)\n- [Railway](https://github.com/nextjs/deploy-railway)\n- [Replit](https://github.com/nextjs/deploy-replit)"
  },
  {
    "id": "17-deploying.mdx#2",
    "metadata": {
      "title": "Deploying",
      "description": "Learn how to deploy your Next.js application."
    },
    "content": "## Docker\n\nNext.js can be deployed to any provider that supports [Docker](https://www.docker.com/) containers. This includes container orchestrators like Kubernetes or a cloud provider that runs Docker.\n\nDocker deployments support all Next.js features. Learn how to [configure them](/docs/app/guides/self-hosting) for your infrastructure.\n\n> **Note for development:** While Docker is excellent for production deployments, consider using local development (`npm run dev`) instead of Docker during development on Mac and Windows for better performance. [Learn more about optimizing local development](/docs/app/guides/local-development).\n\n### Templates\n\n- [Docker](https://github.com/vercel/next.js/tree/canary/examples/with-docker)\n- [Docker Multi-Environment](https://github.com/vercel/next.js/tree/canary/examples/with-docker-multi-env)\n- [DigitalOcean](https://github.com/nextjs/deploy-digitalocean)\n- [Fly.io](https://github.com/nextjs/deploy-fly)\n- [Google Cloud Run](https://github.com/nextjs/deploy-google-cloud-run)\n- [Render](https://github.com/nextjs/deploy-render)\n- [SST](https://github.com/nextjs/deploy-sst)"
  },
  {
    "id": "17-deploying.mdx#3",
    "metadata": {
      "title": "Deploying",
      "description": "Learn how to deploy your Next.js application."
    },
    "content": "## Static export\n\nNext.js enables starting as a static site or [Single-Page Application (SPA)](/docs/app/guides/single-page-applications), then later optionally upgrading to use features that require a server.\n\nSince Next.js supports [static exports](/docs/app/guides/static-exports), it can be deployed and hosted on any web server that can serve HTML/CSS/JS static assets. This includes tools like AWS S3, Nginx, or Apache.\n\nRunning as a [static export](/docs/app/guides/static-exports) **does not** support Next.js features that require a server. [Learn more](/docs/app/guides/static-exports#unsupported-features).\n\n### Templates\n\n- [GitHub Pages](https://github.com/nextjs/deploy-github-pages)"
  },
  {
    "id": "17-deploying.mdx#4",
    "metadata": {
      "title": "Deploying",
      "description": "Learn how to deploy your Next.js application."
    },
    "content": "## Adapters\n\nNext.js can be adapted to run on different platforms to support their infrastructure capabilities.\n\nRefer to each provider's documentation for information on supported Next.js features:\n\n- [Appwrite Sites](https://appwrite.io/docs/products/sites/quick-start/nextjs)\n- [AWS Amplify Hosting](https://docs.amplify.aws/nextjs/start/quickstart/nextjs-app-router-client-components)\n- [Cloudflare](https://developers.cloudflare.com/workers/frameworks/framework-guides/nextjs)\n- [Deno Deploy](https://docs.deno.com/examples/next_tutorial)\n- [Netlify](https://docs.netlify.com/frameworks/next-js/overview/#next-js-support-on-netlify)\n- [Vercel](https://vercel.com/docs/frameworks/nextjs)\n\n> **Note:** We are working on a [Deployment Adapters API](https://github.com/vercel/next.js/discussions/77740) for all platforms to adopt. After completion, we will add documentation on how to write your own adapters."
  },
  {
    "id": "18-upgrading.mdx#0",
    "metadata": {
      "title": "Upgrading",
      "description": "Learn how to upgrade your Next.js application to the latest version or canary."
    },
    "content": "---\ntitle: Upgrading\ndescription: Learn how to upgrade your Next.js application to the latest version or canary.\nrelated:\n  title: Version guides\n  description: See the version guides for in-depth upgrade instructions.\n  links:\n    - app/guides/upgrading/version-16\n    - app/guides/upgrading/version-15\n    - app/guides/upgrading/version-14\n---\n\n## Latest version\n\nTo update to the latest version of Next.js, you can use the `upgrade` command:\n\n```bash filename=\"Terminal\"\nnext upgrade\n```\n\nNext.js 15 and earlier do not support the `upgrade` command and need to use a separate package instead:\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@canary upgrade latest\n```\n\nIf you prefer to upgrade manually, install the latest Next.js and React versions:\n\n```bash package=\"pnpm\"\npnpm i next@latest react@latest react-dom@latest eslint-config-next@latest\n```\n\n```bash package=\"npm\"\nnpm i next@latest react@latest react-dom@latest eslint-config-next@latest\n```\n\n```bash package=\"yarn\"\nyarn add next@latest react@latest react-dom@latest eslint-config-next@latest\n```\n\n```bash package=\"bun\"\nbun add next@latest react@latest react-dom@latest eslint-config-next@latest\n```"
  },
  {
    "id": "18-upgrading.mdx#1",
    "metadata": {
      "title": "Upgrading",
      "description": "Learn how to upgrade your Next.js application to the latest version or canary."
    },
    "content": "## Canary version\n\nTo update to the latest canary, make sure you're on the latest version of Next.js and everything is working as expected. Then, run the following command:\n\n```bash filename=\"Terminal\"\nnpm i next@canary\n```\n\n### Features available in canary\n\nThe following features are currently available in canary:\n\n**Authentication**:\n\n- [`forbidden`](/docs/app/api-reference/functions/forbidden)\n- [`unauthorized`](/docs/app/api-reference/functions/unauthorized)\n- [`forbidden.js`](/docs/app/api-reference/file-conventions/forbidden)\n- [`unauthorized.js`](/docs/app/api-reference/file-conventions/unauthorized)\n- [`authInterrupts`](/docs/app/api-reference/config/next-config-js/authInterrupts)"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Getting Started",
      "description": "Learn how to create full-stack web applications with the Next.js App Router."
    },
    "content": "---\ntitle: Getting Started\ndescription: Learn how to create full-stack web applications with the Next.js App Router.\n---\n\nWelcome to the Next.js documentation!\n\nThis **Getting Started** section will help you create your first Next.js app and learn the core features you'll use in every project.\n\n## Pre-requisite knowledge\n\nOur documentation assumes some familiarity with web development. Before getting started, it'll help if you're comfortable with:\n\n- HTML\n- CSS\n- JavaScript\n- React\n\nIf you're new to React or need a refresher, we recommend starting with our [React Foundations course](/learn/react-foundations), and the [Next.js Foundations course](/learn/dashboard-app) that has you building an application as you learn.\n\n## Next Steps"
  },
  {
    "id": "analytics.mdx#0",
    "metadata": {
      "title": "How to add analytics to your Next.js application",
      "description": "Measure and track page performance using Next.js Speed Insights"
    },
    "content": "---\ntitle: How to add analytics to your Next.js application\nnav_title: Analytics\ndescription: Measure and track page performance using Next.js Speed Insights\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js has built-in support for measuring and reporting performance metrics. You can either use the [`useReportWebVitals`](/docs/app/api-reference/functions/use-report-web-vitals) hook to manage reporting yourself, or alternatively, Vercel provides a [managed service](https://vercel.com/analytics?utm_source=next-site&utm_medium=docs&utm_campaign=next-website) to automatically collect and visualize metrics for you."
  },
  {
    "id": "analytics.mdx#1",
    "metadata": {
      "title": "How to add analytics to your Next.js application",
      "description": "Measure and track page performance using Next.js Speed Insights"
    },
    "content": "## Client Instrumentation\n\nFor more advanced analytics and monitoring needs, Next.js provides a `instrumentation-client.js|ts` file that runs before your application's frontend code starts executing. This is ideal for setting up global analytics, error tracking, or performance monitoring tools.\n\nTo use it, create an `instrumentation-client.js` or `instrumentation-client.ts` file in your application's root directory:\n\n```js filename=\"instrumentation-client.js\"\n// Initialize analytics before the app starts\nconsole.log('Analytics initialized')\n\n// Set up global error tracking\nwindow.addEventListener('error', (event) => {\n  // Send to your error tracking service\n  reportError(event.error)\n})\n```"
  },
  {
    "id": "analytics.mdx#2",
    "metadata": {
      "title": "How to add analytics to your Next.js application",
      "description": "Measure and track page performance using Next.js Speed Insights"
    },
    "content": "## Build Your Own\n\n<PagesOnly>\n\n```jsx filename=\"pages/_app.js\"\nimport { useReportWebVitals } from 'next/web-vitals'\n\nfunction MyApp({ Component, pageProps }) {\n  useReportWebVitals((metric) => {\n    console.log(metric)\n  })\n\n  return <Component {...pageProps} />\n}\n```\n\nView the [API Reference](/docs/pages/api-reference/functions/use-report-web-vitals) for more information.\n\n</PagesOnly>\n\n<AppOnly>\n\n```jsx filename=\"app/_components/web-vitals.js\"\n'use client'\n\nimport { useReportWebVitals } from 'next/web-vitals'\n\nexport function WebVitals() {\n  useReportWebVitals((metric) => {\n    console.log(metric)\n  })\n}\n```\n\n```jsx filename=\"app/layout.js\"\nimport { WebVitals } from './_components/web-vitals'\n\nexport default function Layout({ children }) {\n  return (\n    <html>\n      <body>\n        <WebVitals />\n        {children}\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "analytics.mdx#3",
    "metadata": {
      "title": "How to add analytics to your Next.js application",
      "description": "Measure and track page performance using Next.js Speed Insights"
    },
    "content": "```\n\n> Since the `useReportWebVitals` hook requires the `'use client'` directive, the most performant approach is to create a separate component that the root layout imports. This confines the client boundary exclusively to the `WebVitals` component.\n\nView the [API Reference](/docs/app/api-reference/functions/use-report-web-vitals) for more information.\n\n</AppOnly>"
  },
  {
    "id": "analytics.mdx#4",
    "metadata": {
      "title": "How to add analytics to your Next.js application",
      "description": "Measure and track page performance using Next.js Speed Insights"
    },
    "content": "## Web Vitals\n\n[Web Vitals](https://web.dev/vitals/) are a set of useful metrics that aim to capture the user\nexperience of a web page. The following web vitals are all included:\n\n- [Time to First Byte](https://developer.mozilla.org/docs/Glossary/Time_to_first_byte) (TTFB)\n- [First Contentful Paint](https://developer.mozilla.org/docs/Glossary/First_contentful_paint) (FCP)\n- [Largest Contentful Paint](https://web.dev/lcp/) (LCP)\n- [First Input Delay](https://web.dev/fid/) (FID)\n- [Cumulative Layout Shift](https://web.dev/cls/) (CLS)\n- [Interaction to Next Paint](https://web.dev/inp/) (INP)\n\nYou can handle all the results of these metrics using the `name` property.\n\n<PagesOnly>\n\n```jsx filename=\"pages/_app.js\"\nimport { useReportWebVitals } from 'next/web-vitals'\n\nfunction MyApp({ Component, pageProps }) {\n  useReportWebVitals((metric) => {\n    switch (metric.name) {\n      case 'FCP': {\n        // handle FCP results\n      }\n      case 'LCP': {\n        // handle LCP results\n      }\n      // ...\n    }\n  })\n\n  return <Component {...pageProps} />\n}"
  },
  {
    "id": "analytics.mdx#5",
    "metadata": {
      "title": "How to add analytics to your Next.js application",
      "description": "Measure and track page performance using Next.js Speed Insights"
    },
    "content": "```\n\n</PagesOnly>\n\n<AppOnly>\n\n```tsx filename=\"app/_components/web-vitals.tsx\" switcher\n'use client'\n\nimport { useReportWebVitals } from 'next/web-vitals'\n\nexport function WebVitals() {\n  useReportWebVitals((metric) => {\n    switch (metric.name) {\n      case 'FCP': {\n        // handle FCP results\n      }\n      case 'LCP': {\n        // handle LCP results\n      }\n      // ...\n    }\n  })\n}\n```\n\n```jsx filename=\"app/_components/web-vitals.js\" switcher\n'use client'\n\nimport { useReportWebVitals } from 'next/web-vitals'\n\nexport function WebVitals() {\n  useReportWebVitals((metric) => {\n    switch (metric.name) {\n      case 'FCP': {\n        // handle FCP results\n      }\n      case 'LCP': {\n        // handle LCP results\n      }\n      // ...\n    }\n  })\n}\n```\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "analytics.mdx#6",
    "metadata": {
      "title": "How to add analytics to your Next.js application",
      "description": "Measure and track page performance using Next.js Speed Insights"
    },
    "content": "## Custom Metrics\n\nIn addition to the core metrics listed above, there are some additional custom metrics that\nmeasure the time it takes for the page to hydrate and render:\n\n- `Next.js-hydration`: Length of time it takes for the page to start and finish hydrating (in ms)\n- `Next.js-route-change-to-render`: Length of time it takes for a page to start rendering after a\n  route change (in ms)\n- `Next.js-render`: Length of time it takes for a page to finish render after a route change (in ms)\n\nYou can handle all the results of these metrics separately:\n\n```js\nexport function reportWebVitals(metric) {\n  switch (metric.name) {\n    case 'Next.js-hydration':\n      // handle hydration results\n      break\n    case 'Next.js-route-change-to-render':\n      // handle route-change to render results\n      break\n    case 'Next.js-render':\n      // handle render results\n      break\n    default:\n      break\n  }\n}\n```\n\nThese metrics work in all browsers that support the [User Timing API](https://caniuse.com/#feat=user-timing).\n\n</PagesOnly>"
  },
  {
    "id": "analytics.mdx#7",
    "metadata": {
      "title": "How to add analytics to your Next.js application",
      "description": "Measure and track page performance using Next.js Speed Insights"
    },
    "content": "## Sending results to external systems\n\nYou can send results to any endpoint to measure and track\nreal user performance on your site. For example:\n\n```js\nuseReportWebVitals((metric) => {\n  const body = JSON.stringify(metric)\n  const url = 'https://example.com/analytics'\n\n  // Use `navigator.sendBeacon()` if available, falling back to `fetch()`.\n  if (navigator.sendBeacon) {\n    navigator.sendBeacon(url, body)\n  } else {\n    fetch(url, { body, method: 'POST', keepalive: true })\n  }\n})"
  },
  {
    "id": "analytics.mdx#8",
    "metadata": {
      "title": "How to add analytics to your Next.js application",
      "description": "Measure and track page performance using Next.js Speed Insights"
    },
    "content": "```\n\n> **Good to know**: If you use [Google Analytics](https://analytics.google.com/analytics/web/), using the\n> `id` value can allow you to construct metric distributions manually (to calculate percentiles,\n> etc.)\n\n> ```js\n> useReportWebVitals((metric) => {\n>   // Use `window.gtag` if you initialized Google Analytics as this example:\n>   // https://github.com/vercel/next.js/blob/canary/examples/with-google-analytics\n>   window.gtag('event', metric.name, {\n>     value: Math.round(\n>       metric.name === 'CLS' ? metric.value * 1000 : metric.value\n>     ), // values must be integers\n>     event_label: metric.id, // id unique to current page load\n>     non_interaction: true, // avoids affecting bounce rate.\n>   })\n> })\n> ```\n>\n> Read more about [sending results to Google Analytics](https://github.com/GoogleChrome/web-vitals#send-the-results-to-google-analytics)."
  },
  {
    "id": "authentication.mdx#0",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "---\ntitle: How to implement authentication in Next.js\nnav_title: Authentication\ndescription: Learn how to implement authentication in your Next.js application.\n---\n\nUnderstanding authentication is crucial for protecting your application's data. This page will guide you through what React and Next.js features to use to implement auth.\n\nBefore starting, it helps to break down the process into three concepts:\n\n1. **[Authentication](#authentication)**: Verifies if the user is who they say they are. It requires the user to prove their identity with something they have, such as a username and password.\n2. **[Session Management](#session-management)**: Tracks the user's auth state across requests.\n3. **[Authorization](#authorization)**: Decides what routes and data the user can access.\n\nThis diagram shows the authentication flow using React and Next.js features:\n\n<Image\n  alt=\"Diagram showing the authentication flow with React and Next.js features\"\n  srcLight=\"/docs/light/authentication-overview.png\"\n  srcDark=\"/docs/dark/authentication-overview.png\"\n  width=\"1600\"\n  height=\"1383\"\n/>"
  },
  {
    "id": "authentication.mdx#1",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "The examples on this page walk through basic username and password auth for educational purposes. While you can implement a custom auth solution, for increased security and simplicity, we recommend using an authentication library. These offer built-in solutions for authentication, session management, and authorization, as well as additional features such as social logins, multi-factor authentication, and role-based access control. You can find a list in the [Auth Libraries](#auth-libraries) section."
  },
  {
    "id": "authentication.mdx#2",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "## Authentication\n\n<AppOnly>"
  },
  {
    "id": "authentication.mdx#3",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "### Sign-up and login functionality\n\nYou can use the [`<form>`](https://react.dev/reference/react-dom/components/form) element with React's [Server Actions](/docs/app/getting-started/updating-data) and `useActionState` to capture user credentials, validate form fields, and call your Authentication Provider's API or database.\n\nSince Server Actions always execute on the server, they provide a secure environment for handling authentication logic.\n\nHere are the steps to implement signup/login functionality:"
  },
  {
    "id": "authentication.mdx#4",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "#### 1. Capture user credentials\n\nTo capture user credentials, create a form that invokes a Server Action on submission. For example, a signup form that accepts the user's name, email, and password:\n\n```tsx filename=\"app/ui/signup-form.tsx\" switcher\nimport { signup } from '@/app/actions/auth'\n\nexport function SignupForm() {\n  return (\n    <form action={signup}>\n      <div>\n        <label htmlFor=\"name\">Name</label>\n        <input id=\"name\" name=\"name\" placeholder=\"Name\" />\n      </div>\n      <div>\n        <label htmlFor=\"email\">Email</label>\n        <input id=\"email\" name=\"email\" type=\"email\" placeholder=\"Email\" />\n      </div>\n      <div>\n        <label htmlFor=\"password\">Password</label>\n        <input id=\"password\" name=\"password\" type=\"password\" />\n      </div>\n      <button type=\"submit\">Sign Up</button>\n    </form>\n  )\n}"
  },
  {
    "id": "authentication.mdx#5",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/ui/signup-form.js\" switcher\nimport { signup } from '@/app/actions/auth'\n\nexport function SignupForm() {\n  return (\n    <form action={signup}>\n      <div>\n        <label htmlFor=\"name\">Name</label>\n        <input id=\"name\" name=\"name\" placeholder=\"Name\" />\n      </div>\n      <div>\n        <label htmlFor=\"email\">Email</label>\n        <input id=\"email\" name=\"email\" type=\"email\" placeholder=\"Email\" />\n      </div>\n      <div>\n        <label htmlFor=\"password\">Password</label>\n        <input id=\"password\" name=\"password\" type=\"password\" />\n      </div>\n      <button type=\"submit\">Sign Up</button>\n    </form>\n  )\n}\n```\n\n```tsx filename=\"app/actions/auth.ts\" switcher\nexport async function signup(formData: FormData) {}\n```\n\n```jsx filename=\"app/actions/auth.js\" switcher\nexport async function signup(formData) {}\n```"
  },
  {
    "id": "authentication.mdx#6",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "#### 2. Validate form fields on the server\n\nUse the Server Action to validate the form fields on the server. If your authentication provider doesn't provide form validation, you can use a schema validation library like [Zod](https://zod.dev/) or [Yup](https://github.com/jquense/yup).\n\nUsing Zod as an example, you can define a form schema with appropriate error messages:\n\n```ts filename=\"app/lib/definitions.ts\" switcher\nimport * as z from 'zod'\n\nexport const SignupFormSchema = z.object({\n  name: z\n    .string()\n    .min(2, { error: 'Name must be at least 2 characters long.' })\n    .trim(),\n  email: z.email({ error: 'Please enter a valid email.' }).trim(),\n  password: z\n    .string()\n    .min(8, { error: 'Be at least 8 characters long' })\n    .regex(/[a-zA-Z]/, { error: 'Contain at least one letter.' })\n    .regex(/[0-9]/, { error: 'Contain at least one number.' })\n    .regex(/[^a-zA-Z0-9]/, {\n      error: 'Contain at least one special character.',\n    })\n    .trim(),\n})\n\nexport type FormState =\n  | {\n      errors?: {\n        name?: string[]\n        email?: string[]\n        password?: string[]\n      }\n      message?: string\n    }\n  | undefined"
  },
  {
    "id": "authentication.mdx#7",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"app/lib/definitions.js\" switcher\nimport * as z from 'zod'\n\nexport const SignupFormSchema = z.object({\n  name: z\n    .string()\n    .min(2, { error: 'Name must be at least 2 characters long.' })\n    .trim(),\n  email: z.email({ error: 'Please enter a valid email.' }).trim(),\n  password: z\n    .string()\n    .min(8, { error: 'Be at least 8 characters long' })\n    .regex(/[a-zA-Z]/, { error: 'Contain at least one letter.' })\n    .regex(/[0-9]/, { error: 'Contain at least one number.' })\n    .regex(/[^a-zA-Z0-9]/, {\n      error: 'Contain at least one special character.',\n    })\n    .trim(),\n})"
  },
  {
    "id": "authentication.mdx#8",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\nTo prevent unnecessary calls to your authentication provider's API or database, you can `return` early in the Server Action if any form fields do not match the defined schema.\n\n```ts filename=\"app/actions/auth.ts\" switcher\nimport { SignupFormSchema, FormState } from '@/app/lib/definitions'\n\nexport async function signup(state: FormState, formData: FormData) {\n  // Validate form fields\n  const validatedFields = SignupFormSchema.safeParse({\n    name: formData.get('name'),\n    email: formData.get('email'),\n    password: formData.get('password'),\n  })\n\n  // If any form fields are invalid, return early\n  if (!validatedFields.success) {\n    return {\n      errors: validatedFields.error.flatten().fieldErrors,\n    }\n  }\n\n  // Call the provider or db to create a user...\n}"
  },
  {
    "id": "authentication.mdx#9",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"app/actions/auth.js\" switcher\nimport { SignupFormSchema } from '@/app/lib/definitions'\n\nexport async function signup(state, formData) {\n  // Validate form fields\n  const validatedFields = SignupFormSchema.safeParse({\n    name: formData.get('name'),\n    email: formData.get('email'),\n    password: formData.get('password'),\n  })\n\n  // If any form fields are invalid, return early\n  if (!validatedFields.success) {\n    return {\n      errors: validatedFields.error.flatten().fieldErrors,\n    }\n  }\n\n  // Call the provider or db to create a user...\n}"
  },
  {
    "id": "authentication.mdx#10",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\nBack in your `<SignupForm />`, you can use React's `useActionState` hook to display validation errors while the form is submitting:\n\n```tsx filename=\"app/ui/signup-form.tsx\" switcher highlight={7,15,21,27-36}\n'use client'\n\nimport { signup } from '@/app/actions/auth'\nimport { useActionState } from 'react'\n\nexport default function SignupForm() {\n  const [state, action, pending] = useActionState(signup, undefined)\n\n  return (\n    <form action={action}>\n      <div>\n        <label htmlFor=\"name\">Name</label>\n        <input id=\"name\" name=\"name\" placeholder=\"Name\" />\n      </div>\n      {state?.errors?.name && <p>{state.errors.name}</p>}\n\n      <div>\n        <label htmlFor=\"email\">Email</label>\n        <input id=\"email\" name=\"email\" placeholder=\"Email\" />\n      </div>\n      {state?.errors?.email && <p>{state.errors.email}</p>}"
  },
  {
    "id": "authentication.mdx#11",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "<div>\n        <label htmlFor=\"email\">Email</label>\n        <input id=\"email\" name=\"email\" placeholder=\"Email\" />\n      </div>\n      {state?.errors?.email && <p>{state.errors.email}</p>}\n\n      <div>\n        <label htmlFor=\"password\">Password</label>\n        <input id=\"password\" name=\"password\" type=\"password\" />\n      </div>\n      {state?.errors?.password && (\n        <div>\n          <p>Password must:</p>\n          <ul>\n            {state.errors.password.map((error) => (\n              <li key={error}>- {error}</li>\n            ))}\n          </ul>\n        </div>\n      )}\n      <button disabled={pending} type=\"submit\">\n        Sign Up\n      </button>\n    </form>\n  )\n}"
  },
  {
    "id": "authentication.mdx#12",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/ui/signup-form.js\" switcher highlight={7,15,21,27-36}\n'use client'\n\nimport { signup } from '@/app/actions/auth'\nimport { useActionState } from 'react'\n\nexport default function SignupForm() {\n  const [state, action, pending] = useActionState(signup, undefined)\n\n  return (\n    <form action={action}>\n      <div>\n        <label htmlFor=\"name\">Name</label>\n        <input id=\"name\" name=\"name\" placeholder=\"Name\" />\n      </div>\n      {state?.errors?.name && <p>{state.errors.name}</p>}\n\n      <div>\n        <label htmlFor=\"email\">Email</label>\n        <input id=\"email\" name=\"email\" placeholder=\"Email\" />\n      </div>\n      {state?.errors?.email && <p>{state.errors.email}</p>}\n\n      <div>\n        <label htmlFor=\"password\">Password</label>\n        <input id=\"password\" name=\"password\" type=\"password\" />\n      </div>\n      {state?.errors?.password && (\n        <div>\n          <p>Password must:</p>\n          <ul>\n            {state.errors.password.map((error) => (\n              <li key={error}>- {error}</li>\n            ))}\n          </ul>\n        </div>\n      )}\n      <button disabled={pending} type=\"submit\">\n        Sign Up\n      </button>\n    </form>\n  )\n}"
  },
  {
    "id": "authentication.mdx#13",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n> **Good to know:**\n>\n> - In React 19, `useFormStatus` includes additional keys on the returned object, like data, method, and action. If you are not using React 19, only the `pending` key is available.\n> - Before mutating data, you should always ensure a user is also authorized to perform the action. See [Authentication and Authorization](#authorization)."
  },
  {
    "id": "authentication.mdx#14",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "#### 3. Create a user or check user credentials\n\nAfter validating form fields, you can create a new user account or check if the user exists by calling your authentication provider's API or database.\n\nContinuing from the previous example:\n\n```tsx filename=\"app/actions/auth.tsx\" switcher\nexport async function signup(state: FormState, formData: FormData) {\n  // 1. Validate form fields\n  // ...\n\n  // 2. Prepare data for insertion into database\n  const { name, email, password } = validatedFields.data\n  // e.g. Hash the user's password before storing it\n  const hashedPassword = await bcrypt.hash(password, 10)\n\n  // 3. Insert the user into the database or call an Auth Library's API\n  const data = await db\n    .insert(users)\n    .values({\n      name,\n      email,\n      password: hashedPassword,\n    })\n    .returning({ id: users.id })\n\n  const user = data[0]\n\n  if (!user) {\n    return {\n      message: 'An error occurred while creating your account.',\n    }\n  }\n\n  // TODO:\n  // 4. Create user session\n  // 5. Redirect user\n}"
  },
  {
    "id": "authentication.mdx#15",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/actions/auth.js\" switcher\nexport async function signup(state, formData) {\n  // 1. Validate form fields\n  // ...\n\n  // 2. Prepare data for insertion into database\n  const { name, email, password } = validatedFields.data\n  // e.g. Hash the user's password before storing it\n  const hashedPassword = await bcrypt.hash(password, 10)\n\n  // 3. Insert the user into the database or call an Library API\n  const data = await db\n    .insert(users)\n    .values({\n      name,\n      email,\n      password: hashedPassword,\n    })\n    .returning({ id: users.id })\n\n  const user = data[0]\n\n  if (!user) {\n    return {\n      message: 'An error occurred while creating your account.',\n    }\n  }\n\n  // TODO:\n  // 4. Create user session\n  // 5. Redirect user\n}"
  },
  {
    "id": "authentication.mdx#16",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\nAfter successfully creating the user account or verifying the user credentials, you can create a session to manage the user's auth state. Depending on your session management strategy, the session can be stored in a cookie or database, or both. Continue to the [Session Management](#session-management) section to learn more.\n\n> **Tips:**\n>\n> - The example above is verbose since it breaks down the authentication steps for the purpose of education. This highlights that implementing your own secure solution can quickly become complex. Consider using an [Auth Library](#auth-libraries) to simplify the process.\n> - To improve the user experience, you may want to check for duplicate emails or usernames earlier in the registration flow. For example, as the user types in a username or the input field loses focus. This can help prevent unnecessary form submissions and provide immediate feedback to the user. You can debounce requests with libraries such as [use-debounce](https://www.npmjs.com/package/use-debounce) to manage the frequency of these checks.\n\n</AppOnly>\n\n<PagesOnly>\n\nHere are the steps to implement a sign-up and/or login form:"
  },
  {
    "id": "authentication.mdx#17",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "</AppOnly>\n\n<PagesOnly>\n\nHere are the steps to implement a sign-up and/or login form:\n\n1. The user submits their credentials through a form.\n2. The form sends a request that is handled by an API route.\n3. Upon successful verification, the process is completed, indicating the user's successful authentication.\n4. If verification is unsuccessful, an error message is shown.\n\nConsider a login form where users can input their credentials:\n\n```tsx filename=\"pages/login.tsx\" switcher\nimport { FormEvent } from 'react'\nimport { useRouter } from 'next/router'\n\nexport default function LoginPage() {\n  const router = useRouter()\n\n  async function handleSubmit(event: FormEvent<HTMLFormElement>) {\n    event.preventDefault()\n\n    const formData = new FormData(event.currentTarget)\n    const email = formData.get('email')\n    const password = formData.get('password')\n\n    const response = await fetch('/api/auth/login', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email, password }),\n    })\n\n    if (response.ok) {\n      router.push('/profile')\n    } else {\n      // Handle errors\n    }\n  }"
  },
  {
    "id": "authentication.mdx#18",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "if (response.ok) {\n      router.push('/profile')\n    } else {\n      // Handle errors\n    }\n  }\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <input type=\"email\" name=\"email\" placeholder=\"Email\" required />\n      <input type=\"password\" name=\"password\" placeholder=\"Password\" required />\n      <button type=\"submit\">Login</button>\n    </form>\n  )\n}"
  },
  {
    "id": "authentication.mdx#19",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"pages/login.jsx\" switcher\nimport { FormEvent } from 'react'\nimport { useRouter } from 'next/router'\n\nexport default function LoginPage() {\n  const router = useRouter()\n\n  async function handleSubmit(event) {\n    event.preventDefault()\n\n    const formData = new FormData(event.currentTarget)\n    const email = formData.get('email')\n    const password = formData.get('password')\n\n    const response = await fetch('/api/auth/login', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email, password }),\n    })\n\n    if (response.ok) {\n      router.push('/profile')\n    } else {\n      // Handle errors\n    }\n  }\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <input type=\"email\" name=\"email\" placeholder=\"Email\" required />\n      <input type=\"password\" name=\"password\" placeholder=\"Password\" required />\n      <button type=\"submit\">Login</button>\n    </form>\n  )\n}"
  },
  {
    "id": "authentication.mdx#20",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\nThe form above has two input fields for capturing the user's email and password. On submission, it triggers a function that sends a POST request to an API route (`/api/auth/login`).\n\nYou can then call your Authentication Provider's API in the API route to handle authentication:\n\n```ts filename=\"pages/api/auth/login.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\nimport { signIn } from '@/auth'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  try {\n    const { email, password } = req.body\n    await signIn('credentials', { email, password })\n\n    res.status(200).json({ success: true })\n  } catch (error) {\n    if (error.type === 'CredentialsSignin') {\n      res.status(401).json({ error: 'Invalid credentials.' })\n    } else {\n      res.status(500).json({ error: 'Something went wrong.' })\n    }\n  }\n}"
  },
  {
    "id": "authentication.mdx#21",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"pages/api/auth/login.js\" switcher\nimport { signIn } from '@/auth'\n\nexport default async function handler(req, res) {\n  try {\n    const { email, password } = req.body\n    await signIn('credentials', { email, password })\n\n    res.status(200).json({ success: true })\n  } catch (error) {\n    if (error.type === 'CredentialsSignin') {\n      res.status(401).json({ error: 'Invalid credentials.' })\n    } else {\n      res.status(500).json({ error: 'Something went wrong.' })\n    }\n  }\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "authentication.mdx#22",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "## Session Management\n\nSession management ensures that the user's authenticated state is preserved across requests. It involves creating, storing, refreshing, and deleting sessions or tokens.\n\nThere are two types of sessions:\n\n1. [**Stateless**](#stateless-sessions): Session data (or a token) is stored in the browser's cookies. The cookie is sent with each request, allowing the session to be verified on the server. This method is simpler, but can be less secure if not implemented correctly.\n2. [**Database**](#database-sessions): Session data is stored in a database, with the user's browser only receiving the encrypted session ID. This method is more secure, but can be complex and use more server resources.\n\n> **Good to know:** While you can use either method, or both, we recommend using a session management library such as [iron-session](https://github.com/vvo/iron-session) or [Jose](https://github.com/panva/jose)."
  },
  {
    "id": "authentication.mdx#23",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "### Stateless Sessions\n\n<AppOnly>\n\nTo create and manage stateless sessions, there are a few steps you need to follow:\n\n1. Generate a secret key, which will be used to sign your session, and store it as an [environment variable](/docs/app/guides/environment-variables).\n2. Write logic to encrypt/decrypt session data using a session management library.\n3. Manage cookies using the Next.js [`cookies`](/docs/app/api-reference/functions/cookies) API.\n\nIn addition to the above, consider adding functionality to [update (or refresh)](#updating-or-refreshing-sessions) the session when the user returns to the application, and [delete](#deleting-the-session) the session when the user logs out.\n\n> **Good to know:** Check if your [auth library](#auth-libraries) includes session management."
  },
  {
    "id": "authentication.mdx#24",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "#### 1. Generating a secret key\n\nThere are a few ways you can generate secret key to sign your session. For example, you may choose to use the `openssl` command in your terminal:\n\n```bash filename=\"terminal\"\nopenssl rand -base64 32\n```\n\nThis command generates a 32-character random string that you can use as your secret key and store in your [environment variables file](/docs/app/guides/environment-variables):\n\n```bash filename=\".env\"\nSESSION_SECRET=your_secret_key\n```\n\nYou can then reference this key in your session management logic:\n\n```js filename=\"app/lib/session.js\"\nconst secretKey = process.env.SESSION_SECRET\n```"
  },
  {
    "id": "authentication.mdx#25",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "#### 2. Encrypting and decrypting sessions\n\nNext, you can use your preferred [session management library](#session-management-libraries) to encrypt and decrypt sessions. Continuing from the previous example, we'll use [Jose](https://www.npmjs.com/package/jose) (compatible with the [Edge Runtime](/docs/app/api-reference/edge)) and React's [`server-only`](https://www.npmjs.com/package/server-only) package to ensure that your session management logic is only executed on the server.\n\n```tsx filename=\"app/lib/session.ts\" switcher\nimport 'server-only'\nimport { SignJWT, jwtVerify } from 'jose'\nimport { SessionPayload } from '@/app/lib/definitions'\n\nconst secretKey = process.env.SESSION_SECRET\nconst encodedKey = new TextEncoder().encode(secretKey)\n\nexport async function encrypt(payload: SessionPayload) {\n  return new SignJWT(payload)\n    .setProtectedHeader({ alg: 'HS256' })\n    .setIssuedAt()\n    .setExpirationTime('7d')\n    .sign(encodedKey)\n}"
  },
  {
    "id": "authentication.mdx#26",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "export async function decrypt(session: string | undefined = '') {\n  try {\n    const { payload } = await jwtVerify(session, encodedKey, {\n      algorithms: ['HS256'],\n    })\n    return payload\n  } catch (error) {\n    console.log('Failed to verify session')\n  }\n}"
  },
  {
    "id": "authentication.mdx#27",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/lib/session.js\" switcher\nimport 'server-only'\nimport { SignJWT, jwtVerify } from 'jose'\n\nconst secretKey = process.env.SESSION_SECRET\nconst encodedKey = new TextEncoder().encode(secretKey)\n\nexport async function encrypt(payload) {\n  return new SignJWT(payload)\n    .setProtectedHeader({ alg: 'HS256' })\n    .setIssuedAt()\n    .setExpirationTime('7d')\n    .sign(encodedKey)\n}\n\nexport async function decrypt(session) {\n  try {\n    const { payload } = await jwtVerify(session, encodedKey, {\n      algorithms: ['HS256'],\n    })\n    return payload\n  } catch (error) {\n    console.log('Failed to verify session')\n  }\n}\n```\n\n> **Tips**:\n>\n> - The payload should contain the **minimum**, unique user data that'll be used in subsequent requests, such as the user's ID, role, etc. It should not contain personally identifiable information like phone number, email address, credit card information, etc, or sensitive data like passwords."
  },
  {
    "id": "authentication.mdx#28",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "#### 3. Setting cookies (recommended options)\n\nTo store the session in a cookie, use the Next.js [`cookies`](/docs/app/api-reference/functions/cookies) API. The cookie should be set on the server, and include the recommended options:\n\n- **HttpOnly**: Prevents client-side JavaScript from accessing the cookie.\n- **Secure**: Use https to send the cookie.\n- **SameSite**: Specify whether the cookie can be sent with cross-site requests.\n- **Max-Age or Expires**: Delete the cookie after a certain period.\n- **Path**: Define the URL path for the cookie.\n\nPlease refer to [MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies) for more information on each of these options.\n\n```ts filename=\"app/lib/session.ts\" switcher\nimport 'server-only'\nimport { cookies } from 'next/headers'\n\nexport async function createSession(userId: string) {\n  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n  const session = await encrypt({ userId, expiresAt })\n  const cookieStore = await cookies()\n\n  cookieStore.set('session', session, {\n    httpOnly: true,\n    secure: true,\n    expires: expiresAt,\n    sameSite: 'lax',\n    path: '/',\n  })\n}"
  },
  {
    "id": "authentication.mdx#29",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"app/lib/session.js\" switcher\nimport 'server-only'\nimport { cookies } from 'next/headers'\n\nexport async function createSession(userId) {\n  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n  const session = await encrypt({ userId, expiresAt })\n  const cookieStore = await cookies()\n\n  cookieStore.set('session', session, {\n    httpOnly: true,\n    secure: true,\n    expires: expiresAt,\n    sameSite: 'lax',\n    path: '/',\n  })\n}\n```\n\nBack in your Server Action, you can invoke the `createSession()` function, and use the [`redirect()`](/docs/app/guides/redirecting) API to redirect the user to the appropriate page:\n\n```ts filename=\"app/actions/auth.ts\" switcher\nimport { createSession } from '@/app/lib/session'\n\nexport async function signup(state: FormState, formData: FormData) {\n  // Previous steps:\n  // 1. Validate form fields\n  // 2. Prepare data for insertion into database\n  // 3. Insert the user into the database or call an Library API\n\n  // Current steps:\n  // 4. Create user session\n  await createSession(user.id)\n  // 5. Redirect user\n  redirect('/profile')\n}"
  },
  {
    "id": "authentication.mdx#30",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"app/actions/auth.js\" switcher\nimport { createSession } from '@/app/lib/session'\n\nexport async function signup(state, formData) {\n  // Previous steps:\n  // 1. Validate form fields\n  // 2. Prepare data for insertion into database\n  // 3. Insert the user into the database or call an Library API\n\n  // Current steps:\n  // 4. Create user session\n  await createSession(user.id)\n  // 5. Redirect user\n  redirect('/profile')\n}\n```\n\n> **Tips**:\n>\n> - **Cookies should be set on the server** to prevent client-side tampering.\n> - 🎥 Watch: Learn more about stateless sessions and authentication with Next.js → [YouTube (11 minutes)](https://www.youtube.com/watch?v=DJvM2lSPn6w)."
  },
  {
    "id": "authentication.mdx#31",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "#### Updating (or refreshing) sessions\n\nYou can also extend the session's expiration time. This is useful for keeping the user logged in after they access the application again. For example:\n\n```ts filename=\"app/lib/session.ts\" switcher\nimport 'server-only'\nimport { cookies } from 'next/headers'\nimport { decrypt } from '@/app/lib/session'\n\nexport async function updateSession() {\n  const session = (await cookies()).get('session')?.value\n  const payload = await decrypt(session)\n\n  if (!session || !payload) {\n    return null\n  }\n\n  const expires = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const cookieStore = await cookies()\n  cookieStore.set('session', session, {\n    httpOnly: true,\n    secure: true,\n    expires: expires,\n    sameSite: 'lax',\n    path: '/',\n  })\n}"
  },
  {
    "id": "authentication.mdx#32",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"app/lib/session.js\" switcher\nimport 'server-only'\nimport { cookies } from 'next/headers'\nimport { decrypt } from '@/app/lib/session'\n\nexport async function updateSession() {\n  const session = (await cookies()).get('session')?.value\n  const payload = await decrypt(session)\n\n  if (!session || !payload) {\n    return null\n  }\n\n  const expires = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)(\n    await cookies()\n  ).set('session', session, {\n    httpOnly: true,\n    secure: true,\n    expires: expires,\n    sameSite: 'lax',\n    path: '/',\n  })\n}\n```\n\n> **Tip:** Check if your auth library supports refresh tokens, which can be used to extend the user's session."
  },
  {
    "id": "authentication.mdx#33",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "#### Deleting the session\n\nTo delete the session, you can delete the cookie:\n\n```ts filename=\"app/lib/session.ts\" switcher\nimport 'server-only'\nimport { cookies } from 'next/headers'\n\nexport async function deleteSession() {\n  const cookieStore = await cookies()\n  cookieStore.delete('session')\n}\n```\n\n```js filename=\"app/lib/session.js\" switcher\nimport 'server-only'\nimport { cookies } from 'next/headers'\n\nexport async function deleteSession() {\n  const cookieStore = await cookies()\n  cookieStore.delete('session')\n}\n```\n\nThen you can reuse the `deleteSession()` function in your application, for example, on logout:\n\n```ts filename=\"app/actions/auth.ts\" switcher\nimport { cookies } from 'next/headers'\nimport { deleteSession } from '@/app/lib/session'\n\nexport async function logout() {\n  await deleteSession()\n  redirect('/login')\n}\n```\n\n```js filename=\"app/actions/auth.js\" switcher\nimport { cookies } from 'next/headers'\nimport { deleteSession } from '@/app/lib/session'\n\nexport async function logout() {\n  await deleteSession()\n  redirect('/login')\n}\n```\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "authentication.mdx#34",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "#### Setting and deleting cookies\n\nYou can use [API Routes](/docs/pages/building-your-application/routing/api-routes) to set the session as a cookie on the server:\n\n```ts filename=\"pages/api/login.ts\" switcher\nimport { serialize } from 'cookie'\nimport type { NextApiRequest, NextApiResponse } from 'next'\nimport { encrypt } from '@/app/lib/session'\n\nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  const sessionData = req.body\n  const encryptedSessionData = encrypt(sessionData)\n\n  const cookie = serialize('session', encryptedSessionData, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    maxAge: 60 * 60 * 24 * 7, // One week\n    path: '/',\n  })\n  res.setHeader('Set-Cookie', cookie)\n  res.status(200).json({ message: 'Successfully set cookie!' })\n}"
  },
  {
    "id": "authentication.mdx#35",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"pages/api/login.js\" switcher\nimport { serialize } from 'cookie'\nimport { encrypt } from '@/app/lib/session'\n\nexport default function handler(req, res) {\n  const sessionData = req.body\n  const encryptedSessionData = encrypt(sessionData)\n\n  const cookie = serialize('session', encryptedSessionData, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    maxAge: 60 * 60 * 24 * 7, // One week\n    path: '/',\n  })\n  res.setHeader('Set-Cookie', cookie)\n  res.status(200).json({ message: 'Successfully set cookie!' })\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "authentication.mdx#36",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "### Database Sessions\n\nTo create and manage database sessions, you'll need to follow these steps:\n\n1. Create a table in your database to store session and data (or check if your Auth Library handles this).\n2. Implement functionality to insert, update, and delete sessions\n3. Encrypt the session ID before storing it in the user's browser, and ensure the database and cookie stay in sync (this is optional, but recommended for optimistic auth checks in [Proxy](#optimistic-checks-with-proxy-optional)).\n\n<AppOnly>\n\nFor example:\n\n```ts filename=\"app/lib/session.ts\" switcher\nimport cookies from 'next/headers'\nimport { db } from '@/app/lib/db'\nimport { encrypt } from '@/app/lib/session'\n\nexport async function createSession(id: number) {\n  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  // 1. Create a session in the database\n  const data = await db\n    .insert(sessions)\n    .values({\n      userId: id,\n      expiresAt,\n    })\n    // Return the session ID\n    .returning({ id: sessions.id })\n\n  const sessionId = data[0].id\n\n  // 2. Encrypt the session ID\n  const session = await encrypt({ sessionId, expiresAt })"
  },
  {
    "id": "authentication.mdx#37",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "const sessionId = data[0].id\n\n  // 2. Encrypt the session ID\n  const session = await encrypt({ sessionId, expiresAt })\n\n  // 3. Store the session in cookies for optimistic auth checks\n  const cookieStore = await cookies()\n  cookieStore.set('session', session, {\n    httpOnly: true,\n    secure: true,\n    expires: expiresAt,\n    sameSite: 'lax',\n    path: '/',\n  })\n}"
  },
  {
    "id": "authentication.mdx#38",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"app/lib/session.js\" switcher\nimport cookies from 'next/headers'\nimport { db } from '@/app/lib/db'\nimport { encrypt } from '@/app/lib/session'\n\nexport async function createSession(id) {\n  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  // 1. Create a session in the database\n  const data = await db\n    .insert(sessions)\n    .values({\n      userId: id,\n      expiresAt,\n    })\n    // Return the session ID\n    .returning({ id: sessions.id })\n\n  const sessionId = data[0].id\n\n  // 2. Encrypt the session ID\n  const session = await encrypt({ sessionId, expiresAt })\n\n  // 3. Store the session in cookies for optimistic auth checks\n  const cookieStore = await cookies()\n  cookieStore.set('session', session, {\n    httpOnly: true,\n    secure: true,\n    expires: expiresAt,\n    sameSite: 'lax',\n    path: '/',\n  })\n}"
  },
  {
    "id": "authentication.mdx#39",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n> **Tips**:\n>\n> - For faster access, you may consider adding server caching for the lifetime of the session. You can also keep the session data in your primary database, and combine data requests to reduce the number of queries.\n> - You may opt to use database sessions for more advanced use cases, such as keeping track of the last time a user logged in, or number of active devices, or give users the ability to log out of all devices.\n\nAfter implementing session management, you'll need to add authorization logic to control what users can access and do within your application. Continue to the [Authorization](#authorization) section to learn more.\n\n</AppOnly>\n\n<PagesOnly>\n\n**Creating a Session on the Server**:\n\n```ts filename=\"pages/api/create-session.ts\" switcher\nimport db from '../../lib/db'\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  try {\n    const user = req.body\n    const sessionId = generateSessionId()\n    await db.insertSession({\n      sessionId,\n      userId: user.id,\n      createdAt: new Date(),\n    })"
  },
  {
    "id": "authentication.mdx#40",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "res.status(200).json({ sessionId })\n  } catch (error) {\n    res.status(500).json({ error: 'Internal Server Error' })\n  }\n}"
  },
  {
    "id": "authentication.mdx#41",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"pages/api/create-session.js\" switcher\nimport db from '../../lib/db'\n\nexport default async function handler(req, res) {\n  try {\n    const user = req.body\n    const sessionId = generateSessionId()\n    await db.insertSession({\n      sessionId,\n      userId: user.id,\n      createdAt: new Date(),\n    })\n\n    res.status(200).json({ sessionId })\n  } catch (error) {\n    res.status(500).json({ error: 'Internal Server Error' })\n  }\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "authentication.mdx#42",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "## Authorization\n\nOnce a user is authenticated and a session is created, you can implement authorization to control what the user can access and do within your application.\n\nThere are two main types of authorization checks:\n\n1. **Optimistic**: Checks if the user is authorized to access a route or perform an action using the session data stored in the cookie. These checks are useful for quick operations, such as showing/hiding UI elements or redirecting users based on permissions or roles.\n2. **Secure**: Checks if the user is authorized to access a route or perform an action using the session data stored in the database. These checks are more secure and are used for operations that require access to sensitive data or actions.\n\nFor both cases, we recommend:\n\n- Creating a [Data Access Layer](#creating-a-data-access-layer-dal) to centralize your authorization logic\n- Using [Data Transfer Objects (DTO)](#using-data-transfer-objects-dto) to only return the necessary data\n- Optionally use [Proxy](#optimistic-checks-with-proxy-optional) to perform optimistic checks."
  },
  {
    "id": "authentication.mdx#43",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "### Optimistic checks with Proxy (Optional)\n\nThere are some cases where you may want to use [Proxy](/docs/app/api-reference/file-conventions/proxy) and redirect users based on permissions:\n\n- To perform optimistic checks. Since Proxy runs on every route, it's a good way to centralize redirect logic and pre-filter unauthorized users.\n- To protect static routes that share data between users (e.g. content behind a paywall).\n\nHowever, since Proxy runs on every route, including [prefetched](/docs/app/getting-started/linking-and-navigating#prefetching) routes, it's important to only read the session from the cookie (optimistic checks), and avoid database checks to prevent performance issues.\n\nFor example:\n\n```tsx filename=\"proxy.ts\" switcher\nimport { NextRequest, NextResponse } from 'next/server'\nimport { decrypt } from '@/app/lib/session'\nimport { cookies } from 'next/headers'\n\n// 1. Specify protected and public routes\nconst protectedRoutes = ['/dashboard']\nconst publicRoutes = ['/login', '/signup', '/']"
  },
  {
    "id": "authentication.mdx#44",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "// 1. Specify protected and public routes\nconst protectedRoutes = ['/dashboard']\nconst publicRoutes = ['/login', '/signup', '/']\n\nexport default async function proxy(req: NextRequest) {\n  // 2. Check if the current route is protected or public\n  const path = req.nextUrl.pathname\n  const isProtectedRoute = protectedRoutes.includes(path)\n  const isPublicRoute = publicRoutes.includes(path)\n\n  // 3. Decrypt the session from the cookie\n  const cookie = (await cookies()).get('session')?.value\n  const session = await decrypt(cookie)\n\n  // 4. Redirect to /login if the user is not authenticated\n  if (isProtectedRoute && !session?.userId) {\n    return NextResponse.redirect(new URL('/login', req.nextUrl))\n  }\n\n  // 5. Redirect to /dashboard if the user is authenticated\n  if (\n    isPublicRoute &&\n    session?.userId &&\n    !req.nextUrl.pathname.startsWith('/dashboard')\n  ) {\n    return NextResponse.redirect(new URL('/dashboard', req.nextUrl))\n  }\n\n  return NextResponse.next()\n}\n\n// Routes Proxy should not run on\nexport const config = {\n  matcher: ['/((?!api|_next/static|_next/image|.*\\\\.png$).*)'],\n}"
  },
  {
    "id": "authentication.mdx#45",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\nimport { decrypt } from '@/app/lib/session'\nimport { cookies } from 'next/headers'\n\n// 1. Specify protected and public routes\nconst protectedRoutes = ['/dashboard']\nconst publicRoutes = ['/login', '/signup', '/']\n\nexport default async function proxy(req) {\n  // 2. Check if the current route is protected or public\n  const path = req.nextUrl.pathname\n  const isProtectedRoute = protectedRoutes.includes(path)\n  const isPublicRoute = publicRoutes.includes(path)\n\n  // 3. Decrypt the session from the cookie\n  const cookie = (await cookies()).get('session')?.value\n  const session = await decrypt(cookie)\n\n  // 5. Redirect to /login if the user is not authenticated\n  if (isProtectedRoute && !session?.userId) {\n    return NextResponse.redirect(new URL('/login', req.nextUrl))\n  }\n\n  // 6. Redirect to /dashboard if the user is authenticated\n  if (\n    isPublicRoute &&\n    session?.userId &&\n    !req.nextUrl.pathname.startsWith('/dashboard')\n  ) {\n    return NextResponse.redirect(new URL('/dashboard', req.nextUrl))\n  }\n\n  return NextResponse.next()\n}"
  },
  {
    "id": "authentication.mdx#46",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "return NextResponse.next()\n}\n\n// Routes Proxy should not run on\nexport const config = {\n  matcher: ['/((?!api|_next/static|_next/image|.*\\\\.png$).*)'],\n}"
  },
  {
    "id": "authentication.mdx#47",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\nWhile Proxy can be useful for initial checks, it should not be your only line of defense in protecting your data. The majority of security checks should be performed as close as possible to your data source, see [Data Access Layer](#creating-a-data-access-layer-dal) for more information.\n\n> **Tips**:\n>\n> - In Proxy, you can also read cookies using `req.cookies.get('session').value`.\n> - Proxy uses the Node.js runtime, check if your Auth library and session management library are compatible. You may need to use [Middleware](https://github.com/vercel/next.js/blob/v15.5.6/docs/01-app/03-api-reference/03-file-conventions/middleware.mdx) if your Auth library only supports [Edge Runtime](/docs/app/api-reference/edge)\n> - You can use the `matcher` property in the Proxy to specify which routes Proxy should run on. Although, for auth, it's recommended Proxy runs on all routes.\n\n<AppOnly>"
  },
  {
    "id": "authentication.mdx#48",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "### Creating a Data Access Layer (DAL)\n\nWe recommend creating a DAL to centralize your data requests and authorization logic.\n\nThe DAL should include a function that verifies the user's session as they interact with your application. At the very least, the function should check if the session is valid, then redirect or return the user information needed to make further requests.\n\nFor example, create a separate file for your DAL that includes a `verifySession()` function. Then use React's [cache](https://react.dev/reference/react/cache) API to memoize the return value of the function during a React render pass:\n\n```tsx filename=\"app/lib/dal.ts\" switcher\nimport 'server-only'\n\nimport { cookies } from 'next/headers'\nimport { decrypt } from '@/app/lib/session'\n\nexport const verifySession = cache(async () => {\n  const cookie = (await cookies()).get('session')?.value\n  const session = await decrypt(cookie)\n\n  if (!session?.userId) {\n    redirect('/login')\n  }\n\n  return { isAuth: true, userId: session.userId }\n})"
  },
  {
    "id": "authentication.mdx#49",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"app/lib/dal.js\" switcher\nimport 'server-only'\n\nimport { cookies } from 'next/headers'\nimport { decrypt } from '@/app/lib/session'\n\nexport const verifySession = cache(async () => {\n  const cookie = (await cookies()).get('session')?.value\n  const session = await decrypt(cookie)\n\n  if (!session.userId) {\n    redirect('/login')\n  }\n\n  return { isAuth: true, userId: session.userId }\n})\n```\n\nYou can then invoke the `verifySession()` function in your data requests, Server Actions, Route Handlers:\n\n```tsx filename=\"app/lib/dal.ts\" switcher\nexport const getUser = cache(async () => {\n  const session = await verifySession()\n  if (!session) return null\n\n  try {\n    const data = await db.query.users.findMany({\n      where: eq(users.id, session.userId),\n      // Explicitly return the columns you need rather than the whole user object\n      columns: {\n        id: true,\n        name: true,\n        email: true,\n      },\n    })\n\n    const user = data[0]\n\n    return user\n  } catch (error) {\n    console.log('Failed to fetch user')\n    return null\n  }\n})"
  },
  {
    "id": "authentication.mdx#50",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/lib/dal.js\" switcher\nexport const getUser = cache(async () => {\n  const session = await verifySession()\n  if (!session) return null\n\n  try {\n    const data = await db.query.users.findMany({\n      where: eq(users.id, session.userId),\n      // Explicitly return the columns you need rather than the whole user object\n      columns: {\n        id: true,\n        name: true,\n        email: true,\n      },\n    })\n\n    const user = data[0]\n\n    return user\n  } catch (error) {\n    console.log('Failed to fetch user')\n    return null\n  }\n})"
  },
  {
    "id": "authentication.mdx#51",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n> **Tip**:\n>\n> - A DAL can be used to protect data fetched at request time. However, for static routes that share data between users, data will be fetched at build time and not at request time. Use [Proxy](#optimistic-checks-with-proxy-optional) to protect static routes.\n> - For secure checks, you can check if the session is valid by comparing the session ID with your database. Use React's [cache](https://react.dev/reference/react/cache) function to avoid unnecessary duplicate requests to the database during a render pass.\n> - You may wish to consolidate related data requests in a JavaScript class that runs `verifySession()` before any methods."
  },
  {
    "id": "authentication.mdx#52",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "### Using Data Transfer Objects (DTO)\n\nWhen retrieving data, it's recommended you return only the necessary data that will be used in your application, and not entire objects. For example, if you're fetching user data, you might only return the user's ID and name, rather than the entire user object which could contain passwords, phone numbers, etc.\n\nHowever, if you have no control over the returned data structure, or are working in a team where you want to avoid whole objects being passed to the client, you can use strategies such as specifying what fields are safe to be exposed to the client.\n\n```tsx filename=\"app/lib/dto.ts\" switcher\nimport 'server-only'\nimport { getUser } from '@/app/lib/dal'\n\nfunction canSeeUsername(viewer: User) {\n  return true\n}\n\nfunction canSeePhoneNumber(viewer: User, team: string) {\n  return viewer.isAdmin || team === viewer.team\n}\n\nexport async function getProfileDTO(slug: string) {\n  const data = await db.query.users.findMany({\n    where: eq(users.slug, slug),\n    // Return specific columns here\n  })\n  const user = data[0]\n\n  const currentUser = await getUser(user.id)"
  },
  {
    "id": "authentication.mdx#53",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "const currentUser = await getUser(user.id)\n\n  // Or return only what's specific to the query here\n  return {\n    username: canSeeUsername(currentUser) ? user.username : null,\n    phonenumber: canSeePhoneNumber(currentUser, user.team)\n      ? user.phonenumber\n      : null,\n  }\n}"
  },
  {
    "id": "authentication.mdx#54",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"app/lib/dto.js\" switcher\nimport 'server-only'\nimport { getUser } from '@/app/lib/dal'\n\nfunction canSeeUsername(viewer) {\n  return true\n}\n\nfunction canSeePhoneNumber(viewer, team) {\n  return viewer.isAdmin || team === viewer.team\n}\n\nexport async function getProfileDTO(slug) {\n  const data = await db.query.users.findMany({\n    where: eq(users.slug, slug),\n    // Return specific columns here\n  })\n  const user = data[0]\n\n  const currentUser = await getUser(user.id)\n\n  // Or return only what's specific to the query here\n  return {\n    username: canSeeUsername(currentUser) ? user.username : null,\n    phonenumber: canSeePhoneNumber(currentUser, user.team)\n      ? user.phonenumber\n      : null,\n  }\n}"
  },
  {
    "id": "authentication.mdx#55",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\nBy centralizing your data requests and authorization logic in a DAL and using DTOs, you can ensure that all data requests are secure and consistent, making it easier to maintain, audit, and debug as your application scales.\n\n> **Good to know**:\n>\n> - There are a couple of different ways you can define a DTO, from using `toJSON()`, to individual functions like the example above, or JS classes. Since these are JavaScript patterns and not a React or Next.js feature, we recommend doing some research to find the best pattern for your application.\n> - Learn more about security best practices in our [Security in Next.js article](/blog/security-nextjs-server-components-actions)."
  },
  {
    "id": "authentication.mdx#56",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "### Server Components\n\nAuth check in [Server Components](/docs/app/getting-started/server-and-client-components) are useful for role-based access. For example, to conditionally render components based on the user's role:\n\n```tsx filename=\"app/dashboard/page.tsx\" switcher\nimport { verifySession } from '@/app/lib/dal'\n\nexport default async function Dashboard() {\n  const session = await verifySession()\n  const userRole = session?.user?.role // Assuming 'role' is part of the session object\n\n  if (userRole === 'admin') {\n    return <AdminDashboard />\n  } else if (userRole === 'user') {\n    return <UserDashboard />\n  } else {\n    redirect('/login')\n  }\n}\n```\n\n```jsx filename=\"app/dashboard/page.jsx\" switcher\nimport { verifySession } from '@/app/lib/dal'\n\nexport default async function Dashboard() {\n  const session = await verifySession()\n  const userRole = session?.user?.role // Assuming 'role' is part of the session object\n\n  if (userRole === 'admin') {\n    return <AdminDashboard />\n  } else if (userRole === 'user') {\n    return <UserDashboard />\n  } else {\n    redirect('/login')\n  }\n}"
  },
  {
    "id": "authentication.mdx#57",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\nIn the example, we use the `verifySession()` function from our DAL to check for 'admin', 'user', and unauthorized roles. This pattern ensures that each user interacts only with components appropriate to their role."
  },
  {
    "id": "authentication.mdx#58",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "### Layouts and auth checks\n\nDue to [Partial Rendering](/docs/app/getting-started/linking-and-navigating#client-side-transitions), be cautious when doing checks in [Layouts](/docs/app/api-reference/file-conventions/layout) as these don't re-render on navigation, meaning the user session won't be checked on every route change.\n\nInstead, you should do the checks close to your data source or the component that'll be conditionally rendered.\n\nFor example, consider a shared layout that fetches the user data and displays the user image in a nav. Instead of doing the auth check in the layout, you should fetch the user data (`getUser()`) in the layout and do the auth check in your DAL.\n\nThis guarantees that wherever `getUser()` is called within your application, the auth check is performed, and prevents developers forgetting to check the user is authorized to access the data.\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default async function Layout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  const user = await getUser();\n\n  return (\n    // ...\n  )\n}"
  },
  {
    "id": "authentication.mdx#59",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default async function Layout({ children }) {\n  const user = await getUser();\n\n  return (\n    // ...\n  )\n}\n```\n\n```ts filename=\"app/lib/dal.ts\" switcher\nexport const getUser = cache(async () => {\n  const session = await verifySession()\n  if (!session) return null\n\n  // Get user ID from session and fetch data\n})\n```\n\n```js filename=\"app/lib/dal.js\" switcher\nexport const getUser = cache(async () => {\n  const session = await verifySession()\n  if (!session) return null\n\n  // Get user ID from session and fetch data\n})\n```\n\n> **Good to know:**\n>\n> - A common pattern in SPAs is to `return null` in a layout or a top-level component if a user is not authorized. This pattern is **not recommended** since Next.js applications have multiple entry points, which will not prevent nested route segments and Server Actions from being accessed."
  },
  {
    "id": "authentication.mdx#60",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "### Server Actions\n\nTreat [Server Actions](/docs/app/getting-started/updating-data) with the same security considerations as public-facing API endpoints, and verify if the user is allowed to perform a mutation.\n\nIn the example below, we check the user's role before allowing the action to proceed:\n\n```ts filename=\"app/lib/actions.ts\" switcher\n'use server'\nimport { verifySession } from '@/app/lib/dal'\n\nexport async function serverAction(formData: FormData) {\n  const session = await verifySession()\n  const userRole = session?.user?.role\n\n  // Return early if user is not authorized to perform the action\n  if (userRole !== 'admin') {\n    return null\n  }\n\n  // Proceed with the action for authorized users\n}\n```\n\n```js filename=\"app/lib/actions.js\" switcher\n'use server'\nimport { verifySession } from '@/app/lib/dal'\n\nexport async function serverAction() {\n  const session = await verifySession()\n  const userRole = session.user.role\n\n  // Return early if user is not authorized to perform the action\n  if (userRole !== 'admin') {\n    return null\n  }\n\n  // Proceed with the action for authorized users\n}\n```"
  },
  {
    "id": "authentication.mdx#61",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "### Route Handlers\n\nTreat [Route Handlers](/docs/app/api-reference/file-conventions/route) with the same security considerations as public-facing API endpoints, and verify if the user is allowed to access the Route Handler.\n\nFor example:\n\n```ts filename=\"app/api/route.ts\" switcher\nimport { verifySession } from '@/app/lib/dal'\n\nexport async function GET() {\n  // User authentication and role verification\n  const session = await verifySession()\n\n  // Check if the user is authenticated\n  if (!session) {\n    // User is not authenticated\n    return new Response(null, { status: 401 })\n  }\n\n  // Check if the user has the 'admin' role\n  if (session.user.role !== 'admin') {\n    // User is authenticated but does not have the right permissions\n    return new Response(null, { status: 403 })\n  }\n\n  // Continue for authorized users\n}"
  },
  {
    "id": "authentication.mdx#62",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"app/api/route.js\" switcher\nimport { verifySession } from '@/app/lib/dal'\n\nexport async function GET() {\n  // User authentication and role verification\n  const session = await verifySession()\n\n  // Check if the user is authenticated\n  if (!session) {\n    // User is not authenticated\n    return new Response(null, { status: 401 })\n  }\n\n  // Check if the user has the 'admin' role\n  if (session.user.role !== 'admin') {\n    // User is authenticated but does not have the right permissions\n    return new Response(null, { status: 403 })\n  }\n\n  // Continue for authorized users\n}\n```\n\nThe example above demonstrates a Route Handler with a two-tier security check. It first checks for an active session, and then verifies if the logged-in user is an 'admin'."
  },
  {
    "id": "authentication.mdx#63",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "## Context Providers\n\nUsing context providers for auth works due to [interleaving](/docs/app/getting-started/server-and-client-components#examples#interleaving-server-and-client-components). However, React `context` is not supported in Server Components, making them only applicable to Client Components.\n\nThis works, but any child Server Components will be rendered on the server first, and will not have access to the context provider’s session data:\n\n```tsx filename=\"app/layout.ts\" switcher\nimport { ContextProvider } from 'auth-lib'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <ContextProvider>{children}</ContextProvider>\n      </body>\n    </html>\n  )\n}\n```\n\n```tsx filename=\"app/ui/profile.ts switcher\n'use client';\n\nimport { useSession } from \"auth-lib\";\n\nexport default function Profile() {\n  const { userId } = useSession();\n  const { data } = useSWR(`/api/user/${userId}`, fetcher)\n\n  return (\n    // ...\n  );\n}"
  },
  {
    "id": "authentication.mdx#64",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/ui/profile.js switcher\n'use client';\n\nimport { useSession } from \"auth-lib\";\n\nexport default function Profile() {\n  const { userId } = useSession();\n  const { data } = useSWR(`/api/user/${userId}`, fetcher)\n\n  return (\n    // ...\n  );\n}\n```\n\nIf session data is needed in Client Components (e.g. for client-side data fetching), use React’s [`taintUniqueValue`](https://react.dev/reference/react/experimental_taintUniqueValue) API to prevent sensitive session data from being exposed to the client.\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "authentication.mdx#65",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "### Creating a Data Access Layer (DAL)"
  },
  {
    "id": "authentication.mdx#66",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "#### Protecting API Routes\n\nAPI Routes in Next.js are essential for handling server-side logic and data management. It's crucial to secure these routes to ensure that only authorized users can access specific functionalities. This typically involves verifying the user's authentication status and their role-based permissions.\n\nHere's an example of securing an API Route:\n\n```ts filename=\"pages/api/route.ts\" switcher\nimport { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const session = await getSession(req)\n\n  // Check if the user is authenticated\n  if (!session) {\n    res.status(401).json({\n      error: 'User is not authenticated',\n    })\n    return\n  }\n\n  // Check if the user has the 'admin' role\n  if (session.user.role !== 'admin') {\n    res.status(401).json({\n      error: 'Unauthorized access: User does not have admin privileges.',\n    })\n    return\n  }\n\n  // Proceed with the route for authorized users\n  // ... implementation of the API Route\n}"
  },
  {
    "id": "authentication.mdx#67",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "```\n\n```js filename=\"pages/api/route.js\" switcher\nexport default async function handler(req, res) {\n  const session = await getSession(req)\n\n  // Check if the user is authenticated\n  if (!session) {\n    res.status(401).json({\n      error: 'User is not authenticated',\n    })\n    return\n  }\n\n  // Check if the user has the 'admin' role\n  if (session.user.role !== 'admin') {\n    res.status(401).json({\n      error: 'Unauthorized access: User does not have admin privileges.',\n    })\n    return\n  }\n\n  // Proceed with the route for authorized users\n  // ... implementation of the API Route\n}\n```\n\nThis example demonstrates an API Route with a two-tier security check for authentication and authorization. It first checks for an active session, and then verifies if the logged-in user is an 'admin'. This approach ensures secure access, limited to authenticated and authorized users, maintaining robust security for request processing.\n\n</PagesOnly>"
  },
  {
    "id": "authentication.mdx#68",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "## Resources\n\nNow that you've learned about authentication in Next.js, here are Next.js-compatible libraries and resources to help you implement secure authentication and session management:\n\n### Auth Libraries\n\n- [Auth0](https://auth0.com/docs/quickstart/webapp/nextjs)\n- [Better Auth](https://www.better-auth.com/docs/integrations/next)\n- [Clerk](https://clerk.com/docs/quickstarts/nextjs)\n- [Descope](https://docs.descope.com/getting-started/nextjs)\n- [Kinde](https://kinde.com/docs/developer-tools/nextjs-sdk)\n- [Logto](https://docs.logto.io/quick-starts/next-app-router)\n- [NextAuth.js](https://authjs.dev/getting-started/installation?framework=next.js)\n- [Ory](https://www.ory.sh/docs/getting-started/integrate-auth/nextjs)\n- [Stack Auth](https://docs.stack-auth.com/getting-started/setup)\n- [Supabase](https://supabase.com/docs/guides/getting-started/quickstarts/nextjs)\n- [Stytch](https://stytch.com/docs/guides/quickstarts/nextjs)\n- [WorkOS](https://workos.com/docs/user-management/nextjs)\n\n### Session Management Libraries\n\n- [Iron Session](https://github.com/vvo/iron-session)\n- [Jose](https://github.com/panva/jose)"
  },
  {
    "id": "authentication.mdx#69",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in your Next.js application."
    },
    "content": "## Further Reading\n\nTo continue learning about authentication and security, check out the following resources:\n\n- [How to think about security in Next.js](/blog/security-nextjs-server-components-actions)\n- [Understanding XSS Attacks](https://vercel.com/guides/understanding-xss-attacks)\n- [Understanding CSRF Attacks](https://vercel.com/guides/understanding-csrf-attacks)\n- [The Copenhagen Book](https://thecopenhagenbook.com/)"
  },
  {
    "id": "backend-for-frontend.mdx#0",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "---\ntitle: How to use Next.js as a backend for your frontend\nnav_title: Backend for Frontend\ndescription: Learn how to use Next.js as a backend framework\nrelated:\n  title: API Reference\n  description: Learn more about Route Handlers and Proxy\n  links:\n    - app/api-reference/file-conventions/route\n    - app/api-reference/file-conventions/proxy\n---\n\nNext.js supports the \"Backend for Frontend\" pattern. This lets you create public endpoints to handle HTTP requests and return any content type—not just HTML. You can also access data sources and perform side effects like updating remote data.\n\nIf you are starting a new project, using `create-next-app` with the `--api` flag automatically includes an example `route.ts` in your new project’s `app/` folder, demonstrating how to create an API endpoint.\n\n```bash filename=\"Terminal\"\nnpx create-next-app@latest --api"
  },
  {
    "id": "backend-for-frontend.mdx#1",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n> **Good to know**: Next.js backend capabilities are not a full backend replacement. They serve as an API layer that:\n>\n> - is publicly reachable\n> - handles any HTTP request\n> - can return any content type\n\nTo implement this pattern, use:\n\n- [Route Handlers](/docs/app/api-reference/file-conventions/route)\n- [`proxy`](/docs/app/api-reference/file-conventions/proxy)\n- In Pages Router, [API Routes](/docs/pages/building-your-application/routing/api-routes)"
  },
  {
    "id": "backend-for-frontend.mdx#2",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## Public Endpoints\n\nRoute Handlers are public HTTP endpoints. Any client can access them.\n\nCreate a Route Handler using the `route.ts` or `route.js` file convention:\n\n```ts filename=\"/app/api/route.ts\" switcher\nexport function GET(request: Request) {}\n```\n\n```js filename=\"/app/api/route.js\" switcher\nexport function GET(request) {}\n```\n\nThis handles `GET` requests sent to `/api`.\n\nUse `try/catch` blocks for operations that may throw an exception:\n\n```ts filename=\"/app/api/route.ts\" switcher\nimport { submit } from '@/lib/submit'\n\nexport async function POST(request: Request) {\n  try {\n    await submit(request)\n    return new Response(null, { status: 204 })\n  } catch (reason) {\n    const message =\n      reason instanceof Error ? reason.message : 'Unexpected error'\n\n    return new Response(message, { status: 500 })\n  }\n}"
  },
  {
    "id": "backend-for-frontend.mdx#3",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n```js filename=\"/app/api/route.js\" switcher\nimport { submit } from '@/lib/submit'\n\nexport async function POST(request) {\n  try {\n    await submit(request)\n    return new Response(null, { status: 204 })\n  } catch (reason) {\n    const message =\n      reason instanceof Error ? reason.message : 'Unexpected error'\n\n    return new Response(message, { status: 500 })\n  }\n}\n```\n\nAvoid exposing sensitive information in error messages sent to the client.\n\nTo restrict access, implement authentication and authorization. See [Authentication](/docs/app/guides/authentication)."
  },
  {
    "id": "backend-for-frontend.mdx#4",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## Content types\n\nRoute Handlers let you serve non-UI responses, including JSON, XML, images, files, and plain text.\n\nNext.js uses file conventions for common endpoints:\n\n- [`sitemap.xml`](/docs/app/api-reference/file-conventions/metadata/sitemap)\n- [`opengraph-image.jpg`, `twitter-image`](/docs/app/api-reference/file-conventions/metadata/opengraph-image)\n- [favicon, app icon, and apple-icon](/docs/app/api-reference/file-conventions/metadata/app-icons)\n- [`manifest.json`](/docs/app/api-reference/file-conventions/metadata/manifest)\n- [`robots.txt`](/docs/app/api-reference/file-conventions/metadata/robots)\n\nYou can also define custom ones, such as:\n\n- `llms.txt`\n- `rss.xml`\n- `.well-known`\n\nFor example, `app/rss.xml/route.ts` creates a Route Handler for `rss.xml`.\n\n```ts filename=\"/app/rss.xml/route.ts\" switcher\nexport async function GET(request: Request) {\n  const rssResponse = await fetch(/* rss endpoint */)\n  const rssData = await rssResponse.json()"
  },
  {
    "id": "backend-for-frontend.mdx#5",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```ts filename=\"/app/rss.xml/route.ts\" switcher\nexport async function GET(request: Request) {\n  const rssResponse = await fetch(/* rss endpoint */)\n  const rssData = await rssResponse.json()\n\n  const rssFeed = `<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<rss version=\"2.0\">\n<channel>\n <title>${rssData.title}</title>\n <description>${rssData.description}</description>\n <link>${rssData.link}</link>\n <copyright>${rssData.copyright}</copyright>\n ${rssData.items.map((item) => {\n   return `<item>\n    <title>${item.title}</title>\n    <description>${item.description}</description>\n    <link>${item.link}</link>\n    <pubDate>${item.publishDate}</pubDate>\n    <guid isPermaLink=\"false\">${item.guid}</guid>\n </item>`\n })}\n</channel>\n</rss>`\n\n  const headers = new Headers({ 'content-type': 'application/xml' })\n\n  return new Response(rssFeed, { headers })\n}"
  },
  {
    "id": "backend-for-frontend.mdx#6",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n```js filename=\"/app/rss.xml/route.js\" switcher\nexport async function GET(request) {\n  const rssResponse = await fetch(/* rss endpoint */)\n  const rssData = await rssResponse.json()\n\n  const rssFeed = `<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<rss version=\"2.0\">\n<channel>\n <title>${rssData.title}</title>\n <description>${rssData.description}</description>\n <link>${rssData.link}</link>\n <copyright>${rssData.copyright}</copyright>\n ${rssData.items.map((item) => {\n   return `<item>\n    <title>${item.title}</title>\n    <description>${item.description}</description>\n    <link>${item.link}</link>\n    <pubDate>${item.publishDate}</pubDate>\n    <guid isPermaLink=\"false\">${item.guid}</guid>\n </item>`\n })}\n</channel>\n</rss>`\n\n  const headers = new Headers({ 'content-type': 'application/xml' })\n\n  return new Response(rssFeed, { headers })\n}\n```\n\nSanitize any input used to generate markup."
  },
  {
    "id": "backend-for-frontend.mdx#7",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "### Consuming request payloads\n\nUse Request [instance methods](https://developer.mozilla.org/en-US/docs/Web/API/Request#instance_methods) like `.json()`, `.formData()`, or `.text()` to access the request body.\n\n`GET` and `HEAD` requests don’t carry a body.\n\n```ts filename=\"/app/api/echo-body/route.ts\" switcher\nexport async function POST(request: Request) {\n  const res = await request.json()\n  return Response.json({ res })\n}\n```\n\n```js filename=\"/app/api/echo-body/route.js\" switcher\nexport async function POST(request) {\n  const res = await request.json()\n  return Response.json({ res })\n}"
  },
  {
    "id": "backend-for-frontend.mdx#8",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n```js filename=\"/app/api/echo-body/route.js\" switcher\nexport async function POST(request) {\n  const res = await request.json()\n  return Response.json({ res })\n}\n```\n\n> **Good to know**: Validate data before passing it to other systems\n\n```ts filename=\"/app/api/send-email/route.ts\" switcher\nimport { sendMail, validateInputs } from '@/lib/email-transporter'\n\nexport async function POST(request: Request) {\n  const formData = await request.formData()\n  const email = formData.get('email')\n  const contents = formData.get('contents')\n\n  try {\n    await validateInputs({ email, contents })\n    const info = await sendMail({ email, contents })\n\n    return Response.json({ messageId: info.messageId })\n  } catch (reason) {\n    const message =\n      reason instanceof Error ? reason.message : 'Unexpected exception'\n\n    return new Response(message, { status: 500 })\n  }\n}"
  },
  {
    "id": "backend-for-frontend.mdx#9",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n```js filename=\"/app/api/send-email/route.js\" switcher\nimport { sendMail, validateInputs } from '@/lib/email-transporter'\n\nexport async function POST(request) {\n  const formData = await request.formData()\n  const email = formData.get('email')\n  const contents = formData.get('contents')\n\n  try {\n    await validateInputs({ email, contents })\n    const info = await sendMail({ email, contents })\n\n    return Response.json({ messageId: info.messageId })\n  } catch (reason) {\n    const message =\n      reason instanceof Error ? reason.message : 'Unexpected exception'\n\n    return new Response(message, { status: 500 })\n  }\n}\n```\n\nYou can only read the request body once. Clone the request if you need to read it again:\n\n```ts filename=\"/app/api/clone/route.ts\" switcher\nexport async function POST(request: Request) {\n  try {\n    const clonedRequest = request.clone()\n\n    await request.body()\n    await clonedRequest.body()\n    await request.body() // Throws error\n\n    return new Response(null, { status: 204 })\n  } catch {\n    return new Response(null, { status: 500 })\n  }\n}"
  },
  {
    "id": "backend-for-frontend.mdx#10",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n```js filename=\"/app/api/clone/route.js\" switcher\nexport async function POST(request) {\n  try {\n    const clonedRequest = request.clone()\n\n    await request.body()\n    await clonedRequest.body()\n    await request.body() // Throws error\n\n    return new Response(null, { status: 204 })\n  } catch {\n    return new Response(null, { status: 500 })\n  }\n}\n```"
  },
  {
    "id": "backend-for-frontend.mdx#11",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## Manipulating data\n\nRoute Handlers can transform, filter, and aggregate data from one or more sources. This keeps logic out of the frontend and avoids exposing internal systems.\n\nYou can also offload heavy computations to the server and reduce client battery and data usage.\n\n```ts file=\"/app/api/weather/route.ts\" switcher\nimport { parseWeatherData } from '@/lib/weather'\n\nexport async function POST(request: Request) {\n  const body = await request.json()\n  const searchParams = new URLSearchParams({ lat: body.lat, lng: body.lng })\n\n  try {\n    const weatherResponse = await fetch(`${weatherEndpoint}?${searchParams}`)\n\n    if (!weatherResponse.ok) {\n      /* handle error */\n    }\n\n    const weatherData = await weatherResponse.text()\n    const payload = parseWeatherData.asJSON(weatherData)\n\n    return new Response(payload, { status: 200 })\n  } catch (reason) {\n    const message =\n      reason instanceof Error ? reason.message : 'Unexpected exception'\n\n    return new Response(message, { status: 500 })\n  }\n}"
  },
  {
    "id": "backend-for-frontend.mdx#12",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n```js file=\"/app/api/weather/route.js\" switcher\nimport { parseWeatherData } from '@/lib/weather'\n\nexport async function POST(request) {\n  const body = await request.json()\n  const searchParams = new URLSearchParams({ lat: body.lat, lng: body.lng })\n\n  try {\n    const weatherResponse = await fetch(`${weatherEndpoint}?${searchParams}`)\n\n    if (!weatherResponse.ok) {\n      /* handle error */\n    }\n\n    const weatherData = await weatherResponse.text()\n    const payload = parseWeatherData.asJSON(weatherData)\n\n    return new Response(payload, { status: 200 })\n  } catch (reason) {\n    const message =\n      reason instanceof Error ? reason.message : 'Unexpected exception'\n\n    return new Response(message, { status: 500 })\n  }\n}\n```\n\n> **Good to know**: This example uses `POST` to avoid putting geo-location data in the URL. `GET` requests may be cached or logged, which could expose sensitive info."
  },
  {
    "id": "backend-for-frontend.mdx#13",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## Proxying to a backend\n\nYou can use a Route Handler as a `proxy` to another backend. Add validation logic before forwarding the request.\n\n```ts filename=\"/app/api/[...slug]/route.ts\" switcher\nimport { isValidRequest } from '@/lib/utils'\n\nexport async function POST(request: Request, { params }) {\n  const clonedRequest = request.clone()\n  const isValid = await isValidRequest(clonedRequest)\n\n  if (!isValid) {\n    return new Response(null, { status: 400, statusText: 'Bad Request' })\n  }\n\n  const { slug } = await params\n  const pathname = slug.join('/')\n  const proxyURL = new URL(pathname, 'https://nextjs.org')\n  const proxyRequest = new Request(proxyURL, request)\n\n  try {\n    return fetch(proxyRequest)\n  } catch (reason) {\n    const message =\n      reason instanceof Error ? reason.message : 'Unexpected exception'\n\n    return new Response(message, { status: 500 })\n  }\n}"
  },
  {
    "id": "backend-for-frontend.mdx#14",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n```js filename=\"/app/api/[...slug]/route.js\" switcher\nimport { isValidRequest } from '@/lib/utils'\n\nexport async function POST(request, { params }) {\n  const clonedRequest = request.clone()\n  const isValid = await isValidRequest(clonedRequest)\n\n  if (!isValid) {\n    return new Response(null, { status: 400, statusText: 'Bad Request' })\n  }\n\n  const { slug } = await params\n  const pathname = slug.join('/')\n  const proxyURL = new URL(pathname, 'https://nextjs.org')\n  const proxyRequest = new Request(proxyURL, request)\n\n  try {\n    return fetch(proxyRequest)\n  } catch (reason) {\n    const message =\n      reason instanceof Error ? reason.message : 'Unexpected exception'\n\n    return new Response(message, { status: 500 })\n  }\n}\n```\n\nOr use:\n\n- `proxy` [rewrites](#proxy)\n- [`rewrites`](/docs/app/api-reference/config/next-config-js/rewrites) in `next.config.js`."
  },
  {
    "id": "backend-for-frontend.mdx#15",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## NextRequest and NextResponse\n\nNext.js extends the [`Request`](https://developer.mozilla.org/en-US/docs/Web/API/Request) and [`Response`](https://developer.mozilla.org/en-US/docs/Web/API/Response) Web APIs with methods that simplify common operations. These extensions are available in both Route Handlers and Proxy.\n\nBoth provide methods for reading and manipulating cookies.\n\n`NextRequest` includes the [`nextUrl`](/docs/app/api-reference/functions/next-request#nexturl) property, which exposes parsed values from the incoming request, for example, it makes it easier to access request pathname and search params.\n\n`NextResponse` provides helpers like `next()`, `json()`, `redirect()`, and `rewrite()`.\n\nYou can pass `NextRequest` to any function expecting `Request`. Likewise, you can return `NextResponse` where a `Response` is expected.\n\n```ts filename=\"/app/echo-pathname/route.ts\" switcher\nimport { type NextRequest, NextResponse } from 'next/server'\n\nexport async function GET(request: NextRequest) {\n  const nextUrl = request.nextUrl\n\n  if (nextUrl.searchParams.get('redirect')) {\n    return NextResponse.redirect(new URL('/', request.url))\n  }"
  },
  {
    "id": "backend-for-frontend.mdx#16",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "export async function GET(request: NextRequest) {\n  const nextUrl = request.nextUrl\n\n  if (nextUrl.searchParams.get('redirect')) {\n    return NextResponse.redirect(new URL('/', request.url))\n  }\n\n  if (nextUrl.searchParams.get('rewrite')) {\n    return NextResponse.rewrite(new URL('/', request.url))\n  }\n\n  return NextResponse.json({ pathname: nextUrl.pathname })\n}"
  },
  {
    "id": "backend-for-frontend.mdx#17",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n```js filename=\"/app/echo-pathname/route.js\" switcher\nimport { NextResponse } from 'next/server'\n\nexport async function GET(request) {\n  const nextUrl = request.nextUrl\n\n  if (nextUrl.searchParams.get('redirect')) {\n    return NextResponse.redirect(new URL('/', request.url))\n  }\n\n  if (nextUrl.searchParams.get('rewrite')) {\n    return NextResponse.rewrite(new URL('/', request.url))\n  }\n\n  return NextResponse.json({ pathname: nextUrl.pathname })\n}\n```\n\nLearn more about [`NextRequest`](/docs/app/api-reference/functions/next-request) and [`NextResponse`](/docs/app/api-reference/functions/next-response)."
  },
  {
    "id": "backend-for-frontend.mdx#18",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## Webhooks and callback URLs\n\nUse Route Handlers to receive event notifications from third-party applications.\n\nFor example, revalidate a route when content changes in a CMS. Configure the CMS to call a specific endpoint on changes.\n\n```ts filename=\"/app/webhook/route.ts\" switcher\nimport { type NextRequest, NextResponse } from 'next/server'\n\nexport async function GET(request: NextRequest) {\n  const token = request.nextUrl.searchParams.get('token')\n\n  if (token !== process.env.REVALIDATE_SECRET_TOKEN) {\n    return NextResponse.json({ success: false }, { status: 401 })\n  }\n\n  const tag = request.nextUrl.searchParams.get('tag')\n\n  if (!tag) {\n    return NextResponse.json({ success: false }, { status: 400 })\n  }\n\n  revalidateTag(tag)\n\n  return NextResponse.json({ success: true })\n}"
  },
  {
    "id": "backend-for-frontend.mdx#19",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n```js filename=\"/app/webhook/route.js\" switcher\nimport { NextResponse } from 'next/server'\n\nexport async function GET(request) {\n  const token = request.nextUrl.searchParams.get('token')\n\n  if (token !== process.env.REVALIDATE_SECRET_TOKEN) {\n    return NextResponse.json({ success: false }, { status: 401 })\n  }\n\n  const tag = request.nextUrl.searchParams.get('tag')\n\n  if (!tag) {\n    return NextResponse.json({ success: false }, { status: 400 })\n  }\n\n  revalidateTag(tag)\n\n  return NextResponse.json({ success: true })\n}"
  },
  {
    "id": "backend-for-frontend.mdx#20",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\nCallback URLs are another use case. When a user completes a third-party flow, the third party sends them to a callback URL. Use a Route Handler to verify the response and decide where to redirect the user.\n\n```ts filename=\"/app/auth/callback/route.ts\" switcher\nimport { type NextRequest, NextResponse } from 'next/server'\n\nexport async function GET(request: NextRequest) {\n  const token = request.nextUrl.searchParams.get('session_token')\n  const redirectUrl = request.nextUrl.searchParams.get('redirect_url')\n\n  const response = NextResponse.redirect(new URL(redirectUrl, request.url))\n\n  response.cookies.set({\n    value: token,\n    name: '_token',\n    path: '/',\n    secure: true,\n    httpOnly: true,\n    expires: undefined, // session cookie\n  })\n\n  return response\n}"
  },
  {
    "id": "backend-for-frontend.mdx#21",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n```js filename=\"/app/auth/callback/route.js\" switcher\nimport { NextResponse } from 'next/server'\n\nexport async function GET(request) {\n  const token = request.nextUrl.searchParams.get('session_token')\n  const redirectUrl = request.nextUrl.searchParams.get('redirect_url')\n\n  const response = NextResponse.redirect(new URL(redirectUrl, request.url))\n\n  response.cookies.set({\n    value: token,\n    name: '_token',\n    path: '/',\n    secure: true,\n    httpOnly: true,\n    expires: undefined, // session cookie\n  })\n\n  return response\n}\n```"
  },
  {
    "id": "backend-for-frontend.mdx#22",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## Redirects\n\n```ts filename=\"app/api/route.ts\" switcher\nimport { redirect } from 'next/navigation'\n\nexport async function GET(request: Request) {\n  redirect('https://nextjs.org/')\n}\n```\n\n```js filename=\"app/api/route.js\" switcher\nimport { redirect } from 'next/navigation'\n\nexport async function GET(request) {\n  redirect('https://nextjs.org/')\n}\n```\n\nLearn more about redirects in [`redirect`](/docs/app/api-reference/functions/redirect) and [`permanentRedirect`](/docs/app/api-reference/functions/permanentRedirect)"
  },
  {
    "id": "backend-for-frontend.mdx#23",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## Proxy\n\nOnly one `proxy` file is allowed per project. Use `config.matcher` to target specific paths. Learn more about [`proxy`](/docs/app/api-reference/file-conventions/proxy).\n\nUse `proxy` to generate a response before the request reaches a route path.\n\n```ts filename=\"proxy.ts\" switcher\nimport { isAuthenticated } from '@lib/auth'\n\nexport const config = {\n  matcher: '/api/:function*',\n}\n\nexport function proxy(request: Request) {\n  if (!isAuthenticated(request)) {\n    return Response.json(\n      { success: false, message: 'authentication failed' },\n      { status: 401 }\n    )\n  }\n}\n```\n\n```js filename=\"proxy.js\" switcher\nimport { isAuthenticated } from '@lib/auth'\n\nexport const config = {\n  matcher: '/api/:function*',\n}\n\nexport function proxy(request) {\n  if (!isAuthenticated(request)) {\n    return Response.json(\n      { success: false, message: 'authentication failed' },\n      { status: 401 }\n    )\n  }\n}"
  },
  {
    "id": "backend-for-frontend.mdx#24",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\nYou can also proxy requests using `proxy`:\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextResponse } from 'next/server'\n\nexport function proxy(request: Request) {\n  if (request.nextUrl.pathname === '/proxy-this-path') {\n    const rewriteUrl = new URL('https://nextjs.org')\n    return NextResponse.rewrite(rewriteUrl)\n  }\n}\n```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\n\nexport function proxy(request) {\n  if (request.nextUrl.pathname === '/proxy-this-path') {\n    const rewriteUrl = new URL('https://nextjs.org')\n    return NextResponse.rewrite(rewriteUrl)\n  }\n}\n```\n\nAnother type of response `proxy` can produce are redirects:\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextResponse } from 'next/server'\n\nexport function proxy(request: Request) {\n  if (request.nextUrl.pathname === '/v1/docs') {\n    request.nextUrl.pathname = '/v2/docs'\n    return NextResponse.redirect(request.nextUrl)\n  }\n}"
  },
  {
    "id": "backend-for-frontend.mdx#25",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\n\nexport function proxy(request) {\n  if (request.nextUrl.pathname === '/v1/docs') {\n    request.nextUrl.pathname = '/v2/docs'\n    return NextResponse.redirect(request.nextUrl)\n  }\n}\n```"
  },
  {
    "id": "backend-for-frontend.mdx#26",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## Security\n\n### Working with headers\n\nBe deliberate about where headers go, and avoid directly passing incoming request headers to the outgoing response.\n\n- **Upstream request headers**: In Proxy, `NextResponse.next({ request: { headers } })` modifies the headers your server receives and does not expose them to the client.\n- **Response headers**: `new Response(..., { headers })`, `NextResponse.json(..., { headers })`, `NextResponse.next({ headers })`, or `response.headers.set(...)` send headers back to the client. If sensitive values were appended to these headers, they will be visible to clients.\n\nLearn more in [NextResponse headers in Proxy](/docs/app/api-reference/functions/next-response#next)."
  },
  {
    "id": "backend-for-frontend.mdx#27",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "### Rate limiting\n\nYou can implement rate limiting in your Next.js backend. In addition to code-based checks, enable any rate limiting features provided by your host.\n\n```ts filename=\"/app/resource/route.ts\" switcher\nimport { NextResponse } from 'next/server'\nimport { checkRateLimit } from '@/lib/rate-limit'\n\nexport async function POST(request: Request) {\n  const { rateLimited } = await checkRateLimit(request)\n\n  if (rateLimited) {\n    return NextResponse.json({ error: 'Rate limit exceeded' }, { status: 429 })\n  }\n\n  return new Response(null, { status: 204 })\n}\n```\n\n```js filename=\"/app/resource/route.js\" switcher\nimport { NextResponse } from 'next/server'\nimport { checkRateLimit } from '@/lib/rate-limit'\n\nexport async function POST(request) {\n  const { rateLimited } = await checkRateLimit(request)\n\n  if (rateLimited) {\n    return NextResponse.json({ error: 'Rate limit exceeded' }, { status: 429 })\n  }\n\n  return new Response(null, { status: 204 })\n}\n```"
  },
  {
    "id": "backend-for-frontend.mdx#28",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "### Verify payloads\n\nNever trust incoming request data. Validate content type and size, and sanitize against XSS before use.\n\nUse timeouts to prevent abuse and protect server resources.\n\nStore user-generated static assets in dedicated services. When possible, upload them from the browser and store the returned URI in your database to reduce request size.\n\n### Access to protected resources\n\nAlways verify credentials before granting access. Do not rely on proxy alone for authentication and authorization.\n\nRemove sensitive or unnecessary data from responses and backend logs.\n\nRotate credentials and API keys regularly."
  },
  {
    "id": "backend-for-frontend.mdx#29",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## Preflight Requests\n\nPreflight requests use the `OPTIONS` method to ask the server if a request is allowed based on origin, method, and headers.\n\nIf `OPTIONS` is not defined, Next.js adds it automatically and sets the `Allow` header based on the other defined methods.\n\n- [CORS](/docs/app/api-reference/file-conventions/route#cors)\n\n## Library patterns\n\nCommunity libraries often use the factory pattern for Route Handlers.\n\n```ts filename=\"/app/api/[...path]/route.ts\"\nimport { createHandler } from 'third-party-library'\n\nconst handler = createHandler({\n  /* library-specific options */\n})\n\nexport const GET = handler\n// or\nexport { handler as POST }\n```\n\nThis creates a shared handler for `GET` and `POST` requests. The library customizes behavior based on the `method` and `pathname` in the request.\n\nLibraries can also provide a `proxy` factory.\n\n```ts filename=\"proxy.ts\"\nimport { createMiddleware } from 'third-party-library'\n\nexport default createMiddleware()\n```\n\n> **Good to know**: Third-party libraries may still refer to `proxy` as `middleware`."
  },
  {
    "id": "backend-for-frontend.mdx#30",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## More examples\n\nSee more examples on using [Router Handlers](/docs/app/api-reference/file-conventions/route#examples) and the [`proxy`](/docs/app/api-reference/file-conventions/proxy#examples) API references.\n\nThese examples include, working with [Cookies](/docs/app/api-reference/file-conventions/route#cookies), [Headers](/docs/app/api-reference/file-conventions/route#headers), [Streaming](/docs/app/api-reference/file-conventions/route#streaming), Proxy [negative matching](/docs/app/api-reference/file-conventions/proxy#negative-matching), and other useful code snippets."
  },
  {
    "id": "backend-for-frontend.mdx#31",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "## Caveats\n\n### Server Components\n\nFetch data in Server Components directly from its source, not via Route Handlers.\n\nFor Server Components pre-rendered at build time, using Route Handlers will fail the build step. This is because, while building there is no server listening for these requests.\n\nFor Server Components rendered on demand, fetching from Route Handlers is slower due to the extra HTTP round trip between the handler and the render process.\n\n> A server side `fetch` request uses absolute URLs. This implies an HTTP round trip, to an external server. During development, your own development server acts as the external server. At build time there is no server, and at runtime, the server is available through your public facing domain.\n\nServer Components cover most data-fetching needs. However, fetching data client side might be necessary for:\n\n- Data that depends on client-only Web APIs:\n  - Geo-location API\n  - Storage API\n  - Audio API\n  - File API\n- Frequently polled data\n\nFor these, use community libraries like [`swr`](https://swr.vercel.app/) or [`react-query`](https://tanstack.com/query/latest/docs/framework/react/overview)."
  },
  {
    "id": "backend-for-frontend.mdx#32",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "### Server Actions\n\nServer Actions let you run server-side code from the client. Their primary purpose is to mutate data from your frontend client.\n\nServer Actions are queued. Using them for data fetching introduces sequential execution.\n\n### `export` mode\n\n`export` mode outputs a static site without a runtime server. Features that require the Next.js runtime are [not supported](/docs/app/guides/static-exports#unsupported-features), because this mode produces a static site, and no runtime server.\n\nIn `export mode`, only `GET` Route Handlers are supported, in combination with the [`dynamic`](/docs/app/api-reference/file-conventions/route-segment-config#dynamic) route segment config, set to `'force-static'`.\n\nThis can be used to generate static HTML, JSON, TXT, or other files.\n\n```js filename=\"app/hello-world/route.ts\"\nexport const dynamic = 'force-static'\n\nexport function GET() {\n  return new Response('Hello World', { status: 200 })\n}\n```"
  },
  {
    "id": "backend-for-frontend.mdx#33",
    "metadata": {
      "title": "How to use Next.js as a backend for your frontend",
      "description": "Learn how to use Next.js as a backend framework"
    },
    "content": "### Deployment environment\n\nSome hosts deploy Route Handlers as lambda functions. This means:\n\n- Route Handlers cannot share data between requests.\n- The environment may not support writing to File System.\n- Long-running handlers may be terminated due to timeouts.\n- WebSockets won’t work because the connection closes on timeout, or after the response is generated."
  },
  {
    "id": "caching.mdx#0",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "---\ntitle: Caching in Next.js\nnav_title: Caching\ndescription: An overview of caching mechanisms in Next.js.\n---\n\nNext.js improves your application's performance and reduces costs by caching rendering work and data requests. This page provides an in-depth look at Next.js caching mechanisms, the APIs you can use to configure them, and how they interact with each other.\n\n> **Good to know**: This page helps you understand how Next.js works under the hood but is **not** essential knowledge to be productive with Next.js. Most of Next.js' caching heuristics are determined by your API usage and have defaults for the best performance with zero or minimal configuration. If you instead want to jump to examples, [start here](/docs/app/getting-started/fetching-data)."
  },
  {
    "id": "caching.mdx#1",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "## Overview\n\nHere's a high-level overview of the different caching mechanisms and their purpose:\n\n| Mechanism                                   | What                       | Where  | Purpose                                         | Duration                        |\n| ------------------------------------------- | -------------------------- | ------ | ----------------------------------------------- | ------------------------------- |\n| [Request Memoization](#request-memoization) | Return values of functions | Server | Re-use data in a React Component tree           | Per-request lifecycle           |\n| [Data Cache](#data-cache)                   | Data                       | Server | Store data across user requests and deployments | Persistent (can be revalidated) |\n| [Full Route Cache](#full-route-cache)       | HTML and RSC payload       | Server | Reduce rendering cost and improve performance   | Persistent (can be revalidated) |\n| [Router Cache](#client-side-router-cache)   | RSC Payload                | Client | Reduce server requests on navigation            | User session or time-based      |"
  },
  {
    "id": "caching.mdx#2",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "By default, Next.js will cache as much as possible to improve performance and reduce cost. This means routes are **statically rendered** and data requests are **cached** unless you opt out. The diagram below shows the default caching behavior: when a route is statically rendered at build time and when a static route is first visited.\n\n<Image\n  alt=\"Diagram showing the default caching behavior in Next.js for the four mechanisms, with HIT, MISS and SET at build time and when a route is first visited.\"\n  srcLight=\"/docs/light/caching-overview.png\"\n  srcDark=\"/docs/dark/caching-overview.png\"\n  width=\"1600\"\n  height=\"1179\"\n/>\n\nCaching behavior changes depending on whether the route is statically or dynamically rendered, data is cached or uncached, and whether a request is part of an initial visit or a subsequent navigation. Depending on your use case, you can configure the caching behavior for individual routes and data requests.\n\nFetch caching is **not** supported in `proxy`. Any fetches done inside of your `proxy` will be uncached."
  },
  {
    "id": "caching.mdx#3",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "## Rendering Strategies\n\nTo understand how caching works in Next.js, it's helpful to understand the rendering strategies available. The rendering strategy determines when your route's HTML is generated, which directly impacts what can be cached.\n\n### Static Rendering\n\nWith Static Rendering, routes are rendered at **build time** or in the background after [data revalidation](/docs/app/guides/incremental-static-regeneration). The result is cached and can be reused across requests. Static routes are fully cached in the [Full Route Cache](#full-route-cache)."
  },
  {
    "id": "caching.mdx#4",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Dynamic Rendering\n\nWith Dynamic Rendering, routes are rendered at **request time**. This happens when your route uses request-specific information like cookies, headers, or search params.\n\nA route becomes dynamic when it uses any of these APIs:\n\n- [`cookies`](/docs/app/api-reference/functions/cookies)\n- [`headers`](/docs/app/api-reference/functions/headers)\n- [`connection`](/docs/app/api-reference/functions/connection)\n- [`draftMode`](/docs/app/api-reference/functions/draft-mode)\n- [`searchParams` prop](/docs/app/api-reference/file-conventions/page#searchparams-optional)\n- [`unstable_noStore`](/docs/app/api-reference/functions/unstable_noStore)\n- [`fetch`](/docs/app/api-reference/functions/fetch) with `{ cache: 'no-store' }`\n\nDynamic routes are not cached in the Full Route Cache, but can still use the [Data Cache](#data-cache) for data requests.\n\n> **Good to know**: You can use [Cache Components](/docs/app/getting-started/cache-components) to mix static and dynamic rendering within the same route."
  },
  {
    "id": "caching.mdx#5",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "## Request Memoization\n\nNext.js extends the [`fetch` API](#fetch) to automatically **memoize** requests that have the same URL and options. This means you can call a fetch function for the same data in multiple places in a React component tree while only executing it once.\n\n<Image\n  alt=\"Deduplicated Fetch Requests\"\n  srcLight=\"/docs/light/deduplicated-fetch-requests.png\"\n  srcDark=\"/docs/dark/deduplicated-fetch-requests.png\"\n  width=\"1600\"\n  height=\"857\"\n/>\n\nFor example, if you need to use the same data across a route (e.g. in a Layout, Page, and multiple components), you do not have to fetch data at the top of the tree, and forward props between components. Instead, you can fetch data in the components that need it without worrying about the performance implications of making multiple requests across the network for the same data.\n\n```tsx filename=\"app/example.tsx\" switcher\nasync function getItem() {\n  // The `fetch` function is automatically memoized and the result\n  // is cached\n  const res = await fetch('https://.../item/1')\n  return res.json()\n}\n\n// This function is called twice, but only executed the first time\nconst item = await getItem() // cache MISS"
  },
  {
    "id": "caching.mdx#6",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "// This function is called twice, but only executed the first time\nconst item = await getItem() // cache MISS\n\n// The second call could be anywhere in your route\nconst item = await getItem() // cache HIT"
  },
  {
    "id": "caching.mdx#7",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/example.js\" switcher\nasync function getItem() {\n  // The `fetch` function is automatically memoized and the result\n  // is cached\n  const res = await fetch('https://.../item/1')\n  return res.json()\n}\n\n// This function is called twice, but only executed the first time\nconst item = await getItem() // cache MISS\n\n// The second call could be anywhere in your route\nconst item = await getItem() // cache HIT"
  },
  {
    "id": "caching.mdx#8",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "```\n\n**How Request Memoization Works**\n\n<Image\n  alt=\"Diagram showing how fetch memoization works during React rendering.\"\n  srcLight=\"/docs/light/request-memoization.png\"\n  srcDark=\"/docs/dark/request-memoization.png\"\n  width=\"1600\"\n  height=\"742\"\n/>\n\n- While rendering a route, the first time a particular request is called, its result will not be in memory and it'll be a cache `MISS`.\n- Therefore, the function will be executed, and the data will be fetched from the external source, and the result will be stored in memory.\n- Subsequent function calls of the request in the same render pass will be a cache `HIT`, and the data will be returned from memory without executing the function.\n- Once the route has been rendered and the rendering pass is complete, memory is \"reset\" and all request memoization entries are cleared."
  },
  {
    "id": "caching.mdx#9",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "> **Good to know**:\n>\n> - Request memoization is a React feature, not a Next.js feature. It's included here to show how it interacts with the other caching mechanisms.\n> - Memoization only applies to the `GET` method in `fetch` requests.\n> - Memoization only applies to the React Component tree, this means:\n>   - It applies to `fetch` requests in `generateMetadata`, `generateStaticParams`, Layouts, Pages, and other Server Components.\n>   - It doesn't apply to `fetch` requests in Route Handlers as they are not a part of the React component tree.\n> - For cases where `fetch` is not suitable (e.g. some database clients, CMS clients, or GraphQL clients), you can use the [React `cache` function](#react-cache-function) to memoize functions."
  },
  {
    "id": "caching.mdx#10",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Duration\n\nThe cache lasts the lifetime of a server request until the React component tree has finished rendering.\n\n### Revalidating\n\nSince the memoization is not shared across server requests and only applies during rendering, there is no need to revalidate it.\n\n### Opting out\n\nMemoization only applies to the `GET` method in `fetch` requests, other methods, such as `POST` and `DELETE`, are not memoized. This default behavior is a React optimization and we do not recommend opting out of it.\n\nTo manage individual requests, you can use the [`signal`](https://developer.mozilla.org/en-US/docs/Web/API/AbortController/signal) property from [`AbortController`](https://developer.mozilla.org/en-US/docs/Web/API/AbortController).\n\n```js filename=\"app/example.js\"\nconst { signal } = new AbortController()\nfetch(url, { signal })\n```"
  },
  {
    "id": "caching.mdx#11",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "## Data Cache\n\nNext.js has a built-in Data Cache that **persists** the result of data fetches across incoming **server requests** and **deployments**. This is possible because Next.js extends the native `fetch` API to allow each request on the server to set its own persistent caching semantics.\n\n> **Good to know**: In the browser, the `cache` option of `fetch` indicates how a request will interact with the browser's HTTP cache, in Next.js, the `cache` option indicates how a server-side request will interact with the server's Data Cache.\n\nYou can use the [`cache`](#fetch-optionscache) and [`next.revalidate`](#fetch-optionsnextrevalidate) options of `fetch` to configure the caching behavior.\n\nIn development mode, `fetch` data is [reused for Hot Module Replacement (HMR)](/docs/app/api-reference/functions/fetch#fetch-default-auto-no-store-and-cache-no-store-not-showing-fresh-data-in-development), and caching options are ignored for [hard refreshes](/docs/app/api-reference/functions/fetch#hard-refresh-and-caching-in-development).\n\n**How the Data Cache Works**"
  },
  {
    "id": "caching.mdx#12",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "**How the Data Cache Works**\n\n<Image\n  alt=\"Diagram showing how cached and uncached fetch requests interact with the Data Cache. Cached requests are stored in the Data Cache, and memoized, uncached requests are fetched from the data source, not stored in the Data Cache, and memoized.\"\n  srcLight=\"/docs/light/data-cache.png\"\n  srcDark=\"/docs/dark/data-cache.png\"\n  width=\"1600\"\n  height=\"661\"\n/>\n\n- The first time a `fetch` request with the `'force-cache'` option is called during rendering, Next.js checks the Data Cache for a cached response.\n- If a cached response is found, it's returned immediately and [memoized](#request-memoization).\n- If a cached response is not found, the request is made to the data source, the result is stored in the Data Cache, and memoized.\n- For uncached data (e.g. no `cache` option defined or using `{ cache: 'no-store' }`), the result is always fetched from the data source, and memoized.\n- Whether the data is cached or uncached, the requests are always memoized to avoid making duplicate requests for the same data during a React render pass."
  },
  {
    "id": "caching.mdx#13",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "> **Differences between the Data Cache and Request Memoization**\n>\n> While both caching mechanisms help improve performance by re-using cached data, the Data Cache is persistent across incoming requests and deployments, whereas memoization only lasts the lifetime of a request."
  },
  {
    "id": "caching.mdx#14",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Duration\n\nThe Data Cache is persistent across incoming requests and deployments unless you revalidate or opt-out."
  },
  {
    "id": "caching.mdx#15",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Revalidating\n\nCached data can be revalidated in two ways, with:\n\n- **Time-based Revalidation**: Revalidate data after a certain amount of time has passed and a new request is made. This is useful for data that changes infrequently and freshness is not as critical.\n- **On-demand Revalidation:** Revalidate data based on an event (e.g. form submission). On-demand revalidation can use a tag-based or path-based approach to revalidate groups of data at once. This is useful when you want to ensure the latest data is shown as soon as possible (e.g. when content from your headless CMS is updated)."
  },
  {
    "id": "caching.mdx#16",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "#### Time-based Revalidation\n\nTo revalidate data at a timed interval, you can use the `next.revalidate` option of `fetch` to set the cache lifetime of a resource (in seconds).\n\n```js\n// Revalidate at most every hour\nfetch('https://...', { next: { revalidate: 3600 } })"
  },
  {
    "id": "caching.mdx#17",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "```\n\nAlternatively, you can use [Route Segment Config options](#segment-config-options) to configure all `fetch` requests in a segment or for cases where you're not able to use `fetch`.\n\n**How Time-based Revalidation Works**\n\n<Image\n  alt=\"Diagram showing how time-based revalidation works, after the revalidation period, stale data is returned for the first request, then data is revalidated.\"\n  srcLight=\"/docs/light/time-based-revalidation.png\"\n  srcDark=\"/docs/dark/time-based-revalidation.png\"\n  width=\"1600\"\n  height=\"1252\"\n/>\n\n- The first time a fetch request with `revalidate` is called, the data will be fetched from the external data source and stored in the Data Cache.\n- Any requests that are called within the specified timeframe (e.g. 60-seconds) will return the cached data.\n- After the timeframe, the next request will still return the cached (now stale) data.\n  - Next.js will trigger a revalidation of the data in the background.\n  - Once the data is fetched successfully, Next.js will update the Data Cache with the fresh data.\n  - If the background revalidation fails, the previous data will be kept unaltered."
  },
  {
    "id": "caching.mdx#18",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "This is similar to [**stale-while-revalidate**](https://web.dev/articles/stale-while-revalidate) behavior."
  },
  {
    "id": "caching.mdx#19",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "#### On-demand Revalidation\n\nData can be revalidated on-demand by path ([`revalidatePath`](#revalidatepath)) or by cache tag ([`revalidateTag`](#fetch-optionsnexttags-and-revalidatetag)).\n\n**How On-Demand Revalidation Works**\n\n<Image\n  alt=\"Diagram showing how on-demand revalidation works, the Data Cache is updated with fresh data after a revalidation request.\"\n  srcLight=\"/docs/light/on-demand-revalidation.png\"\n  srcDark=\"/docs/dark/on-demand-revalidation.png\"\n  width=\"1600\"\n  height=\"1082\"\n/>\n\n- The first time a `fetch` request is called, the data will be fetched from the external data source and stored in the Data Cache.\n- When an on-demand revalidation is triggered, the appropriate cache entries will be purged from the cache.\n  - This is different from time-based revalidation, which keeps the stale data in the cache until the fresh data is fetched.\n- The next time a request is made, it will be a cache `MISS` again, and the data will be fetched from the external data source and stored in the Data Cache."
  },
  {
    "id": "caching.mdx#20",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Opting out\n\nIf you do _not_ want to cache the response from `fetch`, you can do the following:\n\n```js\nlet data = await fetch('https://api.vercel.app/blog', { cache: 'no-store' })\n```"
  },
  {
    "id": "caching.mdx#21",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "## Full Route Cache\n\n> **Related terms**:\n>\n> You may see the terms **Automatic Static Optimization**, **Static Site Generation**, or **Static Rendering** being used interchangeably to refer to the process of rendering and caching routes of your application at build time.\n\nNext.js automatically renders and caches routes at build time. This is an optimization that allows you to serve the cached route instead of rendering on the server for every request, resulting in faster page loads.\n\nTo understand how the Full Route Cache works, it's helpful to look at how React handles rendering, and how Next.js caches the result:"
  },
  {
    "id": "caching.mdx#22",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### 1. React Rendering on the Server\n\nOn the server, Next.js uses React's APIs to orchestrate rendering. The rendering work is split into chunks: by individual routes segments and Suspense boundaries.\n\nEach chunk is rendered in two steps:\n\n1. React renders Server Components into a special data format, optimized for streaming, called the **React Server Component Payload**.\n2. Next.js uses the React Server Component Payload and Client Component JavaScript instructions to render **HTML** on the server.\n\nThis means we don't have to wait for everything to render before caching the work or sending a response. Instead, we can stream a response as work is completed."
  },
  {
    "id": "caching.mdx#23",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "This means we don't have to wait for everything to render before caching the work or sending a response. Instead, we can stream a response as work is completed.\n\n> **What is the React Server Component Payload?**\n>\n> The React Server Component Payload is a compact binary representation of the rendered React Server Components tree. It's used by React on the client to update the browser's DOM. The React Server Component Payload contains:\n>\n> - The rendered result of Server Components\n> - Placeholders for where Client Components should be rendered and references to their JavaScript files\n> - Any props passed from a Server Component to a Client Component\n>\n> To learn more, see the [Server Components](/docs/app/getting-started/server-and-client-components) documentation."
  },
  {
    "id": "caching.mdx#24",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### 2. Next.js Caching on the Server (Full Route Cache)\n\n<Image\n  alt=\"Default behavior of the Full Route Cache, showing how the React Server Component Payload and HTML are cached on the server for statically rendered routes.\"\n  srcLight=\"/docs/light/full-route-cache.png\"\n  srcDark=\"/docs/dark/full-route-cache.png\"\n  width=\"1600\"\n  height=\"888\"\n/>\n\nThe default behavior of Next.js is to cache the rendered result (React Server Component Payload and HTML) of a route on the server. This applies to statically rendered routes at build time, or during revalidation.\n\n### 3. React Hydration and Reconciliation on the Client\n\nAt request time, on the client:\n\n1. The HTML is used to immediately show a fast non-interactive initial preview of the Client and Server Components.\n2. The React Server Components Payload is used to reconcile the Client and rendered Server Component trees, and update the DOM.\n3. The JavaScript instructions are used to [hydrate](https://react.dev/reference/react-dom/client/hydrateRoot) Client Components and make the application interactive."
  },
  {
    "id": "caching.mdx#25",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### 4. Next.js Caching on the Client (Router Cache)\n\nThe React Server Component Payload is stored in the client-side [Router Cache](#client-side-router-cache) - a separate in-memory cache, split by individual route segment. This Router Cache is used to improve the navigation experience by storing previously visited routes and prefetching future routes.\n\n### 5. Subsequent Navigations\n\nOn subsequent navigations or during prefetching, Next.js will check if the React Server Components Payload is stored in the Router Cache. If so, it will skip sending a new request to the server.\n\nIf the route segments are not in the cache, Next.js will fetch the React Server Components Payload from the server, and populate the Router Cache on the client."
  },
  {
    "id": "caching.mdx#26",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Static and Dynamic Rendering\n\nWhether a route is cached or not at build time depends on whether it's statically or dynamically rendered. Static routes are cached by default, whereas dynamic routes are rendered at request time, and not cached.\n\nThis diagram shows the difference between statically and dynamically rendered routes, with cached and uncached data:\n\n<Image\n  alt=\"How static and dynamic rendering affects the Full Route Cache. Static routes are cached at build time or after data revalidation, whereas dynamic routes are never cached\"\n  srcLight=\"/docs/light/static-and-dynamic-routes.png\"\n  srcDark=\"/docs/dark/static-and-dynamic-routes.png\"\n  width=\"1600\"\n  height=\"1314\"\n/>\n\nLearn more about [static and dynamic rendering](#rendering-strategies).\n\n### Duration\n\nBy default, the Full Route Cache is persistent. This means that the render output is cached across user requests."
  },
  {
    "id": "caching.mdx#27",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Duration\n\nBy default, the Full Route Cache is persistent. This means that the render output is cached across user requests.\n\n### Invalidation\n\nThere are two ways you can invalidate the Full Route Cache:\n\n- **[Revalidating Data](/docs/app/guides/caching#revalidating)**: Revalidating the [Data Cache](#data-cache), will in turn invalidate the Router Cache by re-rendering components on the server and caching the new render output.\n- **Redeploying**: Unlike the Data Cache, which persists across deployments, the Full Route Cache is cleared on new deployments."
  },
  {
    "id": "caching.mdx#28",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Opting out\n\nYou can opt out of the Full Route Cache, or in other words, dynamically render components for every incoming request, by:\n\n- **Using a [Dynamic API](#dynamic-apis)**: This will opt the route out from the Full Route Cache and dynamically render it at request time. The Data Cache can still be used.\n- **Using the `dynamic = 'force-dynamic'` or `revalidate = 0` route segment config options**: This will skip the Full Route Cache and the Data Cache. Meaning components will be rendered and data fetched on every incoming request to the server. The Router Cache will still apply as it's a client-side cache.\n- **Opting out of the [Data Cache](#data-cache)**: If a route has a `fetch` request that is not cached, this will opt the route out of the Full Route Cache. The data for the specific `fetch` request will be fetched for every incoming request. Other `fetch` requests that explicitly enable caching will still be cached in the Data Cache. This allows for a hybrid of cached and uncached data."
  },
  {
    "id": "caching.mdx#29",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "## Client-side Router Cache\n\nNext.js has an in-memory client-side router cache that stores the RSC payload of route segments, split by layouts, loading states, and pages.\n\nWhen a user navigates between routes, Next.js caches the visited route segments and [prefetches](/docs/app/getting-started/linking-and-navigating#prefetching) the routes the user is likely to navigate to. This results in instant back/forward navigation, no full-page reload between navigations, and preservation of browser state and React state in shared layouts.\n\nWith the Router Cache:\n\n- **Layouts** are cached and reused on navigation ([partial rendering](/docs/app/getting-started/linking-and-navigating#client-side-transitions)).\n- **Loading states** are cached and reused on navigation for [instant navigation](/docs/app/api-reference/file-conventions/loading#instant-loading-states).\n- **Pages** are not cached by default, but are reused during browser backward and forward navigation. You can enable caching for page segments by using the experimental [`staleTimes`](/docs/app/api-reference/config/next-config-js/staleTimes) config option.\n\n{/* TODO: Update diagram to match v15 behavior */}"
  },
  {
    "id": "caching.mdx#30",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "{/* TODO: Update diagram to match v15 behavior */}\n\n> **Good to know:** This cache specifically applies to Next.js and Server Components, and is different to the browser's [bfcache](https://web.dev/bfcache/), though it has a similar result."
  },
  {
    "id": "caching.mdx#31",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Duration\n\nThe cache is stored in the browser's temporary memory. Two factors determine how long the router cache lasts:\n\n- **Session**: The cache persists across navigation. However, it's cleared on page refresh.\n- **Automatic Invalidation Period**: The cache of layouts and loading states is automatically invalidated after a specific time. The duration depends on how the resource was [prefetched](/docs/app/api-reference/components/link#prefetch), and if the resource was [statically generated](#static-rendering):\n  - **Default Prefetching** (`prefetch={null}` or unspecified): not cached for dynamic pages, 5 minutes for static pages.\n  - **Full Prefetching** (`prefetch={true}` or `router.prefetch`): 5 minutes for both static & dynamic pages.\n\nWhile a page refresh will clear **all** cached segments, the automatic invalidation period only affects the individual segment from the time it was prefetched.\n\n> **Good to know**: The experimental [`staleTimes`](/docs/app/api-reference/config/next-config-js/staleTimes) config option can be used to adjust the automatic invalidation times mentioned above."
  },
  {
    "id": "caching.mdx#32",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Invalidation\n\nThere are two ways you can invalidate the Router Cache:\n\n- In a **Server Action**:\n  - Revalidating data on-demand by path with ([`revalidatePath`](/docs/app/api-reference/functions/revalidatePath)) or by cache tag with ([`revalidateTag`](/docs/app/api-reference/functions/revalidateTag))\n  - Using [`cookies.set`](/docs/app/api-reference/functions/cookies#setting-a-cookie) or [`cookies.delete`](/docs/app/api-reference/functions/cookies#deleting-cookies) invalidates the Router Cache to prevent routes that use cookies from becoming stale (e.g. authentication).\n- Calling [`router.refresh`](/docs/app/api-reference/functions/use-router) will invalidate the Router Cache and make a new request to the server for the current route.\n\n### Opting out\n\nAs of Next.js 15, page segments are opted out by default.\n\n> **Good to know:** You can also opt out of [prefetching](/docs/app/getting-started/linking-and-navigating#prefetching) by setting the `prefetch` prop of the `<Link>` component to `false`."
  },
  {
    "id": "caching.mdx#33",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "## Cache Interactions\n\nWhen configuring the different caching mechanisms, it's important to understand how they interact with each other:\n\n### Data Cache and Full Route Cache\n\n- Revalidating or opting out of the Data Cache **will** invalidate the Full Route Cache, as the render output depends on data.\n- Invalidating or opting out of the Full Route Cache **does not** affect the Data Cache. You can dynamically render a route that has both cached and uncached data. This is useful when most of your page uses cached data, but you have a few components that rely on data that needs to be fetched at request time. You can dynamically render without worrying about the performance impact of re-fetching all the data."
  },
  {
    "id": "caching.mdx#34",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Data Cache and Client-side Router cache\n\n- To immediately invalidate the Data Cache and Router cache, you can use [`revalidatePath`](#revalidatepath) or [`revalidateTag`](#fetch-optionsnexttags-and-revalidatetag) in a [Server Action](/docs/app/getting-started/updating-data).\n- Revalidating the Data Cache in a [Route Handler](/docs/app/api-reference/file-conventions/route) **will not** immediately invalidate the Router Cache as the Route Handler isn't tied to a specific route. This means Router Cache will continue to serve the previous payload until a hard refresh, or the automatic invalidation period has elapsed."
  },
  {
    "id": "caching.mdx#35",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "## APIs\n\nThe following table provides an overview of how different Next.js APIs affect caching:"
  },
  {
    "id": "caching.mdx#36",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "| API                                                                     | Router Cache               | Full Route Cache      | Data Cache            | React Cache          |\n| ----------------------------------------------------------------------- | -------------------------- | --------------------- | --------------------- | -------------------- |\n| [`<Link prefetch>`](#link)                                              | Cache                      |                       |                       |                      |\n| [`router.prefetch`](#routerprefetch)                                    | Cache                      |                       |                       |                      |\n| [`router.refresh`](#routerrefresh)                                      | Revalidate                 |                       |                       |                      |\n| [`fetch`](#fetch)                                                       |                            |                       | Cache                 | Cache (GET and HEAD) |"
  },
  {
    "id": "caching.mdx#37",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "| [`fetch`](#fetch)                                                       |                            |                       | Cache                 | Cache (GET and HEAD) |\n| [`fetch` `options.cache`](#fetch-optionscache)                          |                            |                       | Cache or Opt out      |                      |\n| [`fetch` `options.next.revalidate`](#fetch-optionsnextrevalidate)       |                            | Revalidate            | Revalidate            |                      |\n| [`fetch` `options.next.tags`](#fetch-optionsnexttags-and-revalidatetag) |                            | Cache                 | Cache                 |                      |\n| [`revalidateTag`](#fetch-optionsnexttags-and-revalidatetag)             | Revalidate (Server Action) | Revalidate            | Revalidate            |                      |\n| [`revalidatePath`](#revalidatepath)                                     | Revalidate (Server Action) | Revalidate            | Revalidate            |                      |"
  },
  {
    "id": "caching.mdx#38",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "| [`revalidatePath`](#revalidatepath)                                     | Revalidate (Server Action) | Revalidate            | Revalidate            |                      |\n| [`const revalidate`](#segment-config-options)                           |                            | Revalidate or Opt out | Revalidate or Opt out |                      |\n| [`const dynamic`](#segment-config-options)                              |                            | Cache or Opt out      | Cache or Opt out      |                      |\n| [`cookies`](#cookies)                                                   | Revalidate (Server Action) | Opt out               |                       |                      |\n| [`headers`, `searchParams`](#dynamic-apis)                              |                            | Opt out               |                       |                      |\n| [`generateStaticParams`](#generatestaticparams)                         |                            | Cache                 |                       |                      |"
  },
  {
    "id": "caching.mdx#39",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "| [`generateStaticParams`](#generatestaticparams)                         |                            | Cache                 |                       |                      |\n| [`React.cache`](#react-cache-function)                                  |                            |                       |                       | Cache                |\n| [`unstable_cache`](/docs/app/api-reference/functions/unstable_cache)    |                            |                       | Cache                 |                      |"
  },
  {
    "id": "caching.mdx#40",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### `<Link>`\n\nBy default, the `<Link>` component automatically prefetches routes from the Full Route Cache and adds the React Server Component Payload to the Router Cache.\n\nTo disable prefetching, you can set the `prefetch` prop to `false`. But this will not skip the cache permanently, the route segment will still be cached client-side when the user visits the route.\n\nLearn more about the [`<Link>` component](/docs/app/api-reference/components/link).\n\n### `router.prefetch`\n\nThe `prefetch` option of the `useRouter` hook can be used to manually prefetch a route. This adds the React Server Component Payload to the Router Cache.\n\nSee the [`useRouter` hook](/docs/app/api-reference/functions/use-router) API reference.\n\n### `router.refresh`\n\nThe `refresh` option of the `useRouter` hook can be used to manually refresh a route. This completely clears the Router Cache, and makes a new request to the server for the current route. `refresh` does not affect the Data or Full Route Cache.\n\nThe rendered result will be reconciled on the client while preserving React state and browser state.\n\nSee the [`useRouter` hook](/docs/app/api-reference/functions/use-router) API reference."
  },
  {
    "id": "caching.mdx#41",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### `fetch`\n\nData returned from `fetch` is _not_ automatically cached in the Data Cache.\n\nBy default, when no `cache` or `next.revalidate` options are provided:\n\n- [Dynamic rendering](#dynamic-rendering): Fetch runs on every request and always returns fresh data.\n- [Static rendering](#static-rendering): Fetched data is stored in the [Data Cache](#data-cache), and the rendered output in the [Full Route Cache](#full-route-cache). Next.js serves this cached result until the path is revalidated.\n\nSee the [`fetch` API Reference](/docs/app/api-reference/functions/fetch) for more options.\n\n### `fetch options.cache`\n\nYou can opt individual `fetch` into caching by setting the `cache` option to `force-cache`:\n\n```jsx\n// Opt into caching\nfetch(`https://...`, { cache: 'force-cache' })\n```\n\nSee the [`fetch` API Reference](/docs/app/api-reference/functions/fetch) for more options."
  },
  {
    "id": "caching.mdx#42",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### `fetch options.next.revalidate`\n\nYou can use the `next.revalidate` option of `fetch` to set the revalidation period (in seconds) of an individual `fetch` request. This will revalidate the Data Cache, which in turn will revalidate the Full Route Cache. Fresh data will be fetched, and components will be re-rendered on the server.\n\n```jsx\n// Revalidate at most after 1 hour\nfetch(`https://...`, { next: { revalidate: 3600 } })\n```\n\nSee the [`fetch` API reference](/docs/app/api-reference/functions/fetch) for more options."
  },
  {
    "id": "caching.mdx#43",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### `fetch options.next.tags` and `revalidateTag`\n\nNext.js has a cache tagging system for fine-grained data caching and revalidation.\n\n1. When using `fetch` or [`unstable_cache`](/docs/app/api-reference/functions/unstable_cache), you have the option to tag cache entries with one or more tags.\n2. Then, you can call `revalidateTag` to purge the cache entries associated with that tag.\n\nFor example, you can set a tag when fetching data:\n\n```jsx\n// Cache data with a tag\nfetch(`https://...`, { next: { tags: ['a', 'b', 'c'] } })\n```\n\nThen, call `revalidateTag` with a tag to purge the cache entry:\n\n```jsx\n// Revalidate entries with a specific tag\nrevalidateTag('a')"
  },
  {
    "id": "caching.mdx#44",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "```\n\nThen, call `revalidateTag` with a tag to purge the cache entry:\n\n```jsx\n// Revalidate entries with a specific tag\nrevalidateTag('a')\n```\n\nThere are two places you can use `revalidateTag`, depending on what you're trying to achieve:\n\n1. [Route Handlers](/docs/app/api-reference/file-conventions/route) - to revalidate data in response of a third party event (e.g. webhook). This will not invalidate the Router Cache immediately as the Router Handler isn't tied to a specific route.\n2. [Server Actions](/docs/app/getting-started/updating-data) - to revalidate data after a user action (e.g. form submission). This will invalidate the Router Cache for the associated route."
  },
  {
    "id": "caching.mdx#45",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### `revalidatePath`\n\n`revalidatePath` allows you manually revalidate data **and** re-render the route segments below a specific path in a single operation. Calling the `revalidatePath` method revalidates the Data Cache, which in turn invalidates the Full Route Cache.\n\n```jsx\nrevalidatePath('/')"
  },
  {
    "id": "caching.mdx#46",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "```\n\nThere are two places you can use `revalidatePath`, depending on what you're trying to achieve:\n\n1. [Route Handlers](/docs/app/api-reference/file-conventions/route) - to revalidate data in response to a third party event (e.g. webhook).\n2. [Server Actions](/docs/app/getting-started/updating-data) - to revalidate data after a user interaction (e.g. form submission, clicking a button).\n\nSee the [`revalidatePath` API reference](/docs/app/api-reference/functions/revalidatePath) for more information.\n\n> **`revalidatePath`** vs. **`router.refresh`**:\n>\n> Calling `router.refresh` will clear the Router cache, and re-render route segments on the server without invalidating the Data Cache or the Full Route Cache.\n>\n> The difference is that `revalidatePath` purges the Data Cache and Full Route Cache, whereas `router.refresh()` does not change the Data Cache and Full Route Cache, as it is a client-side API."
  },
  {
    "id": "caching.mdx#47",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Dynamic APIs\n\nDynamic APIs like `cookies` and `headers`, and the `searchParams` prop in Pages depend on runtime incoming request information. Using them will opt a route out of the Full Route Cache, in other words, the route will be dynamically rendered.\n\n#### `cookies`\n\nUsing `cookies.set` or `cookies.delete` in a Server Action invalidates the Router Cache to prevent routes that use cookies from becoming stale (e.g. to reflect authentication changes).\n\nSee the [`cookies`](/docs/app/api-reference/functions/cookies) API reference."
  },
  {
    "id": "caching.mdx#48",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### Segment Config Options\n\nThe Route Segment Config options can be used to override the route segment defaults or when you're not able to use the `fetch` API (e.g. database client or 3rd party libraries).\n\nThe following Route Segment Config options will opt out of the Full Route Cache:\n\n- `const dynamic = 'force-dynamic'`\n\nThis config option will opt all fetches out of the Data Cache (i.e. `no-store`):\n\n- `const fetchCache = 'default-no-store'`\n\nSee the [`fetchCache`](/docs/app/api-reference/file-conventions/route-segment-config#fetchcache) to see more advanced options.\n\nSee the [Route Segment Config](/docs/app/api-reference/file-conventions/route-segment-config) documentation for more options."
  },
  {
    "id": "caching.mdx#49",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### `generateStaticParams`\n\nFor [dynamic segments](/docs/app/api-reference/file-conventions/dynamic-routes) (e.g. `app/blog/[slug]/page.js`), paths provided by `generateStaticParams` are cached in the Full Route Cache at build time. At request time, Next.js will also cache paths that weren't known at build time the first time they're visited.\n\nTo statically render all paths at build time, supply the full list of paths to `generateStaticParams`:\n\n```jsx filename=\"app/blog/[slug]/page.js\"\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  return posts.map((post) => ({\n    slug: post.slug,\n  }))\n}\n```\n\nTo statically render a subset of paths at build time, and the rest the first time they're visited at runtime, return a partial list of paths:\n\n```jsx filename=\"app/blog/[slug]/page.js\"\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  // Render the first 10 posts at build time\n  return posts.slice(0, 10).map((post) => ({\n    slug: post.slug,\n  }))\n}"
  },
  {
    "id": "caching.mdx#50",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "```\n\nTo statically render all paths the first time they're visited, return an empty array (no paths will be rendered at build time) or utilize [`export const dynamic = 'force-static'`](/docs/app/api-reference/file-conventions/route-segment-config#dynamic):\n\n```jsx filename=\"app/blog/[slug]/page.js\"\nexport async function generateStaticParams() {\n  return []\n}\n```\n\n> **Good to know:** You must return an array from `generateStaticParams`, even if it's empty. Otherwise, the route will be dynamically rendered.\n\n```jsx filename=\"app/changelog/[slug]/page.js\"\nexport const dynamic = 'force-static'\n```\n\nTo disable caching at request time, add the `export const dynamicParams = false` option in a route segment. When this config option is used, only paths provided by `generateStaticParams` will be served, and other routes will 404 or match (in the case of [catch-all routes](/docs/app/api-reference/file-conventions/dynamic-routes#catch-all-segments))."
  },
  {
    "id": "caching.mdx#51",
    "metadata": {
      "title": "Caching in Next.js",
      "description": "An overview of caching mechanisms in Next.js."
    },
    "content": "### React `cache` function\n\nThe React `cache` function allows you to memoize the return value of a function, allowing you to call the same function multiple times while only executing it once.\n\n`fetch` requests using the `GET` or `HEAD` methods are automatically memoized, so you do not need to wrap it in React `cache`. However, for other `fetch` methods, or when using data fetching libraries (such as some database, CMS, or GraphQL clients) that don't inherently memoize requests, you can use `cache` to manually memoize data requests.\n\n```ts filename=\"utils/get-item.ts\" switcher\nimport { cache } from 'react'\nimport db from '@/lib/db'\n\nexport const getItem = cache(async (id: string) => {\n  const item = await db.item.findUnique({ id })\n  return item\n})\n```\n\n```js filename=\"utils/get-item.js\" switcher\nimport { cache } from 'react'\nimport db from '@/lib/db'\n\nexport const getItem = cache(async (id) => {\n  const item = await db.item.findUnique({ id })\n  return item\n})\n```"
  },
  {
    "id": "ci-build-caching.mdx#0",
    "metadata": {
      "title": "How to configure Continuous Integration (CI) build caching",
      "description": "Learn how to configure CI to cache Next.js builds"
    },
    "content": "---\ntitle: How to configure Continuous Integration (CI) build caching\nnav_title: CI Build Caching\ndescription: Learn how to configure CI to cache Next.js builds\n---\n\nTo improve build performance, Next.js saves a cache to `.next/cache` that is shared between builds.\n\nTo take advantage of this cache in Continuous Integration (CI) environments, your CI workflow will need to be configured to correctly persist the cache between builds.\n\n> If your CI is not configured to persist `.next/cache` between builds, you may see a [No Cache Detected](/docs/messages/no-cache) error.\n\nHere are some example cache configurations for common CI providers:\n\n## Vercel\n\nNext.js caching is automatically configured for you. There's no action required on your part. If you are using Turborepo on Vercel, [learn more here](https://vercel.com/docs/monorepos/turborepo)."
  },
  {
    "id": "ci-build-caching.mdx#1",
    "metadata": {
      "title": "How to configure Continuous Integration (CI) build caching",
      "description": "Learn how to configure CI to cache Next.js builds"
    },
    "content": "## CircleCI\n\nEdit your `save_cache` step in `.circleci/config.yml` to include `.next/cache`:\n\n```yaml\nsteps:\n  - save_cache:\n      key: dependency-cache-{{ checksum \"yarn.lock\" }}\n      paths:\n        - ./node_modules\n        - ./.next/cache\n```\n\nIf you do not have a `save_cache` key, please follow CircleCI's [documentation on setting up build caching](https://circleci.com/docs/2.0/caching/).\n\n## Travis CI\n\nAdd or merge the following into your `.travis.yml`:\n\n```yaml\ncache:\n  directories:\n    - $HOME/.cache/yarn\n    - node_modules\n    - .next/cache\n```\n\n## GitLab CI\n\nAdd or merge the following into your `.gitlab-ci.yml`:\n\n```yaml\ncache:\n  key: ${CI_COMMIT_REF_SLUG}\n  paths:\n    - node_modules/\n    - .next/cache/\n```\n\n## Netlify CI\n\nUse [Netlify Plugins](https://www.netlify.com/products/build/plugins/) with [`@netlify/plugin-nextjs`](https://www.npmjs.com/package/@netlify/plugin-nextjs).\n\n## AWS CodeBuild\n\nAdd (or merge in) the following to your `buildspec.yml`:\n\n```yaml\ncache:\n  paths:\n    - 'node_modules/**/*' # Cache `node_modules` for faster `yarn` or `npm i`\n    - '.next/cache/**/*' # Cache Next.js for faster application rebuilds\n```"
  },
  {
    "id": "ci-build-caching.mdx#2",
    "metadata": {
      "title": "How to configure Continuous Integration (CI) build caching",
      "description": "Learn how to configure CI to cache Next.js builds"
    },
    "content": "## GitHub Actions\n\nUsing GitHub's [actions/cache](https://github.com/actions/cache), add the following step in your workflow file:\n\n```yaml\nuses: actions/cache@v4\nwith:\n  # See here for caching with `yarn`, `bun` or other package managers https://github.com/actions/cache/blob/main/examples.md or you can leverage caching with actions/setup-node https://github.com/actions/setup-node\n  path: |\n    ~/.npm\n    ${{ github.workspace }}/.next/cache\n  # Generate a new cache whenever packages or source files change.\n  key: ${{ runner.os }}-nextjs-${{ hashFiles('**/package-lock.json') }}-${{ hashFiles('**/*.js', '**/*.jsx', '**/*.ts', '**/*.tsx') }}\n  # If source files changed but packages didn't, rebuild from a prior cache.\n  restore-keys: |\n    ${{ runner.os }}-nextjs-${{ hashFiles('**/package-lock.json') }}-\n```\n\n## Bitbucket Pipelines\n\nAdd or merge the following into your `bitbucket-pipelines.yml` at the top level (same level as `pipelines`):\n\n```yaml\ndefinitions:\n  caches:\n    nextcache: .next/cache\n```\n\nThen reference it in the `caches` section of your pipeline's `step`:\n\n```yaml\n- step:\n    name: your_step_name\n    caches:\n      - node\n      - nextcache\n```"
  },
  {
    "id": "ci-build-caching.mdx#3",
    "metadata": {
      "title": "How to configure Continuous Integration (CI) build caching",
      "description": "Learn how to configure CI to cache Next.js builds"
    },
    "content": "## Heroku\n\nUsing Heroku's [custom cache](https://devcenter.heroku.com/articles/nodejs-support#custom-caching), add a `cacheDirectories` array in your top-level package.json:\n\n```javascript\n\"cacheDirectories\": [\".next/cache\"]\n```\n\n## Azure Pipelines\n\nUsing Azure Pipelines' [Cache task](https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/utility/cache), add the following task to your pipeline yaml file somewhere prior to the task that executes `next build`:\n\n```yaml\n- task: Cache@2\n  displayName: 'Cache .next/cache'\n  inputs:\n    key: next | $(Agent.OS) | yarn.lock\n    path: '$(System.DefaultWorkingDirectory)/.next/cache'\n```"
  },
  {
    "id": "ci-build-caching.mdx#4",
    "metadata": {
      "title": "How to configure Continuous Integration (CI) build caching",
      "description": "Learn how to configure CI to cache Next.js builds"
    },
    "content": "## Jenkins (Pipeline)\n\nUsing Jenkins' [Job Cacher](https://www.jenkins.io/doc/pipeline/steps/jobcacher/) plugin, add the following build step to your `Jenkinsfile` where you would normally run `next build` or `npm install`:\n\n```yaml\nstage(\"Restore npm packages\") {\n    steps {\n        // Writes lock-file to cache based on the GIT_COMMIT hash\n        writeFile file: \"next-lock.cache\", text: \"$GIT_COMMIT\"\n\n        cache(caches: [\n            arbitraryFileCache(\n                path: \"node_modules\",\n                includes: \"**/*\",\n                cacheValidityDecidingFile: \"package-lock.json\"\n            )\n        ]) {\n            sh \"npm install\"\n        }\n    }\n}\nstage(\"Build\") {\n    steps {\n        // Writes lock-file to cache based on the GIT_COMMIT hash\n        writeFile file: \"next-lock.cache\", text: \"$GIT_COMMIT\"\n\n        cache(caches: [\n            arbitraryFileCache(\n                path: \".next/cache\",\n                includes: \"**/*\",\n                cacheValidityDecidingFile: \"next-lock.cache\"\n            )\n        ]) {\n            // aka `next build`\n            sh \"npm run build\"\n        }\n    }\n}\n```"
  },
  {
    "id": "content-security-policy.mdx#0",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "---\ntitle: How to set a Content Security Policy (CSP) for your Next.js application\nnav_title: Content Security Policy\ndescription: Learn how to set a Content Security Policy (CSP) for your Next.js application.\nrelated:\n  links:\n    - app/api-reference/file-conventions/proxy\n    - app/api-reference/functions/headers\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n[Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) is important to guard your Next.js application against various security threats such as cross-site scripting (XSS), clickjacking, and other code injection attacks.\n\nBy using CSP, developers can specify which origins are permissible for content sources, scripts, stylesheets, images, fonts, objects, media (audio, video), iframes, and more.\n\n<details>\n  <summary>Examples</summary>\n\n- [Strict CSP](https://github.com/vercel/next.js/tree/canary/examples/with-strict-csp)\n\n</details>"
  },
  {
    "id": "content-security-policy.mdx#1",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "## Nonces\n\nA [nonce](https://developer.mozilla.org/docs/Web/HTML/Global_attributes/nonce) is a unique, random string of characters created for a one-time use. It is used in conjunction with CSP to selectively allow certain inline scripts or styles to execute, bypassing strict CSP directives.\n\n### Why use a nonce?\n\nCSP can block both inline and external scripts to prevent attacks. A nonce lets you safely allow specific scripts to run—only if they include the matching nonce value.\n\nIf an attacker wanted to load a script into your page, they'd need to guess the nonce value. That's why the nonce must be unpredictable and unique for every request."
  },
  {
    "id": "content-security-policy.mdx#2",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "### Adding a nonce with Proxy\n\n[Proxy](/docs/app/api-reference/file-conventions/proxy) enables you to add headers and generate nonces before the page renders.\n\nEvery time a page is viewed, a fresh nonce should be generated. This means that you **must use [dynamic rendering](/docs/app/guides/caching#dynamic-rendering) to add nonces**.\n\nFor example:\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextRequest, NextResponse } from 'next/server'\n\nexport function proxy(request: NextRequest) {\n  const nonce = Buffer.from(crypto.randomUUID()).toString('base64')\n  const cspHeader = `\n    default-src 'self';\n    script-src 'self' 'nonce-${nonce}' 'strict-dynamic';\n    style-src 'self' 'nonce-${nonce}';\n    img-src 'self' blob: data:;\n    font-src 'self';\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n`\n  // Replace newline characters and spaces\n  const contentSecurityPolicyHeaderValue = cspHeader\n    .replace(/\\s{2,}/g, ' ')\n    .trim()\n\n  const requestHeaders = new Headers(request.headers)\n  requestHeaders.set('x-nonce', nonce)"
  },
  {
    "id": "content-security-policy.mdx#3",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "const requestHeaders = new Headers(request.headers)\n  requestHeaders.set('x-nonce', nonce)\n\n  requestHeaders.set(\n    'Content-Security-Policy',\n    contentSecurityPolicyHeaderValue\n  )\n\n  const response = NextResponse.next({\n    request: {\n      headers: requestHeaders,\n    },\n  })\n  response.headers.set(\n    'Content-Security-Policy',\n    contentSecurityPolicyHeaderValue\n  )\n\n  return response\n}"
  },
  {
    "id": "content-security-policy.mdx#4",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\n\nexport function proxy(request) {\n  const nonce = Buffer.from(crypto.randomUUID()).toString('base64')\n  const cspHeader = `\n    default-src 'self';\n    script-src 'self' 'nonce-${nonce}' 'strict-dynamic';\n    style-src 'self' 'nonce-${nonce}';\n    img-src 'self' blob: data:;\n    font-src 'self';\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n`\n  // Replace newline characters and spaces\n  const contentSecurityPolicyHeaderValue = cspHeader\n    .replace(/\\s{2,}/g, ' ')\n    .trim()\n\n  const requestHeaders = new Headers(request.headers)\n  requestHeaders.set('x-nonce', nonce)\n  requestHeaders.set(\n    'Content-Security-Policy',\n    contentSecurityPolicyHeaderValue\n  )\n\n  const response = NextResponse.next({\n    request: {\n      headers: requestHeaders,\n    },\n  })\n  response.headers.set(\n    'Content-Security-Policy',\n    contentSecurityPolicyHeaderValue\n  )\n\n  return response\n}"
  },
  {
    "id": "content-security-policy.mdx#5",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "```\n\nBy default, Proxy runs on all requests. You can filter Proxy to run on specific paths using a [`matcher`](/docs/app/api-reference/file-conventions/proxy#matcher).\n\nWe recommend ignoring matching prefetches (from `next/link`) and static assets that don't need the CSP header.\n\n```ts filename=\"proxy.ts\" switcher\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      missing: [\n        { type: 'header', key: 'next-router-prefetch' },\n        { type: 'header', key: 'purpose', value: 'prefetch' },\n      ],\n    },\n  ],\n}"
  },
  {
    "id": "content-security-policy.mdx#6",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      missing: [\n        { type: 'header', key: 'next-router-prefetch' },\n        { type: 'header', key: 'purpose', value: 'prefetch' },\n      ],\n    },\n  ],\n}\n```"
  },
  {
    "id": "content-security-policy.mdx#7",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "### How nonces work in Next.js\n\nTo use a nonce, your page must be **dynamically rendered**. This is because Next.js applies nonces during **server-side rendering**, based on the CSP header present in the request. Static pages are generated at build time, when no request or response headers exist—so no nonce can be injected.\n\nHere’s how nonce support works in a dynamically rendered page:\n\n1. **Proxy generates a nonce**: Your proxy creates a unique nonce for the request, adds it to your `Content-Security-Policy` header, and also sets it in a custom `x-nonce` header.\n2. **Next.js extracts the nonce**: During rendering, Next.js parses the `Content-Security-Policy` header and extracts the nonce using the `'nonce-{value}'` pattern.\n3. **Nonce is applied automatically**: Next.js attaches the nonce to:\n   - Framework scripts (React, Next.js runtime)\n   - Page-specific JavaScript bundles\n   - Inline styles and scripts generated by Next.js\n   - Any `<Script>` components using the `nonce` prop\n\nBecause of this automatic behavior, you don’t need to manually add a nonce to each tag."
  },
  {
    "id": "content-security-policy.mdx#8",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "### Forcing dynamic rendering\n\nIf you're using nonces, you may need to explicitly opt pages into dynamic rendering:\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { connection } from 'next/server'\n\nexport default async function Page() {\n  // wait for an incoming request to render this page\n  await connection()\n  // Your page content\n}\n```\n\n```jsx filename=\"app/page.jsx\" switcher\nimport { connection } from 'next/server'\n\nexport default async function Page() {\n  // wait for an incoming request to render this page\n  await connection()\n  // Your page content\n}\n```"
  },
  {
    "id": "content-security-policy.mdx#9",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "### Reading the nonce\n\n<PagesOnly>\n  You can provide the nonce to your page using\n  [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props):\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Script from 'next/script'\n\nimport type { GetServerSideProps } from 'next'\n\nexport default function Page({ nonce }) {\n  return (\n    <Script\n      src=\"https://www.googletagmanager.com/gtag/js\"\n      strategy=\"afterInteractive\"\n      nonce={nonce}\n    />\n  )\n}\n\nexport const getServerSideProps: GetServerSideProps = async ({ req }) => {\n  const nonce = req.headers['x-nonce']\n  return { props: { nonce } }\n}\n```\n\n```jsx filename=\"pages/index.jsx\" switcher\nimport Script from 'next/script'\nexport default function Page({ nonce }) {\n  return (\n    <Script\n      src=\"https://www.googletagmanager.com/gtag/js\"\n      strategy=\"afterInteractive\"\n      nonce={nonce}\n    />\n  )\n}\n\nexport async function getServerSideProps({ req }) {\n  const nonce = req.headers['x-nonce']\n  return { props: { nonce } }\n}"
  },
  {
    "id": "content-security-policy.mdx#10",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "```\n\nYou can also access the nonce in `_document.tsx` for Pages Router applications:\n\n```tsx filename=\"pages/_document.tsx\" switcher\nimport Document, {\n  Html,\n  Head,\n  Main,\n  NextScript,\n  DocumentContext,\n  DocumentInitialProps,\n} from 'next/document'\n\ninterface ExtendedDocumentProps extends DocumentInitialProps {\n  nonce?: string\n}\n\nclass MyDocument extends Document<ExtendedDocumentProps> {\n  static async getInitialProps(\n    ctx: DocumentContext\n  ): Promise<ExtendedDocumentProps> {\n    const initialProps = await Document.getInitialProps(ctx)\n    const nonce = ctx.req?.headers?.['x-nonce'] as string | undefined\n\n    return {\n      ...initialProps,\n      nonce,\n    }\n  }\n\n  render() {\n    const { nonce } = this.props\n\n    return (\n      <Html lang=\"en\">\n        <Head nonce={nonce} />\n        <body>\n          <Main />\n          <NextScript nonce={nonce} />\n        </body>\n      </Html>\n    )\n  }\n}\n\nexport default MyDocument"
  },
  {
    "id": "content-security-policy.mdx#11",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"pages/_document.jsx\" switcher\nimport Document, { Html, Head, Main, NextScript } from 'next/document'\n\nclass MyDocument extends Document {\n  static async getInitialProps(ctx) {\n    const initialProps = await Document.getInitialProps(ctx)\n    const nonce = ctx.req?.headers?.['x-nonce']\n\n    return {\n      ...initialProps,\n      nonce,\n    }\n  }\n\n  render() {\n    const { nonce } = this.props\n\n    return (\n      <Html lang=\"en\">\n        <Head nonce={nonce} />\n        <body>\n          <Main />\n          <NextScript nonce={nonce} />\n        </body>\n      </Html>\n    )\n  }\n}\n\nexport default MyDocument\n```\n\n</PagesOnly>\n\n<AppOnly>\n\nYou can read the nonce from a [Server Component](/docs/app/getting-started/server-and-client-components) using [`headers`](/docs/app/api-reference/functions/headers):\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { headers } from 'next/headers'\nimport Script from 'next/script'\n\nexport default async function Page() {\n  const nonce = (await headers()).get('x-nonce')\n\n  return (\n    <Script\n      src=\"https://www.googletagmanager.com/gtag/js\"\n      strategy=\"afterInteractive\"\n      nonce={nonce}\n    />\n  )\n}"
  },
  {
    "id": "content-security-policy.mdx#12",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/page.jsx\" switcher\nimport { headers } from 'next/headers'\nimport Script from 'next/script'\n\nexport default async function Page() {\n  const nonce = (await headers()).get('x-nonce')\n\n  return (\n    <Script\n      src=\"https://www.googletagmanager.com/gtag/js\"\n      strategy=\"afterInteractive\"\n      nonce={nonce}\n    />\n  )\n}\n```\n\n</AppOnly>"
  },
  {
    "id": "content-security-policy.mdx#13",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "## Static vs Dynamic Rendering with CSP\n\nUsing nonces has important implications for how your Next.js application renders:\n\n### Dynamic Rendering Requirement\n\nWhen you use nonces in your CSP, **all pages must be dynamically rendered**. This means:\n\n- Pages will build successfully but may encounter runtime errors if not properly configured for dynamic rendering\n- Each request generates a fresh page with a new nonce\n- Static optimization and Incremental Static Regeneration (ISR) are disabled\n- Pages cannot be cached by CDNs without additional configuration\n- **Partial Prerendering (PPR) is incompatible** with nonce-based CSP since static shell scripts won't have access to the nonce\n\n### Performance Implications\n\nThe shift from static to dynamic rendering affects performance:\n\n- **Slower initial page loads**: Pages must be generated on each request\n- **Increased server load**: Every request requires server-side rendering\n- **No CDN caching**: Dynamic pages cannot be cached at the edge by default\n- **Higher hosting costs**: More server resources needed for dynamic rendering"
  },
  {
    "id": "content-security-policy.mdx#14",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "### When to use nonces\n\nConsider nonces when:\n\n- You have strict security requirements that prohibit `'unsafe-inline'`\n- Your application handles sensitive data\n- You need to allow specific inline scripts while blocking others\n- Compliance requirements mandate strict CSP"
  },
  {
    "id": "content-security-policy.mdx#15",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "## Without Nonces\n\nFor applications that do not require nonces, you can set the CSP header directly in your [`next.config.js`](/docs/app/api-reference/config/next-config-js) file:\n\n```js filename=\"next.config.js\"\nconst cspHeader = `\n    default-src 'self';\n    script-src 'self' 'unsafe-eval' 'unsafe-inline';\n    style-src 'self' 'unsafe-inline';\n    img-src 'self' blob: data:;\n    font-src 'self';\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n`\n\nmodule.exports = {\n  async headers() {\n    return [\n      {\n        source: '/(.*)',\n        headers: [\n          {\n            key: 'Content-Security-Policy',\n            value: cspHeader.replace(/\\n/g, ''),\n          },\n        ],\n      },\n    ]\n  },\n}\n```\n\n<AppOnly>"
  },
  {
    "id": "content-security-policy.mdx#16",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "## Subresource Integrity (Experimental)\n\nAs an alternative to nonces, Next.js offers experimental support for hash-based CSP using Subresource Integrity (SRI). This approach allows you to maintain static generation while still having a strict CSP.\n\n> **Good to know**: This feature is experimental and only available with webpack bundler in App Router applications.\n\n### How SRI works\n\nInstead of using nonces, SRI generates cryptographic hashes of your JavaScript files at build time. These hashes are added as `integrity` attributes to script tags, allowing browsers to verify that files haven't been modified during transit.\n\n### Enabling SRI\n\nAdd the experimental SRI configuration to your `next.config.js`:\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    sri: {\n      algorithm: 'sha256', // or 'sha384' or 'sha512'\n    },\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "content-security-policy.mdx#17",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "### CSP configuration with SRI\n\nWhen SRI is enabled, you can continue using your existing CSP policies. SRI works independently by adding `integrity` attributes to your assets:\n\n> **Good to know**: For dynamic rendering scenarios, you can still generate nonces with proxy if needed, combining both SRI integrity attributes and nonce-based CSP approaches.\n\n```js filename=\"next.config.js\"\nconst cspHeader = `\n    default-src 'self';\n    script-src 'self';\n    style-src 'self';\n    img-src 'self' blob: data:;\n    font-src 'self';\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n`\n\nmodule.exports = {\n  experimental: {\n    sri: {\n      algorithm: 'sha256',\n    },\n  },\n  async headers() {\n    return [\n      {\n        source: '/(.*)',\n        headers: [\n          {\n            key: 'Content-Security-Policy',\n            value: cspHeader.replace(/\\n/g, ''),\n          },\n        ],\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "content-security-policy.mdx#18",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "### Benefits of SRI over nonces\n\n- **Static generation**: Pages can be statically generated and cached\n- **CDN compatibility**: Static pages work with CDN caching\n- **Better performance**: No server-side rendering required for each request\n- **Build-time security**: Hashes are generated at build time, ensuring integrity\n\n### Limitations of SRI\n\n- **Experimental**: Feature may change or be removed\n- **Webpack only**: Not available with Turbopack\n- **App Router only**: Not supported in Pages Router\n- **Build-time only**: Cannot handle dynamically generated scripts\n\n</AppOnly>"
  },
  {
    "id": "content-security-policy.mdx#19",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "## Development vs Production Considerations\n\nCSP implementation differs between development and production environments:"
  },
  {
    "id": "content-security-policy.mdx#20",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "### Development Environment\n\nIn development, you will need to enable `'unsafe-eval'` to support APIs that provide additional debugging information:\n\n```ts filename=\"proxy.ts\" switcher\nexport function proxy(request: NextRequest) {\n  const nonce = Buffer.from(crypto.randomUUID()).toString('base64')\n  const isDev = process.env.NODE_ENV === 'development'\n\n  const cspHeader = `\n    default-src 'self';\n    script-src 'self' 'nonce-${nonce}' 'strict-dynamic' ${isDev ? \"'unsafe-eval'\" : ''};\n    style-src 'self' ${isDev ? \"'unsafe-inline'\" : `'nonce-${nonce}'`};\n    img-src 'self' blob: data:;\n    font-src 'self';\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n`\n\n  // Rest of proxy implementation\n}"
  },
  {
    "id": "content-security-policy.mdx#21",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nexport function proxy(request) {\n  const nonce = Buffer.from(crypto.randomUUID()).toString('base64')\n  const isDev = process.env.NODE_ENV === 'development'\n\n  const cspHeader = `\n    default-src 'self';\n    script-src 'self' 'nonce-${nonce}' 'strict-dynamic' ${isDev ? \"'unsafe-eval'\" : ''};\n    style-src 'self' ${isDev ? \"'unsafe-inline'\" : `'nonce-${nonce}'`};\n    img-src 'self' blob: data:;\n    font-src 'self';\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n`\n\n  // Rest of proxy implementation\n}\n```"
  },
  {
    "id": "content-security-policy.mdx#22",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "### Production Deployment\n\nCommon issues in production:\n\n- **Nonce not applied**: Ensure your proxy runs on all necessary routes\n- **Static assets blocked**: Verify your CSP allows Next.js static assets\n- **Third-party scripts**: Add necessary domains to your CSP policy"
  },
  {
    "id": "content-security-policy.mdx#23",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "## Troubleshooting"
  },
  {
    "id": "content-security-policy.mdx#24",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "### Third-party Scripts\n\n<AppOnly>\n\nWhen using third-party scripts with CSP:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { GoogleTagManager } from '@next/third-parties/google'\nimport { headers } from 'next/headers'\n\nexport default async function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  const nonce = (await headers()).get('x-nonce')\n\n  return (\n    <html lang=\"en\">\n      <body>\n        {children}\n        <GoogleTagManager gtmId=\"GTM-XYZ\" nonce={nonce} />\n      </body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.jsx\" switcher\nimport { GoogleTagManager } from '@next/third-parties/google'\nimport { headers } from 'next/headers'\n\nexport default async function RootLayout({ children }) {\n  const nonce = (await headers()).get('x-nonce')\n\n  return (\n    <html lang=\"en\">\n      <body>\n        {children}\n        <GoogleTagManager gtmId=\"GTM-XYZ\" nonce={nonce} />\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "content-security-policy.mdx#25",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\nWhen using third-party scripts with CSP, ensure you add the necessary domains and pass the nonce:\n\n```tsx filename=\"pages/_app.tsx\" switcher\nimport type { AppProps } from 'next/app'\nimport Script from 'next/script'\n\nexport default function App({ Component, pageProps }: AppProps) {\n  const nonce = pageProps.nonce\n\n  return (\n    <>\n      <Component {...pageProps} />\n      <Script\n        src=\"https://www.googletagmanager.com/gtag/js\"\n        strategy=\"afterInteractive\"\n        nonce={nonce}\n      />\n    </>\n  )\n}\n```\n\n```jsx filename=\"pages/_app.jsx\" switcher\nimport Script from 'next/script'\n\nexport default function App({ Component, pageProps }) {\n  const nonce = pageProps.nonce\n\n  return (\n    <>\n      <Component {...pageProps} />\n      <Script\n        src=\"https://www.googletagmanager.com/gtag/js\"\n        strategy=\"afterInteractive\"\n        nonce={nonce}\n      />\n    </>\n  )\n}"
  },
  {
    "id": "content-security-policy.mdx#26",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "```\n\n</PagesOnly>\n\nUpdate your CSP to allow third-party domains:\n\n```ts filename=\"proxy.ts\" switcher\nconst cspHeader = `\n  default-src 'self';\n  script-src 'self' 'nonce-${nonce}' 'strict-dynamic' https://www.googletagmanager.com;\n  connect-src 'self' https://www.google-analytics.com;\n  img-src 'self' data: https://www.google-analytics.com;\n`\n```\n\n```js filename=\"proxy.js\" switcher\nconst cspHeader = `\n  default-src 'self';\n  script-src 'self' 'nonce-${nonce}' 'strict-dynamic' https://www.googletagmanager.com;\n  connect-src 'self' https://www.google-analytics.com;\n  img-src 'self' data: https://www.google-analytics.com;\n`\n```"
  },
  {
    "id": "content-security-policy.mdx#27",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "### Common CSP Violations\n\n1. **Inline styles**: Use CSS-in-JS libraries that support nonces or move styles to external files\n2. **Dynamic imports**: Ensure dynamic imports are allowed in your script-src policy\n3. **WebAssembly**: Add `'wasm-unsafe-eval'` if using WebAssembly\n4. **Service workers**: Add appropriate policies for service worker scripts"
  },
  {
    "id": "content-security-policy.mdx#28",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "## Version History\n\n| Version    | Changes                                                       |\n| ---------- | ------------------------------------------------------------- |\n| `v14.0.0`  | Experimental SRI support added for hash-based CSP             |\n| `v13.4.20` | Recommended for proper nonce handling and CSP header parsing. |"
  },
  {
    "id": "css-in-js.mdx#0",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "---\ntitle: How to use CSS-in-JS libraries\nnav_title: CSS-in-JS\ndescription: Use CSS-in-JS libraries with Next.js\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n<AppOnly>\n\n> **Warning:** Using CSS-in-JS with newer React features like Server Components and Streaming requires library authors to support the latest version of React, including [concurrent rendering](https://react.dev/blog/2022/03/29/react-v18#what-is-concurrent-react).\n\nThe following libraries are supported in Client Components in the `app` directory (alphabetical):"
  },
  {
    "id": "css-in-js.mdx#1",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "The following libraries are supported in Client Components in the `app` directory (alphabetical):\n\n- [`ant-design`](https://ant.design/docs/react/use-with-next#using-app-router)\n- [`chakra-ui`](https://chakra-ui.com/getting-started/nextjs-app-guide)\n- [`@fluentui/react-components`](https://react.fluentui.dev/?path=/docs/concepts-developer-server-side-rendering-next-js-appdir-setup--page)\n- [`kuma-ui`](https://kuma-ui.com)\n- [`@mui/material`](https://mui.com/material-ui/guides/next-js-app-router/)\n- [`@mui/joy`](https://mui.com/joy-ui/integrations/next-js-app-router/)\n- [`pandacss`](https://panda-css.com)\n- [`styled-jsx`](#styled-jsx)\n- [`styled-components`](#styled-components)\n- [`stylex`](https://stylexjs.com)\n- [`tamagui`](https://tamagui.dev/docs/guides/next-js#server-components)\n- [`tss-react`](https://tss-react.dev/)\n- [`vanilla-extract`](https://vanilla-extract.style)\n\nThe following are currently working on support:\n\n- [`emotion`](https://github.com/emotion-js/emotion/issues/2928)\n\n> **Good to know**: We're testing out different CSS-in-JS libraries and we'll be adding more examples for libraries that support React 18 features and/or the `app` directory."
  },
  {
    "id": "css-in-js.mdx#2",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "## Configuring CSS-in-JS in `app`\n\nConfiguring CSS-in-JS is a three-step opt-in process that involves:\n\n1. A **style registry** to collect all CSS rules in a render.\n2. The new `useServerInsertedHTML` hook to inject rules before any content that might use them.\n3. A Client Component that wraps your app with the style registry during initial server-side rendering."
  },
  {
    "id": "css-in-js.mdx#3",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "### `styled-jsx`\n\nUsing `styled-jsx` in Client Components requires using `v5.1.0`. First, create a new registry:\n\n```tsx filename=\"app/registry.tsx\" switcher\n'use client'\n\nimport React, { useState } from 'react'\nimport { useServerInsertedHTML } from 'next/navigation'\nimport { StyleRegistry, createStyleRegistry } from 'styled-jsx'\n\nexport default function StyledJsxRegistry({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  // Only create stylesheet once with lazy initial state\n  // x-ref: https://reactjs.org/docs/hooks-reference.html#lazy-initial-state\n  const [jsxStyleRegistry] = useState(() => createStyleRegistry())\n\n  useServerInsertedHTML(() => {\n    const styles = jsxStyleRegistry.styles()\n    jsxStyleRegistry.flush()\n    return <>{styles}</>\n  })\n\n  return <StyleRegistry registry={jsxStyleRegistry}>{children}</StyleRegistry>\n}"
  },
  {
    "id": "css-in-js.mdx#4",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "```\n\n```jsx filename=\"app/registry.js\" switcher\n'use client'\n\nimport React, { useState } from 'react'\nimport { useServerInsertedHTML } from 'next/navigation'\nimport { StyleRegistry, createStyleRegistry } from 'styled-jsx'\n\nexport default function StyledJsxRegistry({ children }) {\n  // Only create stylesheet once with lazy initial state\n  // x-ref: https://reactjs.org/docs/hooks-reference.html#lazy-initial-state\n  const [jsxStyleRegistry] = useState(() => createStyleRegistry())\n\n  useServerInsertedHTML(() => {\n    const styles = jsxStyleRegistry.styles()\n    jsxStyleRegistry.flush()\n    return <>{styles}</>\n  })\n\n  return <StyleRegistry registry={jsxStyleRegistry}>{children}</StyleRegistry>\n}\n```\n\nThen, wrap your [root layout](/docs/app/api-reference/file-conventions/layout#root-layout) with the registry:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport StyledJsxRegistry from './registry'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html>\n      <body>\n        <StyledJsxRegistry>{children}</StyledJsxRegistry>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "css-in-js.mdx#5",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nimport StyledJsxRegistry from './registry'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html>\n      <body>\n        <StyledJsxRegistry>{children}</StyledJsxRegistry>\n      </body>\n    </html>\n  )\n}\n```\n\n[View an example here](https://github.com/vercel/next.js/tree/canary/examples/with-styled-jsx)."
  },
  {
    "id": "css-in-js.mdx#6",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "### Styled Components\n\nBelow is an example of how to configure `styled-components@6` or newer:\n\nFirst, enable styled-components in `next.config.js`.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  compiler: {\n    styledComponents: true,\n  },\n}"
  },
  {
    "id": "css-in-js.mdx#7",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "```\n\nThen, use the `styled-components` API to create a global registry component to collect all CSS style rules generated during a render, and a function to return those rules. Then use the `useServerInsertedHTML` hook to inject the styles collected in the registry into the `<head>` HTML tag in the root layout.\n\n```tsx filename=\"lib/registry.tsx\" switcher\n'use client'\n\nimport React, { useState } from 'react'\nimport { useServerInsertedHTML } from 'next/navigation'\nimport { ServerStyleSheet, StyleSheetManager } from 'styled-components'\n\nexport default function StyledComponentsRegistry({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  // Only create stylesheet once with lazy initial state\n  // x-ref: https://reactjs.org/docs/hooks-reference.html#lazy-initial-state\n  const [styledComponentsStyleSheet] = useState(() => new ServerStyleSheet())\n\n  useServerInsertedHTML(() => {\n    const styles = styledComponentsStyleSheet.getStyleElement()\n    styledComponentsStyleSheet.instance.clearTag()\n    return <>{styles}</>\n  })\n\n  if (typeof window !== 'undefined') return <>{children}</>"
  },
  {
    "id": "css-in-js.mdx#8",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "if (typeof window !== 'undefined') return <>{children}</>\n\n  return (\n    <StyleSheetManager sheet={styledComponentsStyleSheet.instance}>\n      {children}\n    </StyleSheetManager>\n  )\n}"
  },
  {
    "id": "css-in-js.mdx#9",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "```\n\n```jsx filename=\"lib/registry.js\" switcher\n'use client'\n\nimport React, { useState } from 'react'\nimport { useServerInsertedHTML } from 'next/navigation'\nimport { ServerStyleSheet, StyleSheetManager } from 'styled-components'\n\nexport default function StyledComponentsRegistry({ children }) {\n  // Only create stylesheet once with lazy initial state\n  // x-ref: https://reactjs.org/docs/hooks-reference.html#lazy-initial-state\n  const [styledComponentsStyleSheet] = useState(() => new ServerStyleSheet())\n\n  useServerInsertedHTML(() => {\n    const styles = styledComponentsStyleSheet.getStyleElement()\n    styledComponentsStyleSheet.instance.clearTag()\n    return <>{styles}</>\n  })\n\n  if (typeof window !== 'undefined') return <>{children}</>\n\n  return (\n    <StyleSheetManager sheet={styledComponentsStyleSheet.instance}>\n      {children}\n    </StyleSheetManager>\n  )\n}"
  },
  {
    "id": "css-in-js.mdx#10",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "```\n\nWrap the `children` of the root layout with the style registry component:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport StyledComponentsRegistry from './lib/registry'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html>\n      <body>\n        <StyledComponentsRegistry>{children}</StyledComponentsRegistry>\n      </body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport StyledComponentsRegistry from './lib/registry'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html>\n      <body>\n        <StyledComponentsRegistry>{children}</StyledComponentsRegistry>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "css-in-js.mdx#11",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "```\n\n[View an example here](https://github.com/vercel/next.js/tree/canary/examples/with-styled-components).\n\n> **Good to know**:\n>\n> - During server rendering, styles will be extracted to a global registry and flushed to the `<head>` of your HTML. This ensures the style rules are placed before any content that might use them. In the future, we may use an upcoming React feature to determine where to inject the styles.\n> - During streaming, styles from each chunk will be collected and appended to existing styles. After client-side hydration is complete, `styled-components` will take over as usual and inject any further dynamic styles.\n> - We specifically use a Client Component at the top level of the tree for the style registry because it's more efficient to extract CSS rules this way. It avoids re-generating styles on subsequent server renders, and prevents them from being sent in the Server Component payload.\n> - For advanced use cases where you need to configure individual properties of styled-components compilation, you can read our [Next.js styled-components API reference](/docs/architecture/nextjs-compiler#styled-components) to learn more.\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "css-in-js.mdx#12",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "</AppOnly>\n\n<PagesOnly>\n\n<details>\n  <summary>Examples</summary>\n\n- [Styled JSX](https://github.com/vercel/next.js/tree/canary/examples/with-styled-jsx)\n- [Styled Components](https://github.com/vercel/next.js/tree/canary/examples/with-styled-components)\n- [Emotion](https://github.com/vercel/next.js/tree/canary/examples/with-emotion)\n- [Linaria](https://github.com/vercel/next.js/tree/canary/examples/with-linaria)\n- [Styletron](https://github.com/vercel/next.js/tree/canary/examples/with-styletron)\n- [Cxs](https://github.com/vercel/next.js/tree/canary/examples/with-cxs)\n- [Fela](https://github.com/vercel/next.js/tree/canary/examples/with-fela)\n- [Stitches](https://github.com/vercel/next.js/tree/canary/examples/with-stitches)\n\n</details>\n\nIt's possible to use any existing CSS-in-JS solution. The simplest one is inline styles:\n\n```jsx\nfunction HiThere() {\n  return <p style={{ color: 'red' }}>hi there</p>\n}\n\nexport default HiThere"
  },
  {
    "id": "css-in-js.mdx#13",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "```\n\nWe bundle [styled-jsx](https://github.com/vercel/styled-jsx) to provide support for isolated scoped CSS.\nThe aim is to support \"shadow CSS\" similar to Web Components, which unfortunately [do not support server-rendering and are JS-only](https://github.com/w3c/webcomponents/issues/71).\n\nSee the above examples for other popular CSS-in-JS solutions (like Styled Components).\n\nA component using `styled-jsx` looks like this:\n\n```jsx\nfunction HelloWorld() {\n  return (\n    <div>\n      Hello world\n      <p>scoped!</p>\n      <style jsx>{`\n        p {\n          color: blue;\n        }\n        div {\n          background: red;\n        }\n        @media (max-width: 600px) {\n          div {\n            background: blue;\n          }\n        }\n      `}</style>\n      <style global jsx>{`\n        body {\n          background: black;\n        }\n      `}</style>\n    </div>\n  )\n}\n\nexport default HelloWorld\n```\n\nPlease see the [styled-jsx documentation](https://github.com/vercel/styled-jsx) for more examples."
  },
  {
    "id": "css-in-js.mdx#14",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "### Disabling JavaScript\n\nYes, if you disable JavaScript the CSS will still be loaded in the production build (`next start`). During development, we require JavaScript to be enabled to provide the best developer experience with [Fast Refresh](https://nextjs.org/blog/next-9-4#fast-refresh).\n\n</PagesOnly>"
  },
  {
    "id": "custom-server.mdx#0",
    "metadata": {
      "title": "How to set up a custom server in Next.js",
      "description": "Start a Next.js app programmatically using a custom server."
    },
    "content": "---\ntitle: How to set up a custom server in Next.js\nnav_title: Custom Server\ndescription: Start a Next.js app programmatically using a custom server.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js includes its own server with `next start` by default. If you have an existing backend, you can still use it with Next.js (this is not a custom server). A custom Next.js server allows you to programmatically start a server for custom patterns. The majority of the time, you will not need this approach. However, it's available if you need to eject."
  },
  {
    "id": "custom-server.mdx#1",
    "metadata": {
      "title": "How to set up a custom server in Next.js",
      "description": "Start a Next.js app programmatically using a custom server."
    },
    "content": "> **Good to know**:\n>\n> - Before deciding to use a custom server, keep in mind that it should only be used when the integrated router of Next.js can't meet your app requirements. A custom server will remove important performance optimizations, like **[Automatic Static Optimization](/docs/pages/building-your-application/rendering/automatic-static-optimization).**\n> - When using standalone output mode, it does not trace custom server files. This mode outputs a separate minimal `server.js` file, instead. These cannot be used together.\n\nTake a look at the [following example](https://github.com/vercel/next.js/tree/canary/examples/custom-server) of a custom server:\n\n```ts filename=\"server.ts\" switcher\nimport { createServer } from 'http'\nimport { parse } from 'url'\nimport next from 'next'\n\nconst port = parseInt(process.env.PORT || '3000', 10)\nconst dev = process.env.NODE_ENV !== 'production'\nconst app = next({ dev })\nconst handle = app.getRequestHandler()\n\napp.prepare().then(() => {\n  createServer((req, res) => {\n    const parsedUrl = parse(req.url!, true)\n    handle(req, res, parsedUrl)\n  }).listen(port)"
  },
  {
    "id": "custom-server.mdx#2",
    "metadata": {
      "title": "How to set up a custom server in Next.js",
      "description": "Start a Next.js app programmatically using a custom server."
    },
    "content": "app.prepare().then(() => {\n  createServer((req, res) => {\n    const parsedUrl = parse(req.url!, true)\n    handle(req, res, parsedUrl)\n  }).listen(port)\n\n  console.log(\n    `> Server listening at http://localhost:${port} as ${\n      dev ? 'development' : process.env.NODE_ENV\n    }`\n  )\n})"
  },
  {
    "id": "custom-server.mdx#3",
    "metadata": {
      "title": "How to set up a custom server in Next.js",
      "description": "Start a Next.js app programmatically using a custom server."
    },
    "content": "```\n\n```js filename=\"server.js\" switcher\nimport { createServer } from 'http'\nimport { parse } from 'url'\nimport next from 'next'\n\nconst port = parseInt(process.env.PORT || '3000', 10)\nconst dev = process.env.NODE_ENV !== 'production'\nconst app = next({ dev })\nconst handle = app.getRequestHandler()\n\napp.prepare().then(() => {\n  createServer((req, res) => {\n    const parsedUrl = parse(req.url, true)\n    handle(req, res, parsedUrl)\n  }).listen(port)\n\n  console.log(\n    `> Server listening at http://localhost:${port} as ${\n      dev ? 'development' : process.env.NODE_ENV\n    }`\n  )\n})\n```\n\n> `server.js` does not run through the Next.js Compiler or bundling process. Make sure the syntax and source code this file requires are compatible with the current Node.js version you are using. [View an example](https://github.com/vercel/next.js/tree/canary/examples/custom-server).\n\nTo run the custom server, you'll need to update the `scripts` in `package.json` like so:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"node server.js\",\n    \"build\": \"next build\",\n    \"start\": \"NODE_ENV=production node server.js\"\n  }\n}"
  },
  {
    "id": "custom-server.mdx#4",
    "metadata": {
      "title": "How to set up a custom server in Next.js",
      "description": "Start a Next.js app programmatically using a custom server."
    },
    "content": "```\n\nAlternatively, you can set up `nodemon` ([example](https://github.com/vercel/next.js/tree/canary/examples/custom-server)). The custom server uses the following import to connect the server with the Next.js application:\n\n```js\nimport next from 'next'\n\nconst app = next({})"
  },
  {
    "id": "custom-server.mdx#5",
    "metadata": {
      "title": "How to set up a custom server in Next.js",
      "description": "Start a Next.js app programmatically using a custom server."
    },
    "content": "```\n\nThe above `next` import is a function that receives an object with the following options:"
  },
  {
    "id": "custom-server.mdx#6",
    "metadata": {
      "title": "How to set up a custom server in Next.js",
      "description": "Start a Next.js app programmatically using a custom server."
    },
    "content": "| Option       | Type               | Description                                                                         |\n| ------------ | ------------------ | ----------------------------------------------------------------------------------- |\n| `conf`       | `Object`           | The same object you would use in `next.config.js`. Defaults to `{}`                 |\n| `dev`        | `Boolean`          | (_Optional_) Whether or not to launch Next.js in dev mode. Defaults to `false`      |\n| `dir`        | `String`           | (_Optional_) Location of the Next.js project. Defaults to `'.'`                     |\n| `quiet`      | `Boolean`          | (_Optional_) Hide error messages containing server information. Defaults to `false` |\n| `hostname`   | `String`           | (_Optional_) The hostname the server is running behind                              |\n| `port`       | `Number`           | (_Optional_) The port the server is running behind                                  |\n| `httpServer` | `node:http#Server` | (_Optional_) The HTTP Server that Next.js is running behind                         |"
  },
  {
    "id": "custom-server.mdx#7",
    "metadata": {
      "title": "How to set up a custom server in Next.js",
      "description": "Start a Next.js app programmatically using a custom server."
    },
    "content": "| `httpServer` | `node:http#Server` | (_Optional_) The HTTP Server that Next.js is running behind                         |\n| `turbopack`  | `Boolean`          | (_Optional_) Enable Turbopack (enabled by default)                                  |\n| `webpack`    | `Boolean`          | (_Optional_) Enable webpack                                                         |"
  },
  {
    "id": "custom-server.mdx#8",
    "metadata": {
      "title": "How to set up a custom server in Next.js",
      "description": "Start a Next.js app programmatically using a custom server."
    },
    "content": "The returned `app` can then be used to let Next.js handle requests as required.\n\n<PagesOnly>"
  },
  {
    "id": "custom-server.mdx#9",
    "metadata": {
      "title": "How to set up a custom server in Next.js",
      "description": "Start a Next.js app programmatically using a custom server."
    },
    "content": "## Disabling file-system routing\n\nBy default, `Next` will serve each file in the `pages` folder under a pathname matching the filename. If your project uses a custom server, this behavior may result in the same content being served from multiple paths, which can present problems with SEO and UX.\n\nTo disable this behavior and prevent routing based on files in `pages`, open `next.config.js` and disable the `useFileSystemPublicRoutes` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  useFileSystemPublicRoutes: false,\n}\n```\n\n> Note that `useFileSystemPublicRoutes` disables filename routes from SSR; client-side routing may still access those paths. When using this option, you should guard against navigation to routes you do not want programmatically.\n\n> You may also wish to configure the client-side router to disallow client-side redirects to filename routes; for that refer to [`router.beforePopState`](/docs/pages/api-reference/functions/use-router#routerbeforepopstate).\n\n</PagesOnly>"
  },
  {
    "id": "data-security.mdx#0",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "---\ntitle: How to think about data security in Next.js\nnav_title: Data Security\ndescription: Learn the built-in data security features in Next.js and learn best practices for protecting your application's data.\nrelated:\n  title: Next Steps\n  description: Learn more about the topics mentioned in this guide.\n  links:\n    - app/guides/authentication\n    - app/guides/content-security-policy\n    - app/guides/forms\n---\n\n[React Server Components](https://react.dev/reference/rsc/server-components) improve performance and simplify data fetching, but also shift where and how data is accessed, changing some of the traditional security assumptions for handling data in frontend apps.\n\nThis guide will help you understand how to think about data security in Next.js and how to implement best practices."
  },
  {
    "id": "data-security.mdx#1",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "## Data fetching approaches\n\nThere are three main approaches we recommend for fetching data in Next.js, depending on the size and age of your project:\n\n- [HTTP APIs](#external-http-apis): for existing large applications and organizations.\n- [Data Access Layer](#data-access-layer): for new projects.\n- [Component-Level Data Access](#component-level-data-access): for prototypes and learning.\n\nWe recommend choosing one data fetching approach and avoiding mixing them. This makes it clear for both developers working in your code base and security auditors what to expect."
  },
  {
    "id": "data-security.mdx#2",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "### External HTTP APIs\n\nYou should follow a **Zero Trust** model when adopting Server Components in an existing project. You can continue calling your existing API endpoints such as REST or GraphQL from Server Components using [`fetch`](/docs/app/api-reference/functions/fetch), just as you would in Client Components.\n\n```tsx filename=\"app/page.tsx\"\nimport { cookies } from 'next/headers'\n\nexport default async function Page() {\n  const cookieStore = cookies()\n  const token = cookieStore.get('AUTH_TOKEN')?.value\n\n  const res = await fetch('https://api.example.com/profile', {\n    headers: {\n      Cookie: `AUTH_TOKEN=${token}`,\n      // Other headers\n    },\n  })\n\n  // ....\n}\n```\n\nThis approach works well when:\n\n- You already have security practices in place.\n- Separate backend teams use other languages or manage APIs independently."
  },
  {
    "id": "data-security.mdx#3",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "### Data Access Layer\n\nFor new projects, we recommend creating a dedicated **Data Access Layer (DAL)**. This is a internal library that controls how and when data is fetched, and what gets passed to your render context.\n\nA Data Access Layer should:\n\n- Only run on the server.\n- Perform authorization checks.\n- Return safe, minimal **Data Transfer Objects (DTOs)**.\n\nThis approach centralizes all data access logic, making it easier to enforce consistent data access and reduces the risk of authorization bugs. You also get the benefit of sharing an in-memory cache across different parts of a request.\n\n```ts filename=\"data/auth.ts\"\nimport { cache } from 'react'\nimport { cookies } from 'next/headers'"
  },
  {
    "id": "data-security.mdx#4",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "```ts filename=\"data/auth.ts\"\nimport { cache } from 'react'\nimport { cookies } from 'next/headers'\n\n// Cached helper methods makes it easy to get the same value in many places\n// without manually passing it around. This discourages passing it from Server\n// Component to Server Component which minimizes risk of passing it to a Client\n// Component.\nexport const getCurrentUser = cache(async () => {\n  const token = cookies().get('AUTH_TOKEN')\n  const decodedToken = await decryptAndValidate(token)\n  // Don't include secret tokens or private information as public fields.\n  // Use classes to avoid accidentally passing the whole object to the client.\n  return new User(decodedToken.id)\n})"
  },
  {
    "id": "data-security.mdx#5",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "```\n\n```tsx filename=\"data/user-dto.tsx\"\nimport 'server-only'\nimport { getCurrentUser } from './auth'\n\nfunction canSeeUsername(viewer: User) {\n  // Public info for now, but can change\n  return true\n}\n\nfunction canSeePhoneNumber(viewer: User, team: string) {\n  // Privacy rules\n  return viewer.isAdmin || team === viewer.team\n}\n\nexport async function getProfileDTO(slug: string) {\n  // Don't pass values, read back cached values, also solves context and easier to make it lazy\n\n  // use a database API that supports safe templating of queries\n  const [rows] = await sql`SELECT * FROM user WHERE slug = ${slug}`\n  const userData = rows[0]\n\n  const currentUser = await getCurrentUser()\n\n  // only return the data relevant for this query and not everything\n  // <https://www.w3.org/2001/tag/doc/APIMinimization>\n  return {\n    username: canSeeUsername(currentUser) ? userData.username : null,\n    phonenumber: canSeePhoneNumber(currentUser, userData.team)\n      ? userData.phonenumber\n      : null,\n  }\n}"
  },
  {
    "id": "data-security.mdx#6",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "```\n\n```tsx filename=\"app/page.tsx\"\nimport { getProfile } from '../../data/user'\n\nexport async function Page({ params: { slug } }) {\n  // This page can now safely pass around this profile knowing\n  // that it shouldn't contain anything sensitive.\n  const profile = await getProfile(slug);\n  ...\n}\n```\n\n> **Good to know:** Secret keys should be stored in environment variables, but only the Data Access Layer should access `process.env`. This keeps secrets from being exposed to other parts of the application."
  },
  {
    "id": "data-security.mdx#7",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "### Component-level data access\n\nFor quick prototypes and iteration, database queries can be placed directly in Server Components.\n\nThis approach, however, makes it easier to accidentally expose private data to the client, for example:\n\n```tsx filename=\"app/page.tsx\"\nimport Profile from './components/profile.tsx'\n\nexport async function Page({ params: { slug } }) {\n  const [rows] = await sql`SELECT * FROM user WHERE slug = ${slug}`\n  const userData = rows[0]\n  // EXPOSED: This exposes all the fields in userData to the client because\n  // we are passing the data from the Server Component to the Client.\n  return <Profile user={userData} />\n}\n```\n\n```tsx filename=\"app/ui/profile.tsx\"\n'use client'\n\n// BAD: This is a bad props interface because it accepts way more data than the\n// Client Component needs and it encourages server components to pass all that\n// data down. A better solution would be to accept a limited object with just\n// the fields necessary for rendering the profile.\nexport default async function Profile({ user }: { user: User }) {\n  return (\n    <div>\n      <h1>{user.name}</h1>\n      ...\n    </div>\n  )\n}"
  },
  {
    "id": "data-security.mdx#8",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "```\n\nYou should sanitize the data before passing it to the Client Component:\n\n```ts filename=\"data/user.ts\"\nimport { sql } from './db'\n\nexport async function getUser(slug: string) {\n  const [rows] = await sql`SELECT * FROM user WHERE slug = ${slug}`\n  const user = rows[0]\n\n  // Return only the public fields\n  return {\n    name: user.name,\n  }\n}\n```\n\n```tsx filename=\"app/page.tsx\"\nimport { getUser } from '../data/user'\nimport Profile from './ui/profile'\n\nexport default async function Page({\n  params: { slug },\n}: {\n  params: { slug: string }\n}) {\n  const publicProfile = await getUser(slug)\n  return <Profile user={publicProfile} />\n}\n```"
  },
  {
    "id": "data-security.mdx#9",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "## Reading data\n\n### Passing data from server to client\n\nOn the initial load, both Server and Client Components run on the server to generate HTML. However, they execute in isolated module systems. This ensures that Server Components can access private data and APIs, while Client Components cannot.\n\n**Server Components:**\n\n- Run only on the server.\n- Can safely access environment variables, secrets, databases, and internal APIs.\n\n**Client Components:**\n\n- Run on the server during pre-rendering, but must follow the same security assumptions as code running in the browser.\n- Must not access privileged data or server-only modules.\n\nThis ensures the app is secure by default, but it's possible to accidentally expose private data through how data is fetched or passed to components."
  },
  {
    "id": "data-security.mdx#10",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "### Tainting\n\nTo prevent accidental exposure of private data to the client, you can use React Taint APIs:\n\n- [`experimental_taintObjectReference`](https://react.dev/reference/react/experimental_taintObjectReference) for data objects.\n- [`experimental_taintUniqueValue`](https://react.dev/reference/react/experimental_taintUniqueValue) for specific values.\n\nYou can enable usage in your Next.js app with the [`experimental.taint`](/docs/app/api-reference/config/next-config-js/taint) option in `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  experimental: {\n    taint: true,\n  },\n}\n```\n\nThis prevents the tainted objects or values from being passed to the client. However, it's an additional layer of protection, you should still filter and sanitize the data in your [DAL](#data-access-layer) before passing it to React's render context.\n\n> **Good to know:**\n>\n> - By default, environment variables are only available on the Server. Next.js exposes any environment variable prefixed with `NEXT_PUBLIC_` to the client. [Learn more](/docs/app/guides/environment-variables).\n> - Functions and classes are already blocked from being passed to Client Components by default."
  },
  {
    "id": "data-security.mdx#11",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "### Preventing client-side execution of server-only code\n\nTo prevent server-only code from being executed on the client, you can mark a module with the [`server-only`](https://www.npmjs.com/package/server-only) package:\n\n```bash package=\"npm\"\nnpm install server-only\n```\n\n```bash package=\"yarn\"\nyarn add server-only\n```\n\n```bash package=\"pnpm\"\npnpm add server-only\n```\n\n```bash package=\"bun\"\nbun add server-only\n```\n\n```ts filename=\"lib/data.ts\"\nimport 'server-only'\n\n//...\n```\n\nThis ensures that proprietary code or internal business logic stays on the server by causing a build error if the module is imported in the client environment."
  },
  {
    "id": "data-security.mdx#12",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "## Mutating Data\n\nNext.js handles mutations with [Server Actions](https://react.dev/reference/rsc/server-functions)."
  },
  {
    "id": "data-security.mdx#13",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "### Built-in Server Actions Security features\n\nBy default, when a Server Action is created and exported, it creates a public HTTP endpoint and should be treated with the same security assumptions and authorization checks. This means, even if a Server Action or utility function is not imported elsewhere in your code, it's still publicly accessible.\n\nTo improve security, Next.js has the following built-in features:\n\n- **Secure action IDs:** Next.js creates encrypted, non-deterministic IDs to allow the client to reference and call the Server Action. These IDs are periodically recalculated between builds for enhanced security.\n- **Dead code elimination:** Unused Server Actions (referenced by their IDs) are removed from client bundle to avoid public access.\n\n> **Good to know**:\n>\n> The IDs are created during compilation and are cached for a maximum of 14 days. They will be regenerated when a new build is initiated or when the build cache is invalidated.\n> This security improvement reduces the risk in cases where an authentication layer is missing. However, you should still treat Server Actions like public HTTP endpoints.\n\n```jsx\n// app/actions.js\n'use server'"
  },
  {
    "id": "data-security.mdx#14",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "```jsx\n// app/actions.js\n'use server'\n\n// If this action **is** used in our application, Next.js\n// will create a secure ID to allow the client to reference\n// and call the Server Action.\nexport async function updateUserAction(formData) {}\n\n// If this action **is not** used in our application, Next.js\n// will automatically remove this code during `next build`\n// and will not create a public endpoint.\nexport async function deleteUserAction(formData) {}\n```"
  },
  {
    "id": "data-security.mdx#15",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "### Validating client input\n\nYou should always validate input from client, as they can be easily modified. For example, form data, URL parameters, headers, and searchParams:\n\n```tsx filename=\"app/page.tsx\"\n// BAD: Trusting searchParams directly\nexport default async function Page({ searchParams }) {\n  const isAdmin = searchParams.get('isAdmin')\n  if (isAdmin === 'true') {\n    // Vulnerable: relies on untrusted client data\n    return <AdminPanel />\n  }\n}\n\n// GOOD: Re-verify every time\nimport { cookies } from 'next/headers'\nimport { verifyAdmin } from './auth'\n\nexport default async function Page() {\n  const token = cookies().get('AUTH_TOKEN')\n  const isAdmin = await verifyAdmin(token)\n\n  if (isAdmin) {\n    return <AdminPanel />\n  }\n}\n```\n\n### Authentication and authorization\n\nYou should always ensure that a user is authorized to perform an action. For example:\n\n```tsx filename=\"app/actions.ts\"\n'use server'\n\nimport { auth } from './lib'\n\nexport function addItem() {\n  const { user } = auth()\n  if (!user) {\n    throw new Error('You must be signed in to perform this action')\n  }\n\n  // ...\n}\n```\n\nLearn more about [Authentication](/docs/app/guides/authentication) in Next.js."
  },
  {
    "id": "data-security.mdx#16",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "### Closures and encryption\n\nDefining a Server Action inside a component creates a [closure](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures) where the action has access to the outer function's scope. For example, the `publish` action has access to the `publishVersion` variable:\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default async function Page() {\n  const publishVersion = await getLatestVersion();\n\n  async function publish() {\n    \"use server\";\n    if (publishVersion !== await getLatestVersion()) {\n      throw new Error('The version has changed since pressing publish');\n    }\n    ...\n  }\n\n  return (\n    <form>\n      <button formAction={publish}>Publish</button>\n    </form>\n  );\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nexport default async function Page() {\n  const publishVersion = await getLatestVersion();\n\n  async function publish() {\n    \"use server\";\n    if (publishVersion !== await getLatestVersion()) {\n      throw new Error('The version has changed since pressing publish');\n    }\n    ...\n  }\n\n  return (\n    <form>\n      <button formAction={publish}>Publish</button>\n    </form>\n  );\n}"
  },
  {
    "id": "data-security.mdx#17",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "```\n\nClosures are useful when you need to capture a _snapshot_ of data (e.g. `publishVersion`) at the time of rendering so that it can be used later when the action is invoked.\n\nHowever, for this to happen, the captured variables are sent to the client and back to the server when the action is invoked. To prevent sensitive data from being exposed to the client, Next.js automatically encrypts the closed-over variables. A new private key is generated for each action every time a Next.js application is built. This means actions can only be invoked for a specific build.\n\n> **Good to know:** We don't recommend relying on encryption alone to prevent sensitive values from being exposed on the client."
  },
  {
    "id": "data-security.mdx#18",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "### Overwriting encryption keys (advanced)\n\nWhen self-hosting your Next.js application across multiple servers, each server instance may end up with a different encryption key, leading to potential inconsistencies.\n\nTo mitigate this, you can overwrite the encryption key using the `process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY` environment variable. Specifying this variable ensures that your encryption keys are persistent across builds, and all server instances use the same key. This variable **must** be AES-GCM encrypted.\n\nThis is an advanced use case where consistent encryption behavior across multiple deployments is critical for your application. You should consider standard security practices such key rotation and signing.\n\n> **Good to know:** Next.js applications deployed to Vercel automatically handle this."
  },
  {
    "id": "data-security.mdx#19",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "### Allowed origins (advanced)\n\nSince Server Actions can be invoked in a `<form>` element, this opens them up to [CSRF attacks](https://developer.mozilla.org/en-US/docs/Glossary/CSRF).\n\nBehind the scenes, Server Actions use the `POST` method, and only this HTTP method is allowed to invoke them. This prevents most CSRF vulnerabilities in modern browsers, particularly with [SameSite cookies](https://web.dev/articles/samesite-cookies-explained) being the default.\n\nAs an additional protection, Server Actions in Next.js also compare the [Origin header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin) to the [Host header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Host) (or `X-Forwarded-Host`). If these don't match, the request will be aborted. In other words, Server Actions can only be invoked on the same host as the page that hosts it."
  },
  {
    "id": "data-security.mdx#20",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "For large applications that use reverse proxies or multi-layered backend architectures (where the server API differs from the production domain), it's recommended to use the configuration option [`serverActions.allowedOrigins`](/docs/app/api-reference/config/next-config-js/serverActions) option to specify a list of safe origins. The option accepts an array of strings.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nmodule.exports = {\n  experimental: {\n    serverActions: {\n      allowedOrigins: ['my-proxy.com', '*.my-proxy.com'],\n    },\n  },\n}"
  },
  {
    "id": "data-security.mdx#21",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "```\n\nLearn more about [Security and Server Actions](https://nextjs.org/blog/security-nextjs-server-components-actions)."
  },
  {
    "id": "data-security.mdx#22",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "### Avoiding side-effects during rendering\n\nMutations (e.g. logging out users, updating databases, invalidating caches) should never be a side-effect, either in Server or Client Components. Next.js explicitly prevents setting cookies or triggering cache revalidation within render methods to avoid unintended side effects.\n\n```tsx filename=\"app/page.tsx\"\n// BAD: Triggering a mutation during rendering\nexport default async function Page({ searchParams }) {\n  if (searchParams.get('logout')) {\n    cookies().delete('AUTH_TOKEN')\n  }\n\n  return <UserProfile />\n}\n```\n\nInstead, you should use Server Actions to handle mutations.\n\n```tsx filename=\"app/page.tsx\"\n// GOOD: Using Server Actions to handle mutations\nimport { logout } from './actions'\n\nexport default function Page() {\n  return (\n    <>\n      <UserProfile />\n      <form action={logout}>\n        <button type=\"submit\">Logout</button>\n      </form>\n    </>\n  )\n}\n```\n\n> **Good to know:** Next.js uses `POST` requests to handle mutations. This prevents accidental side-effects from GET requests, reducing Cross-Site Request Forgery (CSRF) risks."
  },
  {
    "id": "data-security.mdx#23",
    "metadata": {
      "title": "How to think about data security in Next.js",
      "description": "Learn the built-in data security features in Next.js and learn best practices for protecting your application's data."
    },
    "content": "## Auditing\n\nIf you're doing an audit of a Next.js project, here are a few things we recommend looking extra at:\n\n- **Data Access Layer:** Is there an established practice for an isolated Data Access Layer? Verify that database packages and environment variables are not imported outside the Data Access Layer.\n- **`\"use client\"` files:** Are the Component props expecting private data? Are the type signatures overly broad?\n- **`\"use server\"` files:** Are the Action arguments validated in the action or inside the Data Access Layer? Is the user re-authorized inside the action?\n- **`/[param]/.`** Folders with brackets are user input. Are params validated?\n- **`proxy.ts` and `route.ts`:** Have a lot of power. Spend extra time auditing these using traditional techniques. Perform Penetration Testing or Vulnerability Scanning regularly or in alignment with your team's software development lifecycle."
  },
  {
    "id": "debugging.mdx#0",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "---\ntitle: How to use debugging tools with Next.js\nnav_title: Debugging\ndescription: Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nThis documentation explains how you can debug your Next.js frontend and backend code with full source maps support using the [VS Code debugger](https://code.visualstudio.com/docs/editor/debugging), [Chrome DevTools](https://developers.google.com/web/tools/chrome-devtools), or [Firefox DevTools](https://firefox-source-docs.mozilla.org/devtools-user/).\n\nAny debugger that can attach to Node.js can also be used to debug a Next.js application. You can find more details in the Node.js [Debugging Guide](https://nodejs.org/en/docs/guides/debugging-getting-started/)."
  },
  {
    "id": "debugging.mdx#1",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "## Debugging with VS Code\n\nCreate a file named `.vscode/launch.json` at the root of your project with the following content:"
  },
  {
    "id": "debugging.mdx#2",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "```json filename=\"launch.json\"\n{\n  \"version\": \"0.2.0\",\n  \"configurations\": [\n    {\n      \"name\": \"Next.js: debug server-side\",\n      \"type\": \"node-terminal\",\n      \"request\": \"launch\",\n      \"command\": \"npm run dev -- --inspect\"\n    },\n    {\n      \"name\": \"Next.js: debug client-side\",\n      \"type\": \"chrome\",\n      \"request\": \"launch\",\n      \"url\": \"http://localhost:3000\"\n    },\n    {\n      \"name\": \"Next.js: debug client-side (Firefox)\",\n      \"type\": \"firefox\",\n      \"request\": \"launch\",\n      \"url\": \"http://localhost:3000\",\n      \"reAttach\": true,\n      \"pathMappings\": [\n        {\n          \"url\": \"webpack://_N_E\",\n          \"path\": \"${workspaceFolder}\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Next.js: debug full stack\",\n      \"type\": \"node\",\n      \"request\": \"launch\",\n      \"program\": \"${workspaceFolder}/node_modules/next/dist/bin/next\",\n      \"runtimeArgs\": [\"--inspect\"],\n      \"skipFiles\": [\"<node_internals>/**\"],\n      \"serverReadyAction\": {\n        \"action\": \"debugWithEdge\",\n        \"killOnServerStop\": true,\n        \"pattern\": \"- Local:.+(https?://.+)\",\n        \"uriFormat\": \"%s\",\n        \"webRoot\": \"${workspaceFolder}\"\n      }\n    }\n  ]\n}"
  },
  {
    "id": "debugging.mdx#3",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "```\n\n> **Note**: To use Firefox debugging in VS Code, you'll need to install the [Firefox Debugger extension](https://marketplace.visualstudio.com/items?itemName=firefox-devtools.vscode-firefox-debug).\n\n`npm run dev` can be replaced with `yarn dev` if you're using Yarn or `pnpm dev` if you're using pnpm.\n\nIn the \"Next.js: debug full stack\" configuration, `serverReadyAction.action` specifies which browser to open when the server is ready. `debugWithEdge` means to launch the Edge browser. If you are using Chrome, change this value to `debugWithChrome`.\n\nIf you're [changing the port number](/docs/pages/api-reference/cli/next#next-dev-options) your application starts on, replace the `3000` in `http://localhost:3000` with the port you're using instead.\n\nIf you're running Next.js from a directory other than root (for example, if you're using Turborepo) then you need to add `cwd` to the server-side and full stack debugging tasks. For example, `\"cwd\": \"${workspaceFolder}/apps/web\"`."
  },
  {
    "id": "debugging.mdx#4",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "Now go to the Debug panel (`Ctrl+Shift+D` on Windows/Linux, `⇧+⌘+D` on macOS), select a launch configuration, then press `F5` or select **Debug: Start Debugging** from the Command Palette to start your debugging session."
  },
  {
    "id": "debugging.mdx#5",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "## Using the Debugger in Jetbrains WebStorm\n\nClick the drop down menu listing the runtime configuration, and click `Edit Configurations...`. Create a `JavaScript Debug` debug configuration with `http://localhost:3000` as the URL. Customize to your liking (e.g. Browser for debugging, store as project file), and click `OK`. Run this debug configuration, and the selected browser should automatically open. At this point, you should have 2 applications in debug mode: the NextJS node application, and the client/browser application."
  },
  {
    "id": "debugging.mdx#6",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "## Debugging with Browser DevTools\n\n### Client-side code\n\nStart your development server as usual by running `next dev`, `npm run dev`, or `yarn dev`. Once the server starts, open `http://localhost:3000` (or your alternate URL) in your preferred browser.\n\nFor Chrome:\n\n- Open Chrome's Developer Tools (`Ctrl+Shift+J` on Windows/Linux, `⌥+⌘+I` on macOS)\n- Go to the **Sources** tab\n\nFor Firefox:\n\n- Open Firefox's Developer Tools (`Ctrl+Shift+I` on Windows/Linux, `⌥+⌘+I` on macOS)\n- Go to the **Debugger** tab\n\nIn either browser, any time your client-side code reaches a [`debugger`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/debugger) statement, code execution will pause and that file will appear in the debug area. You can also search for files to set breakpoints manually:\n\n- In Chrome: Press `Ctrl+P` on Windows/Linux or `⌘+P` on macOS\n- In Firefox: Press `Ctrl+P` on Windows/Linux or `⌘+P` on macOS, or use the file tree in the left panel\n\nNote that when searching, your source files will have paths starting with `webpack://_N_E/./`."
  },
  {
    "id": "debugging.mdx#7",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "### React Developer Tools\n\nFor React-specific debugging, install the [React Developer Tools](https://react.dev/learn/react-developer-tools) browser extension. This essential tool helps you:\n\n- Inspect React components\n- Edit props and state\n- Identify performance problems"
  },
  {
    "id": "debugging.mdx#8",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "### Server-side code\n\nTo debug server-side Next.js code with browser DevTools, you need to pass the `--inspect` flag:\n\n```bash filename=\"Terminal\"\nnext dev --inspect\n```\n\nThe value of `--inspect` is passed to the underlying Node.js process. Check out the [`--inspect` docs for advanced use cases](https://nodejs.org/api/cli.html#--inspecthostport).\n\n> **Good to know**: Use `--inspect=0.0.0.0` to allow remote debugging access outside localhost, such as when running the app in a Docker container.\n\nLaunching the Next.js dev server with the `--inspect` flag will look something like this:\n\n```bash filename=\"Terminal\"\nDebugger listening on ws://127.0.0.1:9229/0cf90313-350d-4466-a748-cd60f4e47c95\nFor help, see: https://nodejs.org/en/docs/inspector\nready - started server on 0.0.0.0:3000, url: http://localhost:3000"
  },
  {
    "id": "debugging.mdx#9",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "```\n\nFor Chrome:\n\n1. Open a new tab and visit `chrome://inspect`\n1. Look for your Next.js application in the **Remote Target** section\n1. Click **inspect** to open a separate DevTools window\n1. Go to the **Sources** tab\n\nFor Firefox:\n\n1. Open a new tab and visit `about:debugging`\n1. Click **This Firefox** in the left sidebar\n1. Under **Remote Targets**, find your Next.js application\n1. Click **Inspect** to open the debugger\n1. Go to the **Debugger** tab\n\nDebugging server-side code works similarly to client-side debugging. When searching for files (`Ctrl+P`/`⌘+P`), your source files will have paths starting with `webpack://{application-name}/./` (where `{application-name}` will be replaced with the name of your application according to your `package.json` file).\n\nTo use `--inspect-brk` or `--inspect-wait`, you have to specify `NODE_OPTIONS` instead. e.g. `NODE_OPTIONS=--inspect-brk next dev`."
  },
  {
    "id": "debugging.mdx#10",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "### Inspect Server Errors with Browser DevTools\n\nWhen you encounter an error, inspecting the source code can help trace the root cause of errors.\n\nNext.js will display a Node.js icon underneath the Next.js version indicator on the error overlay. By clicking that icon, the DevTools URL is copied to your clipboard. You can open a new browser tab with that URL to inspect the Next.js server process.\n\n### Debugging on Windows\n\nEnsure Windows Defender is disabled on your machine. This external service will check _every file read_, which has been reported to greatly increase Fast Refresh time with `next dev`. This is a known issue, not related to Next.js, but it does affect Next.js development."
  },
  {
    "id": "debugging.mdx#11",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code, Chrome DevTools, or Firefox DevTools."
    },
    "content": "## More information\n\nTo learn more about how to use a JavaScript debugger, take a look at the following documentation:\n\n- [Node.js debugging in VS Code: Breakpoints](https://code.visualstudio.com/docs/nodejs/nodejs-debugging#_breakpoints)\n- [Chrome DevTools: Debug JavaScript](https://developers.google.com/web/tools/chrome-devtools/javascript)\n- [Firefox DevTools: Debugger](https://firefox-source-docs.mozilla.org/devtools-user/debugger/)"
  },
  {
    "id": "draft-mode.mdx#0",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with App Router here."
    },
    "content": "---\ntitle: How to preview content with Draft Mode in Next.js\nnav_title: Draft Mode\ndescription: Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with App Router here.\nrelated:\n  title: Next Steps\n  description: See the API reference for more information on how to use Draft Mode.\n  links:\n    - app/api-reference/functions/draft-mode\n---\n\n**Draft Mode** allows you to preview draft content from your headless CMS in your Next.js application. This is useful for static pages that are generated at build time as it allows you to switch to [dynamic rendering](/docs/app/guides/caching#dynamic-rendering) and see the draft changes without having to rebuild your entire site.\n\nThis page walks through how to enable and use Draft Mode."
  },
  {
    "id": "draft-mode.mdx#1",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with App Router here."
    },
    "content": "## Step 1: Create a Route Handler\n\nCreate a [Route Handler](/docs/app/api-reference/file-conventions/route). It can have any name, for example, `app/api/draft/route.ts`.\n\n```ts filename=\"app/api/draft/route.ts\" switcher\nexport async function GET(request: Request) {\n  return new Response('')\n}\n```\n\n```js filename=\"app/api/draft/route.js\" switcher\nexport async function GET() {\n  return new Response('')\n}\n```\n\nThen, import the [`draftMode`](/docs/app/api-reference/functions/draft-mode) function and call the `enable()` method.\n\n```ts filename=\"app/api/draft/route.ts\" switcher\nimport { draftMode } from 'next/headers'\n\nexport async function GET(request: Request) {\n  const draft = await draftMode()\n  draft.enable()\n  return new Response('Draft mode is enabled')\n}\n```\n\n```js filename=\"app/api/draft/route.js\" switcher\nimport { draftMode } from 'next/headers'\n\nexport async function GET(request) {\n  const draft = await draftMode()\n  draft.enable()\n  return new Response('Draft mode is enabled')\n}"
  },
  {
    "id": "draft-mode.mdx#2",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with App Router here."
    },
    "content": "```\n\nThis will set a **cookie** to enable draft mode. Subsequent requests containing this cookie will trigger draft mode and change the behavior of statically generated pages.\n\nYou can test this manually by visiting `/api/draft` and looking at your browser’s developer tools. Notice the `Set-Cookie` response header with a cookie named `__prerender_bypass`."
  },
  {
    "id": "draft-mode.mdx#3",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with App Router here."
    },
    "content": "## Step 2: Access the Route Handler from your Headless CMS\n\n> These steps assume that the headless CMS you’re using supports setting **custom draft URLs**. If it doesn’t, you can still use this method to secure your draft URLs, but you’ll need to construct and access the draft URL manually. The specific steps will vary depending on which headless CMS you’re using.\n\nTo securely access the Route Handler from your headless CMS:\n\n1. Create a **secret token string** using a token generator of your choice. This secret will only be known by your Next.js app and your headless CMS.\n2. If your headless CMS supports setting custom draft URLs, specify a draft URL (this assumes that your Route Handler is located at `app/api/draft/route.ts`). For example:\n\n```bash filename=\"Terminal\"\nhttps://<your-site>/api/draft?secret=<token>&slug=<path>"
  },
  {
    "id": "draft-mode.mdx#4",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with App Router here."
    },
    "content": "```\n\n> - `<your-site>` should be your deployment domain.\n> - `<token>` should be replaced with the secret token you generated.\n> - `<path>` should be the path for the page that you want to view. If you want to view `/posts/one`, then you should use `&slug=/posts/one`.\n>\n> Your headless CMS might allow you to include a variable in the draft URL so that `<path>` can be set dynamically based on the CMS’s data like so: `&slug=/posts/{entry.fields.slug}`\n\n3. In your Route Handler, check that the secret matches and that the `slug` parameter exists (if not, the request should fail), call `draftMode.enable()` to set the cookie. Then, redirect the browser to the path specified by `slug`:\n\n```ts filename=\"app/api/draft/route.ts\" switcher\nimport { draftMode } from 'next/headers'\nimport { redirect } from 'next/navigation'\n\nexport async function GET(request: Request) {\n  // Parse query string parameters\n  const { searchParams } = new URL(request.url)\n  const secret = searchParams.get('secret')\n  const slug = searchParams.get('slug')"
  },
  {
    "id": "draft-mode.mdx#5",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with App Router here."
    },
    "content": "// Check the secret and next parameters\n  // This secret should only be known to this Route Handler and the CMS\n  if (secret !== 'MY_SECRET_TOKEN' || !slug) {\n    return new Response('Invalid token', { status: 401 })\n  }\n\n  // Fetch the headless CMS to check if the provided `slug` exists\n  // getPostBySlug would implement the required fetching logic to the headless CMS\n  const post = await getPostBySlug(slug)\n\n  // If the slug doesn't exist prevent draft mode from being enabled\n  if (!post) {\n    return new Response('Invalid slug', { status: 401 })\n  }\n\n  // Enable Draft Mode by setting the cookie\n  const draft = await draftMode()\n  draft.enable()\n\n  // Redirect to the path from the fetched post\n  // We don't redirect to searchParams.slug as that might lead to open redirect vulnerabilities\n  redirect(post.slug)\n}"
  },
  {
    "id": "draft-mode.mdx#6",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with App Router here."
    },
    "content": "```\n\n```js filename=\"app/api/draft/route.js\" switcher\nimport { draftMode } from 'next/headers'\nimport { redirect } from 'next/navigation'\n\nexport async function GET(request) {\n  // Parse query string parameters\n  const { searchParams } = new URL(request.url)\n  const secret = searchParams.get('secret')\n  const slug = searchParams.get('slug')\n\n  // Check the secret and next parameters\n  // This secret should only be known to this Route Handler and the CMS\n  if (secret !== 'MY_SECRET_TOKEN' || !slug) {\n    return new Response('Invalid token', { status: 401 })\n  }\n\n  // Fetch the headless CMS to check if the provided `slug` exists\n  // getPostBySlug would implement the required fetching logic to the headless CMS\n  const post = await getPostBySlug(slug)\n\n  // If the slug doesn't exist prevent draft mode from being enabled\n  if (!post) {\n    return new Response('Invalid slug', { status: 401 })\n  }\n\n  // Enable Draft Mode by setting the cookie\n  const draft = await draftMode()\n  draft.enable()\n\n  // Redirect to the path from the fetched post\n  // We don't redirect to searchParams.slug as that might lead to open redirect vulnerabilities\n  redirect(post.slug)\n}"
  },
  {
    "id": "draft-mode.mdx#7",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with App Router here."
    },
    "content": "```\n\nIf it succeeds, then the browser will be redirected to the path you want to view with the draft mode cookie."
  },
  {
    "id": "draft-mode.mdx#8",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with App Router here."
    },
    "content": "## Step 3: Preview the Draft Content\n\nThe next step is to update your page to check the value of `draftMode().isEnabled`.\n\nIf you request a page which has the cookie set, then data will be fetched at **request time** (instead of at build time).\n\nFurthermore, the value of `isEnabled` will be `true`.\n\n```tsx filename=\"app/page.tsx\" switcher\n// page that fetches data\nimport { draftMode } from 'next/headers'\n\nasync function getData() {\n  const { isEnabled } = await draftMode()\n\n  const url = isEnabled\n    ? 'https://draft.example.com'\n    : 'https://production.example.com'\n\n  const res = await fetch(url)\n\n  return res.json()\n}\n\nexport default async function Page() {\n  const { title, desc } = await getData()\n\n  return (\n    <main>\n      <h1>{title}</h1>\n      <p>{desc}</p>\n    </main>\n  )\n}"
  },
  {
    "id": "draft-mode.mdx#9",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with App Router here."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\n// page that fetches data\nimport { draftMode } from 'next/headers'\n\nasync function getData() {\n  const { isEnabled } = await draftMode()\n\n  const url = isEnabled\n    ? 'https://draft.example.com'\n    : 'https://production.example.com'\n\n  const res = await fetch(url)\n\n  return res.json()\n}\n\nexport default async function Page() {\n  const { title, desc } = await getData()\n\n  return (\n    <main>\n      <h1>{title}</h1>\n      <p>{desc}</p>\n    </main>\n  )\n}\n```\n\nIf you access the draft Route Handler (with `secret` and `slug`) from your headless CMS or manually using the URL, you should now be able to see the draft content. And, if you update your draft without publishing, you should be able to view the draft."
  },
  {
    "id": "environment-variables.mdx#0",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "---\ntitle: How to use environment variables in Next.js\nnav_title: Environment Variables\ndescription: Learn to add and access environment variables in your Next.js application.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js comes with built-in support for environment variables, which allows you to do the following:\n\n- [Use `.env` to load environment variables](#loading-environment-variables)\n- [Bundle environment variables for the browser by prefixing with `NEXT_PUBLIC_`](#bundling-environment-variables-for-the-browser)\n\n> **Warning:** The default `create-next-app` template ensures all `.env` files are added to your `.gitignore`. You almost never want to commit these files to your repository."
  },
  {
    "id": "environment-variables.mdx#1",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "## Loading Environment Variables\n\nNext.js has built-in support for loading environment variables from `.env*` files into `process.env`.\n\n```txt filename=\".env\"\nDB_HOST=localhost\nDB_USER=myuser\nDB_PASS=mypassword\n```\n\n<PagesOnly>\n\nThis loads `process.env.DB_HOST`, `process.env.DB_USER`, and `process.env.DB_PASS` into the Node.js environment automatically allowing you to use them in [Next.js data fetching methods](/docs/pages/building-your-application/data-fetching) and [API routes](/docs/pages/building-your-application/routing/api-routes).\n\nFor example, using [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props):\n\n```js filename=\"pages/index.js\"\nexport async function getStaticProps() {\n  const db = await myDB.connect({\n    host: process.env.DB_HOST,\n    username: process.env.DB_USER,\n    password: process.env.DB_PASS,\n  })\n  // ...\n}"
  },
  {
    "id": "environment-variables.mdx#2",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "```\n\n</PagesOnly>\n\n<AppOnly>\n\n> **Note**: Next.js also supports multiline variables inside of your `.env*` files:\n>\n> ```bash\n> # .env\n>\n> # you can write with line breaks\n> PRIVATE_KEY=\"-----BEGIN RSA PRIVATE KEY-----\n> ...\n> Kh9NV...\n> ...\n> -----END DSA PRIVATE KEY-----\"\n>\n> # or with `\\n` inside double quotes\n> PRIVATE_KEY=\"-----BEGIN RSA PRIVATE KEY-----\\nKh9NV...\\n-----END DSA PRIVATE KEY-----\\n\"\n> ```\n\n> **Note**: If you are using a `/src` folder, please note that Next.js will load the .env files **only** from the parent folder and **not** from the `/src` folder.\n> This loads `process.env.DB_HOST`, `process.env.DB_USER`, and `process.env.DB_PASS` into the Node.js environment automatically allowing you to use them in [Route Handlers](/docs/app/api-reference/file-conventions/route).\n\nFor example:\n\n```js filename=\"app/api/route.js\"\nexport async function GET() {\n  const db = await myDB.connect({\n    host: process.env.DB_HOST,\n    username: process.env.DB_USER,\n    password: process.env.DB_PASS,\n  })\n  // ...\n}\n```\n\n</AppOnly>"
  },
  {
    "id": "environment-variables.mdx#3",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "### Loading Environment Variables with `@next/env`\n\nIf you need to load environment variables outside of the Next.js runtime, such as in a root config file for an ORM or test runner, you can use the `@next/env` package.\n\nThis package is used internally by Next.js to load environment variables from `.env*` files.\n\nTo use it, install the package and use the `loadEnvConfig` function to load the environment variables:\n\n```bash\nnpm install @next/env\n```\n\n```tsx filename=\"envConfig.ts\" switcher\nimport { loadEnvConfig } from '@next/env'\n\nconst projectDir = process.cwd()\nloadEnvConfig(projectDir)\n```\n\n```jsx filename=\"envConfig.js\" switcher\nimport { loadEnvConfig } from '@next/env'\n\nconst projectDir = process.cwd()\nloadEnvConfig(projectDir)\n```\n\nThen, you can import the configuration where needed. For example:\n\n```tsx filename=\"orm.config.ts\" switcher\nimport './envConfig.ts'\n\nexport default defineConfig({\n  dbCredentials: {\n    connectionString: process.env.DATABASE_URL!,\n  },\n})\n```\n\n```jsx filename=\"orm.config.js\" switcher\nimport './envConfig.js'\n\nexport default defineConfig({\n  dbCredentials: {\n    connectionString: process.env.DATABASE_URL,\n  },\n})\n```"
  },
  {
    "id": "environment-variables.mdx#4",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "### Referencing Other Variables\n\nNext.js will automatically expand variables that use `$` to reference other variables e.g. `$VARIABLE` inside of your `.env*` files. This allows you to reference other secrets. For example:\n\n```txt filename=\".env\"\nTWITTER_USER=nextjs\nTWITTER_URL=https://x.com/$TWITTER_USER\n```\n\nIn the above example, `process.env.TWITTER_URL` would be set to `https://x.com/nextjs`.\n\n> **Good to know**: If you need to use variable with a `$` in the actual value, it needs to be escaped e.g. `\\$`."
  },
  {
    "id": "environment-variables.mdx#5",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "## Bundling Environment Variables for the Browser\n\nNon-`NEXT_PUBLIC_` environment variables are only available in the Node.js environment, meaning they aren't accessible to the browser (the client runs in a different _environment_).\n\nIn order to make the value of an environment variable accessible in the browser, Next.js can \"inline\" a value, at build time, into the js bundle that is delivered to the client, replacing all references to `process.env.[variable]` with a hard-coded value. To tell it to do this, you just have to prefix the variable with `NEXT_PUBLIC_`. For example:\n\n```txt filename=\"Terminal\"\nNEXT_PUBLIC_ANALYTICS_ID=abcdefghijk"
  },
  {
    "id": "environment-variables.mdx#6",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "```\n\nThis will tell Next.js to replace all references to `process.env.NEXT_PUBLIC_ANALYTICS_ID` in the Node.js environment with the value from the environment in which you run `next build`, allowing you to use it anywhere in your code. It will be inlined into any JavaScript sent to the browser.\n\n> **Note**: After being built, your app will no longer respond to changes to these environment variables. For instance, if you use a Heroku pipeline to promote slugs built in one environment to another environment, or if you build and deploy a single Docker image to multiple environments, all `NEXT_PUBLIC_` variables will be frozen with the value evaluated at build time, so these values need to be set appropriately when the project is built. If you need access to runtime environment values, you'll have to setup your own API to provide them to the client (either on demand or during initialization).\n\n```js filename=\"pages/index.js\"\nimport setupAnalyticsService from '../lib/my-analytics-service'"
  },
  {
    "id": "environment-variables.mdx#7",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "```js filename=\"pages/index.js\"\nimport setupAnalyticsService from '../lib/my-analytics-service'\n\n// 'NEXT_PUBLIC_ANALYTICS_ID' can be used here as it's prefixed by 'NEXT_PUBLIC_'.\n// It will be transformed at build time to `setupAnalyticsService('abcdefghijk')`.\nsetupAnalyticsService(process.env.NEXT_PUBLIC_ANALYTICS_ID)\n\nfunction HomePage() {\n  return <h1>Hello World</h1>\n}\n\nexport default HomePage"
  },
  {
    "id": "environment-variables.mdx#8",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "```\n\nNote that dynamic lookups will _not_ be inlined, such as:\n\n```js\n// This will NOT be inlined, because it uses a variable\nconst varName = 'NEXT_PUBLIC_ANALYTICS_ID'\nsetupAnalyticsService(process.env[varName])\n\n// This will NOT be inlined, because it uses a variable\nconst env = process.env\nsetupAnalyticsService(env.NEXT_PUBLIC_ANALYTICS_ID)\n```"
  },
  {
    "id": "environment-variables.mdx#9",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "### Runtime Environment Variables\n\nNext.js can support both build time and runtime environment variables.\n\n**By default, environment variables are only available on the server**. To expose an environment variable to the browser, it must be prefixed with `NEXT_PUBLIC_`. However, these public environment variables will be inlined into the JavaScript bundle during `next build`.\n\n<PagesOnly>\n\nTo read runtime environment variables, we recommend using `getServerSideProps` or [incrementally adopting the App Router](/docs/app/guides/migrating/app-router-migration).\n\n</PagesOnly>\n\n<AppOnly>\n\nYou can safely read environment variables on the server during dynamic rendering:\n\n```tsx filename=\"app/page.ts\" switcher\nimport { connection } from 'next/server'\n\nexport default async function Component() {\n  await connection()\n  // cookies, headers, and other Dynamic APIs\n  // will also opt into dynamic rendering, meaning\n  // this env variable is evaluated at runtime\n  const value = process.env.MY_VALUE\n  // ...\n}"
  },
  {
    "id": "environment-variables.mdx#10",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nimport { connection } from 'next/server'\n\nexport default async function Component() {\n  await connection()\n  // cookies, headers, and other Dynamic APIs\n  // will also opt into dynamic rendering, meaning\n  // this env variable is evaluated at runtime\n  const value = process.env.MY_VALUE\n  // ...\n}\n```\n\n</AppOnly>\n\nThis allows you to use a singular Docker image that can be promoted through multiple environments with different values.\n\n**Good to know:**\n\n- You can run code on server startup using the [`register` function](/docs/app/guides/instrumentation)."
  },
  {
    "id": "environment-variables.mdx#11",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "## Test Environment Variables\n\nApart from `development` and `production` environments, there is a 3rd option available: `test`. In the same way you can set defaults for development or production environments, you can do the same with a `.env.test` file for the `testing` environment (though this one is not as common as the previous two). Next.js will not load environment variables from `.env.development` or `.env.production` in the `testing` environment.\n\nThis one is useful when running tests with tools like `jest` or `cypress` where you need to set specific environment vars only for testing purposes. Test default values will be loaded if `NODE_ENV` is set to `test`, though you usually don't need to do this manually as testing tools will address it for you.\n\nThere is a small difference between `test` environment, and both `development` and `production` that you need to bear in mind: `.env.local` won't be loaded, as you expect tests to produce the same results for everyone. This way every test execution will use the same env defaults across different executions by ignoring your `.env.local` (which is intended to override the default set)."
  },
  {
    "id": "environment-variables.mdx#12",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "> **Good to know**: similar to Default Environment Variables, `.env.test` file should be included in your repository, but `.env.test.local` shouldn't, as `.env*.local` are intended to be ignored through `.gitignore`.\n\nWhile running unit tests you can make sure to load your environment variables the same way Next.js does by leveraging the `loadEnvConfig` function from the `@next/env` package.\n\n```js\n// The below can be used in a Jest global setup file or similar for your testing set-up\nimport { loadEnvConfig } from '@next/env'\n\nexport default async () => {\n  const projectDir = process.cwd()\n  loadEnvConfig(projectDir)\n}\n```"
  },
  {
    "id": "environment-variables.mdx#13",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "## Environment Variable Load Order\n\nEnvironment variables are looked up in the following places, in order, stopping once the variable is found.\n\n1. `process.env`\n1. `.env.$(NODE_ENV).local`\n1. `.env.local` (Not checked when `NODE_ENV` is `test`.)\n1. `.env.$(NODE_ENV)`\n1. `.env`\n\nFor example, if `NODE_ENV` is `development` and you define a variable in both `.env.development.local` and `.env`, the value in `.env.development.local` will be used.\n\n> **Good to know**: The allowed values for `NODE_ENV` are `production`, `development` and `test`.\n\n## Good to know\n\n- If you are using a [`/src` directory](/docs/app/api-reference/file-conventions/src-folder), `.env.*` files should remain in the root of your project.\n- If the environment variable `NODE_ENV` is unassigned, Next.js automatically assigns `development` when running the `next dev` command, or `production` for all other commands.\n\n## Version History\n\n| Version  | Changes                                       |\n| -------- | --------------------------------------------- |\n| `v9.4.0` | Support `.env` and `NEXT_PUBLIC_` introduced. |"
  },
  {
    "id": "forms.mdx#0",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "---\ntitle: How to create forms with Server Actions\nnav_title: Forms\ndescription: Learn how to create forms in Next.js with React Server Actions.\n---\n\nReact Server Actions are [Server Functions](https://react.dev/reference/rsc/server-functions) that execute on the server. They can be called in Server and Client Components to handle form submissions. This guide will walk you through how to create forms in Next.js with Server Actions."
  },
  {
    "id": "forms.mdx#1",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "## How it works\n\nReact extends the HTML [`<form>`](https://developer.mozilla.org/docs/Web/HTML/Element/form) element to allow Server Actions to be invoked with the [`action`](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/form#action) attribute.\n\nWhen used in a form, the function automatically receives the [`FormData`](https://developer.mozilla.org/docs/Web/API/FormData/FormData) object. You can then extract the data using the native [`FormData` methods](https://developer.mozilla.org/en-US/docs/Web/API/FormData#instance_methods):\n\n```tsx filename=\"app/invoices/page.tsx\" switcher\nexport default function Page() {\n  async function createInvoice(formData: FormData) {\n    'use server'\n\n    const rawFormData = {\n      customerId: formData.get('customerId'),\n      amount: formData.get('amount'),\n      status: formData.get('status'),\n    }\n\n    // mutate data\n    // revalidate the cache\n  }\n\n  return <form action={createInvoice}>...</form>\n}"
  },
  {
    "id": "forms.mdx#2",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "```\n\n```jsx filename=\"app/invoices/page.js\" switcher\nexport default function Page() {\n  async function createInvoice(formData) {\n    'use server'\n\n    const rawFormData = {\n      customerId: formData.get('customerId'),\n      amount: formData.get('amount'),\n      status: formData.get('status'),\n    }\n\n    // mutate data\n    // revalidate the cache\n  }\n\n  return <form action={createInvoice}>...</form>\n}\n```\n\n> **Good to know:** When working with forms that have multiple fields, use JavaScript's [`Object.fromEntries()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries). For example: `const rawFormData = Object.fromEntries(formData)`. Note that this object will contain extra properties prefixed with `$ACTION_`."
  },
  {
    "id": "forms.mdx#3",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "## Passing additional arguments\n\nOutside of form fields, you can pass additional arguments to a Server Function using the JavaScript [`bind`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind) method. For example, to pass the `userId` argument to the `updateUser` Server Function:\n\n```tsx filename=\"app/client-component.tsx\" highlight={6} switcher\n'use client'\n\nimport { updateUser } from './actions'\n\nexport function UserProfile({ userId }: { userId: string }) {\n  const updateUserWithId = updateUser.bind(null, userId)\n\n  return (\n    <form action={updateUserWithId}>\n      <input type=\"text\" name=\"name\" />\n      <button type=\"submit\">Update User Name</button>\n    </form>\n  )\n}\n```\n\n```jsx filename=\"app/client-component.js\" highlight={6} switcher\n'use client'\n\nimport { updateUser } from './actions'\n\nexport function UserProfile({ userId }) {\n  const updateUserWithId = updateUser.bind(null, userId)\n\n  return (\n    <form action={updateUserWithId}>\n      <input type=\"text\" name=\"name\" />\n      <button type=\"submit\">Update User Name</button>\n    </form>\n  )\n}"
  },
  {
    "id": "forms.mdx#4",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "```\n\nThe Server Function will receive the `userId` as an additional argument:\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nexport async function updateUser(userId: string, formData: FormData) {}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nexport async function updateUser(userId, formData) {}\n```\n\n> **Good to know**:\n>\n> - An alternative is to pass arguments as hidden input fields in the form (e.g. `<input type=\"hidden\" name=\"userId\" value={userId} />`). However, the value will be part of the rendered HTML and will not be encoded.\n> - `bind` works in both Server and Client Components and supports progressive enhancement."
  },
  {
    "id": "forms.mdx#5",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "## Form validation\n\nForms can be validated on the client or server.\n\n- For **client-side validation**, you can use the HTML attributes like `required` and `type=\"email\"` for basic validation.\n- For **server-side validation**, you can use a library like [zod](https://zod.dev/) to validate the form fields. For example:\n\n```tsx filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { z } from 'zod'\n\nconst schema = z.object({\n  email: z.string({\n    invalid_type_error: 'Invalid Email',\n  }),\n})\n\nexport default async function createUser(formData: FormData) {\n  const validatedFields = schema.safeParse({\n    email: formData.get('email'),\n  })\n\n  // Return early if the form data is invalid\n  if (!validatedFields.success) {\n    return {\n      errors: validatedFields.error.flatten().fieldErrors,\n    }\n  }\n\n  // Mutate data\n}"
  },
  {
    "id": "forms.mdx#6",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "```\n\n```jsx filename=\"app/actions.js\" switcher\n'use server'\n\nimport { z } from 'zod'\n\nconst schema = z.object({\n  email: z.string({\n    invalid_type_error: 'Invalid Email',\n  }),\n})\n\nexport default async function createsUser(formData) {\n  const validatedFields = schema.safeParse({\n    email: formData.get('email'),\n  })\n\n  // Return early if the form data is invalid\n  if (!validatedFields.success) {\n    return {\n      errors: validatedFields.error.flatten().fieldErrors,\n    }\n  }\n\n  // Mutate data\n}\n```"
  },
  {
    "id": "forms.mdx#7",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "## Validation errors\n\nTo display validation errors or messages, turn the component that defines the `<form>` into a Client Component and use React [`useActionState`](https://react.dev/reference/react/useActionState).\n\nWhen using `useActionState`, the Server function signature will change to receive a new `prevState` or `initialState` parameter as its first argument.\n\n```tsx filename=\"app/actions.ts\" highlight={4} switcher\n'use server'\n\nimport { z } from 'zod'\n\nexport async function createUser(initialState: any, formData: FormData) {\n  const validatedFields = schema.safeParse({\n    email: formData.get('email'),\n  })\n  // ...\n}\n```\n\n```jsx filename=\"app/actions.ts\" highlight={4} switcher\n'use server'\n\nimport { z } from 'zod'\n\n// ...\n\nexport async function createUser(initialState, formData) {\n  const validatedFields = schema.safeParse({\n    email: formData.get('email'),\n  })\n  // ...\n}"
  },
  {
    "id": "forms.mdx#8",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "```\n\nYou can then conditionally render the error message based on the `state` object.\n\n```tsx filename=\"app/ui/signup.tsx\" highlight={11,18-20} switcher\n'use client'\n\nimport { useActionState } from 'react'\nimport { createUser } from '@/app/actions'\n\nconst initialState = {\n  message: '',\n}\n\nexport function Signup() {\n  const [state, formAction, pending] = useActionState(createUser, initialState)\n\n  return (\n    <form action={formAction}>\n      <label htmlFor=\"email\">Email</label>\n      <input type=\"text\" id=\"email\" name=\"email\" required />\n      {/* ... */}\n      <p aria-live=\"polite\">{state?.message}</p>\n      <button disabled={pending}>Sign up</button>\n    </form>\n  )\n}"
  },
  {
    "id": "forms.mdx#9",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "```\n\n```jsx filename=\"app/ui/signup.js\" highlight={11,18-20} switcher\n'use client'\n\nimport { useActionState } from 'react'\nimport { createUser } from '@/app/actions'\n\nconst initialState = {\n  message: '',\n}\n\nexport function Signup() {\n  const [state, formAction, pending] = useActionState(createUser, initialState)\n\n  return (\n    <form action={formAction}>\n      <label htmlFor=\"email\">Email</label>\n      <input type=\"text\" id=\"email\" name=\"email\" required />\n      {/* ... */}\n      <p aria-live=\"polite\">{state?.message}</p>\n      <button disabled={pending}>Sign up</button>\n    </form>\n  )\n}\n```"
  },
  {
    "id": "forms.mdx#10",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "## Pending states\n\nThe [`useActionState`](https://react.dev/reference/react/useActionState) hook exposes a `pending` boolean that can be used to show a loading indicator or disable the submit button while the action is being executed.\n\n```tsx filename=\"app/ui/signup.tsx\" highlight={7,12} switcher\n'use client'\n\nimport { useActionState } from 'react'\nimport { createUser } from '@/app/actions'\n\nexport function Signup() {\n  const [state, formAction, pending] = useActionState(createUser, initialState)\n\n  return (\n    <form action={formAction}>\n      {/* Other form elements */}\n      <button disabled={pending}>Sign up</button>\n    </form>\n  )\n}\n```\n\n```jsx filename=\"app/ui/signup.js\" highlight={7,12} switcher\n'use client'\n\nimport { useActionState } from 'react'\nimport { createUser } from '@/app/actions'\n\nexport function Signup() {\n  const [state, formAction, pending] = useActionState(createUser, initialState)\n\n  return (\n    <form action={formAction}>\n      {/* Other form elements */}\n      <button disabled={pending}>Sign up</button>\n    </form>\n  )\n}"
  },
  {
    "id": "forms.mdx#11",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "```\n\nAlternatively, you can use the [`useFormStatus`](https://react.dev/reference/react-dom/hooks/useFormStatus) hook to show a loading indicator while the action is being executed. When using this hook, you'll need to create a separate component to render the loading indicator. For example, to disable the button when the action is pending:\n\n```tsx filename=\"app/ui/button.tsx\" highlight={6} switcher\n'use client'\n\nimport { useFormStatus } from 'react-dom'\n\nexport function SubmitButton() {\n  const { pending } = useFormStatus()\n\n  return (\n    <button disabled={pending} type=\"submit\">\n      Sign Up\n    </button>\n  )\n}\n```\n\n```jsx filename=\"app/ui/button.js\" highlight={6} switcher\n'use client'\n\nimport { useFormStatus } from 'react-dom'\n\nexport function SubmitButton() {\n  const { pending } = useFormStatus()\n\n  return (\n    <button disabled={pending} type=\"submit\">\n      Sign Up\n    </button>\n  )\n}"
  },
  {
    "id": "forms.mdx#12",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "```\n\nYou can then nest the `SubmitButton` component inside the form:\n\n```tsx filename=\"app/ui/signup.tsx\" switcher\nimport { SubmitButton } from './button'\nimport { createUser } from '@/app/actions'\n\nexport function Signup() {\n  return (\n    <form action={createUser}>\n      {/* Other form elements */}\n      <SubmitButton />\n    </form>\n  )\n}\n```\n\n```jsx filename=\"app/ui/signup.js\" switcher\nimport { SubmitButton } from './button'\nimport { createUser } from '@/app/actions'\n\nexport function Signup() {\n  return (\n    <form action={createUser}>\n      {/* Other form elements */}\n      <SubmitButton />\n    </form>\n  )\n}\n```\n\n> **Good to know:** In React 19, `useFormStatus` includes additional keys on the returned object, like data, method, and action. If you are not using React 19, only the `pending` key is available."
  },
  {
    "id": "forms.mdx#13",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "## Optimistic updates\n\nYou can use the React [`useOptimistic`](https://react.dev/reference/react/useOptimistic) hook to optimistically update the UI before the Server Function finishes executing, rather than waiting for the response:\n\n```tsx filename=\"app/page.tsx\" switcher\n'use client'\n\nimport { useOptimistic } from 'react'\nimport { send } from './actions'\n\ntype Message = {\n  message: string\n}\n\nexport function Thread({ messages }: { messages: Message[] }) {\n  const [optimisticMessages, addOptimisticMessage] = useOptimistic<\n    Message[],\n    string\n  >(messages, (state, newMessage) => [...state, { message: newMessage }])\n\n  const formAction = async (formData: FormData) => {\n    const message = formData.get('message') as string\n    addOptimisticMessage(message)\n    await send(message)\n  }\n\n  return (\n    <div>\n      {optimisticMessages.map((m, i) => (\n        <div key={i}>{m.message}</div>\n      ))}\n      <form action={formAction}>\n        <input type=\"text\" name=\"message\" />\n        <button type=\"submit\">Send</button>\n      </form>\n    </div>\n  )\n}"
  },
  {
    "id": "forms.mdx#14",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\n'use client'\n\nimport { useOptimistic } from 'react'\nimport { send } from './actions'\n\nexport function Thread({ messages }) {\n  const [optimisticMessages, addOptimisticMessage] = useOptimistic(\n    messages,\n    (state, newMessage) => [...state, { message: newMessage }]\n  )\n\n  const formAction = async (formData) => {\n    const message = formData.get('message')\n    addOptimisticMessage(message)\n    await send(message)\n  }\n\n  return (\n    <div>\n      {optimisticMessages.map((m) => (\n        <div>{m.message}</div>\n      ))}\n      <form action={formAction}>\n        <input type=\"text\" name=\"message\" />\n        <button type=\"submit\">Send</button>\n      </form>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "forms.mdx#15",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "## Nested form elements\n\nYou can call Server Actions in elements nested inside `<form>` such as `<button>`, `<input type=\"submit\">`, and `<input type=\"image\">`. These elements accept the `formAction` prop or event handlers.\n\nThis is useful in cases where you want to call multiple Server Actions within a form. For example, you can create a specific `<button>` element for saving a post draft in addition to publishing it. See the [React `<form>` docs](https://react.dev/reference/react-dom/components/form#handling-multiple-submission-types) for more information."
  },
  {
    "id": "forms.mdx#16",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "## Programmatic form submission\n\nYou can trigger a form submission programmatically using the [`requestSubmit()`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/requestSubmit) method. For example, when the user submits a form using the `⌘` + `Enter` keyboard shortcut, you can listen for the `onKeyDown` event:\n\n```tsx filename=\"app/entry.tsx\" switcher\n'use client'\n\nexport function Entry() {\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (\n      (e.ctrlKey || e.metaKey) &&\n      (e.key === 'Enter' || e.key === 'NumpadEnter')\n    ) {\n      e.preventDefault()\n      e.currentTarget.form?.requestSubmit()\n    }\n  }\n\n  return (\n    <div>\n      <textarea name=\"entry\" rows={20} required onKeyDown={handleKeyDown} />\n    </div>\n  )\n}"
  },
  {
    "id": "forms.mdx#17",
    "metadata": {
      "title": "How to create forms with Server Actions",
      "description": "Learn how to create forms in Next.js with React Server Actions."
    },
    "content": "```\n\n```jsx filename=\"app/entry.js\" switcher\n'use client'\n\nexport function Entry() {\n  const handleKeyDown = (e) => {\n    if (\n      (e.ctrlKey || e.metaKey) &&\n      (e.key === 'Enter' || e.key === 'NumpadEnter')\n    ) {\n      e.preventDefault()\n      e.currentTarget.form?.requestSubmit()\n    }\n  }\n\n  return (\n    <div>\n      <textarea name=\"entry\" rows={20} required onKeyDown={handleKeyDown} />\n    </div>\n  )\n}\n```\n\nThis will trigger the submission of the nearest `<form>` ancestor, which will invoke the Server Function."
  },
  {
    "id": "incremental-static-regeneration.mdx#0",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "---\ntitle: How to implement Incremental Static Regeneration (ISR)\nnav_title: ISR\ndescription: Learn how to create or update static pages at runtime with Incremental Static Regeneration.\n---\n\n<details>\n  <summary>Examples</summary>\n\n- [Next.js Commerce](https://vercel.com/templates/next.js/nextjs-commerce)\n- [On-Demand ISR](https://on-demand-isr.vercel.app)\n- [Next.js Forms](https://github.com/vercel/next.js/tree/canary/examples/next-forms)\n\n</details>\n\nIncremental Static Regeneration (ISR) enables you to:\n\n- Update static content without rebuilding the entire site\n- Reduce server load by serving prerendered, static pages for most requests\n- Ensure proper `cache-control` headers are automatically added to pages\n- Handle large amounts of content pages without long `next build` times\n\nHere's a minimal example:\n\n<AppOnly>\n\n```tsx filename=\"app/blog/[id]/page.tsx\" switcher\ninterface Post {\n  id: string\n  title: string\n  content: string\n}\n\n// Next.js will invalidate the cache when a\n// request comes in, at most once every 60 seconds.\nexport const revalidate = 60"
  },
  {
    "id": "incremental-static-regeneration.mdx#1",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "// Next.js will invalidate the cache when a\n// request comes in, at most once every 60 seconds.\nexport const revalidate = 60\n\nexport async function generateStaticParams() {\n  const posts: Post[] = await fetch('https://api.vercel.app/blog').then((res) =>\n    res.json()\n  )\n  return posts.map((post) => ({\n    id: String(post.id),\n  }))\n}\n\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n  const post: Post = await fetch(`https://api.vercel.app/blog/${id}`).then(\n    (res) => res.json()\n  )\n  return (\n    <main>\n      <h1>{post.title}</h1>\n      <p>{post.content}</p>\n    </main>\n  )\n}"
  },
  {
    "id": "incremental-static-regeneration.mdx#2",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "```\n\n```jsx filename=\"app/blog/[id]/page.jsx\" switcher\n// Next.js will invalidate the cache when a\n// request comes in, at most once every 60 seconds.\nexport const revalidate = 60\n\nexport async function generateStaticParams() {\n  const posts = await fetch('https://api.vercel.app/blog').then((res) =>\n    res.json()\n  )\n  return posts.map((post) => ({\n    id: String(post.id),\n  }))\n}\n\nexport default async function Page({ params }) {\n  const { id } = await params\n  const post = await fetch(`https://api.vercel.app/blog/${id}`).then((res) =>\n    res.json()\n  )\n  return (\n    <main>\n      <h1>{post.title}</h1>\n      <p>{post.content}</p>\n    </main>\n  )\n}"
  },
  {
    "id": "incremental-static-regeneration.mdx#3",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "```\n\nHere's how this example works:\n\n1. During `next build`, all known blog posts are generated\n2. All requests made to these pages (e.g. `/blog/1`) are cached and instantaneous\n3. After 60 seconds has passed, the next request will still return the cached (now stale) page\n4. The cache is invalidated and a new version of the page begins generating in the background\n5. Once generated successfully, the next request will return the updated page and cache it for subsequent requests\n6. If `/blog/26` is requested, and it exists, the page will be generated on-demand. This behavior can be changed by using a different [dynamicParams](/docs/app/api-reference/file-conventions/route-segment-config#dynamicparams) value. However, if the post does not exist, then 404 is returned.\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/blog/[id].tsx\" switcher\nimport type { GetStaticPaths, GetStaticProps } from 'next'\n\ninterface Post {\n  id: string\n  title: string\n  content: string\n}\n\ninterface Props {\n  post: Post\n}"
  },
  {
    "id": "incremental-static-regeneration.mdx#4",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "interface Post {\n  id: string\n  title: string\n  content: string\n}\n\ninterface Props {\n  post: Post\n}\n\nexport const getStaticPaths: GetStaticPaths = async () => {\n  const posts = await fetch('https://api.vercel.app/blog').then((res) =>\n    res.json()\n  )\n  const paths = posts.map((post: Post) => ({\n    params: { id: String(post.id) },\n  }))\n\n  return { paths, fallback: 'blocking' }\n}\n\nexport const getStaticProps: GetStaticProps<Props> = async ({\n  params,\n}: {\n  params: { id: string }\n}) => {\n  const post = await fetch(`https://api.vercel.app/blog/${params.id}`).then(\n    (res) => res.json()\n  )\n\n  return {\n    props: { post },\n    // Next.js will invalidate the cache when a\n    // request comes in, at most once every 60 seconds.\n    revalidate: 60,\n  }\n}\n\nexport default function Page({ post }: Props) {\n  return (\n    <main>\n      <h1>{post.title}</h1>\n      <p>{post.content}</p>\n    </main>\n  )\n}"
  },
  {
    "id": "incremental-static-regeneration.mdx#5",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "```\n\n```jsx filename=\"pages/blog/[id].jsx\" switcher\nexport async function getStaticPaths() {\n  const posts = await fetch('https://api.vercel.app/blog').then((res) =>\n    res.json()\n  )\n  const paths = posts.map((post) => ({\n    params: { id: post.id },\n  }))\n\n  return { paths, fallback: 'blocking' }\n}\n\nexport async function getStaticProps({ params }) {\n  const post = await fetch(`https://api.vercel.app/blog/${params.id}`).then(\n    (res) => res.json()\n  )\n\n  return {\n    props: { post },\n    // Next.js will invalidate the cache when a\n    // request comes in, at most once every 60 seconds.\n    revalidate: 60,\n  }\n}\n\nexport default function Page({ post }) {\n  return (\n    <main>\n      <h1>{post.title}</h1>\n      <p>{post.content}</p>\n    </main>\n  )\n}"
  },
  {
    "id": "incremental-static-regeneration.mdx#6",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "```\n\nHere's how this example works:\n\n1. During `next build`, all known blog posts are generated\n2. All requests made to these pages (e.g. `/blog/1`) are cached and instantaneous\n3. After 60 seconds has passed, the next request will still return the cached (now stale) page\n4. The cache is invalidated and a new version of the page begins generating in the background\n5. Once generated successfully, the next request will return the updated page and cache it for subsequent requests\n6. If `/blog/26` is requested, and it exists, the page will be generated on-demand. This behavior can be changed by using a different [fallback](/docs/pages/api-reference/functions/get-static-paths#fallback-false) value. However, if the post does not exist, then 404 is returned.\n\n</PagesOnly>"
  },
  {
    "id": "incremental-static-regeneration.mdx#7",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "## Reference\n\n<AppOnly>\n\n### Route segment config\n\n- [`revalidate`](/docs/app/api-reference/file-conventions/route-segment-config#revalidate)\n- [`dynamicParams`](/docs/app/api-reference/file-conventions/route-segment-config#dynamicparams)\n\n### Functions\n\n- [`revalidatePath`](/docs/app/api-reference/functions/revalidatePath)\n- [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag)\n\n</AppOnly>\n\n<PagesOnly>\n\n### Functions\n\n- [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props)\n- [`res.revalidate`](/docs/pages/building-your-application/routing/api-routes#response-helpers)\n\n</PagesOnly>"
  },
  {
    "id": "incremental-static-regeneration.mdx#8",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "## Examples\n\n<AppOnly>"
  },
  {
    "id": "incremental-static-regeneration.mdx#9",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "### Time-based revalidation\n\nThis fetches and displays a list of blog posts on /blog. After an hour has passed, the next visitor will still receive the cached (stale) version of the page immediately for a fast response. Simultaneously, Next.js triggers regeneration of a fresh version in the background. Once the new version is successfully generated, it replaces the cached version, and subsequent visitors will receive the updated content.\n\n```tsx filename=\"app/blog/page.tsx\" switcher\ninterface Post {\n  id: string\n  title: string\n  content: string\n}\n\nexport const revalidate = 3600 // invalidate every hour\n\nexport default async function Page() {\n  const data = await fetch('https://api.vercel.app/blog')\n  const posts: Post[] = await data.json()\n  return (\n    <main>\n      <h1>Blog Posts</h1>\n      <ul>\n        {posts.map((post) => (\n          <li key={post.id}>{post.title}</li>\n        ))}\n      </ul>\n    </main>\n  )\n}"
  },
  {
    "id": "incremental-static-regeneration.mdx#10",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "```\n\n```jsx filename=\"app/blog/page.js\" switcher\nexport const revalidate = 3600 // invalidate every hour\n\nexport default async function Page() {\n  const data = await fetch('https://api.vercel.app/blog')\n  const posts = await data.json()\n  return (\n    <main>\n      <h1>Blog Posts</h1>\n      <ul>\n        {posts.map((post) => (\n          <li key={post.id}>{post.title}</li>\n        ))}\n      </ul>\n    </main>\n  )\n}\n```\n\nWe recommend setting a high revalidation time. For instance, 1 hour instead of 1 second. If you need more precision, consider using on-demand revalidation. If you need real-time data, consider switching to [dynamic rendering](/docs/app/guides/caching#dynamic-rendering)."
  },
  {
    "id": "incremental-static-regeneration.mdx#11",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "### On-demand revalidation with `revalidatePath`\n\nFor a more precise method of revalidation, invalidate cached pages on-demand with the `revalidatePath` function.\n\nFor example, this Server Action would get called after adding a new post. Regardless of how you retrieve your data in your Server Component, either using `fetch` or connecting to a database, this will invalidate the cache for the entire route. The next request to that route will trigger regeneration and serve fresh data, which will then be cached for subsequent requests.\n\n> **Note:** `revalidatePath` invalidates the cache entries but regeneration happens on the next request. If you want to eagerly regenerate the cache entry immediately instead of waiting for the next request, you can use the Pages router [`res.revalidate`](docs/pages/guides/incremental-static-regeneration#on-demand-validation-with-resrevalidate) method. We're working on adding new methods to provide eager regeneration capabilities for the App Router.\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { revalidatePath } from 'next/cache'"
  },
  {
    "id": "incremental-static-regeneration.mdx#12",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { revalidatePath } from 'next/cache'\n\nexport async function createPost() {\n  // Invalidate the cache for the /posts route\n  revalidatePath('/posts')\n}"
  },
  {
    "id": "incremental-static-regeneration.mdx#13",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { revalidatePath } from 'next/cache'\n\nexport async function createPost() {\n  // Invalidate the cache for the /posts route\n  revalidatePath('/posts')\n}\n```\n\n[View a demo](https://on-demand-isr.vercel.app) and [explore the source code](https://github.com/vercel/on-demand-isr)."
  },
  {
    "id": "incremental-static-regeneration.mdx#14",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "### On-demand revalidation with `revalidateTag`\n\nFor most use cases, prefer revalidating entire paths. If you need more granular control, you can use the `revalidateTag` function. For example, you can tag individual `fetch` calls:\n\n```tsx filename=\"app/blog/page.tsx\" switcher\nexport default async function Page() {\n  const data = await fetch('https://api.vercel.app/blog', {\n    next: { tags: ['posts'] },\n  })\n  const posts = await data.json()\n  // ...\n}\n```\n\n```jsx filename=\"app/blog/page.js\" switcher\nexport default async function Page() {\n  const data = await fetch('https://api.vercel.app/blog', {\n    next: { tags: ['posts'] },\n  })\n  const posts = await data.json()\n  // ...\n}\n```\n\nIf you are using an ORM or connecting to a database, you can use `unstable_cache`:\n\n```tsx filename=\"app/blog/page.tsx\" switcher\nimport { unstable_cache } from 'next/cache'\nimport { db, posts } from '@/lib/db'\n\nconst getCachedPosts = unstable_cache(\n  async () => {\n    return await db.select().from(posts)\n  },\n  ['posts'],\n  { revalidate: 3600, tags: ['posts'] }\n)\n\nexport default async function Page() {\n  const posts = getCachedPosts()\n  // ...\n}"
  },
  {
    "id": "incremental-static-regeneration.mdx#15",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "```\n\n```jsx filename=\"app/blog/page.js\" switcher\nimport { unstable_cache } from 'next/cache'\nimport { db, posts } from '@/lib/db'\n\nconst getCachedPosts = unstable_cache(\n  async () => {\n    return await db.select().from(posts)\n  },\n  ['posts'],\n  { revalidate: 3600, tags: ['posts'] }\n)\n\nexport default async function Page() {\n  const posts = getCachedPosts()\n  // ...\n}\n```\n\nYou can then use `revalidateTag` in a [Server Actions](/docs/app/getting-started/updating-data) or [Route Handler](/docs/app/api-reference/file-conventions/route):\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { revalidateTag } from 'next/cache'\n\nexport async function createPost() {\n  // Invalidate all data tagged with 'posts'\n  revalidateTag('posts')\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { revalidateTag } from 'next/cache'\n\nexport async function createPost() {\n  // Invalidate all data tagged with 'posts'\n  revalidateTag('posts')\n}\n```\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "incremental-static-regeneration.mdx#16",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "### On-demand validation with `res.revalidate()`\n\nFor a more precise method of revalidation, use `res.revalidate` to generate a new page on-demand from an API Router.\n\nFor example, this API Route can be called at `/api/revalidate?secret=<token>` to revalidate a given blog post. Create a secret token only known by your Next.js app. This secret will be used to prevent unauthorized access to the revalidation API Route.\n\n```ts filename=\"pages/api/revalidate.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  // Check for secret to confirm this is a valid request\n  if (req.query.secret !== process.env.MY_SECRET_TOKEN) {\n    return res.status(401).json({ message: 'Invalid token' })\n  }\n\n  try {\n    // This should be the actual path not a rewritten path\n    // e.g. for \"/posts/[id]\" this should be \"/posts/1\"\n    await res.revalidate('/posts/1')\n    return res.json({ revalidated: true })\n  } catch (err) {\n    // If there was an error, Next.js will continue\n    // to show the last successfully generated page\n    return res.status(500).send('Error revalidating')\n  }\n}"
  },
  {
    "id": "incremental-static-regeneration.mdx#17",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "```\n\n```js filename=\"pages/api/revalidate.js\" switcher\nexport default async function handler(req, res) {\n  // Check for secret to confirm this is a valid request\n  if (req.query.secret !== process.env.MY_SECRET_TOKEN) {\n    return res.status(401).json({ message: 'Invalid token' })\n  }\n\n  try {\n    // This should be the actual path not a rewritten path\n    // e.g. for \"/posts/[id]\" this should be \"/posts/1\"\n    await res.revalidate('/posts/1')\n    return res.json({ revalidated: true })\n  } catch (err) {\n    // If there was an error, Next.js will continue\n    // to show the last successfully generated page\n    return res.status(500).send('Error revalidating')\n  }\n}\n```\n\nIf you are using on-demand revalidation, you do not need to specify a `revalidate` time inside of `getStaticProps`. Next.js will use the default value of `false` (no revalidation) and only revalidate the page on-demand when `res.revalidate()` is called.\n\n</PagesOnly>"
  },
  {
    "id": "incremental-static-regeneration.mdx#18",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "### Handling uncaught exceptions\n\n<AppOnly>\n\nIf an error is thrown while attempting to revalidate data, the last successfully generated data will continue to be served from the cache. On the next subsequent request, Next.js will retry revalidating the data. [Learn more about error handling](/docs/app/getting-started/error-handling).\n\n</AppOnly>\n\n<PagesOnly>\n\nIf there is an error inside `getStaticProps` when handling background regeneration, or you manually throw an error, the last successfully generated page will continue to show. On the next subsequent request, Next.js will retry calling `getStaticProps`.\n\n```tsx filename=\"pages/blog/[id].tsx\" switcher\nimport type { GetStaticProps } from 'next'\n\ninterface Post {\n  id: string\n  title: string\n  content: string\n}\n\ninterface Props {\n  post: Post\n}\n\nexport const getStaticProps: GetStaticProps<Props> = async ({\n  params,\n}: {\n  params: { id: string }\n}) => {\n  // If this request throws an uncaught error, Next.js will\n  // not invalidate the currently shown page and\n  // retry getStaticProps on the next request.\n  const res = await fetch(`https://api.vercel.app/blog/${params.id}`)\n  const post: Post = await res.json()"
  },
  {
    "id": "incremental-static-regeneration.mdx#19",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "if (!res.ok) {\n    // If there is a server error, you might want to\n    // throw an error instead of returning so that the cache is not updated\n    // until the next successful request.\n    throw new Error(`Failed to fetch posts, received status ${res.status}`)\n  }\n\n  return {\n    props: { post },\n    // Next.js will invalidate the cache when a\n    // request comes in, at most once every 60 seconds.\n    revalidate: 60,\n  }\n}"
  },
  {
    "id": "incremental-static-regeneration.mdx#20",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "```\n\n```jsx filename=\"pages/blog/[id].jsx\" switcher\nexport async function getStaticProps({ params }) {\n  // If this request throws an uncaught error, Next.js will\n  // not invalidate the currently shown page and\n  // retry getStaticProps on the next request.\n  const res = await fetch(`https://api.vercel.app/blog/${params.id}`)\n  const post = await res.json()\n\n  if (!res.ok) {\n    // If there is a server error, you might want to\n    // throw an error instead of returning so that the cache is not updated\n    // until the next successful request.\n    throw new Error(`Failed to fetch posts, received status ${res.status}`)\n  }\n\n  return {\n    props: { post },\n    // Next.js will invalidate the cache when a\n    // request comes in, at most once every 60 seconds.\n    revalidate: 60,\n  }\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "incremental-static-regeneration.mdx#21",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "### Customizing the cache location\n\nYou can configure the Next.js cache location if you want to persist cached pages and data to durable storage, or share the cache across multiple containers or instances of your Next.js application. [Learn more](/docs/app/guides/self-hosting#caching-and-isr)."
  },
  {
    "id": "incremental-static-regeneration.mdx#22",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "## Troubleshooting\n\n### Debugging cached data in local development\n\nIf you are using the `fetch` API, you can add additional logging to understand which requests are cached or uncached. [Learn more about the `logging` option](/docs/app/api-reference/config/next-config-js/logging).\n\n```jsx filename=\"next.config.js\"\nmodule.exports = {\n  logging: {\n    fetches: {\n      fullUrl: true,\n    },\n  },\n}\n```\n\n### Verifying correct production behavior\n\nTo verify your pages are cached and revalidated correctly in production, you can test locally by running `next build` and then `next start` to run the production Next.js server.\n\nThis will allow you to test ISR behavior as it would work in a production environment. For further debugging, add the following environment variable to your `.env` file:\n\n```bash filename=\".env\"\nNEXT_PRIVATE_DEBUG_CACHE=1\n```\n\nThis will make the Next.js server console log ISR cache hits and misses. You can inspect the output to see which pages are generated during `next build`, as well as how pages are updated as paths are accessed on-demand."
  },
  {
    "id": "incremental-static-regeneration.mdx#23",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "## Caveats\n\n<AppOnly>\n\n- ISR is only supported when using the Node.js runtime (default).\n- ISR is not supported when creating a [Static Export](/docs/app/guides/static-exports).\n- If you have multiple `fetch` requests in a statically rendered route, and each has a different `revalidate` frequency, the lowest time will be used for ISR. However, those revalidate frequencies will still be respected by the [Data Cache](/docs/app/guides/caching#data-cache).\n- If any of the `fetch` requests used on a route have a `revalidate` time of `0`, or an explicit `no-store`, the route will be [dynamically rendered](/docs/app/guides/caching#dynamic-rendering).\n- Proxy won't be executed for on-demand ISR requests, meaning any path rewrites or logic in Proxy will not be applied. Ensure you are revalidating the exact path. For example, `/post/1` instead of a rewritten `/post-1`.\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "incremental-static-regeneration.mdx#24",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "</AppOnly>\n\n<PagesOnly>\n\n- ISR is only supported when using the Node.js runtime (default).\n- ISR is not supported when creating a [Static Export](/docs/app/guides/static-exports).\n- Proxy won't be executed for on-demand ISR requests, meaning any path rewrites or logic in Proxy will not be applied. Ensure you are revalidating the exact path. For example, `/post/1` instead of a rewritten `/post-1`.\n\n</PagesOnly>"
  },
  {
    "id": "incremental-static-regeneration.mdx#25",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "## Platform Support\n\n| Deployment Option                                                   | Supported         |\n| ------------------------------------------------------------------- | ----------------- |\n| [Node.js server](/docs/app/getting-started/deploying#nodejs-server) | Yes               |\n| [Docker container](/docs/app/getting-started/deploying#docker)      | Yes               |\n| [Static export](/docs/app/getting-started/deploying#static-export)  | No                |\n| [Adapters](/docs/app/getting-started/deploying#adapters)            | Platform-specific |\n\nLearn how to [configure ISR](/docs/app/guides/self-hosting#caching-and-isr) when self-hosting Next.js."
  },
  {
    "id": "incremental-static-regeneration.mdx#26",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "## Version history\n\n| Version   | Changes                                                                             |\n| --------- | ----------------------------------------------------------------------------------- |\n| `v14.1.0` | Custom `cacheHandler` is stable.                                                    |\n| `v13.0.0` | App Router is introduced.                                                           |\n| `v12.2.0` | Pages Router: On-Demand ISR is stable                                               |\n| `v12.0.0` | Pages Router: [Bot-aware ISR fallback](/blog/next-12#bot-aware-isr-fallback) added. |\n| `v9.5.0`  | Pages Router: [Stable ISR introduced](/blog/next-9-5).                              |"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Guides",
      "description": "Learn how to implement common patterns and real-world use cases using Next.js"
    },
    "content": "---\ntitle: Guides\ndescription: Learn how to implement common patterns and real-world use cases using Next.js\n---"
  },
  {
    "id": "instrumentation.mdx#0",
    "metadata": {
      "title": "How to set up instrumentation",
      "description": "Learn how to use instrumentation to run code at server startup in your Next.js app"
    },
    "content": "---\ntitle: How to set up instrumentation\nnav_title: Instrumentation\ndescription: Learn how to use instrumentation to run code at server startup in your Next.js app\nrelated:\n  title: Learn more about Instrumentation\n  links:\n    - app/api-reference/file-conventions/instrumentation\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nInstrumentation is the process of using code to integrate monitoring and logging tools into your application. This allows you to track the performance and behavior of your application, and to debug issues in production."
  },
  {
    "id": "instrumentation.mdx#1",
    "metadata": {
      "title": "How to set up instrumentation",
      "description": "Learn how to use instrumentation to run code at server startup in your Next.js app"
    },
    "content": "## Convention\n\nTo set up instrumentation, create `instrumentation.ts|js` file in the **root directory** of your project (or inside the [`src`](/docs/app/api-reference/file-conventions/src-folder) folder if using one).\n\nThen, export a `register` function in the file. This function will be called **once** when a new Next.js server instance is initiated.\n\nFor example, to use Next.js with [OpenTelemetry](https://opentelemetry.io/) and [@vercel/otel](https://vercel.com/docs/observability/otel-overview):\n\n```ts filename=\"instrumentation.ts\" switcher\nimport { registerOTel } from '@vercel/otel'\n\nexport function register() {\n  registerOTel('next-app')\n}\n```\n\n```js filename=\"instrumentation.js\" switcher\nimport { registerOTel } from '@vercel/otel'\n\nexport function register() {\n  registerOTel('next-app')\n}"
  },
  {
    "id": "instrumentation.mdx#2",
    "metadata": {
      "title": "How to set up instrumentation",
      "description": "Learn how to use instrumentation to run code at server startup in your Next.js app"
    },
    "content": "```\n\n```js filename=\"instrumentation.js\" switcher\nimport { registerOTel } from '@vercel/otel'\n\nexport function register() {\n  registerOTel('next-app')\n}\n```\n\nSee the [Next.js with OpenTelemetry example](https://github.com/vercel/next.js/tree/canary/examples/with-opentelemetry) for a complete implementation.\n\n> **Good to know**:\n>\n> - The `instrumentation` file should be in the root of your project and not inside the `app` or `pages` directory. If you're using the `src` folder, then place the file inside `src` alongside `pages` and `app`.\n> - If you use the [`pageExtensions` config option](/docs/app/api-reference/config/next-config-js/pageExtensions) to add a suffix, you will also need to update the `instrumentation` filename to match."
  },
  {
    "id": "instrumentation.mdx#3",
    "metadata": {
      "title": "How to set up instrumentation",
      "description": "Learn how to use instrumentation to run code at server startup in your Next.js app"
    },
    "content": "## Examples\n\n### Importing files with side effects\n\nSometimes, it may be useful to import a file in your code because of the side effects it will cause. For example, you might import a file that defines a set of global variables, but never explicitly use the imported file in your code. You would still have access to the global variables the package has declared.\n\nWe recommend importing files using JavaScript `import` syntax within your `register` function. The following example demonstrates a basic usage of `import` in a `register` function:\n\n```ts filename=\"instrumentation.ts\" switcher\nexport async function register() {\n  await import('package-with-side-effect')\n}\n```\n\n```js filename=\"instrumentation.js\" switcher\nexport async function register() {\n  await import('package-with-side-effect')\n}\n```\n\n> **Good to know:**\n>\n> We recommend importing the file from within the `register` function, rather than at the top of the file. By doing this, you can colocate all of your side effects in one place in your code, and avoid any unintended consequences from importing globally at the top of the file."
  },
  {
    "id": "instrumentation.mdx#4",
    "metadata": {
      "title": "How to set up instrumentation",
      "description": "Learn how to use instrumentation to run code at server startup in your Next.js app"
    },
    "content": "### Importing runtime-specific code\n\nNext.js calls `register` in all environments, so it's important to conditionally import any code that doesn't support specific runtimes (e.g. [Edge or Node.js](/docs/app/api-reference/edge)). You can use the `NEXT_RUNTIME` environment variable to get the current environment:\n\n```ts filename=\"instrumentation.ts\" switcher\nexport async function register() {\n  if (process.env.NEXT_RUNTIME === 'nodejs') {\n    await import('./instrumentation-node')\n  }\n\n  if (process.env.NEXT_RUNTIME === 'edge') {\n    await import('./instrumentation-edge')\n  }\n}\n```\n\n```js filename=\"instrumentation.js\" switcher\nexport async function register() {\n  if (process.env.NEXT_RUNTIME === 'nodejs') {\n    await import('./instrumentation-node')\n  }\n\n  if (process.env.NEXT_RUNTIME === 'edge') {\n    await import('./instrumentation-edge')\n  }\n}\n```"
  },
  {
    "id": "internationalization.mdx#0",
    "metadata": {
      "title": "Internationalization",
      "description": "Add support for multiple languages with internationalized routing and localized content."
    },
    "content": "---\ntitle: Internationalization\ndescription: Add support for multiple languages with internationalized routing and localized content.\n---\n\nNext.js enables you to configure the routing and rendering of content to support multiple languages. Making your site adaptive to different locales includes translated content (localization) and internationalized routes.\n\n## Terminology\n\n- **Locale:** An identifier for a set of language and formatting preferences. This usually includes the preferred language of the user and possibly their geographic region.\n  - `en-US`: English as spoken in the United States\n  - `nl-NL`: Dutch as spoken in the Netherlands\n  - `nl`: Dutch, no specific region"
  },
  {
    "id": "internationalization.mdx#1",
    "metadata": {
      "title": "Internationalization",
      "description": "Add support for multiple languages with internationalized routing and localized content."
    },
    "content": "## Routing Overview\n\nIt’s recommended to use the user’s language preferences in the browser to select which locale to use. Changing your preferred language will modify the incoming `Accept-Language` header to your application.\n\nFor example, using the following libraries, you can look at an incoming `Request` to determine which locale to select, based on the `Headers`, locales you plan to support, and the default locale.\n\n```js filename=\"proxy.js\"\nimport { match } from '@formatjs/intl-localematcher'\nimport Negotiator from 'negotiator'\n\nlet headers = { 'accept-language': 'en-US,en;q=0.5' }\nlet languages = new Negotiator({ headers }).languages()\nlet locales = ['en-US', 'nl-NL', 'nl']\nlet defaultLocale = 'en-US'\n\nmatch(languages, locales, defaultLocale) // -> 'en-US'"
  },
  {
    "id": "internationalization.mdx#2",
    "metadata": {
      "title": "Internationalization",
      "description": "Add support for multiple languages with internationalized routing and localized content."
    },
    "content": "```\n\nRouting can be internationalized by either the sub-path (`/fr/products`) or domain (`my-site.fr/products`). With this information, you can now redirect the user based on the locale inside [Proxy](/docs/app/api-reference/file-conventions/proxy).\n\n```js filename=\"proxy.js\"\nimport { NextResponse } from \"next/server\";\n\nlet locales = ['en-US', 'nl-NL', 'nl']\n\n// Get the preferred locale, similar to the above or using a library\nfunction getLocale(request) { ... }\n\nexport function proxy(request) {\n  // Check if there is any supported locale in the pathname\n  const { pathname } = request.nextUrl\n  const pathnameHasLocale = locales.some(\n    (locale) => pathname.startsWith(`/${locale}/`) || pathname === `/${locale}`\n  )\n\n  if (pathnameHasLocale) return\n\n  // Redirect if there is no locale\n  const locale = getLocale(request)\n  request.nextUrl.pathname = `/${locale}${pathname}`\n  // e.g. incoming request is /products\n  // The new URL is now /en-US/products\n  return NextResponse.redirect(request.nextUrl)\n}\n\nexport const config = {\n  matcher: [\n    // Skip all internal paths (_next)\n    '/((?!_next).*)',\n    // Optional: only run on root (/) URL\n    // '/'\n  ],\n}"
  },
  {
    "id": "internationalization.mdx#3",
    "metadata": {
      "title": "Internationalization",
      "description": "Add support for multiple languages with internationalized routing and localized content."
    },
    "content": "```\n\nFinally, ensure all special files inside `app/` are nested under `app/[lang]`. This enables the Next.js router to dynamically handle different locales in the route, and forward the `lang` parameter to every layout and page. For example:\n\n```tsx filename=\"app/[lang]/page.tsx\" switcher\n// You now have access to the current locale\n// e.g. /en-US/products -> `lang` is \"en-US\"\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ lang: string }>\n}) {\n  const { lang } = await params\n  return ...\n}\n```\n\n```jsx filename=\"app/[lang]/page.js\" switcher\n// You now have access to the current locale\n// e.g. /en-US/products -> `lang` is \"en-US\"\nexport default async function Page({ params }) {\n  const { lang } = await params\n  return ...\n}\n```\n\nThe root layout can also be nested in the new folder (e.g. `app/[lang]/layout.js`)."
  },
  {
    "id": "internationalization.mdx#4",
    "metadata": {
      "title": "Internationalization",
      "description": "Add support for multiple languages with internationalized routing and localized content."
    },
    "content": "## Localization\n\nChanging displayed content based on the user’s preferred locale, or localization, is not something specific to Next.js. The patterns described below would work the same with any web application.\n\nLet’s assume we want to support both English and Dutch content inside our application. We might maintain two different “dictionaries”, which are objects that give us a mapping from some key to a localized string. For example:\n\n```json filename=\"dictionaries/en.json\"\n{\n  \"products\": {\n    \"cart\": \"Add to Cart\"\n  }\n}\n```\n\n```json filename=\"dictionaries/nl.json\"\n{\n  \"products\": {\n    \"cart\": \"Toevoegen aan Winkelwagen\"\n  }\n}\n```\n\nWe can then create a `getDictionary` function to load the translations for the requested locale:\n\n```ts filename=\"app/[lang]/dictionaries.ts\" switcher\nimport 'server-only'\n\nconst dictionaries = {\n  en: () => import('./dictionaries/en.json').then((module) => module.default),\n  nl: () => import('./dictionaries/nl.json').then((module) => module.default),\n}\n\nexport const getDictionary = async (locale: 'en' | 'nl') =>\n  dictionaries[locale]()"
  },
  {
    "id": "internationalization.mdx#5",
    "metadata": {
      "title": "Internationalization",
      "description": "Add support for multiple languages with internationalized routing and localized content."
    },
    "content": "```\n\n```js filename=\"app/[lang]/dictionaries.js\" switcher\nimport 'server-only'\n\nconst dictionaries = {\n  en: () => import('./dictionaries/en.json').then((module) => module.default),\n  nl: () => import('./dictionaries/nl.json').then((module) => module.default),\n}\n\nexport const getDictionary = async (locale) => dictionaries[locale]()\n```\n\nGiven the currently selected language, we can fetch the dictionary inside of a layout or page.\n\n```tsx filename=\"app/[lang]/page.tsx\" switcher\nimport { getDictionary } from './dictionaries'\n\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ lang: 'en' | 'nl' }>\n}) {\n  const { lang } = await params\n  const dict = await getDictionary(lang) // en\n  return <button>{dict.products.cart}</button> // Add to Cart\n}\n```\n\n```jsx filename=\"app/[lang]/page.js\" switcher\nimport { getDictionary } from './dictionaries'\n\nexport default async function Page({ params }) {\n  const { lang } = await params\n  const dict = await getDictionary(lang) // en\n  return <button>{dict.products.cart}</button> // Add to Cart\n}"
  },
  {
    "id": "internationalization.mdx#6",
    "metadata": {
      "title": "Internationalization",
      "description": "Add support for multiple languages with internationalized routing and localized content."
    },
    "content": "```\n\nBecause all layouts and pages in the `app/` directory default to [Server Components](/docs/app/getting-started/server-and-client-components), we do not need to worry about the size of the translation files affecting our client-side JavaScript bundle size. This code will **only run on the server**, and only the resulting HTML will be sent to the browser."
  },
  {
    "id": "internationalization.mdx#7",
    "metadata": {
      "title": "Internationalization",
      "description": "Add support for multiple languages with internationalized routing and localized content."
    },
    "content": "## Static Rendering\n\nTo generate static routes for a given set of locales, we can use `generateStaticParams` with any page or layout. This can be global, for example, in the root layout:\n\n```tsx filename=\"app/[lang]/layout.tsx\" switcher\nexport async function generateStaticParams() {\n  return [{ lang: 'en-US' }, { lang: 'de' }]\n}\n\nexport default async function RootLayout({\n  children,\n  params,\n}: Readonly<{\n  children: React.ReactNode\n  params: Promise<{ lang: 'en-US' | 'de' }>\n}>) {\n  return (\n    <html lang={(await params).lang}>\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/[lang]/layout.js\" switcher\nexport async function generateStaticParams() {\n  return [{ lang: 'en-US' }, { lang: 'de' }]\n}\n\nexport default async function RootLayout({ children, params }) {\n  return (\n    <html lang={(await params).lang}>\n      <body>{children}</body>\n    </html>\n  )\n}\n```"
  },
  {
    "id": "internationalization.mdx#8",
    "metadata": {
      "title": "Internationalization",
      "description": "Add support for multiple languages with internationalized routing and localized content."
    },
    "content": "## Resources\n\n- [Minimal i18n routing and translations](https://github.com/vercel/next.js/tree/canary/examples/i18n-routing)\n- [`next-intl`](https://next-intl.dev)\n- [`next-international`](https://github.com/QuiiBz/next-international)\n- [`next-i18n-router`](https://github.com/i18nexus/next-i18n-router)\n- [`paraglide-next`](https://inlang.com/m/osslbuzt/paraglide-next-i18n)\n- [`lingui`](https://lingui.dev)\n- [`tolgee`](https://tolgee.io/apps-integrations/next)\n- [`next-intlayer`](https://intlayer.org/doc/environment/nextjs)\n- [`gt-next`](https://generaltranslation.com/en/docs/next)"
  },
  {
    "id": "json-ld.mdx#0",
    "metadata": {
      "title": "How to implement JSON-LD in your Next.js application",
      "description": "Learn how to add JSON-LD to your Next.js application to describe your content to search engines and AI."
    },
    "content": "---\ntitle: How to implement JSON-LD in your Next.js application\nnav_title: JSON-LD\ndescription: Learn how to add JSON-LD to your Next.js application to describe your content to search engines and AI.\n---\n\n[JSON-LD](https://json-ld.org/) is a format for structured data that can be used by search engines and AI to help them understand the structure of the page beyond pure content. For example, you can use it to describe a person, an event, an organization, a movie, a book, a recipe, and many other types of entities.\n\nOur current recommendation for JSON-LD is to render structured data as a `<script>` tag in your `layout.js` or `page.js` components.\n\nThe following snippet uses `JSON.stringify`, which does not sanitize malicious strings used in XSS injection. To prevent this type of vulnerability, you can scrub `HTML` tags from the `JSON-LD` payload, for example, by replacing the character, `<`, with its unicode equivalent, `\\u003c`.\n\nReview your organization's recommended approach to sanitize potentially dangerous strings, or use community maintained alternatives for `JSON.stringify` such as, [serialize-javascript](https://www.npmjs.com/package/serialize-javascript)."
  },
  {
    "id": "json-ld.mdx#1",
    "metadata": {
      "title": "How to implement JSON-LD in your Next.js application",
      "description": "Learn how to add JSON-LD to your Next.js application to describe your content to search engines and AI."
    },
    "content": "```tsx filename=\"app/products/[id]/page.tsx\" switcher\nexport default async function Page({ params }) {\n  const { id } = await params\n  const product = await getProduct(id)\n\n  const jsonLd = {\n    '@context': 'https://schema.org',\n    '@type': 'Product',\n    name: product.name,\n    image: product.image,\n    description: product.description,\n  }\n\n  return (\n    <section>\n      {/* Add JSON-LD to your page */}\n      <script\n        type=\"application/ld+json\"\n        dangerouslySetInnerHTML={{\n          __html: JSON.stringify(jsonLd).replace(/</g, '\\\\u003c'),\n        }}\n      />\n      {/* ... */}\n    </section>\n  )\n}"
  },
  {
    "id": "json-ld.mdx#2",
    "metadata": {
      "title": "How to implement JSON-LD in your Next.js application",
      "description": "Learn how to add JSON-LD to your Next.js application to describe your content to search engines and AI."
    },
    "content": "```\n\n```jsx filename=\"app/products/[id]/page.js\" switcher\nexport default async function Page({ params }) {\n  const { id } = await params\n  const product = await getProduct(id)\n\n  const jsonLd = {\n    '@context': 'https://schema.org',\n    '@type': 'Product',\n    name: product.name,\n    image: product.image,\n    description: product.description,\n  }\n\n  return (\n    <section>\n      {/* Add JSON-LD to your page */}\n      <script\n        type=\"application/ld+json\"\n        dangerouslySetInnerHTML={{\n          __html: JSON.stringify(jsonLd).replace(/</g, '\\\\u003c'),\n        }}\n      />\n      {/* ... */}\n    </section>\n  )\n}"
  },
  {
    "id": "json-ld.mdx#3",
    "metadata": {
      "title": "How to implement JSON-LD in your Next.js application",
      "description": "Learn how to add JSON-LD to your Next.js application to describe your content to search engines and AI."
    },
    "content": "```\n\nYou can validate and test your structured data with the [Rich Results Test](https://search.google.com/test/rich-results) for Google or the generic [Schema Markup Validator](https://validator.schema.org/).\n\nYou can type your JSON-LD with TypeScript using community packages like [`schema-dts`](https://www.npmjs.com/package/schema-dts):\n\n```tsx\nimport { Product, WithContext } from 'schema-dts'\n\nconst jsonLd: WithContext<Product> = {\n  '@context': 'https://schema.org',\n  '@type': 'Product',\n  name: 'Next.js Sticker',\n  image: 'https://nextjs.org/imgs/sticker.png',\n  description: 'Dynamic at the speed of static.',\n}\n```"
  },
  {
    "id": "lazy-loading.mdx#0",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "---\ntitle: How to lazy load Client Components and libraries\nnav_title: Lazy Loading\ndescription: Lazy load imported libraries and React Components to improve your application's loading performance.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n[Lazy loading](https://developer.mozilla.org/docs/Web/Performance/Lazy_loading) in Next.js helps improve the initial loading performance of an application by decreasing the amount of JavaScript needed to render a route.\n\n<AppOnly>\n\nIt allows you to defer loading of **Client Components** and imported libraries, and only include them in the client bundle when they're needed. For example, you might want to defer loading a modal until a user clicks to open it.\n\nThere are two ways you can implement lazy loading in Next.js:\n\n1. Using [Dynamic Imports](#nextdynamic) with `next/dynamic`\n2. Using [`React.lazy()`](https://react.dev/reference/react/lazy) with [Suspense](https://react.dev/reference/react/Suspense)"
  },
  {
    "id": "lazy-loading.mdx#1",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "1. Using [Dynamic Imports](#nextdynamic) with `next/dynamic`\n2. Using [`React.lazy()`](https://react.dev/reference/react/lazy) with [Suspense](https://react.dev/reference/react/Suspense)\n\nBy default, Server Components are automatically [code split](https://developer.mozilla.org/docs/Glossary/Code_splitting), and you can use [streaming](/docs/app/api-reference/file-conventions/loading) to progressively send pieces of UI from the server to the client. Lazy loading applies to Client Components."
  },
  {
    "id": "lazy-loading.mdx#2",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "## `next/dynamic`\n\n`next/dynamic` is a composite of [`React.lazy()`](https://react.dev/reference/react/lazy) and [Suspense](https://react.dev/reference/react/Suspense). It behaves the same way in the `app` and `pages` directories to allow for incremental migration."
  },
  {
    "id": "lazy-loading.mdx#3",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "## Examples\n\n### Importing Client Components\n\n```jsx filename=\"app/page.js\"\n'use client'\n\nimport { useState } from 'react'\nimport dynamic from 'next/dynamic'\n\n// Client Components:\nconst ComponentA = dynamic(() => import('../components/A'))\nconst ComponentB = dynamic(() => import('../components/B'))\nconst ComponentC = dynamic(() => import('../components/C'), { ssr: false })\n\nexport default function ClientComponentExample() {\n  const [showMore, setShowMore] = useState(false)\n\n  return (\n    <div>\n      {/* Load immediately, but in a separate client bundle */}\n      <ComponentA />\n\n      {/* Load on demand, only when/if the condition is met */}\n      {showMore && <ComponentB />}\n      <button onClick={() => setShowMore(!showMore)}>Toggle</button>\n\n      {/* Load only on the client side */}\n      <ComponentC />\n    </div>\n  )\n}\n```\n\n> **Note:** When a Server Component dynamically imports a Client Component, automatic [code splitting](https://developer.mozilla.org/docs/Glossary/Code_splitting) is currently **not** supported."
  },
  {
    "id": "lazy-loading.mdx#4",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "### Skipping SSR\n\nWhen using `React.lazy()` and Suspense, Client Components will be [prerendered](https://github.com/reactwg/server-components/discussions/4) (SSR) by default.\n\n> **Note:** `ssr: false` option will only work for Client Components, move it into Client Components ensure the client code-splitting working properly.\n\nIf you want to disable pre-rendering for a Client Component, you can use the `ssr` option set to `false`:\n\n```jsx\nconst ComponentC = dynamic(() => import('../components/C'), { ssr: false })\n```"
  },
  {
    "id": "lazy-loading.mdx#5",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "### Importing Server Components\n\nIf you dynamically import a Server Component, only the Client Components that are children of the Server Component will be lazy-loaded - not the Server Component itself.\nIt will also help preload the static assets such as CSS when you're using it in Server Components.\n\n```jsx filename=\"app/page.js\"\nimport dynamic from 'next/dynamic'\n\n// Server Component:\nconst ServerComponent = dynamic(() => import('../components/ServerComponent'))\n\nexport default function ServerComponentExample() {\n  return (\n    <div>\n      <ServerComponent />\n    </div>\n  )\n}\n```\n\n> **Note:** `ssr: false` option is not supported in Server Components. You will see an error if you try to use it in Server Components.\n> `ssr: false` is not allowed with `next/dynamic` in Server Components. Please move it into a Client Component."
  },
  {
    "id": "lazy-loading.mdx#6",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "### Loading External Libraries\n\nExternal libraries can be loaded on demand using the [`import()`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/import) function. This example uses the external library `fuse.js` for fuzzy search. The module is only loaded on the client after the user types in the search input.\n\n```jsx filename=\"app/page.js\"\n'use client'\n\nimport { useState } from 'react'\n\nconst names = ['Tim', 'Joe', 'Bel', 'Lee']\n\nexport default function Page() {\n  const [results, setResults] = useState()\n\n  return (\n    <div>\n      <input\n        type=\"text\"\n        placeholder=\"Search\"\n        onChange={async (e) => {\n          const { value } = e.currentTarget\n          // Dynamically load fuse.js\n          const Fuse = (await import('fuse.js')).default\n          const fuse = new Fuse(names)\n\n          setResults(fuse.search(value))\n        }}\n      />\n      <pre>Results: {JSON.stringify(results, null, 2)}</pre>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "lazy-loading.mdx#7",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "### Adding a custom loading component\n\n```jsx filename=\"app/page.js\"\n'use client'\n\nimport dynamic from 'next/dynamic'\n\nconst WithCustomLoading = dynamic(\n  () => import('../components/WithCustomLoading'),\n  {\n    loading: () => <p>Loading...</p>,\n  }\n)\n\nexport default function Page() {\n  return (\n    <div>\n      {/* The loading component will be rendered while  <WithCustomLoading/> is loading */}\n      <WithCustomLoading />\n    </div>\n  )\n}\n```\n\n### Importing Named Exports\n\nTo dynamically import a named export, you can return it from the Promise returned by [`import()`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/import) function:\n\n```jsx filename=\"components/hello.js\"\n'use client'\n\nexport function Hello() {\n  return <p>Hello!</p>\n}\n```\n\n```jsx filename=\"app/page.js\"\nimport dynamic from 'next/dynamic'\n\nconst ClientComponent = dynamic(() =>\n  import('../components/hello').then((mod) => mod.Hello)\n)\n```\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "lazy-loading.mdx#8",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "## `next/dynamic`\n\n`next/dynamic` is a composite of [`React.lazy()`](https://react.dev/reference/react/lazy) and [Suspense](https://react.dev/reference/react/Suspense). It behaves the same way in the `app` and `pages` directories to allow for incremental migration.\n\nIn the example below, by using `next/dynamic`, the header component will not be included in the page's initial JavaScript bundle. The page will render the Suspense `fallback` first, followed by the `Header` component when the `Suspense` boundary is resolved.\n\n```jsx\nimport dynamic from 'next/dynamic'\n\nconst DynamicHeader = dynamic(() => import('../components/header'), {\n  loading: () => <p>Loading...</p>,\n})\n\nexport default function Home() {\n  return <DynamicHeader />\n}"
  },
  {
    "id": "lazy-loading.mdx#9",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "```\n\n> **Good to know**: In `import('path/to/component')`, the path must be explicitly written. It can't be a template string nor a variable. Furthermore the `import()` has to be inside the `dynamic()` call for Next.js to be able to match webpack bundles / module ids to the specific `dynamic()` call and preload them before rendering. `dynamic()` can't be used inside of React rendering as it needs to be marked in the top level of the module for preloading to work, similar to `React.lazy`."
  },
  {
    "id": "lazy-loading.mdx#10",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "## Examples\n\n### With named exports\n\nTo dynamically import a named export, you can return it from the [Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise) returned by [`import()`](https://github.com/tc39/proposal-dynamic-import#example):\n\n```jsx filename=\"components/hello.js\"\nexport function Hello() {\n  return <p>Hello!</p>\n}\n\n// pages/index.js\nimport dynamic from 'next/dynamic'\n\nconst DynamicComponent = dynamic(() =>\n  import('../components/hello').then((mod) => mod.Hello)\n)\n```\n\n### With no SSR\n\nTo dynamically load a component on the client side, you can use the `ssr` option to disable server-rendering. This is useful if an external dependency or component relies on browser APIs like `window`.\n\n```jsx\n'use client'\n\nimport dynamic from 'next/dynamic'\n\nconst DynamicHeader = dynamic(() => import('../components/header'), {\n  ssr: false,\n})\n```"
  },
  {
    "id": "lazy-loading.mdx#11",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's loading performance."
    },
    "content": "### With external libraries\n\nThis example uses the external library `fuse.js` for fuzzy search. The module is only loaded in the browser after the user types in the search input.\n\n```jsx\nimport { useState } from 'react'\n\nconst names = ['Tim', 'Joe', 'Bel', 'Lee']\n\nexport default function Page() {\n  const [results, setResults] = useState()\n\n  return (\n    <div>\n      <input\n        type=\"text\"\n        placeholder=\"Search\"\n        onChange={async (e) => {\n          const { value } = e.currentTarget\n          // Dynamically load fuse.js\n          const Fuse = (await import('fuse.js')).default\n          const fuse = new Fuse(names)\n\n          setResults(fuse.search(value))\n        }}\n      />\n      <pre>Results: {JSON.stringify(results, null, 2)}</pre>\n    </div>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "local-development.mdx#0",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "---\ntitle: How to optimize your local development environment\nnav_title: Development Environment\ndescription: Learn how to optimize your local development environment with Next.js.\n---\n\nNext.js is designed to provide a great developer experience. As your application grows, you might notice slower compilation times during local development. This guide will help you identify and fix common compile-time performance issues.\n\n## Local dev vs. production\n\nThe development process with `next dev` is different than `next build` and `next start`.\n\n`next dev` compiles routes in your application as you open or navigate to them. This enables you to start the dev server without waiting for every route in your application to compile, which is both faster and uses less memory. Running a production build applies other optimizations, like minifying files and creating content hashes, which are not needed for local development."
  },
  {
    "id": "local-development.mdx#1",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "## Improving local dev performance"
  },
  {
    "id": "local-development.mdx#2",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "### 1. Check your computer's antivirus\n\nAntivirus software can slow down file access. While this is more common on Windows machines, this can be an issue for any system with an antivirus tool installed.\n\nOn Windows, you can add your project to the [Microsoft Defender Antivirus exclusion list](https://support.microsoft.com/en-us/windows/virus-and-threat-protection-in-the-windows-security-app-1362f4cd-d71a-b52a-0b66-c2820032b65e#bkmk_threat-protection-settings).\n\n1. Open the **\"Windows Security\"** application and then select **\"Virus & threat protection\"** &rarr; **\"Manage settings\"** &rarr; **\"Add or remove exclusions\"**.\n2. Add a **\"Folder\"** exclusion. Select your project folder.\n\nOn macOS, you can disable [Gatekeeper](https://support.apple.com/guide/security/gatekeeper-and-runtime-protection-sec5599b66df/web) inside of your terminal.\n\n1. Run `sudo spctl developer-mode enable-terminal` in your terminal.\n2. Open the **\"System Settings\"** app and then select **\"Privacy & Security\"** &rarr; **\"Developer Tools\"**.\n3. Ensure your terminal is listed and enabled. If you're using a third-party terminal like iTerm or Ghostty, add that to the list.\n4. Restart your terminal."
  },
  {
    "id": "local-development.mdx#3",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "<Image\n  alt=\"Screenshot of macOS System Settings showing the Privacy & Security pane\"\n  srcLight=\"/docs/light/macos-gatekeeper-privacy-and-security.png\"\n  srcDark=\"/docs/dark/macos-gatekeeper-privacy-and-security.png\"\n  width=\"723\"\n  height=\"250\"\n/>\n\n<Image\n  alt=\"Screenshot of macOS System Settings showing the Developer Tools options\"\n  srcLight=\"/docs/light/macos-gatekeeper-developer-tools.png\"\n  srcDark=\"/docs/dark/macos-gatekeeper-developer-tools.png\"\n  width=\"723\"\n  height=\"250\"\n/>\n\nIf you or your employer have configured any other Antivirus solutions on your system, you should inspect the relevant settings for those products."
  },
  {
    "id": "local-development.mdx#4",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "### 2. Update Next.js and use Turbopack\n\nMake sure you're using the latest version of Next.js. Each new version often includes performance improvements.\n\nTurbopack is now the default bundler for Next.js development and provides significant performance improvements over webpack.\n\n```bash\nnpm install next@latest\nnpm run dev  # Turbopack is used by default\n```\n\nIf you need to use Webpack instead of Turbopack, you can opt-in:\n\n```bash\nnpm run dev --webpack\n```\n\n[Learn more about Turbopack](/blog/turbopack-for-development-stable). See our [upgrade guides](/docs/app/guides/upgrading) and codemods for more information."
  },
  {
    "id": "local-development.mdx#5",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "### 3. Check your imports\n\nThe way you import code can greatly affect compilation and bundling time. Learn more about [optimizing package bundling](/docs/app/guides/package-bundling) and explore tools like [Dependency Cruiser](https://github.com/sverweij/dependency-cruiser) or [Madge](https://github.com/pahen/madge)."
  },
  {
    "id": "local-development.mdx#6",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "#### Icon libraries\n\nLibraries like `@material-ui/icons`, `@phosphor-icons/react`, or `react-icons` can import thousands of icons, even if you only use a few. Try to import only the icons you need:\n\n```jsx\n// Instead of this:\nimport { TriangleIcon } from '@phosphor-icons/react'\n\n// Do this:\nimport { TriangleIcon } from '@phosphor-icons/react/dist/csr/Triangle'\n```\n\nYou can often find what import pattern to use in the documentation for the icon library you're using. This example follows [`@phosphor-icons/react`](https://www.npmjs.com/package/@phosphor-icons/react#import-performance-optimization) recommendation.\n\nLibraries like `react-icons` includes many different icon sets. Choose one set and stick with that set.\n\nFor example, if your application uses `react-icons` and imports all of these:\n\n- `pi` (Phosphor Icons)\n- `md` (Material Design Icons)\n- `tb` (tabler-icons)\n- `cg` (cssgg)\n\nCombined they will be tens of thousands of modules that the compiler has to handle, even if you only use a single import from each."
  },
  {
    "id": "local-development.mdx#7",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "#### Barrel files\n\n\"Barrel files\" are files that export many items from other files. They can slow down builds because the compiler has to parse them to find if there are side-effects in the module scope by using the import.\n\nTry to import directly from specific files when possible. [Learn more about barrel files](https://vercel.com/blog/how-we-optimized-package-imports-in-next-js) and the built-in optimizations in Next.js.\n\n#### Optimize package imports\n\nNext.js can automatically optimize imports for certain packages. If you are using packages that utilize barrel files, add them to your `next.config.js`:\n\n```jsx\nmodule.exports = {\n  experimental: {\n    optimizePackageImports: ['package-name'],\n  },\n}\n```\n\nTurbopack automatically analyzes imports and optimizes them. It does not require this configuration."
  },
  {
    "id": "local-development.mdx#8",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "### 4. Check your Tailwind CSS setup\n\nIf you're using Tailwind CSS, make sure it's set up correctly.\n\nA common mistake is configuring your `content` array in a way which includes `node_modules` or other large directories of files that should not be scanned.\n\nTailwind CSS version 3.4.8 or newer will warn you about settings that might slow down your build.\n\n1. In your `tailwind.config.js`, be specific about which files to scan:\n\n   ```jsx\n   module.exports = {\n     content: [\n       './src/**/*.{js,ts,jsx,tsx}', // Good\n       // This might be too broad\n       // It will match `packages/**/node_modules` too\n       // '../../packages/**/*.{js,ts,jsx,tsx}',\n     ],\n   }\n   ```\n\n2. Avoid scanning unnecessary files:\n\n   ```jsx\n   module.exports = {\n     content: [\n       // Better - only scans the 'src' folder\n       '../../packages/ui/src/**/*.{js,ts,jsx,tsx}',\n     ],\n   }\n   ```"
  },
  {
    "id": "local-development.mdx#9",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "### 5. Check custom webpack settings\n\nIf you've added custom webpack settings, they might be slowing down compilation.\n\nConsider if you really need them for local development. You can optionally only include certain tools for production builds, or explore using the default Turbopack bundler and configuring [loaders](/docs/app/api-reference/config/next-config-js/turbopack#configuring-webpack-loaders) instead.\n\n### 6. Optimize memory usage\n\nIf your app is very large, it might need more memory.\n\n[Learn more about optimizing memory usage](/docs/app/guides/memory-usage).\n\n### 7. Server Components and data fetching\n\nChanges to Server Components cause the entire page to re-render locally in order to show the new changes, which includes fetching new data for the component.\n\nThe experimental `serverComponentsHmrCache` option allows you to cache `fetch` responses in Server Components across Hot Module Replacement (HMR) refreshes in local development. This results in faster responses and reduced costs for billed API calls.\n\n[Learn more about the experimental option](/docs/app/api-reference/config/next-config-js/serverComponentsHmrCache)."
  },
  {
    "id": "local-development.mdx#10",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "### 8. Consider local development over Docker\n\nIf you're using Docker for development on Mac or Windows, you may experience significantly slower performance compared to running Next.js locally.\n\nDocker's filesystem access on Mac and Windows can cause Hot Module Replacement (HMR) to take seconds or even minutes, while the same application runs with fast HMR when developed locally.\n\nThis performance difference is due to how Docker handles filesystem operations outside of Linux environments. For the best development experience:\n\n- Use local development (`npm run dev` or `pnpm dev`) instead of Docker during development\n- Reserve Docker for production deployments and testing production builds\n- If you must use Docker for development, consider using Docker on a Linux machine or VM\n\n[Learn more about Docker deployment](/docs/app/getting-started/deploying#docker) for production use."
  },
  {
    "id": "local-development.mdx#11",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "## Tools for finding problems\n\n### Detailed fetch logging\n\nUse the `logging.fetches` option in your `next.config.js` file, to see more detailed information about what's happening during development:\n\n```js\nmodule.exports = {\n  logging: {\n    fetches: {\n      fullUrl: true,\n    },\n  },\n}\n```\n\n[Learn more about fetch logging](/docs/app/api-reference/config/next-config-js/logging)."
  },
  {
    "id": "local-development.mdx#12",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "### Turbopack tracing\n\nTurbopack tracing is a tool that helps you understand the performance of your application during local development.\nIt provides detailed information about the time taken for each module to compile and how they are related.\n\n1. Make sure you have the latest version of Next.js installed.\n1. Generate a Turbopack trace file:\n\n   ```bash\n   NEXT_TURBOPACK_TRACING=1 npm run dev\n   ```\n\n1. Navigate around your application or make edits to files to reproduce the problem.\n1. Stop the Next.js development server.\n1. A file called `trace-turbopack` will be available in the `.next/dev` folder.\n1. You can interpret the file using `npx next internal trace [path-to-file]`:\n\n   ```bash\n   npx next internal trace .next/dev/trace-turbopack\n   ```\n\n   On versions where `trace` is not available, the command was named `turbo-trace-server`:\n\n   ```bash\n   npx next internal turbo-trace-server .next/dev/trace-turbopack"
  },
  {
    "id": "local-development.mdx#13",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "```\n\n   On versions where `trace` is not available, the command was named `turbo-trace-server`:\n\n   ```bash\n   npx next internal turbo-trace-server .next/dev/trace-turbopack\n   ```\n\n1. Once the trace server is running you can view the trace at https://trace.nextjs.org/.\n1. By default the trace viewer will aggregate timings, in order to see each individual time you can switch from \"Aggregated in order\" to \"Spans in order\" at the top right of the viewer.\n\n> **Good to know**: The trace file is place under the development server directory, which defaults to `.next/dev`. This is controllable using the [`isolatedDevBuild`](/docs/app/api-reference/config/next-config-js/isolatedDevBuild) flag in your Next config file."
  },
  {
    "id": "local-development.mdx#14",
    "metadata": {
      "title": "How to optimize your local development environment",
      "description": "Learn how to optimize your local development environment with Next.js."
    },
    "content": "### Still having problems?\n\nShare the trace file generated in the [Turbopack Tracing](#turbopack-tracing) section and share it on [GitHub Discussions](https://github.com/vercel/next.js/discussions) or [Discord](https://nextjs.org/discord)."
  },
  {
    "id": "mcp.mdx#0",
    "metadata": {
      "title": "Enabling Next.js MCP Server for Coding Agents",
      "description": "Learn how to use Next.js MCP support to allow coding agents access to your application state"
    },
    "content": "---\ntitle: Enabling Next.js MCP Server for Coding Agents\nnav_title: Next.js MCP Server\ndescription: Learn how to use Next.js MCP support to allow coding agents access to your application state\n---\n\nThe [Model Context Protocol (MCP)](https://modelcontextprotocol.io) is an open standard that allows AI agents and coding assistants to interact with your applications through a standardized interface.\n\nNext.js 16+ includes MCP support that enables coding agents to access your application's internals in real-time. To use this functionality, install the [`next-devtools-mcp`](https://www.npmjs.com/package/next-devtools-mcp) package.\n\n## Getting started\n\n**Requirements:** Next.js 16 or above\n\nAdd `next-devtools-mcp` to the `.mcp.json` file at the root of your project:\n\n```json filename=\".mcp.json\"\n{\n  \"mcpServers\": {\n    \"next-devtools\": {\n      \"command\": \"npx\",\n      \"args\": [\"-y\", \"next-devtools-mcp@latest\"]\n    }\n  }\n}\n```\n\nThat's it! When you start your development server, `next-devtools-mcp` will automatically discover and connect to your running Next.js instance.\n\nFor more configuration options, see the [next-devtools-mcp repository](https://github.com/vercel/next-devtools-mcp)."
  },
  {
    "id": "mcp.mdx#1",
    "metadata": {
      "title": "Enabling Next.js MCP Server for Coding Agents",
      "description": "Learn how to use Next.js MCP support to allow coding agents access to your application state"
    },
    "content": "## Capabilities\n\n`next-devtools-mcp` provides coding agents with a growing set of capabilities:\n\n### Application Runtime Access\n\n- **Error Detection**: Retrieve current build errors, runtime errors, and type errors from your dev server\n- **Live State Queries**: Access real-time application state and runtime information\n- **Page Metadata**: Query page routes, components, and rendering details\n- **Server Actions**: Inspect Server Actions and component hierarchies\n- **Development Logs**: Access development server logs and console output\n\n### Development Tools\n\n- **Next.js Knowledge Base**: Query comprehensive Next.js documentation and best practices\n- **Migration and Upgrade Tools**: Automated helpers for upgrading to Next.js 16 with codemods\n- **Cache Components Guide**: Setup and configuration assistance for Cache Components\n- **Browser Testing**: [Playwright MCP](https://github.com/microsoft/playwright-mcp) integration for verifying pages in the browser\n\n> **Note:** The Next.js team is actively expanding these capabilities. New tools and features are added regularly to improve the agent development experience."
  },
  {
    "id": "mcp.mdx#2",
    "metadata": {
      "title": "Enabling Next.js MCP Server for Coding Agents",
      "description": "Learn how to use Next.js MCP support to allow coding agents access to your application state"
    },
    "content": "## Development workflow\n\n1. Start your Next.js development server:\n\n```bash filename=\"Terminal\"\nnpm run dev\n```\n\n2. Your Coding Agent will automatically connect to the running Next.js instance via `next-devtools-mcp`\n\n3. Open your application in the browser to view pages\n\n4. Query your agent for insights and diagnostics (see examples below)\n\n### Available tools\n\nThrough `next-devtools-mcp`, agents can use the following tools:\n\n- **`get_errors`**: Retrieve current build errors, runtime errors, and type errors from your dev server\n- **`get_logs`**: Get the path to the development log file containing browser console logs and server output\n- **`get_page_metadata`**: Get metadata about specific pages including routes, components, and rendering information\n- **`get_project_metadata`**: Retrieve project structure, configuration, and dev server URL\n- **`get_server_action_by_id`**: Look up Server Actions by their ID to find the source file and function name"
  },
  {
    "id": "mcp.mdx#3",
    "metadata": {
      "title": "Enabling Next.js MCP Server for Coding Agents",
      "description": "Learn how to use Next.js MCP support to allow coding agents access to your application state"
    },
    "content": "## Using with agents\n\nMCP-compatible Coding Agents can automatically discover and connect to your Next.js development server, providing them with rich context about your project.\n\n### Benefits for agent-assisted development\n\nAgents can:\n\n- **Make context-aware suggestions**: Recommend the right place to add new features based on your existing structure\n- **Query live application state**: Check current configuration, routes, and middleware during development\n- **Understand your app router pages layout**: Know exactly which page and layout are rendered\n- **Provide accurate implementations**: Generate code that follows your project's patterns and conventions"
  },
  {
    "id": "mcp.mdx#4",
    "metadata": {
      "title": "Enabling Next.js MCP Server for Coding Agents",
      "description": "Learn how to use Next.js MCP support to allow coding agents access to your application state"
    },
    "content": "## Examples"
  },
  {
    "id": "mcp.mdx#5",
    "metadata": {
      "title": "Enabling Next.js MCP Server for Coding Agents",
      "description": "Learn how to use Next.js MCP support to allow coding agents access to your application state"
    },
    "content": "### Error detection and diagnosis\n\nAsk your agent about errors in real-time:\n\n```bash\nUser: \"What errors are currently in my application?\""
  },
  {
    "id": "mcp.mdx#6",
    "metadata": {
      "title": "Enabling Next.js MCP Server for Coding Agents",
      "description": "Learn how to use Next.js MCP support to allow coding agents access to your application state"
    },
    "content": "```\n\nThe agent will:\n\n- Query your running Next.js application via `next-devtools-mcp`\n- Retrieve current build errors, runtime errors, and type errors\n- Analyze the errors and provide actionable fixes\n\n<details>\n<summary>Agent response (click to expand)</summary>\n\n```bash\n> fix errors on the page\n\n⏺ I'll help you fix the errors on the page. Let me first check what errors exist by looking at the\n  current state of the project.\n\n⏺ next-devtools - nextjs_runtime (MCP)(action: \"discover_servers\")\n⏺ next-devtools - nextjs_runtime (MCP)(action: \"call_tool\", toolName: \"get_errors\")\n\n⏺ I found a hydration error on the /about page. The error shows that the server is rendering\n  \"server\" but the client is rendering \"client\", causing a mismatch. Let me create a todo list and fix\n   this issue.\n\n⏺ Perfect! Now let me check for errors on the page.           01:14 PM  claude-sonnet-4-5-20250929"
  },
  {
    "id": "mcp.mdx#7",
    "metadata": {
      "title": "Enabling Next.js MCP Server for Coding Agents",
      "description": "Learn how to use Next.js MCP support to allow coding agents access to your application state"
    },
    "content": "⏺ Perfect! Now let me check for errors on the page.           01:14 PM  claude-sonnet-4-5-20250929\n\n⏺ next-devtools - nextjs_runtime (MCP)(action: \"call_tool\", toolName: \"get_errors\")\n  ⎿ {\n      \"success\": true,\n      \"port\": 3000,\n      \"toolName\": \"get_errors\",\n      \"result\": {\n        \"content\": [\n          {\n            \"type\": \"text\",\n            \"text\": \"# Found errors in 1 browser session(s)\\n\\n## Session: /about\\n\\n**1 error(s)\n     found**\\n\\n### Runtime Errors\\n\\n#### Error 1 (Type: recoverable)\\n\\n**Error**: Hydration failed"
  },
  {
    "id": "mcp.mdx#8",
    "metadata": {
      "title": "Enabling Next.js MCP Server for Coding Agents",
      "description": "Learn how to use Next.js MCP support to allow coding agents access to your application state"
    },
    "content": "```\n\n</details>"
  },
  {
    "id": "mcp.mdx#9",
    "metadata": {
      "title": "Enabling Next.js MCP Server for Coding Agents",
      "description": "Learn how to use Next.js MCP support to allow coding agents access to your application state"
    },
    "content": "### Upgrading and best practices\n\nGet help with Next.js concepts and migrations:\n\n```bash\nUser: \"Help me upgrade my Next.js app to version 16\"\n```\n\nThe agent will analyze your current version, guide you through automated migrations with codemods, and provide step-by-step instructions for handling breaking changes.\n\nAsk conceptual questions:\n\n```bash\nUser: \"When should I use 'use client' in App Router?\"\n```\n\nThe agent will query the Next.js knowledge base and provide documentation-backed explanations with examples from your codebase."
  },
  {
    "id": "mcp.mdx#10",
    "metadata": {
      "title": "Enabling Next.js MCP Server for Coding Agents",
      "description": "Learn how to use Next.js MCP support to allow coding agents access to your application state"
    },
    "content": "## How it works\n\nNext.js 16+ includes a built-in MCP endpoint at `/_next/mcp` that runs within your development server. The `next-devtools-mcp` package automatically discovers and communicates with these endpoints, allowing it to:\n\n- Connect to multiple Next.js instances running on different ports\n- Forward tool calls to the appropriate Next.js dev server\n- Provide a unified interface for coding agents\n\nThis architecture decouples the agent interface from the internal implementation, enabling `next-devtools-mcp` to work seamlessly across different Next.js projects.\n\n## Troubleshooting\n\n### MCP server not connecting\n\n- Ensure you're using Next.js v16 or above\n- Verify `next-devtools-mcp` is configured in your `.mcp.json`\n- Start your development server: `npm run dev`\n- Restart your development server if it was already running\n- Check that your coding agent has loaded the MCP server configuration"
  },
  {
    "id": "mdx.mdx#0",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "---\ntitle: How to use markdown and MDX in Next.js\nnav_title: MDX\ndescription: Learn how to configure MDX and use it in your Next.js apps.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n[Markdown](https://daringfireball.net/projects/markdown/syntax) is a lightweight markup language used to format text. It allows you to write using plain text syntax and convert it to structurally valid HTML. It's commonly used for writing content on websites and blogs.\n\nYou write...\n\n```md\nI **love** using [Next.js](https://nextjs.org/)\n```\n\nOutput:\n\n```html\n<p>I <strong>love</strong> using <a href=\"https://nextjs.org/\">Next.js</a></p>"
  },
  {
    "id": "mdx.mdx#1",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\nOutput:\n\n```html\n<p>I <strong>love</strong> using <a href=\"https://nextjs.org/\">Next.js</a></p>\n```\n\n[MDX](https://mdxjs.com/) is a superset of markdown that lets you write [JSX](https://react.dev/learn/writing-markup-with-jsx) directly in your markdown files. It is a powerful way to add dynamic interactivity and embed React components within your content.\n\nNext.js can support both local MDX content inside your application, as well as remote MDX files fetched dynamically on the server. The Next.js plugin handles transforming markdown and React components into HTML, including support for usage in Server Components (the default in App Router).\n\n> **Good to know**: View the [Portfolio Starter Kit](https://vercel.com/templates/next.js/portfolio-starter-kit) template for a complete working example."
  },
  {
    "id": "mdx.mdx#2",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "## Install dependencies\n\nThe `@next/mdx` package, and related packages, are used to configure Next.js so it can process markdown and MDX. **It sources data from local files**, allowing you to create pages with a `.md` or `.mdx` extension, directly in your `/pages` or `/app` directory.\n\nInstall these packages to render MDX with Next.js:\n\n```bash filename=\"Terminal\"\nnpm install @next/mdx @mdx-js/loader @mdx-js/react @types/mdx\n```"
  },
  {
    "id": "mdx.mdx#3",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "## Configure `next.config.mjs`\n\nUpdate the `next.config.mjs` file at your project's root to configure it to use MDX:\n\n```js filename=\"next.config.mjs\"\nimport createMDX from '@next/mdx'\n\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  // Configure `pageExtensions` to include markdown and MDX files\n  pageExtensions: ['js', 'jsx', 'md', 'mdx', 'ts', 'tsx'],\n  // Optionally, add any other Next.js config below\n}\n\nconst withMDX = createMDX({\n  // Add markdown plugins here, as desired\n})\n\n// Merge MDX config with Next.js config\nexport default withMDX(nextConfig)\n```\n\nThis allows `.mdx` files to act as pages, routes, or imports in your application.\n\n### Handling `.md` files\n\nBy default, `next/mdx` only compiles files with the `.mdx` extension. To handle `.md` files with webpack, update the `extension` option:\n\n```js filename=\"next.config.mjs\"\nconst withMDX = createMDX({\n  extension: /\\.(md|mdx)$/,\n})\n```"
  },
  {
    "id": "mdx.mdx#4",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "## Add an `mdx-components.tsx` file\n\nCreate an `mdx-components.tsx` (or `.js`) file in the root of your project to define global MDX Components. For example, at the same level as `pages` or `app`, or inside `src` if applicable.\n\n```tsx filename=\"mdx-components.tsx\" switcher\nimport type { MDXComponents } from 'mdx/types'\n\nconst components: MDXComponents = {}\n\nexport function useMDXComponents(): MDXComponents {\n  return components\n}\n```\n\n```js filename=\"mdx-components.js\" switcher\nconst components = {}\n\nexport function useMDXComponents() {\n  return components\n}\n```\n\n> **Good to know**:\n>\n> - `mdx-components.tsx` is **required** to use `@next/mdx` with App Router and will not work without it.\n> - Learn more about the [`mdx-components.tsx` file convention](/docs/app/api-reference/file-conventions/mdx-components).\n> - Learn how to [use custom styles and components](#using-custom-styles-and-components)."
  },
  {
    "id": "mdx.mdx#5",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "## Rendering MDX\n\nYou can render MDX using Next.js's file based routing or by importing MDX files into other pages.\n\n### Using file based routing\n\nWhen using file based routing, you can use MDX pages like any other page.\n\n<AppOnly>\n\nIn App Router apps, that includes being able to use [metadata](/docs/app/getting-started/metadata-and-og-images).\n\nCreate a new MDX page within the `/app` directory:\n\n```txt\n  my-project\n  ├── app\n  │   └── mdx-page\n  │       └── page.(mdx/md)\n  |── mdx-components.(tsx/js)\n  └── package.json\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nCreate a new MDX page within the `/pages` directory:\n\n```txt\n  my-project\n  |── mdx-components.(tsx/js)\n  ├── pages\n  │   └── mdx-page.(mdx/md)\n  └── package.json\n```\n\n</PagesOnly>\n\nYou can use MDX in these files, and even import React components, directly inside your MDX page:\n\n```mdx\nimport { MyComponent } from 'my-component'\n\n# Welcome to my MDX page!\n\nThis is some **bold** and _italics_ text.\n\nThis is a list in markdown:\n\n- One\n- Two\n- Three\n\nCheckout my React component:\n\n<MyComponent />\n```\n\nNavigating to the `/mdx-page` route should display your rendered MDX page."
  },
  {
    "id": "mdx.mdx#6",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "### Using imports\n\n<AppOnly>\n\nCreate a new page within the `/app` directory and an MDX file wherever you'd like:\n\n```txt\n  .\n  ├── app/\n  │   └── mdx-page/\n  │       └── page.(tsx/js)\n  ├── markdown/\n  │   └── welcome.(mdx/md)\n  ├── mdx-components.(tsx/js)\n  └── package.json\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nCreate a new page within the `/pages` directory and an MDX file wherever you'd like:\n\n```txt\n  .\n  ├── markdown/\n  │   └── welcome.(mdx/md)\n  ├── pages/\n  │   └── mdx-page.(tsx/js)\n  ├── mdx-components.(tsx/js)\n  └── package.json\n```\n\n</PagesOnly>\n\nYou can use MDX in these files, and even import React components, directly inside your MDX page:\n\n```mdx filename=\"markdown/welcome.mdx\" switcher\nimport { MyComponent } from 'my-component'\n\n# Welcome to my MDX page!\n\nThis is some **bold** and _italics_ text.\n\nThis is a list in markdown:\n\n- One\n- Two\n- Three\n\nCheckout my React component:\n\n<MyComponent />\n```\n\nImport the MDX file inside the page to display the content:\n\n<AppOnly>\n\n```tsx filename=\"app/mdx-page/page.tsx\" switcher\nimport Welcome from '@/markdown/welcome.mdx'\n\nexport default function Page() {\n  return <Welcome />\n}"
  },
  {
    "id": "mdx.mdx#7",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\n```jsx filename=\"app/mdx-page/page.js\" switcher\nimport Welcome from '@/markdown/welcome.mdx'\n\nexport default function Page() {\n  return <Welcome />\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/mdx-page.tsx\" switcher\nimport Welcome from '@/markdown/welcome.mdx'\n\nexport default function Page() {\n  return <Welcome />\n}\n```\n\n```jsx filename=\"pages/mdx-page.js\" switcher\nimport Welcome from '@/markdown/welcome.mdx'\n\nexport default function Page() {\n  return <Welcome />\n}\n```\n\n</PagesOnly>\n\nNavigating to the `/mdx-page` route should display your rendered MDX page.\n\n<AppOnly>"
  },
  {
    "id": "mdx.mdx#8",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "### Using dynamic imports\n\nYou can import dynamic MDX components instead of using filesystem routing for MDX files.\n\nFor example, you can have a dynamic route segment which loads MDX components from a separate directory:\n\n<Image\n  alt=\"Route segments for dynamic MDX components\"\n  srcLight=\"/docs/light/mdx-files.png\"\n  srcDark=\"/docs/dark/mdx-files.png\"\n  width=\"1600\"\n  height=\"849\"\n/>\n\n[`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params) can be used to prerender the provided routes. By marking `dynamicParams` as `false`, accessing a route not defined in `generateStaticParams` will 404.\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = await params\n  const { default: Post } = await import(`@/content/${slug}.mdx`)\n\n  return <Post />\n}\n\nexport function generateStaticParams() {\n  return [{ slug: 'welcome' }, { slug: 'about' }]\n}\n\nexport const dynamicParams = false"
  },
  {
    "id": "mdx.mdx#9",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nexport default async function Page({ params }) {\n  const { slug } = await params\n  const { default: Post } = await import(`@/content/${slug}.mdx`)\n\n  return <Post />\n}\n\nexport function generateStaticParams() {\n  return [{ slug: 'welcome' }, { slug: 'about' }]\n}\n\nexport const dynamicParams = false\n```\n\n> **Good to know**: Ensure you specify the `.mdx` file extension in your import. While it is not required to use [module path aliases](/docs/app/getting-started/installation#set-up-absolute-imports-and-module-path-aliases) (e.g., `@/content`), it does simplify your import path.\n\n</AppOnly>"
  },
  {
    "id": "mdx.mdx#10",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "## Using custom styles and components\n\nMarkdown, when rendered, maps to native HTML elements. For example, writing the following markdown:\n\n```md"
  },
  {
    "id": "mdx.mdx#11",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "## This is a heading\n\nThis is a list in markdown:\n\n- One\n- Two\n- Three\n```\n\nGenerates the following HTML:\n\n```html\n<h2>This is a heading</h2>\n\n<p>This is a list in markdown:</p>\n\n<ul>\n  <li>One</li>\n  <li>Two</li>\n  <li>Three</li>\n</ul>\n```\n\nTo style your markdown, you can provide custom components that map to the generated HTML elements. Styles and components can be implemented globally, locally, and with shared layouts."
  },
  {
    "id": "mdx.mdx#12",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "### Global styles and components\n\nAdding styles and components in `mdx-components.tsx` will affect _all_ MDX files in your application.\n\n```tsx filename=\"mdx-components.tsx\" switcher\nimport type { MDXComponents } from 'mdx/types'\nimport Image, { ImageProps } from 'next/image'\n\n// This file allows you to provide custom React components\n// to be used in MDX files. You can import and use any\n// React component you want, including inline styles,\n// components from other libraries, and more.\n\nconst components = {\n  // Allows customizing built-in components, e.g. to add styling.\n  h1: ({ children }) => (\n    <h1 style={{ color: 'red', fontSize: '48px' }}>{children}</h1>\n  ),\n  img: (props) => (\n    <Image\n      sizes=\"100vw\"\n      style={{ width: '100%', height: 'auto' }}\n      {...(props as ImageProps)}\n    />\n  ),\n} satisfies MDXComponents\n\nexport function useMDXComponents(): MDXComponents {\n  return components\n}"
  },
  {
    "id": "mdx.mdx#13",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\n```js filename=\"mdx-components.js\" switcher\nimport Image from 'next/image'\n\n// This file allows you to provide custom React components\n// to be used in MDX files. You can import and use any\n// React component you want, including inline styles,\n// components from other libraries, and more.\n\nconst components = {\n  // Allows customizing built-in components, e.g. to add styling.\n  h1: ({ children }) => (\n    <h1 style={{ color: 'red', fontSize: '48px' }}>{children}</h1>\n  ),\n  img: (props) => (\n    <Image sizes=\"100vw\" style={{ width: '100%', height: 'auto' }} {...props} />\n  ),\n}\n\nexport function useMDXComponents() {\n  return components\n}\n```"
  },
  {
    "id": "mdx.mdx#14",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "### Local styles and components\n\nYou can apply local styles and components to specific pages by passing them into imported MDX components. These will merge with and override [global styles and components](#global-styles-and-components).\n\n<AppOnly>\n\n```tsx filename=\"app/mdx-page/page.tsx\" switcher\nimport Welcome from '@/markdown/welcome.mdx'\n\nfunction CustomH1({ children }) {\n  return <h1 style={{ color: 'blue', fontSize: '100px' }}>{children}</h1>\n}\n\nconst overrideComponents = {\n  h1: CustomH1,\n}\n\nexport default function Page() {\n  return <Welcome components={overrideComponents} />\n}\n```\n\n```jsx filename=\"app/mdx-page/page.js\" switcher\nimport Welcome from '@/markdown/welcome.mdx'\n\nfunction CustomH1({ children }) {\n  return <h1 style={{ color: 'blue', fontSize: '100px' }}>{children}</h1>\n}\n\nconst overrideComponents = {\n  h1: CustomH1,\n}\n\nexport default function Page() {\n  return <Welcome components={overrideComponents} />\n}"
  },
  {
    "id": "mdx.mdx#15",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/mdx-page.tsx\" switcher\nimport Welcome from '@/markdown/welcome.mdx'\n\nfunction CustomH1({ children }) {\n  return <h1 style={{ color: 'blue', fontSize: '100px' }}>{children}</h1>\n}\n\nconst overrideComponents = {\n  h1: CustomH1,\n}\n\nexport default function Page() {\n  return <Welcome components={overrideComponents} />\n}\n```\n\n```jsx filename=\"pages/mdx-page.js\" switcher\nimport Welcome from '@/markdown/welcome.mdx'\n\nfunction CustomH1({ children }) {\n  return <h1 style={{ color: 'blue', fontSize: '100px' }}>{children}</h1>\n}\n\nconst overrideComponents = {\n  h1: CustomH1,\n}\n\nexport default function Page() {\n  return <Welcome components={overrideComponents} />\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "mdx.mdx#16",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "### Shared layouts\n\n<AppOnly>\n\nTo share a layout across MDX pages, you can use the [built-in layouts support](/docs/app/api-reference/file-conventions/layout) with the App Router.\n\n```tsx filename=\"app/mdx-page/layout.tsx\" switcher\nexport default function MdxLayout({ children }: { children: React.ReactNode }) {\n  // Create any shared layout or styles here\n  return <div style={{ color: 'blue' }}>{children}</div>\n}\n```\n\n```jsx filename=\"app/mdx-page/layout.js\" switcher\nexport default function MdxLayout({ children }) {\n  // Create any shared layout or styles here\n  return <div style={{ color: 'blue' }}>{children}</div>\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nTo share a layout around MDX pages, create a layout component:\n\n```tsx filename=\"components/mdx-layout.tsx\" switcher\nexport default function MdxLayout({ children }: { children: React.ReactNode }) {\n  // Create any shared layout or styles here\n  return <div style={{ color: 'blue' }}>{children}</div>\n}\n```\n\n```jsx filename=\"components/mdx-layout.js\" switcher\nexport default function MdxLayout({ children }) {\n  // Create any shared layout or styles here\n  return <div style={{ color: 'blue' }}>{children}</div>\n}"
  },
  {
    "id": "mdx.mdx#17",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\nThen, import the layout component into the MDX page, wrap the MDX content in the layout, and export it:\n\n```mdx\nimport MdxLayout from '../components/mdx-layout'\n\n# Welcome to my MDX page!\n\nexport default function MDXPage({ children }) {\n  return <MdxLayout>{children}</MdxLayout>\n\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "mdx.mdx#18",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "### Using Tailwind typography plugin\n\nIf you are using [Tailwind](https://tailwindcss.com) to style your application, using the [`@tailwindcss/typography` plugin](https://tailwindcss.com/docs/plugins#typography) will allow you to reuse your Tailwind configuration and styles in your markdown files.\n\nThe plugin adds a set of `prose` classes that can be used to add typographic styles to content blocks that come from sources, like markdown.\n\n[Install Tailwind typography](https://github.com/tailwindlabs/tailwindcss-typography?tab=readme-ov-file#installation) and use with [shared layouts](#shared-layouts) to add the `prose` you want.\n\n<AppOnly>\n\n```tsx filename=\"app/mdx-page/layout.tsx\" switcher\nexport default function MdxLayout({ children }: { children: React.ReactNode }) {\n  // Create any shared layout or styles here\n  return (\n    <div className=\"prose prose-headings:mt-8 prose-headings:font-semibold prose-headings:text-black prose-h1:text-5xl prose-h2:text-4xl prose-h3:text-3xl prose-h4:text-2xl prose-h5:text-xl prose-h6:text-lg dark:prose-headings:text-white\">\n      {children}\n    </div>\n  )\n}"
  },
  {
    "id": "mdx.mdx#19",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\n```jsx filename=\"app/mdx-page/layout.js\" switcher\nexport default function MdxLayout({ children }) {\n  // Create any shared layout or styles here\n  return (\n    <div className=\"prose prose-headings:mt-8 prose-headings:font-semibold prose-headings:text-black prose-h1:text-5xl prose-h2:text-4xl prose-h3:text-3xl prose-h4:text-2xl prose-h5:text-xl prose-h6:text-lg dark:prose-headings:text-white\">\n      {children}\n    </div>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nTo share a layout around MDX pages, create a layout component:\n\n```tsx filename=\"components/mdx-layout.tsx\" switcher\nexport default function MdxLayout({ children }: { children: React.ReactNode }) {\n  // Create any shared layout or styles here\n  return (\n    <div className=\"prose prose-headings:mt-8 prose-headings:font-semibold prose-headings:text-black prose-h1:text-5xl prose-h2:text-4xl prose-h3:text-3xl prose-h4:text-2xl prose-h5:text-xl prose-h6:text-lg dark:prose-headings:text-white\">\n      {children}\n    </div>\n  )\n}"
  },
  {
    "id": "mdx.mdx#20",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\n```jsx filename=\"components/mdx-layout.js\" switcher\nexport default function MdxLayout({ children }) {\n  // Create any shared layout or styles here\n  return (\n    <div className=\"prose prose-headings:mt-8 prose-headings:font-semibold prose-headings:text-black prose-h1:text-5xl prose-h2:text-4xl prose-h3:text-3xl prose-h4:text-2xl prose-h5:text-xl prose-h6:text-lg dark:prose-headings:text-white\">\n      {children}\n    </div>\n  )\n}\n```\n\nThen, import the layout component into the MDX page, wrap the MDX content in the layout, and export it:\n\n```mdx\nimport MdxLayout from '../components/mdx-layout'\n\n# Welcome to my MDX page!\n\nexport default function MDXPage({ children }) {\n  return <MdxLayout>{children}</MdxLayout>\n\n}\n```\n\n</PagesOnly >"
  },
  {
    "id": "mdx.mdx#21",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "## Frontmatter\n\nFrontmatter is a YAML like key/value pairing that can be used to store data about a page. `@next/mdx` does **not** support frontmatter by default, though there are many solutions for adding frontmatter to your MDX content, such as:\n\n- [remark-frontmatter](https://github.com/remarkjs/remark-frontmatter)\n- [remark-mdx-frontmatter](https://github.com/remcohaszing/remark-mdx-frontmatter)\n- [gray-matter](https://github.com/jonschlinkert/gray-matter)\n\n`@next/mdx` **does** allow you to use exports like any other JavaScript component:\n\n```mdx filename=\"content/blog-post.mdx\" switcher\nexport const metadata = {\n  author: 'John Doe',\n}\n\n# Blog post\n```\n\nMetadata can now be referenced outside of the MDX file:\n\n<AppOnly>\n\n```tsx filename=\"app/blog/page.tsx\" switcher\nimport BlogPost, { metadata } from '@/content/blog-post.mdx'\n\nexport default function Page() {\n  console.log('metadata: ', metadata)\n  //=> { author: 'John Doe' }\n  return <BlogPost />\n}"
  },
  {
    "id": "mdx.mdx#22",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\n```jsx filename=\"app/blog/page.js\" switcher\nimport BlogPost, { metadata } from '@/content/blog-post.mdx'\n\nexport default function Page() {\n  console.log('metadata: ', metadata)\n  //=> { author: 'John Doe' }\n  return <BlogPost />\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/blog.tsx\" switcher\nimport BlogPost, { metadata } from '@/content/blog-post.mdx'\n\nexport default function Page() {\n  console.log('metadata: ', metadata)\n  //=> { author: 'John Doe' }\n  return <BlogPost />\n}\n```\n\n```jsx filename=\"pages/blog.js\" switcher\nimport BlogPost, { metadata } from '@/content/blog-post.mdx'\n\nexport default function Page() {\n  console.log('metadata: ', metadata)\n  //=> { author: 'John Doe' }\n  return <BlogPost />\n}"
  },
  {
    "id": "mdx.mdx#23",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\n</PagesOnly>\n\nA common use case for this is when you want to iterate over a collection of MDX and extract data. For example, creating a blog index page from all blog posts. You can use packages like [Node's `fs` module](https://nodejs.org/api/fs.html) or [globby](https://www.npmjs.com/package/globby) to read a directory of posts and extract the metadata.\n\n> **Good to know**:\n>\n> - Using `fs`, `globby`, etc. can only be used server-side.\n> - View the [Portfolio Starter Kit](https://vercel.com/templates/next.js/portfolio-starter-kit) template for a complete working example."
  },
  {
    "id": "mdx.mdx#24",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "## remark and rehype Plugins\n\nYou can optionally provide remark and rehype plugins to transform the MDX content.\n\nFor example, you can use [`remark-gfm`](https://github.com/remarkjs/remark-gfm) to support GitHub Flavored Markdown.\n\nSince the remark and rehype ecosystem is ESM only, you'll need to use `next.config.mjs` or `next.config.ts` as the configuration file.\n\n```js filename=\"next.config.mjs\"\nimport remarkGfm from 'remark-gfm'\nimport createMDX from '@next/mdx'\n\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  // Allow .mdx extensions for files\n  pageExtensions: ['js', 'jsx', 'md', 'mdx', 'ts', 'tsx'],\n  // Optionally, add any other Next.js config below\n}\n\nconst withMDX = createMDX({\n  // Add markdown plugins here, as desired\n  options: {\n    remarkPlugins: [remarkGfm],\n    rehypePlugins: [],\n  },\n})\n\n// Combine MDX and Next.js config\nexport default withMDX(nextConfig)\n```"
  },
  {
    "id": "mdx.mdx#25",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "### Using Plugins with Turbopack\n\nTo use plugins with [Turbopack](/docs/app/api-reference/turbopack), upgrade to the latest `@next/mdx` and specify plugin names using a string:\n\n```js filename=\"next.config.mjs\"\nimport createMDX from '@next/mdx'\n\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  pageExtensions: ['js', 'jsx', 'md', 'mdx', 'ts', 'tsx'],\n}\n\nconst withMDX = createMDX({\n  options: {\n    remarkPlugins: [\n      // Without options\n      'remark-gfm',\n      // With options\n      ['remark-toc', { heading: 'The Table' }],\n    ],\n    rehypePlugins: [\n      // Without options\n      'rehype-slug',\n      // With options\n      ['rehype-katex', { strict: true, throwOnError: true }],\n    ],\n  },\n})\n\nexport default withMDX(nextConfig)\n```\n\n> **Good to know**:\n>\n> remark and rehype plugins without serializable options cannot be used yet with [Turbopack](/docs/app/api-reference/turbopack), because JavaScript functions can't be passed to Rust."
  },
  {
    "id": "mdx.mdx#26",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "## Remote MDX\n\nIf your MDX files or content lives _somewhere else_, you can fetch it dynamically on the server. This is useful for content stored in a CMS, database, or anywhere else. A community package for this use is [`next-mdx-remote-client`](https://github.com/ipikuka/next-mdx-remote-client?tab=readme-ov-file#the-part-associated-with-nextjs-app-router).\n\n> **Good to know**: Please proceed with caution. MDX compiles to JavaScript and is executed on the server. You should only fetch MDX content from a trusted source, otherwise this can lead to remote code execution (RCE).\n\nThe following example uses `next-mdx-remote-client`:\n\n<AppOnly>\n\n```tsx filename=\"app/mdx-page-remote/page.tsx\" switcher\nimport { MDXRemote } from 'next-mdx-remote-client/rsc'\n\nexport default async function RemoteMdxPage() {\n  // MDX text - can be from a database, CMS, fetch, anywhere...\n  const res = await fetch('https://...')\n  const markdown = await res.text()\n  return <MDXRemote source={markdown} />\n}"
  },
  {
    "id": "mdx.mdx#27",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\n```jsx filename=\"app/mdx-page-remote/page.js\" switcher\nimport { MDXRemote } from 'next-mdx-remote-client/rsc'\n\nexport default async function RemoteMdxPage() {\n  // MDX text - can be from a database, CMS, fetch, anywhere...\n  const res = await fetch('https://...')\n  const markdown = await res.text()\n  return <MDXRemote source={markdown} />\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/mdx-page-remote.tsx\" switcher\nimport {\n  serialize,\n  type SerializeResult,\n} from 'next-mdx-remote-client/serialize'\nimport { MDXClient } from 'next-mdx-remote-client'\n\ntype Props = {\n  mdxSource: SerializeResult\n}\n\nexport default function RemoteMdxPage({ mdxSource }: Props) {\n  if ('error' in mdxSource) {\n    // either render error UI or throw `mdxSource.error`\n  }\n  return <MDXClient {...mdxSource} />\n}\n\nexport async function getStaticProps() {\n  // MDX text - can be from a database, CMS, fetch, anywhere...\n  const res = await fetch('https:...')\n  const mdxText = await res.text()\n  const mdxSource = await serialize({ source: mdxText })\n  return { props: { mdxSource } }\n}"
  },
  {
    "id": "mdx.mdx#28",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\n```jsx filename=\"pages/mdx-page-remote.js\" switcher\nimport { serialize } from 'next-mdx-remote-client/serialize'\nimport { MDXClient } from 'next-mdx-remote-client'\n\nexport default function RemoteMdxPage({ mdxSource }) {\n  if ('error' in mdxSource) {\n    // either render error UI or throw `mdxSource.error`\n  }\n  return <MDXClient {...mdxSource} />\n}\n\nexport async function getStaticProps() {\n  // MDX text - can be from a database, CMS, fetch, anywhere...\n  const res = await fetch('https:...')\n  const mdxText = await res.text()\n  const mdxSource = await serialize({ source: mdxText })\n  return { props: { mdxSource } }\n}\n```\n\n</PagesOnly>\n\nNavigating to the `/mdx-page-remote` route should display your rendered MDX."
  },
  {
    "id": "mdx.mdx#29",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "## Deep Dive: How do you transform markdown into HTML?\n\nReact does not natively understand markdown. The markdown plaintext needs to first be transformed into HTML. This can be accomplished with `remark` and `rehype`.\n\n`remark` is an ecosystem of tools around markdown. `rehype` is the same, but for HTML. For example, the following code snippet transforms markdown into HTML:\n\n```js\nimport { unified } from 'unified'\nimport remarkParse from 'remark-parse'\nimport remarkRehype from 'remark-rehype'\nimport rehypeSanitize from 'rehype-sanitize'\nimport rehypeStringify from 'rehype-stringify'\n\nmain()\n\nasync function main() {\n  const file = await unified()\n    .use(remarkParse) // Convert into markdown AST\n    .use(remarkRehype) // Transform to HTML AST\n    .use(rehypeSanitize) // Sanitize HTML input\n    .use(rehypeStringify) // Convert AST into serialized HTML\n    .process('Hello, Next.js!')\n\n  console.log(String(file)) // <p>Hello, Next.js!</p>\n}"
  },
  {
    "id": "mdx.mdx#30",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "```\n\nThe `remark` and `rehype` ecosystem contains plugins for [syntax highlighting](https://github.com/atomiks/rehype-pretty-code), [linking headings](https://github.com/rehypejs/rehype-autolink-headings), [generating a table of contents](https://github.com/remarkjs/remark-toc), and more.\n\nWhen using `@next/mdx` as shown above, you **do not** need to use `remark` or `rehype` directly, as it is handled for you. We're describing it here for a deeper understanding of what the `@next/mdx` package is doing underneath."
  },
  {
    "id": "mdx.mdx#31",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX and use it in your Next.js apps."
    },
    "content": "## Using the Rust-based MDX compiler (experimental)\n\nNext.js supports a new MDX compiler written in Rust. This compiler is still experimental and is not recommended for production use. To use the new compiler, you need to configure `next.config.js` when you pass it to `withMDX`:\n\n```js filename=\"next.config.js\"\nmodule.exports = withMDX({\n  experimental: {\n    mdxRs: true,\n  },\n})\n```\n\n`mdxRs` also accepts an object to configure how to transform mdx files.\n\n```js filename=\"next.config.js\"\nmodule.exports = withMDX({\n  experimental: {\n    mdxRs: {\n      jsxRuntime?: string            // Custom jsx runtime\n      jsxImportSource?: string       // Custom jsx import source,\n      mdxType?: 'gfm' | 'commonmark' // Configure what kind of mdx syntax will be used to parse & transform\n    },\n  },\n})\n```\n\n## Helpful Links\n\n- [MDX](https://mdxjs.com)\n- [`@next/mdx`](https://www.npmjs.com/package/@next/mdx)\n- [remark](https://github.com/remarkjs/remark)\n- [rehype](https://github.com/rehypejs/rehype)\n- [Markdoc](https://markdoc.dev/docs/nextjs)"
  },
  {
    "id": "memory-usage.mdx#0",
    "metadata": {
      "title": "How to optimize memory usage",
      "description": "Optimize memory used by your application in development and production."
    },
    "content": "---\ntitle: How to optimize memory usage\nnav_title: Memory Usage\ndescription: Optimize memory used by your application in development and production.\n---\n\nAs applications grow and become more feature rich, they can demand more resources when developing locally or creating production builds.\n\nLet's explore some strategies and techniques to optimize memory and address common memory issues in Next.js.\n\n## Reduce number of dependencies\n\nApplications with a large amount of dependencies will use more memory.\n\nThe [Bundle Analyzer](/docs/app/guides/package-bundling) can help you investigate large dependencies in your application that may be able to be removed to improve performance and memory usage.\n\n## Try `experimental.webpackMemoryOptimizations`\n\nStarting in `v15.0.0`, you can add `experimental.webpackMemoryOptimizations: true` to your `next.config.js` file to change behavior in Webpack that reduces max memory usage but may increase compilation times by a slight amount.\n\n> **Good to know**: This feature is currently experimental to test on more projects first, but it is considered to be low-risk."
  },
  {
    "id": "memory-usage.mdx#1",
    "metadata": {
      "title": "How to optimize memory usage",
      "description": "Optimize memory used by your application in development and production."
    },
    "content": "## Run `next build` with `--experimental-debug-memory-usage`\n\nStarting in `14.2.0`, you can run `next build --experimental-debug-memory-usage` to run the build in a mode where Next.js will print out information about memory usage continuously throughout the build, such as heap usage and garbage collection statistics. Heap snapshots will also be taken automatically when memory usage gets close to the configured limit.\n\n> **Good to know**: This feature is not compatible with the Webpack build worker option which is auto-enabled unless you have custom webpack config.\n\n## Record a heap profile\n\nTo look for memory issues, you can record a heap profile from Node.js and load it in Chrome DevTools to identify potential sources of memory leaks.\n\nIn your terminal, pass the `--heap-prof` flag to Node.js when starting your Next.js build:\n\n```sh\nnode --heap-prof node_modules/next/dist/bin/next build\n```\n\nAt the end of the build, a `.heapprofile` file will be created by Node.js.\n\nIn Chrome DevTools, you can open the Memory tab and click on the \"Load Profile\" button to visualize the file."
  },
  {
    "id": "memory-usage.mdx#2",
    "metadata": {
      "title": "How to optimize memory usage",
      "description": "Optimize memory used by your application in development and production."
    },
    "content": "## Analyze a snapshot of the heap\n\nYou can use an inspector tool to analyze the memory usage of the application.\n\nWhen running the `next build` or `next dev` command, add `NODE_OPTIONS=--inspect` to the beginning of the command. This will expose the inspector agent on the default port.\nIf you wish to break before any user code starts, you can pass `--inspect-brk` instead. While the process is running, you can use a tool such as Chrome DevTools to connect to the debugging port to record and analyze a snapshot of the heap to see what memory is being retained.\n\nStarting in `14.2.0`, you can also run `next build` with the `--experimental-debug-memory-usage` flag to make it easier to take heap snapshots.\n\nWhile running in this mode, you can send a `SIGUSR2` signal to the process at any point, and the process will take a heap snapshot.\n\nThe heap snapshot will be saved to the project root of the Next.js application and can be loaded in any heap analyzer, such as Chrome DevTools, to see what memory is retained. This mode is not yet compatible with Webpack build workers."
  },
  {
    "id": "memory-usage.mdx#3",
    "metadata": {
      "title": "How to optimize memory usage",
      "description": "Optimize memory used by your application in development and production."
    },
    "content": "See [how to record and analyze heap snapshots](https://developer.chrome.com/docs/devtools/memory-problems/heap-snapshots) for more information."
  },
  {
    "id": "memory-usage.mdx#4",
    "metadata": {
      "title": "How to optimize memory usage",
      "description": "Optimize memory used by your application in development and production."
    },
    "content": "## Webpack build worker\n\nThe Webpack build worker allows you to run Webpack compilations inside a separate Node.js worker which will decrease memory usage of your application during builds.\n\nThis option is enabled by default if your application does not have a custom Webpack configuration starting in `v14.1.0`.\n\nIf you are using an older version of Next.js or you have a custom Webpack configuration, you can enable this option by setting `experimental.webpackBuildWorker: true` inside your `next.config.js`.\n\n> **Good to know**: This feature may not be compatible with all custom Webpack plugins."
  },
  {
    "id": "memory-usage.mdx#5",
    "metadata": {
      "title": "How to optimize memory usage",
      "description": "Optimize memory used by your application in development and production."
    },
    "content": "## Disable Webpack cache\n\nThe [Webpack cache](https://webpack.js.org/configuration/cache/) saves generated Webpack modules in memory and/or to disk to improve the speed of builds. This can\nhelp with performance, but it will also increase the memory usage of your application to store the cached data.\n\nYou can disable this behavior by adding a [custom Webpack configuration](/docs/app/api-reference/config/next-config-js/webpack) to your application:\n\n```js filename=\"next.config.mjs\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  webpack: (\n    config,\n    { buildId, dev, isServer, defaultLoaders, nextRuntime, webpack }\n  ) => {\n    if (config.cache && !dev) {\n      config.cache = Object.freeze({\n        type: 'memory',\n      })\n    }\n    // Important: return the modified config\n    return config\n  },\n}\n\nexport default nextConfig\n```"
  },
  {
    "id": "memory-usage.mdx#6",
    "metadata": {
      "title": "How to optimize memory usage",
      "description": "Optimize memory used by your application in development and production."
    },
    "content": "## Disable static analysis\n\nTypechecking may require a lot of memory, especially in large projects.\nHowever, most projects have a dedicated CI runner that already handles these tasks.\nWhen the build produces out-of-memory issues during the \"Running TypeScript\" step, you can disable this task during builds:\n\n```js filename=\"next.config.mjs\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  typescript: {\n    // !! WARN !!\n    // Dangerously allow production builds to successfully complete even if\n    // your project has type errors.\n    // !! WARN !!\n    ignoreBuildErrors: true,\n  },\n}\n\nexport default nextConfig\n```\n\n- [Ignoring TypeScript Errors](/docs/app/api-reference/config/typescript#disabling-typescript-errors-in-production)\n\nKeep in mind that this may produce faulty deploys due to type errors.\nWe strongly recommend only promoting builds to production after static analysis has completed.\nIf you deploy to Vercel, you can check out the [guide for staging deployments](https://vercel.com/docs/deployments/managing-deployments#staging-and-promoting-a-production-deployment) to learn how to promote builds to production after custom tasks have succeeded."
  },
  {
    "id": "memory-usage.mdx#7",
    "metadata": {
      "title": "How to optimize memory usage",
      "description": "Optimize memory used by your application in development and production."
    },
    "content": "## Disable source maps\n\nGenerating source maps consumes extra memory during the build process.\n\nYou can disable source map generation by adding `productionBrowserSourceMaps: false` and `experimental.serverSourceMaps: false` to your Next.js configuration.\n\nWhen using the `cacheComponents` feature, Next.js will use source maps by default during the prerender phase of `next build`.\nIf you consistently encounter memory issues during that phase (after \"Generating static pages\"),\nyou can try disabling source maps in that phase by adding `enablePrerenderSourceMaps: false` to your Next.js configuration.\n\n> **Good to know**: Some plugins may turn on source maps and may require custom configuration to disable.\n\n## Edge memory issues\n\nNext.js `v14.1.3` fixed a memory issue when using the Edge runtime. Please update to this version (or later) to see if it addresses your issue."
  },
  {
    "id": "memory-usage.mdx#8",
    "metadata": {
      "title": "How to optimize memory usage",
      "description": "Optimize memory used by your application in development and production."
    },
    "content": "## Edge memory issues\n\nNext.js `v14.1.3` fixed a memory issue when using the Edge runtime. Please update to this version (or later) to see if it addresses your issue.\n\n## Preloading Entries\n\nWhen the Next.js server starts, it preloads each page's JavaScript modules into memory, rather than at request time.\n\nThis optimization allows for faster response times, in exchange for a larger initial memory footprint.\n\nTo disable this optimization, set the `experimental.preloadEntriesOnStart` flag to `false`.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst config: NextConfig = {\n  experimental: {\n    preloadEntriesOnStart: false,\n  },\n}\n\nexport default config\n```\n\n```js filename=\"next.config.mjs\" switcher\n/** @type {import('next').NextConfig} */\nconst config = {\n  experimental: {\n    preloadEntriesOnStart: false,\n  },\n}\n\nexport default config\n```\n\nNext.js doesn't unload these JavaScript modules, meaning that even with this optimization disabled, the memory footprint of your Next.js server will eventually be the same if all pages are eventually requested."
  },
  {
    "id": "app-router-migration.mdx#0",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "---\ntitle: How to migrate from Pages to the App Router\nnav_title: App Router\ndescription: Learn how to upgrade your existing Next.js application from the Pages Router to the App Router.\n---\n\nThis guide will help you:\n\n- [Update your Next.js application from version 12 to version 13](#nextjs-version)\n- [Upgrade features that work in both the `pages` and the `app` directories](#upgrading-new-features)\n- [Incrementally migrate your existing application from `pages` to `app`](#migrating-from-pages-to-app)"
  },
  {
    "id": "app-router-migration.mdx#1",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "## Upgrading\n\n### Node.js Version\n\nThe minimum Node.js version is now **v18.17**. See the [Node.js documentation](https://nodejs.org/docs/latest-v18.x/api/) for more information.\n\n### Next.js Version\n\nTo update to Next.js version 13, run the following command using your preferred package manager:\n\n```bash filename=\"Terminal\"\nnpm install next@latest react@latest react-dom@latest\n```\n\n### ESLint Version\n\nIf you're using ESLint, you need to upgrade your ESLint version:\n\n```bash filename=\"Terminal\"\nnpm install -D eslint-config-next@latest\n```\n\n> **Good to know**: You may need to restart the ESLint server in VS Code for the ESLint changes to take effect. Open the Command Palette (`cmd+shift+p` on Mac; `ctrl+shift+p` on Windows) and search for `ESLint: Restart ESLint Server`.\n\n## Next Steps\n\nAfter you've updated, see the following sections for next steps:\n\n- [Upgrade new features](#upgrading-new-features): A guide to help you upgrade to new features such as the improved Image and Link Components.\n- [Migrate from the `pages` to `app` directory](#migrating-from-pages-to-app): A step-by-step guide to help you incrementally migrate from the `pages` to the `app` directory."
  },
  {
    "id": "app-router-migration.mdx#2",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "## Upgrading New Features\n\nNext.js 13 introduced the new [App Router](/docs/app) with new features and conventions. The new Router is available in the `app` directory and co-exists with the `pages` directory.\n\nUpgrading to Next.js 13 does **not** require using the App Router. You can continue using `pages` with new features that work in both directories, such as the updated [Image component](#image-component), [Link component](#link-component), [Script component](#script-component), and [Font optimization](#font-optimization)."
  },
  {
    "id": "app-router-migration.mdx#3",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "### `<Image/>` Component\n\nNext.js 12 introduced new improvements to the Image Component with a temporary import: `next/future/image`. These improvements included less client-side JavaScript, easier ways to extend and style images, better accessibility, and native browser lazy loading.\n\nIn version 13, this new behavior is now the default for `next/image`.\n\nThere are two codemods to help you migrate to the new Image Component:\n\n- [**`next-image-to-legacy-image` codemod**](/docs/app/guides/upgrading/codemods#next-image-to-legacy-image): Safely and automatically renames `next/image` imports to `next/legacy/image`. Existing components will maintain the same behavior.\n- [**`next-image-experimental` codemod**](/docs/app/guides/upgrading/codemods#next-image-experimental): Dangerously adds inline styles and removes unused props. This will change the behavior of existing components to match the new defaults. To use this codemod, you need to run the `next-image-to-legacy-image` codemod first."
  },
  {
    "id": "app-router-migration.mdx#4",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "### `<Link>` Component\n\nThe [`<Link>` Component](/docs/app/api-reference/components/link) no longer requires manually adding an `<a>` tag as a child. This behavior was added as an experimental option in [version 12.2](https://nextjs.org/blog/next-12-2) and is now the default. In Next.js 13, `<Link>` always renders `<a>` and allows you to forward props to the underlying tag.\n\nFor example:\n\n```jsx\nimport Link from 'next/link'\n\n// Next.js 12: `<a>` has to be nested otherwise it's excluded\n<Link href=\"/about\">\n  <a>About</a>\n</Link>\n\n// Next.js 13: `<Link>` always renders `<a>` under the hood\n<Link href=\"/about\">\n  About\n</Link>\n```\n\nTo upgrade your links to Next.js 13, you can use the [`new-link` codemod](/docs/app/guides/upgrading/codemods#new-link)."
  },
  {
    "id": "app-router-migration.mdx#5",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "### `<Script>` Component\n\nThe behavior of [`next/script`](/docs/app/api-reference/components/script) has been updated to support both `pages` and `app`, but some changes need to be made to ensure a smooth migration:\n\n- Move any `beforeInteractive` scripts you previously included in `_document.js` to the root layout file (`app/layout.tsx`).\n- The experimental `worker` strategy does not yet work in `app` and scripts denoted with this strategy will either have to be removed or modified to use a different strategy (e.g. `lazyOnload`).\n- `onLoad`, `onReady`, and `onError` handlers will not work in Server Components so make sure to move them to a [Client Component](/docs/app/getting-started/server-and-client-components) or remove them altogether."
  },
  {
    "id": "app-router-migration.mdx#6",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "### Font Optimization\n\nPreviously, Next.js helped you optimize fonts by [inlining font CSS](/docs/app/api-reference/components/font). Version 13 introduces the new [`next/font`](/docs/app/api-reference/components/font) module which gives you the ability to customize your font loading experience while still ensuring great performance and privacy. `next/font` is supported in both the `pages` and `app` directories.\n\nWhile [inlining CSS](/docs/app/api-reference/components/font) still works in `pages`, it does not work in `app`. You should use [`next/font`](/docs/app/api-reference/components/font) instead.\n\nSee the [Font Optimization](/docs/app/api-reference/components/font) page to learn how to use `next/font`."
  },
  {
    "id": "app-router-migration.mdx#7",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "## Migrating from `pages` to `app`\n\n> **🎥 Watch:** Learn how to incrementally adopt the App Router → [YouTube (16 minutes)](https://www.youtube.com/watch?v=YQMSietiFm0).\n\nMoving to the App Router may be the first time using React features that Next.js builds on top of such as Server Components, Suspense, and more. When combined with new Next.js features such as [special files](/docs/app/api-reference/file-conventions) and [layouts](/docs/app/api-reference/file-conventions/layout), migration means new concepts, mental models, and behavioral changes to learn.\n\nWe recommend reducing the combined complexity of these updates by breaking down your migration into smaller steps. The `app` directory is intentionally designed to work simultaneously with the `pages` directory to allow for incremental page-by-page migration."
  },
  {
    "id": "app-router-migration.mdx#8",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "- The `app` directory supports nested routes _and_ layouts. [Learn more](/docs/app/getting-started/layouts-and-pages).\n- Use nested folders to define routes and a special `page.js` file to make a route segment publicly accessible. [Learn more](#step-4-migrating-pages).\n- [Special file conventions](/docs/app/api-reference/file-conventions) are used to create UI for each route segment. The most common special files are `page.js` and `layout.js`.\n  - Use `page.js` to define UI unique to a route.\n  - Use `layout.js` to define UI that is shared across multiple routes.\n  - `.js`, `.jsx`, or `.tsx` file extensions can be used for special files.\n- You can colocate other files inside the `app` directory such as components, styles, tests, and more. [Learn more](/docs/app).\n- Data fetching functions like `getServerSideProps` and `getStaticProps` have been replaced with [a new API](/docs/app/getting-started/fetching-data) inside `app`. `getStaticPaths` has been replaced with [`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params)."
  },
  {
    "id": "app-router-migration.mdx#9",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "- `pages/_app.js` and `pages/_document.js` have been replaced with a single `app/layout.js` root layout. [Learn more](/docs/app/api-reference/file-conventions/layout#root-layout).\n- `pages/_error.js` has been replaced with more granular `error.js` special files. [Learn more](/docs/app/getting-started/error-handling).\n- `pages/404.js` has been replaced with the [`not-found.js`](/docs/app/api-reference/file-conventions/not-found) file.\n- `pages/api/*` API Routes have been replaced with the [`route.js`](/docs/app/api-reference/file-conventions/route) (Route Handler) special file."
  },
  {
    "id": "app-router-migration.mdx#10",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "### Step 1: Creating the `app` directory\n\nUpdate to the latest Next.js version (requires 13.4 or greater):\n\n```bash\nnpm install next@latest\n```\n\nThen, create a new `app` directory at the root of your project (or `src/` directory)."
  },
  {
    "id": "app-router-migration.mdx#11",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "### Step 2: Creating a Root Layout\n\nCreate a new `app/layout.tsx` file inside the `app` directory. This is a [root layout](/docs/app/api-reference/file-conventions/layout#root-layout) that will apply to all routes inside `app`.\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  // Layouts must accept a children prop.\n  // This will be populated with nested layouts or pages\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({\n  // Layouts must accept a children prop.\n  // This will be populated with nested layouts or pages\n  children,\n}) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "app-router-migration.mdx#12",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\n- The `app` directory **must** include a root layout.\n- The root layout must define `<html>`, and `<body>` tags since Next.js does not automatically create them\n- The root layout replaces the `pages/_app.tsx` and `pages/_document.tsx` files.\n- `.js`, `.jsx`, or `.tsx` extensions can be used for layout files.\n\nTo manage `<head>` HTML elements, you can use the [built-in SEO support](/docs/app/getting-started/metadata-and-og-images):\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: 'Home',\n  description: 'Welcome to Next.js',\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport const metadata = {\n  title: 'Home',\n  description: 'Welcome to Next.js',\n}\n```"
  },
  {
    "id": "app-router-migration.mdx#13",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "#### Migrating `_document.js` and `_app.js`\n\nIf you have an existing `_app` or `_document` file, you can copy the contents (e.g. global styles) to the root layout (`app/layout.tsx`). Styles in `app/layout.tsx` will _not_ apply to `pages/*`. You should keep `_app`/`_document` while migrating to prevent your `pages/*` routes from breaking. Once fully migrated, you can then safely delete them.\n\nIf you are using any React Context providers, they will need to be moved to a [Client Component](/docs/app/getting-started/server-and-client-components)."
  },
  {
    "id": "app-router-migration.mdx#14",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "#### Migrating the `getLayout()` pattern to Layouts (Optional)\n\nNext.js recommended adding a [property to Page components](/docs/pages/building-your-application/routing/pages-and-layouts#layout-pattern) to achieve per-page layouts in the `pages` directory. This pattern can be replaced with native support for [nested layouts](/docs/app/api-reference/file-conventions/layout) in the `app` directory.\n\n<details>\n  <summary>See before and after example</summary>\n\n**Before**\n\n```jsx filename=\"components/DashboardLayout.js\"\nexport default function DashboardLayout({ children }) {\n  return (\n    <div>\n      <h2>My Dashboard</h2>\n      {children}\n    </div>\n  )\n}\n```\n\n```jsx filename=\"pages/dashboard/index.js\"\nimport DashboardLayout from '../components/DashboardLayout'\n\nexport default function Page() {\n  return <p>My Page</p>\n}\n\nPage.getLayout = function getLayout(page) {\n  return <DashboardLayout>{page}</DashboardLayout>\n}"
  },
  {
    "id": "app-router-migration.mdx#15",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\n**After**\n\n- Remove the `Page.getLayout` property from `pages/dashboard/index.js` and follow the [steps for migrating pages](#step-4-migrating-pages) to the `app` directory.\n\n  ```jsx filename=\"app/dashboard/page.js\"\n  export default function Page() {\n    return <p>My Page</p>\n  }\n  ```\n\n- Move the contents of `DashboardLayout` into a new [Client Component](/docs/app/getting-started/server-and-client-components) to retain `pages` directory behavior.\n\n  ```jsx filename=\"app/dashboard/DashboardLayout.js\"\n  'use client' // this directive should be at top of the file, before any imports.\n\n  // This is a Client Component\n  export default function DashboardLayout({ children }) {\n    return (\n      <div>\n        <h2>My Dashboard</h2>\n        {children}\n      </div>\n    )\n  }\n  ```\n\n- Import the `DashboardLayout` into a new `layout.js` file inside the `app` directory.\n\n  ```jsx filename=\"app/dashboard/layout.js\"\n  import DashboardLayout from './DashboardLayout'\n\n  // This is a Server Component\n  export default function Layout({ children }) {\n    return <DashboardLayout>{children}</DashboardLayout>\n  }"
  },
  {
    "id": "app-router-migration.mdx#16",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\n- You can incrementally move non-interactive parts of `DashboardLayout.js` (Client Component) into `layout.js` (Server Component) to reduce the amount of component JavaScript you send to the client.\n\n</details>"
  },
  {
    "id": "app-router-migration.mdx#17",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "### Step 3: Migrating `next/head`\n\nIn the `pages` directory, the `next/head` React component is used to manage `<head>` HTML elements such as `title` and `meta` . In the `app` directory, `next/head` is replaced with the new [built-in SEO support](/docs/app/getting-started/metadata-and-og-images).\n\n**Before:**\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Head from 'next/head'\n\nexport default function Page() {\n  return (\n    <>\n      <Head>\n        <title>My page title</title>\n      </Head>\n    </>\n  )\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Head from 'next/head'\n\nexport default function Page() {\n  return (\n    <>\n      <Head>\n        <title>My page title</title>\n      </Head>\n    </>\n  )\n}\n```\n\n**After:**\n\n```tsx filename=\"app/page.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: 'My Page Title',\n}\n\nexport default function Page() {\n  return '...'\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nexport const metadata = {\n  title: 'My Page Title',\n}\n\nexport default function Page() {\n  return '...'\n}\n```\n\n[See all metadata options](/docs/app/api-reference/functions/generate-metadata)."
  },
  {
    "id": "app-router-migration.mdx#18",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "### Step 4: Migrating Pages\n\n- Pages in the [`app` directory](/docs/app) are [Server Components](/docs/app/getting-started/server-and-client-components) by default. This is different from the `pages` directory where pages are [Client Components](/docs/app/getting-started/server-and-client-components).\n- [Data fetching](/docs/app/getting-started/fetching-data) has changed in `app`. `getServerSideProps`, `getStaticProps` and `getInitialProps` have been replaced with a simpler API.\n- The `app` directory uses nested folders to define routes and a special `page.js` file to make a route segment publicly accessible.\n- | `pages` Directory | `app` Directory       | Route          |\n  | ----------------- | --------------------- | -------------- |\n  | `index.js`        | `page.js`             | `/`            |\n  | `about.js`        | `about/page.js`       | `/about`       |\n  | `blog/[slug].js`  | `blog/[slug]/page.js` | `/blog/post-1` |\n\nWe recommend breaking down the migration of a page into two main steps:\n\n- Step 1: Move the default exported Page Component into a new Client Component.\n- Step 2: Import the new Client Component into a new `page.js` file inside the `app` directory."
  },
  {
    "id": "app-router-migration.mdx#19",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "- Step 1: Move the default exported Page Component into a new Client Component.\n- Step 2: Import the new Client Component into a new `page.js` file inside the `app` directory.\n\n> **Good to know**: This is the easiest migration path because it has the most comparable behavior to the `pages` directory.\n\n**Step 1: Create a new Client Component**\n\n- Create a new separate file inside the `app` directory (i.e. `app/home-page.tsx` or similar) that exports a Client Component. To define Client Components, add the `'use client'` directive to the top of the file (before any imports).\n  - Similar to the Pages Router, there is an [optimization step](/docs/app/getting-started/server-and-client-components#on-the-client-first-load) to prerender Client Components to static HTML on the initial page load.\n- Move the default exported page component from `pages/index.js` to `app/home-page.tsx`.\n\n```tsx filename=\"app/home-page.tsx\" switcher\n'use client'"
  },
  {
    "id": "app-router-migration.mdx#20",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```tsx filename=\"app/home-page.tsx\" switcher\n'use client'\n\n// This is a Client Component (same as components in the `pages` directory)\n// It receives data as props, has access to state and effects, and is\n// prerendered on the server during the initial page load.\nexport default function HomePage({ recentPosts }) {\n  return (\n    <div>\n      {recentPosts.map((post) => (\n        <div key={post.id}>{post.title}</div>\n      ))}\n    </div>\n  )\n}"
  },
  {
    "id": "app-router-migration.mdx#21",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\n```jsx filename=\"app/home-page.js\" switcher\n'use client'\n\n// This is a Client Component. It receives data as props and\n// has access to state and effects just like Page components\n// in the `pages` directory.\nexport default function HomePage({ recentPosts }) {\n  return (\n    <div>\n      {recentPosts.map((post) => (\n        <div key={post.id}>{post.title}</div>\n      ))}\n    </div>\n  )\n}"
  },
  {
    "id": "app-router-migration.mdx#22",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\n**Step 2: Create a new page**\n\n- Create a new `app/page.tsx` file inside the `app` directory. This is a Server Component by default.\n- Import the `home-page.tsx` Client Component into the page.\n- If you were fetching data in `pages/index.js`, move the data fetching logic directly into the Server Component using the new [data fetching APIs](/docs/app/getting-started/fetching-data). See the [data fetching upgrade guide](#step-6-migrating-data-fetching-methods) for more details.\n\n  ```tsx filename=\"app/page.tsx\" switcher\n  // Import your Client Component\n  import HomePage from './home-page'\n\n  async function getPosts() {\n    const res = await fetch('https://...')\n    const posts = await res.json()\n    return posts\n  }\n\n  export default async function Page() {\n    // Fetch data directly in a Server Component\n    const recentPosts = await getPosts()\n    // Forward fetched data to your Client Component\n    return <HomePage recentPosts={recentPosts} />\n  }"
  },
  {
    "id": "app-router-migration.mdx#23",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\n  ```jsx filename=\"app/page.js\" switcher\n  // Import your Client Component\n  import HomePage from './home-page'\n\n  async function getPosts() {\n    const res = await fetch('https://...')\n    const posts = await res.json()\n    return posts\n  }\n\n  export default async function Page() {\n    // Fetch data directly in a Server Component\n    const recentPosts = await getPosts()\n    // Forward fetched data to your Client Component\n    return <HomePage recentPosts={recentPosts} />\n  }\n  ```\n\n- If your previous page used `useRouter`, you'll need to update to the new routing hooks. [Learn more](/docs/app/api-reference/functions/use-router).\n- Start your development server and visit [`http://localhost:3000`](http://localhost:3000). You should see your existing index route, now served through the app directory."
  },
  {
    "id": "app-router-migration.mdx#24",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "### Step 5: Migrating Routing Hooks\n\nA new router has been added to support the new behavior in the `app` directory.\n\nIn `app`, you should use the three new hooks imported from `next/navigation`: [`useRouter()`](/docs/app/api-reference/functions/use-router), [`usePathname()`](/docs/app/api-reference/functions/use-pathname), and [`useSearchParams()`](/docs/app/api-reference/functions/use-search-params)."
  },
  {
    "id": "app-router-migration.mdx#25",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "- The new `useRouter` hook is imported from `next/navigation` and has different behavior to the `useRouter` hook in `pages` which is imported from `next/router`.\n  - The [`useRouter` hook imported from `next/router`](/docs/pages/api-reference/functions/use-router) is not supported in the `app` directory but can continue to be used in the `pages` directory.\n- The new `useRouter` does not return the `pathname` string. Use the separate `usePathname` hook instead.\n- The new `useRouter` does not return the `query` object. Search parameters and dynamic route parameters are now separate. Use the `useSearchParams` and `useParams` hooks instead.\n- You can use `useSearchParams` and `usePathname` together to listen to page changes. See the [Router Events](/docs/app/api-reference/functions/use-router#router-events) section for more details.\n- These new hooks are only supported in Client Components. They cannot be used in Server Components.\n\n```tsx filename=\"app/example-client-component.tsx\" switcher\n'use client'\n\nimport { useRouter, usePathname, useSearchParams } from 'next/navigation'"
  },
  {
    "id": "app-router-migration.mdx#26",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```tsx filename=\"app/example-client-component.tsx\" switcher\n'use client'\n\nimport { useRouter, usePathname, useSearchParams } from 'next/navigation'\n\nexport default function ExampleClientComponent() {\n  const router = useRouter()\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n\n  // ...\n}"
  },
  {
    "id": "app-router-migration.mdx#27",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\n```jsx filename=\"app/example-client-component.js\" switcher\n'use client'\n\nimport { useRouter, usePathname, useSearchParams } from 'next/navigation'\n\nexport default function ExampleClientComponent() {\n  const router = useRouter()\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n\n  // ...\n}"
  },
  {
    "id": "app-router-migration.mdx#28",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\nIn addition, the new `useRouter` hook has the following changes:\n\n- `isFallback` has been removed because `fallback` has [been replaced](#replacing-fallback).\n- The `locale`, `locales`, `defaultLocales`, `domainLocales` values have been removed because built-in i18n Next.js features are no longer necessary in the `app` directory. [Learn more about i18n](/docs/app/guides/internationalization).\n- `basePath` has been removed. The alternative will not be part of `useRouter`. It has not yet been implemented.\n- `asPath` has been removed because the concept of `as` has been removed from the new router.\n- `isReady` has been removed because it is no longer necessary. During [static rendering](/docs/app/guides/caching#static-rendering), any component that uses the [`useSearchParams()`](/docs/app/api-reference/functions/use-search-params) hook will skip the prerendering step and instead be rendered on the client at runtime.\n- `route` has been removed. `usePathname` or `useSelectedLayoutSegments()` provide an alternative.\n\n[View the `useRouter()` API reference](/docs/app/api-reference/functions/use-router)."
  },
  {
    "id": "app-router-migration.mdx#29",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "#### Sharing components between `pages` and `app`\n\nTo keep components compatible between the `pages` and `app` routers, refer to the [`useRouter` hook from `next/compat/router`](/docs/pages/api-reference/functions/use-router#the-nextcompatrouter-export).\nThis is the `useRouter` hook from the `pages` directory, but intended to be used while sharing components between routers. Once you are ready to use it only on the `app` router, update to the new [`useRouter` from `next/navigation`](/docs/app/api-reference/functions/use-router)."
  },
  {
    "id": "app-router-migration.mdx#30",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "### Step 6: Migrating Data Fetching Methods\n\nThe `pages` directory uses `getServerSideProps` and `getStaticProps` to fetch data for pages. Inside the `app` directory, these previous data fetching functions are replaced with a [simpler API](/docs/app/getting-started/fetching-data) built on top of `fetch()` and `async` React Server Components.\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default async function Page() {\n  // This request should be cached until manually invalidated.\n  // Similar to `getStaticProps`.\n  // `force-cache` is the default and can be omitted.\n  const staticData = await fetch(`https://...`, { cache: 'force-cache' })\n\n  // This request should be refetched on every request.\n  // Similar to `getServerSideProps`.\n  const dynamicData = await fetch(`https://...`, { cache: 'no-store' })\n\n  // This request should be cached with a lifetime of 10 seconds.\n  // Similar to `getStaticProps` with the `revalidate` option.\n  const revalidatedData = await fetch(`https://...`, {\n    next: { revalidate: 10 },\n  })\n\n  return <div>...</div>\n}"
  },
  {
    "id": "app-router-migration.mdx#31",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nexport default async function Page() {\n  // This request should be cached until manually invalidated.\n  // Similar to `getStaticProps`.\n  // `force-cache` is the default and can be omitted.\n  const staticData = await fetch(`https://...`, { cache: 'force-cache' })\n\n  // This request should be refetched on every request.\n  // Similar to `getServerSideProps`.\n  const dynamicData = await fetch(`https://...`, { cache: 'no-store' })\n\n  // This request should be cached with a lifetime of 10 seconds.\n  // Similar to `getStaticProps` with the `revalidate` option.\n  const revalidatedData = await fetch(`https://...`, {\n    next: { revalidate: 10 },\n  })\n\n  return <div>...</div>\n}\n```"
  },
  {
    "id": "app-router-migration.mdx#32",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "#### Server-side Rendering (`getServerSideProps`)\n\nIn the `pages` directory, `getServerSideProps` is used to fetch data on the server and forward props to the default exported React component in the file. The initial HTML for the page is prerendered from the server, followed by \"hydrating\" the page in the browser (making it interactive).\n\n```jsx filename=\"pages/dashboard.js\"\n// `pages` directory\n\nexport async function getServerSideProps() {\n  const res = await fetch(`https://...`)\n  const projects = await res.json()\n\n  return { props: { projects } }\n}\n\nexport default function Dashboard({ projects }) {\n  return (\n    <ul>\n      {projects.map((project) => (\n        <li key={project.id}>{project.name}</li>\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "app-router-migration.mdx#33",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\nIn the App Router, we can colocate our data fetching inside our React components using [Server Components](/docs/app/getting-started/server-and-client-components). This allows us to send less JavaScript to the client, while maintaining the rendered HTML from the server.\n\nBy setting the `cache` option to `no-store`, we can indicate that the fetched data should [never be cached](/docs/app/getting-started/fetching-data). This is similar to `getServerSideProps` in the `pages` directory.\n\n```tsx filename=\"app/dashboard/page.tsx\" switcher\n// `app` directory\n\n// This function can be named anything\nasync function getProjects() {\n  const res = await fetch(`https://...`, { cache: 'no-store' })\n  const projects = await res.json()\n\n  return projects\n}\n\nexport default async function Dashboard() {\n  const projects = await getProjects()\n\n  return (\n    <ul>\n      {projects.map((project) => (\n        <li key={project.id}>{project.name}</li>\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "app-router-migration.mdx#34",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/page.js\" switcher\n// `app` directory\n\n// This function can be named anything\nasync function getProjects() {\n  const res = await fetch(`https://...`, { cache: 'no-store' })\n  const projects = await res.json()\n\n  return projects\n}\n\nexport default async function Dashboard() {\n  const projects = await getProjects()\n\n  return (\n    <ul>\n      {projects.map((project) => (\n        <li key={project.id}>{project.name}</li>\n      ))}\n    </ul>\n  )\n}\n```"
  },
  {
    "id": "app-router-migration.mdx#35",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "#### Accessing Request Object\n\nIn the `pages` directory, you can retrieve request-based data based on the Node.js HTTP API.\n\nFor example, you can retrieve the `req` object from `getServerSideProps` and use it to retrieve the request's cookies and headers.\n\n```jsx filename=\"pages/index.js\"\n// `pages` directory\n\nexport async function getServerSideProps({ req, query }) {\n  const authHeader = req.getHeaders()['authorization'];\n  const theme = req.cookies['theme'];\n\n  return { props: { ... }}\n}\n\nexport default function Page(props) {\n  return ...\n}"
  },
  {
    "id": "app-router-migration.mdx#36",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\nThe `app` directory exposes new read-only functions to retrieve request data:\n\n- [`headers`](/docs/app/api-reference/functions/headers): Based on the Web Headers API, and can be used inside [Server Components](/docs/app/getting-started/server-and-client-components) to retrieve request headers.\n- [`cookies`](/docs/app/api-reference/functions/cookies): Based on the Web Cookies API, and can be used inside [Server Components](/docs/app/getting-started/server-and-client-components) to retrieve cookies.\n\n```tsx filename=\"app/page.tsx\" switcher\n// `app` directory\nimport { cookies, headers } from 'next/headers'\n\nasync function getData() {\n  const authHeader = (await headers()).get('authorization')\n\n  return '...'\n}\n\nexport default async function Page() {\n  // You can use `cookies` or `headers` inside Server Components\n  // directly or in your data fetching function\n  const theme = (await cookies()).get('theme')\n  const data = await getData()\n  return '...'\n}"
  },
  {
    "id": "app-router-migration.mdx#37",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\n// `app` directory\nimport { cookies, headers } from 'next/headers'\n\nasync function getData() {\n  const authHeader = (await headers()).get('authorization')\n\n  return '...'\n}\n\nexport default async function Page() {\n  // You can use `cookies` or `headers` inside Server Components\n  // directly or in your data fetching function\n  const theme = (await cookies()).get('theme')\n  const data = await getData()\n  return '...'\n}\n```"
  },
  {
    "id": "app-router-migration.mdx#38",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "#### Static Site Generation (`getStaticProps`)\n\nIn the `pages` directory, the `getStaticProps` function is used to pre-render a page at build time. This function can be used to fetch data from an external API or directly from a database, and pass this data down to the entire page as it's being generated during the build.\n\n```jsx filename=\"pages/index.js\"\n// `pages` directory\n\nexport async function getStaticProps() {\n  const res = await fetch(`https://...`)\n  const projects = await res.json()\n\n  return { props: { projects } }\n}\n\nexport default function Index({ projects }) {\n  return projects.map((project) => <div>{project.name}</div>)\n}"
  },
  {
    "id": "app-router-migration.mdx#39",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\nIn the `app` directory, data fetching with [`fetch()`](/docs/app/api-reference/functions/fetch) will default to `cache: 'force-cache'`, which will cache the request data until manually invalidated. This is similar to `getStaticProps` in the `pages` directory.\n\n```jsx filename=\"app/page.js\"\n// `app` directory\n\n// This function can be named anything\nasync function getProjects() {\n  const res = await fetch(`https://...`)\n  const projects = await res.json()\n\n  return projects\n}\n\nexport default async function Index() {\n  const projects = await getProjects()\n\n  return projects.map((project) => <div>{project.name}</div>)\n}\n```"
  },
  {
    "id": "app-router-migration.mdx#40",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "#### Dynamic paths (`getStaticPaths`)\n\nIn the `pages` directory, the `getStaticPaths` function is used to define the dynamic paths that should be pre-rendered at build time.\n\n```jsx filename=\"pages/posts/[id].js\"\n// `pages` directory\nimport PostLayout from '@/components/post-layout'\n\nexport async function getStaticPaths() {\n  return {\n    paths: [{ params: { id: '1' } }, { params: { id: '2' } }],\n  }\n}\n\nexport async function getStaticProps({ params }) {\n  const res = await fetch(`https://.../posts/${params.id}`)\n  const post = await res.json()\n\n  return { props: { post } }\n}\n\nexport default function Post({ post }) {\n  return <PostLayout post={post} />\n}"
  },
  {
    "id": "app-router-migration.mdx#41",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\nIn the `app` directory, `getStaticPaths` is replaced with [`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params).\n\n[`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params) behaves similarly to `getStaticPaths`, but has a simplified API for returning route parameters and can be used inside [layouts](/docs/app/api-reference/file-conventions/layout). The return shape of `generateStaticParams` is an array of segments instead of an array of nested `param` objects or a string of resolved paths.\n\n```jsx filename=\"app/posts/[id]/page.js\"\n// `app` directory\nimport PostLayout from '@/components/post-layout'\n\nexport async function generateStaticParams() {\n  return [{ id: '1' }, { id: '2' }]\n}\n\nasync function getPost(params) {\n  const res = await fetch(`https://.../posts/${(await params).id}`)\n  const post = await res.json()\n\n  return post\n}\n\nexport default async function Post({ params }) {\n  const post = await getPost(params)\n\n  return <PostLayout post={post} />\n}"
  },
  {
    "id": "app-router-migration.mdx#42",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\nUsing the name `generateStaticParams` is more appropriate than `getStaticPaths` for the new model in the `app` directory. The `get` prefix is replaced with a more descriptive `generate`, which sits better alone now that `getStaticProps` and `getServerSideProps` are no longer necessary. The `Paths` suffix is replaced by `Params`, which is more appropriate for nested routing with multiple dynamic segments.\n\n---"
  },
  {
    "id": "app-router-migration.mdx#43",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "#### Replacing `fallback`\n\nIn the `pages` directory, the `fallback` property returned from `getStaticPaths` is used to define the behavior of a page that isn't pre-rendered at build time. This property can be set to `true` to show a fallback page while the page is being generated, `false` to show a 404 page, or `blocking` to generate the page at request time.\n\n```jsx filename=\"pages/posts/[id].js\"\n// `pages` directory\n\nexport async function getStaticPaths() {\n  return {\n    paths: [],\n    fallback: 'blocking'\n  };\n}\n\nexport async function getStaticProps({ params }) {\n  ...\n}\n\nexport default function Post({ post }) {\n  return ...\n}"
  },
  {
    "id": "app-router-migration.mdx#44",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\nIn the `app` directory the [`config.dynamicParams` property](/docs/app/api-reference/file-conventions/route-segment-config#dynamicparams) controls how params outside of [`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params) are handled:\n\n- **`true`**: (default) Dynamic segments not included in `generateStaticParams` are generated on demand.\n- **`false`**: Dynamic segments not included in `generateStaticParams` will return a 404.\n\nThis replaces the `fallback: true | false | 'blocking'` option of `getStaticPaths` in the `pages` directory. The `fallback: 'blocking'` option is not included in `dynamicParams` because the difference between `'blocking'` and `true` is negligible with streaming.\n\n```jsx filename=\"app/posts/[id]/page.js\"\n// `app` directory\n\nexport const dynamicParams = true;\n\nexport async function generateStaticParams() {\n  return [...]\n}\n\nasync function getPost(params) {\n  ...\n}\n\nexport default async function Post({ params }) {\n  const post = await getPost(params);\n\n  return ...\n}"
  },
  {
    "id": "app-router-migration.mdx#45",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "```\n\nWith [`dynamicParams`](/docs/app/api-reference/file-conventions/route-segment-config#dynamicparams) set to `true` (the default), when a route segment is requested that hasn't been generated, it will be server-rendered and cached."
  },
  {
    "id": "app-router-migration.mdx#46",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "#### Incremental Static Regeneration (`getStaticProps` with `revalidate`)\n\nIn the `pages` directory, the `getStaticProps` function allows you to add a `revalidate` field to automatically regenerate a page after a certain amount of time.\n\n```jsx filename=\"pages/index.js\"\n// `pages` directory\n\nexport async function getStaticProps() {\n  const res = await fetch(`https://.../posts`)\n  const posts = await res.json()\n\n  return {\n    props: { posts },\n    revalidate: 60,\n  }\n}\n\nexport default function Index({ posts }) {\n  return (\n    <Layout>\n      <PostList posts={posts} />\n    </Layout>\n  )\n}\n```\n\nIn the `app` directory, data fetching with [`fetch()`](/docs/app/api-reference/functions/fetch) can use `revalidate`, which will cache the request for the specified amount of seconds.\n\n```jsx filename=\"app/page.js\"\n// `app` directory\n\nasync function getPosts() {\n  const res = await fetch(`https://.../posts`, { next: { revalidate: 60 } })\n  const data = await res.json()\n\n  return data.posts\n}\n\nexport default async function PostList() {\n  const posts = await getPosts()\n\n  return posts.map((post) => <div>{post.name}</div>)\n}\n```"
  },
  {
    "id": "app-router-migration.mdx#47",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "#### API Routes\n\nAPI Routes continue to work in the `pages/api` directory without any changes. However, they have been replaced by [Route Handlers](/docs/app/api-reference/file-conventions/route) in the `app` directory.\n\nRoute Handlers allow you to create custom request handlers for a given route using the Web [Request](https://developer.mozilla.org/docs/Web/API/Request) and [Response](https://developer.mozilla.org/docs/Web/API/Response) APIs.\n\n```ts filename=\"app/api/route.ts\" switcher\nexport async function GET(request: Request) {}\n```\n\n```js filename=\"app/api/route.js\" switcher\nexport async function GET(request) {}\n```\n\n> **Good to know**: If you previously used API routes to call an external API from the client, you can now use [Server Components](/docs/app/getting-started/server-and-client-components) instead to securely fetch data. Learn more about [data fetching](/docs/app/getting-started/fetching-data).\n\n#### Single-Page Applications\n\nIf you are also migrating to Next.js from a Single-Page Application (SPA) at the same time, see our [documentation](/docs/app/guides/single-page-applications) to learn more."
  },
  {
    "id": "app-router-migration.mdx#48",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "### Step 7: Styling\n\nIn the `pages` directory, global stylesheets are restricted to only `pages/_app.js`. With the `app` directory, this restriction has been lifted. Global styles can be added to any layout, page, or component.\n\n- [CSS Modules](/docs/app/getting-started/css#css-modules)\n- [Tailwind CSS](/docs/app/getting-started/css#tailwind-css)\n- [Global Styles](/docs/app/getting-started/css#global-css)\n- [CSS-in-JS](/docs/app/guides/css-in-js)\n- [External Stylesheets](/docs/app/getting-started/css#external-stylesheets)\n- [Sass](/docs/app/guides/sass)"
  },
  {
    "id": "app-router-migration.mdx#49",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "#### Tailwind CSS\n\nIf you're using Tailwind CSS, you'll need to add the `app` directory to your `tailwind.config.js` file:\n\n```js filename=\"tailwind.config.js\"\nmodule.exports = {\n  content: [\n    './app/**/*.{js,ts,jsx,tsx,mdx}', // <-- Add this line\n    './pages/**/*.{js,ts,jsx,tsx,mdx}',\n    './components/**/*.{js,ts,jsx,tsx,mdx}',\n  ],\n}\n```\n\nYou'll also need to import your global styles in your `app/layout.js` file:\n\n```jsx filename=\"app/layout.js\"\nimport '../styles/globals.css'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\nLearn more about [styling with Tailwind CSS](/docs/app/getting-started/css#tailwind-css)"
  },
  {
    "id": "app-router-migration.mdx#50",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "## Using App Router together with Pages Router\n\nWhen navigating between routes served by the different Next.js routers, there will be a hard navigation. Automatic link prefetching with `next/link` will not prefetch across routers.\n\nInstead, you can [optimize navigations](https://vercel.com/guides/optimizing-hard-navigations) between App Router and Pages Router to retain the prefetched and fast page transitions. [Learn more](https://vercel.com/guides/optimizing-hard-navigations).\n\n## Codemods\n\nNext.js provides Codemod transformations to help upgrade your codebase when a feature is deprecated. See [Codemods](/docs/app/guides/upgrading/codemods) for more information."
  },
  {
    "id": "from-create-react-app.mdx#0",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "---\ntitle: How to migrate from Create React App to Next.js\nnav_title: Create React App\ndescription: Learn how to migrate your existing React application from Create React App to Next.js.\n---\n\nThis guide will help you migrate an existing Create React App (CRA) site to Next.js."
  },
  {
    "id": "from-create-react-app.mdx#1",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "## Why Switch?\n\nThere are several reasons why you might want to switch from Create React App to Next.js:\n\n### Slow initial page loading time\n\nCreate React App uses purely client-side rendering. Client-side only applications, also known as [single-page applications (SPAs)](/docs/app/guides/single-page-applications), often experience slow initial page loading time. This happens due to a couple of reasons:\n\n1. The browser needs to wait for the React code and your entire application bundle to download and run before your code is able to send requests to load data.\n2. Your application code grows with every new feature and dependency you add.\n\n### No automatic code splitting\n\nThe previous issue of slow loading times can be somewhat mitigated with code splitting. However, if you try to do code splitting manually, you can inadvertently introduce network waterfalls. Next.js provides automatic code splitting and tree-shaking built into its router and build pipeline."
  },
  {
    "id": "from-create-react-app.mdx#2",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Network waterfalls\n\nA common cause of poor performance occurs when applications make sequential client-server requests to fetch data. One pattern for data fetching in a [SPA](/docs/app/guides/single-page-applications) is to render a placeholder, and then fetch data after the component has mounted. Unfortunately, a child component can only begin fetching data after its parent has finished loading its own data, resulting in a “waterfall” of requests.\n\nWhile client-side data fetching is supported in Next.js, Next.js also lets you move data fetching to the server. This often eliminates client-server waterfalls altogether.\n\n### Fast and intentional loading states\n\nWith built-in support for [streaming through React Suspense](/docs/app/getting-started/linking-and-navigating#streaming), you can define which parts of your UI load first and in what order, without creating network waterfalls.\n\nThis enables you to build pages that are faster to load and eliminate [layout shifts](https://vercel.com/blog/how-core-web-vitals-affect-seo)."
  },
  {
    "id": "from-create-react-app.mdx#3",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Choose the data fetching strategy\n\nDepending on your needs, Next.js allows you to choose your data fetching strategy on a page or component-level basis. For example, you could fetch data from your CMS and render blog posts at build time (SSG) for quick load speeds, or fetch data at request time (SSR) when necessary.\n\n### Proxy\n\n[Next.js Proxy](/docs/app/api-reference/file-conventions/proxy) allows you to run code on the server before a request is completed. For instance, you can avoid a flash of unauthenticated content by redirecting a user to a login page in the proxy for authenticated-only pages. You can also use it for features like A/B testing, experimentation, and [internationalization](/docs/app/guides/internationalization).\n\n### Built-in Optimizations\n\n[Images](/docs/app/api-reference/components/image), [fonts](/docs/app/api-reference/components/font), and [third-party scripts](/docs/app/guides/scripts) often have a large impact on an application’s performance. Next.js includes specialized components and APIs that automatically optimize them for you."
  },
  {
    "id": "from-create-react-app.mdx#4",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "## Migration Steps\n\nOur goal is to get a working Next.js application as quickly as possible so that you can then adopt Next.js features incrementally. To begin with, we’ll treat your application as a purely client-side application ([SPA](/docs/app/guides/single-page-applications)) without immediately replacing your existing router. This reduces complexity and merge conflicts.\n\n> **Note**: If you are using advanced CRA configurations such as a custom `homepage` field in your `package.json`, a custom service worker, or specific Babel/webpack tweaks, please see the **Additional Considerations** section at the end of this guide for tips on replicating or adapting these features in Next.js.\n\n### Step 1: Install the Next.js Dependency\n\nInstall Next.js in your existing project:\n\n```bash filename=\"Terminal\"\nnpm install next@latest\n```"
  },
  {
    "id": "from-create-react-app.mdx#5",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Step 1: Install the Next.js Dependency\n\nInstall Next.js in your existing project:\n\n```bash filename=\"Terminal\"\nnpm install next@latest\n```\n\n### Step 2: Create the Next.js Configuration File\n\nCreate a `next.config.ts` at the root of your project (same level as your `package.json`). This file holds your [Next.js configuration options](/docs/app/api-reference/config/next-config-js).\n\n```js filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  output: 'export', // Outputs a Single-Page Application (SPA)\n  distDir: 'build', // Changes the build output directory to `build`\n}\n\nexport default nextConfig\n```\n\n> **Note**: Using `output: 'export'` means you’re doing a static export. You will **not** have access to server-side features like SSR or APIs. You can remove this line to leverage Next.js server features."
  },
  {
    "id": "from-create-react-app.mdx#6",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Step 3: Create the Root Layout\n\nA Next.js [App Router](/docs/app) application must include a [root layout](/docs/app/api-reference/file-conventions/layout#root-layout) file, which is a [React Server Component](/docs/app/getting-started/server-and-client-components) that will wrap all your pages.\n\nThe closest equivalent of the root layout file in a CRA application is `public/index.html`, which includes your `<html>`, `<head>`, and `<body>` tags.\n\n1. Create a new `app` directory inside your `src` folder (or at your project root if you prefer `app` at the root).\n2. Inside the `app` directory, create a `layout.tsx` (or `layout.js`) file:\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return '...'\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return '...'\n}"
  },
  {
    "id": "from-create-react-app.mdx#7",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return '...'\n}\n```\n\nNow copy the content of your old `index.html` into this `<RootLayout>` component. Replace `body div#root` (and `body noscript`) with `<div id=\"root\">{children}</div>`.\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <meta charSet=\"UTF-8\" />\n        <link rel=\"icon\" href=\"%PUBLIC_URL%/favicon.ico\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n        <title>React App</title>\n        <meta name=\"description\" content=\"Web site created...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "from-create-react-app.mdx#8",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\" />\n        <link rel=\"icon\" href=\"%PUBLIC_URL%/favicon.ico\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n        <title>React App</title>\n        <meta name=\"description\" content=\"Web site created...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}\n```\n\n> **Good to know**: Next.js ignores CRA’s `public/manifest.json`, additional iconography, and [testing configuration](/docs/app/guides/testing) by default. If you need these, Next.js has support with its [Metadata API](/docs/app/getting-started/metadata-and-og-images) and [Testing](/docs/app/guides/testing) setup."
  },
  {
    "id": "from-create-react-app.mdx#9",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Step 4: Metadata\n\nNext.js automatically includes the `<meta charset=\"UTF-8\" />` and `<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />` tags, so you can remove them from `<head>`:\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <link rel=\"icon\" href=\"%PUBLIC_URL%/favicon.ico\" />\n        <title>React App</title>\n        <meta name=\"description\" content=\"Web site created...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <link rel=\"icon\" href=\"%PUBLIC_URL%/favicon.ico\" />\n        <title>React App</title>\n        <meta name=\"description\" content=\"Web site created...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "from-create-react-app.mdx#10",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "```\n\nAny [metadata files](/docs/app/getting-started/metadata-and-og-images#file-based-metadata) such as `favicon.ico`, `icon.png`, `robots.txt` are automatically added to the application `<head>` tag as long as you have them placed into the top level of the `app` directory. After moving [all supported files](/docs/app/getting-started/metadata-and-og-images#file-based-metadata) into the `app` directory you can safely delete their `<link>` tags:\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <title>React App</title>\n        <meta name=\"description\" content=\"Web site created...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <title>React App</title>\n        <meta name=\"description\" content=\"Web site created...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "from-create-react-app.mdx#11",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "```\n\nFinally, Next.js can manage your last `<head>` tags with the [Metadata API](/docs/app/getting-started/metadata-and-og-images). Move your final metadata info into an exported [`metadata` object](/docs/app/api-reference/functions/generate-metadata#metadata-object):\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: 'React App',\n  description: 'Web site created with Next.js.',\n}\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport const metadata = {\n  title: 'React App',\n  description: 'Web site created with Next.js.',\n}\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "from-create-react-app.mdx#12",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "```\n\nWith the above changes, you shifted from declaring everything in your `index.html` to using Next.js' convention-based approach built into the framework ([Metadata API](/docs/app/getting-started/metadata-and-og-images)). This approach enables you to more easily improve your SEO and web shareability of your pages."
  },
  {
    "id": "from-create-react-app.mdx#13",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Step 5: Styles\n\nLike CRA, Next.js supports [CSS Modules](/docs/app/getting-started/css#css-modules) out of the box. It also supports [global CSS imports](/docs/app/getting-started/css#global-css).\n\nIf you have a global CSS file, import it into your `app/layout.tsx`:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport '../index.css'\n\nexport const metadata = {\n  title: 'React App',\n  description: 'Web site created with Next.js.',\n}\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}\n```\n\nIf you're using Tailwind CSS, see our [installation docs](/docs/app/getting-started/css#tailwind-css)."
  },
  {
    "id": "from-create-react-app.mdx#14",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Step 6: Create the Entrypoint Page\n\nCreate React App uses `src/index.tsx` (or `index.js`) as the entry point. In Next.js (App Router), each folder inside the `app` directory corresponds to a route, and each folder should have a `page.tsx`.\n\nSince we want to keep the app as an SPA for now and intercept **all** routes, we’ll use an [optional catch-all route](/docs/app/api-reference/file-conventions/dynamic-routes#optional-catch-all-segments).\n\n1. **Create a `[[...slug]]` directory inside `app`.**\n\n```bash\napp\n ┣ [[...slug]]\n ┃ ┗ page.tsx\n ┣ layout.tsx\n```\n\n2. **Add the following to `page.tsx`**:\n\n```tsx filename=\"app/[[...slug]]/page.tsx\" switcher\nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n\nexport default function Page() {\n  return '...' // We'll update this\n}\n```\n\n```jsx filename=\"app/[[...slug]]/page.js\" switcher\nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n\nexport default function Page() {\n  return '...' // We'll update this\n}"
  },
  {
    "id": "from-create-react-app.mdx#15",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/[[...slug]]/page.js\" switcher\nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n\nexport default function Page() {\n  return '...' // We'll update this\n}\n```\n\nThis tells Next.js to generate a single route for the empty slug (`/`), effectively mapping **all** routes to the same page. This page is a [Server Component](/docs/app/getting-started/server-and-client-components), prerendered into static HTML."
  },
  {
    "id": "from-create-react-app.mdx#16",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Step 7: Add a Client-Only Entrypoint\n\nNext, we’ll embed your CRA’s root App component inside a [Client Component](/docs/app/getting-started/server-and-client-components) so that all logic remains client-side. If this is your first time using Next.js, it's worth knowing that clients components (by default) are still prerendered on the server. You can think about them as having the additional capability of running client-side JavaScript.\n\nCreate a `client.tsx` (or `client.js`) in `app/[[...slug]]/`:\n\n```tsx filename=\"app/[[...slug]]/client.tsx\" switcher\n'use client'\n\nimport dynamic from 'next/dynamic'\n\nconst App = dynamic(() => import('../../App'), { ssr: false })\n\nexport function ClientOnly() {\n  return <App />\n}\n```\n\n```jsx filename=\"app/[[...slug]]/client.js\" switcher\n'use client'\n\nimport dynamic from 'next/dynamic'\n\nconst App = dynamic(() => import('../../App'), { ssr: false })\n\nexport function ClientOnly() {\n  return <App />\n}"
  },
  {
    "id": "from-create-react-app.mdx#17",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "```\n\n- The `'use client'` directive makes this file a **Client Component**.\n- The `dynamic` import with `ssr: false` disables server-side rendering for the `<App />` component, making it truly client-only (SPA).\n\nNow update your `page.tsx` (or `page.js`) to use your new component:\n\n```tsx filename=\"app/[[...slug]]/page.tsx\" switcher\nimport { ClientOnly } from './client'\n\nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n\nexport default function Page() {\n  return <ClientOnly />\n}\n```\n\n```jsx filename=\"app/[[...slug]]/page.js\" switcher\nimport { ClientOnly } from './client'\n\nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n\nexport default function Page() {\n  return <ClientOnly />\n}\n```"
  },
  {
    "id": "from-create-react-app.mdx#18",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Step 8: Update Static Image Imports\n\nIn CRA, importing an image file returns its public URL as a string:\n\n```tsx\nimport image from './img.png'\n\nexport default function App() {\n  return <img src={image} />\n}"
  },
  {
    "id": "from-create-react-app.mdx#19",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "```\n\nWith Next.js, static image imports return an object. The object can then be used directly with the Next.js [`<Image>` component](/docs/app/api-reference/components/image), or you can use the object's `src` property with your existing `<img>` tag.\n\nThe `<Image>` component has the added benefits of [automatic image optimization](/docs/app/api-reference/components/image). The `<Image>` component automatically sets the `width` and `height` attributes of the resulting `<img>` based on the image's dimensions. This prevents layout shifts when the image loads. However, this can cause issues if your app contains images with only one of their dimensions being styled without the other styled to `auto`. When not styled to `auto`, the dimension will default to the `<img>` dimension attribute's value, which can cause the image to appear distorted."
  },
  {
    "id": "from-create-react-app.mdx#20",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "Keeping the `<img>` tag will reduce the amount of changes in your application and prevent the above issues. You can then optionally later migrate to the `<Image>` component to take advantage of optimizing images by [configuring a loader](/docs/app/api-reference/components/image#loader), or moving to the default Next.js server which has automatic image optimization.\n\n**Convert absolute import paths for images imported from `/public` into relative imports:**\n\n```tsx\n// Before\nimport logo from '/logo.png'\n\n// After\nimport logo from '../public/logo.png'"
  },
  {
    "id": "from-create-react-app.mdx#21",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "```\n\n**Pass the image `src` property instead of the whole image object to your `<img>` tag:**\n\n```tsx\n// Before\n<img src={logo} />\n\n// After\n<img src={logo.src} />\n```\n\nAlternatively, you can reference the public URL for the image asset based on the filename. For example, `public/logo.png` will serve the image at `/logo.png` for your application, which would be the `src` value.\n\n> **Warning:** If you're using TypeScript, you might encounter type errors when accessing the `src` property. To fix them, you need to add `next-env.d.ts` to the [`include` array](https://www.typescriptlang.org/tsconfig#include) of your `tsconfig.json` file. Next.js will automatically generate this file when you run your application on step 9."
  },
  {
    "id": "from-create-react-app.mdx#22",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Step 9: Migrate Environment Variables\n\nNext.js supports [environment variables](/docs/app/guides/environment-variables) similarly to CRA but **requires** a `NEXT_PUBLIC_` prefix for any variable you want to expose in the browser.\n\nThe main difference is the prefix used to expose environment variables on the client-side. Change all environment variables with the `REACT_APP_` prefix to `NEXT_PUBLIC_`.\n\n### Step 10: Update Scripts in `package.json`\n\nUpdate your `package.json` scripts to use Next.js commands. Also, add `.next` and `next-env.d.ts` to your `.gitignore`:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"npx serve@latest ./build\"\n  }\n}\n```\n\n```txt filename=\".gitignore\"\n# ...\n.next\nnext-env.d.ts\n```\n\nNow you can run:\n\n```bash\nnpm run dev\n```\n\nOpen [http://localhost:3000](http://localhost:3000). You should see your application now running on Next.js (in SPA mode)."
  },
  {
    "id": "from-create-react-app.mdx#23",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Step 11: Clean Up\n\nYou can now remove artifacts that are specific to Create React App:\n\n- `public/index.html`\n- `src/index.tsx`\n- `src/react-app-env.d.ts`\n- The `reportWebVitals` setup\n- The `react-scripts` dependency (uninstall it from `package.json`)"
  },
  {
    "id": "from-create-react-app.mdx#24",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "## Additional Considerations\n\n### Using a Custom `homepage` in CRA\n\nIf you used the `homepage` field in your CRA `package.json` to serve the app under a specific subpath, you can replicate that in Next.js using the [`basePath` configuration](/docs/app/api-reference/config/next-config-js/basePath) in `next.config.ts`:\n\n```ts filename=\"next.config.ts\"\nimport { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  basePath: '/my-subpath',\n  // ...\n}\n\nexport default nextConfig\n```\n\n### Handling a Custom `Service Worker`\n\nIf you used CRA’s service worker (e.g., `serviceWorker.js` from `create-react-app`), you can learn how to create [Progressive Web Applications (PWAs)](/docs/app/guides/progressive-web-apps) with Next.js."
  },
  {
    "id": "from-create-react-app.mdx#25",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### Proxying API Requests\n\nIf your CRA app used the `proxy` field in `package.json` to forward requests to a backend server, you can replicate this with [Next.js rewrites](/docs/app/api-reference/config/next-config-js/rewrites) in `next.config.ts`:\n\n```ts filename=\"next.config.ts\"\nimport { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  async rewrites() {\n    return [\n      {\n        source: '/api/:path*',\n        destination: 'https://your-backend.com/:path*',\n      },\n    ]\n  },\n}\n```\n\n### Custom Webpack\n\nIf you had a custom webpack or Babel configuration in CRA, you can extend Next.js’s config in `next.config.ts`:\n\n```ts filename=\"next.config.ts\"\nimport { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  webpack: (config, { isServer }) => {\n    // Modify the webpack config here\n    return config\n  },\n}\n\nexport default nextConfig\n```\n\n> **Note**: This will require using Webpack by adding `--webpack` to your `dev` script."
  },
  {
    "id": "from-create-react-app.mdx#26",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "### TypeScript Setup\n\nNext.js automatically sets up TypeScript if you have a `tsconfig.json`. Make sure `next-env.d.ts` is listed in your `tsconfig.json` `include` array:\n\n```json\n{\n  \"include\": [\"next-env.d.ts\", \"app/**/*\", \"src/**/*\"]\n}\n```"
  },
  {
    "id": "from-create-react-app.mdx#27",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "## Bundler Compatibility\n\nCreate React App uses webpack for bundling. Next.js now defaults to [Turbopack](/docs/app/api-reference/config/next-config-js/turbopack) for faster local development:\n\n```bash\nnext dev  # Uses Turbopack by default\n```\n\nTo use Webpack instead (similar to CRA):\n\n```bash\nnext dev --webpack\n```\n\nYou can still provide a [custom webpack configuration](/docs/app/api-reference/config/next-config-js/webpack) if you need to migrate advanced webpack settings from CRA."
  },
  {
    "id": "from-create-react-app.mdx#28",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "## Next Steps\n\nIf everything worked, you now have a functioning Next.js application running as a single-page application. You aren’t yet leveraging Next.js features like server-side rendering or file-based routing, but you can now do so incrementally:\n\n- **Migrate from React Router** to the [Next.js App Router](/docs/app) for:\n  - Automatic code splitting\n  - [Streaming server rendering](/docs/app/api-reference/file-conventions/loading)\n  - [React Server Components](/docs/app/getting-started/server-and-client-components)\n- **Optimize images** with the [`<Image>` component](/docs/app/api-reference/components/image)\n- **Optimize fonts** with [`next/font`](/docs/app/api-reference/components/font)\n- **Optimize third-party scripts** with the [`<Script>` component](/docs/app/guides/scripts)\n- **Enable ESLint** with Next.js [recommended rules](/docs/app/api-reference/config/eslint#setup-eslint)\n\n> **Note**: Using a static export (`output: 'export'`) [does not currently support](https://github.com/vercel/next.js/issues/54393) the `useParams` hook or other server features. To use all Next.js features, remove `output: 'export'` from your `next.config.ts`."
  },
  {
    "id": "from-vite.mdx#0",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "---\ntitle: How to migrate from Vite to Next.js\nnav_title: Vite\ndescription: Learn how to migrate your existing React application from Vite to Next.js.\n---\n\nThis guide will help you migrate an existing Vite application to Next.js."
  },
  {
    "id": "from-vite.mdx#1",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "## Why Switch?\n\nThere are several reasons why you might want to switch from Vite to Next.js:\n\n### Slow initial page loading time\n\nIf you have built your application with the [default Vite plugin for React](https://github.com/vitejs/vite-plugin-react/tree/main/packages/plugin-react), your application is a purely client-side application. Client-side only applications, also known as single-page applications (SPAs), often experience slow initial page loading time. This happens due to a couple of reasons:\n\n1. The browser needs to wait for the React code and your entire application bundle to download and run before your code is able to send requests to load some data.\n2. Your application code grows with every new feature and extra dependency you add.\n\n### No automatic code splitting\n\nThe previous issue of slow loading times can be somewhat managed with code splitting. However, if you try to do code splitting manually, you'll often make performance worse. It's easy to inadvertently introduce network waterfalls when code-splitting manually. Next.js provides automatic code splitting built into its router."
  },
  {
    "id": "from-vite.mdx#2",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "### Network waterfalls\n\nA common cause of poor performance occurs when applications make sequential client-server requests to fetch data. One common pattern for data fetching in an SPA is to initially render a placeholder, and then fetch data after the component has mounted. Unfortunately, this means that a child component that fetches data can't start fetching until the parent component has finished loading its own data.\n\nWhile fetching data on the client is supported with Next.js, it also gives you the option to shift data fetching to the server, which can eliminate client-server waterfalls.\n\n### Fast and intentional loading states\n\nWith built-in support for [streaming through React Suspense](/docs/app/getting-started/linking-and-navigating#streaming), you can be more intentional about which parts of your UI you want to load first and in what order without introducing network waterfalls.\n\nThis enables you to build pages that are faster to load and eliminate [layout shifts](https://vercel.com/blog/how-core-web-vitals-affect-seo)."
  },
  {
    "id": "from-vite.mdx#3",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "### Choose the data fetching strategy\n\nDepending on your needs, Next.js allows you to choose your data fetching strategy on a page and component basis. You can decide to fetch at build time, at request time on the server, or on the client. For example, you can fetch data from your CMS and render your blog posts at build time, which can then be efficiently cached on a CDN.\n\n### Proxy\n\n[Next.js Proxy](/docs/app/api-reference/file-conventions/proxy) allows you to run code on the server before a request is completed. This is especially useful to avoid having a flash of unauthenticated content when the user visits an authenticated-only page by redirecting the user to a login page. The proxy is also useful for experimentation and [internationalization](/docs/app/guides/internationalization).\n\n### Built-in Optimizations\n\n[Images](/docs/app/api-reference/components/image), [fonts](/docs/app/api-reference/components/font), and [third-party scripts](/docs/app/guides/scripts) often have significant impact on an application's performance. Next.js comes with built-in components that automatically optimize those for you."
  },
  {
    "id": "from-vite.mdx#4",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "## Migration Steps\n\nOur goal with this migration is to get a working Next.js application as quickly as possible, so that\nyou can then adopt Next.js features incrementally. To begin with, we'll keep it as a purely\nclient-side application (SPA) without migrating your existing router. This helps minimize the\nchances of encountering issues during the migration process and reduces merge conflicts.\n\n### Step 1: Install the Next.js Dependency\n\nThe first thing you need to do is to install `next` as a dependency:\n\n```bash filename=\"Terminal\"\nnpm install next@latest\n```\n\n### Step 2: Create the Next.js Configuration File\n\nCreate a `next.config.mjs` at the root of your project. This file will hold your\n[Next.js configuration options](/docs/app/api-reference/config/next-config-js).\n\n```js filename=\"next.config.mjs\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export', // Outputs a Single-Page Application (SPA).\n  distDir: './dist', // Changes the build output directory to `./dist/`.\n}\n\nexport default nextConfig\n```\n\n> **Good to know:** You can use either `.js` or `.mjs` for your Next.js configuration file."
  },
  {
    "id": "from-vite.mdx#5",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "### Step 3: Update TypeScript Configuration\n\nIf you're using TypeScript, you need to update your `tsconfig.json` file with the following changes\nto make it compatible with Next.js. If you're not using TypeScript, you can skip this step."
  },
  {
    "id": "from-vite.mdx#6",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "1. Remove the [project reference](https://www.typescriptlang.org/tsconfig#references) to `tsconfig.node.json`\n2. Add `./dist/types/**/*.ts` and `./next-env.d.ts` to the [`include` array](https://www.typescriptlang.org/tsconfig#include)\n3. Add `./node_modules` to the [`exclude` array](https://www.typescriptlang.org/tsconfig#exclude)\n4. Add `{ \"name\": \"next\" }` to the [`plugins` array in `compilerOptions`](https://www.typescriptlang.org/tsconfig#plugins): `\"plugins\": [{ \"name\": \"next\" }]`\n5. Set [`esModuleInterop`](https://www.typescriptlang.org/tsconfig#esModuleInterop) to `true`: `\"esModuleInterop\": true`\n6. Set [`jsx`](https://www.typescriptlang.org/tsconfig#jsx) to `react-jsx`: `\"jsx\": \"react-jsx\"`\n7. Set [`allowJs`](https://www.typescriptlang.org/tsconfig#allowJs) to `true`: `\"allowJs\": true`\n8. Set [`forceConsistentCasingInFileNames`](https://www.typescriptlang.org/tsconfig#forceConsistentCasingInFileNames) to `true`: `\"forceConsistentCasingInFileNames\": true`\n9. Set [`incremental`](https://www.typescriptlang.org/tsconfig#incremental) to `true`: `\"incremental\": true`\n\nHere's an example of a working `tsconfig.json` with those changes:"
  },
  {
    "id": "from-vite.mdx#7",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "Here's an example of a working `tsconfig.json` with those changes:\n\n```json filename=\"tsconfig.json\"\n{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"esModuleInterop\": true,\n    \"skipLibCheck\": true,\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\",\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n    \"allowJs\": true,\n    \"forceConsistentCasingInFileNames\": true,\n    \"incremental\": true,\n    \"plugins\": [{ \"name\": \"next\" }]\n  },\n  \"include\": [\"./src\", \"./dist/types/**/*.ts\", \"./next-env.d.ts\"],\n  \"exclude\": [\"./node_modules\"]\n}"
  },
  {
    "id": "from-vite.mdx#8",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\nYou can find more information about configuring TypeScript on the\n[Next.js docs](/docs/app/api-reference/config/typescript#ide-plugin)."
  },
  {
    "id": "from-vite.mdx#9",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "### Step 4: Create the Root Layout\n\nA Next.js [App Router](/docs/app) application must include a\n[root layout](/docs/app/api-reference/file-conventions/layout#root-layout)\nfile, which is a [React Server Component](/docs/app/getting-started/server-and-client-components)\nthat will wrap all pages in your application. This file is defined at the top level of the `app`\ndirectory.\n\nThe closest equivalent to the root layout file in a Vite application is the\n[`index.html` file](https://vitejs.dev/guide/#index-html-and-project-root), which contains your\n`<html>`, `<head>`, and `<body>` tags.\n\nIn this step, you'll convert your `index.html` file into a root layout file:\n\n1. Create a new `app` directory in your `src` folder.\n2. Create a new `layout.tsx` file inside that `app` directory:\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return '...'\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return '...'\n}"
  },
  {
    "id": "from-vite.mdx#10",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return '...'\n}\n```\n\n> **Good to know**: `.js`, `.jsx`, or `.tsx` extensions can be used for Layout files.\n\n3. Copy the content of your `index.html` file into the previously created `<RootLayout>` component while\n   replacing the `body.div#root` and `body.script` tags with `<div id=\"root\">{children}</div>`:\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\" />\n        <link rel=\"icon\" type=\"image/svg+xml\" href=\"/icon.svg\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n        <title>My App</title>\n        <meta name=\"description\" content=\"My App is a...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "from-vite.mdx#11",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\" />\n        <link rel=\"icon\" type=\"image/svg+xml\" href=\"/icon.svg\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n        <title>My App</title>\n        <meta name=\"description\" content=\"My App is a...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "from-vite.mdx#12",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\n4. Next.js already includes by default the\n   [meta charset](https://developer.mozilla.org/docs/Web/HTML/Element/meta#charset) and\n   [meta viewport](https://developer.mozilla.org/docs/Web/HTML/Viewport_meta_tag) tags, so you\n   can safely remove those from your `<head>`:\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <link rel=\"icon\" type=\"image/svg+xml\" href=\"/icon.svg\" />\n        <title>My App</title>\n        <meta name=\"description\" content=\"My App is a...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <link rel=\"icon\" type=\"image/svg+xml\" href=\"/icon.svg\" />\n        <title>My App</title>\n        <meta name=\"description\" content=\"My App is a...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "from-vite.mdx#13",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\n5. Any [metadata files](/docs/app/getting-started/metadata-and-og-images#file-based-metadata)\n   such as `favicon.ico`, `icon.png`, `robots.txt` are automatically added to the application\n   `<head>` tag as long as you have them placed into the top level of the `app` directory. After\n   moving\n   [all supported files](/docs/app/getting-started/metadata-and-og-images#file-based-metadata)\n   into the `app` directory you can safely delete their `<link>` tags:\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <title>My App</title>\n        <meta name=\"description\" content=\"My App is a...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <head>\n        <title>My App</title>\n        <meta name=\"description\" content=\"My App is a...\" />\n      </head>\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "from-vite.mdx#14",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\n6. Finally, Next.js can manage your last `<head>` tags with the\n   [Metadata API](/docs/app/getting-started/metadata-and-og-images). Move your final metadata\n   info into an exported\n   [`metadata` object](/docs/app/api-reference/functions/generate-metadata#metadata-object):\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: 'My App',\n  description: 'My App is a...',\n}\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport const metadata = {\n  title: 'My App',\n  description: 'My App is a...',\n}\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <div id=\"root\">{children}</div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "from-vite.mdx#15",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\nWith the above changes, you shifted from declaring everything in your `index.html` to using Next.js'\nconvention-based approach built into the framework\n([Metadata API](/docs/app/getting-started/metadata-and-og-images)). This approach enables you\nto more easily improve your SEO and web shareability of your pages."
  },
  {
    "id": "from-vite.mdx#16",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "### Step 5: Create the Entrypoint Page\n\nOn Next.js you declare an entrypoint for your application by creating a `page.tsx` file. The\nclosest equivalent of this file on Vite is your `main.tsx` file. In this step, you’ll set up the\nentrypoint of your application.\n\n1. **Create a `[[...slug]]` directory in your `app` directory.**\n\nSince in this guide we're aiming first to set up our Next.js as an SPA (Single Page Application), you need your page entrypoint to catch all possible routes of your application. For that, create a new `[[...slug]]` directory in your `app` directory.\n\nThis directory is what is called an [optional catch-all route segment](/docs/app/api-reference/file-conventions/dynamic-routes#optional-catch-all-segments). Next.js uses a file-system based router where folders are used to define routes. This special directory will make sure that all routes of your application will be directed to its containing `page.tsx` file.\n\n2. **Create a new `page.tsx` file inside the `app/[[...slug]]` directory with the following content:**\n\n```tsx filename=\"app/[[...slug]]/page.tsx\" switcher\nimport '../../index.css'\n\nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}"
  },
  {
    "id": "from-vite.mdx#17",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```tsx filename=\"app/[[...slug]]/page.tsx\" switcher\nimport '../../index.css'\n\nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n\nexport default function Page() {\n  return '...' // We'll update this\n}"
  },
  {
    "id": "from-vite.mdx#18",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/[[...slug]]/page.js\" switcher\nimport '../../index.css'\n\nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n\nexport default function Page() {\n  return '...' // We'll update this\n}\n```\n\n> **Good to know**: `.js`, `.jsx`, or `.tsx` extensions can be used for Page files.\n\nThis file is a [Server Component](/docs/app/getting-started/server-and-client-components). When you run `next build`, the file is prerendered into a static asset. It does _not_ require any dynamic code.\n\nThis file imports our global CSS and tells [`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params) we are only going to generate one route, the index route at `/`.\n\nNow, let's move the rest of our Vite application which will run client-only.\n\n```tsx filename=\"app/[[...slug]]/client.tsx\" switcher\n'use client'\n\nimport React from 'react'\nimport dynamic from 'next/dynamic'\n\nconst App = dynamic(() => import('../../App'), { ssr: false })\n\nexport function ClientOnly() {\n  return <App />\n}"
  },
  {
    "id": "from-vite.mdx#19",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/[[...slug]]/client.js\" switcher\n'use client'\n\nimport React from 'react'\nimport dynamic from 'next/dynamic'\n\nconst App = dynamic(() => import('../../App'), { ssr: false })\n\nexport function ClientOnly() {\n  return <App />\n}\n```\n\nThis file is a [Client Component](/docs/app/getting-started/server-and-client-components), defined by the `'use client'`\ndirective. Client Components are still [prerendered to HTML](/docs/app/getting-started/server-and-client-components#how-do-server-and-client-components-work-in-nextjs) on the server before being sent to the client.\n\nSince we want a client-only application to start, we can configure Next.js to disable prerendering from the `App` component down.\n\n```tsx\nconst App = dynamic(() => import('../../App'), { ssr: false })\n```\n\nNow, update your entrypoint page to use the new component:\n\n```tsx filename=\"app/[[...slug]]/page.tsx\" switcher\nimport '../../index.css'\nimport { ClientOnly } from './client'\n\nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n\nexport default function Page() {\n  return <ClientOnly />\n}"
  },
  {
    "id": "from-vite.mdx#20",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/[[...slug]]/page.js\" switcher\nimport '../../index.css'\nimport { ClientOnly } from './client'\n\nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n\nexport default function Page() {\n  return <ClientOnly />\n}\n```"
  },
  {
    "id": "from-vite.mdx#21",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "### Step 6: Update Static Image Imports\n\nNext.js handles static image imports slightly different from Vite. With Vite, importing an image\nfile will return its public URL as a string:\n\n```tsx filename=\"App.tsx\"\nimport image from './img.png' // `image` will be '/assets/img.2d8efhg.png' in production\n\nexport default function App() {\n  return <img src={image} />\n}"
  },
  {
    "id": "from-vite.mdx#22",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\nWith Next.js, static image imports return an object. The object can then be used directly with the\nNext.js [`<Image>` component](/docs/app/api-reference/components/image), or you can use the object's\n`src` property with your existing `<img>` tag.\n\nThe `<Image>` component has the added benefits of\n[automatic image optimization](/docs/app/api-reference/components/image). The `<Image>`\ncomponent automatically sets the `width` and `height` attributes of the resulting `<img>` based on\nthe image's dimensions. This prevents layout shifts when the image loads. However, this can cause\nissues if your app contains images with only one of their dimensions being styled without the other\nstyled to `auto`. When not styled to `auto`, the dimension will default to the `<img>` dimension\nattribute's value, which can cause the image to appear distorted."
  },
  {
    "id": "from-vite.mdx#23",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "Keeping the `<img>` tag will reduce the amount of changes in your application and prevent the above\nissues. You can then optionally later migrate to the `<Image>` component to take advantage of optimizing images by [configuring a loader](/docs/app/api-reference/components/image#loader), or moving to the default Next.js server which has automatic image optimization.\n\n1. **Convert absolute import paths for images imported from `/public` into relative imports:**\n\n```tsx\n// Before\nimport logo from '/logo.png'\n\n// After\nimport logo from '../public/logo.png'"
  },
  {
    "id": "from-vite.mdx#24",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\n2. **Pass the image `src` property instead of the whole image object to your `<img>` tag:**\n\n```tsx\n// Before\n<img src={logo} />\n\n// After\n<img src={logo.src} />\n```\n\nAlternatively, you can reference the public URL for the image asset based on the filename. For example, `public/logo.png` will serve the image at `/logo.png` for your application, which would be the `src` value.\n\n> **Warning:** If you're using TypeScript, you might encounter type errors when accessing the `src`\n> property. You can safely ignore those for now. They will be fixed by the end of this guide."
  },
  {
    "id": "from-vite.mdx#25",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "### Step 7: Migrate the Environment Variables\n\nNext.js has support for `.env`\n[environment variables](/docs/app/guides/environment-variables)\nsimilar to Vite. The main difference is the prefix used to expose environment variables on the\nclient-side.\n\n- Change all environment variables with the `VITE_` prefix to `NEXT_PUBLIC_`.\n\nVite exposes a few built-in environment variables on the special `import.meta.env` object which\naren’t supported by Next.js. You need to update their usage as follows:\n\n- `import.meta.env.MODE` ⇒ `process.env.NODE_ENV`\n- `import.meta.env.PROD` ⇒ `process.env.NODE_ENV === 'production'`\n- `import.meta.env.DEV` ⇒ `process.env.NODE_ENV !== 'production'`\n- `import.meta.env.SSR` ⇒ `typeof window !== 'undefined'`\n\nNext.js also doesn't provide a built-in `BASE_URL` environment variable. However, you can still\nconfigure one, if you need it:\n\n1. **Add the following to your `.env` file:**\n\n```bash filename=\".env\"\n# ...\nNEXT_PUBLIC_BASE_PATH=\"/some-base-path\""
  },
  {
    "id": "from-vite.mdx#26",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "```\n\n2. **Set [`basePath`](/docs/app/api-reference/config/next-config-js/basePath) to `process.env.NEXT_PUBLIC_BASE_PATH` in your `next.config.mjs` file:**\n\n```js filename=\"next.config.mjs\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export', // Outputs a Single-Page Application (SPA).\n  distDir: './dist', // Changes the build output directory to `./dist/`.\n  basePath: process.env.NEXT_PUBLIC_BASE_PATH, // Sets the base path to `/some-base-path`.\n}\n\nexport default nextConfig\n```\n\n3. **Update `import.meta.env.BASE_URL` usages to `process.env.NEXT_PUBLIC_BASE_PATH`**"
  },
  {
    "id": "from-vite.mdx#27",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "### Step 8: Update Scripts in `package.json`\n\nYou should now be able to run your application to test if you successfully migrated to Next.js. But\nbefore that, you need to update your `scripts` in your `package.json` with Next.js related commands,\nand add `.next` and `next-env.d.ts` to your `.gitignore`:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\"\n  }\n}\n```\n\n```txt filename=\".gitignore\"\n# ...\n.next\nnext-env.d.ts\ndist\n```\n\nNow run `npm run dev`, and open [`http://localhost:3000`](http://localhost:3000). You should see your application now running on Next.js.\n\n> **Example:** Check out [this pull request](https://github.com/inngest/vite-to-nextjs/pull/1) for a\n> working example of a Vite application migrated to Next.js.\n\n### Step 9: Clean Up\n\nYou can now clean up your codebase from Vite related artifacts:\n\n- Delete `main.tsx`\n- Delete `index.html`\n- Delete `vite-env.d.ts`\n- Delete `tsconfig.node.json`\n- Delete `vite.config.ts`\n- Uninstall Vite dependencies"
  },
  {
    "id": "from-vite.mdx#28",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "## Next Steps\n\nIf everything went according to plan, you now have a functioning Next.js application running as a\nsingle-page application. However, you aren't yet taking advantage of most of Next.js' benefits, but\nyou can now start making incremental changes to reap all the benefits. Here's what you might want to\ndo next:\n\n- Migrate from React Router to the [Next.js App Router](/docs/app) to get:\n  - Automatic code splitting\n  - [Streaming Server-Rendering](/docs/app/api-reference/file-conventions/loading)\n  - [React Server Components](/docs/app/getting-started/server-and-client-components)\n- [Optimize images with the `<Image>` component](/docs/app/api-reference/components/image)\n- [Optimize fonts with `next/font`](/docs/app/api-reference/components/font)\n- [Optimize third-party scripts with the `<Script>` component](/docs/app/guides/scripts)\n- [Update your ESLint configuration to support Next.js rules](/docs/app/api-reference/config/eslint)"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Migrating",
      "description": "Learn how to migrate from popular frameworks to Next.js"
    },
    "content": "---\ntitle: Migrating\ndescription: Learn how to migrate from popular frameworks to Next.js\n---"
  },
  {
    "id": "multi-tenant.mdx#0",
    "metadata": {
      "title": "How to build multi-tenant apps in Next.js",
      "description": "Learn how to build multi-tenant apps with the App Router."
    },
    "content": "---\ntitle: How to build multi-tenant apps in Next.js\nnav_title: Multi-tenant\ndescription: Learn how to build multi-tenant apps with the App Router.\n---\n\nIf you are looking to build a single Next.js application that serves multiple tenants, we have [built an example](https://vercel.com/templates/next.js/platforms-starter-kit) showing our recommended architecture."
  },
  {
    "id": "multi-zones.mdx#0",
    "metadata": {
      "title": "How to build micro-frontends using multi-zones and Next.js",
      "description": "Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain."
    },
    "content": "---\ntitle: How to build micro-frontends using multi-zones and Next.js\nnav_title: Multi-zones\ndescription: Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n<details open>\n  <summary>Examples</summary>\n\n- [With Zones](https://github.com/vercel/next.js/tree/canary/examples/with-zones)\n\n</details>"
  },
  {
    "id": "multi-zones.mdx#1",
    "metadata": {
      "title": "How to build micro-frontends using multi-zones and Next.js",
      "description": "Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain."
    },
    "content": "<details open>\n  <summary>Examples</summary>\n\n- [With Zones](https://github.com/vercel/next.js/tree/canary/examples/with-zones)\n\n</details>\n\nMulti-Zones are an approach to micro-frontends that separate a large application on a domain into smaller Next.js applications that each serve a set of paths. This is useful when there are collections of pages unrelated to the other pages in the application. By moving those pages to a separate zone (i.e., a separate application), you can reduce the size of each application which improves build times and removes code that is only necessary for one of the zones. Since applications are decoupled, Multi-Zones also allows other applications on the domain to use their own choice of framework.\n\nFor example, let's say you have the following set of pages that you would like to split up:\n\n- `/blog/*` for all blog posts\n- `/dashboard/*` for all pages when the user is logged-in to the dashboard\n- `/*` for the rest of your website not covered by other zones"
  },
  {
    "id": "multi-zones.mdx#2",
    "metadata": {
      "title": "How to build micro-frontends using multi-zones and Next.js",
      "description": "Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain."
    },
    "content": "- `/blog/*` for all blog posts\n- `/dashboard/*` for all pages when the user is logged-in to the dashboard\n- `/*` for the rest of your website not covered by other zones\n\nWith Multi-Zones support, you can create three applications that all are served on the same domain and look the same to the user, but you can develop and deploy each of the applications independently.\n\n<Image\n  alt=\"Three zones: A, B, C. Showing a hard navigation between routes from different zones, and soft navigations between routes within the same zone.\"\n  srcLight=\"/docs/light/multi-zones.png\"\n  srcDark=\"/docs/dark/multi-zones.png\"\n  width=\"1600\"\n  height=\"750\"\n/>\n\nNavigating between pages in the same zone will perform soft navigations, a navigation that does not require reloading the page. For example, in this diagram, navigating from `/` to `/products` will be a soft navigation.\n\nNavigating from a page in one zone to a page in another zone, such as from `/` to `/dashboard`, will perform a hard navigation, unloading the resources of the current page and loading the resources of the new page. Pages that are frequently visited together should live in the same zone to avoid hard navigations."
  },
  {
    "id": "multi-zones.mdx#3",
    "metadata": {
      "title": "How to build micro-frontends using multi-zones and Next.js",
      "description": "Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain."
    },
    "content": "## How to define a zone\n\nA zone is a normal Next.js application where you also configure an [assetPrefix](/docs/app/api-reference/config/next-config-js/assetPrefix) to avoid conflicts with pages and static files in other zones.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  assetPrefix: '/blog-static',\n}\n```\n\nNext.js assets, such as JavaScript and CSS, will be prefixed with `assetPrefix` to make sure that they don't conflict with assets from other zones. These assets will be served under `/assetPrefix/_next/...` for each of the zones.\n\nThe default application handling all paths not routed to another more specific zone does not need an `assetPrefix`.\n\nIn versions older than Next.js 15, you may also need an additional rewrite to handle the static assets. This is no longer necessary in Next.js 15.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  assetPrefix: '/blog-static',\n  async rewrites() {\n    return {\n      beforeFiles: [\n        {\n          source: '/blog-static/_next/:path+',\n          destination: '/_next/:path+',\n        },\n      ],\n    }\n  },\n}\n```"
  },
  {
    "id": "multi-zones.mdx#4",
    "metadata": {
      "title": "How to build micro-frontends using multi-zones and Next.js",
      "description": "Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain."
    },
    "content": "## How to route requests to the right zone\n\nWith the Multi Zones set-up, you need to route the paths to the correct zone since they are served by different applications. You can use any HTTP proxy to do this, but one of the Next.js applications can also be used to route requests for the entire domain.\n\nTo route to the correct zone using a Next.js application, you can use [`rewrites`](/docs/app/api-reference/config/next-config-js/rewrites). For each path served by a different zone, you would add a rewrite rule to send that path to the domain of the other zone, and you also need to rewrite the requests for the static assets. For example:\n\n```js filename=\"next.config.js\"\nasync rewrites() {\n    return [\n        {\n            source: '/blog',\n            destination: `${process.env.BLOG_DOMAIN}/blog`,\n        },\n        {\n            source: '/blog/:path+',\n            destination: `${process.env.BLOG_DOMAIN}/blog/:path+`,\n        },\n        {\n            source: '/blog-static/:path+',\n            destination: `${process.env.BLOG_DOMAIN}/blog-static/:path+`,\n        }\n    ];\n}"
  },
  {
    "id": "multi-zones.mdx#5",
    "metadata": {
      "title": "How to build micro-frontends using multi-zones and Next.js",
      "description": "Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain."
    },
    "content": "```\n\n`destination` should be a URL that is served by the zone, including scheme and domain. This should point to the zone's production domain, but it can also be used to route requests to `localhost` in local development.\n\n> **Good to know**: URL paths should be unique to a zone. For example, two zones trying to serve `/blog` would create a routing conflict."
  },
  {
    "id": "multi-zones.mdx#6",
    "metadata": {
      "title": "How to build micro-frontends using multi-zones and Next.js",
      "description": "Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain."
    },
    "content": "### Routing requests using proxy\n\nRouting requests through [`rewrites`](/docs/app/api-reference/config/next-config-js/rewrites) is recommended to minimize latency overhead for the requests, but proxy can also be used when there is a need for a dynamic decision when routing. For example, if you are using a feature flag to decide where a path should be routed such as during a migration, you can use proxy.\n\n```js filename=\"proxy.js\"\nexport async function proxy(request) {\n  const { pathname, search } = req.nextUrl;\n  if (pathname === '/your-path' && myFeatureFlag.isEnabled()) {\n    return NextResponse.rewrite(`${rewriteDomain}${pathname}${search});\n  }\n}\n```"
  },
  {
    "id": "multi-zones.mdx#7",
    "metadata": {
      "title": "How to build micro-frontends using multi-zones and Next.js",
      "description": "Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain."
    },
    "content": "## Linking between zones\n\nLinks to paths in a different zone should use an `a` tag instead of the Next.js [`<Link>`](/docs/pages/api-reference/components/link) component. This is because Next.js will try to prefetch and soft navigate to any relative path in `<Link>` component, which will not work across zones.\n\n## Sharing code\n\nThe Next.js applications that make up the different zones can live in any repository. However, it is often convenient to put these zones in a [monorepo](https://en.wikipedia.org/wiki/Monorepo) to more easily share code. For zones that live in different repositories, code can also be shared using public or private NPM packages.\n\nSince the pages in different zones may be released at different times, feature flags can be useful for enabling or disabling features in unison across the different zones.\n\n<AppOnly>"
  },
  {
    "id": "multi-zones.mdx#8",
    "metadata": {
      "title": "How to build micro-frontends using multi-zones and Next.js",
      "description": "Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain."
    },
    "content": "## Server Actions\n\nWhen using [Server Actions](/docs/app/getting-started/updating-data) with Multi-Zones, you must explicitly allow the user-facing origin since your user facing domain may serve multiple applications. In your `next.config.js` file, add the following lines:\n\n```js filename=\"next.config.js\"\nconst nextConfig = {\n  experimental: {\n    serverActions: {\n      allowedOrigins: ['your-production-domain.com'],\n    },\n  },\n}\n```\n\nSee [`serverActions.allowedOrigins`](/docs/app/api-reference/config/next-config-js/serverActions#allowedorigins) for more information.\n\n</AppOnly>"
  },
  {
    "id": "open-telemetry.mdx#0",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "---\ntitle: How to set up instrumentation with OpenTelemetry\nnav_title: OpenTelemetry\ndescription: Learn how to instrument your Next.js app with OpenTelemetry.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nObservability is crucial for understanding and optimizing the behavior and performance of your Next.js app.\n\nAs applications become more complex, it becomes increasingly difficult to identify and diagnose issues that may arise. By leveraging observability tools, such as logging and metrics, developers can gain insights into their application's behavior and identify areas for optimization. With observability, developers can proactively address issues before they become major problems and provide a better user experience. Therefore, it is highly recommended to use observability in your Next.js applications to improve performance, optimize resources, and enhance user experience."
  },
  {
    "id": "open-telemetry.mdx#1",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "We recommend using OpenTelemetry for instrumenting your apps.\nIt's a platform-agnostic way to instrument apps that allows you to change your observability provider without changing your code.\nRead [Official OpenTelemetry docs](https://opentelemetry.io/docs/) for more information about OpenTelemetry and how it works.\n\nThis documentation uses terms like _Span_, _Trace_ or _Exporter_ throughout this doc, all of which can be found in [the OpenTelemetry Observability Primer](https://opentelemetry.io/docs/concepts/observability-primer/).\n\nNext.js supports OpenTelemetry instrumentation out of the box, which means that we already instrumented Next.js itself.\n\n<PagesOnly>\n  When you enable OpenTelemetry we will automatically wrap all your code like\n  `getStaticProps` in _spans_ with helpful attributes.\n</PagesOnly>"
  },
  {
    "id": "open-telemetry.mdx#2",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "## Getting Started\n\nOpenTelemetry is extensible but setting it up properly can be quite verbose.\nThat's why we prepared a package `@vercel/otel` that helps you get started quickly."
  },
  {
    "id": "open-telemetry.mdx#3",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "### Using `@vercel/otel`\n\nTo get started, install the following packages:\n\n```bash filename=\"Terminal\"\nnpm install @vercel/otel @opentelemetry/sdk-logs @opentelemetry/api-logs @opentelemetry/instrumentation\n```\n\n<AppOnly>\n\nNext, create a custom [`instrumentation.ts`](/docs/app/guides/instrumentation) (or `.js`) file in the **root directory** of the project (or inside `src` folder if using one):\n\n</AppOnly>\n\n<PagesOnly>\n\nNext, create a custom [`instrumentation.ts`](/docs/pages/guides/instrumentation) (or `.js`) file in the **root directory** of the project (or inside `src` folder if using one):\n\n</PagesOnly>\n\n```ts filename=\"your-project/instrumentation.ts\" switcher\nimport { registerOTel } from '@vercel/otel'\n\nexport function register() {\n  registerOTel({ serviceName: 'next-app' })\n}\n```\n\n```js filename=\"your-project/instrumentation.js\" switcher\nimport { registerOTel } from '@vercel/otel'\n\nexport function register() {\n  registerOTel({ serviceName: 'next-app' })\n}"
  },
  {
    "id": "open-telemetry.mdx#4",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "```\n\nSee the [`@vercel/otel` documentation](https://www.npmjs.com/package/@vercel/otel) for additional configuration options.\n\n<AppOnly>\n\n> **Good to know**:\n>\n> - The `instrumentation` file should be in the root of your project and not inside the `app` or `pages` directory. If you're using the `src` folder, then place the file inside `src` alongside `pages` and `app`.\n> - If you use the [`pageExtensions` config option](/docs/app/api-reference/config/next-config-js/pageExtensions) to add a suffix, you will also need to update the `instrumentation` filename to match.\n> - We have created a basic [with-opentelemetry](https://github.com/vercel/next.js/tree/canary/examples/with-opentelemetry) example that you can use.\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "open-telemetry.mdx#5",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "</AppOnly>\n\n<PagesOnly>\n\n> **Good to know**:\n>\n> - The `instrumentation` file should be in the root of your project and not inside the `app` or `pages` directory. If you're using the `src` folder, then place the file inside `src` alongside `pages` and `app`.\n> - If you use the [`pageExtensions` config option](/docs/pages/api-reference/config/next-config-js/pageExtensions) to add a suffix, you will also need to update the `instrumentation` filename to match.\n> - We have created a basic [with-opentelemetry](https://github.com/vercel/next.js/tree/canary/examples/with-opentelemetry) example that you can use.\n\n</PagesOnly>"
  },
  {
    "id": "open-telemetry.mdx#6",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "### Manual OpenTelemetry configuration\n\nThe `@vercel/otel` package provides many configuration options and should serve most of common use cases. But if it doesn't suit your needs, you can configure OpenTelemetry manually.\n\nFirstly you need to install OpenTelemetry packages:\n\n```bash filename=\"Terminal\"\nnpm install @opentelemetry/sdk-node @opentelemetry/resources @opentelemetry/semantic-conventions @opentelemetry/sdk-trace-node @opentelemetry/exporter-trace-otlp-http\n```\n\nNow you can initialize `NodeSDK` in your `instrumentation.ts`.\nUnlike `@vercel/otel`, `NodeSDK` is not compatible with edge runtime, so you need to make sure that you are importing them only when `process.env.NEXT_RUNTIME === 'nodejs'`. We recommend creating a new file `instrumentation.node.ts` which you conditionally import only when using node:\n\n```ts filename=\"instrumentation.ts\" switcher\nexport async function register() {\n  if (process.env.NEXT_RUNTIME === 'nodejs') {\n    await import('./instrumentation.node.ts')\n  }\n}\n```\n\n```js filename=\"instrumentation.js\" switcher\nexport async function register() {\n  if (process.env.NEXT_RUNTIME === 'nodejs') {\n    await import('./instrumentation.node.js')\n  }\n}"
  },
  {
    "id": "open-telemetry.mdx#7",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "```\n\n```js filename=\"instrumentation.js\" switcher\nexport async function register() {\n  if (process.env.NEXT_RUNTIME === 'nodejs') {\n    await import('./instrumentation.node.js')\n  }\n}\n```\n\n```ts filename=\"instrumentation.node.ts\" switcher\nimport { OTLPTraceExporter } from '@opentelemetry/exporter-trace-otlp-http'\nimport { resourceFromAttributes } from '@opentelemetry/resources'\nimport { NodeSDK } from '@opentelemetry/sdk-node'\nimport { SimpleSpanProcessor } from '@opentelemetry/sdk-trace-node'\nimport { ATTR_SERVICE_NAME } from '@opentelemetry/semantic-conventions'\n\nconst sdk = new NodeSDK({\n  resource: resourceFromAttributes({\n    [ATTR_SERVICE_NAME]: 'next-app',\n  }),\n  spanProcessor: new SimpleSpanProcessor(new OTLPTraceExporter()),\n})\nsdk.start()"
  },
  {
    "id": "open-telemetry.mdx#8",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "```\n\n```js filename=\"instrumentation.node.js\" switcher\nimport { OTLPTraceExporter } from '@opentelemetry/exporter-trace-otlp-http'\nimport { resourceFromAttributes } from '@opentelemetry/resources'\nimport { NodeSDK } from '@opentelemetry/sdk-node'\nimport { SimpleSpanProcessor } from '@opentelemetry/sdk-trace-node'\nimport { ATTR_SERVICE_NAME } from '@opentelemetry/semantic-conventions'\n\nconst sdk = new NodeSDK({\n  resource: resourceFromAttributes({\n    [ATTR_SERVICE_NAME]: 'next-app',\n  }),\n  spanProcessor: new SimpleSpanProcessor(new OTLPTraceExporter()),\n})\nsdk.start()\n```\n\nDoing this is equivalent to using `@vercel/otel`, but it's possible to modify and extend some features that are not exposed by the `@vercel/otel`. If edge runtime support is necessary, you will have to use `@vercel/otel`."
  },
  {
    "id": "open-telemetry.mdx#9",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "## Testing your instrumentation\n\nYou need an OpenTelemetry collector with a compatible backend to test OpenTelemetry traces locally.\nWe recommend using our [OpenTelemetry dev environment](https://github.com/vercel/opentelemetry-collector-dev-setup).\n\nIf everything works well you should be able to see the root server span labeled as `GET /requested/pathname`.\nAll other spans from that particular trace will be nested under it.\n\nNext.js traces more spans than are emitted by default.\nTo see more spans, you must set `NEXT_OTEL_VERBOSE=1`."
  },
  {
    "id": "open-telemetry.mdx#10",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "## Deployment\n\n### Using OpenTelemetry Collector\n\nWhen you are deploying with OpenTelemetry Collector, you can use `@vercel/otel`.\nIt will work both on Vercel and when self-hosted.\n\n#### Deploying on Vercel\n\nWe made sure that OpenTelemetry works out of the box on Vercel.\n\nFollow [Vercel documentation](https://vercel.com/docs/concepts/observability/otel-overview/quickstart) to connect your project to an observability provider.\n\n#### Self-hosting\n\nDeploying to other platforms is also straightforward. You will need to spin up your own OpenTelemetry Collector to receive and process the telemetry data from your Next.js app.\n\nTo do this, follow the [OpenTelemetry Collector Getting Started guide](https://opentelemetry.io/docs/collector/getting-started/), which will walk you through setting up the collector and configuring it to receive data from your Next.js app.\n\nOnce you have your collector up and running, you can deploy your Next.js app to your chosen platform following their respective deployment guides."
  },
  {
    "id": "open-telemetry.mdx#11",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "### Custom Exporters\n\nOpenTelemetry Collector is not necessary. You can use a custom OpenTelemetry exporter with [`@vercel/otel`](#using-vercelotel) or [manual OpenTelemetry configuration](#manual-opentelemetry-configuration)."
  },
  {
    "id": "open-telemetry.mdx#12",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "## Custom Spans\n\nYou can add a custom span with [OpenTelemetry APIs](https://opentelemetry.io/docs/instrumentation/js/instrumentation).\n\n```bash filename=\"Terminal\"\nnpm install @opentelemetry/api\n```\n\nThe following example demonstrates a function that fetches GitHub stars and adds a custom `fetchGithubStars` span to track the fetch request's result:\n\n```ts\nimport { trace } from '@opentelemetry/api'\n\nexport async function fetchGithubStars() {\n  return await trace\n    .getTracer('nextjs-example')\n    .startActiveSpan('fetchGithubStars', async (span) => {\n      try {\n        return await getValue()\n      } finally {\n        span.end()\n      }\n    })\n}\n```\n\nThe `register` function will execute before your code runs in a new environment.\nYou can start creating new spans, and they should be correctly added to the exported trace."
  },
  {
    "id": "open-telemetry.mdx#13",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "## Default Spans in Next.js\n\nNext.js automatically instruments several spans for you to provide useful insights into your application's performance.\n\nAttributes on spans follow [OpenTelemetry semantic conventions](https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/). We also add some custom attributes under the `next` namespace:\n\n- `next.span_name` - duplicates span name\n- `next.span_type` - each span type has a unique identifier\n- `next.route` - The route pattern of the request (e.g., `/[param]/user`).\n- `next.rsc` (true/false) - Whether the request is an RSC request, such as prefetch.\n- `next.page`\n  - This is an internal value used by an app router.\n  - You can think about it as a route to a special file (like `page.ts`, `layout.ts`, `loading.ts` and others)\n  - It can be used as a unique identifier only when paired with `next.route` because `/layout` can be used to identify both `/(groupA)/layout.ts` and `/(groupB)/layout.ts`"
  },
  {
    "id": "open-telemetry.mdx#14",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "### `[http.method] [next.route]`\n\n- `next.span_type`: `BaseServer.handleRequest`\n\nThis span represents the root span for each incoming request to your Next.js application. It tracks the HTTP method, route, target, and status code of the request.\n\nAttributes:\n\n- [Common HTTP attributes](https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#common-attributes)\n  - `http.method`\n  - `http.status_code`\n- [Server HTTP attributes](https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#http-server-semantic-conventions)\n  - `http.route`\n  - `http.target`\n- `next.span_name`\n- `next.span_type`\n- `next.route`\n\n### `render route (app) [next.route]`\n\n- `next.span_type`: `AppRender.getBodyResult`.\n\nThis span represents the process of rendering a route in the app router.\n\nAttributes:\n\n- `next.span_name`\n- `next.span_type`\n- `next.route`"
  },
  {
    "id": "open-telemetry.mdx#15",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "### `fetch [http.method] [http.url]`\n\n- `next.span_type`: `AppRender.fetch`\n\nThis span represents the fetch request executed in your code.\n\nAttributes:\n\n- [Common HTTP attributes](https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#common-attributes)\n  - `http.method`\n- [Client HTTP attributes](https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#http-client)\n  - `http.url`\n  - `net.peer.name`\n  - `net.peer.port` (only if specified)\n- `next.span_name`\n- `next.span_type`\n\nThis span can be turned off by setting `NEXT_OTEL_FETCH_DISABLED=1` in your environment. This is useful when you want to use a custom fetch instrumentation library.\n\n### `executing api route (app) [next.route]`\n\n- `next.span_type`: `AppRouteRouteHandlers.runHandler`.\n\nThis span represents the execution of an API Route Handler in the app router.\n\nAttributes:\n\n- `next.span_name`\n- `next.span_type`\n- `next.route`\n\n### `getServerSideProps [next.route]`\n\n- `next.span_type`: `Render.getServerSideProps`.\n\nThis span represents the execution of `getServerSideProps` for a specific route.\n\nAttributes:\n\n- `next.span_name`\n- `next.span_type`\n- `next.route`"
  },
  {
    "id": "open-telemetry.mdx#16",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "### `getStaticProps [next.route]`\n\n- `next.span_type`: `Render.getStaticProps`.\n\nThis span represents the execution of `getStaticProps` for a specific route.\n\nAttributes:\n\n- `next.span_name`\n- `next.span_type`\n- `next.route`\n\n### `render route (pages) [next.route]`\n\n- `next.span_type`: `Render.renderDocument`.\n\nThis span represents the process of rendering the document for a specific route.\n\nAttributes:\n\n- `next.span_name`\n- `next.span_type`\n- `next.route`\n\n### `generateMetadata [next.page]`\n\n- `next.span_type`: `ResolveMetadata.generateMetadata`.\n\nThis span represents the process of generating metadata for a specific page (a single route can have multiple of these spans).\n\nAttributes:\n\n- `next.span_name`\n- `next.span_type`\n- `next.page`\n\n### `resolve page components`\n\n- `next.span_type`: `NextNodeServer.findPageComponents`.\n\nThis span represents the process of resolving page components for a specific page.\n\nAttributes:\n\n- `next.span_name`\n- `next.span_type`\n- `next.route`"
  },
  {
    "id": "open-telemetry.mdx#17",
    "metadata": {
      "title": "How to set up instrumentation with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "### `resolve segment modules`\n\n- `next.span_type`: `NextNodeServer.getLayoutOrPageModule`.\n\nThis span represents loading of code modules for a layout or a page.\n\nAttributes:\n\n- `next.span_name`\n- `next.span_type`\n- `next.segment`\n\n### `start response`\n\n- `next.span_type`: `NextNodeServer.startResponse`.\n\nThis zero-length span represents the time when the first byte has been sent in the response."
  },
  {
    "id": "package-bundling.mdx#0",
    "metadata": {
      "title": "How to optimize package bundling",
      "description": "Learn how to optimize your application's server and client bundles."
    },
    "content": "---\ntitle: How to optimize package bundling\nnav_title: Package Bundling\ndescription: Learn how to optimize your application's server and client bundles.\nrelated:\n  description: Learn more about optimizing your application for production.\n  links:\n    - app/guides/production-checklist\n---\n\nBundling external packages can significantly improve the performance of your application. <AppOnly>By default, packages imported inside Server Components and Route Handlers are automatically bundled by Next.js. This page will guide you through how to analyze and further optimize package bundling.</AppOnly> <PagesOnly>By default, packages imported into your application are not bundled. This can impact performance or might not work if external packages are not pre-bundled, for example, if imported from a monorepo or `node_modules`. This page will guide you through how to analyze and configure package bundling.</PagesOnly>"
  },
  {
    "id": "package-bundling.mdx#1",
    "metadata": {
      "title": "How to optimize package bundling",
      "description": "Learn how to optimize your application's server and client bundles."
    },
    "content": "## Analyzing JavaScript bundles\n\n[`@next/bundle-analyzer`](https://www.npmjs.com/package/@next/bundle-analyzer) is a plugin for Next.js that helps you manage the size of your application bundles. It generates a visual report of the size of each package and their dependencies. You can use the information to remove large dependencies, split, or [lazy-load](/docs/app/guides/lazy-loading) your code.\n\n### Installation\n\nInstall the plugin by running the following command:\n\n```bash\nnpm i @next/bundle-analyzer\n# or\nyarn add @next/bundle-analyzer\n# or\npnpm add @next/bundle-analyzer\n```\n\nThen, add the bundle analyzer's settings to your `next.config.js`.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {}\n\nconst withBundleAnalyzer = require('@next/bundle-analyzer')({\n  enabled: process.env.ANALYZE === 'true',\n})\n\nmodule.exports = withBundleAnalyzer(nextConfig)\n```"
  },
  {
    "id": "package-bundling.mdx#2",
    "metadata": {
      "title": "How to optimize package bundling",
      "description": "Learn how to optimize your application's server and client bundles."
    },
    "content": "### Generating a report\n\nRun the following command to analyze your bundles:\n\n```bash\nANALYZE=true npm run build\n# or\nANALYZE=true yarn build\n# or\nANALYZE=true pnpm build\n```\n\nThe report will open three new tabs in your browser, which you can inspect. Periodically evaluating your application's bundles can help you maintain application performance over time."
  },
  {
    "id": "package-bundling.mdx#3",
    "metadata": {
      "title": "How to optimize package bundling",
      "description": "Learn how to optimize your application's server and client bundles."
    },
    "content": "## Optimizing package imports\n\nSome packages, such as icon libraries, can export hundreds of modules, which can cause performance issues in development and production.\n\nYou can optimize how these packages are imported by adding the [`optimizePackageImports`](/docs/app/api-reference/config/next-config-js/optimizePackageImports) option to your `next.config.js`. This option will only load the modules you _actually_ use, while still giving you the convenience of writing import statements with many named exports.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    optimizePackageImports: ['icon-library'],\n  },\n}\n\nmodule.exports = nextConfig\n```\n\nNext.js also optimizes some libraries automatically, thus they do not need to be included in the optimizePackageImports list. See the [full list](/docs/app/api-reference/config/next-config-js/optimizePackageImports).\n\n<PagesOnly>"
  },
  {
    "id": "package-bundling.mdx#4",
    "metadata": {
      "title": "How to optimize package bundling",
      "description": "Learn how to optimize your application's server and client bundles."
    },
    "content": "## Bundling specific packages\n\nTo bundle specific packages, you can use the [`transpilePackages`](/docs/app/api-reference/config/next-config-js/transpilePackages) option in your `next.config.js`. This option is useful for bundling external packages that are not pre-bundled, for example, in a monorepo or imported from `node_modules`.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  transpilePackages: ['package-name'],\n}\n\nmodule.exports = nextConfig\n```\n\n## Bundling all packages\n\nTo automatically bundle all packages (default behavior in the App Router), you can use the [`bundlePagesRouterDependencies`](/docs/pages/api-reference/config/next-config-js/bundlePagesRouterDependencies) option in your `next.config.js`.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  bundlePagesRouterDependencies: true,\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "package-bundling.mdx#5",
    "metadata": {
      "title": "How to optimize package bundling",
      "description": "Learn how to optimize your application's server and client bundles."
    },
    "content": "## Opting specific packages out of bundling\n\nIf you have the [`bundlePagesRouterDependencies`](/docs/pages/api-reference/config/next-config-js/bundlePagesRouterDependencies) option enabled, you can opt specific packages out of automatic bundling using the [`serverExternalPackages`](/docs/pages/api-reference/config/next-config-js/serverExternalPackages) option in your `next.config.js`:\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  // Automatically bundle external packages in the Pages Router:\n  bundlePagesRouterDependencies: true,\n  // Opt specific packages out of bundling for both App and Pages Router:\n  serverExternalPackages: ['package-name'],\n}\n\nmodule.exports = nextConfig\n```\n\n</PagesOnly>\n\n<AppOnly>"
  },
  {
    "id": "package-bundling.mdx#6",
    "metadata": {
      "title": "How to optimize package bundling",
      "description": "Learn how to optimize your application's server and client bundles."
    },
    "content": "## Opting specific packages out of bundling\n\nSince packages imported inside Server Components and Route Handlers are automatically bundled by Next.js, you can opt specific packages out of bundling using the [`serverExternalPackages`](/docs/app/api-reference/config/next-config-js/serverExternalPackages) option in your `next.config.js`.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  serverExternalPackages: ['package-name'],\n}\n\nmodule.exports = nextConfig\n```\n\nNext.js includes a list of popular packages that currently are working on compatibility and automatically opt-ed out. See the [full list](/docs/app/api-reference/config/next-config-js/serverExternalPackages).\n\n</AppOnly>"
  },
  {
    "id": "prefetching.mdx#0",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "---\ntitle: Prefetching\ndescription: Learn how to configure prefetching in Next.js\n---\n\nPrefetching makes navigating between different routes in your application feel instant. Next.js tries to intelligently prefetch by default, based on the links used in your application code.\n\nThis guide will explain how prefetching works and show common implementation patterns:\n\n- [Automatic prefetch](#automatic-prefetch)\n- [Manual prefetch](#manual-prefetch)\n- [Hover-triggered prefetch](#hover-triggered-prefetch)\n- [Extending or ejecting link](#extending-or-ejecting-link)\n- [Disabled prefetch](#disabled-prefetch)"
  },
  {
    "id": "prefetching.mdx#1",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "## How does prefetching work?\n\nWhen navigating between routes, the browser requests assets for the page like HTML and JavaScript files. Prefetching is the process of fetching these resources _ahead_ of time, before you navigate to a new route.\n\nNext.js automatically splits your application into smaller JavaScript chunks based on routes. Instead of loading all the code upfront like traditional SPAs, only the code needed for the current route is loaded. This reduces the initial load time while other parts of the app are loaded in the background. By the time you click the link, the resources for the new route have already been loaded into the browser cache.\n\nWhen navigating to the new page, there's no full page reload or browser loading spinner. Instead, Next.js performs a [client-side transition](/docs/app/getting-started/linking-and-navigating#client-side-transitions), making the page navigation feel instant."
  },
  {
    "id": "prefetching.mdx#2",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "## Prefetching static vs. dynamic routes\n\n|                                                                   | **Static page** | **Dynamic page**                                                                |\n| ----------------------------------------------------------------- | --------------- | ------------------------------------------------------------------------------- |\n| **Prefetched**                                                    | Yes, full route | No, unless [`loading.js`](/docs/app/api-reference/file-conventions/loading)     |\n| [**Client Cache TTL**](/docs/app/guides/caching#full-route-cache) | 5 min (default) | Off, unless [enabled](/docs/app/api-reference/config/next-config-js/staleTimes) |\n| **Server roundtrip on click**                                     | No              | Yes, streamed after [shell](/docs/app/getting-started/cache-components)         |\n\n> **Good to know:** During the initial navigation, the browser fetches the HTML, JavaScript, and React Server Components (RSC) Payload. For subsequent navigations, the browser will fetch the RSC Payload for Server Components and JS bundle for Client Components."
  },
  {
    "id": "prefetching.mdx#3",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "## Automatic prefetch\n\n```tsx filename=\"app/ui/nav-link.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function NavLink() {\n  return <Link href=\"/about\">About</Link>\n}\n```\n\n```jsx filename=\"app/ui/nav-link.js\" switcher\nimport Link from 'next/link'\n\nexport default function NavLink() {\n  return <Link href=\"/about\">About</Link>\n}\n```\n\n| **Context**       | **Prefetched payload**           | **Client Cache TTL**                                                           |\n| ----------------- | -------------------------------- | ------------------------------------------------------------------------------ |\n| No `loading.js`   | Entire page                      | Until app reload                                                               |\n| With `loading.js` | Layout to first loading boundary | 30s ([configurable](/docs/app/api-reference/config/next-config-js/staleTimes)) |\n\nAutomatic prefetching runs only in production. Disable with `prefetch={false}` or use the wrapper in [Disabled Prefetch](#disabled-prefetch)."
  },
  {
    "id": "prefetching.mdx#4",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "## Manual prefetch\n\nTo do manual prefetching, import the `useRouter` hook from `next/navigation`, and call `router.prefetch()` to warm routes outside the viewport or in response to analytics, hover, scroll, etc.\n\n```tsx\n'use client'\n\nimport { useRouter } from 'next/navigation'\nimport { CustomLink } from '@components/link'\n\nexport function PricingCard() {\n  const router = useRouter()\n\n  return (\n    <div onMouseEnter={() => router.prefetch('/pricing')}>\n      {/* other UI elements */}\n      <CustomLink href=\"/pricing\">View Pricing</CustomLink>\n    </div>\n  )\n}\n```\n\nIf the intent is to prefetch a URL when a component loads, see the extending or rejecting a link [example]."
  },
  {
    "id": "prefetching.mdx#5",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "## Hover-triggered prefetch\n\n> **Proceed with caution:** Extending `Link` opts you into maintaining prefetching, cache invalidation, and accessibility concerns. Proceed only if defaults are insufficient.\n\nNext.js tries to do the right prefetching by default, but power users can eject and modify based on their needs. You have the control between performance and resource consumption.\n\nFor example, you might have to only trigger prefetches on hover, instead of when entering the viewport (the default behavior):\n\n```tsx\n'use client'\n\nimport Link from 'next/link'\nimport { useState } from 'react'\n\nexport function HoverPrefetchLink({\n  href,\n  children,\n}: {\n  href: string\n  children: React.ReactNode\n}) {\n  const [active, setActive] = useState(false)\n\n  return (\n    <Link\n      href={href}\n      prefetch={active ? null : false}\n      onMouseEnter={() => setActive(true)}\n    >\n      {children}\n    </Link>\n  )\n}\n```\n\n`prefetch={null}` restores default (static) prefetching once the user shows intent."
  },
  {
    "id": "prefetching.mdx#6",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "## Extending or ejecting link\n\nYou can extend the `<Link>` component to create your own custom prefetching strategy. For example, using the [ForesightJS](https://foresightjs.com/docs/integrations/nextjs) library which prefetches links by predicting the direction of the user's cursor.\n\nAlternatively, you can use [`useRouter`](/docs/app/api-reference/functions/use-router) to recreate some of the native `<Link>` behavior. However, be aware this opts you into maintaining prefetching and cache invalidation.\n\n```tsx\n'use client'\n\nimport { useRouter } from 'next/navigation'\nimport { useEffect } from 'react'\n\nfunction ManualPrefetchLink({\n  href,\n  children,\n}: {\n  href: string\n  children: React.ReactNode\n}) {\n  const router = useRouter()\n\n  useEffect(() => {\n    let cancelled = false\n    const poll = () => {\n      if (!cancelled) router.prefetch(href, { onInvalidate: poll })\n    }\n    poll()\n    return () => {\n      cancelled = true\n    }\n  }, [href, router])\n\n  return (\n    <a\n      href={href}\n      onClick={(event) => {\n        event.preventDefault()\n        router.push(href)\n      }}\n    >\n      {children}\n    </a>\n  )\n}"
  },
  {
    "id": "prefetching.mdx#7",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "```\n\n[`onInvalidate`](/docs/app/api-reference/functions/use-router#userouter) is invoked when Next.js suspects cached data is stale, allowing you to refresh the prefetch.\n\n> **Good to know:** Using an `a` tag will cause a full page navigation to the destination route, you can use `onClick` to prevent the full page navigation, and then invoke `router.push` to navigate to the destination."
  },
  {
    "id": "prefetching.mdx#8",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "## Disabled prefetch\n\nYou can fully disable prefetching for certain routes for more fine-grained control over resource consumption.\n\n```tsx\n'use client'\n\nimport Link, { LinkProps } from 'next/link'\n\nfunction NoPrefetchLink({\n  prefetch,\n  ...rest\n}: LinkProps & { children: React.ReactNode }) {\n  return <Link {...rest} prefetch={false} />\n}\n```\n\nFor example, you may still want to have consistent usage of `<Link>` in your application, but links in your footer might not need to be prefetched when entering the viewport."
  },
  {
    "id": "prefetching.mdx#9",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "## Prefetching optimizations\n\n### Client cache\n\nNext.js stores prefetched React Server Component payloads in memory, keyed by route segments. When navigating between sibling routes (e.g. `/dashboard/settings` → `/dashboard/analytics`), it reuses the parent layout and only fetches the updated leaf page. This reduces network traffic and improves navigation speed.\n\n### Prefetch scheduling\n\nNext.js maintains a small task queue, which prefetches in the following order:\n\n1. Links in the viewport\n2. Links showing user intent (hover or touch)\n3. Newer links replace older ones\n4. Links scrolled off-screen are discarded\n\nThe scheduler prioritizes likely navigations while minimizing unused downloads.\n\n### Partial Prerendering (PPR)\n\nWhen PPR is enabled, a page is divided into a static shell and a streamed dynamic section:\n\n- The shell, which can be prefetched, streams immediately\n- Dynamic data streams when ready\n- Data invalidations (`revalidateTag`, `revalidatePath`) silently refresh associated prefetches"
  },
  {
    "id": "prefetching.mdx#10",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "## Troubleshooting"
  },
  {
    "id": "prefetching.mdx#11",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "### Triggering unwanted side-effects during prefetching\n\nIf your layouts or pages are not [pure](https://react.dev/learn/keeping-components-pure#purity-components-as-formulas) and have side-effects (e.g. tracking analytics), these might be triggered when the route is prefetched, not when the user visits the page.\n\nTo avoid this, you should move side-effects to a `useEffect` hook or a Server Action triggered from a Client Component.\n\n**Before**:\n\n```tsx filename=\"app/dashboard/layout.tsx\" switcher\nimport { trackPageView } from '@/lib/analytics'\n\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  // This runs during prefetch\n  trackPageView()\n\n  return <div>{children}</div>\n}\n```\n\n```jsx filename=\"app/dashboard/layout.js\" switcher\nimport { trackPageView } from '@/lib/analytics'\n\nexport default function Layout({ children }) {\n  // This runs during prefetch\n  trackPageView()\n\n  return <div>{children}</div>\n}"
  },
  {
    "id": "prefetching.mdx#12",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "```\n\n**After**:\n\n```tsx filename=\"app/ui/analytics-tracker.tsx\" switcher\n'use client'\n\nimport { useEffect } from 'react'\nimport { trackPageView } from '@/lib/analytics'\n\nexport function AnalyticsTracker() {\n  useEffect(() => {\n    trackPageView()\n  }, [])\n\n  return null\n}\n```\n\n```jsx filename=\"app/ui/analytics-tracker.js\" switcher\n'use client'\n\nimport { useEffect } from 'react'\nimport { trackPageView } from '@/lib/analytics'\n\nexport function AnalyticsTracker() {\n  useEffect(() => {\n    trackPageView()\n  }, [])\n\n  return null\n}\n```\n\n```tsx filename=\"app/dashboard/layout.tsx\" switcher\nimport { AnalyticsTracker } from '@/app/ui/analytics-tracker'\n\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    <div>\n      <AnalyticsTracker />\n      {children}\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/dashboard/layout.js\" switcher\nimport { AnalyticsTracker } from '@/app/ui/analytics-tracker'\n\nexport default function Layout({ children }) {\n  return (\n    <div>\n      <AnalyticsTracker />\n      {children}\n    </div>\n  )\n}\n```"
  },
  {
    "id": "prefetching.mdx#13",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "### Preventing too many prefetches\n\nNext.js automatically prefetches links in the viewport when using the `<Link>` component.\n\nThere may be cases where you want to prevent this to avoid unnecessary usage of resources, such as when rendering a large list of links (e.g. an infinite scroll table).\n\nYou can disable prefetching by setting the `prefetch` prop of the `<Link>` component to `false`.\n\n```tsx filename=\"app/ui/no-prefetch-link.tsx\" switcher\n<Link prefetch={false} href={`/blog/${post.id}`}>\n  {post.title}\n</Link>"
  },
  {
    "id": "prefetching.mdx#14",
    "metadata": {
      "title": "Prefetching",
      "description": "Learn how to configure prefetching in Next.js"
    },
    "content": "```\n\nHowever, this means static routes will only be fetched on click, and dynamic routes will wait for the server to render before navigating.\n\nTo reduce resource usage without disabling prefetch entirely, you can defer prefetching until the user hovers over a link. This targets only links the user is likely to visit.\n\n```tsx filename=\"app/ui/hover-prefetch-link.tsx\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useState } from 'react'\n\nexport function HoverPrefetchLink({\n  href,\n  children,\n}: {\n  href: string\n  children: React.ReactNode\n}) {\n  const [active, setActive] = useState(false)\n\n  return (\n    <Link\n      href={href}\n      prefetch={active ? null : false}\n      onMouseEnter={() => setActive(true)}\n    >\n      {children}\n    </Link>\n  )\n}\n```\n\n```jsx filename=\"app/ui/hover-prefetch-link.js\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useState } from 'react'\n\nexport function HoverPrefetchLink({ href, children }) {\n  const [active, setActive] = useState(false)\n\n  return (\n    <Link\n      href={href}\n      prefetch={active ? null : false}\n      onMouseEnter={() => setActive(true)}\n    >\n      {children}\n    </Link>\n  )\n}\n```"
  },
  {
    "id": "production-checklist.mdx#0",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "---\ntitle: How to optimize your Next.js application for production\nnav_title: Production\ndescription: Recommendations to ensure the best performance and user experience before taking your Next.js application to production.\n---\n\nBefore taking your Next.js application to production, there are some optimizations and patterns you should consider implementing for the best user experience, performance, and security.\n\nThis page provides best practices that you can use as a reference when [building your application](#during-development) and [before going to production](#before-going-to-production), as well as the [automatic Next.js optimizations](#automatic-optimizations) you should be aware of."
  },
  {
    "id": "production-checklist.mdx#1",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "## Automatic optimizations\n\nThese Next.js optimizations are enabled by default and require no configuration:\n\n<AppOnly>"
  },
  {
    "id": "production-checklist.mdx#2",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "- **[Server Components](/docs/app/getting-started/server-and-client-components):** Next.js uses Server Components by default. Server Components run on the server, and don't require JavaScript to render on the client. As such, they have no impact on the size of your client-side JavaScript bundles. You can then use [Client Components](/docs/app/getting-started/server-and-client-components) as needed for interactivity.\n- **[Code-splitting](/docs/app/getting-started/linking-and-navigating#how-navigation-works):** Server Components enable automatic code-splitting by route segments. You may also consider [lazy loading](/docs/app/guides/lazy-loading) Client Components and third-party libraries, where appropriate.\n- **[Prefetching](/docs/app/getting-started/linking-and-navigating#prefetching):** When a link to a new route enters the user's viewport, Next.js prefetches the route in background. This makes navigation to new routes almost instant. You can opt out of prefetching, where appropriate."
  },
  {
    "id": "production-checklist.mdx#3",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "- **[Static Rendering](/docs/app/guides/caching#static-rendering):** Next.js statically renders Server and Client Components on the server at build time and caches the rendered result to improve your application's performance. You can opt into [Dynamic Rendering](/docs/app/guides/caching#dynamic-rendering) for specific routes, where appropriate. {/* TODO: Update when PPR is stable */}\n- **[Caching](/docs/app/guides/caching):** Next.js caches data requests, the rendered result of Server and Client Components, static assets, and more, to reduce the number of network requests to your server, database, and backend services. You may opt out of caching, where appropriate."
  },
  {
    "id": "production-checklist.mdx#4",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "</AppOnly>\n\n<PagesOnly>\n\n- **[Code-splitting](/docs/pages/building-your-application/routing/pages-and-layouts):** Next.js automatically code-splits your application code by pages. This means only the code needed for the current page is loaded on navigation. You may also consider [lazy loading](/docs/pages/guides/lazy-loading) third-party libraries, where appropriate.\n- **[Prefetching](/docs/pages/api-reference/components/link#prefetch):** When a link to a new route enters the user's viewport, Next.js prefetches the route in background. This makes navigation to new routes almost instant. You can opt out of prefetching, where appropriate.\n- **[Automatic Static Optimization](/docs/pages/building-your-application/rendering/automatic-static-optimization):** Next.js automatically determines that a page is static (can be pre-rendered) if it has no blocking data requirements. Optimized pages can be cached, and served to the end-user from multiple CDN locations. You may opt into [Server-side Rendering](/docs/pages/building-your-application/data-fetching/get-server-side-props), where appropriate.\n\n</PagesOnly>"
  },
  {
    "id": "production-checklist.mdx#5",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "</PagesOnly>\n\nThese defaults aim to improve your application's performance, and reduce the cost and amount of data transferred on each network request."
  },
  {
    "id": "production-checklist.mdx#6",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "## During development\n\nWhile building your application, we recommend using the following features to ensure the best performance and user experience:"
  },
  {
    "id": "production-checklist.mdx#7",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "### Routing and rendering\n\n<AppOnly>"
  },
  {
    "id": "production-checklist.mdx#8",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "- **[Layouts](/docs/app/api-reference/file-conventions/layout):** Use layouts to share UI across pages and enable [partial rendering](/docs/app/getting-started/linking-and-navigating#client-side-transitions) on navigation.\n- **[`<Link>` component](/docs/app/api-reference/components/link):** Use the `<Link>` component for [client-side navigation and prefetching](/docs/app/getting-started/linking-and-navigating#how-navigation-works).\n- **[Error Handling](/docs/app/getting-started/error-handling):** Gracefully handle [catch-all errors](/docs/app/getting-started/error-handling) and [404 errors](/docs/app/api-reference/file-conventions/not-found) in production by creating custom error pages.\n- **[Client and Server Components](/docs/app/getting-started/server-and-client-components#examples):** Follow the recommended composition patterns for Server and Client Components, and check the placement of your [`\"use client\"` boundaries](/docs/app/getting-started/server-and-client-components#examples#moving-client-components-down-the-tree) to avoid unnecessarily increasing your client-side JavaScript bundle."
  },
  {
    "id": "production-checklist.mdx#9",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "- **[Dynamic APIs](/docs/app/guides/caching#dynamic-rendering):** Be aware that Dynamic APIs like [`cookies`](/docs/app/api-reference/functions/cookies) and the [`searchParams`](/docs/app/api-reference/file-conventions/page#searchparams-optional) prop will opt the entire route into [Dynamic Rendering](/docs/app/guides/caching#dynamic-rendering) (or your whole application if used in the [Root Layout](/docs/app/api-reference/file-conventions/layout#root-layout)). Ensure Dynamic API usage is intentional and wrap them in `<Suspense>` boundaries where appropriate."
  },
  {
    "id": "production-checklist.mdx#10",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "> **Good to know**: [Partial Prerendering (experimental)](/blog/next-14#partial-prerendering-preview) will allow parts of a route to be dynamic without opting the whole route into dynamic rendering.\n\n</AppOnly>\n\n<PagesOnly>\n\n- **[`<Link>` component](/docs/pages/building-your-application/routing/linking-and-navigating):** Use the `<Link>` component for client-side navigation and prefetching.\n- **[Custom Errors](/docs/pages/building-your-application/routing/custom-error):** Gracefully handle [500](/docs/pages/building-your-application/routing/custom-error#500-page) and [404 errors](/docs/pages/building-your-application/routing/custom-error#404-page)\n\n</PagesOnly>"
  },
  {
    "id": "production-checklist.mdx#11",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "### Data fetching and caching\n\n<AppOnly>"
  },
  {
    "id": "production-checklist.mdx#12",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "- **[Server Components](/docs/app/getting-started/fetching-data):** Leverage the benefits of fetching data on the server using Server Components.\n- **[Route Handlers](/docs/app/api-reference/file-conventions/route):** Use Route Handlers to access your backend resources from Client Components. But do not call Route Handlers from Server Components to avoid an additional server request.\n- **[Streaming](/docs/app/api-reference/file-conventions/loading):** Use Loading UI and React Suspense to progressively send UI from the server to the client, and prevent the whole route from blocking while data is being fetched.\n- **[Parallel Data Fetching](/docs/app/getting-started/fetching-data#parallel-data-fetching):** Reduce network waterfalls by fetching data in parallel, where appropriate. Also, consider [preloading data](/docs/app/getting-started/fetching-data#preloading-data) where appropriate.\n- **[Data Caching](/docs/app/guides/caching#data-cache):** Verify whether your data requests are being cached or not, and opt into caching, where appropriate. Ensure requests that don't use `fetch` are [cached](/docs/app/api-reference/functions/unstable_cache)."
  },
  {
    "id": "production-checklist.mdx#13",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "- **[Static Images](/docs/app/api-reference/file-conventions/public-folder):** Use the `public` directory to automatically cache your application's static assets, e.g. images."
  },
  {
    "id": "production-checklist.mdx#14",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "</AppOnly>\n\n<PagesOnly>\n\n- **[API Routes](/docs/pages/building-your-application/routing/api-routes):** Use Route Handlers to access your backend resources, and prevent sensitive secrets from being exposed to the client.\n- **[Data Caching](/docs/pages/building-your-application/data-fetching/get-static-props):** Verify whether your data requests are being cached or not, and opt into caching, where appropriate. Ensure requests that don't use `getStaticProps` are cached where appropriate.\n- **[Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration):** Use Incremental Static Regeneration to update static pages after they've been built, without rebuilding your entire site.\n- **[Static Images](/docs/pages/api-reference/file-conventions/public-folder):** Use the `public` directory to automatically cache your application's static assets, e.g. images.\n\n</PagesOnly>"
  },
  {
    "id": "production-checklist.mdx#15",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "### UI and accessibility\n\n<AppOnly>\n\n- **[Forms and Validation](/docs/app/guides/forms):** Use Server Actions to handle form submissions, server-side validation, and handle errors.\n- **[Global Error UI](/docs/app/api-reference/file-conventions/error#global-error):** Add `app/global-error.tsx` to provide consistent, accessible fallback UI and recovery for uncaught errors across your app.\n- **[Global 404](/docs/app/api-reference/file-conventions/not-found#global-not-foundjs-experimental):** Add `app/global-not-found.tsx` to serve an accessible 404 for unmatched routes across your app.\n\n</AppOnly>"
  },
  {
    "id": "production-checklist.mdx#16",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "</AppOnly>\n\n- **[Font Module](/docs/app/api-reference/components/font):** Optimize fonts by using the Font Module, which automatically hosts your font files with other static assets, removes external network requests, and reduces [layout shift](https://web.dev/articles/cls).\n- **[`<Image>` Component](/docs/app/api-reference/components/image):** Optimize images by using the Image Component, which automatically optimizes images, prevents layout shift, and serves them in modern formats like WebP.\n- **[`<Script>` Component](/docs/app/guides/scripts):** Optimize third-party scripts by using the Script Component, which automatically defers scripts and prevents them from blocking the main thread.\n- **[ESLint](/docs/architecture/accessibility#linting):** Use the built-in `eslint-plugin-jsx-a11y` plugin to catch accessibility issues early."
  },
  {
    "id": "production-checklist.mdx#17",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "### Security\n\n<AppOnly>\n\n- **[Tainting](/docs/app/api-reference/config/next-config-js/taint):** Prevent sensitive data from being exposed to the client by tainting data objects and/or specific values.\n- **[Server Actions](/docs/app/getting-started/updating-data):** Ensure users are authorized to call Server Actions. Review the recommended [security practices](/blog/security-nextjs-server-components-actions).\n\n</AppOnly>\n\n- **[Environment Variables](/docs/app/guides/environment-variables):** Ensure your `.env.*` files are added to `.gitignore` and only public variables are prefixed with `NEXT_PUBLIC_`.\n- **[Content Security Policy](/docs/app/guides/content-security-policy):** Consider adding a Content Security Policy to protect your application against various security threats such as cross-site scripting, clickjacking, and other code injection attacks."
  },
  {
    "id": "production-checklist.mdx#18",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "### Metadata and SEO\n\n<AppOnly>\n\n- **[Metadata API](/docs/app/getting-started/metadata-and-og-images):** Use the Metadata API to improve your application's Search Engine Optimization (SEO) by adding page titles, descriptions, and more.\n- **[Open Graph (OG) images](/docs/app/api-reference/file-conventions/metadata/opengraph-image):** Create OG images to prepare your application for social sharing.\n- **[Sitemaps](/docs/app/api-reference/functions/generate-sitemaps) and [Robots](/docs/app/api-reference/file-conventions/metadata/robots):** Help Search Engines crawl and index your pages by generating sitemaps and robots files.\n\n</AppOnly>\n\n<PagesOnly>\n\n- **[`<Head>` Component](/docs/pages/api-reference/components/head):** Use the `next/head` component to add page titles, descriptions, and more.\n\n</PagesOnly>\n\n### Type safety\n\n- **TypeScript and [TS Plugin](/docs/app/api-reference/config/typescript):** Use TypeScript and the TypeScript plugin for better type-safety, and to help you catch errors early."
  },
  {
    "id": "production-checklist.mdx#19",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "## Before going to production\n\nBefore going to production, you can run `next build` to build your application locally and catch any build errors, then run `next start` to measure the performance of your application in a production-like environment.\n\n### Core Web Vitals\n\n- **[Lighthouse](https://developers.google.com/web/tools/lighthouse):** Run lighthouse in incognito to gain a better understanding of how your users will experience your site, and to identify areas for improvement. This is a simulated test and should be paired with looking at field data (such as Core Web Vitals).\n\n<AppOnly>\n\n- **[`useReportWebVitals` hook](/docs/app/api-reference/functions/use-report-web-vitals):** Use this hook to send [Core Web Vitals](https://web.dev/articles/vitals) data to analytics tools.\n\n</AppOnly>"
  },
  {
    "id": "production-checklist.mdx#20",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "### Analyzing bundles\n\nUse the [`@next/bundle-analyzer` plugin](/docs/app/guides/package-bundling#analyzing-javascript-bundles) to analyze the size of your JavaScript bundles and identify large modules and dependencies that might be impacting your application's performance.\n\nAdditionally, the following tools can help you understand the impact of adding new dependencies to your application:\n\n- [Import Cost](https://marketplace.visualstudio.com/items?itemName=wix.vscode-import-cost)\n- [Package Phobia](https://packagephobia.com/)\n- [Bundle Phobia](https://bundlephobia.com/)\n- [bundlejs](https://bundlejs.com/)"
  },
  {
    "id": "progressive-web-apps.mdx#0",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "---\ntitle: How to build a Progressive Web Application (PWA) with Next.js\nnav_title: PWAs\ndescription: Learn how to build a Progressive Web Application (PWA) with Next.js.\nrelated:\n  links:\n    - app/api-reference/file-conventions/metadata/manifest\n---\n\nProgressive Web Applications (PWAs) offer the reach and accessibility of web applications combined with the features and user experience of native mobile apps. With Next.js, you can create PWAs that provide a seamless, app-like experience across all platforms without the need for multiple codebases or app store approvals.\n\nPWAs allow you to:\n\n- Deploy updates instantly without waiting for app store approval\n- Create cross-platform applications with a single codebase\n- Provide native-like features such as home screen installation and push notifications"
  },
  {
    "id": "progressive-web-apps.mdx#1",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "## Creating a PWA with Next.js"
  },
  {
    "id": "progressive-web-apps.mdx#2",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "### 1. Creating the Web App Manifest\n\nNext.js provides built-in support for creating a [web app manifest](/docs/app/api-reference/file-conventions/metadata/manifest) using the App Router. You can create either a static or dynamic manifest file:\n\nFor example, create a `app/manifest.ts` or `app/manifest.json` file:\n\n```tsx filename=\"app/manifest.ts\" switcher\nimport type { MetadataRoute } from 'next'\n\nexport default function manifest(): MetadataRoute.Manifest {\n  return {\n    name: 'Next.js PWA',\n    short_name: 'NextPWA',\n    description: 'A Progressive Web App built with Next.js',\n    start_url: '/',\n    display: 'standalone',\n    background_color: '#ffffff',\n    theme_color: '#000000',\n    icons: [\n      {\n        src: '/icon-192x192.png',\n        sizes: '192x192',\n        type: 'image/png',\n      },\n      {\n        src: '/icon-512x512.png',\n        sizes: '512x512',\n        type: 'image/png',\n      },\n    ],\n  }\n}"
  },
  {
    "id": "progressive-web-apps.mdx#3",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/manifest.js\" switcher\nexport default function manifest() {\n  return {\n    name: 'Next.js PWA',\n    short_name: 'NextPWA',\n    description: 'A Progressive Web App built with Next.js',\n    start_url: '/',\n    display: 'standalone',\n    background_color: '#ffffff',\n    theme_color: '#000000',\n    icons: [\n      {\n        src: '/icon-192x192.png',\n        sizes: '192x192',\n        type: 'image/png',\n      },\n      {\n        src: '/icon-512x512.png',\n        sizes: '512x512',\n        type: 'image/png',\n      },\n    ],\n  }\n}\n```\n\nThis file should contain information about the name, icons, and how it should be displayed as an icon on the user's device. This will allow users to install your PWA on their home screen, providing a native app-like experience.\n\nYou can use tools like [favicon generators](https://realfavicongenerator.net/) to create the different icon sets and place the generated files in your `public/` folder."
  },
  {
    "id": "progressive-web-apps.mdx#4",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "### 2. Implementing Web Push Notifications\n\nWeb Push Notifications are supported with all modern browsers, including:\n\n- iOS 16.4+ for applications installed to the home screen\n- Safari 16 for macOS 13 or later\n- Chromium based browsers\n- Firefox\n\nThis makes PWAs a viable alternative to native apps. Notably, you can trigger install prompts without needing offline support.\n\nWeb Push Notifications allow you to re-engage users even when they're not actively using your app. Here's how to implement them in a Next.js application:\n\nFirst, let's create the main page component in `app/page.tsx`. We'll break it down into smaller parts for better understanding. First, we’ll add some of the imports and utilities we’ll need. It’s okay that the referenced Server Actions do not yet exist:\n\n```tsx switcher\n'use client'\n\nimport { useState, useEffect } from 'react'\nimport { subscribeUser, unsubscribeUser, sendNotification } from './actions'\n\nfunction urlBase64ToUint8Array(base64String: string) {\n  const padding = '='.repeat((4 - (base64String.length % 4)) % 4)\n  const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/')"
  },
  {
    "id": "progressive-web-apps.mdx#5",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "const rawData = window.atob(base64)\n  const outputArray = new Uint8Array(rawData.length)\n\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i)\n  }\n  return outputArray\n}"
  },
  {
    "id": "progressive-web-apps.mdx#6",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "```\n\n```jsx switcher\n'use client'\n\nimport { useState, useEffect } from 'react'\nimport { subscribeUser, unsubscribeUser, sendNotification } from './actions'\n\nfunction urlBase64ToUint8Array(base64String) {\n  const padding = '='.repeat((4 - (base64String.length % 4)) % 4)\n  const base64 = (base64String + padding)\n    .replace(/\\\\-/g, '+')\n    .replace(/_/g, '/')\n\n  const rawData = window.atob(base64)\n  const outputArray = new Uint8Array(rawData.length)\n\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i)\n  }\n  return outputArray\n}"
  },
  {
    "id": "progressive-web-apps.mdx#7",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "```\n\nLet’s now add a component to manage subscribing, unsubscribing, and sending push notifications.\n\n```tsx switcher\nfunction PushNotificationManager() {\n  const [isSupported, setIsSupported] = useState(false)\n  const [subscription, setSubscription] = useState<PushSubscription | null>(\n    null\n  )\n  const [message, setMessage] = useState('')\n\n  useEffect(() => {\n    if ('serviceWorker' in navigator && 'PushManager' in window) {\n      setIsSupported(true)\n      registerServiceWorker()\n    }\n  }, [])\n\n  async function registerServiceWorker() {\n    const registration = await navigator.serviceWorker.register('/sw.js', {\n      scope: '/',\n      updateViaCache: 'none',\n    })\n    const sub = await registration.pushManager.getSubscription()\n    setSubscription(sub)\n  }"
  },
  {
    "id": "progressive-web-apps.mdx#8",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "async function subscribeToPush() {\n    const registration = await navigator.serviceWorker.ready\n    const sub = await registration.pushManager.subscribe({\n      userVisibleOnly: true,\n      applicationServerKey: urlBase64ToUint8Array(\n        process.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY!\n      ),\n    })\n    setSubscription(sub)\n    const serializedSub = JSON.parse(JSON.stringify(sub))\n    await subscribeUser(serializedSub)\n  }\n\n  async function unsubscribeFromPush() {\n    await subscription?.unsubscribe()\n    setSubscription(null)\n    await unsubscribeUser()\n  }\n\n  async function sendTestNotification() {\n    if (subscription) {\n      await sendNotification(message)\n      setMessage('')\n    }\n  }\n\n  if (!isSupported) {\n    return <p>Push notifications are not supported in this browser.</p>\n  }"
  },
  {
    "id": "progressive-web-apps.mdx#9",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "if (!isSupported) {\n    return <p>Push notifications are not supported in this browser.</p>\n  }\n\n  return (\n    <div>\n      <h3>Push Notifications</h3>\n      {subscription ? (\n        <>\n          <p>You are subscribed to push notifications.</p>\n          <button onClick={unsubscribeFromPush}>Unsubscribe</button>\n          <input\n            type=\"text\"\n            placeholder=\"Enter notification message\"\n            value={message}\n            onChange={(e) => setMessage(e.target.value)}\n          />\n          <button onClick={sendTestNotification}>Send Test</button>\n        </>\n      ) : (\n        <>\n          <p>You are not subscribed to push notifications.</p>\n          <button onClick={subscribeToPush}>Subscribe</button>\n        </>\n      )}\n    </div>\n  )\n}"
  },
  {
    "id": "progressive-web-apps.mdx#10",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "```\n\n```jsx switcher\nfunction PushNotificationManager() {\n  const [isSupported, setIsSupported] = useState(false);\n  const [subscription, setSubscription] = useState(null);\n  const [message, setMessage] = useState('');\n\n  useEffect(() => {\n    if ('serviceWorker' in navigator && 'PushManager' in window) {\n      setIsSupported(true);\n      registerServiceWorker();\n    }\n  }, []);\n\n  async function registerServiceWorker() {\n    const registration = await navigator.serviceWorker.register('/sw.js', {\n      scope: '/',\n      updateViaCache: 'none',\n    });\n    const sub = await registration.pushManager.getSubscription();\n    setSubscription(sub);\n  }\n\n  async function subscribeToPush() {\n    const registration = await navigator.serviceWorker.ready;\n    const sub = await registration.pushManager.subscribe({\n      userVisibleOnly: true,\n      applicationServerKey: urlBase64ToUint8Array(\n        process.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY!\n      ),\n    });\n    setSubscription(sub);\n    await subscribeUser(sub);\n  }\n\n  async function unsubscribeFromPush() {\n    await subscription?.unsubscribe();\n    setSubscription(null);\n    await unsubscribeUser();\n  }"
  },
  {
    "id": "progressive-web-apps.mdx#11",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "async function unsubscribeFromPush() {\n    await subscription?.unsubscribe();\n    setSubscription(null);\n    await unsubscribeUser();\n  }\n\n  async function sendTestNotification() {\n    if (subscription) {\n      await sendNotification(message);\n      setMessage('');\n    }\n  }\n\n  if (!isSupported) {\n    return <p>Push notifications are not supported in this browser.</p>;\n  }\n\n  return (\n    <div>\n      <h3>Push Notifications</h3>\n      {subscription ? (\n        <>\n          <p>You are subscribed to push notifications.</p>\n          <button onClick={unsubscribeFromPush}>Unsubscribe</button>\n          <input\n            type=\"text\"\n            placeholder=\"Enter notification message\"\n            value={message}\n            onChange={(e) => setMessage(e.target.value)}\n          />\n          <button onClick={sendTestNotification}>Send Test</button>\n        </>\n      ) : (\n        <>\n          <p>You are not subscribed to push notifications.</p>\n          <button onClick={subscribeToPush}>Subscribe</button>\n        </>\n      )}\n    </div>\n  );\n}"
  },
  {
    "id": "progressive-web-apps.mdx#12",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "```\n\nFinally, let’s create a component to show a message for iOS devices to instruct them to install to their home screen, and only show this if the app is not already installed.\n\n```tsx switcher\nfunction InstallPrompt() {\n  const [isIOS, setIsIOS] = useState(false)\n  const [isStandalone, setIsStandalone] = useState(false)\n\n  useEffect(() => {\n    setIsIOS(\n      /iPad|iPhone|iPod/.test(navigator.userAgent) && !(window as any).MSStream\n    )\n\n    setIsStandalone(window.matchMedia('(display-mode: standalone)').matches)\n  }, [])\n\n  if (isStandalone) {\n    return null // Don't show install button if already installed\n  }\n\n  return (\n    <div>\n      <h3>Install App</h3>\n      <button>Add to Home Screen</button>\n      {isIOS && (\n        <p>\n          To install this app on your iOS device, tap the share button\n          <span role=\"img\" aria-label=\"share icon\">\n            {' '}\n            ⎋{' '}\n          </span>\n          and then \"Add to Home Screen\"\n          <span role=\"img\" aria-label=\"plus icon\">\n            {' '}\n            ➕{' '}\n          </span>\n          .\n        </p>\n      )}\n    </div>\n  )\n}"
  },
  {
    "id": "progressive-web-apps.mdx#13",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "export default function Page() {\n  return (\n    <div>\n      <PushNotificationManager />\n      <InstallPrompt />\n    </div>\n  )\n}"
  },
  {
    "id": "progressive-web-apps.mdx#14",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "```\n\n```jsx switcher\nfunction InstallPrompt() {\n  const [isIOS, setIsIOS] = useState(false);\n  const [isStandalone, setIsStandalone] = useState(false);\n\n  useEffect(() => {\n    setIsIOS(\n      /iPad|iPhone|iPod/.test(navigator.userAgent) && !(window as any).MSStream\n    );\n\n    setIsStandalone(window.matchMedia('(display-mode: standalone)').matches);\n  }, []);\n\n  if (isStandalone) {\n    return null; // Don't show install button if already installed\n  }\n\n  return (\n    <div>\n      <h3>Install App</h3>\n      <button>Add to Home Screen</button>\n      {isIOS && (\n        <p>\n          To install this app on your iOS device, tap the share button\n          <span role=\"img\" aria-label=\"share icon\">\n            {' '}\n            ⎋{' '}\n          </span>\n          and then \"Add to Home Screen\"\n          <span role=\"img\" aria-label=\"plus icon\">\n            {' '}\n            ➕{' '}\n          </span>\n          .\n        </p>\n      )}\n    </div>\n  );\n}\n\nexport default function Page() {\n  return (\n    <div>\n      <PushNotificationManager />\n      <InstallPrompt />\n    </div>\n  );\n}\n```\n\nNow, let’s create the Server Actions which this file calls."
  },
  {
    "id": "progressive-web-apps.mdx#15",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "### 3. Implementing Server Actions\n\nCreate a new file to contain your actions at `app/actions.ts`. This file will handle creating subscriptions, deleting subscriptions, and sending notifications.\n\n```tsx filename=\"app/actions.ts\" switcher\n'use server'\n\nimport webpush from 'web-push'\n\nwebpush.setVapidDetails(\n  '<mailto:your-email@example.com>',\n  process.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY!,\n  process.env.VAPID_PRIVATE_KEY!\n)\n\nlet subscription: PushSubscription | null = null\n\nexport async function subscribeUser(sub: PushSubscription) {\n  subscription = sub\n  // In a production environment, you would want to store the subscription in a database\n  // For example: await db.subscriptions.create({ data: sub })\n  return { success: true }\n}\n\nexport async function unsubscribeUser() {\n  subscription = null\n  // In a production environment, you would want to remove the subscription from the database\n  // For example: await db.subscriptions.delete({ where: { ... } })\n  return { success: true }\n}\n\nexport async function sendNotification(message: string) {\n  if (!subscription) {\n    throw new Error('No subscription available')\n  }"
  },
  {
    "id": "progressive-web-apps.mdx#16",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "export async function sendNotification(message: string) {\n  if (!subscription) {\n    throw new Error('No subscription available')\n  }\n\n  try {\n    await webpush.sendNotification(\n      subscription,\n      JSON.stringify({\n        title: 'Test Notification',\n        body: message,\n        icon: '/icon.png',\n      })\n    )\n    return { success: true }\n  } catch (error) {\n    console.error('Error sending push notification:', error)\n    return { success: false, error: 'Failed to send notification' }\n  }\n}"
  },
  {
    "id": "progressive-web-apps.mdx#17",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/actions.js\" switcher\n'use server';\n\nimport webpush from 'web-push';\n\nwebpush.setVapidDetails(\n  '<mailto:your-email@example.com>',\n  process.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY!,\n  process.env.VAPID_PRIVATE_KEY!\n);\n\nlet subscription= null;\n\nexport async function subscribeUser(sub) {\n  subscription = sub;\n  // In a production environment, you would want to store the subscription in a database\n  // For example: await db.subscriptions.create({ data: sub })\n  return { success: true };\n}\n\nexport async function unsubscribeUser() {\n  subscription = null;\n  // In a production environment, you would want to remove the subscription from the database\n  // For example: await db.subscriptions.delete({ where: { ... } })\n  return { success: true };\n}\n\nexport async function sendNotification(message) {\n  if (!subscription) {\n    throw new Error('No subscription available');\n  }"
  },
  {
    "id": "progressive-web-apps.mdx#18",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "export async function sendNotification(message) {\n  if (!subscription) {\n    throw new Error('No subscription available');\n  }\n\n  try {\n    await webpush.sendNotification(\n      subscription,\n      JSON.stringify({\n        title: 'Test Notification',\n        body: message,\n        icon: '/icon.png',\n      })\n    );\n    return { success: true };\n  } catch (error) {\n    console.error('Error sending push notification:', error);\n    return { success: false, error: 'Failed to send notification' };\n  }\n}"
  },
  {
    "id": "progressive-web-apps.mdx#19",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "```\n\nSending a notification will be handled by our service worker, created in step 5.\n\nIn a production environment, you would want to store the subscription in a database for persistence across server restarts and to manage multiple users' subscriptions."
  },
  {
    "id": "progressive-web-apps.mdx#20",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "### 4. Generating VAPID Keys\n\nTo use the Web Push API, you need to generate [VAPID](https://vapidkeys.com/) keys. The simplest way is to use the web-push CLI directly:\n\nFirst, install web-push globally:\n\n```bash filename=\"Terminal\"\nnpm install -g web-push\n```\n\nGenerate the VAPID keys by running:\n\n```bash filename=\"Terminal\"\nweb-push generate-vapid-keys\n```\n\nCopy the output and paste the keys into your `.env` file:\n\n```\nNEXT_PUBLIC_VAPID_PUBLIC_KEY=your_public_key_here\nVAPID_PRIVATE_KEY=your_private_key_here\n```"
  },
  {
    "id": "progressive-web-apps.mdx#21",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "### 5. Creating a Service Worker\n\nCreate a `public/sw.js` file for your service worker:\n\n```js filename=\"public/sw.js\"\nself.addEventListener('push', function (event) {\n  if (event.data) {\n    const data = event.data.json()\n    const options = {\n      body: data.body,\n      icon: data.icon || '/icon.png',\n      badge: '/badge.png',\n      vibrate: [100, 50, 100],\n      data: {\n        dateOfArrival: Date.now(),\n        primaryKey: '2',\n      },\n    }\n    event.waitUntil(self.registration.showNotification(data.title, options))\n  }\n})\n\nself.addEventListener('notificationclick', function (event) {\n  console.log('Notification click received.')\n  event.notification.close()\n  event.waitUntil(clients.openWindow('<https://your-website.com>'))\n})"
  },
  {
    "id": "progressive-web-apps.mdx#22",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "```\n\nThis service worker supports custom images and notifications. It handles incoming push events and notification clicks.\n\n- You can set custom icons for notifications using the `icon` and `badge` properties.\n- The `vibrate` pattern can be adjusted to create custom vibration alerts on supported devices.\n- Additional data can be attached to the notification using the `data` property.\n\nRemember to test your service worker thoroughly to ensure it behaves as expected across different devices and browsers. Also, make sure to update the `'https://your-website.com'` link in the `notificationclick` event listener to the appropriate URL for your application."
  },
  {
    "id": "progressive-web-apps.mdx#23",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "### 6. Adding to Home Screen\n\nThe `InstallPrompt` component defined in step 2 shows a message for iOS devices to instruct them to install to their home screen.\n\nTo ensure your application can be installed to a mobile home screen, you must have:\n\n1. A valid web app manifest (created in step 1)\n2. The website served over HTTPS\n\nModern browsers will automatically show an installation prompt to users when these criteria are met. You can provide a custom installation button with [`beforeinstallprompt`](https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeinstallprompt_event), however, we do not recommend this as it is not cross browser and platform (does not work on Safari iOS)."
  },
  {
    "id": "progressive-web-apps.mdx#24",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "### 7. Testing Locally\n\nTo ensure you can view notifications locally, ensure that:\n\n- You are [running locally with HTTPS](/docs/app/api-reference/cli/next#using-https-during-development)\n  - Use `next dev --experimental-https` for testing\n- Your browser (Chrome, Safari, Firefox) has notifications enabled\n  - When prompted locally, accept permissions to use notifications\n  - Ensure notifications are not disabled globally for the entire browser\n  - If you are still not seeing notifications, try using another browser to debug"
  },
  {
    "id": "progressive-web-apps.mdx#25",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "### 8. Securing your application\n\nSecurity is a crucial aspect of any web application, especially for PWAs. Next.js allows you to configure security headers using the `next.config.js` file. For example:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async headers() {\n    return [\n      {\n        source: '/(.*)',\n        headers: [\n          {\n            key: 'X-Content-Type-Options',\n            value: 'nosniff',\n          },\n          {\n            key: 'X-Frame-Options',\n            value: 'DENY',\n          },\n          {\n            key: 'Referrer-Policy',\n            value: 'strict-origin-when-cross-origin',\n          },\n        ],\n      },\n      {\n        source: '/sw.js',\n        headers: [\n          {\n            key: 'Content-Type',\n            value: 'application/javascript; charset=utf-8',\n          },\n          {\n            key: 'Cache-Control',\n            value: 'no-cache, no-store, must-revalidate',\n          },\n          {\n            key: 'Content-Security-Policy',\n            value: \"default-src 'self'; script-src 'self'\",\n          },\n        ],\n      },\n    ]\n  },\n}"
  },
  {
    "id": "progressive-web-apps.mdx#26",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "```\n\nLet’s go over each of these options:\n\n1. Global Headers (applied to all routes):\n   1. `X-Content-Type-Options: nosniff`: Prevents MIME type sniffing, reducing the risk of malicious file uploads.\n   2. `X-Frame-Options: DENY`: Protects against clickjacking attacks by preventing your site from being embedded in iframes.\n   3. `Referrer-Policy: strict-origin-when-cross-origin`: Controls how much referrer information is included with requests, balancing security and functionality.\n2. Service Worker Specific Headers:\n   1. `Content-Type: application/javascript; charset=utf-8`: Ensures the service worker is interpreted correctly as JavaScript.\n   2. `Cache-Control: no-cache, no-store, must-revalidate`: Prevents caching of the service worker, ensuring users always get the latest version.\n   3. `Content-Security-Policy: default-src 'self'; script-src 'self'`: Implements a strict Content Security Policy for the service worker, only allowing scripts from the same origin.\n\nLearn more about defining [Content Security Policies](/docs/app/guides/content-security-policy) with Next.js."
  },
  {
    "id": "progressive-web-apps.mdx#27",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "## Extending your PWA"
  },
  {
    "id": "progressive-web-apps.mdx#28",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "1. **Exploring PWA Capabilities**: PWAs can leverage various web APIs to provide advanced functionality. Consider exploring features like background sync, periodic background sync, or the File System Access API to enhance your application. For inspiration and up-to-date information on PWA capabilities, you can refer to resources like [What PWA Can Do Today](https://whatpwacando.today/).\n2. **Static Exports:** If your application requires not running a server, and instead using a static export of files, you can update the Next.js configuration to enable this change. Learn more in the [Next.js Static Export documentation](/docs/app/guides/static-exports). However, you will need to move from Server Actions to calling an external API, as well as moving your defined headers to your proxy.\n3. **Offline Support**: To provide offline functionality, one option is [Serwist](https://github.com/serwist/serwist) with Next.js. You can find an example of how to integrate Serwist with Next.js in their [documentation](https://github.com/serwist/serwist/tree/main/examples/next-basic). **Note:** this plugin currently requires webpack configuration."
  },
  {
    "id": "progressive-web-apps.mdx#29",
    "metadata": {
      "title": "How to build a Progressive Web Application (PWA) with Next.js",
      "description": "Learn how to build a Progressive Web Application (PWA) with Next.js."
    },
    "content": "4. **Security Considerations**: Ensure that your service worker is properly secured. This includes using HTTPS, validating the source of push messages, and implementing proper error handling.\n5. **User Experience**: Consider implementing progressive enhancement techniques to ensure your app works well even when certain PWA features are not supported by the user's browser."
  },
  {
    "id": "redirecting.mdx#0",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "---\ntitle: How to handle redirects in Next.js\nnav_title: Redirecting\ndescription: Learn the different ways to handle redirects in Next.js.\nrelated:\n  links:\n    - app/api-reference/functions/redirect\n    - app/api-reference/functions/permanentRedirect\n    - app/api-reference/file-conventions/proxy\n    - app/api-reference/config/next-config-js/redirects\n---\n\nThere are a few ways you can handle redirects in Next.js. This page will go through each available option, use cases, and how to manage large numbers of redirects.\n\n<AppOnly>"
  },
  {
    "id": "redirecting.mdx#1",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "| API                                                           | Purpose                                           | Where                                             | Status Code                            |\n| ------------------------------------------------------------- | ------------------------------------------------- | ------------------------------------------------- | -------------------------------------- |\n| [`redirect`](#redirect-function)                              | Redirect user after a mutation or event           | Server Components, Server Actions, Route Handlers | 307 (Temporary) or 303 (Server Action) |\n| [`permanentRedirect`](#permanentredirect-function)            | Redirect user after a mutation or event           | Server Components, Server Actions, Route Handlers | 308 (Permanent)                        |\n| [`useRouter`](#userouter-hook)                                | Perform a client-side navigation                  | Event Handlers in Client Components               | N/A                                    |"
  },
  {
    "id": "redirecting.mdx#2",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "| [`redirects` in `next.config.js`](#redirects-in-nextconfigjs) | Redirect an incoming request based on a path      | `next.config.js` file                             | 307 (Temporary) or 308 (Permanent)     |\n| [`NextResponse.redirect`](#nextresponseredirect-in-proxy)     | Redirect an incoming request based on a condition | Proxy                                             | Any                                    |"
  },
  {
    "id": "redirecting.mdx#3",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "</AppOnly>\n\n<PagesOnly>\n\n| API                                                           | Purpose                                           | Where                 | Status Code                        |\n| ------------------------------------------------------------- | ------------------------------------------------- | --------------------- | ---------------------------------- |\n| [`useRouter`](#userouter-hook)                                | Perform a client-side navigation                  | Components            | N/A                                |\n| [`redirects` in `next.config.js`](#redirects-in-nextconfigjs) | Redirect an incoming request based on a path      | `next.config.js` file | 307 (Temporary) or 308 (Permanent) |\n| [`NextResponse.redirect`](#nextresponseredirect-in-proxy)     | Redirect an incoming request based on a condition | Proxy                 | Any                                |\n\n</PagesOnly>\n\n<AppOnly>"
  },
  {
    "id": "redirecting.mdx#4",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "## `redirect` function\n\nThe `redirect` function allows you to redirect the user to another URL. You can call `redirect` in [Server Components](/docs/app/getting-started/server-and-client-components), [Route Handlers](/docs/app/api-reference/file-conventions/route), and [Server Actions](/docs/app/getting-started/updating-data).\n\n`redirect` is often used after a mutation or event. For example, creating a post:\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { redirect } from 'next/navigation'\nimport { revalidatePath } from 'next/cache'\n\nexport async function createPost(id: string) {\n  try {\n    // Call database\n  } catch (error) {\n    // Handle errors\n  }\n\n  revalidatePath('/posts') // Update cached posts\n  redirect(`/post/${id}`) // Navigate to the new post page\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { redirect } from 'next/navigation'\nimport { revalidatePath } from 'next/cache'\n\nexport async function createPost(id) {\n  try {\n    // Call database\n  } catch (error) {\n    // Handle errors\n  }\n\n  revalidatePath('/posts') // Update cached posts\n  redirect(`/post/${id}`) // Navigate to the new post page\n}"
  },
  {
    "id": "redirecting.mdx#5",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\n> **Good to know**:\n>\n> - `redirect` returns a 307 (Temporary Redirect) status code by default. When used in a Server Action, it returns a 303 (See Other), which is commonly used for redirecting to a success page as a result of a POST request.\n> - `redirect` throws an error so it should be called **outside** the `try` block when using `try/catch` statements.\n> - `redirect` can be called in Client Components during the rendering process but not in event handlers. You can use the [`useRouter` hook](#userouter-hook) instead.\n> - `redirect` also accepts absolute URLs and can be used to redirect to external links.\n> - If you'd like to redirect before the render process, use [`next.config.js`](#redirects-in-nextconfigjs) or [Proxy](#nextresponseredirect-in-proxy).\n\nSee the [`redirect` API reference](/docs/app/api-reference/functions/redirect) for more information."
  },
  {
    "id": "redirecting.mdx#6",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "## `permanentRedirect` function\n\nThe `permanentRedirect` function allows you to **permanently** redirect the user to another URL. You can call `permanentRedirect` in [Server Components](/docs/app/getting-started/server-and-client-components), [Route Handlers](/docs/app/api-reference/file-conventions/route), and [Server Actions](/docs/app/getting-started/updating-data).\n\n`permanentRedirect` is often used after a mutation or event that changes an entity's canonical URL, such as updating a user's profile URL after they change their username:\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { permanentRedirect } from 'next/navigation'\nimport { revalidateTag } from 'next/cache'\n\nexport async function updateUsername(username: string, formData: FormData) {\n  try {\n    // Call database\n  } catch (error) {\n    // Handle errors\n  }\n\n  revalidateTag('username') // Update all references to the username\n  permanentRedirect(`/profile/${username}`) // Navigate to the new user profile\n}"
  },
  {
    "id": "redirecting.mdx#7",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { permanentRedirect } from 'next/navigation'\nimport { revalidateTag } from 'next/cache'\n\nexport async function updateUsername(username, formData) {\n  try {\n    // Call database\n  } catch (error) {\n    // Handle errors\n  }\n\n  revalidateTag('username') // Update all references to the username\n  permanentRedirect(`/profile/${username}`) // Navigate to the new user profile\n}\n```\n\n> **Good to know**:\n>\n> - `permanentRedirect` returns a 308 (permanent redirect) status code by default.\n> - `permanentRedirect` also accepts absolute URLs and can be used to redirect to external links.\n> - If you'd like to redirect before the render process, use [`next.config.js`](#redirects-in-nextconfigjs) or [Proxy](#nextresponseredirect-in-proxy).\n\nSee the [`permanentRedirect` API reference](/docs/app/api-reference/functions/permanentRedirect) for more information.\n\n</AppOnly>"
  },
  {
    "id": "redirecting.mdx#8",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "## `useRouter()` hook\n\n<AppOnly>\n\nIf you need to redirect inside an event handler in a Client Component, you can use the `push` method from the `useRouter` hook. For example:\n\n```tsx filename=\"app/page.tsx\" switcher\n'use client'\n\nimport { useRouter } from 'next/navigation'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button type=\"button\" onClick={() => router.push('/dashboard')}>\n      Dashboard\n    </button>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\n'use client'\n\nimport { useRouter } from 'next/navigation'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button type=\"button\" onClick={() => router.push('/dashboard')}>\n      Dashboard\n    </button>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nIf you need to redirect inside a component, you can use the `push` method from the `useRouter` hook. For example:\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { useRouter } from 'next/router'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button type=\"button\" onClick={() => router.push('/dashboard')}>\n      Dashboard\n    </button>\n  )\n}"
  },
  {
    "id": "redirecting.mdx#9",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nimport { useRouter } from 'next/router'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button type=\"button\" onClick={() => router.push('/dashboard')}>\n      Dashboard\n    </button>\n  )\n}\n```\n\n</PagesOnly>\n\n> **Good to know**:\n>\n> - If you don't need to programmatically navigate a user, you should use a [`<Link>`](/docs/app/api-reference/components/link) component.\n\n<AppOnly>\n\nSee the [`useRouter` API reference](/docs/app/api-reference/functions/use-router) for more information.\n\n</AppOnly>\n\n<PagesOnly>\n\nSee the [`useRouter` API reference](/docs/pages/api-reference/functions/use-router) for more information.\n\n</PagesOnly>"
  },
  {
    "id": "redirecting.mdx#10",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "## `redirects` in `next.config.js`\n\nThe `redirects` option in the `next.config.js` file allows you to redirect an incoming request path to a different destination path. This is useful when you change the URL structure of pages or have a list of redirects that are known ahead of time.\n\n`redirects` supports [path](/docs/app/api-reference/config/next-config-js/redirects#path-matching), [header, cookie, and query matching](/docs/app/api-reference/config/next-config-js/redirects#header-cookie-and-query-matching), giving you the flexibility to redirect users based on an incoming request.\n\nTo use `redirects`, add the option to your `next.config.js` file:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  async redirects() {\n    return [\n      // Basic redirect\n      {\n        source: '/about',\n        destination: '/',\n        permanent: true,\n      },\n      // Wildcard path matching\n      {\n        source: '/blog/:slug',\n        destination: '/news/:slug',\n        permanent: true,\n      },\n    ]\n  },\n}\n\nexport default nextConfig"
  },
  {
    "id": "redirecting.mdx#11",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  async redirects() {\n    return [\n      // Basic redirect\n      {\n        source: '/about',\n        destination: '/',\n        permanent: true,\n      },\n      // Wildcard path matching\n      {\n        source: '/blog/:slug',\n        destination: '/news/:slug',\n        permanent: true,\n      },\n    ]\n  },\n}\n```\n\nSee the [`redirects` API reference](/docs/app/api-reference/config/next-config-js/redirects) for more information.\n\n> **Good to know**:\n>\n> - `redirects` can return a 307 (Temporary Redirect) or 308 (Permanent Redirect) status code with the `permanent` option.\n> - `redirects` may have a limit on platforms. For example, on Vercel, there's a limit of 1,024 redirects. To manage a large number of redirects (1000+), consider creating a custom solution using [Proxy](/docs/app/api-reference/file-conventions/proxy). See [managing redirects at scale](#managing-redirects-at-scale-advanced) for more.\n> - `redirects` runs **before** Proxy."
  },
  {
    "id": "redirecting.mdx#12",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "## `NextResponse.redirect` in Proxy\n\nProxy allows you to run code before a request is completed. Then, based on the incoming request, redirect to a different URL using `NextResponse.redirect`. This is useful if you want to redirect users based on a condition (e.g. authentication, session management, etc) or have [a large number of redirects](#managing-redirects-at-scale-advanced).\n\nFor example, to redirect the user to a `/login` page if they are not authenticated:\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextResponse, NextRequest } from 'next/server'\nimport { authenticate } from 'auth-provider'\n\nexport function proxy(request: NextRequest) {\n  const isAuthenticated = authenticate(request)\n\n  // If the user is authenticated, continue as normal\n  if (isAuthenticated) {\n    return NextResponse.next()\n  }\n\n  // Redirect to login page if not authenticated\n  return NextResponse.redirect(new URL('/login', request.url))\n}\n\nexport const config = {\n  matcher: '/dashboard/:path*',\n}"
  },
  {
    "id": "redirecting.mdx#13",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\nimport { authenticate } from 'auth-provider'\n\nexport function proxy(request) {\n  const isAuthenticated = authenticate(request)\n\n  // If the user is authenticated, continue as normal\n  if (isAuthenticated) {\n    return NextResponse.next()\n  }\n\n  // Redirect to login page if not authenticated\n  return NextResponse.redirect(new URL('/login', request.url))\n}\n\nexport const config = {\n  matcher: '/dashboard/:path*',\n}\n```\n\n> **Good to know**:\n>\n> - Proxy runs **after** `redirects` in `next.config.js` and **before** rendering.\n\nSee the [Proxy](/docs/app/api-reference/file-conventions/proxy) documentation for more information."
  },
  {
    "id": "redirecting.mdx#14",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "## Managing redirects at scale (advanced)\n\nTo manage a large number of redirects (1000+), you may consider creating a custom solution using Proxy. This allows you to handle redirects programmatically without having to redeploy your application.\n\nTo do this, you'll need to consider:\n\n1. Creating and storing a redirect map.\n2. Optimizing data lookup performance.\n\n> **Next.js Example**: See our [Proxy with Bloom filter](https://redirects-bloom-filter.vercel.app/) example for an implementation of the recommendations below."
  },
  {
    "id": "redirecting.mdx#15",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "### 1. Creating and storing a redirect map\n\nA redirect map is a list of redirects that you can store in a database (usually a key-value store) or JSON file.\n\nConsider the following data structure:\n\n```json\n{\n  \"/old\": {\n    \"destination\": \"/new\",\n    \"permanent\": true\n  },\n  \"/blog/post-old\": {\n    \"destination\": \"/blog/post-new\",\n    \"permanent\": true\n  }\n}"
  },
  {
    "id": "redirecting.mdx#16",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\nIn [Proxy](/docs/app/api-reference/file-conventions/proxy), you can read from a database such as Vercel's [Edge Config](https://vercel.com/docs/edge-config/get-started) or [Redis](https://vercel.com/docs/redis), and redirect the user based on the incoming request:\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextResponse, NextRequest } from 'next/server'\nimport { get } from '@vercel/edge-config'\n\ntype RedirectEntry = {\n  destination: string\n  permanent: boolean\n}\n\nexport async function proxy(request: NextRequest) {\n  const pathname = request.nextUrl.pathname\n  const redirectData = await get(pathname)\n\n  if (redirectData && typeof redirectData === 'string') {\n    const redirectEntry: RedirectEntry = JSON.parse(redirectData)\n    const statusCode = redirectEntry.permanent ? 308 : 307\n    return NextResponse.redirect(redirectEntry.destination, statusCode)\n  }\n\n  // No redirect found, continue without redirecting\n  return NextResponse.next()\n}"
  },
  {
    "id": "redirecting.mdx#17",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\nimport { get } from '@vercel/edge-config'\n\nexport async function proxy(request) {\n  const pathname = request.nextUrl.pathname\n  const redirectData = await get(pathname)\n\n  if (redirectData) {\n    const redirectEntry = JSON.parse(redirectData)\n    const statusCode = redirectEntry.permanent ? 308 : 307\n    return NextResponse.redirect(redirectEntry.destination, statusCode)\n  }\n\n  // No redirect found, continue without redirecting\n  return NextResponse.next()\n}\n```"
  },
  {
    "id": "redirecting.mdx#18",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "### 2. Optimizing data lookup performance\n\nReading a large dataset for every incoming request can be slow and expensive. There are two ways you can optimize data lookup performance:\n\n- Use a database that is optimized for fast reads\n- Use a data lookup strategy such as a [Bloom filter](https://en.wikipedia.org/wiki/Bloom_filter) to efficiently check if a redirect exists **before** reading the larger redirects file or database.\n\nConsidering the previous example, you can import a generated bloom filter file into Proxy, then, check if the incoming request pathname exists in the bloom filter.\n\nIf it does, forward the request to a <AppOnly>[Route Handler](/docs/app/api-reference/file-conventions/route)</AppOnly> <PagesOnly>[API Routes](/docs/pages/building-your-application/routing/api-routes)</PagesOnly> which will check the actual file and redirect the user to the appropriate URL. This avoids importing a large redirects file into Proxy, which can slow down every incoming request.\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextResponse, NextRequest } from 'next/server'\nimport { ScalableBloomFilter } from 'bloom-filters'\nimport GeneratedBloomFilter from './redirects/bloom-filter.json'"
  },
  {
    "id": "redirecting.mdx#19",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "type RedirectEntry = {\n  destination: string\n  permanent: boolean\n}\n\n// Initialize bloom filter from a generated JSON file\nconst bloomFilter = ScalableBloomFilter.fromJSON(GeneratedBloomFilter as any)\n\nexport async function proxy(request: NextRequest) {\n  // Get the path for the incoming request\n  const pathname = request.nextUrl.pathname\n\n  // Check if the path is in the bloom filter\n  if (bloomFilter.has(pathname)) {\n    // Forward the pathname to the Route Handler\n    const api = new URL(\n      `/api/redirects?pathname=${encodeURIComponent(request.nextUrl.pathname)}`,\n      request.nextUrl.origin\n    )\n\n    try {\n      // Fetch redirect data from the Route Handler\n      const redirectData = await fetch(api)\n\n      if (redirectData.ok) {\n        const redirectEntry: RedirectEntry | undefined =\n          await redirectData.json()\n\n        if (redirectEntry) {\n          // Determine the status code\n          const statusCode = redirectEntry.permanent ? 308 : 307\n\n          // Redirect to the destination\n          return NextResponse.redirect(redirectEntry.destination, statusCode)\n        }\n      }\n    } catch (error) {\n      console.error(error)\n    }\n  }"
  },
  {
    "id": "redirecting.mdx#20",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "// Redirect to the destination\n          return NextResponse.redirect(redirectEntry.destination, statusCode)\n        }\n      }\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  // No redirect found, continue the request without redirecting\n  return NextResponse.next()\n}"
  },
  {
    "id": "redirecting.mdx#21",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\nimport { ScalableBloomFilter } from 'bloom-filters'\nimport GeneratedBloomFilter from './redirects/bloom-filter.json'\n\n// Initialize bloom filter from a generated JSON file\nconst bloomFilter = ScalableBloomFilter.fromJSON(GeneratedBloomFilter)\n\nexport async function proxy(request) {\n  // Get the path for the incoming request\n  const pathname = request.nextUrl.pathname\n\n  // Check if the path is in the bloom filter\n  if (bloomFilter.has(pathname)) {\n    // Forward the pathname to the Route Handler\n    const api = new URL(\n      `/api/redirects?pathname=${encodeURIComponent(request.nextUrl.pathname)}`,\n      request.nextUrl.origin\n    )\n\n    try {\n      // Fetch redirect data from the Route Handler\n      const redirectData = await fetch(api)\n\n      if (redirectData.ok) {\n        const redirectEntry = await redirectData.json()\n\n        if (redirectEntry) {\n          // Determine the status code\n          const statusCode = redirectEntry.permanent ? 308 : 307"
  },
  {
    "id": "redirecting.mdx#22",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "if (redirectEntry) {\n          // Determine the status code\n          const statusCode = redirectEntry.permanent ? 308 : 307\n\n          // Redirect to the destination\n          return NextResponse.redirect(redirectEntry.destination, statusCode)\n        }\n      }\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  // No redirect found, continue the request without redirecting\n  return NextResponse.next()\n}"
  },
  {
    "id": "redirecting.mdx#23",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\n<AppOnly>\n\nThen, in the Route Handler:\n\n```ts filename=\"app/api/redirects/route.ts\" switcher\nimport { NextRequest, NextResponse } from 'next/server'\nimport redirects from '@/app/redirects/redirects.json'\n\ntype RedirectEntry = {\n  destination: string\n  permanent: boolean\n}\n\nexport function GET(request: NextRequest) {\n  const pathname = request.nextUrl.searchParams.get('pathname')\n  if (!pathname) {\n    return new Response('Bad Request', { status: 400 })\n  }\n\n  // Get the redirect entry from the redirects.json file\n  const redirect = (redirects as Record<string, RedirectEntry>)[pathname]\n\n  // Account for bloom filter false positives\n  if (!redirect) {\n    return new Response('No redirect', { status: 400 })\n  }\n\n  // Return the redirect entry\n  return NextResponse.json(redirect)\n}"
  },
  {
    "id": "redirecting.mdx#24",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\n```js filename=\"app/api/redirects/route.js\" switcher\nimport { NextResponse } from 'next/server'\nimport redirects from '@/app/redirects/redirects.json'\n\nexport function GET(request) {\n  const pathname = request.nextUrl.searchParams.get('pathname')\n  if (!pathname) {\n    return new Response('Bad Request', { status: 400 })\n  }\n\n  // Get the redirect entry from the redirects.json file\n  const redirect = redirects[pathname]\n\n  // Account for bloom filter false positives\n  if (!redirect) {\n    return new Response('No redirect', { status: 400 })\n  }\n\n  // Return the redirect entry\n  return NextResponse.json(redirect)\n}"
  },
  {
    "id": "redirecting.mdx#25",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\nThen, in the API Route:\n\n```ts filename=\"pages/api/redirects.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\nimport redirects from '@/app/redirects/redirects.json'\n\ntype RedirectEntry = {\n  destination: string\n  permanent: boolean\n}\n\nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  const pathname = req.query.pathname\n  if (!pathname) {\n    return res.status(400).json({ message: 'Bad Request' })\n  }\n\n  // Get the redirect entry from the redirects.json file\n  const redirect = (redirects as Record<string, RedirectEntry>)[pathname]\n\n  // Account for bloom filter false positives\n  if (!redirect) {\n    return res.status(400).json({ message: 'No redirect' })\n  }\n\n  // Return the redirect entry\n  return res.json(redirect)\n}"
  },
  {
    "id": "redirecting.mdx#26",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "```\n\n```js filename=\"pages/api/redirects.js\" switcher\nimport redirects from '@/app/redirects/redirects.json'\n\nexport default function handler(req, res) {\n  const pathname = req.query.pathname\n  if (!pathname) {\n    return res.status(400).json({ message: 'Bad Request' })\n  }\n\n  // Get the redirect entry from the redirects.json file\n  const redirect = redirects[pathname]\n\n  // Account for bloom filter false positives\n  if (!redirect) {\n    return res.status(400).json({ message: 'No redirect' })\n  }\n\n  // Return the redirect entry\n  return res.json(redirect)\n}\n```\n\n</PagesOnly>\n\n> **Good to know:**\n>\n> - To generate a bloom filter, you can use a library like [`bloom-filters`](https://www.npmjs.com/package/bloom-filters).\n> - You should validate requests made to your Route Handler to prevent malicious requests."
  },
  {
    "id": "sass.mdx#0",
    "metadata": {
      "title": "How to use Sass",
      "description": "Style your Next.js application using Sass."
    },
    "content": "---\ntitle: How to use Sass\nnav_title: Sass\ndescription: Style your Next.js application using Sass.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js has built-in support for integrating with Sass after the package is installed using both the `.scss` and `.sass` extensions. You can use component-level Sass via CSS Modules and the `.module.scss`or `.module.sass` extension.\n\nFirst, install [`sass`](https://github.com/sass/sass):\n\n```bash filename=\"Terminal\"\nnpm install --save-dev sass"
  },
  {
    "id": "sass.mdx#1",
    "metadata": {
      "title": "How to use Sass",
      "description": "Style your Next.js application using Sass."
    },
    "content": "```\n\n> **Good to know**:\n>\n> Sass supports [two different syntaxes](https://sass-lang.com/documentation/syntax), each with their own extension.\n> The `.scss` extension requires you use the [SCSS syntax](https://sass-lang.com/documentation/syntax#scss),\n> while the `.sass` extension requires you use the [Indented Syntax (\"Sass\")](https://sass-lang.com/documentation/syntax#the-indented-syntax).\n>\n> If you're not sure which to choose, start with the `.scss` extension which is a superset of CSS, and doesn't require you learn the\n> Indented Syntax (\"Sass\")."
  },
  {
    "id": "sass.mdx#2",
    "metadata": {
      "title": "How to use Sass",
      "description": "Style your Next.js application using Sass."
    },
    "content": "### Customizing Sass Options\n\nIf you want to configure your Sass options, use `sassOptions` in `next.config`.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  sassOptions: {\n    additionalData: `$var: red;`,\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\n\nconst nextConfig = {\n  sassOptions: {\n    additionalData: `$var: red;`,\n  },\n}\n\nmodule.exports = nextConfig\n```\n\n#### Implementation\n\nYou can use the `implementation` property to specify the Sass implementation to use. By default, Next.js uses the [`sass`](https://www.npmjs.com/package/sass) package.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  sassOptions: {\n    implementation: 'sass-embedded',\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\n\nconst nextConfig = {\n  sassOptions: {\n    implementation: 'sass-embedded',\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "sass.mdx#3",
    "metadata": {
      "title": "How to use Sass",
      "description": "Style your Next.js application using Sass."
    },
    "content": "### Sass Variables\n\nNext.js supports Sass variables exported from CSS Module files.\n\nFor example, using the exported `primaryColor` Sass variable:\n\n```scss filename=\"app/variables.module.scss\"\n$primary-color: #64ff00;\n\n:export {\n  primaryColor: $primary-color;\n}\n```\n\n<AppOnly>\n\n```jsx filename=\"app/page.js\"\n// maps to root `/` URL\n\nimport variables from './variables.module.scss'\n\nexport default function Page() {\n  return <h1 style={{ color: variables.primaryColor }}>Hello, Next.js!</h1>\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/_app.js\"\nimport variables from '../styles/variables.module.scss'\n\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <Layout color={variables.primaryColor}>\n      <Component {...pageProps} />\n    </Layout>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "scripts.mdx#0",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "---\ntitle: How to load and optimize scripts\nnav_title: Scripts\ndescription: Optimize 3rd party scripts with the built-in Script component.\nrelated:\n  title: API Reference\n  description: Learn more about the next/script API.\n  links:\n    - app/api-reference/components/script\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n<AppOnly>"
  },
  {
    "id": "scripts.mdx#1",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "### Layout Scripts\n\nTo load a third-party script for multiple routes, import `next/script` and include the script directly in your layout component:\n\n```tsx filename=\"app/dashboard/layout.tsx\" switcher\nimport Script from 'next/script'\n\nexport default function DashboardLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <>\n      <section>{children}</section>\n      <Script src=\"https://example.com/script.js\" />\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/dashboard/layout.js\" switcher\nimport Script from 'next/script'\n\nexport default function DashboardLayout({ children }) {\n  return (\n    <>\n      <section>{children}</section>\n      <Script src=\"https://example.com/script.js\" />\n    </>\n  )\n}\n```\n\nThe third-party script is fetched when the folder route (e.g. `dashboard/page.js`) or any nested route (e.g. `dashboard/settings/page.js`) is accessed by the user. Next.js will ensure the script will **only load once**, even if a user navigates between multiple routes in the same layout.\n\n</AppOnly>"
  },
  {
    "id": "scripts.mdx#2",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "### Application Scripts\n\n<AppOnly>\n\nTo load a third-party script for all routes, import `next/script` and include the script directly in your root layout:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport Script from 'next/script'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n      <Script src=\"https://example.com/script.js\" />\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport Script from 'next/script'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n      <Script src=\"https://example.com/script.js\" />\n    </html>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nTo load a third-party script for all routes, import `next/script` and include the script directly in your custom `_app`:\n\n```jsx filename=\"pages/_app.js\"\nimport Script from 'next/script'\n\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <>\n      <Component {...pageProps} />\n      <Script src=\"https://example.com/script.js\" />\n    </>\n  )\n}"
  },
  {
    "id": "scripts.mdx#3",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "```\n\n</PagesOnly>\n\nThis script will load and execute when _any_ route in your application is accessed. Next.js will ensure the script will **only load once**, even if a user navigates between multiple pages.\n\n> **Recommendation**: We recommend only including third-party scripts in specific pages or layouts in order to minimize any unnecessary impact to performance."
  },
  {
    "id": "scripts.mdx#4",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "### Strategy\n\nAlthough the default behavior of `next/script` allows you to load third-party scripts in any page or layout, you can fine-tune its loading behavior by using the `strategy` property:\n\n- `beforeInteractive`: Load the script before any Next.js code and before any page hydration occurs.\n- `afterInteractive`: (**default**) Load the script early but after some hydration on the page occurs.\n- `lazyOnload`: Load the script later during browser idle time.\n- `worker`: (experimental) Load the script in a web worker.\n\nRefer to the [`next/script`](/docs/app/api-reference/components/script#strategy) API reference documentation to learn more about each strategy and their use cases."
  },
  {
    "id": "scripts.mdx#5",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "### Offloading Scripts To A Web Worker (experimental)\n\n> **Warning:** The `worker` strategy is not yet stable and does not yet work with the App Router. Use with caution.\n\nScripts that use the `worker` strategy are offloaded and executed in a web worker with [Partytown](https://partytown.builder.io/). This can improve the performance of your site by dedicating the main thread to the rest of your application code.\n\nThis strategy is still experimental and can only be used if the `nextScriptWorkers` flag is enabled in `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  experimental: {\n    nextScriptWorkers: true,\n  },\n}\n```\n\nThen, run `next` (normally `npm run dev` or `yarn dev`) and Next.js will guide you through the installation of the required packages to finish the setup:\n\n```bash filename=\"Terminal\"\nnpm run dev"
  },
  {
    "id": "scripts.mdx#6",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "```\n\nThen, run `next` (normally `npm run dev` or `yarn dev`) and Next.js will guide you through the installation of the required packages to finish the setup:\n\n```bash filename=\"Terminal\"\nnpm run dev\n```\n\nYou'll see instructions like these: Please install Partytown by running `npm install @builder.io/partytown`\n\nOnce setup is complete, defining `strategy=\"worker\"` will automatically instantiate Partytown in your application and offload the script to a web worker.\n\n```tsx filename=\"pages/home.tsx\" switcher\nimport Script from 'next/script'\n\nexport default function Home() {\n  return (\n    <>\n      <Script src=\"https://example.com/script.js\" strategy=\"worker\" />\n    </>\n  )\n}\n```\n\n```jsx filename=\"pages/home.js\" switcher\nimport Script from 'next/script'\n\nexport default function Home() {\n  return (\n    <>\n      <Script src=\"https://example.com/script.js\" strategy=\"worker\" />\n    </>\n  )\n}\n```\n\nThere are a number of trade-offs that need to be considered when loading a third-party script in a web worker. Please see Partytown's [tradeoffs](https://partytown.builder.io/trade-offs) documentation for more information.\n\n<PagesOnly>"
  },
  {
    "id": "scripts.mdx#7",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "#### Using custom Partytown configuration\n\nAlthough the `worker` strategy does not require any additional configuration to work, Partytown supports the use of a config object to modify some of its settings, including enabling `debug` mode and forwarding events and triggers.\n\nIf you would like to add additional configuration options, you can include it within the `<Head />` component used in a [custom `_document.js`](/docs/pages/building-your-application/routing/custom-document):\n\n```jsx filename=\"_pages/document.jsx\"\nimport { Html, Head, Main, NextScript } from 'next/document'\n\nexport default function Document() {\n  return (\n    <Html>\n      <Head>\n        <script\n          data-partytown-config\n          dangerouslySetInnerHTML={{\n            __html: `\n              partytown = {\n                lib: \"/_next/static/~partytown/\",\n                debug: true\n              };\n            `,\n          }}\n        />\n      </Head>\n      <body>\n        <Main />\n        <NextScript />\n      </body>\n    </Html>\n  )\n}"
  },
  {
    "id": "scripts.mdx#8",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "```\n\nIn order to modify Partytown's configuration, the following conditions must be met:\n\n1. The `data-partytown-config` attribute must be used in order to overwrite the default configuration used by Next.js\n2. Unless you decide to save Partytown's library files in a separate directory, the `lib: \"/_next/static/~partytown/\"` property and value must be included in the configuration object in order to let Partytown know where Next.js stores the necessary static files.\n\n> **Note**: If you are using an [asset prefix](/docs/pages/api-reference/config/next-config-js/assetPrefix) and would like to modify Partytown's default configuration, you must include it as part of the `lib` path.\n\nTake a look at Partytown's [configuration options](https://partytown.builder.io/configuration) to see the full list of other properties that can be added.\n\n</PagesOnly>"
  },
  {
    "id": "scripts.mdx#9",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "### Inline Scripts\n\nInline scripts, or scripts not loaded from an external file, are also supported by the Script component. They can be written by placing the JavaScript within curly braces:\n\n```jsx\n<Script id=\"show-banner\">\n  {`document.getElementById('banner').classList.remove('hidden')`}\n</Script>\n```\n\nOr by using the `dangerouslySetInnerHTML` property:\n\n```jsx\n<Script\n  id=\"show-banner\"\n  dangerouslySetInnerHTML={{\n    __html: `document.getElementById('banner').classList.remove('hidden')`,\n  }}\n/>\n```\n\n> **Warning**: An `id` property must be assigned for inline scripts in order for Next.js to track and optimize the script."
  },
  {
    "id": "scripts.mdx#10",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "### Executing Additional Code\n\nEvent handlers can be used with the Script component to execute additional code after a certain event occurs:\n\n- `onLoad`: Execute code after the script has finished loading.\n- `onReady`: Execute code after the script has finished loading and every time the component is mounted.\n- `onError`: Execute code if the script fails to load.\n\n<AppOnly>\n\nThese handlers will only work when `next/script` is imported and used inside of a [Client Component](/docs/app/getting-started/server-and-client-components) where `\"use client\"` is defined as the first line of code:\n\n```tsx filename=\"app/page.tsx\" switcher\n'use client'\n\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://example.com/script.js\"\n        onLoad={() => {\n          console.log('Script has loaded')\n        }}\n      />\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\n'use client'\n\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://example.com/script.js\"\n        onLoad={() => {\n          console.log('Script has loaded')\n        }}\n      />\n    </>\n  )\n}"
  },
  {
    "id": "scripts.mdx#11",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "```\n\nRefer to the [`next/script`](/docs/app/api-reference/components/script#onload) API reference to learn more about each event handler and view examples.\n\n</AppOnly>\n\n<PagesOnly>\n\nThese handlers will only work when `next/script` is imported and used inside of a [Client Component](/docs/app/getting-started/server-and-client-components) where `\"use client\"` is defined as the first line of code:\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://example.com/script.js\"\n        onLoad={() => {\n          console.log('Script has loaded')\n        }}\n      />\n    </>\n  )\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://example.com/script.js\"\n        onLoad={() => {\n          console.log('Script has loaded')\n        }}\n      />\n    </>\n  )\n}\n```\n\nRefer to the [`next/script`](/docs/pages/api-reference/components/script#onload) API reference to learn more about each event handler and view examples.\n\n</PagesOnly>"
  },
  {
    "id": "scripts.mdx#12",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "### Additional Attributes\n\nThere are many DOM attributes that can be assigned to a `<script>` element that are not used by the Script component, like [`nonce`](https://developer.mozilla.org/docs/Web/HTML/Global_attributes/nonce) or [custom data attributes](https://developer.mozilla.org/docs/Web/HTML/Global_attributes/data-*). Including any additional attributes will automatically forward it to the final, optimized `<script>` element that is included in the HTML.\n\n<AppOnly>\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://example.com/script.js\"\n        id=\"example-script\"\n        nonce=\"XUENAJFW\"\n        data-test=\"script\"\n      />\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://example.com/script.js\"\n        id=\"example-script\"\n        nonce=\"XUENAJFW\"\n        data-test=\"script\"\n      />\n    </>\n  )\n}"
  },
  {
    "id": "scripts.mdx#13",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://example.com/script.js\"\n        id=\"example-script\"\n        nonce=\"XUENAJFW\"\n        data-test=\"script\"\n      />\n    </>\n  )\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://example.com/script.js\"\n        id=\"example-script\"\n        nonce=\"XUENAJFW\"\n        data-test=\"script\"\n      />\n    </>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "self-hosting.mdx#0",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "---\ntitle: How to self-host your Next.js application\nnav_title: Self-Hosting\ndescription: Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports).\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nWhen [deploying](/docs/app/getting-started/deploying) your Next.js app, you may want to configure how different features are handled based on your infrastructure.\n\n> **🎥 Watch:** Learn more about self-hosting Next.js → [YouTube (45 minutes)](https://www.youtube.com/watch?v=sIVL4JMqRfc)."
  },
  {
    "id": "self-hosting.mdx#1",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "## Reverse Proxy\n\nWhen self-hosting, it's recommended to use a reverse proxy (like nginx) in front of your Next.js server rather than exposing it directly to the internet. A reverse proxy can handle malformed requests, slow connection attacks, payload size limits, rate limiting, and other security concerns, offloading these tasks from the Next.js server. This allows the server to dedicate its resources to rendering rather than request validation."
  },
  {
    "id": "self-hosting.mdx#2",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "## Image Optimization\n\n[Image Optimization](/docs/app/api-reference/components/image) through `next/image` works self-hosted with zero configuration when deploying using `next start`. If you would prefer to have a separate service to optimize images, you can [configure an image loader](/docs/app/api-reference/components/image#loader).\n\nImage Optimization can be used with a [static export](/docs/app/guides/static-exports#image-optimization) by defining a custom image loader in `next.config.js`. Note that images are optimized at runtime, not during the build.\n\n> **Good to know:**\n>\n> - On glibc-based Linux systems, Image Optimization may require [additional configuration](https://sharp.pixelplumbing.com/install#linux-memory-allocator) to prevent excessive memory usage.\n> - Learn more about the [caching behavior of optimized images](/docs/app/api-reference/components/image#minimumcachettl) and how to configure the TTL.\n> - You can also [disable Image Optimization](/docs/app/api-reference/components/image#unoptimized) and still retain other benefits of using `next/image` if you prefer. For example, if you are optimizing images yourself separately."
  },
  {
    "id": "self-hosting.mdx#3",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "## Proxy\n\n[Proxy](/docs/app/api-reference/file-conventions/proxy) works self-hosted with zero configuration when deploying using `next start`. Since it requires access to the incoming request, it is not supported when using a [static export](/docs/app/guides/static-exports).\n\nProxy uses the [Edge runtime](/docs/app/api-reference/edge), a subset of all available Node.js APIs to help ensure low latency, since it may run in front of every route or asset in your application. If you do not want this, you can use the [full Node.js runtime](/blog/next-15-2#nodejs-middleware-experimental) to run Proxy."
  },
  {
    "id": "self-hosting.mdx#4",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "If you are looking to add logic (or use an external package) that requires all Node.js APIs, you might be able to move this logic to a [layout](/docs/app/api-reference/file-conventions/layout) as a [Server Component](/docs/app/getting-started/server-and-client-components). For example, checking [headers](/docs/app/api-reference/functions/headers) and [redirecting](/docs/app/api-reference/functions/redirect). You can also use headers, cookies, or query parameters to [redirect](/docs/app/api-reference/config/next-config-js/redirects#header-cookie-and-query-matching) or [rewrite](/docs/app/api-reference/config/next-config-js/rewrites#header-cookie-and-query-matching) through `next.config.js`. If that does not work, you can also use a [custom server](/docs/pages/guides/custom-server)."
  },
  {
    "id": "self-hosting.mdx#5",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "## Environment Variables\n\nNext.js can support both build time and runtime environment variables.\n\n**By default, environment variables are only available on the server**. To expose an environment variable to the browser, it must be prefixed with `NEXT_PUBLIC_`. However, these public environment variables will be inlined into the JavaScript bundle during `next build`.\n\n<PagesOnly>\n\nTo read runtime environment variables, we recommend using `getServerSideProps` or [incrementally adopting the App Router](/docs/app/guides/migrating/app-router-migration).\n\n</PagesOnly>\n\n<AppOnly>\n\nYou safely read environment variables on the server during dynamic rendering.\n\n```tsx filename=\"app/page.ts\" switcher\nimport { connection } from 'next/server'\n\nexport default async function Component() {\n  await connection()\n  // cookies, headers, and other Dynamic APIs\n  // will also opt into dynamic rendering, meaning\n  // this env variable is evaluated at runtime\n  const value = process.env.MY_VALUE\n  // ...\n}"
  },
  {
    "id": "self-hosting.mdx#6",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nimport { connection } from 'next/server'\n\nexport default async function Component() {\n  await connection()\n  // cookies, headers, and other Dynamic APIs\n  // will also opt into dynamic rendering, meaning\n  // this env variable is evaluated at runtime\n  const value = process.env.MY_VALUE\n  // ...\n}\n```\n\n</AppOnly>\n\nThis allows you to use a singular Docker image that can be promoted through multiple environments with different values.\n\n> **Good to know:**\n>\n> - You can run code on server startup using the [`register` function](/docs/app/guides/instrumentation)."
  },
  {
    "id": "self-hosting.mdx#7",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "## Caching and ISR\n\nNext.js can cache responses, generated static pages, build outputs, and other static assets like images, fonts, and scripts.\n\nCaching and revalidating pages (with [Incremental Static Regeneration](/docs/app/guides/incremental-static-regeneration)) use the **same shared cache**. By default, this cache is stored to the filesystem (on disk) on your Next.js server. **This works automatically when self-hosting** using both the Pages and App Router.\n\nYou can configure the Next.js cache location if you want to persist cached pages and data to durable storage, or share the cache across multiple containers or instances of your Next.js application."
  },
  {
    "id": "self-hosting.mdx#8",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "### Automatic Caching\n\n- Next.js sets the `Cache-Control` header of `public, max-age=31536000, immutable` to truly immutable assets. It cannot be overridden. These immutable files contain a SHA-hash in the file name, so they can be safely cached indefinitely. For example, [Static Image Imports](/docs/app/getting-started/images#local-images). You can [configure the TTL](/docs/app/api-reference/components/image#minimumcachettl) for images.\n- Incremental Static Regeneration (ISR) sets the `Cache-Control` header of `s-maxage: <revalidate in getStaticProps>, stale-while-revalidate`. This revalidation time is defined in your [`getStaticProps` function](/docs/pages/building-your-application/data-fetching/get-static-props) in seconds. If you set `revalidate: false`, it will default to a one-year cache duration.\n- Dynamically rendered pages set a `Cache-Control` header of `private, no-cache, no-store, max-age=0, must-revalidate` to prevent user-specific data from being cached. This applies to both the App Router and Pages Router. This also includes [Draft Mode](/docs/app/guides/draft-mode)."
  },
  {
    "id": "self-hosting.mdx#9",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "### Static Assets\n\nIf you want to host static assets on a different domain or CDN, you can use the `assetPrefix` [configuration](/docs/app/api-reference/config/next-config-js/assetPrefix) in `next.config.js`. Next.js will use this asset prefix when retrieving JavaScript or CSS files. Separating your assets to a different domain does come with the downside of extra time spent on DNS and TLS resolution.\n\n[Learn more about `assetPrefix`](/docs/app/api-reference/config/next-config-js/assetPrefix)."
  },
  {
    "id": "self-hosting.mdx#10",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "### Configuring Caching\n\nBy default, generated cache assets will be stored in memory (defaults to 50mb) and on disk. If you are hosting Next.js using a container orchestration platform like Kubernetes, each pod will have a copy of the cache. To prevent stale data from being shown since the cache is not shared between pods by default, you can configure the Next.js cache to provide a cache handler and disable in-memory caching.\n\nTo configure the ISR/Data Cache location when self-hosting, you can configure a custom handler in your `next.config.js` file:\n\n```jsx filename=\"next.config.js\"\nmodule.exports = {\n  cacheHandler: require.resolve('./cache-handler.js'),\n  cacheMaxMemorySize: 0, // disable default in-memory caching\n}"
  },
  {
    "id": "self-hosting.mdx#11",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "```\n\nThen, create `cache-handler.js` in the root of your project, for example:\n\n```jsx filename=\"cache-handler.js\"\nconst cache = new Map()\n\nmodule.exports = class CacheHandler {\n  constructor(options) {\n    this.options = options\n  }\n\n  async get(key) {\n    // This could be stored anywhere, like durable storage\n    return cache.get(key)\n  }\n\n  async set(key, data, ctx) {\n    // This could be stored anywhere, like durable storage\n    cache.set(key, {\n      value: data,\n      lastModified: Date.now(),\n      tags: ctx.tags,\n    })\n  }\n\n  async revalidateTag(tags) {\n    // tags is either a string or an array of strings\n    tags = [tags].flat()\n    // Iterate over all entries in the cache\n    for (let [key, value] of cache) {\n      // If the value's tags include the specified tag, delete this entry\n      if (value.tags.some((tag) => tags.includes(tag))) {\n        cache.delete(key)\n      }\n    }\n  }\n\n  // If you want to have temporary in memory cache for a single request that is reset\n  // before the next request you can leverage this method\n  resetRequestCache() {}\n}"
  },
  {
    "id": "self-hosting.mdx#12",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "```\n\nUsing a custom cache handler will allow you to ensure consistency across all pods hosting your Next.js application. For instance, you can save the cached values anywhere, like [Redis](https://github.com/vercel/next.js/tree/canary/examples/cache-handler-redis) or AWS S3.\n\n> **Good to know:**\n>\n> - `revalidatePath` is a convenience layer on top of cache tags. Calling `revalidatePath` will call the `revalidateTag` function with a special default tag for the provided page."
  },
  {
    "id": "self-hosting.mdx#13",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "## Build Cache\n\nNext.js generates an ID during `next build` to identify which version of your application is being served. The same build should be used and boot up multiple containers.\n\nIf you are rebuilding for each stage of your environment, you will need to generate a consistent build ID to use between containers. Use the `generateBuildId` command in `next.config.js`:\n\n```jsx filename=\"next.config.js\"\nmodule.exports = {\n  generateBuildId: async () => {\n    // This could be anything, using the latest git hash\n    return process.env.GIT_HASH\n  },\n}\n```"
  },
  {
    "id": "self-hosting.mdx#14",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "## Version Skew\n\nNext.js will automatically mitigate most instances of [version skew](https://www.industrialempathy.com/posts/version-skew/) and automatically reload the application to retrieve new assets when detected. For example, if there is a mismatch in the `deploymentId`, transitions between pages will perform a hard navigation versus using a prefetched value.\n\nWhen the application is reloaded, there may be a loss of application state if it's not designed to persist between page navigations. For example, using URL state or local storage would persist state after a page refresh. However, component state like `useState` would be lost in such navigations.\n\n<AppOnly>"
  },
  {
    "id": "self-hosting.mdx#15",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "## Streaming and Suspense\n\nThe Next.js App Router supports [streaming responses](/docs/app/api-reference/file-conventions/loading) when self-hosting. If you are using nginx or a similar proxy, you will need to configure it to disable buffering to enable streaming.\n\nFor example, you can disable buffering in nginx by setting `X-Accel-Buffering` to `no`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async headers() {\n    return [\n      {\n        source: '/:path*{/}?',\n        headers: [\n          {\n            key: 'X-Accel-Buffering',\n            value: 'no',\n          },\n        ],\n      },\n    ]\n  },\n}\n```\n\n## Cache Components\n\n[Cache Components](/docs/app/getting-started/cache-components) works by default with Next.js and is not a CDN-only feature. This includes deployment as a Node.js server (through `next start`) and when used with a Docker container."
  },
  {
    "id": "self-hosting.mdx#16",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "## Usage with CDNs\n\nWhen using a CDN in front on your Next.js application, the page will include `Cache-Control: private` response header when dynamic APIs are accessed. This ensures that the resulting HTML page is marked as non-cacheable. If the page is fully prerendered to static, it will include `Cache-Control: public` to allow the page to be cached on the CDN.\n\nIf you don't need a mix of both static and dynamic components, you can make your entire route static and cache the output HTML on a CDN. This Automatic Static Optimization is the default behavior when running `next build` if dynamic APIs are not used.\n\nAs Partial Prerendering moves to stable, we will provide support through the Deployment Adapters API.\n\n</AppOnly>\n\n<AppOnly>\n\n## `after`\n\n[`after`](/docs/app/api-reference/functions/after) is fully supported when self-hosting with `next start`.\n\nWhen stopping the server, ensure a graceful shutdown by sending `SIGINT` or `SIGTERM` signals and waiting. This allows the Next.js server to wait until after pending callback functions or promises used inside `after` have finished.\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "self-hosting.mdx#17",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "## Manual Graceful Shutdowns\n\nWhen self-hosting, you might want to run code when the server shuts down on `SIGTERM` or `SIGINT` signals.\n\nYou can set the env variable `NEXT_MANUAL_SIG_HANDLE` to `true` and then register a handler for that signal inside your `_document.js` file. You will need to register the environment variable directly in the `package.json` script, and not in the `.env` file.\n\n> **Good to know**: Manual signal handling is not available in `next dev`.\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"NEXT_MANUAL_SIG_HANDLE=true next start\"\n  }\n}\n```\n\n```js filename=\"pages/_document.js\"\nif (process.env.NEXT_MANUAL_SIG_HANDLE) {\n  process.on('SIGTERM', () => {\n    console.log('Received SIGTERM: cleaning up')\n    process.exit(0)\n  })\n  process.on('SIGINT', () => {\n    console.log('Received SIGINT: cleaning up')\n    process.exit(0)\n  })\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "single-page-applications.mdx#0",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "---\ntitle: How to build single-page applications with Next.js\nnav_title: SPAs\ndescription: Next.js fully supports building Single-Page Applications (SPAs).\n---\n\nNext.js fully supports building Single-Page Applications (SPAs).\n\nThis includes fast route transitions with prefetching, client-side data fetching, using browser APIs, integrating with third-party client libraries, creating static routes, and more.\n\nIf you have an existing SPA, you can migrate to Next.js without large changes to your code. Next.js then allows you to progressively add server features as needed."
  },
  {
    "id": "single-page-applications.mdx#1",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "## What is a Single-Page Application?\n\nThe definition of a SPA varies. We’ll define a “strict SPA” as:\n\n- **Client-side rendering (CSR)**: The app is served by one HTML file (e.g. `index.html`). Every route, page transition, and data fetch is handled by JavaScript in the browser.\n- **No full-page reloads**: Rather than requesting a new document for each route, client-side JavaScript manipulates the current page’s DOM and fetches data as needed.\n\nStrict SPAs often require large amounts of JavaScript to load before the page can be interactive. Further, client data waterfalls can be challenging to manage. Building SPAs with Next.js can address these issues."
  },
  {
    "id": "single-page-applications.mdx#2",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "## Why use Next.js for SPAs?\n\nNext.js can automatically code split your JavaScript bundles, and generate multiple HTML entry points into different routes. This avoids loading unnecessary JavaScript code on the client-side, reducing the bundle size and enabling faster page loads.\n\nThe [`next/link`](/docs/app/api-reference/components/link) component automatically [prefetches](/docs/app/api-reference/components/link#prefetch) routes, giving you the fast page transitions of a strict SPA, but with the advantage of persisting application routing state to the URL for linking and sharing.\n\nNext.js can start as a static site or even a strict SPA where everything is rendered client-side. If your project grows, Next.js allows you to progressively add more server features (e.g. [React Server Components](/docs/app/getting-started/server-and-client-components), [Server Actions](/docs/app/getting-started/updating-data), and more) as needed."
  },
  {
    "id": "single-page-applications.mdx#3",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "## Examples\n\nLet's explore common patterns used to build SPAs and how Next.js solves them."
  },
  {
    "id": "single-page-applications.mdx#4",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "### Using React’s `use` within a Context Provider\n\nWe recommend fetching data in a parent component (or layout), returning the Promise, and then unwrapping the value in a Client Component with React’s [`use` hook](https://react.dev/reference/react/use).\n\nNext.js can start data fetching early on the server. In this example, that’s the root layout — the entry point to your application. The server can immediately begin streaming a response to the client.\n\nBy “hoisting” your data fetching to the root layout, Next.js starts the specified requests on the server early before any other components in your application. This eliminates client waterfalls and prevents having multiple roundtrips between client and server. It can also significantly improve performance, as your server is closer (and ideally colocated) to where your database is located.\n\nFor example, update your root layout to call the Promise, but do _not_ await it.\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { UserProvider } from './user-provider'\nimport { getUser } from './user' // some server-side function"
  },
  {
    "id": "single-page-applications.mdx#5",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "```tsx filename=\"app/layout.tsx\" switcher\nimport { UserProvider } from './user-provider'\nimport { getUser } from './user' // some server-side function\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  let userPromise = getUser() // do NOT await\n\n  return (\n    <html lang=\"en\">\n      <body>\n        <UserProvider userPromise={userPromise}>{children}</UserProvider>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "single-page-applications.mdx#6",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { UserProvider } from './user-provider'\nimport { getUser } from './user' // some server-side function\n\nexport default function RootLayout({ children }) {\n  let userPromise = getUser() // do NOT await\n\n  return (\n    <html lang=\"en\">\n      <body>\n        <UserProvider userPromise={userPromise}>{children}</UserProvider>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "single-page-applications.mdx#7",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "```\n\nWhile you can [defer and pass a single Promise](/docs/app/getting-started/fetching-data#streaming-data-with-the-use-hook) as a prop to a Client Component, we generally see this pattern paired with a React context provider. This enables easier access from Client Components with a custom React Hook.\n\nYou can forward a Promise to the React context provider:\n\n```ts filename=\"app/user-provider.ts\" switcher\n'use client';\n\nimport { createContext, useContext, ReactNode } from 'react';\n\ntype User = any;\ntype UserContextType = {\n  userPromise: Promise<User | null>;\n};\n\nconst UserContext = createContext<UserContextType | null>(null);\n\nexport function useUser(): UserContextType {\n  let context = useContext(UserContext);\n  if (context === null) {\n    throw new Error('useUser must be used within a UserProvider');\n  }\n  return context;\n}\n\nexport function UserProvider({\n  children,\n  userPromise\n}: {\n  children: ReactNode;\n  userPromise: Promise<User | null>;\n}) {\n  return (\n    <UserContext.Provider value={{ userPromise }}>\n      {children}\n    </UserContext.Provider>\n  );\n}"
  },
  {
    "id": "single-page-applications.mdx#8",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "```\n\n```js filename=\"app/user-provider.js\" switcher\n'use client'\n\nimport { createContext, useContext, ReactNode } from 'react'\n\nconst UserContext = createContext(null)\n\nexport function useUser() {\n  let context = useContext(UserContext)\n  if (context === null) {\n    throw new Error('useUser must be used within a UserProvider')\n  }\n  return context\n}\n\nexport function UserProvider({ children, userPromise }) {\n  return (\n    <UserContext.Provider value={{ userPromise }}>\n      {children}\n    </UserContext.Provider>\n  )\n}\n```\n\nFinally, you can call the `useUser()` custom hook in any Client Component and unwrap the Promise:\n\n```tsx filename=\"app/profile.tsx\" switcher\n'use client'\n\nimport { use } from 'react'\nimport { useUser } from './user-provider'\n\nexport function Profile() {\n  const { userPromise } = useUser()\n  const user = use(userPromise)\n\n  return '...'\n}\n```\n\n```jsx filename=\"app/profile.js\" switcher\n'use client'\n\nimport { use } from 'react'\nimport { useUser } from './user-provider'\n\nexport function Profile() {\n  const { userPromise } = useUser()\n  const user = use(userPromise)\n\n  return '...'\n}"
  },
  {
    "id": "single-page-applications.mdx#9",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "```\n\nThe component that consumes the Promise (e.g. `Profile` above) will be suspended. This enables partial hydration. You can see the streamed and prerendered HTML before JavaScript has finished loading."
  },
  {
    "id": "single-page-applications.mdx#10",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "### SPAs with SWR\n\n[SWR](https://swr.vercel.app) is a popular React library for data fetching.\n\nWith SWR 2.3.0 (and React 19+), you can gradually adopt server features alongside your existing SWR-based client data fetching code. This is an abstraction of the above `use()` pattern. This means you can move data fetching between the client and server-side, or use both:\n\n- **Client-only:** `useSWR(key, fetcher)`\n- **Server-only:** `useSWR(key)` + RSC-provided data\n- **Mixed:** `useSWR(key, fetcher)` + RSC-provided data\n\nFor example, wrap your application with `<SWRConfig>` and a `fallback`:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { SWRConfig } from 'swr'\nimport { getUser } from './user' // some server-side function\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <SWRConfig\n      value={{\n        fallback: {\n          // We do NOT await getUser() here\n          // Only components that read this data will suspend\n          '/api/user': getUser(),\n        },\n      }}\n    >\n      {children}\n    </SWRConfig>\n  )\n}"
  },
  {
    "id": "single-page-applications.mdx#11",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "```\n\n```js filename=\"app/layout.js\" switcher\nimport { SWRConfig } from 'swr'\nimport { getUser } from './user' // some server-side function\n\nexport default function RootLayout({ children }) {\n  return (\n    <SWRConfig\n      value={{\n        fallback: {\n          // We do NOT await getUser() here\n          // Only components that read this data will suspend\n          '/api/user': getUser(),\n        },\n      }}\n    >\n      {children}\n    </SWRConfig>\n  )\n}\n```\n\nBecause this is a Server Component, `getUser()` can securely read cookies, headers, or talk to your database. No separate API route is needed. Client components below the `<SWRConfig>` can call `useSWR()` with the same key to retrieve the user data. The component code with `useSWR` **does not require any changes** from your existing client-fetching solution.\n\n```tsx filename=\"app/profile.tsx\" switcher\n'use client'\n\nimport useSWR from 'swr'\n\nexport function Profile() {\n  const fetcher = (url) => fetch(url).then((res) => res.json())\n  // The same SWR pattern you already know\n  const { data, error } = useSWR('/api/user', fetcher)\n\n  return '...'\n}"
  },
  {
    "id": "single-page-applications.mdx#12",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "```\n\n```jsx filename=\"app/profile.js\" switcher\n'use client'\n\nimport useSWR from 'swr'\n\nexport function Profile() {\n  const fetcher = (url) => fetch(url).then((res) => res.json())\n  // The same SWR pattern you already know\n  const { data, error } = useSWR('/api/user', fetcher)\n\n  return '...'\n}"
  },
  {
    "id": "single-page-applications.mdx#13",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "```\n\nThe `fallback` data can be prerendered and included in the initial HTML response, then immediately read in the child components using `useSWR`. SWR’s polling, revalidation, and caching still run **client-side only**, so it preserves all the interactivity you rely on for an SPA.\n\nSince the initial `fallback` data is automatically handled by Next.js, you can now delete any conditional logic previously needed to check if `data` was `undefined`. When the data is loading, the closest `<Suspense>` boundary will be suspended.\n\n|                      | SWR                 | RSC                 | RSC + SWR           |\n| -------------------- | ------------------- | ------------------- | ------------------- |\n| SSR data             | <Cross size={18} /> | <Check size={18} /> | <Check size={18} /> |\n| Streaming while SSR  | <Cross size={18} /> | <Check size={18} /> | <Check size={18} /> |\n| Deduplicate requests | <Check size={18} /> | <Check size={18} /> | <Check size={18} /> |\n| Client-side features | <Check size={18} /> | <Cross size={18} /> | <Check size={18} /> |"
  },
  {
    "id": "single-page-applications.mdx#14",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "### SPAs with React Query\n\nYou can use React Query with Next.js on both the client and server. This enables you to build both strict SPAs, as well as take advantage of server features in Next.js paired with React Query.\n\nLearn more in the [React Query documentation](https://tanstack.com/query/latest/docs/framework/react/guides/advanced-ssr).\n\n### Rendering components only in the browser\n\nClient components are [prerendered](https://github.com/reactwg/server-components/discussions/4) during `next build`. If you want to disable prerendering for a Client Component and only load it in the browser environment, you can use [`next/dynamic`](/docs/app/guides/lazy-loading#nextdynamic):\n\n```jsx\nimport dynamic from 'next/dynamic'\n\nconst ClientOnlyComponent = dynamic(() => import('./component'), {\n  ssr: false,\n})\n```\n\nThis can be useful for third-party libraries that rely on browser APIs like `window` or `document`. You can also add a `useEffect` that checks for the existence of these APIs, and if they do not exist, return `null` or a loading state which would be prerendered."
  },
  {
    "id": "single-page-applications.mdx#15",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "### Shallow routing on the client\n\nIf you are migrating from a strict SPA like [Create React App](/docs/app/guides/migrating/from-create-react-app) or [Vite](/docs/app/guides/migrating/from-vite), you might have existing code which shallow routes to update the URL state. This can be useful for manual transitions between views in your application _without_ using the default Next.js file-system routing.\n\nNext.js allows you to use the native [`window.history.pushState`](https://developer.mozilla.org/en-US/docs/Web/API/History/pushState) and [`window.history.replaceState`](https://developer.mozilla.org/en-US/docs/Web/API/History/replaceState) methods to update the browser's history stack without reloading the page.\n\n`pushState` and `replaceState` calls integrate into the Next.js Router, allowing you to sync with [`usePathname`](/docs/app/api-reference/functions/use-pathname) and [`useSearchParams`](/docs/app/api-reference/functions/use-search-params).\n\n```tsx fileName=\"app/ui/sort-products.tsx\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function SortProducts() {\n  const searchParams = useSearchParams()"
  },
  {
    "id": "single-page-applications.mdx#16",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "```tsx fileName=\"app/ui/sort-products.tsx\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function SortProducts() {\n  const searchParams = useSearchParams()\n\n  function updateSorting(sortOrder: string) {\n    const urlSearchParams = new URLSearchParams(searchParams.toString())\n    urlSearchParams.set('sort', sortOrder)\n    window.history.pushState(null, '', `?${urlSearchParams.toString()}`)\n  }\n\n  return (\n    <>\n      <button onClick={() => updateSorting('asc')}>Sort Ascending</button>\n      <button onClick={() => updateSorting('desc')}>Sort Descending</button>\n    </>\n  )\n}"
  },
  {
    "id": "single-page-applications.mdx#17",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "```\n\n```jsx fileName=\"app/ui/sort-products.js\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function SortProducts() {\n  const searchParams = useSearchParams()\n\n  function updateSorting(sortOrder) {\n    const urlSearchParams = new URLSearchParams(searchParams.toString())\n    urlSearchParams.set('sort', sortOrder)\n    window.history.pushState(null, '', `?${urlSearchParams.toString()}`)\n  }\n\n  return (\n    <>\n      <button onClick={() => updateSorting('asc')}>Sort Ascending</button>\n      <button onClick={() => updateSorting('desc')}>Sort Descending</button>\n    </>\n  )\n}\n```\n\nLearn more about how [routing and navigation](/docs/app/getting-started/linking-and-navigating#how-navigation-works) work in Next.js."
  },
  {
    "id": "single-page-applications.mdx#18",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "### Using Server Actions in Client Components\n\nYou can progressively adopt Server Actions while still using Client Components. This allows you to remove boilerplate code to call an API route, and instead use React features like `useActionState` to handle loading and error states.\n\nFor example, create your first Server Action:\n\n```tsx filename=\"app/actions.ts\" switcher\n'use server'\n\nexport async function create() {}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nexport async function create() {}\n```\n\nYou can import and use a Server Action from the client, similar to calling a JavaScript function. You do not need to create an API endpoint manually:\n\n```tsx filename=\"app/button.tsx\" switcher\n'use client'\n\nimport { create } from './actions'\n\nexport function Button() {\n  return <button onClick={() => create()}>Create</button>\n}\n```\n\n```jsx filename=\"app/button.js\" switcher\n'use client'\n\nimport { create } from './actions'\n\nexport function Button() {\n  return <button onClick={() => create()}>Create</button>\n}\n```\n\nLearn more about [mutating data with Server Actions](/docs/app/getting-started/updating-data)."
  },
  {
    "id": "single-page-applications.mdx#19",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "## Static export (optional)\n\nNext.js also supports generating a fully [static site](/docs/app/guides/static-exports). This has some advantages over strict SPAs:\n\n- **Automatic code-splitting**: Instead of shipping a single `index.html`, Next.js will generate an HTML file per route, so your visitors get the content faster without waiting for the client JavaScript bundle.\n- **Improved user experience:** Instead of a minimal skeleton for all routes, you get fully rendered pages for each route. When users navigate client side, transitions remain instant and SPA-like.\n\nTo enable a static export, update your configuration:\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  output: 'export',\n}\n\nexport default nextConfig\n```\n\nAfter running `next build`, Next.js will create an `out` folder with the HTML/CSS/JS assets for your application.\n\n> **Note:** Next.js server features are not supported with static exports. [Learn more](/docs/app/guides/static-exports#unsupported-features)."
  },
  {
    "id": "single-page-applications.mdx#20",
    "metadata": {
      "title": "How to build single-page applications with Next.js",
      "description": "Next.js fully supports building Single-Page Applications (SPAs)."
    },
    "content": "## Migrating existing projects to Next.js\n\nYou can incrementally migrate to Next.js by following our guides:\n\n- [Migrating from Create React App](/docs/app/guides/migrating/from-create-react-app)\n- [Migrating from Vite](/docs/app/guides/migrating/from-vite)\n\nIf you are already using a SPA with the Pages Router, you can learn how to [incrementally adopt the App Router](/docs/app/guides/migrating/app-router-migration)."
  },
  {
    "id": "static-exports.mdx#0",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "---\ntitle: How to create a static export of your Next.js application\nnav_title: Static Exports\ndescription: Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server.\n\nWhen running `next build`, Next.js generates an HTML file per route. By breaking a strict SPA into individual HTML files, Next.js can avoid loading unnecessary JavaScript code on the client-side, reducing the bundle size and enabling faster page loads.\n\nSince Next.js supports this static export, it can be deployed and hosted on any web server that can serve HTML/CSS/JS static assets."
  },
  {
    "id": "static-exports.mdx#1",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "## Configuration\n\nTo enable a static export, change the output mode inside `next.config.js`:\n\n```js filename=\"next.config.js\" highlight={5}\n/**\n * @type {import('next').NextConfig}\n */\nconst nextConfig = {\n  output: 'export',\n\n  // Optional: Change links `/me` -> `/me/` and emit `/me.html` -> `/me/index.html`\n  // trailingSlash: true,\n\n  // Optional: Prevent automatic `/me` -> `/me/`, instead preserve `href`\n  // skipTrailingSlashRedirect: true,\n\n  // Optional: Change the output directory `out` -> `dist`\n  // distDir: 'dist',\n}\n\nmodule.exports = nextConfig\n```\n\nAfter running `next build`, Next.js will create an `out` folder with the HTML/CSS/JS assets for your application.\n\n<PagesOnly>\n\nYou can utilize [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) and [`getStaticPaths`](/docs/pages/building-your-application/data-fetching/get-static-paths) to generate an HTML file for each page in your `pages` directory (or more for [dynamic routes](/docs/app/api-reference/file-conventions/dynamic-routes)).\n\n</PagesOnly>\n\n<AppOnly>"
  },
  {
    "id": "static-exports.mdx#2",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "## Supported Features\n\nThe core of Next.js has been designed to support static exports.\n\n### Server Components\n\nWhen you run `next build` to generate a static export, Server Components consumed inside the `app` directory will run during the build, similar to traditional static-site generation.\n\nThe resulting component will be rendered into static HTML for the initial page load and a static payload for client navigation between routes. No changes are required for your Server Components when using the static export, unless they consume [dynamic server functions](#unsupported-features).\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default async function Page() {\n  // This fetch will run on the server during `next build`\n  const res = await fetch('https://api.example.com/...')\n  const data = await res.json()\n\n  return <main>...</main>\n}\n```"
  },
  {
    "id": "static-exports.mdx#3",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "### Client Components\n\nIf you want to perform data fetching on the client, you can use a Client Component with [SWR](https://github.com/vercel/swr) to memoize requests.\n\n```tsx filename=\"app/other/page.tsx\" switcher\n'use client'\n\nimport useSWR from 'swr'\n\nconst fetcher = (url: string) => fetch(url).then((r) => r.json())\n\nexport default function Page() {\n  const { data, error } = useSWR(\n    `https://jsonplaceholder.typicode.com/posts/1`,\n    fetcher\n  )\n  if (error) return 'Failed to load'\n  if (!data) return 'Loading...'\n\n  return data.title\n}\n```\n\n```jsx filename=\"app/other/page.js\" switcher\n'use client'\n\nimport useSWR from 'swr'\n\nconst fetcher = (url) => fetch(url).then((r) => r.json())\n\nexport default function Page() {\n  const { data, error } = useSWR(\n    `https://jsonplaceholder.typicode.com/posts/1`,\n    fetcher\n  )\n  if (error) return 'Failed to load'\n  if (!data) return 'Loading...'\n\n  return data.title\n}"
  },
  {
    "id": "static-exports.mdx#4",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "```\n\nSince route transitions happen client-side, this behaves like a traditional SPA. For example, the following index route allows you to navigate to different posts on the client:\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <>\n      <h1>Index Page</h1>\n      <hr />\n      <ul>\n        <li>\n          <Link href=\"/post/1\">Post 1</Link>\n        </li>\n        <li>\n          <Link href=\"/post/2\">Post 2</Link>\n        </li>\n      </ul>\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <>\n      <h1>Index Page</h1>\n      <p>\n        <Link href=\"/other\">Other Page</Link>\n      </p>\n    </>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "static-exports.mdx#5",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "## Supported Features\n\nThe majority of core Next.js features needed to build a static site are supported, including:\n\n- [Dynamic Routes when using `getStaticPaths`](/docs/app/api-reference/file-conventions/dynamic-routes)\n- Prefetching with `next/link`\n- Preloading JavaScript\n- [Dynamic Imports](/docs/pages/guides/lazy-loading)\n- Any styling options (e.g. CSS Modules, styled-jsx)\n- [Client-side data fetching](/docs/pages/building-your-application/data-fetching/client-side)\n- [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props)\n- [`getStaticPaths`](/docs/pages/building-your-application/data-fetching/get-static-paths)\n\n</PagesOnly>"
  },
  {
    "id": "static-exports.mdx#6",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "### Image Optimization\n\n[Image Optimization](/docs/app/api-reference/components/image) through `next/image` can be used with a static export by defining a custom image loader in `next.config.js`. For example, you can optimize images with a service like Cloudinary:\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export',\n  images: {\n    loader: 'custom',\n    loaderFile: './my-loader.ts',\n  },\n}\n\nmodule.exports = nextConfig\n```\n\nThis custom loader will define how to fetch images from a remote source. For example, the following loader will construct the URL for Cloudinary:\n\n```ts filename=\"my-loader.ts\" switcher\nexport default function cloudinaryLoader({\n  src,\n  width,\n  quality,\n}: {\n  src: string\n  width: number\n  quality?: number\n}) {\n  const params = ['f_auto', 'c_limit', `w_${width}`, `q_${quality || 'auto'}`]\n  return `https://res.cloudinary.com/demo/image/upload/${params.join(\n    ','\n  )}${src}`\n}"
  },
  {
    "id": "static-exports.mdx#7",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "```\n\n```js filename=\"my-loader.js\" switcher\nexport default function cloudinaryLoader({ src, width, quality }) {\n  const params = ['f_auto', 'c_limit', `w_${width}`, `q_${quality || 'auto'}`]\n  return `https://res.cloudinary.com/demo/image/upload/${params.join(\n    ','\n  )}${src}`\n}\n```\n\nYou can then use `next/image` in your application, defining relative paths to the image in Cloudinary:\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Image from 'next/image'\n\nexport default function Page() {\n  return <Image alt=\"turtles\" src=\"/turtles.jpg\" width={300} height={300} />\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport Image from 'next/image'\n\nexport default function Page() {\n  return <Image alt=\"turtles\" src=\"/turtles.jpg\" width={300} height={300} />\n}\n```\n\n<AppOnly>"
  },
  {
    "id": "static-exports.mdx#8",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "### Route Handlers\n\nRoute Handlers will render a static response when running `next build`. Only the `GET` HTTP verb is supported. This can be used to generate static HTML, JSON, TXT, or other files from cached or uncached data. For example:\n\n```ts filename=\"app/data.json/route.ts\" switcher\nexport async function GET() {\n  return Response.json({ name: 'Lee' })\n}\n```\n\n```js filename=\"app/data.json/route.js\" switcher\nexport async function GET() {\n  return Response.json({ name: 'Lee' })\n}\n```\n\nThe above file `app/data.json/route.ts` will render to a static file during `next build`, producing `data.json` containing `{ name: 'Lee' }`.\n\nIf you need to read dynamic values from the incoming request, you cannot use a static export."
  },
  {
    "id": "static-exports.mdx#9",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "### Browser APIs\n\nClient Components are pre-rendered to HTML during `next build`. Because [Web APIs](https://developer.mozilla.org/docs/Web/API) like `window`, `localStorage`, and `navigator` are not available on the server, you need to safely access these APIs only when running in the browser. For example:\n\n```jsx\n'use client';\n\nimport { useEffect } from 'react';\n\nexport default function ClientComponent() {\n  useEffect(() => {\n    // You now have access to `window`\n    console.log(window.innerHeight);\n  }, [])\n\n  return ...;\n}\n```\n\n</AppOnly>"
  },
  {
    "id": "static-exports.mdx#10",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "## Unsupported Features\n\nFeatures that require a Node.js server, or dynamic logic that cannot be computed during the build process, are **not** supported:\n\n<AppOnly>\n\n- [Dynamic Routes](/docs/app/api-reference/file-conventions/dynamic-routes) with `dynamicParams: true`\n- [Dynamic Routes](/docs/app/api-reference/file-conventions/dynamic-routes) without `generateStaticParams()`\n- [Route Handlers](/docs/app/api-reference/file-conventions/route) that rely on Request\n- [Cookies](/docs/app/api-reference/functions/cookies)\n- [Rewrites](/docs/app/api-reference/config/next-config-js/rewrites)\n- [Redirects](/docs/app/api-reference/config/next-config-js/redirects)\n- [Headers](/docs/app/api-reference/config/next-config-js/headers)\n- [Proxy](/docs/app/api-reference/file-conventions/proxy)\n- [Incremental Static Regeneration](/docs/app/guides/incremental-static-regeneration)\n- [Image Optimization](/docs/app/api-reference/components/image) with the default `loader`\n- [Draft Mode](/docs/app/guides/draft-mode)\n- [Server Actions](/docs/app/getting-started/updating-data)\n- [Intercepting Routes](/docs/app/api-reference/file-conventions/intercepting-routes)"
  },
  {
    "id": "static-exports.mdx#11",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "Attempting to use any of these features with `next dev` will result in an error, similar to setting the [`dynamic`](/docs/app/api-reference/file-conventions/route-segment-config#dynamic) option to `error` in the root layout.\n\n```jsx\nexport const dynamic = 'error'"
  },
  {
    "id": "static-exports.mdx#12",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\n- [Internationalized Routing](/docs/pages/guides/internationalization)\n- [API Routes](/docs/pages/building-your-application/routing/api-routes)\n- [Rewrites](/docs/pages/api-reference/config/next-config-js/rewrites)\n- [Redirects](/docs/pages/api-reference/config/next-config-js/redirects)\n- [Headers](/docs/pages/api-reference/config/next-config-js/headers)\n- [Proxy](/docs/pages/api-reference/file-conventions/proxy)\n- [Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration)\n- [Image Optimization](/docs/pages/api-reference/components/image) with the default `loader`\n- [Draft Mode](/docs/pages/guides/draft-mode)\n- [`getStaticPaths` with `fallback: true`](/docs/pages/api-reference/functions/get-static-paths#fallback-true)\n- [`getStaticPaths` with `fallback: 'blocking'`](/docs/pages/api-reference/functions/get-static-paths#fallback-blocking)\n- [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props)\n\n</PagesOnly>"
  },
  {
    "id": "static-exports.mdx#13",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "## Deploying\n\nWith a static export, Next.js can be deployed and hosted on any web server that can serve HTML/CSS/JS static assets.\n\nWhen running `next build`, Next.js generates the static export into the `out` folder. For example, let's say you have the following routes:\n\n- `/`\n- `/blog/[id]`\n\nAfter running `next build`, Next.js will generate the following files:\n\n- `/out/index.html`\n- `/out/404.html`\n- `/out/blog/post-1.html`\n- `/out/blog/post-2.html`\n\nIf you are using a static host like Nginx, you can configure rewrites from incoming requests to the correct files:\n\n```nginx filename=\"nginx.conf\"\nserver {\n  listen 80;\n  server_name acme.com;\n\n  root /var/www/out;\n\n  location / {\n      try_files $uri $uri.html $uri/ =404;\n  }\n\n  # This is necessary when `trailingSlash: false`.\n  # You can omit this when `trailingSlash: true`.\n  location /blog/ {\n      rewrite ^/blog/(.*)$ /blog/$1.html break;\n  }\n\n  error_page 404 /404.html;\n  location = /404.html {\n      internal;\n  }\n}\n```"
  },
  {
    "id": "static-exports.mdx#14",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "## Version History\n\n| Version   | Changes                                                                                                              |\n| --------- | -------------------------------------------------------------------------------------------------------------------- |\n| `v14.0.0` | `next export` has been removed in favor of `\"output\": \"export\"`                                                      |\n| `v13.4.0` | App Router (Stable) adds enhanced static export support, including using React Server Components and Route Handlers. |\n| `v13.3.0` | `next export` is deprecated and replaced with `\"output\": \"export\"`                                                   |"
  },
  {
    "id": "tailwind-v3-css.mdx#0",
    "metadata": {
      "title": "How to install Tailwind CSS v3 in your Next.js application",
      "description": "Style your Next.js Application using Tailwind CSS v3 for broader browser support."
    },
    "content": "---\ntitle: How to install Tailwind CSS v3 in your Next.js application\nnav_title: Tailwind CSS v3\ndescription: Style your Next.js Application using Tailwind CSS v3 for broader browser support.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nThis guide will walk you through how to install [Tailwind CSS v3](https://v3.tailwindcss.com/) in your Next.js application.\n\n> **Good to know:** For the latest Tailwind 4 setup, see the [Tailwind CSS setup instructions](/docs/app/getting-started/css#tailwind-css)."
  },
  {
    "id": "tailwind-v3-css.mdx#1",
    "metadata": {
      "title": "How to install Tailwind CSS v3 in your Next.js application",
      "description": "Style your Next.js Application using Tailwind CSS v3 for broader browser support."
    },
    "content": "## Installing Tailwind v3\n\nInstall Tailwind CSS and its peer dependencies, then run the `init` command to generate both `tailwind.config.js` and `postcss.config.js` files:\n\n```bash package=\"pnpm\"\npnpm add -D tailwindcss@^3 postcss autoprefixer\nnpx tailwindcss init -p\n```\n\n```bash package=\"npm\"\nnpm install -D tailwindcss@^3 postcss autoprefixer\nnpx tailwindcss init -p\n```\n\n```bash package=\"yarn\"\nyarn add -D tailwindcss@^3 postcss autoprefixer\nnpx tailwindcss init -p\n```\n\n```bash package=\"bun\"\nbun add -D tailwindcss@^3 postcss autoprefixer\nbunx tailwindcss init -p\n```"
  },
  {
    "id": "tailwind-v3-css.mdx#2",
    "metadata": {
      "title": "How to install Tailwind CSS v3 in your Next.js application",
      "description": "Style your Next.js Application using Tailwind CSS v3 for broader browser support."
    },
    "content": "## Configuring Tailwind v3\n\nConfigure your template paths in your `tailwind.config.js` file:\n\n<AppOnly>\n\n```js filename=\"tailwind.config.js\"\n/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\n    './app/**/*.{js,ts,jsx,tsx,mdx}',\n    './pages/**/*.{js,ts,jsx,tsx,mdx}',\n    './components/**/*.{js,ts,jsx,tsx,mdx}',\n  ],\n  theme: {\n    extend: {},\n  },\n  plugins: [],\n}\n```\n\nAdd the Tailwind directives to your global CSS file:\n\n```css filename=\"app/globals.css\"\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n```\n\nImport the CSS file in your root layout:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport './globals.css'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport './globals.css'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "tailwind-v3-css.mdx#3",
    "metadata": {
      "title": "How to install Tailwind CSS v3 in your Next.js application",
      "description": "Style your Next.js Application using Tailwind CSS v3 for broader browser support."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\n```js filename=\"tailwind.config.js\"\n/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\n    './pages/**/*.{js,ts,jsx,tsx,mdx}',\n    './components/**/*.{js,ts,jsx,tsx,mdx}',\n    './app/**/*.{js,ts,jsx,tsx,mdx}',\n  ],\n  theme: {\n    extend: {},\n  },\n  plugins: [],\n}\n```\n\nAdd the Tailwind directives to your global CSS file:\n\n```css filename=\"styles/globals.css\"\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n```\n\nImport the CSS file in your `pages/_app.js` file:\n\n```jsx filename=\"pages/_app.js\"\nimport '@/styles/globals.css'\n\nexport default function MyApp({ Component, pageProps }) {\n  return <Component {...pageProps} />\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "tailwind-v3-css.mdx#4",
    "metadata": {
      "title": "How to install Tailwind CSS v3 in your Next.js application",
      "description": "Style your Next.js Application using Tailwind CSS v3 for broader browser support."
    },
    "content": "## Using classes\n\nAfter installing Tailwind CSS and adding the global styles, you can use Tailwind's utility classes in your application.\n\n<AppOnly>\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default function Page() {\n  return <h1 className=\"text-3xl font-bold underline\">Hello, Next.js!</h1>\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nexport default function Page() {\n  return <h1 className=\"text-3xl font-bold underline\">Hello, Next.js!</h1>\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/index.tsx\" switcher\nexport default function Page() {\n  return <h1 className=\"text-3xl font-bold underline\">Hello, Next.js!</h1>\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nexport default function Page() {\n  return <h1 className=\"text-3xl font-bold underline\">Hello, Next.js!</h1>\n}\n```\n\n</PagesOnly>\n\n## Usage with Turbopack\n\nAs of Next.js 13.1, Tailwind CSS and PostCSS are supported with [Turbopack](https://turbo.build/pack/docs/features/css#tailwind-css)."
  },
  {
    "id": "cypress.mdx#0",
    "metadata": {
      "title": "How to set up Cypress with Next.js",
      "description": "Learn how to set up Cypress with Next.js for End-to-End (E2E) and Component Testing."
    },
    "content": "---\ntitle: How to set up Cypress with Next.js\nnav_title: Cypress\ndescription: Learn how to set up Cypress with Next.js for End-to-End (E2E) and Component Testing.\n---\n\n[Cypress](https://www.cypress.io/) is a test runner used for **End-to-End (E2E)** and **Component Testing**. This page will show you how to set up Cypress with Next.js and write your first tests.\n\n> **Warning:**\n>\n> - Cypress versions below 13.6.3 do not support [TypeScript version 5](https://github.com/cypress-io/cypress/issues/27731) with `moduleResolution:\"bundler\"`. However, this issue has been resolved in Cypress version 13.6.3 and later. [cypress v13.6.3](https://docs.cypress.io/guides/references/changelog#13-6-3)\n\n<AppOnly>\n\n## Quickstart\n\nYou can use `create-next-app` with the [with-cypress example](https://github.com/vercel/next.js/tree/canary/examples/with-cypress) to quickly get started.\n\n```bash filename=\"Terminal\"\nnpx create-next-app@latest --example with-cypress with-cypress-app\n```\n\n</AppOnly>"
  },
  {
    "id": "cypress.mdx#1",
    "metadata": {
      "title": "How to set up Cypress with Next.js",
      "description": "Learn how to set up Cypress with Next.js for End-to-End (E2E) and Component Testing."
    },
    "content": "## Manual setup\n\nTo manually set up Cypress, install `cypress` as a dev dependency:\n\n```bash filename=\"Terminal\"\nnpm install -D cypress\n# or\nyarn add -D cypress\n# or\npnpm install -D cypress\n```\n\nAdd the Cypress `open` command to the `package.json` scripts field:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"eslint\",\n    \"cypress:open\": \"cypress open\"\n  }\n}\n```\n\nRun Cypress for the first time to open the Cypress testing suite:\n\n```bash filename=\"Terminal\"\nnpm run cypress:open\n```\n\nYou can choose to configure **E2E Testing** and/or **Component Testing**. Selecting any of these options will automatically create a `cypress.config.js` file and a `cypress` folder in your project."
  },
  {
    "id": "cypress.mdx#2",
    "metadata": {
      "title": "How to set up Cypress with Next.js",
      "description": "Learn how to set up Cypress with Next.js for End-to-End (E2E) and Component Testing."
    },
    "content": "## Creating your first Cypress E2E test\n\nEnsure your `cypress.config` file has the following configuration:\n\n```ts filename=\"cypress.config.ts\" switcher\nimport { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  e2e: {\n    setupNodeEvents(on, config) {},\n  },\n})\n```\n\n```js filename=\"cypress.config.js\" switcher\nconst { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  e2e: {\n    setupNodeEvents(on, config) {},\n  },\n})\n```\n\nThen, create two new Next.js files:\n\n<AppOnly>\n\n```jsx filename=\"app/page.js\"\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <div>\n      <h1>Home</h1>\n      <Link href=\"/about\">About</Link>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/about/page.js\"\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <div>\n      <h1>About</h1>\n      <Link href=\"/\">Home</Link>\n    </div>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/index.js\"\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <div>\n      <h1>Home</h1>\n      <Link href=\"/about\">About</Link>\n    </div>\n  )\n}"
  },
  {
    "id": "cypress.mdx#3",
    "metadata": {
      "title": "How to set up Cypress with Next.js",
      "description": "Learn how to set up Cypress with Next.js for End-to-End (E2E) and Component Testing."
    },
    "content": "```\n\n```jsx filename=\"pages/about.js\"\nimport Link from 'next/link'\n\nexport default function About() {\n  return (\n    <div>\n      <h1>About</h1>\n      <Link href=\"/\">Home</Link>\n    </div>\n  )\n}\n```\n\n</PagesOnly>\n\nAdd a test to check your navigation is working correctly:\n\n```js filename=\"cypress/e2e/app.cy.js\"\ndescribe('Navigation', () => {\n  it('should navigate to the about page', () => {\n    // Start from the index page\n    cy.visit('http://localhost:3000/')\n\n    // Find a link with an href attribute containing \"about\" and click it\n    cy.get('a[href*=\"about\"]').click()\n\n    // The new url should include \"/about\"\n    cy.url().should('include', '/about')\n\n    // The new page should contain an h1 with \"About\"\n    cy.get('h1').contains('About')\n  })\n})\n```"
  },
  {
    "id": "cypress.mdx#4",
    "metadata": {
      "title": "How to set up Cypress with Next.js",
      "description": "Learn how to set up Cypress with Next.js for End-to-End (E2E) and Component Testing."
    },
    "content": "### Running E2E Tests\n\nCypress will simulate a user navigating your application, this requires your Next.js server to be running. We recommend running your tests against your production code to more closely resemble how your application will behave.\n\nRun `npm run build && npm run start` to build your Next.js application, then run `npm run cypress:open` in another terminal window to start Cypress and run your E2E Testing suite.\n\n> **Good to know:**\n>\n> - You can use `cy.visit(\"/\")` instead of `cy.visit(\"http://localhost:3000/\")` by adding `baseUrl: 'http://localhost:3000'` to the `cypress.config.js` configuration file.\n> - Alternatively, you can install the [`start-server-and-test`](https://www.npmjs.com/package/start-server-and-test) package to run the Next.js production server in conjunction with Cypress. After installation, add `\"test\": \"start-server-and-test start http://localhost:3000 cypress\"` to your `package.json` scripts field. Remember to rebuild your application after new changes."
  },
  {
    "id": "cypress.mdx#5",
    "metadata": {
      "title": "How to set up Cypress with Next.js",
      "description": "Learn how to set up Cypress with Next.js for End-to-End (E2E) and Component Testing."
    },
    "content": "## Creating your first Cypress component test\n\nComponent tests build and mount a specific component without having to bundle your whole application or start a server.\n\nSelect **Component Testing** in the Cypress app, then select **Next.js** as your front-end framework. A `cypress/component` folder will be created in your project, and a `cypress.config.js` file will be updated to enable Component Testing.\n\nEnsure your `cypress.config` file has the following configuration:\n\n```ts filename=\"cypress.config.ts\" switcher\nimport { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  component: {\n    devServer: {\n      framework: 'next',\n      bundler: 'webpack',\n    },\n  },\n})\n```\n\n```js filename=\"cypress.config.js\" switcher\nconst { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  component: {\n    devServer: {\n      framework: 'next',\n      bundler: 'webpack',\n    },\n  },\n})"
  },
  {
    "id": "cypress.mdx#6",
    "metadata": {
      "title": "How to set up Cypress with Next.js",
      "description": "Learn how to set up Cypress with Next.js for End-to-End (E2E) and Component Testing."
    },
    "content": "```\n\nAssuming the same components from the previous section, add a test to validate a component is rendering the expected output:\n\n<AppOnly>\n\n```tsx filename=\"cypress/component/about.cy.tsx\"\nimport Page from '../../app/page'\n\ndescribe('<Page />', () => {\n  it('should render and display expected content', () => {\n    // Mount the React component for the Home page\n    cy.mount(<Page />)\n\n    // The new page should contain an h1 with \"Home\"\n    cy.get('h1').contains('Home')\n\n    // Validate that a link with the expected URL is present\n    // Following the link is better suited to an E2E test\n    cy.get('a[href=\"/about\"]').should('be.visible')\n  })\n})"
  },
  {
    "id": "cypress.mdx#7",
    "metadata": {
      "title": "How to set up Cypress with Next.js",
      "description": "Learn how to set up Cypress with Next.js for End-to-End (E2E) and Component Testing."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"cypress/component/about.cy.js\"\nimport AboutPage from '../../pages/about'\n\ndescribe('<AboutPage />', () => {\n  it('should render and display expected content', () => {\n    // Mount the React component for the About page\n    cy.mount(<AboutPage />)\n\n    // The new page should contain an h1 with \"About page\"\n    cy.get('h1').contains('About')\n\n    // Validate that a link with the expected URL is present\n    // *Following* the link is better suited to an E2E test\n    cy.get('a[href=\"/\"]').should('be.visible')\n  })\n})\n```\n\n</PagesOnly>\n\n> **Good to know**:\n>\n> - Cypress currently doesn't support Component Testing for `async` Server Components. We recommend using E2E testing.\n> - Since component tests do not require a Next.js server, features like `<Image />` that rely on a server being available may not function out-of-the-box."
  },
  {
    "id": "cypress.mdx#8",
    "metadata": {
      "title": "How to set up Cypress with Next.js",
      "description": "Learn how to set up Cypress with Next.js for End-to-End (E2E) and Component Testing."
    },
    "content": "### Running Component Tests\n\nRun `npm run cypress:open` in your terminal to start Cypress and run your Component Testing suite."
  },
  {
    "id": "cypress.mdx#9",
    "metadata": {
      "title": "How to set up Cypress with Next.js",
      "description": "Learn how to set up Cypress with Next.js for End-to-End (E2E) and Component Testing."
    },
    "content": "## Continuous Integration (CI)\n\nIn addition to interactive testing, you can also run Cypress headlessly using the `cypress run` command, which is better suited for CI environments:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    //...\n    \"e2e\": \"start-server-and-test dev http://localhost:3000 \\\"cypress open --e2e\\\"\",\n    \"e2e:headless\": \"start-server-and-test dev http://localhost:3000 \\\"cypress run --e2e\\\"\",\n    \"component\": \"cypress open --component\",\n    \"component:headless\": \"cypress run --component\"\n  }\n}\n```\n\nYou can learn more about Cypress and Continuous Integration from these resources:\n\n- [Next.js with Cypress example](https://github.com/vercel/next.js/tree/canary/examples/with-cypress)\n- [Cypress Continuous Integration Docs](https://docs.cypress.io/guides/continuous-integration/introduction)\n- [Cypress GitHub Actions Guide](https://on.cypress.io/github-actions)\n- [Official Cypress GitHub Action](https://github.com/cypress-io/github-action)\n- [Cypress Discord](https://discord.com/invite/cypress)"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Testing",
      "description": "Learn how to set up Next.js with four commonly used testing tools — Cypress, Playwright, Vitest, and Jest."
    },
    "content": "---\ntitle: Testing\ndescription: Learn how to set up Next.js with four commonly used testing tools — Cypress, Playwright, Vitest, and Jest.\n---\n\nIn React and Next.js, there are a few different types of tests you can write, each with its own purpose and use cases. This page provides an overview of types and commonly used tools you can use to test your application."
  },
  {
    "id": "index.mdx#1",
    "metadata": {
      "title": "Testing",
      "description": "Learn how to set up Next.js with four commonly used testing tools — Cypress, Playwright, Vitest, and Jest."
    },
    "content": "## Types of tests\n\n- **Unit Testing** involves testing individual units (or blocks of code) in isolation. In React, a unit can be a single function, hook, or component.\n  - **Component Testing** is a more focused version of unit testing where the primary subject of the tests is React components. This may involve testing how components are rendered, their interaction with props, and their behavior in response to user events.\n  - **Integration Testing** involves testing how multiple units work together. This can be a combination of components, hooks, and functions.\n- **End-to-End (E2E) Testing** involves testing user flows in an environment that simulates real user scenarios, like the browser. This means testing specific tasks (e.g. signup flow) in a production-like environment.\n- **Snapshot Testing** involves capturing the rendered output of a component and saving it to a snapshot file. When tests run, the current rendered output of the component is compared against the saved snapshot. Changes in the snapshot are used to indicate unexpected changes in behavior.\n\n<AppOnly>"
  },
  {
    "id": "index.mdx#2",
    "metadata": {
      "title": "Testing",
      "description": "Learn how to set up Next.js with four commonly used testing tools — Cypress, Playwright, Vitest, and Jest."
    },
    "content": "## Async Server Components\n\nSince `async` Server Components are new to the React ecosystem, some tools do not fully support them. In the meantime, we recommend using **End-to-End Testing** over **Unit Testing** for `async` components.\n\n</AppOnly>\n\n## Guides\n\nSee the guides below to learn how to set up Next.js with these commonly used testing tools:"
  },
  {
    "id": "jest.mdx#0",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "---\ntitle: How to set up Jest with Next.js\nnav_title: Jest\ndescription: Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nJest and React Testing Library are frequently used together for **Unit Testing** and **Snapshot Testing**. This guide will show you how to set up Jest with Next.js and write your first tests.\n\n> **Good to know:** Since `async` Server Components are new to the React ecosystem, Jest currently does not support them. While you can still run **unit tests** for synchronous Server and Client Components, we recommend using an **E2E tests** for `async` components.\n\n## Quickstart\n\nYou can use `create-next-app` with the Next.js [with-jest](https://github.com/vercel/next.js/tree/canary/examples/with-jest) example to quickly get started:\n\n```bash filename=\"Terminal\"\nnpx create-next-app@latest --example with-jest with-jest-app\n```"
  },
  {
    "id": "jest.mdx#1",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "## Manual setup\n\nSince the release of [Next.js 12](https://nextjs.org/blog/next-12), Next.js now has built-in configuration for Jest.\n\nTo set up Jest, install `jest` and the following packages as dev dependencies:\n\n```bash filename=\"Terminal\"\nnpm install -D jest jest-environment-jsdom @testing-library/react @testing-library/dom @testing-library/jest-dom ts-node @types/jest\n# or\nyarn add -D jest jest-environment-jsdom @testing-library/react @testing-library/dom @testing-library/jest-dom ts-node @types/jest\n# or\npnpm install -D jest jest-environment-jsdom @testing-library/react @testing-library/dom @testing-library/jest-dom ts-node @types/jest\n```\n\nGenerate a basic Jest configuration file by running the following command:\n\n```bash filename=\"Terminal\"\nnpm init jest@latest\n# or\nyarn create jest@latest\n# or\npnpm create jest@latest"
  },
  {
    "id": "jest.mdx#2",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "```\n\nGenerate a basic Jest configuration file by running the following command:\n\n```bash filename=\"Terminal\"\nnpm init jest@latest\n# or\nyarn create jest@latest\n# or\npnpm create jest@latest\n```\n\nThis will take you through a series of prompts to setup Jest for your project, including automatically creating a `jest.config.ts|js` file.\n\nUpdate your config file to use `next/jest`. This transformer has all the necessary configuration options for Jest to work with Next.js:\n\n```ts filename=\"jest.config.ts\" switcher\nimport type { Config } from 'jest'\nimport nextJest from 'next/jest.js'\n\nconst createJestConfig = nextJest({\n  // Provide the path to your Next.js app to load next.config.js and .env files in your test environment\n  dir: './',\n})\n\n// Add any custom config to be passed to Jest\nconst config: Config = {\n  coverageProvider: 'v8',\n  testEnvironment: 'jsdom',\n  // Add more setup options before each test is run\n  // setupFilesAfterEnv: ['<rootDir>/jest.setup.ts'],\n}\n\n// createJestConfig is exported this way to ensure that next/jest can load the Next.js config which is async\nexport default createJestConfig(config)"
  },
  {
    "id": "jest.mdx#3",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "```\n\n```js filename=\"jest.config.js\" switcher\nconst nextJest = require('next/jest')\n\n/** @type {import('jest').Config} */\nconst createJestConfig = nextJest({\n  // Provide the path to your Next.js app to load next.config.js and .env files in your test environment\n  dir: './',\n})\n\n// Add any custom config to be passed to Jest\nconst config = {\n  coverageProvider: 'v8',\n  testEnvironment: 'jsdom',\n  // Add more setup options before each test is run\n  // setupFilesAfterEnv: ['<rootDir>/jest.setup.ts'],\n}\n\n// createJestConfig is exported this way to ensure that next/jest can load the Next.js config which is async\nmodule.exports = createJestConfig(config)"
  },
  {
    "id": "jest.mdx#4",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "```\n\nUnder the hood, `next/jest` is automatically configuring Jest for you, including:\n\n- Setting up `transform` using the [Next.js Compiler](/docs/architecture/nextjs-compiler).\n- Auto mocking stylesheets (`.css`, `.module.css`, and their scss variants), image imports and [`next/font`](/docs/app/api-reference/components/font).\n- Loading `.env` (and all variants) into `process.env`.\n- Ignoring `node_modules` from test resolving and transforms.\n- Ignoring `.next` from test resolving.\n- Loading `next.config.js` for flags that enable SWC transforms.\n\n> **Good to know**: To test environment variables directly, load them manually in a separate setup script or in your `jest.config.ts` file. For more information, please see [Test Environment Variables](/docs/app/guides/environment-variables#test-environment-variables).\n\n<PagesOnly>"
  },
  {
    "id": "jest.mdx#5",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "## Setting up Jest (with Babel)\n\nIf you opt out of the [Next.js Compiler](/docs/architecture/nextjs-compiler) and use Babel instead, you will need to manually configure Jest and install `babel-jest` and `identity-obj-proxy` in addition to the packages above.\n\nHere are the recommended options to configure Jest for Next.js:\n\n```js filename=\"jest.config.js\"\nmodule.exports = {\n  collectCoverage: true,\n  // on node 14.x coverage provider v8 offers good speed and more or less good report\n  coverageProvider: 'v8',\n  collectCoverageFrom: [\n    '**/*.{js,jsx,ts,tsx}',\n    '!**/*.d.ts',\n    '!**/node_modules/**',\n    '!<rootDir>/out/**',\n    '!<rootDir>/.next/**',\n    '!<rootDir>/*.config.js',\n    '!<rootDir>/coverage/**',\n  ],\n  moduleNameMapper: {\n    // Handle CSS imports (with CSS modules)\n    // https://jestjs.io/docs/webpack#mocking-css-modules\n    '^.+\\\\.module\\\\.(css|sass|scss)$': 'identity-obj-proxy',\n\n    // Handle CSS imports (without CSS modules)\n    '^.+\\\\.(css|sass|scss)$': '<rootDir>/__mocks__/styleMock.js',"
  },
  {
    "id": "jest.mdx#6",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "// Handle CSS imports (without CSS modules)\n    '^.+\\\\.(css|sass|scss)$': '<rootDir>/__mocks__/styleMock.js',\n\n    // Handle image imports\n    // https://jestjs.io/docs/webpack#handling-static-assets\n    '^.+\\\\.(png|jpg|jpeg|gif|webp|avif|ico|bmp|svg)$': `<rootDir>/__mocks__/fileMock.js`,\n\n    // Handle module aliases\n    '^@/components/(.*)$': '<rootDir>/components/$1',"
  },
  {
    "id": "jest.mdx#7",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "// Handle module aliases\n    '^@/components/(.*)$': '<rootDir>/components/$1',\n\n    // Handle @next/font\n    '@next/font/(.*)': `<rootDir>/__mocks__/nextFontMock.js`,\n    // Handle next/font\n    'next/font/(.*)': `<rootDir>/__mocks__/nextFontMock.js`,\n    // Disable server-only\n    'server-only': `<rootDir>/__mocks__/empty.js`,\n  },\n  // Add more setup options before each test is run\n  // setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],\n  testPathIgnorePatterns: ['<rootDir>/node_modules/', '<rootDir>/.next/'],\n  testEnvironment: 'jsdom',\n  transform: {\n    // Use babel-jest to transpile tests with the next/babel preset\n    // https://jestjs.io/docs/configuration#transform-objectstring-pathtotransformer--pathtotransformer-object\n    '^.+\\\\.(js|jsx|ts|tsx)$': ['babel-jest', { presets: ['next/babel'] }],\n  },\n  transformIgnorePatterns: [\n    '/node_modules/',\n    '^.+\\\\.module\\\\.(css|sass|scss)$',\n  ],\n}"
  },
  {
    "id": "jest.mdx#8",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "```\n\nYou can learn more about each configuration option in the [Jest docs](https://jestjs.io/docs/configuration). We also recommend reviewing [`next/jest` configuration](https://github.com/vercel/next.js/blob/e02fe314dcd0ae614c65b505c6daafbdeebb920e/packages/next/src/build/jest/jest.ts) to see how Next.js configures Jest."
  },
  {
    "id": "jest.mdx#9",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "### Handling stylesheets and image imports\n\nStylesheets and images aren't used in the tests but importing them may cause errors, so they will need to be mocked.\n\nCreate the mock files referenced in the configuration above - `fileMock.js` and `styleMock.js` - inside a `__mocks__` directory:\n\n```js filename=\"__mocks__/fileMock.js\"\nmodule.exports = 'test-file-stub'\n```\n\n```js filename=\"__mocks__/styleMock.js\"\nmodule.exports = {}\n```\n\nFor more information on handling static assets, please refer to the [Jest Docs](https://jestjs.io/docs/webpack#handling-static-assets)."
  },
  {
    "id": "jest.mdx#10",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "## Handling Fonts\n\nTo handle fonts, create the `nextFontMock.js` file inside the `__mocks__` directory, and add the following configuration:\n\n```js filename=\"__mocks__/nextFontMock.js\"\nmodule.exports = new Proxy(\n  {},\n  {\n    get: function getter() {\n      return () => ({\n        className: 'className',\n        variable: 'variable',\n        style: { fontFamily: 'fontFamily' },\n      })\n    },\n  }\n)\n```\n\n</PagesOnly>\n\n## Optional: Handling Absolute Imports and Module Path Aliases\n\nIf your project is using [Module Path Aliases](/docs/app/getting-started/installation#set-up-absolute-imports-and-module-path-aliases), you will need to configure Jest to resolve the imports by matching the paths option in the `jsconfig.json` file with the `moduleNameMapper` option in the `jest.config.js` file. For example:\n\n```json filename=\"tsconfig.json or jsconfig.json\"\n{\n  \"compilerOptions\": {\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"bundler\",\n    \"baseUrl\": \"./\",\n    \"paths\": {\n      \"@/components/*\": [\"components/*\"]\n    }\n  }\n}\n```\n\n```js filename=\"jest.config.js\"\nmoduleNameMapper: {\n  // ...\n  '^@/components/(.*)$': '<rootDir>/components/$1',\n}\n```"
  },
  {
    "id": "jest.mdx#11",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "## Optional: Extend Jest with custom matchers\n\n`@testing-library/jest-dom` includes a set of convenient [custom matchers](https://github.com/testing-library/jest-dom#custom-matchers) such as `.toBeInTheDocument()` making it easier to write tests. You can import the custom matchers for every test by adding the following option to the Jest configuration file:\n\n```ts filename=\"jest.config.ts\" switcher\nsetupFilesAfterEnv: ['<rootDir>/jest.setup.ts']\n```\n\n```js filename=\"jest.config.js\" switcher\nsetupFilesAfterEnv: ['<rootDir>/jest.setup.js']\n```\n\nThen, inside `jest.setup`, add the following import:\n\n```ts filename=\"jest.setup.ts\" switcher\nimport '@testing-library/jest-dom'\n```\n\n```js filename=\"jest.setup.js\" switcher\nimport '@testing-library/jest-dom'\n```\n\n> **Good to know:** [`extend-expect` was removed in `v6.0`](https://github.com/testing-library/jest-dom/releases/tag/v6.0.0), so if you are using `@testing-library/jest-dom` before version 6, you will need to import `@testing-library/jest-dom/extend-expect` instead.\n\nIf you need to add more setup options before each test, you can add them to the `jest.setup` file above."
  },
  {
    "id": "jest.mdx#12",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "## Add a test script to `package.json`\n\nFinally, add a Jest `test` script to your `package.json` file:\n\n```json filename=\"package.json\" highlight={6-7}\n{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"test\": \"jest\",\n    \"test:watch\": \"jest --watch\"\n  }\n}\n```\n\n`jest --watch` will re-run tests when a file is changed. For more Jest CLI options, please refer to the [Jest Docs](https://jestjs.io/docs/cli#reference)."
  },
  {
    "id": "jest.mdx#13",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "### Creating your first test\n\nYour project is now ready to run tests. Create a folder called `__tests__` in your project's root directory.\n\n<PagesOnly>\n\nFor example, we can add a test to check if the `<Home />` component successfully renders a heading:\n\n```jsx filename=\"pages/index.js\nexport default function Home() {\n  return <h1>Home</h1>\n}\n```\n\n```jsx filename=\"__tests__/index.test.js\"\nimport '@testing-library/jest-dom'\nimport { render, screen } from '@testing-library/react'\nimport Home from '../pages/index'\n\ndescribe('Home', () => {\n  it('renders a heading', () => {\n    render(<Home />)\n\n    const heading = screen.getByRole('heading', { level: 1 })\n\n    expect(heading).toBeInTheDocument()\n  })\n})\n```\n\n</PagesOnly>\n\n<AppOnly>\n\nFor example, we can add a test to check if the `<Page />` component successfully renders a heading:\n\n```jsx filename=\"app/page.js\"\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <div>\n      <h1>Home</h1>\n      <Link href=\"/about\">About</Link>\n    </div>\n  )\n}"
  },
  {
    "id": "jest.mdx#14",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "```\n\n```jsx filename=\"__tests__/page.test.jsx\"\nimport '@testing-library/jest-dom'\nimport { render, screen } from '@testing-library/react'\nimport Page from '../app/page'\n\ndescribe('Page', () => {\n  it('renders a heading', () => {\n    render(<Page />)\n\n    const heading = screen.getByRole('heading', { level: 1 })\n\n    expect(heading).toBeInTheDocument()\n  })\n})\n```\n\n</AppOnly>\n\nOptionally, add a [snapshot test](https://jestjs.io/docs/snapshot-testing) to keep track of any unexpected changes in your component:\n\n<PagesOnly>\n\n```jsx filename=\"__tests__/snapshot.js\"\nimport { render } from '@testing-library/react'\nimport Home from '../pages/index'\n\nit('renders homepage unchanged', () => {\n  const { container } = render(<Home />)\n  expect(container).toMatchSnapshot()\n})\n```\n\n> **Good to know**: Test files should not be included inside the Pages Router because any files inside the Pages Router are considered routes.\n\n</PagesOnly>\n\n<AppOnly>\n\n```jsx filename=\"__tests__/snapshot.js\"\nimport { render } from '@testing-library/react'\nimport Page from '../app/page'\n\nit('renders homepage unchanged', () => {\n  const { container } = render(<Page />)\n  expect(container).toMatchSnapshot()\n})"
  },
  {
    "id": "jest.mdx#15",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "```\n\n</AppOnly>"
  },
  {
    "id": "jest.mdx#16",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Jest with Next.js for Unit Testing and Snapshot Testing."
    },
    "content": "## Running your tests\n\nThen, run the following command to run your tests:\n\n```bash filename=\"Terminal\"\nnpm run test\n# or\nyarn test\n# or\npnpm test\n```\n\n## Additional Resources\n\nFor further reading, you may find these resources helpful:\n\n- [Next.js with Jest example](https://github.com/vercel/next.js/tree/canary/examples/with-jest)\n- [Jest Docs](https://jestjs.io/docs/getting-started)\n- [React Testing Library Docs](https://testing-library.com/docs/react-testing-library/intro/)\n- [Testing Playground](https://testing-playground.com/) - use good testing practices to match elements."
  },
  {
    "id": "playwright.mdx#0",
    "metadata": {
      "title": "How to set up Playwright with Next.js",
      "description": "Learn how to set up Playwright with Next.js for End-to-End (E2E) Testing."
    },
    "content": "---\ntitle: How to set up Playwright with Next.js\nnav_title: Playwright\ndescription: Learn how to set up Playwright with Next.js for End-to-End (E2E) Testing.\n---\n\nPlaywright is a testing framework that lets you automate Chromium, Firefox, and WebKit with a single API. You can use it to write **End-to-End (E2E)** testing. This guide will show you how to set up Playwright with Next.js and write your first tests.\n\n## Quickstart\n\nThe fastest way to get started is to use `create-next-app` with the [with-playwright example](https://github.com/vercel/next.js/tree/canary/examples/with-playwright). This will create a Next.js project complete with Playwright configured.\n\n```bash filename=\"Terminal\"\nnpx create-next-app@latest --example with-playwright with-playwright-app\n```"
  },
  {
    "id": "playwright.mdx#1",
    "metadata": {
      "title": "How to set up Playwright with Next.js",
      "description": "Learn how to set up Playwright with Next.js for End-to-End (E2E) Testing."
    },
    "content": "## Manual setup\n\nTo install Playwright, run the following command:\n\n```bash filename=\"Terminal\"\nnpm init playwright\n# or\nyarn create playwright\n# or\npnpm create playwright\n```\n\nThis will take you through a series of prompts to setup and configure Playwright for your project, including adding a `playwright.config.ts` file. Please refer to the [Playwright installation guide](https://playwright.dev/docs/intro#installation) for the step-by-step guide."
  },
  {
    "id": "playwright.mdx#2",
    "metadata": {
      "title": "How to set up Playwright with Next.js",
      "description": "Learn how to set up Playwright with Next.js for End-to-End (E2E) Testing."
    },
    "content": "## Creating your first Playwright E2E test\n\nCreate two new Next.js pages:\n\n<AppOnly>\n\n```tsx filename=\"app/page.tsx\"\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <div>\n      <h1>Home</h1>\n      <Link href=\"/about\">About</Link>\n    </div>\n  )\n}\n```\n\n```tsx filename=\"app/about/page.tsx\"\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <div>\n      <h1>About</h1>\n      <Link href=\"/\">Home</Link>\n    </div>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/index.ts\"\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <div>\n      <h1>Home</h1>\n      <Link href=\"/about\">About</Link>\n    </div>\n  )\n}\n```\n\n```tsx filename=\"pages/about.ts\"\nimport Link from 'next/link'\n\nexport default function About() {\n  return (\n    <div>\n      <h1>About</h1>\n      <Link href=\"/\">Home</Link>\n    </div>\n  )\n}"
  },
  {
    "id": "playwright.mdx#3",
    "metadata": {
      "title": "How to set up Playwright with Next.js",
      "description": "Learn how to set up Playwright with Next.js for End-to-End (E2E) Testing."
    },
    "content": "```\n\n```tsx filename=\"pages/about.ts\"\nimport Link from 'next/link'\n\nexport default function About() {\n  return (\n    <div>\n      <h1>About</h1>\n      <Link href=\"/\">Home</Link>\n    </div>\n  )\n}\n```\n\n</PagesOnly>\n\nThen, add a test to verify that your navigation is working correctly:\n\n```ts filename=\"tests/example.spec.ts\"\nimport { test, expect } from '@playwright/test'\n\ntest('should navigate to the about page', async ({ page }) => {\n  // Start from the index page (the baseURL is set via the webServer in the playwright.config.ts)\n  await page.goto('http://localhost:3000/')\n  // Find an element with the text 'About' and click on it\n  await page.click('text=About')\n  // The new URL should be \"/about\" (baseURL is used there)\n  await expect(page).toHaveURL('http://localhost:3000/about')\n  // The new page should contain an h1 with \"About\"\n  await expect(page.locator('h1')).toContainText('About')\n})"
  },
  {
    "id": "playwright.mdx#4",
    "metadata": {
      "title": "How to set up Playwright with Next.js",
      "description": "Learn how to set up Playwright with Next.js for End-to-End (E2E) Testing."
    },
    "content": "```\n\n> **Good to know**: You can use `page.goto(\"/\")` instead of `page.goto(\"http://localhost:3000/\")`, if you add [`\"baseURL\": \"http://localhost:3000\"`](https://playwright.dev/docs/api/class-testoptions#test-options-base-url) to the `playwright.config.ts` [configuration file](https://playwright.dev/docs/test-configuration)."
  },
  {
    "id": "playwright.mdx#5",
    "metadata": {
      "title": "How to set up Playwright with Next.js",
      "description": "Learn how to set up Playwright with Next.js for End-to-End (E2E) Testing."
    },
    "content": "### Running your Playwright tests\n\nPlaywright will simulate a user navigating your application using three browsers: Chromium, Firefox and Webkit, this requires your Next.js server to be running. We recommend running your tests against your production code to more closely resemble how your application will behave.\n\nRun `npm run build` and `npm run start`, then run `npx playwright test` in another terminal window to run the Playwright tests.\n\n> **Good to know**: Alternatively, you can use the [`webServer`](https://playwright.dev/docs/test-webserver/) feature to let Playwright start the development server and wait until it's fully available."
  },
  {
    "id": "playwright.mdx#6",
    "metadata": {
      "title": "How to set up Playwright with Next.js",
      "description": "Learn how to set up Playwright with Next.js for End-to-End (E2E) Testing."
    },
    "content": "### Running Playwright on Continuous Integration (CI)\n\nPlaywright will by default run your tests in the [headless mode](https://playwright.dev/docs/ci#running-headed). To install all the Playwright dependencies, run `npx playwright install-deps`.\n\nYou can learn more about Playwright and Continuous Integration from these resources:\n\n- [Next.js with Playwright example](https://github.com/vercel/next.js/tree/canary/examples/with-playwright)\n- [Playwright on your CI provider](https://playwright.dev/docs/ci)\n- [Playwright Discord](https://discord.com/invite/playwright-807756831384403968)"
  },
  {
    "id": "vitest.mdx#0",
    "metadata": {
      "title": "How to set up Vitest with Next.js",
      "description": "Learn how to set up Vitest with Next.js for Unit Testing."
    },
    "content": "---\ntitle: How to set up Vitest with Next.js\nnav_title: Vitest\ndescription: Learn how to set up Vitest with Next.js for Unit Testing.\n---\n\nVitest and React Testing Library are frequently used together for **Unit Testing**. This guide will show you how to setup Vitest with Next.js and write your first tests.\n\n> **Good to know:** Since `async` Server Components are new to the React ecosystem, Vitest currently does not support them. While you can still run **unit tests** for synchronous Server and Client Components, we recommend using **E2E tests** for `async` components.\n\n## Quickstart\n\nYou can use `create-next-app` with the Next.js [with-vitest](https://github.com/vercel/next.js/tree/canary/examples/with-vitest) example to quickly get started:\n\n```bash filename=\"Terminal\"\nnpx create-next-app@latest --example with-vitest with-vitest-app\n```"
  },
  {
    "id": "vitest.mdx#1",
    "metadata": {
      "title": "How to set up Vitest with Next.js",
      "description": "Learn how to set up Vitest with Next.js for Unit Testing."
    },
    "content": "## Manual Setup\n\nTo manually set up Vitest, install `vitest` and the following packages as dev dependencies:\n\n```bash filename=\"Terminal\"\n# Using TypeScript\nnpm install -D vitest @vitejs/plugin-react jsdom @testing-library/react @testing-library/dom vite-tsconfig-paths\n# Using JavaScript\nnpm install -D vitest @vitejs/plugin-react jsdom @testing-library/react @testing-library/dom\n```\n\nCreate a `vitest.config.mts|js` file in the root of your project, and add the following options:\n\n```ts filename=\"vitest.config.mts\" switcher\nimport { defineConfig } from 'vitest/config'\nimport react from '@vitejs/plugin-react'\nimport tsconfigPaths from 'vite-tsconfig-paths'\n\nexport default defineConfig({\n  plugins: [tsconfigPaths(), react()],\n  test: {\n    environment: 'jsdom',\n  },\n})\n```\n\n```js filename=\"vitest.config.js\" switcher\nimport { defineConfig } from 'vitest/config'\nimport react from '@vitejs/plugin-react'\n\nexport default defineConfig({\n  plugins: [react()],\n  test: {\n    environment: 'jsdom',\n  },\n})"
  },
  {
    "id": "vitest.mdx#2",
    "metadata": {
      "title": "How to set up Vitest with Next.js",
      "description": "Learn how to set up Vitest with Next.js for Unit Testing."
    },
    "content": "```\n\nFor more information on configuring Vitest, please refer to the [Vitest Configuration](https://vitest.dev/config/#configuration) docs.\n\nThen, add a `test` script to your `package.json`:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"test\": \"vitest\"\n  }\n}\n```\n\nWhen you run `npm run test`, Vitest will **watch** for changes in your project by default."
  },
  {
    "id": "vitest.mdx#3",
    "metadata": {
      "title": "How to set up Vitest with Next.js",
      "description": "Learn how to set up Vitest with Next.js for Unit Testing."
    },
    "content": "## Creating your first Vitest Unit Test\n\nCheck that everything is working by creating a test to check if the `<Page />` component successfully renders a heading:\n\n<AppOnly>\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <div>\n      <h1>Home</h1>\n      <Link href=\"/about\">About</Link>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/page.jsx\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <div>\n      <h1>Home</h1>\n      <Link href=\"/about\">About</Link>\n    </div>\n  )\n}\n```\n\n```tsx filename=\"__tests__/page.test.tsx\" switcher\nimport { expect, test } from 'vitest'\nimport { render, screen } from '@testing-library/react'\nimport Page from '../app/page'\n\ntest('Page', () => {\n  render(<Page />)\n  expect(screen.getByRole('heading', { level: 1, name: 'Home' })).toBeDefined()\n})\n```\n\n```jsx filename=\"__tests__/page.test.jsx\" switcher\nimport { expect, test } from 'vitest'\nimport { render, screen } from '@testing-library/react'\nimport Page from '../app/page'\n\ntest('Page', () => {\n  render(<Page />)\n  expect(screen.getByRole('heading', { level: 1, name: 'Home' })).toBeDefined()\n})"
  },
  {
    "id": "vitest.mdx#4",
    "metadata": {
      "title": "How to set up Vitest with Next.js",
      "description": "Learn how to set up Vitest with Next.js for Unit Testing."
    },
    "content": "```\n\n> **Good to know**: The example above uses the common `__tests__` convention, but test files can also be colocated inside the `app` router.\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <div>\n      <h1>Home</h1>\n      <Link href=\"/about\">About</Link>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"pages/index.jsx\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <div>\n      <h1>Home</h1>\n      <Link href=\"/about\">About</Link>\n    </div>\n  )\n}\n```\n\n```tsx filename=\"__tests__/index.test.tsx\" switcher\nimport { expect, test } from 'vitest'\nimport { render, screen } from '@testing-library/react'\nimport Page from '../pages/index'\n\ntest('Page', () => {\n  render(<Page />)\n  expect(screen.getByRole('heading', { level: 1, name: 'Home' })).toBeDefined()\n})\n```\n\n```jsx filename=\"__tests__/index.test.jsx\" switcher\nimport { expect, test } from 'vitest'\nimport { render, screen } from '@testing-library/react'\nimport Page from '../pages/index'\n\ntest('Page', () => {\n  render(<Page />)\n  expect(screen.getByRole('heading', { level: 1, name: 'Home' })).toBeDefined()\n})"
  },
  {
    "id": "vitest.mdx#5",
    "metadata": {
      "title": "How to set up Vitest with Next.js",
      "description": "Learn how to set up Vitest with Next.js for Unit Testing."
    },
    "content": "```\n\n</PagesOnly>"
  },
  {
    "id": "vitest.mdx#6",
    "metadata": {
      "title": "How to set up Vitest with Next.js",
      "description": "Learn how to set up Vitest with Next.js for Unit Testing."
    },
    "content": "## Running your tests\n\nThen, run the following command to run your tests:\n\n```bash filename=\"Terminal\"\nnpm run test\n# or\nyarn test\n# or\npnpm test\n# or\nbun test\n```\n\n## Additional Resources\n\nYou may find these resources helpful:\n\n- [Next.js with Vitest example](https://github.com/vercel/next.js/tree/canary/examples/with-vitest)\n- [Vitest Docs](https://vitest.dev/guide/)\n- [React Testing Library Docs](https://testing-library.com/docs/react-testing-library/intro/)"
  },
  {
    "id": "third-party-libraries.mdx#0",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "---\ntitle: How to optimize third-party libraries\nnav_title: Third Party Libraries\ndescription: Optimize the performance of third-party libraries in your application with the `@next/third-parties` package.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n**`@next/third-parties`** is a library that provides a collection of components and utilities that improve the performance and developer experience of loading popular third-party libraries in your Next.js application.\n\nAll third-party integrations provided by `@next/third-parties` have been optimized for performance and ease of use."
  },
  {
    "id": "third-party-libraries.mdx#1",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "## Getting Started\n\nTo get started, install the `@next/third-parties` library:\n\n```bash filename=\"Terminal\"\nnpm install @next/third-parties@latest next@latest\n```\n\n{/* To do: Remove this paragraph once package becomes stable */}\n\n`@next/third-parties` is currently an **experimental** library under active development. We recommend installing it with the **latest** or **canary** flags while we work on adding more third-party integrations."
  },
  {
    "id": "third-party-libraries.mdx#2",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "## Google Third-Parties\n\nAll supported third-party libraries from Google can be imported from `@next/third-parties/google`."
  },
  {
    "id": "third-party-libraries.mdx#3",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "### Google Tag Manager\n\nThe `GoogleTagManager` component can be used to instantiate a [Google Tag Manager](https://developers.google.com/tag-platform/tag-manager) container to your page. By default, it fetches the original inline script after hydration occurs on the page.\n\n<AppOnly>\n\nTo load Google Tag Manager for all routes, include the component directly in your root layout and pass in your GTM container ID:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { GoogleTagManager } from '@next/third-parties/google'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <GoogleTagManager gtmId=\"GTM-XYZ\" />\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { GoogleTagManager } from '@next/third-parties/google'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <GoogleTagManager gtmId=\"GTM-XYZ\" />\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "third-party-libraries.mdx#4",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\nTo load Google Tag Manager for all routes, include the component directly in your custom `_app` and\npass in your GTM container ID:\n\n```jsx filename=\"pages/_app.js\"\nimport { GoogleTagManager } from '@next/third-parties/google'\n\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <>\n      <Component {...pageProps} />\n      <GoogleTagManager gtmId=\"GTM-XYZ\" />\n    </>\n  )\n}\n```\n\n</PagesOnly>\n\nTo load Google Tag Manager for a single route, include the component in your page file:\n\n<AppOnly>\n\n```jsx filename=\"app/page.js\"\nimport { GoogleTagManager } from '@next/third-parties/google'\n\nexport default function Page() {\n  return <GoogleTagManager gtmId=\"GTM-XYZ\" />\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/index.js\"\nimport { GoogleTagManager } from '@next/third-parties/google'\n\nexport default function Page() {\n  return <GoogleTagManager gtmId=\"GTM-XYZ\" />\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "third-party-libraries.mdx#5",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "#### Sending Events\n\nThe `sendGTMEvent` function can be used to track user interactions on your page by sending events\nusing the `dataLayer` object. For this function to work, the `<GoogleTagManager />` component must be\nincluded in either a parent layout, page, or component, or directly in the same file.\n\n<AppOnly>\n\n```jsx filename=\"app/page.js\"\n'use client'\n\nimport { sendGTMEvent } from '@next/third-parties/google'\n\nexport function EventButton() {\n  return (\n    <div>\n      <button\n        onClick={() => sendGTMEvent({ event: 'buttonClicked', value: 'xyz' })}\n      >\n        Send Event\n      </button>\n    </div>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/index.js\"\nimport { sendGTMEvent } from '@next/third-parties/google'\n\nexport function EventButton() {\n  return (\n    <div>\n      <button\n        onClick={() => sendGTMEvent({ event: 'buttonClicked', value: 'xyz' })}\n      >\n        Send Event\n      </button>\n    </div>\n  )\n}\n```\n\n</PagesOnly>\n\nRefer to the Tag Manager [developer\ndocumentation](https://developers.google.com/tag-platform/tag-manager/datalayer) to learn about the\ndifferent variables and events that can be passed into the function."
  },
  {
    "id": "third-party-libraries.mdx#6",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "#### Server-side Tagging\n\nIf you're using a server-side tag manager and serving `gtm.js` scripts from your tagging server you can\nuse `gtmScriptUrl` option to specify the URL of the script."
  },
  {
    "id": "third-party-libraries.mdx#7",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "#### Options\n\nOptions to pass to the Google Tag Manager. For a full list of options, read the [Google Tag Manager\ndocs](https://developers.google.com/tag-platform/tag-manager/datalayer).\n\n| Name            | Type       | Description                                                              |\n| --------------- | ---------- | ------------------------------------------------------------------------ |\n| `gtmId`         | Required\\* | Your GTM container ID. Usually starts with `GTM-`.                       |\n| `gtmScriptUrl`  | Optional\\* | GTM script URL. Defaults to `https://www.googletagmanager.com/gtm.js`.   |\n| `dataLayer`     | Optional   | Data layer object to instantiate the container with.                     |\n| `dataLayerName` | Optional   | Name of the data layer. Defaults to `dataLayer`.                         |\n| `auth`          | Optional   | Value of authentication parameter (`gtm_auth`) for environment snippets. |\n| `preview`       | Optional   | Value of preview parameter (`gtm_preview`) for environment snippets.     |"
  },
  {
    "id": "third-party-libraries.mdx#8",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "\\*`gtmId` can be omitted when `gtmScriptUrl` is provided to support [Google tag gateway for advertisers](https://developers.google.com/tag-platform/tag-manager/gateway/setup-guide?setup=manual)."
  },
  {
    "id": "third-party-libraries.mdx#9",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "### Google Analytics\n\nThe `GoogleAnalytics` component can be used to include [Google Analytics\n4](https://developers.google.com/analytics/devguides/collection/ga4) to your page via the Google tag\n(`gtag.js`). By default, it fetches the original scripts after hydration occurs on the page.\n\n> **Recommendation**: If Google Tag Manager is already included in your application, you can\n> configure Google Analytics directly using it, rather than including Google Analytics as a separate\n> component. Refer to the\n> [documentation](https://developers.google.com/analytics/devguides/collection/ga4/tag-options#what-is-gtm)\n> to learn more about the differences between Tag Manager and `gtag.js`.\n\n<AppOnly>\n\nTo load Google Analytics for all routes, include the component directly in your root layout and pass\nin your measurement ID:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { GoogleAnalytics } from '@next/third-parties/google'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n      <GoogleAnalytics gaId=\"G-XYZ\" />\n    </html>\n  )\n}"
  },
  {
    "id": "third-party-libraries.mdx#10",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { GoogleAnalytics } from '@next/third-parties/google'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n      <GoogleAnalytics gaId=\"G-XYZ\" />\n    </html>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nTo load Google Analytics for all routes, include the component directly in your custom `_app` and\npass in your measurement ID:\n\n```jsx filename=\"pages/_app.js\"\nimport { GoogleAnalytics } from '@next/third-parties/google'\n\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <>\n      <Component {...pageProps} />\n      <GoogleAnalytics gaId=\"G-XYZ\" />\n    </>\n  )\n}\n```\n\n</PagesOnly>\n\nTo load Google Analytics for a single route, include the component in your page file:\n\n<AppOnly>\n\n```jsx filename=\"app/page.js\"\nimport { GoogleAnalytics } from '@next/third-parties/google'\n\nexport default function Page() {\n  return <GoogleAnalytics gaId=\"G-XYZ\" />\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/index.js\"\nimport { GoogleAnalytics } from '@next/third-parties/google'\n\nexport default function Page() {\n  return <GoogleAnalytics gaId=\"G-XYZ\" />\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "third-party-libraries.mdx#11",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "#### Sending Events\n\nThe `sendGAEvent` function can be used to measure user interactions on your page by sending events\nusing the `dataLayer` object. For this function to work, the `<GoogleAnalytics />` component must be\nincluded in either a parent layout, page, or component, or directly in the same file.\n\n<AppOnly>\n\n```jsx filename=\"app/page.js\"\n'use client'\n\nimport { sendGAEvent } from '@next/third-parties/google'\n\nexport function EventButton() {\n  return (\n    <div>\n      <button\n        onClick={() => sendGAEvent('event', 'buttonClicked', { value: 'xyz' })}\n      >\n        Send Event\n      </button>\n    </div>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/index.js\"\nimport { sendGAEvent } from '@next/third-parties/google'\n\nexport function EventButton() {\n  return (\n    <div>\n      <button\n        onClick={() => sendGAEvent('event', 'buttonClicked', { value: 'xyz' })}\n      >\n        Send Event\n      </button>\n    </div>\n  )\n}\n```\n\n</PagesOnly>\n\nRefer to the Google Analytics [developer\ndocumentation](https://developers.google.com/analytics/devguides/collection/ga4/event-parameters) to learn\nmore about event parameters."
  },
  {
    "id": "third-party-libraries.mdx#12",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "#### Tracking Pageviews\n\nGoogle Analytics automatically tracks pageviews when the browser history state changes. This means\nthat client-side navigations between Next.js routes will send pageview data without any configuration.\n\nTo ensure that client-side navigations are being measured correctly, verify that the [_“Enhanced\nMeasurement”_](https://support.google.com/analytics/answer/9216061#enable_disable) property is\nenabled in your Admin panel and the _“Page changes based on browser history events”_ checkbox is\nselected.\n\n> **Note**: If you decide to manually send pageview events, make sure to disable the default\n> pageview measurement to avoid having duplicate data. Refer to the Google Analytics [developer\n> documentation](https://developers.google.com/analytics/devguides/collection/ga4/views?client_type=gtag#manual_pageviews)\n> to learn more."
  },
  {
    "id": "third-party-libraries.mdx#13",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "#### Options\n\nOptions to pass to the `<GoogleAnalytics>` component.\n\n| Name            | Type     | Description                                                                                            |\n| --------------- | -------- | ------------------------------------------------------------------------------------------------------ |\n| `gaId`          | Required | Your [measurement ID](https://support.google.com/analytics/answer/12270356). Usually starts with `G-`. |\n| `dataLayerName` | Optional | Name of the data layer. Defaults to `dataLayer`.                                                       |\n| `nonce`         | Optional | A [nonce](/docs/app/guides/content-security-policy#nonces).                                            |"
  },
  {
    "id": "third-party-libraries.mdx#14",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "### Google Maps Embed\n\nThe `GoogleMapsEmbed` component can be used to add a [Google Maps\nEmbed](https://developers.google.com/maps/documentation/embed/embedding-map) to your page. By\ndefault, it uses the `loading` attribute to lazy-load the embed below the fold.\n\n<AppOnly>\n\n```jsx filename=\"app/page.js\"\nimport { GoogleMapsEmbed } from '@next/third-parties/google'\n\nexport default function Page() {\n  return (\n    <GoogleMapsEmbed\n      apiKey=\"XYZ\"\n      height={200}\n      width=\"100%\"\n      mode=\"place\"\n      q=\"Brooklyn+Bridge,New+York,NY\"\n    />\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/index.js\"\nimport { GoogleMapsEmbed } from '@next/third-parties/google'\n\nexport default function Page() {\n  return (\n    <GoogleMapsEmbed\n      apiKey=\"XYZ\"\n      height={200}\n      width=\"100%\"\n      mode=\"place\"\n      q=\"Brooklyn+Bridge,New+York,NY\"\n    />\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "third-party-libraries.mdx#15",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "#### Options\n\nOptions to pass to the Google Maps Embed. For a full list of options, read the [Google Map Embed\ndocs](https://developers.google.com/maps/documentation/embed/embedding-map)."
  },
  {
    "id": "third-party-libraries.mdx#16",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "| Name              | Type     | Description                                                                                         |\n| ----------------- | -------- | --------------------------------------------------------------------------------------------------- |\n| `apiKey`          | Required | Your api key.                                                                                       |\n| `mode`            | Required | [Map mode](https://developers.google.com/maps/documentation/embed/embedding-map#choosing_map_modes) |\n| `height`          | Optional | Height of the embed. Defaults to `auto`.                                                            |\n| `width`           | Optional | Width of the embed. Defaults to `auto`.                                                             |\n| `style`           | Optional | Pass styles to the iframe.                                                                          |\n| `allowfullscreen` | Optional | Property to allow certain map parts to go full screen.                                              |"
  },
  {
    "id": "third-party-libraries.mdx#17",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "| `allowfullscreen` | Optional | Property to allow certain map parts to go full screen.                                              |\n| `loading`         | Optional | Defaults to lazy. Consider changing if you know your embed will be above the fold.                  |\n| `q`               | Optional | Defines map marker location. _This may be required depending on the map mode_.                      |\n| `center`          | Optional | Defines the center of the map view.                                                                 |\n| `zoom`            | Optional | Sets initial zoom level of the map.                                                                 |\n| `maptype`         | Optional | Defines type of map tiles to load.                                                                  |\n| `language`        | Optional | Defines the language to use for UI elements and for the display of labels on map tiles.             |\n| `region`          | Optional | Defines the appropriate borders and labels to display, based on geo-political sensitivities.        |"
  },
  {
    "id": "third-party-libraries.mdx#18",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "### YouTube Embed\n\nThe `YouTubeEmbed` component can be used to load and display a YouTube embed. This component loads\nfaster by using [`lite-youtube-embed`](https://github.com/paulirish/lite-youtube-embed) under the\nhood.\n\n<AppOnly>\n\n```jsx filename=\"app/page.js\"\nimport { YouTubeEmbed } from '@next/third-parties/google'\n\nexport default function Page() {\n  return <YouTubeEmbed videoid=\"ogfYd705cRs\" height={400} params=\"controls=0\" />\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/index.js\"\nimport { YouTubeEmbed } from '@next/third-parties/google'\n\nexport default function Page() {\n  return <YouTubeEmbed videoid=\"ogfYd705cRs\" height={400} params=\"controls=0\" />\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "third-party-libraries.mdx#19",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "#### Options"
  },
  {
    "id": "third-party-libraries.mdx#20",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "| Name        | Type     | Description                                                                                                                                                                                                  |\n| ----------- | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| `videoid`   | Required | YouTube video id.                                                                                                                                                                                            |\n| `width`     | Optional | Width of the video container. Defaults to `auto`                                                                                                                                                             |\n| `height`    | Optional | Height of the video container. Defaults to `auto`                                                                                                                                                            |"
  },
  {
    "id": "third-party-libraries.mdx#21",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "| `playlabel` | Optional | A visually hidden label for the play button for accessibility.                                                                                                                                               |\n| `params`    | Optional | The video player params defined [here](https://developers.google.com/youtube/player_parameters#Parameters). <br/> Params are passed as a query param string. <br/> Eg: `params=\"controls=0&start=10&end=30\"` |\n| `style`     | Optional | Used to apply styles to the video container.                                                                                                                                                                 |"
  },
  {
    "id": "codemods.mdx#0",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "---\ntitle: Codemods\ndescription: Use codemods to upgrade your Next.js codebase when new features are released.\n---\n\nCodemods are transformations that run on your codebase programmatically. This allows a large number of changes to be programmatically applied without having to manually go through every file.\n\nNext.js provides Codemod transformations to help upgrade your Next.js codebase when an API is updated or deprecated.\n\n## Usage\n\nIn your terminal, navigate (`cd`) into your project's folder, then run:\n\n```bash filename=\"Terminal\"\nnpx @next/codemod <transform> <path>\n```\n\nReplacing `<transform>` and `<path>` with appropriate values.\n\n- `transform` - name of transform\n- `path` - files or directory to transform\n- `--dry` Do a dry-run, no code will be edited\n- `--print` Prints the changed output for comparison"
  },
  {
    "id": "codemods.mdx#1",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "## Codemods"
  },
  {
    "id": "codemods.mdx#2",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "### 16.0\n\n#### Remove `experimental_ppr` Route Segment Config from App Router pages and layouts\n\n##### `remove-experimental-ppr`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest remove-experimental-ppr .\n```\n\nThis codemod removes the `experimental_ppr` Route Segment Config from App Router pages and layouts.\n\n```diff filename=\"app/page.tsx\"\n- export const experimental_ppr = true;\n```\n\n#### Remove `unstable_` prefix from stabilized API\n\n##### `remove-unstable-prefix`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest remove-unstable-prefix .\n```\n\nThis codemod removes the `unstable_` prefix from stabilized API.\n\nFor example:\n\n```ts\nimport { unstable_cacheTag as cacheTag } from 'next/cache'\n\ncacheTag()\n```\n\nTransforms into:\n\n```ts\nimport { cacheTag } from 'next/cache'\n\ncacheTag()\n```"
  },
  {
    "id": "codemods.mdx#3",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "#### Migrate from deprecated `middleware` convention to `proxy`\n\n##### `middleware-to-proxy`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest middleware-to-proxy .\n```\n\nThis codemod migrates projects from using the deprecated `middleware` convention to using the `proxy` convention. It:\n\n- Renames `middleware.<extension>` to `proxy.<extension>` (e.g. `middleware.ts` to `proxy.ts`)\n- Renames named export `middleware` to `proxy`\n- Renames Next.js config property `experimental.middlewarePrefetch` to `experimental.proxyPrefetch`\n- Renames Next.js config property `experimental.middlewareClientMaxBodySize` to `experimental.proxyClientMaxBodySize`\n- Renames Next.js config property `experimental.externalMiddlewareRewritesResolve` to `experimental.externalProxyRewritesResolve`\n- Renames Next.js config property `skipMiddlewareUrlNormalize` to `skipProxyUrlNormalize`\n\nFor example:\n\n```ts filename=\"middleware.ts\"\nimport { NextResponse } from 'next/server'\n\nexport function middleware() {\n  return NextResponse.next()\n}\n```\n\nTransforms into:\n\n```ts filename=\"proxy.ts\"\nimport { NextResponse } from 'next/server'\n\nexport function proxy() {\n  return NextResponse.next()\n}\n```"
  },
  {
    "id": "codemods.mdx#4",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "#### Migrate from `next lint` to ESLint CLI"
  },
  {
    "id": "codemods.mdx#5",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "##### `next-lint-to-eslint-cli`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@canary next-lint-to-eslint-cli .\n```\n\nThis codemod migrates projects from using `next lint` to using the ESLint CLI with your local ESLint config. It:\n\n- Creates an `eslint.config.mjs` file with Next.js recommended configurations\n- Updates `package.json` scripts to use `eslint .` instead of `next lint`\n- Adds necessary ESLint dependencies to `package.json`\n- Preserves existing ESLint configurations when found\n\nFor example:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"lint\": \"next lint\"\n  }\n}\n```\n\nBecomes:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"lint\": \"eslint .\"\n  }\n}"
  },
  {
    "id": "codemods.mdx#6",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "```\n\nBecomes:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"lint\": \"eslint .\"\n  }\n}\n```\n\nAnd creates:\n\n```js filename=\"eslint.config.mjs\"\nimport { dirname } from 'path'\nimport { fileURLToPath } from 'url'\nimport { FlatCompat } from '@eslint/eslintrc'\n\nconst __filename = fileURLToPath(import.meta.url)\nconst __dirname = dirname(__filename)\n\nconst compat = new FlatCompat({\n  baseDirectory: __dirname,\n})\n\nconst eslintConfig = [\n  ...compat.extends('next/core-web-vitals', 'next/typescript'),\n  {\n    ignores: [\n      'node_modules/**',\n      '.next/**',\n      'out/**',\n      'build/**',\n      'next-env.d.ts',\n    ],\n  },\n]\n\nexport default eslintConfig\n```"
  },
  {
    "id": "codemods.mdx#7",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "### 15.0\n\n#### Transform App Router Route Segment Config `runtime` value from `experimental-edge` to `edge`\n\n##### `app-dir-runtime-config-experimental-edge`\n\n> **Note**: This codemod is App Router specific.\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest app-dir-runtime-config-experimental-edge .\n```\n\nThis codemod transforms [Route Segment Config `runtime`](https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config#runtime) value `experimental-edge` to `edge`.\n\nFor example:\n\n```ts\nexport const runtime = 'experimental-edge'\n```\n\nTransforms into:\n\n```ts\nexport const runtime = 'edge'\n```"
  },
  {
    "id": "codemods.mdx#8",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "#### Migrate to async Dynamic APIs\n\nAPIs that opted into dynamic rendering that previously supported synchronous access are now asynchronous. You can read more about this breaking change in the [upgrade guide](/docs/app/guides/upgrading/version-15)."
  },
  {
    "id": "codemods.mdx#9",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "##### `next-async-request-api`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest next-async-request-api .\n```\n\nThis codemod will transform dynamic APIs (`cookies()`, `headers()` and `draftMode()` from `next/headers`) that are now asynchronous to be properly awaited or wrapped with `React.use()` if applicable.\nWhen an automatic migration isn't possible, the codemod will either add a typecast (if a TypeScript file) or a comment to inform the user that it needs to be manually reviewed & updated.\n\nFor example:\n\n```tsx\nimport { cookies, headers } from 'next/headers'\nconst token = cookies().get('token')\n\nfunction useToken() {\n  const token = cookies().get('token')\n  return token\n}\n\nexport default function Page() {\n  const name = cookies().get('name')\n}\n\nfunction getHeader() {\n  return headers().get('x-foo')\n}"
  },
  {
    "id": "codemods.mdx#10",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "```\n\nTransforms into:\n\n```tsx\nimport { use } from 'react'\nimport {\n  cookies,\n  headers,\n  type UnsafeUnwrappedCookies,\n  type UnsafeUnwrappedHeaders,\n} from 'next/headers'\nconst token = (cookies() as unknown as UnsafeUnwrappedCookies).get('token')\n\nfunction useToken() {\n  const token = use(cookies()).get('token')\n  return token\n}\n\nexport default async function Page() {\n  const name = (await cookies()).get('name')\n}\n\nfunction getHeader() {\n  return (headers() as unknown as UnsafeUnwrappedHeaders).get('x-foo')\n}"
  },
  {
    "id": "codemods.mdx#11",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "```\n\nWhen we detect property access on the `params` or `searchParams` props in the page / route entries (`page.js`, `layout.js`, `route.js`, or `default.js`) or the `generateMetadata` / `generateViewport` APIs,\nit will attempt to transform the callsite from a sync to an async function, and await the property access. If it can't be made async (such as with a Client Component), it will use `React.use` to unwrap the promise .\n\nFor example:\n\n```tsx\n// page.tsx\nexport default function Page({\n  params,\n  searchParams,\n}: {\n  params: { slug: string }\n  searchParams: { [key: string]: string | string[] | undefined }\n}) {\n  const { value } = searchParams\n  if (value === 'foo') {\n    // ...\n  }\n}\n\nexport function generateMetadata({ params }: { params: { slug: string } }) {\n  const { slug } = params\n  return {\n    title: `My Page - ${slug}`,\n  }\n}"
  },
  {
    "id": "codemods.mdx#12",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "```\n\nTransforms into:\n\n```tsx\n// page.tsx\nexport default async function Page(props: {\n  params: Promise<{ slug: string }>\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}) {\n  const searchParams = await props.searchParams\n  const { value } = searchParams\n  if (value === 'foo') {\n    // ...\n  }\n}\n\nexport async function generateMetadata(props: {\n  params: Promise<{ slug: string }>\n}) {\n  const params = await props.params\n  const { slug } = params\n  return {\n    title: `My Page - ${slug}`,\n  }\n}\n```\n\n> **Good to know:** When this codemod identifies a spot that might require manual intervention, but we aren't able to determine the exact fix, it will add a comment or typecast to the code to inform the user that it needs to be manually updated. These comments are prefixed with **@next/codemod**, and typecasts are prefixed with `UnsafeUnwrapped`.\n> Your build will error until these comments are explicitly removed. [Read more](/docs/messages/sync-dynamic-apis)."
  },
  {
    "id": "codemods.mdx#13",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "#### Replace `geo` and `ip` properties of `NextRequest` with `@vercel/functions`\n\n##### `next-request-geo-ip`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest next-request-geo-ip .\n```\n\nThis codemod installs `@vercel/functions` and transforms `geo` and `ip` properties of `NextRequest` with corresponding `@vercel/functions` features.\n\nFor example:\n\n```ts\nimport type { NextRequest } from 'next/server'\n\nexport function GET(req: NextRequest) {\n  const { geo, ip } = req\n}\n```\n\nTransforms into:\n\n```ts\nimport type { NextRequest } from 'next/server'\nimport { geolocation, ipAddress } from '@vercel/functions'\n\nexport function GET(req: NextRequest) {\n  const geo = geolocation(req)\n  const ip = ipAddress(req)\n}\n```"
  },
  {
    "id": "codemods.mdx#14",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "### 14.0\n\n#### Migrate `ImageResponse` imports\n\n##### `next-og-import`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest next-og-import .\n```\n\nThis codemod moves transforms imports from `next/server` to `next/og` for usage of [Dynamic OG Image Generation](/docs/app/getting-started/metadata-and-og-images#generated-open-graph-images).\n\nFor example:\n\n```js\nimport { ImageResponse } from 'next/server'\n```\n\nTransforms into:\n\n```js\nimport { ImageResponse } from 'next/og'\n```\n\n#### Use `viewport` export\n\n##### `metadata-to-viewport-export`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest metadata-to-viewport-export .\n```\n\nThis codemod migrates certain viewport metadata to `viewport` export.\n\nFor example:\n\n```js\nexport const metadata = {\n  title: 'My App',\n  themeColor: 'dark',\n  viewport: {\n    width: 1,\n  },\n}\n```\n\nTransforms into:\n\n```js\nexport const metadata = {\n  title: 'My App',\n}\n\nexport const viewport = {\n  width: 1,\n  themeColor: 'dark',\n}\n```"
  },
  {
    "id": "codemods.mdx#15",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "### 13.2\n\n#### Use Built-in Font\n\n##### `built-in-next-font`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest built-in-next-font .\n```\n\nThis codemod uninstalls the `@next/font` package and transforms `@next/font` imports into the built-in `next/font`.\n\nFor example:\n\n```js\nimport { Inter } from '@next/font/google'\n```\n\nTransforms into:\n\n```js\nimport { Inter } from 'next/font/google'\n```"
  },
  {
    "id": "codemods.mdx#16",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "### 13.0\n\n#### Rename Next Image Imports\n\n##### `next-image-to-legacy-image`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest next-image-to-legacy-image .\n```\n\nSafely renames `next/image` imports in existing Next.js 10, 11, or 12 applications to `next/legacy/image` in Next.js 13. Also renames `next/future/image` to `next/image`.\n\nFor example:\n\n```jsx filename=\"pages/index.js\"\nimport Image1 from 'next/image'\nimport Image2 from 'next/future/image'\n\nexport default function Home() {\n  return (\n    <div>\n      <Image1 src=\"/test.jpg\" width=\"200\" height=\"300\" />\n      <Image2 src=\"/test.png\" width=\"500\" height=\"400\" />\n    </div>\n  )\n}\n```\n\nTransforms into:\n\n```jsx filename=\"pages/index.js\"\n// 'next/image' becomes 'next/legacy/image'\nimport Image1 from 'next/legacy/image'\n// 'next/future/image' becomes 'next/image'\nimport Image2 from 'next/image'\n\nexport default function Home() {\n  return (\n    <div>\n      <Image1 src=\"/test.jpg\" width=\"200\" height=\"300\" />\n      <Image2 src=\"/test.png\" width=\"500\" height=\"400\" />\n    </div>\n  )\n}\n```"
  },
  {
    "id": "codemods.mdx#17",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "#### Migrate to the New Image Component\n\n##### `next-image-experimental`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest next-image-experimental .\n```\n\nDangerously migrates from `next/legacy/image` to the new `next/image` by adding inline styles and removing unused props.\n\n- Removes `layout` prop and adds `style`.\n- Removes `objectFit` prop and adds `style`.\n- Removes `objectPosition` prop and adds `style`.\n- Removes `lazyBoundary` prop.\n- Removes `lazyRoot` prop.\n\n#### Remove `<a>` Tags From Link Components\n\n##### `new-link`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@latest new-link .\n```\n\n<AppOnly>\n\nRemove `<a>` tags inside [Link Components](/docs/app/api-reference/components/link).\n\n</AppOnly>\n\n<PagesOnly>\n\nRemove `<a>` tags inside [Link Components](/docs/pages/api-reference/components/link).\n\n</PagesOnly>\n\nFor example:\n\n```jsx\n<Link href=\"/about\">\n  <a>About</a>\n</Link>\n// transforms into\n<Link href=\"/about\">\n  About\n</Link>\n\n<Link href=\"/about\">\n  <a onClick={() => console.log('clicked')}>About</a>\n</Link>\n// transforms into\n<Link href=\"/about\" onClick={() => console.log('clicked')}>\n  About\n</Link>\n```"
  },
  {
    "id": "codemods.mdx#18",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "### 11\n\n#### Migrate from CRA\n\n##### `cra-to-next`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod cra-to-next\n```\n\nMigrates a Create React App project to Next.js; creating a Pages Router and necessary config to match behavior. Client-side only rendering is leveraged initially to prevent breaking compatibility due to `window` usage during SSR and can be enabled seamlessly to allow the gradual adoption of Next.js specific features.\n\nPlease share any feedback related to this transform [in this discussion](https://github.com/vercel/next.js/discussions/25858)."
  },
  {
    "id": "codemods.mdx#19",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "### 10\n\n#### Add React imports\n\n##### `add-missing-react-import`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod add-missing-react-import\n```\n\nTransforms files that do not import `React` to include the import in order for the new [React JSX transform](https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html) to work.\n\nFor example:\n\n```jsx filename=\"my-component.js\"\nexport default class Home extends React.Component {\n  render() {\n    return <div>Hello World</div>\n  }\n}\n```\n\nTransforms into:\n\n```jsx filename=\"my-component.js\"\nimport React from 'react'\nexport default class Home extends React.Component {\n  render() {\n    return <div>Hello World</div>\n  }\n}\n```"
  },
  {
    "id": "codemods.mdx#20",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "### 9\n\n#### Transform Anonymous Components into Named Components\n\n##### `name-default-component`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod name-default-component\n```\n\n**Versions 9 and above.**\n\nTransforms anonymous components into named components to make sure they work with [Fast Refresh](https://nextjs.org/blog/next-9-4#fast-refresh).\n\nFor example:\n\n```jsx filename=\"my-component.js\"\nexport default function () {\n  return <div>Hello World</div>\n}\n```\n\nTransforms into:\n\n```jsx filename=\"my-component.js\"\nexport default function MyComponent() {\n  return <div>Hello World</div>\n}\n```\n\nThe component will have a camel-cased name based on the name of the file, and it also works with arrow functions."
  },
  {
    "id": "codemods.mdx#21",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "### 8\n\n> **Note**: Built-in AMP support and this codemod have been removed in Next.js 16.\n\n#### Transform AMP HOC into page config\n\n##### `withamp-to-config`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod withamp-to-config\n```\n\nTransforms the `withAmp` HOC into Next.js 9 page configuration.\n\nFor example:\n\n```js\n// Before\nimport { withAmp } from 'next/amp'\n\nfunction Home() {\n  return <h1>My AMP Page</h1>\n}\n\nexport default withAmp(Home)\n```\n\n```js\n// After\nexport default function Home() {\n  return <h1>My AMP Page</h1>\n}\n\nexport const config = {\n  amp: true,\n}\n```"
  },
  {
    "id": "codemods.mdx#22",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "### 6\n\n#### Use `withRouter`\n\n##### `url-to-withrouter`\n\n```bash filename=\"Terminal\"\nnpx @next/codemod url-to-withrouter\n```\n\nTransforms the deprecated automatically injected `url` property on top level pages to using `withRouter` and the `router` property it injects. Read more here: [https://nextjs.org/docs/messages/url-deprecated](/docs/messages/url-deprecated)\n\nFor example:\n\n```js filename=\"From\"\nimport React from 'react'\nexport default class extends React.Component {\n  render() {\n    const { pathname } = this.props.url\n    return <div>Current pathname: {pathname}</div>\n  }\n}\n```\n\n```js filename=\"To\"\nimport React from 'react'\nimport { withRouter } from 'next/router'\nexport default withRouter(\n  class extends React.Component {\n    render() {\n      const { pathname } = this.props.router\n      return <div>Current pathname: {pathname}</div>\n    }\n  }\n)\n```\n\nThis is one case. All the cases that are transformed (and tested) can be found in the [`__testfixtures__` directory](https://github.com/vercel/next.js/tree/canary/packages/next-codemod/transforms/__testfixtures__/url-to-withrouter)."
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Upgrade Guides",
      "description": "Learn how to upgrade to the latest versions of Next.js."
    },
    "content": "---\ntitle: Upgrade Guides\nnav_title: Upgrading\ndescription: Learn how to upgrade to the latest versions of Next.js.\n---\n\nLearn how to upgrade to the latest versions of Next.js following the versions-specific guides:"
  },
  {
    "id": "version-14.mdx#0",
    "metadata": {
      "title": "How to upgrade to version 14",
      "description": "Upgrade your Next.js Application from Version 13 to 14."
    },
    "content": "---\ntitle: How to upgrade to version 14\nnav_title: Version 14\ndescription: Upgrade your Next.js Application from Version 13 to 14.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "version-14.mdx#1",
    "metadata": {
      "title": "How to upgrade to version 14",
      "description": "Upgrade your Next.js Application from Version 13 to 14."
    },
    "content": "## Upgrading from 13 to 14\n\nTo update to Next.js version 14, run the following command using your preferred package manager:\n\n```bash filename=\"Terminal\"\nnpm i next@next-14 react@18 react-dom@18 && npm i eslint-config-next@next-14 -D\n```\n\n```bash filename=\"Terminal\"\nyarn add next@next-14 react@18 react-dom@18 && yarn add eslint-config-next@next-14 -D\n```\n\n```bash filename=\"Terminal\"\npnpm i next@next-14 react@18 react-dom@18 && pnpm i eslint-config-next@next-14 -D\n```\n\n```bash filename=\"Terminal\"\nbun add next@next-14 react@18 react-dom@18 && bun add eslint-config-next@next-14 -D\n```\n\n> **Good to know:** If you are using TypeScript, ensure you also upgrade `@types/react` and `@types/react-dom` to their latest versions."
  },
  {
    "id": "version-14.mdx#2",
    "metadata": {
      "title": "How to upgrade to version 14",
      "description": "Upgrade your Next.js Application from Version 13 to 14."
    },
    "content": "### v14 Summary\n\n- The minimum Node.js version has been bumped from 16.14 to 18.17, since 16.x has reached end-of-life.\n- The `next export` command has been removed in favor of `output: 'export'` config. Please see the [docs](https://nextjs.org/docs/app/guides/static-exports) for more information.\n- The `next/server` import for `ImageResponse` was renamed to `next/og`. A [codemod is available](/docs/app/guides/upgrading/codemods#next-og-import) to safely and automatically rename your imports.\n- The `@next/font` package has been fully removed in favor of the built-in `next/font`. A [codemod is available](/docs/app/guides/upgrading/codemods#built-in-next-font) to safely and automatically rename your imports.\n- The WASM target for `next-swc` has been removed."
  },
  {
    "id": "version-15.mdx#0",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "---\ntitle: How to upgrade to version 15\nnav_title: Version 15\ndescription: Upgrade your Next.js Application from Version 14 to 15.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n## Upgrading from 14 to 15\n\nTo update to Next.js version 15, you can use the `upgrade` codemod:\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@canary upgrade latest\n```\n\nIf you prefer to do it manually, ensure that you're installing the latest Next & React versions:\n\n```bash filename=\"Terminal\"\nnpm i next@latest react@latest react-dom@latest eslint-config-next@latest\n```\n\n> **Good to know:**\n>\n> - If you see a peer dependencies warning, you may need to update `react` and `react-dom` to the suggested versions, or use the `--force` or `--legacy-peer-deps` flag to ignore the warning. This won't be necessary once both Next.js 15 and React 19 are stable."
  },
  {
    "id": "version-15.mdx#1",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "## React 19\n\n- The minimum versions of `react` and `react-dom` is now 19.\n- `useFormState` has been replaced by `useActionState`. The `useFormState` hook is still available in React 19, but it is deprecated and will be removed in a future release. `useActionState` is recommended and includes additional properties like reading the `pending` state directly. [Learn more](https://react.dev/reference/react/useActionState).\n- `useFormStatus` now includes additional keys like `data`, `method`, and `action`. If you are not using React 19, only the `pending` key is available. [Learn more](https://react.dev/reference/react-dom/hooks/useFormStatus).\n- Read more in the [React 19 upgrade guide](https://react.dev/blog/2024/04/25/react-19-upgrade-guide).\n\n> **Good to know:** If you are using TypeScript, ensure you also upgrade `@types/react` and `@types/react-dom` to their latest versions."
  },
  {
    "id": "version-15.mdx#2",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "## Async Request APIs (Breaking change)\n\nPreviously synchronous Dynamic APIs that rely on runtime information are now **asynchronous**:\n\n- [`cookies`](/docs/app/api-reference/functions/cookies)\n- [`headers`](/docs/app/api-reference/functions/headers)\n- [`draftMode`](/docs/app/api-reference/functions/draft-mode)\n- `params` in [`layout.js`](/docs/app/api-reference/file-conventions/layout), [`page.js`](/docs/app/api-reference/file-conventions/page), [`route.js`](/docs/app/api-reference/file-conventions/route), [`default.js`](/docs/app/api-reference/file-conventions/default), [`opengraph-image`](/docs/app/api-reference/file-conventions/metadata/opengraph-image), [`twitter-image`](/docs/app/api-reference/file-conventions/metadata/opengraph-image), [`icon`](/docs/app/api-reference/file-conventions/metadata/app-icons), and [`apple-icon`](/docs/app/api-reference/file-conventions/metadata/app-icons).\n- `searchParams` in [`page.js`](/docs/app/api-reference/file-conventions/page)\n\nTo ease the burden of migration, a [codemod is available](/docs/app/guides/upgrading/codemods#150) to automate the process and the APIs can temporarily be accessed synchronously."
  },
  {
    "id": "version-15.mdx#3",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "### `cookies`\n\n#### Recommended Async Usage\n\n```tsx\nimport { cookies } from 'next/headers'\n\n// Before\nconst cookieStore = cookies()\nconst token = cookieStore.get('token')\n\n// After\nconst cookieStore = await cookies()\nconst token = cookieStore.get('token')\n```\n\n#### Temporary Synchronous Usage\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { cookies, type UnsafeUnwrappedCookies } from 'next/headers'\n\n// Before\nconst cookieStore = cookies()\nconst token = cookieStore.get('token')\n\n// After\nconst cookieStore = cookies() as unknown as UnsafeUnwrappedCookies\n// will log a warning in dev\nconst token = cookieStore.get('token')\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { cookies } from 'next/headers'\n\n// Before\nconst cookieStore = cookies()\nconst token = cookieStore.get('token')\n\n// After\nconst cookieStore = cookies()\n// will log a warning in dev\nconst token = cookieStore.get('token')\n```"
  },
  {
    "id": "version-15.mdx#4",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "### `headers`\n\n#### Recommended Async Usage\n\n```tsx\nimport { headers } from 'next/headers'\n\n// Before\nconst headersList = headers()\nconst userAgent = headersList.get('user-agent')\n\n// After\nconst headersList = await headers()\nconst userAgent = headersList.get('user-agent')\n```\n\n#### Temporary Synchronous Usage\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { headers, type UnsafeUnwrappedHeaders } from 'next/headers'\n\n// Before\nconst headersList = headers()\nconst userAgent = headersList.get('user-agent')\n\n// After\nconst headersList = headers() as unknown as UnsafeUnwrappedHeaders\n// will log a warning in dev\nconst userAgent = headersList.get('user-agent')\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { headers } from 'next/headers'\n\n// Before\nconst headersList = headers()\nconst userAgent = headersList.get('user-agent')\n\n// After\nconst headersList = headers()\n// will log a warning in dev\nconst userAgent = headersList.get('user-agent')\n```"
  },
  {
    "id": "version-15.mdx#5",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "### `draftMode`\n\n#### Recommended Async Usage\n\n```tsx\nimport { draftMode } from 'next/headers'\n\n// Before\nconst { isEnabled } = draftMode()\n\n// After\nconst { isEnabled } = await draftMode()\n```\n\n#### Temporary Synchronous Usage\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { draftMode, type UnsafeUnwrappedDraftMode } from 'next/headers'\n\n// Before\nconst { isEnabled } = draftMode()\n\n// After\n// will log a warning in dev\nconst { isEnabled } = draftMode() as unknown as UnsafeUnwrappedDraftMode\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { draftMode } from 'next/headers'\n\n// Before\nconst { isEnabled } = draftMode()\n\n// After\n// will log a warning in dev\nconst { isEnabled } = draftMode()\n```"
  },
  {
    "id": "version-15.mdx#6",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "### `params` & `searchParams`\n\n#### Asynchronous Layout\n\n```tsx filename=\"app/layout.tsx\" switcher\n// Before\ntype Params = { slug: string }\n\nexport function generateMetadata({ params }: { params: Params }) {\n  const { slug } = params\n}\n\nexport default async function Layout({\n  children,\n  params,\n}: {\n  children: React.ReactNode\n  params: Params\n}) {\n  const { slug } = params\n}\n\n// After\ntype Params = Promise<{ slug: string }>\n\nexport async function generateMetadata({ params }: { params: Params }) {\n  const { slug } = await params\n}\n\nexport default async function Layout({\n  children,\n  params,\n}: {\n  children: React.ReactNode\n  params: Params\n}) {\n  const { slug } = await params\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\n// Before\nexport function generateMetadata({ params }) {\n  const { slug } = params\n}\n\nexport default async function Layout({ children, params }) {\n  const { slug } = params\n}\n\n// After\nexport async function generateMetadata({ params }) {\n  const { slug } = await params\n}\n\nexport default async function Layout({ children, params }) {\n  const { slug } = await params\n}\n```"
  },
  {
    "id": "version-15.mdx#7",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "#### Synchronous Layout\n\n```tsx filename=\"app/layout.tsx\" switcher\n// Before\ntype Params = { slug: string }\n\nexport default function Layout({\n  children,\n  params,\n}: {\n  children: React.ReactNode\n  params: Params\n}) {\n  const { slug } = params\n}\n\n// After\nimport { use } from 'react'\n\ntype Params = Promise<{ slug: string }>\n\nexport default function Layout(props: {\n  children: React.ReactNode\n  params: Params\n}) {\n  const params = use(props.params)\n  const slug = params.slug\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\n// Before\nexport default function Layout({ children, params }) {\n  const { slug } = params\n}\n\n// After\nimport { use } from 'react'\nexport default async function Layout(props) {\n  const params = use(props.params)\n  const slug = params.slug\n}\n\n```"
  },
  {
    "id": "version-15.mdx#8",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "#### Asynchronous Page\n\n```tsx filename=\"app/page.tsx\" switcher\n// Before\ntype Params = { slug: string }\ntype SearchParams = { [key: string]: string | string[] | undefined }\n\nexport function generateMetadata({\n  params,\n  searchParams,\n}: {\n  params: Params\n  searchParams: SearchParams\n}) {\n  const { slug } = params\n  const { query } = searchParams\n}\n\nexport default async function Page({\n  params,\n  searchParams,\n}: {\n  params: Params\n  searchParams: SearchParams\n}) {\n  const { slug } = params\n  const { query } = searchParams\n}\n\n// After\ntype Params = Promise<{ slug: string }>\ntype SearchParams = Promise<{ [key: string]: string | string[] | undefined }>\n\nexport async function generateMetadata(props: {\n  params: Params\n  searchParams: SearchParams\n}) {\n  const params = await props.params\n  const searchParams = await props.searchParams\n  const slug = params.slug\n  const query = searchParams.query\n}\n\nexport default async function Page(props: {\n  params: Params\n  searchParams: SearchParams\n}) {\n  const params = await props.params\n  const searchParams = await props.searchParams\n  const slug = params.slug\n  const query = searchParams.query\n}"
  },
  {
    "id": "version-15.mdx#9",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\n// Before\nexport function generateMetadata({ params, searchParams }) {\n  const { slug } = params\n  const { query } = searchParams\n}\n\nexport default function Page({ params, searchParams }) {\n  const { slug } = params\n  const { query } = searchParams\n}\n\n// After\nexport async function generateMetadata(props) {\n  const params = await props.params\n  const searchParams = await props.searchParams\n  const slug = params.slug\n  const query = searchParams.query\n}\n\nexport async function Page(props) {\n  const params = await props.params\n  const searchParams = await props.searchParams\n  const slug = params.slug\n  const query = searchParams.query\n}\n```"
  },
  {
    "id": "version-15.mdx#10",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "#### Synchronous Page\n\n```tsx\n'use client'\n\n// Before\ntype Params = { slug: string }\ntype SearchParams = { [key: string]: string | string[] | undefined }\n\nexport default function Page({\n  params,\n  searchParams,\n}: {\n  params: Params\n  searchParams: SearchParams\n}) {\n  const { slug } = params\n  const { query } = searchParams\n}\n\n// After\nimport { use } from 'react'\n\ntype Params = Promise<{ slug: string }>\ntype SearchParams = Promise<{ [key: string]: string | string[] | undefined }>\n\nexport default function Page(props: {\n  params: Params\n  searchParams: SearchParams\n}) {\n  const params = use(props.params)\n  const searchParams = use(props.searchParams)\n  const slug = params.slug\n  const query = searchParams.query\n}\n```\n\n```jsx\n// Before\nexport default function Page({ params, searchParams }) {\n  const { slug } = params\n  const { query } = searchParams\n}\n\n// After\nimport { use } from \"react\"\n\nexport default function Page(props) {\n  const params = use(props.params)\n  const searchParams = use(props.searchParams)\n  const slug = params.slug\n  const query = searchParams.query\n}\n\n```"
  },
  {
    "id": "version-15.mdx#11",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "#### Route Handlers\n\n```tsx filename=\"app/api/route.ts\" switcher\n// Before\ntype Params = { slug: string }\n\nexport async function GET(request: Request, segmentData: { params: Params }) {\n  const params = segmentData.params\n  const slug = params.slug\n}\n\n// After\ntype Params = Promise<{ slug: string }>\n\nexport async function GET(request: Request, segmentData: { params: Params }) {\n  const params = await segmentData.params\n  const slug = params.slug\n}\n```\n\n```js filename=\"app/api/route.js\" switcher\n// Before\nexport async function GET(request, segmentData) {\n  const params = segmentData.params\n  const slug = params.slug\n}\n\n// After\nexport async function GET(request, segmentData) {\n  const params = await segmentData.params\n  const slug = params.slug\n}\n```\n\n<AppOnly>"
  },
  {
    "id": "version-15.mdx#12",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "## `runtime` configuration (Breaking change)\n\nThe `runtime` [segment configuration](/docs/app/api-reference/file-conventions/route-segment-config#runtime) previously supported a value of `experimental-edge` in addition to `edge`. Both configurations refer to the same thing, and to simplify the options, we will now error if `experimental-edge` is used. To fix this, update your `runtime` configuration to `edge`. A [codemod](/docs/app/guides/upgrading/codemods#app-dir-runtime-config-experimental-edge) is available to automatically do this.\n\n</AppOnly>"
  },
  {
    "id": "version-15.mdx#13",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "## `fetch` requests\n\n[`fetch` requests](/docs/app/api-reference/functions/fetch) are no longer cached by default.\n\nTo opt specific `fetch` requests into caching, you can pass the `cache: 'force-cache'` option.\n\n```js filename=\"app/layout.js\"\nexport default async function RootLayout() {\n  const a = await fetch('https://...') // Not Cached\n  const b = await fetch('https://...', { cache: 'force-cache' }) // Cached\n\n  // ...\n}\n```\n\nTo opt all `fetch` requests in a layout or page into caching, you can use the `export const fetchCache = 'default-cache'` [segment config option](/docs/app/api-reference/file-conventions/route-segment-config). If individual `fetch` requests specify a `cache` option, that will be used instead.\n\n```js filename=\"app/layout.js\"\n// Since this is the root layout, all fetch requests in the app\n// that don't set their own cache option will be cached.\nexport const fetchCache = 'default-cache'\n\nexport default async function RootLayout() {\n  const a = await fetch('https://...') // Cached\n  const b = await fetch('https://...', { cache: 'no-store' }) // Not cached\n\n  // ...\n}\n```"
  },
  {
    "id": "version-15.mdx#14",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "## Route Handlers\n\n`GET` functions in [Route Handlers](/docs/app/api-reference/file-conventions/route) are no longer cached by default. To opt `GET` methods into caching, you can use a [route config option](/docs/app/api-reference/file-conventions/route-segment-config) such as `export const dynamic = 'force-static'` in your Route Handler file.\n\n```js filename=\"app/api/route.js\"\nexport const dynamic = 'force-static'\n\nexport async function GET() {}\n```"
  },
  {
    "id": "version-15.mdx#15",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "## Client-side Router Cache\n\nWhen navigating between pages via `<Link>` or `useRouter`, [page](/docs/app/api-reference/file-conventions/page) segments are no longer reused from the client-side router cache. However, they are still reused during browser backward and forward navigation and for shared layouts.\n\nTo opt page segments into caching, you can use the [`staleTimes`](/docs/app/api-reference/config/next-config-js/staleTimes) config option:\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    staleTimes: {\n      dynamic: 30,\n      static: 180,\n    },\n  },\n}\n\nmodule.exports = nextConfig\n```\n\n[Layouts](/docs/app/api-reference/file-conventions/layout) and [loading states](/docs/app/api-reference/file-conventions/loading) are still cached and reused on navigation."
  },
  {
    "id": "version-15.mdx#16",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "## `next/font`\n\nThe `@next/font` package has been removed in favor of the built-in [`next/font`](/docs/app/api-reference/components/font). A [codemod is available](/docs/app/guides/upgrading/codemods#built-in-next-font) to safely and automatically rename your imports.\n\n```js filename=\"app/layout.js\"\n// Before\nimport { Inter } from '@next/font/google'\n\n// After\nimport { Inter } from 'next/font/google'\n```\n\n## bundlePagesRouterDependencies\n\n`experimental.bundlePagesExternals` is now stable and renamed to `bundlePagesRouterDependencies`.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  // Before\n  experimental: {\n    bundlePagesExternals: true,\n  },\n\n  // After\n  bundlePagesRouterDependencies: true,\n}\n\nmodule.exports = nextConfig\n```\n\n## serverExternalPackages\n\n`experimental.serverComponentsExternalPackages` is now stable and renamed to `serverExternalPackages`.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  // Before\n  experimental: {\n    serverComponentsExternalPackages: ['package-name'],\n  },\n\n  // After\n  serverExternalPackages: ['package-name'],\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "version-15.mdx#17",
    "metadata": {
      "title": "How to upgrade to version 15",
      "description": "Upgrade your Next.js Application from Version 14 to 15."
    },
    "content": "## Speed Insights\n\nAuto instrumentation for Speed Insights was removed in Next.js 15.\n\nTo continue using Speed Insights, follow the [Vercel Speed Insights Quickstart](https://vercel.com/docs/speed-insights/quickstart) guide.\n\n## `NextRequest` Geolocation\n\nThe `geo` and `ip` properties on `NextRequest` have been removed as these values are provided by your hosting provider. A [codemod](/docs/app/guides/upgrading/codemods#150) is available to automate this migration.\n\nIf you are using Vercel, you can alternatively use the `geolocation` and `ipAddress` functions from [`@vercel/functions`](https://vercel.com/docs/functions/vercel-functions-package) instead:\n\n```ts filename=\"middleware.ts\"\nimport { geolocation } from '@vercel/functions'\nimport type { NextRequest } from 'next/server'\n\nexport function middleware(request: NextRequest) {\n  const { city } = geolocation(request)\n\n  // ...\n}\n```\n\n```ts filename=\"middleware.ts\"\nimport { ipAddress } from '@vercel/functions'\nimport type { NextRequest } from 'next/server'\n\nexport function middleware(request: NextRequest) {\n  const ip = ipAddress(request)\n\n  // ...\n}\n```"
  },
  {
    "id": "version-16.mdx#0",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "---\ntitle: How to upgrade to version 16\nnav_title: Version 16\ndescription: Upgrade your Next.js Application from Version 15 to 16.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "version-16.mdx#1",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Upgrading from 15 to 16"
  },
  {
    "id": "version-16.mdx#2",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### Using AI Agents with Next.js DevTools MCP\n\nIf you're using an AI coding assistant that supports the [Model Context Protocol (MCP)](https://modelcontextprotocol.io), you can use the **Next.js DevTools MCP** to automate the upgrade process and migration tasks.\n\n#### Setup\n\nAdd the following configuration to your MCP client, example:\n\n```json\n{\n  \"mcpServers\": {\n    \"next-devtools\": {\n      \"command\": \"npx\",\n      \"args\": [\"-y\", \"next-devtools-mcp@latest\"]\n    }\n  }\n}\n```\n\nFor more information, visit the [`next-devtools-mcp`](https://www.npmjs.com/package/next-devtools-mcp) package on npm to configure with your MCP client.\n\n> **Note:** Using `next-devtools-mcp@latest` ensures that your MCP client will always use the latest version of the Next.js DevTools MCP server."
  },
  {
    "id": "version-16.mdx#3",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "#### Example Prompts\n\nOnce configured, you can use natural language prompts to upgrade your Next.js app:\n\n**To upgrade to Next.js 16:**\n\nConnect to your coding agent and then prompt:\n\n```txt\nNext Devtools, help me upgrade my Next.js app to version 16\n```\n\n**To migrate to Cache Components (after upgrading to v16):**\n\nConnect to your coding agent and then prompt:\n\n```txt\nNext Devtools, migrate my Next.js app to cache components\n```\n\nLearn more in the documentation [here](/docs/app/guides/mcp)."
  },
  {
    "id": "version-16.mdx#4",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### Using the Codemod\n\nTo update to Next.js version 16, you can use the `upgrade` [codemod](/docs/app/guides/upgrading/codemods#160):\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@canary upgrade latest\n```\n\nThe [codemod](/docs/app/guides/upgrading/codemods#160) is able to:\n\n- Update `next.config.js` to use the new `turbopack` configuration\n- Migrate from `next lint` to the ESLint CLI\n- Migrate from deprecated `middleware` convention to `proxy`\n- Remove `unstable_` prefix from stabilized APIs\n- Remove `experimental_ppr` Route Segment Config from pages and layouts\n\nIf you prefer to do it manually, install the latest Next.js and React versions:\n\n```bash filename=\"Terminal\"\nnpm install next@latest react@latest react-dom@latest\n```\n\nIf you are using TypeScript, ensure you also upgrade `@types/react` and `@types/react-dom` to their latest versions."
  },
  {
    "id": "version-16.mdx#5",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Node.js runtime and browser support\n\n| Requirement   | Change / Details                                                   |\n| ------------- | ------------------------------------------------------------------ |\n| Node.js 20.9+ | Minimum version now `20.9.0` (LTS); Node.js 18 no longer supported |\n| TypeScript 5+ | Minimum version now `5.1.0`                                        |\n| Browsers      | Chrome 111+, Edge 111+, Firefox 111+, Safari 16.4+                 |"
  },
  {
    "id": "version-16.mdx#6",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Turbopack by default\n\nStarting with **Next.js 16**, Turbopack is stable and used by default with `next dev` and `next build`\n\nPreviously you had to enable Turbopack using `--turbopack`, or `--turbo`.\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"next dev --turbopack\",\n    \"build\": \"next build --turbopack\",\n    \"start\": \"next start\"\n  }\n}\n```\n\nThis is no longer necessary. You can update your `package.json` scripts:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\"\n  }\n}"
  },
  {
    "id": "version-16.mdx#7",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "```\n\nIf your project has a [custom `webpack`](/docs/app/api-reference/config/next-config-js/webpack) configuration and you run `next build` (which now uses Turbopack by default), the build will **fail** to prevent misconfiguration issues.\n\nYou have a few different ways to address this:\n\n- **Use Turbopack anyway:** Run with `next build --turbopack` to build using Turbopack and ignore your `webpack` config.\n- **Switch to Turbopack fully:** Migrate your `webpack` config to Turbopack-compatible options.\n- **Keep using Webpack:** Use the `--webpack` flag to opt out of Turbopack and build with Webpack.\n\n> **Good to know**: If you see failing builds because a `webpack` configuration was found, but you don't define one yourself, it is likely that a plugin is adding a `webpack` option"
  },
  {
    "id": "version-16.mdx#8",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### Opting out of Turbopack\n\nIf you need to continue using Webpack, you can opt out with the `--webpack` flag. For example, to use Turbopack in development but Webpack for production builds:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build --webpack\",\n    \"start\": \"next start\"\n  }\n}\n```\n\nWe recommend using Turbopack for development and production. Submit a comment to this [thread](https://github.com/vercel/next.js/discussions/77721), if you are unable to switch to Turbopack."
  },
  {
    "id": "version-16.mdx#9",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### Turbopack configuration location\n\nThe `experimental.turbopack` configuration is out of experimental.\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\n// Next.js 15 - experimental.turbopack\nconst nextConfig: NextConfig = {\n  experimental: {\n    turbopack: {\n      // options\n    },\n  },\n}\n\nexport default nextConfig\n```\n\nYou can use it as a top-level `turbopack` option:\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\n// Next.js 16 - turbopack at the top level of nextConfig\nconst nextConfig: NextConfig = {\n  turbopack: {\n    // options\n  },\n}\n\nexport default nextConfig\n```\n\nMake sure to review the `Turbopack` configuration [options](/docs/app/api-reference/config/next-config-js/turbopack). **Next.js 16** introduces various improvements and new options, for example:\n\n- [Advanced Webpack loader conditions](/docs/app/api-reference/config/next-config-js/turbopack#advanced-webpack-loader-conditions)\n- [debugIds](/docs/app/api-reference/config/next-config-js/turbopack#debug-ids)"
  },
  {
    "id": "version-16.mdx#10",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### Resolve alias fallback\n\nIn some projects, client-side code may import files containing Node.js native modules. This will cause `Module not found: Can't resolve 'fs'` type of errors.\n\nWhen this happens, you should refactor your code so that your client-side bundles do not reference these Node.js native modules.\n\nHowever, in some cases, this might not be possible. In Webpack the `resolve.fallback` option was typically used to **silence** the error. Turbopack offers a similar option, using `turbopack.resolveAlias`. In this case, tell Turbopack to load an empty module when `fs` is requested for the browser.\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  turbopack: {\n    resolveAlias: {\n      fs: {\n        browser: './empty.ts', // We recommend to fix code imports before using this method\n      },\n    },\n  },\n}\n\nexport default nextConfig\n```\n\nIt is preferable to refactor your modules so that client code doesn't ever import from modules using Node.js native modules."
  },
  {
    "id": "version-16.mdx#11",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### Sass node_modules imports\n\nTurbopack fully supports importing Sass files from `node_modules`. Note that while Webpack allowed the legacy tilde (`~`) prefix, Turbopack does not support this syntax.\n\nIn Webpack:\n\n```scss filename=\"styles/globals.scss\"\n@import '~bootstrap/dist/css/bootstrap.min.css';\n```\n\nIn Turbopack:\n\n```scss filename=\"styles/globals.scss\"\n@import 'bootstrap/dist/css/bootstrap.min.css';\n```\n\nIf changing the imports is not possible, you can use `turbopack.resolveAlias`. For example:\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  turbopack: {\n    resolveAlias: {\n      '~*': '*',\n    },\n  },\n}\n\nexport default nextConfig\n```"
  },
  {
    "id": "version-16.mdx#12",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### Turbopack File System Caching (beta)\n\nTurbopack now supports filesystem caching in development, storing compiler artifacts on disk between runs for significantly faster compile times across restarts.\n\nEnable filesystem caching in your configuration:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    turbopackFileSystemCacheForDev: true,\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    turbopackFileSystemCacheForDev: true,\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "version-16.mdx#13",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Async Request APIs (Breaking change)\n\nVersion 15 introduced [Async Request APIs](https://nextjs.org/docs/app/guides/upgrading/version-15#async-request-apis-breaking-change) as a breaking change, with **temporary** synchronous compatibility.\n\nStarting with **Next.js 16**, synchronous access is fully removed. These APIs can only be accessed asynchronously."
  },
  {
    "id": "version-16.mdx#14",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "Starting with **Next.js 16**, synchronous access is fully removed. These APIs can only be accessed asynchronously.\n\n- [`cookies`](/docs/app/api-reference/functions/cookies)\n- [`headers`](/docs/app/api-reference/functions/headers)\n- [`draftMode`](/docs/app/api-reference/functions/draft-mode)\n- `params` in [`layout.js`](/docs/app/api-reference/file-conventions/layout), [`page.js`](/docs/app/api-reference/file-conventions/page), [`route.js`](/docs/app/api-reference/file-conventions/route), [`default.js`](/docs/app/api-reference/file-conventions/default), [`opengraph-image`](/docs/app/api-reference/file-conventions/metadata/opengraph-image#opengraph-image), [`twitter-image`](/docs/app/api-reference/file-conventions/metadata/opengraph-image#twitter-image), [`icon`](/docs/app/api-reference/file-conventions/metadata/app-icons#icon), and [`apple-icon`](/docs/app/api-reference/file-conventions/metadata/app-icons#apple-icon).\n- `searchParams` in [`page.js`](/docs/app/api-reference/file-conventions/page)\n\nUse the [codemod](/docs/app/guides/upgrading/codemods#migrate-to-async-dynamic-apis) to migrate to async Dynamic APIs."
  },
  {
    "id": "version-16.mdx#15",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### Migrating types for async Dynamic APIs\n\nTo help migrate to async `params` and `searchParams`, you can run [`npx next typegen`](/docs/app/api-reference/cli/next#next-typegen-options) to automatically generate these globally available types helpers:\n\n- [`PageProps`](/docs/app/api-reference/file-conventions/page#page-props-helper)\n- [`LayoutProps`](/docs/app/api-reference/file-conventions/layout#layout-props-helper)\n- [`RouteContext`](/docs/app/api-reference/file-conventions/route#route-context-helper)\n\n> **Good to know**: `typegen` was introduced in Next.js 15.5\n\nThis simplifies type-safe migration to the new async API pattern, and enables you to update your components with full type safety, for example:\n\n```tsx filename=\"/app/blog/[slug]/page.tsx\"\nexport default async function Page(props: PageProps<'/blog/[slug]'>) {\n  const { slug } = await props.params\n  const query = await props.searchParams\n  return <h1>Blog Post: {slug}</h1>\n}\n```\n\nThis approach gives you fully type-safe access to `props.params`, including the `slug`, and to `searchParams`, directly within your page."
  },
  {
    "id": "version-16.mdx#16",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Async parameters for icon, and open-graph Image (Breaking change)\n\n> The props passed to the image generating functions in `opengraph-image`, `twitter-image`, `icon`, and `apple-icon`, are now Promises.\n\nIn previous versions, both the `Image` (image generation function), and the `generateImageMetadata` received a `params` object. The `id` returned by `generateImageMetadata` was passed as a string to the image generation function.\n\n```js filename=\"app/shop/[slug]/opengraph-image.js\"\n// Next.js 15 - synchronous params access\nexport function generateImageMetadata({ params }) {\n  const { slug } = params\n  return [{ id: '1' }, { id: '2' }]\n}\n\n// Next.js 15 - synchronous params and id access\nexport default function Image({ params, id }) {\n  const slug = params.slug\n  const imageId = id // string\n  // ...\n}"
  },
  {
    "id": "version-16.mdx#17",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "```\n\nStarting with **Next.js 16**, to align with the [Async Request APIs](#async-request-apis-breaking-change) change, the image generating function now receives `params` and `id` as promises. The `generateImageMetadata` function continues to receive synchronous `params`.\n\n```js filename=\"app/shop/[slug]/opengraph-image.js\"\nexport async function generateImageMetadata({ params }) {\n  const { slug } = params\n  return [{ id: '1' }, { id: '2' }]\n}\n\n// Next.js 16 - asynchronous params and id access\nexport default async function Image({ params, id }) {\n  const { slug } = await params // params now async\n  const imageId = await id // id is now Promise<string> when using generateImageMetadata\n  // ...\n}\n```"
  },
  {
    "id": "version-16.mdx#18",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Async `id` parameter for `sitemap` (Breaking change)\n\nPreviously, the `id` values returned from [`generateSitemaps`](/docs/app/api-reference/functions/generate-sitemaps) were passed directly to the `sitemap` generating function.\n\n```js filename=\"app/product/sitemap.js\"\nexport async function generateSitemaps() {\n  return [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]\n}\n\n// Next.js 15 - synchronous id access\nexport default async function sitemap({ id }) {\n  const start = id * 50000 // id is a number\n  // ...\n}\n```\n\nStarting with **Next.js 16**, the `sitemap` generating function now receives `id` as a promise.\n\n```js filename=\"app/product/sitemap.js\"\nexport async function generateSitemaps() {\n  return [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]\n}\n\n// Next.js 16 - asynchronous id access\nexport default async function sitemap({ id }) {\n  const resolvedId = await id // id is now Promise<number>\n  const start = resolvedId * 50000\n  // ...\n}\n```"
  },
  {
    "id": "version-16.mdx#19",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## React 19.2\n\nThe App Router in **Next.js 16** uses the latest React [Canary release](https://react.dev/blog/2023/05/03/react-canaries), which includes the newly released React 19.2 features and other features being incrementally stabilized. Highlights include:\n\n- **[View Transitions](https://react.dev/reference/react/ViewTransition)**: Animate elements that update inside a Transition or navigation\n- **[`useEffectEvent`](https://react.dev/reference/react/useEffectEvent)**: Extract non-reactive logic from Effects into reusable Effect Event functions\n- **[Activity](https://react.dev/reference/react/Activity)**: Render \"background activity\" by hiding UI with `display: none` while maintaining state and cleaning up Effects\n\nLearn more in the [React 19.2 announcement](https://react.dev/blog/2025/10/01/react-19-2)."
  },
  {
    "id": "version-16.mdx#20",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## React Compiler Support\n\nBuilt-in support for the React Compiler is now stable in **Next.js 16** following the React Compiler's 1.0 release. The React Compiler automatically memoizes components, reducing unnecessary re-renders with zero manual code changes.\n\nThe `reactCompiler` configuration option has been promoted from `experimental` to stable. It is not enabled by default as we continue gathering build performance data across different application types.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  reactCompiler: true,\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  reactCompiler: true,\n}\n\nmodule.exports = nextConfig\n```\n\nInstall the latest version of the React Compiler plugin:\n\n```bash filename=\"Terminal\"\nnpm install -D babel-plugin-react-compiler\n```\n\n> **Good to know:** Expect compile times in development and during builds to be higher when enabling this option as the React Compiler relies on Babel."
  },
  {
    "id": "version-16.mdx#21",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Caching APIs\n\n### revalidateTag\n\n[`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) has a new function signature. You can pass a [`cacheLife`](/docs/app/api-reference/functions/cacheLife#reference) profile as the second argument.\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { revalidateTag } from 'next/cache'\n\nexport async function updateArticle(articleId: string) {\n  // Mark article data as stale - article readers see stale data while it revalidates\n  revalidateTag(`article-${articleId}`, 'max')\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { revalidateTag } from 'next/cache'\n\nexport async function updateArticle(articleId) {\n  // Mark article data as stale - article readers see stale data while it revalidates\n  revalidateTag(`article-${articleId}`, 'max')\n}\n```\n\nUse `revalidateTag` for content where a slight delay in updates is acceptable, such as blog posts, product catalogs, or documentation. Users receive stale content while fresh data loads in the background."
  },
  {
    "id": "version-16.mdx#22",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### updateTag\n\n[`updateTag`](/docs/app/api-reference/functions/updateTag) is a new [Server Actions](/docs/app/getting-started/updating-data#what-are-server-functions)-only API that provides **read-your-writes** semantics, where a user makes a change and the UI immediately shows the change, rather than stale data.\n\nIt does this by expiring and immediately refreshing data within the same request.\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { updateTag } from 'next/cache'\n\nexport async function updateUserProfile(userId: string, profile: Profile) {\n  await db.users.update(userId, profile)\n\n  // Expire cache and refresh immediately - user sees their changes right away\n  updateTag(`user-${userId}`)\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { updateTag } from 'next/cache'\n\nexport async function updateUserProfile(userId, profile) {\n  await db.users.update(userId, profile)\n\n  // Expire cache and refresh immediately - user sees their changes right away\n  updateTag(`user-${userId}`)\n}"
  },
  {
    "id": "version-16.mdx#23",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "```\n\nThis ensures interactive features reflect changes immediately. Perfect for forms, user settings, and any workflow where users expect to see their updates instantly.\n\nLearn more about when to use `updateTag` or `revalidateTag` [here](/docs/app/api-reference/functions/updateTag#when-to-use-updatetag)."
  },
  {
    "id": "version-16.mdx#24",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### refresh\n\n[`refresh`](/docs/app/api-reference/functions/refresh) allows you to refresh the client router from within a Server Action.\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { refresh } from 'next/cache'\n\nexport async function markNotificationAsRead(notificationId: string) {\n  // Update the notification in the database\n  await db.notifications.markAsRead(notificationId)\n\n  // Refresh the notification count displayed in the header\n  refresh()\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { refresh } from 'next/cache'\n\nexport async function markNotificationAsRead(notificationId) {\n  // Update the notification in the database\n  await db.notifications.markAsRead(notificationId)\n\n  // Refresh the notification count displayed in the header\n  refresh()\n}\n```\n\nUse it when you need to refresh the client router after performing an action."
  },
  {
    "id": "version-16.mdx#25",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### cacheLife and cacheTag\n\n[`cacheLife`](/docs/app/api-reference/functions/cacheLife) and [`cacheTag`](/docs/app/api-reference/functions/cacheTag) are now stable. The `unstable_` prefix is no longer needed.\n\nWherever you had aliased imports like:\n\n```ts\nimport {\n  unstable_cacheLife as cacheLife,\n  unstable_cacheTag as cacheTag,\n} from 'next/cache'\n```\n\nYou can update your imports to:\n\n```ts\nimport { cacheLife, cacheTag } from 'next/cache'\n```"
  },
  {
    "id": "version-16.mdx#26",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Enhanced Routing and Navigation\n\n**Next.js 16** includes a complete overhaul of the routing and navigation system, making page transitions leaner and faster. This optimizes how Next.js prefetches and caches navigation data:\n\n- **Layout deduplication**: When prefetching multiple URLs with a shared layout, the layout is downloaded once.\n- **Incremental prefetching**: Next.js only prefetches parts not already in cache, rather than entire pages.\n\nThese changes require **no code modifications** and are designed to improve performance across all apps.\n\nHowever, you may see more individual prefetch requests with much lower total transfer sizes. We believe this is the right trade-off for nearly all applications.\n\nIf the increased request count causes issues, please let us know by creating an [issue](https://github.com/vercel/next.js/issues) or [discussion](https://github.com/vercel/next.js/discussions) item."
  },
  {
    "id": "version-16.mdx#27",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Partial Pre-Rendering (PPR)\n\n**Next.js 16** removes the experimental **Partial Pre-Rendering (PPR)** flag and configuration options, including the route level segment `experimental_ppr`.\n\nStarting with **Next.js 16**, you can opt into PPR using the [`cacheComponents`](/docs/app/api-reference/config/next-config-js/cacheComponents) configuration.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  cacheComponents: true,\n}\n\nmodule.exports = nextConfig\n```\n\nPPR in **Next.js 16** works differently than in **Next.js 15** canaries. If you are using PPR today, stay in the current Next.js 15 canary you are using. We will follow up with a guide to migrate to Cache Components.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  // If you are using PPR today\n  // stay in the current Next.js 15 canary\n  experimental: {\n    ppr: true,\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "version-16.mdx#28",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## `middleware` to `proxy`\n\nThe `middleware` filename is deprecated, and has been renamed to `proxy` to clarify network boundary and routing focus.\n\nThe `edge` runtime is **NOT** supported in `proxy`. The `proxy` runtime is `nodejs`, and it cannot be configured. If you want to continue using the `edge` runtime, keep using `middleware`. We will follow up on a minor release with further `edge` runtime instructions.\n\n```bash filename=\"Terminal\"\n# Rename your middleware file\nmv middleware.ts proxy.ts\n# or\nmv middleware.js proxy.js\n```\n\nThe named export `middleware` is also deprecated. Rename your function to `proxy`.\n\n```ts filename=\"proxy.ts\" switcher\nexport function proxy(request: Request) {}\n```\n\n```js filename=\"proxy.js\" switcher\nexport function proxy(request) {}\n```\n\nWe recommend changing the function name to `proxy`, even if you are using a default export.\n\nConfiguration flags that contained the `middleware` name are also renamed. For example, `skipMiddlewareUrlNormalize` is now `skipProxyUrlNormalize`\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  skipProxyUrlNormalize: true,\n}\n\nexport default nextConfig"
  },
  {
    "id": "version-16.mdx#29",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  skipProxyUrlNormalize: true,\n}\n\nmodule.exports = nextConfig\n```\n\nThe version 16 [codemod](/docs/app/guides/upgrading/codemods#160) is able to update these flags too."
  },
  {
    "id": "version-16.mdx#30",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## `next/image` changes\n\n### Local Images with Query Strings (Breaking change)\n\nLocal image sources with query strings now require `images.localPatterns.search` configuration to prevent enumeration attacks.\n\n```tsx filename=\"app/page.tsx\"\nimport Image from 'next/image'\n\nexport default function Page() {\n  return <Image src=\"/assets/photo?v=1\" alt=\"Photo\" width=\"100\" height=\"100\" />\n}\n```\n\nIf you need to use query strings with local images, add the pattern to your configuration:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  images: {\n    localPatterns: [\n      {\n        pathname: '/assets/**',\n        search: '?v=1',\n      },\n    ],\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  images: {\n    localPatterns: [\n      {\n        pathname: '/assets/**',\n        search: '?v=1',\n      },\n    ],\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "version-16.mdx#31",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### `minimumCacheTTL` Default (Breaking change)\n\nThe default value for `images.minimumCacheTTL` has changed from `60 seconds` to `4 hours` (14400 seconds). This reduces revalidation cost for images without cache-control headers.\n\nFor some Next.js users, image revalidation was happening frequently, often because the upstream source images missed a `cache-control` header. This caused revalidation to happen every `60` seconds, which increased CPU usage and cost.\n\nSince most images do not change often, this short interval is not ideal. Setting the default to 4 hours offers a more durable cache by default, while still allowing images to update a few times per day if needed.\n\nIf you need the previous behavior, change `minimumCacheTTL` to a lower value, for example back to `60` seconds:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  images: {\n    minimumCacheTTL: 60,\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  images: {\n    minimumCacheTTL: 60,\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "version-16.mdx#32",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### `imageSizes` Default (Breaking change)\n\nThe value `16` has been removed from the default `images.imageSizes` array.\n\nWe have looked at request analytics and found out that very few projects ever serve 16 pixels width images. Removing this setting reduces the size of the `srcset` attribute shipped to the browser by `next/image`.\n\nIf you need to support 16px images:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  images: {\n    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  images: {\n    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],\n  },\n}\n\nmodule.exports = nextConfig\n```\n\nRather than lack of developer usage, we believe 16 pixels width images have become less common, because `devicePixelRatio: 2` actually fetches a 32px image to prevent blurriness in retina displays."
  },
  {
    "id": "version-16.mdx#33",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### `qualities` Default (Breaking change)\n\nThe default value for `images.qualities` has changed from allowing all qualities to only `[75]`.\n\nIf you need to support multiple quality levels:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  images: {\n    qualities: [50, 75, 100],\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  images: {\n    qualities: [50, 75, 100],\n  },\n}\n\nmodule.exports = nextConfig\n```\n\nIf you specify a `quality` prop not included in the `image.qualities` array, the quality will be coerced to the closest value in `images.qualities`. For example, given the configuration above, a `quality` prop of 80, is coerced to 75."
  },
  {
    "id": "version-16.mdx#34",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### Local IP Restriction (Breaking change)\n\nA new security restriction blocks local IP optimization by default. Set `images.dangerouslyAllowLocalIP` to `true` only for private networks.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  images: {\n    dangerouslyAllowLocalIP: true, // Only for private networks\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  images: {\n    dangerouslyAllowLocalIP: true, // Only for private networks\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "version-16.mdx#35",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### Maximum Redirects (Breaking change)\n\nThe default for `images.maximumRedirects` has changed from unlimited to 3 redirects maximum.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  images: {\n    maximumRedirects: 0, // Disable redirects\n    // or\n    maximumRedirects: 5, // Increase for edge cases\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  images: {\n    maximumRedirects: 0, // Disable redirects\n    // or\n    maximumRedirects: 5, // Increase for edge cases\n  },\n}\n\nmodule.exports = nextConfig\n```\n\n### `next/legacy/image` Component (deprecated)\n\nThe `next/legacy/image` component is deprecated. Use `next/image` instead:\n\n```tsx\n// Before\nimport Image from 'next/legacy/image'\n\n// After\nimport Image from 'next/image'\n```"
  },
  {
    "id": "version-16.mdx#36",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### `images.domains` Configuration (deprecated)\n\nThe `images.domains` config is deprecated.\n\n```js filename=\"next.config.js\"\n// image.domains is deprecated\nmodule.exports = {\n  images: {\n    domains: ['example.com'],\n  },\n}\n```\n\nUse `images.remotePatterns` instead for improved security:\n\n```js filename=\"next.config.js\"\n// Use image.remotePatterns instead\nmodule.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 'example.com',\n      },\n    ],\n  },\n}\n```"
  },
  {
    "id": "version-16.mdx#37",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Concurrent `dev` and `build`\n\n`next dev` and `next build` now use separate output directories, enabling concurrent execution. The `next dev` command outputs to `.next/dev`. This is the new default behavior, controlled by [isolatedDevBuild](/docs/app/api-reference/config/next-config-js/isolatedDevBuild).\n\nAdditionally, a lockfile mechanism prevents multiple `next dev` or `next build` instances on the same project.\n\nSince the development server outputs to `.next/dev`, the [Turbopack tracing command](/docs/app/guides/local-development#turbopack-tracing) should be:\n\n```bash\nnpx next internal trace .next/dev/trace-turbopack\n```"
  },
  {
    "id": "version-16.mdx#38",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Parallel Routes `default.js` requirement\n\nAll [parallel route](/docs/app/api-reference/file-conventions/parallel-routes) slots now require explicit `default.js` files. Builds will fail without them.\n\nTo maintain previous behavior, create a [`default.js`](/docs/app/api-reference/file-conventions/default) file that calls `notFound()` or returns `null`.\n\n```tsx filename=\"app/@modal/default.tsx\"\nimport { notFound } from 'next/navigation'\n\nexport default function Default() {\n  notFound()\n}\n```\n\nOr return `null`:\n\n```tsx filename=\"app/@modal/default.tsx\"\nexport default function Default() {\n  return null\n}\n```\n\n## ESLint Flat Config\n\n`@next/eslint-plugin-next` now defaults to ESLint Flat Config format, aligning with ESLint v10 which will drop legacy config support.\n\nMake sure to review our API reference for the [`@next/eslint-plugin-next`](/docs/app/api-reference/config/eslint#setup-eslint) plugin.\n\nIf you're using the legacy `.eslintrc` format, consider migrating to the flat config format. See the [ESLint migration guide](https://eslint.org/docs/latest/use/configure/migration-guide) for details."
  },
  {
    "id": "version-16.mdx#39",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Scroll Behavior Override\n\nIn **previous versions of Next.js**, if you had set `scroll-behavior: smooth` globally on your `<html>` element via CSS, Next.js would override this during SPA route transitions, as follows:\n\n1. Temporarily set `scroll-behavior` to `auto`\n2. Perform the navigation (causing instant scroll to top)\n3. Restore your original `scroll-behavior` value\n\nThis ensured that page navigation always felt snappy and instant, even when you had smooth scrolling enabled for in-page navigation. However, this manipulation could be expensive, especially at the start of every navigation.\n\nIn **Next.js 16**, this behavior has changed. By default, Next.js will **no longer override** your `scroll-behavior` setting during navigation.\n\n**If you want Next.js to perform this override** (the previous default behavior), add the `data-scroll-behavior=\"smooth\"` attribute to your `<html>` element:\n\n```tsx filename=\"app/layout.tsx\"\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\" data-scroll-behavior=\"smooth\">\n      <body>{children}</body>\n    </html>\n  )\n}\n```"
  },
  {
    "id": "version-16.mdx#40",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Performance Improvements\n\nSignificant performance optimizations for `next dev` and `next start` commands, along with improved terminal output with clearer formatting, better error messages, and improved performance metrics.\n\n**Next.js 16** removes the `size` and `First Load JS` metrics from the `next build` output. We found these to be inaccurate in server-driven architectures using React Server Components. Both our Turbopack and Webpack implementations had issues, and disagreed on how to account for Client Components payload.\n\nThe most effective way to measure actual route performance is through tools such as [Chrome Lighthouse](https://developer.chrome.com/docs/lighthouse/overview) or Vercel Analytics, which focus on Core Web Vitals and downloaded resource sizes."
  },
  {
    "id": "version-16.mdx#41",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### `next dev` config load\n\nIn previous versions the Next config file was loaded twice during development:\n\n- When running the `next dev` command\n- When the `next dev` command started the Next.js server\n\nThis was inefficient because the `next dev` command doesn't need the config file to start the Next.js server.\n\nA consequence of this change is that, when running `next dev` checking if `process.argv` includes `'dev'`, in your Next.js config file, will return `false`.\n\n> **Good to know**: The `typegen`, and `build` commands, are still visible in `process.argv`.\n\nThis is specially important for plugins that trigger side-effects on `next dev`. If that's the case, it might be enough to check if `NODE_ENV` is set to `development`.\n\n```js filename=\"next.config.js\"\nimport { startServer } from 'docs-lib/dev-server'\n\nconst isDev = process.env.NODE_ENV === 'development'\n\nif (isDev) {\n  startServer()\n}\n\nconst nextConfig = {\n  /* Your config options */\n}\n\nmodule.exports = nextConfig\n```\n\nAlternatively, use the [`phase`](/docs/app/api-reference/config/next-config-js#phase) in which the configuration is loaded."
  },
  {
    "id": "version-16.mdx#42",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Build Adapters API (alpha)\n\nFollowing the [Build Adapters RFC](https://github.com/vercel/next.js/discussions/77740), the first alpha version of the Build Adapters API is now available.\n\nBuild Adapters allow you to create custom adapters that hook into the build process, enabling deployment platforms and custom build integrations to modify Next.js configuration or process build output.\n\n```js filename=\"next.config.js\"\nconst nextConfig = {\n  experimental: {\n    adapterPath: require.resolve('./my-adapter.js'),\n  },\n}\n\nmodule.exports = nextConfig\n```\n\nShare your feedback in the [RFC discussion](https://github.com/vercel/next.js/discussions/77740).\n\n## Modern Sass API\n\n`sass-loader` has been bumped to v16, which supports [modern Sass syntax](https://sass-lang.com/documentation/js-api/#md:usage) and new features."
  },
  {
    "id": "version-16.mdx#43",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "## Removals\n\nThese features were previously deprecated and are now removed:\n\n### AMP Support\n\nAMP adoption has declined significantly, and maintaining this feature adds complexity to the framework. All AMP APIs and configurations have been removed:\n\n- `amp` configuration from your Next config file\n- `next/amp` hook imports and usage (`useAmp`)\n\n```tsx\n// Removed\nimport { useAmp } from 'next/amp'\n\n// Removed\nexport const config = { amp: true }\n```\n\n- `export const config = { amp: true }` from pages\n\n```js filename=\"next.config.js\"\nconst nextConfig = {\n  // Removed\n  amp: {\n    canonicalBase: 'https://example.com',\n  },\n}\n\nexport default nextConfig\n```\n\nEvaluate if AMP is still necessary for your use case. Most performance benefits can now be achieved through Next.js's built-in optimizations and modern web standards."
  },
  {
    "id": "version-16.mdx#44",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### `next lint` Command\n\nThe `next lint` command has been removed. Use Biome or ESLint directly. `next build` no longer runs linting.\n\nA codemod is available to automate migration:\n\n```bash filename=\"Terminal\"\nnpx @next/codemod@canary next-lint-to-eslint-cli .\n```\n\nThe `eslint` option in the Next.js config file is also removed.\n\n```js filename=\"next.config.mjs\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  // No longer supported\n  // eslint: {},\n}\n\nexport default nextConfig\n```"
  },
  {
    "id": "version-16.mdx#45",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### Runtime Configuration\n\n`serverRuntimeConfig` and `publicRuntimeConfig` have been removed. Use environment variables instead.\n\n**Before (Next.js 15):**\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  serverRuntimeConfig: {\n    dbUrl: process.env.DATABASE_URL,\n  },\n  publicRuntimeConfig: {\n    apiUrl: '/api',\n  },\n}\n```\n\n```tsx filename=\"pages/index.tsx\"\nimport getConfig from 'next/config'\n\nexport default function Page() {\n  const { publicRuntimeConfig } = getConfig()\n  return <p>API URL: {publicRuntimeConfig.apiUrl}</p>\n}\n```\n\n**After (Next.js 16):**\n\nFor server-only values, access environment variables directly in Server Components:\n\n```tsx filename=\"app/page.tsx\"\nasync function fetchData() {\n  const dbUrl = process.env.DATABASE_URL\n  // Use for server-side operations only\n  return await db.query(dbUrl, 'SELECT * FROM users')\n}\n\nexport default async function Page() {\n  const data = await fetchData()\n  return <div>{/* render data */}</div>\n}"
  },
  {
    "id": "version-16.mdx#46",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "```\n\n> **Good to know**: Use the [taint API](/docs/app/api-reference/config/next-config-js/taint) to prevent accidentally passing sensitive server values to Client Components.\n\nFor client-accessible values, use the `NEXT_PUBLIC_` prefix:\n\n```bash filename=\".env.local\"\nNEXT_PUBLIC_API_URL=\"/api\"\n```\n\n```tsx filename=\"app/components/client-component.tsx\"\n'use client'\n\nexport default function ClientComponent() {\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL\n  return <p>API URL: {apiUrl}</p>\n}\n```\n\nTo ensure environment variables are read at runtime (not bundled at build time), use the [`connection()`](/docs/app/api-reference/functions/connection) function before reading from `process.env`:\n\n```tsx filename=\"app/page.tsx\"\nimport { connection } from 'next/server'\n\nexport default async function Page() {\n  await connection()\n  const config = process.env.RUNTIME_CONFIG\n  return <p>{config}</p>\n}\n```\n\nLearn more about [environment variables](/docs/app/guides/environment-variables)."
  },
  {
    "id": "version-16.mdx#47",
    "metadata": {
      "title": "How to upgrade to version 16",
      "description": "Upgrade your Next.js Application from Version 15 to 16."
    },
    "content": "### `devIndicators` Options\n\nThe following options have been removed from [`devIndicators`](/docs/app/api-reference/config/next-config-js/devIndicators):\n\n- `appIsrStatus`\n- `buildActivity`\n- `buildActivityPosition`\n\nThe indicator itself remains available.\n\n### `experimental.dynamicIO`\n\nThe `experimental.dynamicIO` flag has been renamed to `cacheComponents`:\n\nUpdate your Next config file, by removing the `dynamicIO` flag.\n\n```js filename=\"next.config.js\"\n// Next.js 15 - experimental.dynamicIO is now removed\nmodule.exports = {\n  experimental: {\n    dynamicIO: true,\n  },\n}\n```\n\nAdd the [`cacheComponents`](/docs/app/api-reference/config/next-config-js/cacheComponents) flag set to true.\n\n```js filename=\"next.config.js\"\n// Next.js 16 - use cacheComponents instead\nmodule.exports = {\n  cacheComponents: true,\n}\n```\n\n### `unstable_rootParams`\n\nThe `unstable_rootParams` function has been removed. We are working on an alternative API that we will ship in an upcoming minor release."
  },
  {
    "id": "videos.mdx#0",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "---\ntitle: How to use and optimize videos\nnav_title: Videos\ndescription: Recommendations and best practices for optimizing videos in your Next.js application.\n---\n\nThis page outlines how to use videos with Next.js applications, showing how to store and display video files without affecting performance."
  },
  {
    "id": "videos.mdx#1",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "## Using `<video>` and `<iframe>`\n\nVideos can be embedded on the page using the HTML **`<video>`** tag for direct video files and **`<iframe>`** for external platform-hosted videos.\n\n### `<video>`\n\nThe HTML [`<video>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video) tag can embed self-hosted or directly served video content, allowing full control over the playback and appearance.\n\n```jsx filename=\"app/ui/video.jsx\"\nexport function Video() {\n  return (\n    <video width=\"320\" height=\"240\" controls preload=\"none\">\n      <source src=\"/path/to/video.mp4\" type=\"video/mp4\" />\n      <track\n        src=\"/path/to/captions.vtt\"\n        kind=\"subtitles\"\n        srcLang=\"en\"\n        label=\"English\"\n      />\n      Your browser does not support the video tag.\n    </video>\n  )\n}\n```"
  },
  {
    "id": "videos.mdx#2",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "### Common `<video>` tag attributes"
  },
  {
    "id": "videos.mdx#3",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "| Attribute     | Description                                                                                               | Example Value                        |\n| ------------- | --------------------------------------------------------------------------------------------------------- | ------------------------------------ |\n| `src`         | Specifies the source of the video file.                                                                   | `<video src=\"/path/to/video.mp4\" />` |\n| `width`       | Sets the width of the video player.                                                                       | `<video width=\"320\" />`              |\n| `height`      | Sets the height of the video player.                                                                      | `<video height=\"240\" />`             |\n| `controls`    | If present, it displays the default set of playback controls.                                             | `<video controls />`                 |\n| `autoPlay`    | Automatically starts playing the video when the page loads. Note: Autoplay policies vary across browsers. | `<video autoPlay />`                 |"
  },
  {
    "id": "videos.mdx#4",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "| `autoPlay`    | Automatically starts playing the video when the page loads. Note: Autoplay policies vary across browsers. | `<video autoPlay />`                 |\n| `loop`        | Loops the video playback.                                                                                 | `<video loop />`                     |\n| `muted`       | Mutes the audio by default. Often used with `autoPlay`.                                                   | `<video muted />`                    |\n| `preload`     | Specifies how the video is preloaded. Values: `none`, `metadata`, `auto`.                                 | `<video preload=\"none\" />`           |\n| `playsInline` | Enables inline playback on iOS devices, often necessary for autoplay to work on iOS Safari.               | `<video playsInline />`              |"
  },
  {
    "id": "videos.mdx#5",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "> **Good to know**: When using the `autoPlay` attribute, it is important to also include the `muted` attribute to ensure the video plays automatically in most browsers and the `playsInline` attribute for compatibility with iOS devices.\n\nFor a comprehensive list of video attributes, refer to the [MDN documentation](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video#attributes)."
  },
  {
    "id": "videos.mdx#6",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "### Video best practices\n\n- **Fallback Content:** When using the `<video>` tag, include fallback content inside the tag for browsers that do not support video playback.\n- **Subtitles or Captions:** Include subtitles or captions for users who are deaf or hard of hearing. Utilize the [`<track>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/track) tag with your `<video>` elements to specify caption file sources.\n- **Accessible Controls:** Standard HTML5 video controls are recommended for keyboard navigation and screen reader compatibility. For advanced needs, consider third-party players like [react-player](https://github.com/cookpete/react-player) or [video.js](https://videojs.com/), which offer accessible controls and consistent browser experience.\n\n### `<iframe>`\n\nThe HTML `<iframe>` tag allows you to embed videos from external platforms like YouTube or Vimeo.\n\n```jsx filename=\"app/page.jsx\"\nexport default function Page() {\n  return (\n    <iframe src=\"https://www.youtube.com/embed/19g66ezsKAg\" allowFullScreen />\n  )\n}\n```"
  },
  {
    "id": "videos.mdx#7",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "### Common `<iframe>` tag attributes"
  },
  {
    "id": "videos.mdx#8",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "| Attribute         | Description                                                            | Example Value                          |\n| ----------------- | ---------------------------------------------------------------------- | -------------------------------------- |\n| `src`             | The URL of the page to embed.                                          | `<iframe src=\"https://example.com\" />` |\n| `width`           | Sets the width of the iframe.                                          | `<iframe width=\"500\" />`               |\n| `height`          | Sets the height of the iframe.                                         | `<iframe height=\"300\" />`              |\n| `allowFullScreen` | Allows the iframe content to be displayed in full-screen mode.         | `<iframe allowFullScreen />`           |\n| `sandbox`         | Enables an extra set of restrictions on the content within the iframe. | `<iframe sandbox />`                   |\n| `loading`         | Optimize loading behavior (e.g., lazy loading).                        | `<iframe loading=\"lazy\" />`            |"
  },
  {
    "id": "videos.mdx#9",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "| `loading`         | Optimize loading behavior (e.g., lazy loading).                        | `<iframe loading=\"lazy\" />`            |\n| `title`           | Provides a title for the iframe to support accessibility.              | `<iframe title=\"Description\" />`       |"
  },
  {
    "id": "videos.mdx#10",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "For a comprehensive list of iframe attributes, refer to the [MDN documentation](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attributes)."
  },
  {
    "id": "videos.mdx#11",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "### Choosing a video embedding method\n\nThere are two ways you can embed videos in your Next.js application:\n\n- **Self-hosted or direct video files:** Embed self-hosted videos using the `<video>` tag for scenarios requiring detailed control over the player's functionality and appearance. This integration method within Next.js allows for customization and control of your video content.\n- **Using video hosting services (YouTube, Vimeo, etc.):** For video hosting services like YouTube or Vimeo, you'll embed their iframe-based players using the `<iframe>` tag. While this method limits some control over the player, it offers ease of use and features provided by these platforms.\n\nChoose the embedding method that aligns with your application's requirements and the user experience you aim to deliver."
  },
  {
    "id": "videos.mdx#12",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "### Embedding externally hosted videos\n\nTo embed videos from external platforms, you can use Next.js to fetch the video information and React Suspense to handle the fallback state while loading.\n\n**1. Create a Server Component for video embedding**\n\nThe first step is to create a [Server Component](/docs/app/getting-started/server-and-client-components) that generates the appropriate iframe for embedding the video. This component will fetch the source URL for the video and render the iframe.\n\n```jsx filename=\"app/ui/video-component.jsx\"\nexport default async function VideoComponent() {\n  const src = await getVideoSrc()\n\n  return <iframe src={src} allowFullScreen />\n}"
  },
  {
    "id": "videos.mdx#13",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "```\n\n**2. Stream the video component using React Suspense**\n\nAfter creating the Server Component to embed the video, the next step is to [stream](/docs/app/api-reference/file-conventions/loading) the component using [React Suspense](https://react.dev/reference/react/Suspense).\n\n```jsx filename=\"app/page.jsx\"\nimport { Suspense } from 'react'\nimport VideoComponent from '../ui/VideoComponent.jsx'\n\nexport default function Page() {\n  return (\n    <section>\n      <Suspense fallback={<p>Loading video...</p>}>\n        <VideoComponent />\n      </Suspense>\n      {/* Other content of the page */}\n    </section>\n  )\n}"
  },
  {
    "id": "videos.mdx#14",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "```\n\n> **Good to know**: When embedding videos from external platforms, consider the following best practices:\n>\n> - Ensure the video embeds are responsive. Use CSS to make the iframe or video player adapt to different screen sizes.\n> - Implement [strategies for loading videos](https://yoast.com/site-speed-tips-for-faster-video/) based on network conditions, especially for users with limited data plans.\n\nThis approach results in a better user experience as it prevents the page from blocking, meaning the user can interact with the page while the video component streams in.\n\nFor a more engaging and informative loading experience, consider using a loading skeleton as the fallback UI. So instead of showing a simple loading message, you can show a skeleton that resembles the video player like this:\n\n```jsx filename=\"app/page.jsx\"\nimport { Suspense } from 'react'\nimport VideoComponent from '../ui/VideoComponent.jsx'\nimport VideoSkeleton from '../ui/VideoSkeleton.jsx'\n\nexport default function Page() {\n  return (\n    <section>\n      <Suspense fallback={<VideoSkeleton />}>\n        <VideoComponent />\n      </Suspense>\n      {/* Other content of the page */}\n    </section>\n  )\n}\n```"
  },
  {
    "id": "videos.mdx#15",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "## Self-hosted videos\n\nSelf-hosting videos may be preferable for several reasons:\n\n- **Complete control and independence**: Self-hosting gives you direct management over your video content, from playback to appearance, ensuring full ownership and control, free from external platform constraints.\n- **Customization for specific needs**: Ideal for unique requirements, like dynamic background videos, it allows for tailored customization to align with design and functional needs.\n- **Performance and scalability considerations**: Choose storage solutions that are both high-performing and scalable, to support increasing traffic and content size effectively.\n- **Cost and integration**: Balance the costs of storage and bandwidth with the need for easy integration into your Next.js framework and broader tech ecosystem."
  },
  {
    "id": "videos.mdx#16",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "### Using Vercel Blob for video hosting\n\n[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website) offers an efficient way to host videos, providing a scalable cloud storage solution that works well with Next.js. Here's how you can host a video using Vercel Blob:\n\n**1. Uploading a video to Vercel Blob**\n\nIn your Vercel dashboard, navigate to the \"Storage\" tab and select your [Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website) store. In the Blob table's upper-right corner, find and click the \"Upload\" button. Then, choose the video file you wish to upload. After the upload completes, the video file will appear in the Blob table.\n\nAlternatively, you can upload your video using a server action. For detailed instructions, refer to the Vercel documentation on [server-side uploads](https://vercel.com/docs/storage/vercel-blob/server-upload). Vercel also supports [client-side uploads](https://vercel.com/docs/storage/vercel-blob/client-upload). This method may be preferable for certain use cases.\n\n**2. Displaying the video in Next.js**"
  },
  {
    "id": "videos.mdx#17",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "**2. Displaying the video in Next.js**\n\nOnce the video is uploaded and stored, you can display it in your Next.js application. Here's an example of how to do this using the `<video>` tag and React Suspense:\n\n```jsx filename=\"app/page.jsx\"\nimport { Suspense } from 'react'\nimport { list } from '@vercel/blob'\n\nexport default function Page() {\n  return (\n    <Suspense fallback={<p>Loading video...</p>}>\n      <VideoComponent fileName=\"my-video.mp4\" />\n    </Suspense>\n  )\n}\n\nasync function VideoComponent({ fileName }) {\n  const { blobs } = await list({\n    prefix: fileName,\n    limit: 1,\n  })\n  const { url } = blobs[0]\n\n  return (\n    <video controls preload=\"none\" aria-label=\"Video player\">\n      <source src={url} type=\"video/mp4\" />\n      Your browser does not support the video tag.\n    </video>\n  )\n}"
  },
  {
    "id": "videos.mdx#18",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "```\n\nIn this approach, the page uses the video's `@vercel/blob` URL to display the video using the `VideoComponent`. React Suspense is used to show a fallback until the video URL is fetched and the video is ready to be displayed."
  },
  {
    "id": "videos.mdx#19",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "### Adding subtitles to your video\n\nIf you have subtitles for your video, you can easily add them using the `<track>` element inside your `<video>` tag. You can fetch the subtitle file from [Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website) in a similar way as the video file. Here's how you can update the `<VideoComponent>` to include subtitles.\n\n```jsx filename=\"app/page.jsx\"\nasync function VideoComponent({ fileName }) {\n  const { blobs } = await list({\n    prefix: fileName,\n    limit: 2,\n  })\n  const { url } = blobs[0]\n  const { url: captionsUrl } = blobs[1]\n\n  return (\n    <video controls preload=\"none\" aria-label=\"Video player\">\n      <source src={url} type=\"video/mp4\" />\n      <track src={captionsUrl} kind=\"subtitles\" srcLang=\"en\" label=\"English\" />\n      Your browser does not support the video tag.\n    </video>\n  )\n}\n```\n\nBy following this approach, you can effectively self-host and integrate videos into your Next.js applications."
  },
  {
    "id": "videos.mdx#20",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "## Resources\n\nTo continue learning more about video optimization and best practices, please refer to the following resources:"
  },
  {
    "id": "videos.mdx#21",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "- **Understanding video formats and codecs**: Choose the right format and codec, like MP4 for compatibility or WebM for web optimization, for your video needs. For more details, see [Mozilla's guide on video codecs](https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Video_codecs).\n- **Video compression**: Use tools like FFmpeg to effectively compress videos, balancing quality with file size. Learn about compression techniques at [FFmpeg's official website](https://www.ffmpeg.org/).\n- **Resolution and bitrate adjustment**: Adjust [resolution and bitrate](https://www.dacast.com/blog/bitrate-vs-resolution/#:~:text=The%20two%20measure%20different%20aspects,yield%20different%20qualities%20of%20video) based on the viewing platform, with lower settings for mobile devices.\n- **Content Delivery Networks (CDNs)**: Utilize a CDN to enhance video delivery speed and manage high traffic. When using some storage solutions, such as Vercel Blob, CDN functionality is automatically handled for you. [Learn more](https://vercel.com/docs/edge-network/overview?utm_source=next-site&utm_medium=docs&utm_campaign=next-website) about CDNs and their benefits."
  },
  {
    "id": "videos.mdx#22",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "Explore these video streaming platforms for integrating video into your Next.js projects:"
  },
  {
    "id": "videos.mdx#23",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "### Open source `next-video` component\n\n- Provides a `<Video>` component for Next.js, compatible with various hosting services including [Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website), S3, Backblaze, and Mux.\n- [Detailed documentation](https://next-video.dev/docs) for using `next-video.dev` with different hosting services.\n\n### Cloudinary Integration\n\n- Official [documentation and integration guide](https://next.cloudinary.dev/) for using Cloudinary with Next.js.\n- Includes a `<CldVideoPlayer>` component for [drop-in video support](https://next.cloudinary.dev/cldvideoplayer/basic-usage).\n- Find [examples](https://github.com/cloudinary-community/cloudinary-examples/?tab=readme-ov-file#nextjs) of integrating Cloudinary with Next.js including [Adaptive Bitrate Streaming](https://github.com/cloudinary-community/cloudinary-examples/tree/main/examples/nextjs-cldvideoplayer-abr).\n- Other [Cloudinary libraries](https://cloudinary.com/documentation) including a Node.js SDK are also available."
  },
  {
    "id": "videos.mdx#24",
    "metadata": {
      "title": "How to use and optimize videos",
      "description": "Recommendations and best practices for optimizing videos in your Next.js application."
    },
    "content": "### Mux Video API\n\n- Mux provides a [starter template](https://github.com/muxinc/video-course-starter-kit) for creating a video course with Mux and Next.js.\n- Learn about Mux's recommendations for embedding [high-performance video for your Next.js application](https://www.mux.com/for/nextjs).\n- Explore an [example project](https://with-mux-video.vercel.app/) demonstrating Mux with Next.js.\n\n### Fastly\n\n- Learn more about integrating Fastly's solutions for [video on demand](https://www.fastly.com/products/streaming-media/video-on-demand) and streaming media into Next.js.\n\n### ImageKit.io Integration\n\n- Check out the [official quick start guide](https://imagekit.io/docs/integration/nextjs) for integrating ImageKit with Next.js.\n- The integration provides an `<IKVideo>` component, offering [seamless video support](https://imagekit.io/docs/integration/nextjs#rendering-videos).\n- You can also explore other [ImageKit libraries](https://imagekit.io/docs), such as the Node.js SDK, which is also available."
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Directives",
      "description": "Directives are used to modify the behavior of your Next.js application."
    },
    "content": "---\ntitle: Directives\ndescription: Directives are used to modify the behavior of your Next.js application.\n---\n\nThe following directives are available:"
  },
  {
    "id": "use-cache-private.mdx#0",
    "metadata": {
      "title": "use cache: private",
      "description": "Learn how to use the `\"use cache: private\"` directive to enable runtime prefetching of personalized content in your Next.js application."
    },
    "content": "---\ntitle: 'use cache: private'\ndescription: 'Learn how to use the `\"use cache: private\"` directive to enable runtime prefetching of personalized content in your Next.js application.'\nrelated:\n  title: Related\n  description: View related API references.\n  links:\n    - app/api-reference/directives/use-cache\n    - app/api-reference/config/next-config-js/cacheComponents\n    - app/api-reference/config/next-config-js/cacheHandlers\n    - app/api-reference/functions/cacheLife\n    - app/api-reference/functions/cacheTag\n    - app/guides/prefetching\n---\n\nThe `'use cache: private'` directive works just like [`use cache`](/docs/app/api-reference/directives/use-cache), but allows you to use runtime APIs like cookies, headers, or search params.\n\n> **Good to know:** Unlike `use cache`, private caches are not prerendered statically as they contain personalized data that is not shared between users."
  },
  {
    "id": "use-cache-private.mdx#1",
    "metadata": {
      "title": "use cache: private",
      "description": "Learn how to use the `\"use cache: private\"` directive to enable runtime prefetching of personalized content in your Next.js application."
    },
    "content": "## Usage\n\nTo use `'use cache: private'`, enable the [`cacheComponents`](/docs/app/api-reference/config/next-config-js/cacheComponents) flag in your `next.config.ts` file:\n\n```tsx filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  cacheComponents: true,\n}\n\nexport default nextConfig\n```\n\n```jsx filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  cacheComponents: true,\n}\n\nexport default nextConfig\n```\n\nThen add `'use cache: private'` to your function along with a `cacheLife` configuration."
  },
  {
    "id": "use-cache-private.mdx#2",
    "metadata": {
      "title": "use cache: private",
      "description": "Learn how to use the `\"use cache: private\"` directive to enable runtime prefetching of personalized content in your Next.js application."
    },
    "content": "### Basic example\n\n```tsx filename=\"app/product/[id]/page.tsx\" switcher\nimport { Suspense } from 'react'\nimport { cookies } from 'next/headers'\nimport { cacheLife, cacheTag } from 'next/cache'\n\nexport default async function ProductPage({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n\n  return (\n    <div>\n      <ProductDetails id={id} />\n      <Suspense fallback={<div>Loading recommendations...</div>}>\n        <Recommendations productId={id} />\n      </Suspense>\n    </div>\n  )\n}\n\nasync function Recommendations({ productId }: { productId: string }) {\n  const recommendations = await getRecommendations(productId)\n\n  return (\n    <div>\n      {recommendations.map((rec) => (\n        <ProductCard key={rec.id} product={rec} />\n      ))}\n    </div>\n  )\n}\n\nasync function getRecommendations(productId: string) {\n  'use cache: private'\n  cacheTag(`recommendations-${productId}`)\n  cacheLife({ stale: 60 }) // Minimum 30 seconds required for runtime prefetch\n\n  // Access cookies within private cache functions\n  const sessionId = (await cookies()).get('session-id')?.value || 'guest'\n\n  return getPersonalizedRecommendations(productId, sessionId)\n}"
  },
  {
    "id": "use-cache-private.mdx#3",
    "metadata": {
      "title": "use cache: private",
      "description": "Learn how to use the `\"use cache: private\"` directive to enable runtime prefetching of personalized content in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/product/[id]/page.js\" switcher\nimport { Suspense } from 'react'\nimport { cookies } from 'next/headers'\nimport { cacheLife, cacheTag } from 'next/cache'\n\nexport default async function ProductPage({ params }) {\n  const { id } = await params\n\n  return (\n    <div>\n      <ProductDetails id={id} />\n      <Suspense fallback={<div>Loading recommendations...</div>}>\n        <Recommendations productId={id} />\n      </Suspense>\n    </div>\n  )\n}\n\nasync function Recommendations({ productId }) {\n  const recommendations = await getRecommendations(productId)\n\n  return (\n    <div>\n      {recommendations.map((rec) => (\n        <ProductCard key={rec.id} product={rec} />\n      ))}\n    </div>\n  )\n}\n\nasync function getRecommendations(productId) {\n  'use cache: private'\n  cacheTag(`recommendations-${productId}`)\n  cacheLife({ stale: 60 }) // Minimum 30 seconds required for runtime prefetch\n\n  // Access cookies within private cache functions\n  const sessionId = (await cookies()).get('session-id')?.value || 'guest'\n\n  return getPersonalizedRecommendations(productId, sessionId)\n}\n```"
  },
  {
    "id": "use-cache-private.mdx#4",
    "metadata": {
      "title": "use cache: private",
      "description": "Learn how to use the `\"use cache: private\"` directive to enable runtime prefetching of personalized content in your Next.js application."
    },
    "content": "## Request APIs allowed in private caches\n\nThe following request-specific APIs can be used inside `'use cache: private'` functions:\n\n| API            | Allowed in `use cache` | Allowed in `'use cache: private'` |\n| -------------- | ---------------------- | --------------------------------- |\n| `cookies()`    | No                     | Yes                               |\n| `headers()`    | No                     | Yes                               |\n| `searchParams` | No                     | Yes                               |\n| `connection()` | No                     | No                                |\n\n> **Note:** The [`connection()`](https://nextjs.org/docs/app/api-reference/functions/connection) API is prohibited in both `use cache` and `'use cache: private'` as it provides connection-specific information that cannot be safely cached.\n\n## Version History\n\n| Version   | Changes                                                              |\n| --------- | -------------------------------------------------------------------- |\n| `v16.0.0` | `\"use cache: private\"` is enabled with the Cache Components feature. |"
  },
  {
    "id": "use-cache-remote.mdx#0",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "---\ntitle: 'use cache: remote'\ndescription: 'Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application.'\nrelated:\n  title: Related\n  description: View related API references.\n  links:\n    - app/api-reference/directives/use-cache\n    - app/api-reference/directives/use-cache-private\n    - app/api-reference/config/next-config-js/cacheComponents\n    - app/api-reference/config/next-config-js/cacheHandlers\n    - app/api-reference/functions/cacheLife\n    - app/api-reference/functions/cacheTag\n    - app/api-reference/functions/connection\n---\n\nThe `'use cache: remote'` directive enables caching of **shared data** in dynamic contexts where regular [`use cache`](/docs/app/api-reference/directives/use-cache) would not work, for example after calling [`await connection()`](/docs/app/api-reference/functions/connection), [`await cookies()`](/docs/app/api-reference/functions/cookies) or [`await headers()`](/docs/app/api-reference/functions/headers)."
  },
  {
    "id": "use-cache-remote.mdx#1",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "> **Good to know:**\n>\n> - Results are stored in server-side cache handlers and shared across all users.\n> - For **user-specific data** that depends on [`await cookies()`](/docs/app/api-reference/functions/cookies) or [`await headers()`](/docs/app/api-reference/functions/headers), use [`'use cache: private'`](/docs/app/api-reference/directives/use-cache-private) instead."
  },
  {
    "id": "use-cache-remote.mdx#2",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "## Usage\n\nTo use `'use cache: remote'`, enable the [`cacheComponents`](/docs/app/api-reference/config/next-config-js/cacheComponents) flag in your `next.config.ts` file:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  cacheComponents: true,\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  cacheComponents: true,\n}\n\nexport default nextConfig\n```\n\nThen add `'use cache: remote'` to your function that needs to cache data in a dynamic context."
  },
  {
    "id": "use-cache-remote.mdx#3",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "### Basic example\n\nCache product pricing that needs to be fetched at request time but can be shared across all users. Use [`cacheLife`](/docs/app/api-reference/functions/cacheLife#custom-cache-profiles) to set the cache lifetime of the price.\n\n```tsx filename=\"app/product/[id]/page.tsx\" switcher\nimport { Suspense } from 'react'\nimport { connection } from 'next/server'\nimport { cacheTag, cacheLife } from 'next/cache'\n\nexport default async function ProductPage({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n\n  return (\n    <div>\n      <ProductDetails id={id} />\n      <Suspense fallback={<div>Loading price...</div>}>\n        <ProductPrice productId={id} />\n      </Suspense>\n    </div>\n  )\n}\n\nfunction ProductDetails({ id }: { id: string }) {\n  return <div>Product: {id}</div>\n}\n\nasync function ProductPrice({ productId }: { productId: string }) {\n  // Calling connection() makes this component dynamic, preventing\n  // it from being included in the static shell. This ensures the price\n  // is always fetched at request time.\n  await connection()"
  },
  {
    "id": "use-cache-remote.mdx#4",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "// Now we can cache the price in a remote cache handler.\n  // Regular 'use cache' would NOT work here because we're in a dynamic context.\n  const price = await getProductPrice(productId)\n\n  return <div>Price: ${price}</div>\n}\n\nasync function getProductPrice(productId: string) {\n  'use cache: remote'\n  cacheTag(`product-price-${productId}`)\n  cacheLife({ expire: 3600 }) // 1 hour\n\n  // This database query is cached and shared across all users\n  return db.products.getPrice(productId)\n}"
  },
  {
    "id": "use-cache-remote.mdx#5",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/product/[id]/page.js\" switcher\nimport { Suspense } from 'react'\nimport { connection } from 'next/server'\nimport { cacheTag, cacheLife } from 'next/cache'\n\nexport default async function ProductPage({ params }) {\n  const { id } = await params\n\n  return (\n    <div>\n      <ProductDetails id={id} />\n      <Suspense fallback={<div>Loading price...</div>}>\n        <ProductPrice productId={id} />\n      </Suspense>\n    </div>\n  )\n}\n\nfunction ProductDetails({ id }) {\n  return <div>Product: {id}</div>\n}\n\nasync function ProductPrice({ productId }) {\n  // Calling connection() makes this component dynamic, preventing\n  // it from being included in the static shell. This ensures the price\n  // is always fetched at request time.\n  await connection()\n\n  // Now we can cache the price in a remote cache handler.\n  // Regular 'use cache' would NOT work here because we're in a dynamic context.\n  const price = await getProductPrice(productId)\n\n  return <div>Price: ${price}</div>\n}\n\nasync function getProductPrice(productId) {\n  'use cache: remote'\n  cacheTag(`product-price-${productId}`)\n  cacheLife({ expire: 3600 }) // 1 hour"
  },
  {
    "id": "use-cache-remote.mdx#6",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "return <div>Price: ${price}</div>\n}\n\nasync function getProductPrice(productId) {\n  'use cache: remote'\n  cacheTag(`product-price-${productId}`)\n  cacheLife({ expire: 3600 }) // 1 hour\n\n  // This database query is cached and shared across all users\n  return db.products.getPrice(productId)\n}"
  },
  {
    "id": "use-cache-remote.mdx#7",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "```\n\n> **Note:** Regular [`use cache`](/docs/app/api-reference/directives/use-cache) will not cache anything when used in a dynamic context (after [`await connection()`](/docs/app/api-reference/functions/connection), [`await cookies()`](/docs/app/api-reference/functions/cookies), [`await headers()`](/docs/app/api-reference/functions/headers), etc.). Use `'use cache: remote'` to enable runtime caching in these scenarios."
  },
  {
    "id": "use-cache-remote.mdx#8",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "## How `use cache: remote` differs from `use cache` and `use cache: private`\n\nNext.js provides three caching directives, each designed for different use cases:"
  },
  {
    "id": "use-cache-remote.mdx#9",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "| Feature                          | `use cache`                         | `'use cache: remote'`                                     | `'use cache: private'`              |\n| -------------------------------- | ----------------------------------- | --------------------------------------------------------- | ----------------------------------- |\n| **Works in dynamic context**     | No (requires static context)        | Yes (designed for dynamic contexts)                       | Yes                                 |\n| **Access to `await cookies()`**  | No                                  | No                                                        | Yes                                 |\n| **Access to `await headers()`**  | No                                  | No                                                        | Yes                                 |\n| **After `await connection()`**   | No (won't cache)                    | No                                                        | No                                  |"
  },
  {
    "id": "use-cache-remote.mdx#10",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "| **After `await connection()`**   | No (won't cache)                    | No                                                        | No                                  |\n| **Stored in cache handler**      | Yes (server-side)                   | Yes (server-side)                                         | No (client-side only)               |\n| **Cache scope**                  | Global (shared)                     | Global (shared)                                           | Per-user (isolated)                 |\n| **Supports runtime prefetching** | N/A (pre-rendered at build)         | No                                                        | Yes (when configured)               |\n| **Use case**                     | Static, shared content (build-time) | Dynamic, shared content in runtime contexts (per-request) | Personalized, user-specific content |"
  },
  {
    "id": "use-cache-remote.mdx#11",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "> **Note:** While you can't call `await cookies()` or `await headers()` inside `'use cache: remote'`, you can read the values before calling a function that is wrapped by `'use cache: remote'` and the arguments will be included in the cache key. Note that this is not recommended as it will dramatically increase the cache size and reduce the cache hit rate."
  },
  {
    "id": "use-cache-remote.mdx#12",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "### When to use each directive\n\nChoose the right caching directive based on your use case:\n\n**Use [`use cache`](/docs/app/api-reference/directives/use-cache) when:**\n\n- Content can be prerendered at build time\n- Content is shared across all users\n- Content doesn't depend on request-specific data\n\n**Use `'use cache: remote'` when:**\n\n- You need caching within dynamic context\n- Content is shared across users but must be rendered per-request (after `await connection()`)\n- You want to cache expensive operations in a server-side cache handler\n\n**Use [`'use cache: private'`](/docs/app/api-reference/directives/use-cache-private) when:**\n\n- Content is personalized per-user (depends on cookies, headers)\n- You need [runtime prefetching](/docs/app/guides/prefetching) of user-specific content\n- Content should never be shared between users"
  },
  {
    "id": "use-cache-remote.mdx#13",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "## How it works\n\nThe `'use cache: remote'` directive enables runtime caching of shared data in dynamic contexts by storing results in server-side cache handlers rather than prerendering at build time.\n\n### Dynamic context detection\n\nWhen Next.js encounters certain APIs like [`connection()`](/docs/app/api-reference/functions/connection), [`cookies()`](/docs/app/api-reference/functions/cookies), or [`headers()`](/docs/app/api-reference/functions/headers), the context becomes \"dynamic\". In a dynamic context:\n\n1. **Regular `use cache` stops working** - it won't cache anything\n2. **`'use cache: remote'` continues to work** - it is cached by a remote cache handler.\n3. **Results are stored server-side** in a key-value store configured for your deployment\n4. **Cached data is shared across requests** - reducing database load and origin requests\n\n> **Good to know:** Without `'use cache: remote'`, functions in dynamic contexts would execute on every request, potentially creating performance bottlenecks. Remote caching eliminates this issue by storing results in server-side cache handlers."
  },
  {
    "id": "use-cache-remote.mdx#14",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "### Storage behavior\n\nRemote caches are **persisted using server-side cache handlers**, which may include:\n\n- **Distributed key-value stores** (in-memory or persistent storage solutions)\n- **File system or in-memory storage** (often used in development or for custom deployments)\n- **Environment-specific caches** (provided by your hosting infrastructure)\n- **Custom or configured cache handlers** (depending on your application's setup)\n\nThis means:\n\n1. Cached data is shared across all users and requests\n2. Cache entries persist beyond a single session\n3. Cache invalidation works via [`cacheTag`](/docs/app/api-reference/functions/cacheTag) and [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag)\n4. Cache expiration is controlled by [`cacheLife`](/docs/app/api-reference/functions/cacheLife) configuration"
  },
  {
    "id": "use-cache-remote.mdx#15",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "### Dynamic context example\n\n```tsx\nasync function UserDashboard() {\n  // Calling connection() makes the context dynamic\n  await connection()\n\n  // Without any caching directive, this runs on every request\n  const stats = await getStats()\n\n  // With 'use cache: remote', this is cached in the remote handler\n  const analytics = await getAnalytics()\n\n  return (\n    <div>\n      <Stats data={stats} />\n      <Analytics data={analytics} />\n    </div>\n  )\n}\n\nasync function getAnalytics() {\n  'use cache: remote'\n  cacheLife({ expire: 300 }) // 5 minutes\n\n  // This expensive operation is cached and shared across all requests\n  return fetchAnalyticsData()\n}\n```"
  },
  {
    "id": "use-cache-remote.mdx#16",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "## Request APIs and remote caches\n\nWhile `'use cache: remote'` technically allows access to request-specific data by calling API's like [`cookies()`](/docs/app/api-reference/functions/cookies) and [`headers()`](/docs/app/api-reference/functions/headers) before calling a function that is wrapped by `'use cache: remote'`, it's generally not recommended to use them together:"
  },
  {
    "id": "use-cache-remote.mdx#17",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "| API                                                                                   | Allowed in `use cache` | Allowed in `'use cache: remote'` | Recommended                                                                                |\n| ------------------------------------------------------------------------------------- | ---------------------- | -------------------------------- | ------------------------------------------------------------------------------------------ |\n| [`cookies()`](/docs/app/api-reference/functions/cookies)                              | No                     | No                               | Use [`'use cache: private'`](/docs/app/api-reference/directives/use-cache-private) instead |\n| [`headers()`](/docs/app/api-reference/functions/headers)                              | No                     | No                               | Use [`'use cache: private'`](/docs/app/api-reference/directives/use-cache-private) instead |"
  },
  {
    "id": "use-cache-remote.mdx#18",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "| [`connection()`](/docs/app/api-reference/functions/connection)                        | No                     | No                               | No - these cannot ever be cached                                                           |\n| [`searchParams`](/docs/app/api-reference/file-conventions/page#searchparams-optional) | No                     | No                               | Use [`'use cache: private'`](/docs/app/api-reference/directives/use-cache-private) instead |"
  },
  {
    "id": "use-cache-remote.mdx#19",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "> **Important:** If you need to cache based on cookies, headers, or search params, use [`'use cache: private'`](/docs/app/api-reference/directives/use-cache-private) instead. Remote caches are shared across all users, so caching user-specific data in them can lead to incorrect results being served to different users."
  },
  {
    "id": "use-cache-remote.mdx#20",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "## Nesting rules\n\nRemote caches have specific nesting rules:\n\n- Remote caches **can** be nested inside other remote caches (`'use cache: remote'`)\n- Remote caches **can** be nested inside regular caches (`'use cache'`)\n- Remote caches **cannot** be nested inside private caches (`'use cache: private'`)\n- Private caches **cannot** be nested inside remote caches\n\n```tsx\n// VALID: Remote inside remote\nasync function outerRemote() {\n  'use cache: remote'\n  const result = await innerRemote()\n  return result\n}\n\nasync function innerRemote() {\n  'use cache: remote'\n  return getData()\n}\n\n// VALID: Remote inside regular cache\nasync function outerCache() {\n  'use cache'\n  // If this is in a dynamic context, the inner remote cache will work\n  const result = await innerRemote()\n  return result\n}\n\nasync function innerRemote() {\n  'use cache: remote'\n  return getData()\n}\n\n// INVALID: Remote inside private\nasync function outerPrivate() {\n  'use cache: private'\n  const result = await innerRemote() // Error!\n  return result\n}\n\nasync function innerRemote() {\n  'use cache: remote'\n  return getData()\n}"
  },
  {
    "id": "use-cache-remote.mdx#21",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "async function innerRemote() {\n  'use cache: remote'\n  return getData()\n}\n\n// INVALID: Private inside remote\nasync function outerRemote() {\n  'use cache: remote'\n  const result = await innerPrivate() // Error!\n  return result\n}\n\nasync function innerPrivate() {\n  'use cache: private'\n  return getData()\n}\n```"
  },
  {
    "id": "use-cache-remote.mdx#22",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "## Examples\n\nThe following examples demonstrate common patterns for using `'use cache: remote'`. For details about `cacheLife` parameters (`stale`, `revalidate`, `expire`), see the [`cacheLife` API reference](/docs/app/api-reference/functions/cacheLife).\n\n### Per-request database queries\n\nCache expensive database queries that are accessed in dynamic contexts, reducing load on your database:\n\n```tsx filename=\"app/dashboard/page.tsx\"\nimport { connection } from 'next/server'\nimport { cacheLife, cacheTag } from 'next/cache'\n\nexport default async function DashboardPage() {\n  // Make context dynamic\n  await connection()\n\n  const stats = await getGlobalStats()\n\n  return <StatsDisplay stats={stats} />\n}\n\nasync function getGlobalStats() {\n  'use cache: remote'\n  cacheTag('global-stats')\n  cacheLife({ expire: 60 }) // 1 minute\n\n  // This expensive database query is cached and shared across all users,\n  // reducing load on your database\n  const stats = await db.analytics.aggregate({\n    total_users: 'count',\n    active_sessions: 'count',\n    revenue: 'sum',\n  })\n\n  return stats\n}\n```"
  },
  {
    "id": "use-cache-remote.mdx#23",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "### API responses in streaming contexts\n\nCache API responses that are fetched during streaming or after dynamic operations:\n\n```tsx filename=\"app/feed/page.tsx\"\nimport { Suspense } from 'react'\nimport { connection } from 'next/server'\nimport { cacheLife, cacheTag } from 'next/cache'\n\nexport default async function FeedPage() {\n  return (\n    <div>\n      <Suspense fallback={<Skeleton />}>\n        <FeedItems />\n      </Suspense>\n    </div>\n  )\n}\n\nasync function FeedItems() {\n  // Dynamic context\n  await connection()\n\n  const items = await getFeedItems()\n\n  return items.map((item) => <FeedItem key={item.id} item={item} />)\n}\n\nasync function getFeedItems() {\n  'use cache: remote'\n  cacheTag('feed-items')\n  cacheLife({ expire: 120 }) // 2 minutes\n\n  // This API call is cached, reducing requests to your external service\n  const response = await fetch('https://api.example.com/feed')\n  return response.json()\n}\n```"
  },
  {
    "id": "use-cache-remote.mdx#24",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "### Computed data after dynamic checks\n\nCache expensive computations that occur after dynamic security or feature checks:\n\n```tsx filename=\"app/reports/page.tsx\"\nimport { connection } from 'next/server'\nimport { cacheLife } from 'next/cache'\n\nexport default async function ReportsPage() {\n  // Dynamic security check\n  await connection()\n\n  const report = await generateReport()\n\n  return <ReportViewer report={report} />\n}\n\nasync function generateReport() {\n  'use cache: remote'\n  cacheLife({ expire: 3600 }) // 1 hour\n\n  // This expensive computation is cached and shared across all authorized users,\n  // avoiding repeated calculations\n  const data = await db.transactions.findMany()\n\n  return {\n    totalRevenue: calculateRevenue(data),\n    topProducts: analyzeProducts(data),\n    trends: calculateTrends(data),\n  }\n}\n```"
  },
  {
    "id": "use-cache-remote.mdx#25",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "### Mixed caching strategies\n\nCombine static, remote, and private caching for optimal performance:\n\n```tsx filename=\"app/product/[id]/page.tsx\"\nimport { Suspense } from 'react'\nimport { connection } from 'next/server'\nimport { cookies } from 'next/headers'\nimport { cacheLife, cacheTag } from 'next/cache'\n\n// Static product data - prerendered at build time\nasync function getProduct(id: string) {\n  'use cache'\n  cacheTag(`product-${id}`)\n\n  // This is cached at build time and shared across all users\n  return db.products.find({ where: { id } })\n}\n\n// Shared pricing data - cached at runtime in remote handler\nasync function getProductPrice(id: string) {\n  'use cache: remote'\n  cacheTag(`product-price-${id}`)\n  cacheLife({ expire: 300 }) // 5 minutes\n\n  // This is cached at runtime and shared across all users\n  return db.products.getPrice({ where: { id } })\n}\n\n// User-specific recommendations - private cache per user\nasync function getRecommendations(productId: string) {\n  'use cache: private'\n  cacheLife({ expire: 60 }) // 1 minute\n\n  const sessionId = (await cookies()).get('session-id')?.value"
  },
  {
    "id": "use-cache-remote.mdx#26",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "const sessionId = (await cookies()).get('session-id')?.value\n\n  // This is cached per-user and never shared\n  return db.recommendations.findMany({\n    where: { productId, sessionId },\n  })\n}\n\nexport default async function ProductPage({ params }) {\n  const { id } = await params\n\n  // Static product data\n  const product = await getProduct(id)\n\n  return (\n    <div>\n      <ProductDetails product={product} />\n\n      {/* Dynamic shared price */}\n      <Suspense fallback={<PriceSkeleton />}>\n        <ProductPriceComponent productId={id} />\n      </Suspense>\n\n      {/* Dynamic personalized recommendations */}\n      <Suspense fallback={<RecommendationsSkeleton />}>\n        <ProductRecommendations productId={id} />\n      </Suspense>\n    </div>\n  )\n}\n\nfunction ProductDetails({ product }) {\n  return (\n    <div>\n      <h1>{product.name}</h1>\n      <p>{product.description}</p>\n    </div>\n  )\n}\n\nasync function ProductPriceComponent({ productId }) {\n  // Make this component dynamic\n  await connection()\n\n  const price = await getProductPrice(productId)\n  return <div>Price: ${price}</div>\n}"
  },
  {
    "id": "use-cache-remote.mdx#27",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "async function ProductPriceComponent({ productId }) {\n  // Make this component dynamic\n  await connection()\n\n  const price = await getProductPrice(productId)\n  return <div>Price: ${price}</div>\n}\n\nasync function ProductRecommendations({ productId }) {\n  const recommendations = await getRecommendations(productId)\n  return <RecommendationsList items={recommendations} />\n}\n\nfunction PriceSkeleton() {\n  return <div>Loading price...</div>\n}\n\nfunction RecommendationsSkeleton() {\n  return <div>Loading recommendations...</div>\n}\n\nfunction RecommendationsList({ items }) {\n  return (\n    <ul>\n      {items.map((item) => (\n        <li key={item.id}>{item.name}</li>\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "use-cache-remote.mdx#28",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "```\n\n> **Good to know**:\n>\n> - Remote caches are stored in server-side cache handlers and shared across all users\n> - Remote caches work in dynamic contexts where regular [`use cache`](/docs/app/api-reference/directives/use-cache) would fail\n> - Use [`cacheTag()`](/docs/app/api-reference/functions/cacheTag) and [`revalidateTag()`](/docs/app/api-reference/functions/revalidateTag) to invalidate remote caches on-demand\n> - Use [`cacheLife()`](/docs/app/api-reference/functions/cacheLife) to configure cache expiration\n> - For user-specific data, use [`'use cache: private'`](/docs/app/api-reference/directives/use-cache-private) instead of `'use cache: remote'`\n> - Remote caches reduce origin load by storing computed or fetched data server-side"
  },
  {
    "id": "use-cache-remote.mdx#29",
    "metadata": {
      "title": "use cache: remote",
      "description": "Learn how to use the `\"use cache: remote\"` directive to enable caching in dynamic contexts in your Next.js application."
    },
    "content": "## Platform Support\n\n| Deployment Option                                                   | Supported |\n| ------------------------------------------------------------------- | --------- |\n| [Node.js server](/docs/app/getting-started/deploying#nodejs-server) | Yes       |\n| [Docker container](/docs/app/getting-started/deploying#docker)      | Yes       |\n| [Static export](/docs/app/getting-started/deploying#static-export)  | No        |\n| [Adapters](/docs/app/getting-started/deploying#adapters)            | Yes       |\n\n## Version History\n\n| Version   | Changes                                                             |\n| --------- | ------------------------------------------------------------------- |\n| `v16.0.0` | `\"use cache: remote\"` is enabled with the Cache Components feature. |"
  },
  {
    "id": "use-cache.mdx#0",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "---\ntitle: use cache\ndescription: Learn how to use the use cache directive to cache data in your Next.js application.\nrelated:\n  title: Related\n  description: View related API references.\n  links:\n    - app/api-reference/directives/use-cache-private\n    - app/api-reference/config/next-config-js/cacheComponents\n    - app/api-reference/config/next-config-js/cacheLife\n    - app/api-reference/config/next-config-js/cacheHandlers\n    - app/api-reference/functions/cacheTag\n    - app/api-reference/functions/cacheLife\n    - app/api-reference/functions/revalidateTag\n---\n\nThe `use cache` directive allows you to mark a route, React component, or a function as cacheable. It can be used at the top of a file to indicate that all exports in the file should be cached, or inline at the top of function or component to cache the return value."
  },
  {
    "id": "use-cache.mdx#1",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "> **Good to know:**\n>\n> - To use cookies or headers, read them outside cached scopes and pass values as arguments. This is the preferred pattern.\n> - If the in-memory cache isn't sufficient for runtime data, [`'use cache: remote'`](/docs/app/api-reference/directives/use-cache-remote) allows platforms to provide a dedicated cache handler, though it may come with its own costs.\n> - For compliance requirements where data must never be cached on the server, or when a deeply nested component needs to access runtime APIs and restructuring would be disruptive, see [`'use cache: private'`](/docs/app/api-reference/directives/use-cache-private)."
  },
  {
    "id": "use-cache.mdx#2",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "## Usage\n\n`use cache` is a Cache Components feature. To enable it, add the [`cacheComponents`](/docs/app/api-reference/config/next-config-js/cacheComponents) option to your `next.config.ts` file:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  cacheComponents: true,\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  cacheComponents: true,\n}\n\nmodule.exports = nextConfig\n```\n\nThen, add `use cache` at the file, component, or function level:\n\n```tsx\n// File level\n'use cache'\n\nexport default async function Page() {\n  // ...\n}\n\n// Component level\nexport async function MyComponent() {\n  'use cache'\n  return <></>\n}\n\n// Function level\nexport async function getData() {\n  'use cache'\n  const data = await fetch('/api/data')\n  return data\n}\n```\n\n> **Good to know**: When used at file level, all function exports must be async functions."
  },
  {
    "id": "use-cache.mdx#3",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "## How `use cache` works"
  },
  {
    "id": "use-cache.mdx#4",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "### Cache keys\n\nA cache entry's key is generated using a serialized version of its inputs, which includes:\n\n1. **Build ID** - Unique per build, changing this invalidates all cache entries\n2. **Function ID** - A secure hash of the function's location and signature in the codebase\n3. **Serializable arguments** - Props (for components) or function arguments\n4. **HMR refresh hash** (development only) - Invalidates cache on hot module replacement\n\nWhen a cached function references variables from outer scopes, those variables are automatically captured and bound as arguments, making them part of the cache key.\n\n```tsx filename=\"lib/data.ts\"\nasync function Component({ userId }: { userId: string }) {\n  const getData = async (filter: string) => {\n    'use cache'\n    // Cache key includes both userId (from closure) and filter (argument)\n    return fetch(`/api/users/${userId}/data?filter=${filter}`)\n  }\n\n  return getData('active')\n}\n```\n\nIn the snippet above, `userId` is captured from the outer scope and `filter` is passed as an argument, so both become part of the `getData` function's cache key. This means different user and filter combinations will have separate cache entries."
  },
  {
    "id": "use-cache.mdx#5",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "## Serialization\n\nArguments to cached functions and their return values must be serializable.\n\nFor a complete reference, see:\n\n- [Serializable arguments](https://react.dev/reference/rsc/use-server#serializable-parameters-and-return-values) - Uses **React Server Components** serialization\n- [Serializable return types](https://react.dev/reference/rsc/use-client#serializable-types) - Uses **React Client Components** serialization\n\n> **Good to know:** Arguments and return values use different serialization systems. Server Component serialization (for arguments) is more restrictive than Client Component serialization (for return values). This means you can return JSX elements but cannot accept them as arguments unless using pass-through patterns.\n\n### Supported types\n\n**Arguments:**\n\n- Primitives: `string`, `number`, `boolean`, `null`, `undefined`\n- Plain objects: `{ key: value }`\n- Arrays: `[1, 2, 3]`\n- Dates, Maps, Sets, TypedArrays, ArrayBuffers\n- React elements (as pass-through only)\n\n**Return values:**\n\n- Same as arguments, plus JSX elements"
  },
  {
    "id": "use-cache.mdx#6",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "### Unsupported types\n\n- Class instances\n- Functions (except as pass-through)\n- Symbols, WeakMaps, WeakSets\n- URL instances\n\n```tsx filename=\"app/components/user-card.tsx\"\n// Valid - primitives and plain objects\nasync function UserCard({\n  id,\n  config,\n}: {\n  id: string\n  config: { theme: string }\n}) {\n  'use cache'\n  return <div>{id}</div>\n}\n\n// Invalid - class instance\nasync function UserProfile({ user }: { user: UserClass }) {\n  'use cache'\n  // Error: Cannot serialize class instance\n  return <div>{user.name}</div>\n}\n```"
  },
  {
    "id": "use-cache.mdx#7",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "### Pass-through (non-serializable arguments)\n\nYou can accept non-serializable values **as long as you don't introspect them**. This enables composition patterns with `children` and Server Actions:\n\n```tsx filename=\"app/components/cached-wrapper.tsx\"\nasync function CachedWrapper({ children }: { children: ReactNode }) {\n  'use cache'\n  // Don't read or modify children - just pass it through\n  return (\n    <div className=\"wrapper\">\n      <header>Cached Header</header>\n      {children}\n    </div>\n  )\n}\n\n// Usage: children can be dynamic\nexport default function Page() {\n  return (\n    <CachedWrapper>\n      <DynamicComponent /> {/* Not cached, passed through */}\n    </CachedWrapper>\n  )\n}\n```\n\nYou can also pass Server Actions through cached components:\n\n```tsx filename=\"app/components/cached-form.tsx\"\nasync function CachedForm({ action }: { action: () => Promise<void> }) {\n  'use cache'\n  // Don't call action here - just pass it through\n  return <form action={action}>{/* ... */}</form>\n}\n```"
  },
  {
    "id": "use-cache.mdx#8",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "## Constraints\n\nCached functions and components **cannot** directly access runtime APIs like `cookies()`, `headers()`, or `searchParams`. Instead, read these values outside the cached scope and pass them as arguments."
  },
  {
    "id": "use-cache.mdx#9",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "### Runtime caching considerations\n\nWhile `use cache` is designed primarily to include dynamic data in the static shell, it can also cache data at runtime using in-memory LRU (Least Recently Used) storage.\n\nRuntime cache behavior depends on your hosting environment:\n\n| Environment     | Runtime Caching Behavior                                                                                                                                          |\n| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| **Serverless**  | Cache entries may not persist across requests (each request can be a different instance). Build-time caching works normally.                                      |\n| **Self-hosted** | Cache entries persist across requests. Control cache size with [`cacheMaxMemorySize`](/docs/app/api-reference/config/next-config-js/incrementalCacheHandlerPath). |"
  },
  {
    "id": "use-cache.mdx#10",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "If the default in-memory cache isn't enough, consider **[`use cache: remote`](/docs/app/api-reference/directives/use-cache-remote)** which allows platforms to provide a dedicated cache handler (like Redis or KV database). This helps reduce hits against data sources not scaled to your total traffic, though it comes with costs (storage, network latency, platform fees).\n\nVery rarely, for compliance requirements where certain data must never be cached on the server (even ephemerally), or when a component within a `use cache` scope needs to access runtime APIs like `cookies()` and restructuring the component tree is impractical, you might need **[`use cache: private`](/docs/app/api-reference/directives/use-cache-private)**."
  },
  {
    "id": "use-cache.mdx#11",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "## `use cache` at runtime\n\nOn the **server**, cache entries are stored in-memory and respect the `revalidate` and `expire` times from your `cacheLife` configuration. You can customize the cache storage by configuring [`cacheHandlers`](/docs/app/api-reference/config/next-config-js/cacheHandlers) in your `next.config.js` file.\n\nOn the **client**, content from the server cache is stored in the browser's memory for the duration defined by the `stale` time. The client router enforces a **minimum 30-second stale time**, regardless of configuration.\n\nThe `x-nextjs-stale-time` response header communicates cache lifetime from server to client, ensuring coordinated behavior."
  },
  {
    "id": "use-cache.mdx#12",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "## Revalidation\n\nBy default, `use cache` uses the `default` profile with these settings:\n\n- **stale**: 5 minutes (client-side)\n- **revalidate**: 15 minutes (server-side)\n- **expire**: Never expires by time\n\n```tsx filename=\"lib/data.ts\"\nasync function getData() {\n  'use cache'\n  // Implicitly uses default profile\n  return fetch('/api/data')\n}\n```\n\n### Customizing cache lifetime\n\nUse the [`cacheLife`](/docs/app/api-reference/functions/cacheLife) function to customize cache duration:\n\n```tsx filename=\"lib/data.ts\"\nimport { cacheLife } from 'next/cache'\n\nasync function getData() {\n  'use cache'\n  cacheLife('hours') // Use built-in 'hours' profile\n  return fetch('/api/data')\n}\n```"
  },
  {
    "id": "use-cache.mdx#13",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "### On-demand revalidation\n\nUse [`cacheTag`](/docs/app/api-reference/functions/cacheTag), [`updateTag`](/docs/app/api-reference/functions/updateTag), or [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) for on-demand cache invalidation:\n\n```tsx filename=\"lib/data.ts\"\nimport { cacheTag } from 'next/cache'\n\nasync function getProducts() {\n  'use cache'\n  cacheTag('products')\n  return fetch('/api/products')\n}\n```\n\n```tsx filename=\"app/actions.ts\"\n'use server'\n\nimport { updateTag } from 'next/cache'\n\nexport async function updateProduct() {\n  await db.products.update(...)\n  updateTag('products') // Invalidates all 'products' caches\n}\n```\n\nBoth `cacheLife` and `cacheTag` integrate across client and server caching layers, meaning you configure your caching semantics in one place and they apply everywhere."
  },
  {
    "id": "use-cache.mdx#14",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "## Examples"
  },
  {
    "id": "use-cache.mdx#15",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "### Caching an entire route with `use cache`\n\nTo pre-render an entire route, add `use cache` to the top of **both** the `layout` and `page` files. Each of these segments are treated as separate entry points in your application, and will be cached independently.\n\n```tsx filename=\"app/layout.tsx\" switcher\n'use cache'\n\nexport default async function Layout({ children }: { children: ReactNode }) {\n  return <div>{children}</div>\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\n'use cache'\n\nexport default async function Layout({ children }) {\n  return <div>{children}</div>\n}\n```\n\nAny components imported and nested in `page` file are part of the cache output associated with the `page`.\n\n```tsx filename=\"app/page.tsx\" switcher\n'use cache'\n\nasync function Users() {\n  const users = await fetch('/api/users')\n  // loop through users\n}\n\nexport default async function Page() {\n  return (\n    <main>\n      <Users />\n    </main>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\n'use cache'\n\nasync function Users() {\n  const users = await fetch('/api/users')\n  // loop through users\n}\n\nexport default async function Page() {\n  return (\n    <main>\n      <Users />\n    </main>\n  )\n}"
  },
  {
    "id": "use-cache.mdx#16",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "```\n\n> **Good to know**:\n>\n> - If `use cache` is added only to the `layout` or the `page`, only that route segment and any components imported into it will be cached."
  },
  {
    "id": "use-cache.mdx#17",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "### Caching a component's output with `use cache`\n\nYou can use `use cache` at the component level to cache any fetches or computations performed within that component. The cache entry will be reused as long as the serialized props produce the same value in each instance.\n\n```tsx filename=\"app/components/bookings.tsx\" highlight={2} switcher\nexport async function Bookings({ type = 'haircut' }: BookingsProps) {\n  'use cache'\n  async function getBookingsData() {\n    const data = await fetch(`/api/bookings?type=${encodeURIComponent(type)}`)\n    return data\n  }\n  return //...\n}\n\ninterface BookingsProps {\n  type: string\n}\n```\n\n```jsx filename=\"app/components/bookings.js\" highlight={2} switcher\nexport async function Bookings({ type = 'haircut' }) {\n  'use cache'\n  async function getBookingsData() {\n    const data = await fetch(`/api/bookings?type=${encodeURIComponent(type)}`)\n    return data\n  }\n  return //...\n}\n```"
  },
  {
    "id": "use-cache.mdx#18",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "### Caching function output with `use cache`\n\nSince you can add `use cache` to any asynchronous function, you aren't limited to caching components or routes only. You might want to cache a network request, a database query, or a slow computation.\n\n```tsx filename=\"app/actions.ts\" highlight={2} switcher\nexport async function getData() {\n  'use cache'\n\n  const data = await fetch('/api/data')\n  return data\n}\n```\n\n```jsx filename=\"app/actions.js\" highlight={2} switcher\nexport async function getData() {\n  'use cache'\n\n  const data = await fetch('/api/data')\n  return data\n}\n```"
  },
  {
    "id": "use-cache.mdx#19",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "### Interleaving\n\nIn React, composition with `children` or slots is a well-known pattern for building flexible components. When using `use cache`, you can continue to compose your UI in this way. Anything included as `children`, or other compositional slots, in the returned JSX will be passed through the cached component without affecting its cache entry.\n\nAs long as you don't directly reference any of the JSX slots inside the body of the cacheable function itself, their presence in the returned output won't affect the cache entry.\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default async function Page() {\n  const uncachedData = await getData()\n  return (\n    // Pass compositional slots as props, e.g. header and children\n    <CacheComponent header={<h1>Home</h1>}>\n      {/* DynamicComponent is provided as the children slot */}\n      <DynamicComponent data={uncachedData} />\n    </CacheComponent>\n  )\n}"
  },
  {
    "id": "use-cache.mdx#20",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "async function CacheComponent({\n  header, // header: a compositional slot, injected as a prop\n  children, // children: another slot for nested composition\n}: {\n  header: ReactNode\n  children: ReactNode\n}) {\n  'use cache'\n  const cachedData = await fetch('/api/cached-data')\n  return (\n    <div>\n      {header}\n      <PrerenderedComponent data={cachedData} />\n      {children}\n    </div>\n  )\n}"
  },
  {
    "id": "use-cache.mdx#21",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nexport default async function Page() {\n  const uncachedData = await getData()\n  return (\n    // Pass compositional slots as props, e.g. header and children\n    <CacheComponent header={<h1>Home</h1>}>\n      {/* DynamicComponent is provided as the children slot */}\n      <DynamicComponent data={uncachedData} />\n    </CacheComponent>\n  )\n}\n\nasync function CacheComponent({\n  header, // header: a compositional slot, injected as a prop\n  children, // children: another slot for nested composition\n}) {\n  'use cache'\n  const cachedData = await fetch('/api/cached-data')\n  return (\n    <div>\n      {header}\n      <PrerenderedComponent data={cachedData} />\n      {children}\n    </div>\n  )\n}"
  },
  {
    "id": "use-cache.mdx#22",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "```\n\nYou can also pass Server Actions through cached components to Client Components without invoking them inside the cacheable function.\n\n```tsx filename=\"app/page.tsx\" switcher\nimport ClientComponent from './ClientComponent'\n\nexport default async function Page() {\n  const performUpdate = async () => {\n    'use server'\n    // Perform some server-side update\n    await db.update(...)\n  }\n\n  return <CachedComponent performUpdate={performUpdate} />\n}\n\nasync function CachedComponent({\n  performUpdate,\n}: {\n  performUpdate: () => Promise<void>\n}) {\n  'use cache'\n  // Do not call performUpdate here\n  return <ClientComponent action={performUpdate} />\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport ClientComponent from './ClientComponent'\n\nexport default async function Page() {\n  const performUpdate = async () => {\n    'use server'\n    // Perform some server-side update\n    await db.update(...)\n  }\n\n  return <CachedComponent performUpdate={performUpdate} />\n}\n\nasync function CachedComponent({ performUpdate }) {\n  'use cache'\n  // Do not call performUpdate here\n  return <ClientComponent action={performUpdate} />\n}"
  },
  {
    "id": "use-cache.mdx#23",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "```\n\n```tsx filename=\"app/ClientComponent.tsx\" switcher\n'use client'\n\nexport default function ClientComponent({\n  action,\n}: {\n  action: () => Promise<void>\n}) {\n  return <button onClick={action}>Update</button>\n}\n```\n\n```jsx filename=\"app/ClientComponent.js\" switcher\n'use client'\n\nexport default function ClientComponent({ action }) {\n  return <button onClick={action}>Update</button>\n}\n```"
  },
  {
    "id": "use-cache.mdx#24",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "## Troubleshooting"
  },
  {
    "id": "use-cache.mdx#25",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "### Build Hangs (Cache Timeout)\n\nIf your build hangs, you're accessing Promises that resolve to dynamic or runtime data, created outside a `use cache` boundary. The cached function waits for data that can't resolve during the build, causing a timeout after 50 seconds.\n\nWhen the build timeouts you'll see this error message:\n\n> Error: Filling a cache during prerender timed out, likely because request-specific arguments such as params, searchParams, cookies() or dynamic data were used inside \"use cache\".\n\nCommon ways this happens: passing such Promises as props, accessing them via closure, or retrieving them from shared storage (Maps).\n\n> **Good to know:** Directly calling `cookies()` or `headers()` inside `use cache` fails immediately with a [different error](/docs/messages/next-request-in-use-cache), not a timeout.\n\n**Passing runtime data Promises as props:**\n\n```tsx filename=\"app/page.tsx\"\nimport { cookies } from 'next/headers'\nimport { Suspense } from 'react'\n\nexport default function Page() {\n  return (\n    <Suspense fallback={<div>Loading...</div>}>\n      <Dynamic />\n    </Suspense>\n  )\n}"
  },
  {
    "id": "use-cache.mdx#26",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "export default function Page() {\n  return (\n    <Suspense fallback={<div>Loading...</div>}>\n      <Dynamic />\n    </Suspense>\n  )\n}\n\nasync function Dynamic() {\n  const cookieStore = cookies()\n  return <Cached promise={cookieStore} /> // Build hangs\n}\n\nasync function Cached({ promise }: { promise: Promise<unknown> }) {\n  'use cache'\n  const data = await promise // Waits for runtime data during build\n  return <p>..</p>\n}"
  },
  {
    "id": "use-cache.mdx#27",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "```\n\nAwait the `cookies` store in the `Dynamic` component, and pass a cookie value to the `Cached` component.\n\n**Shared deduplication storage:**\n\n```tsx filename=\"app/page.tsx\"\n// Problem: Map stores dynamic Promises, accessed by cached code\nimport { Suspense } from 'react'\n\nconst cache = new Map<string, Promise<string>>()\n\nexport default function Page() {\n  return (\n    <>\n      <Suspense fallback={<div>Loading...</div>}>\n        <Dynamic id=\"data\" />\n      </Suspense>\n      <Cached id=\"data\" />\n    </>\n  )\n}\n\nasync function Dynamic({ id }: { id: string }) {\n  // Stores dynamic Promise in shared Map\n  cache.set(\n    id,\n    fetch(`https://api.example.com/${id}`).then((r) => r.text())\n  )\n  return <p>Dynamic</p>\n}\n\nasync function Cached({ id }: { id: string }) {\n  'use cache'\n  return <p>{await cache.get(id)}</p> // Build hangs - retrieves dynamic Promise\n}\n```\n\nUse Next.js's built-in `fetch()` deduplication or use separate Maps for cached and uncached contexts."
  },
  {
    "id": "use-cache.mdx#28",
    "metadata": {
      "title": "use cache",
      "description": "Learn how to use the use cache directive to cache data in your Next.js application."
    },
    "content": "## Platform Support\n\n| Deployment Option                                                   | Supported         |\n| ------------------------------------------------------------------- | ----------------- |\n| [Node.js server](/docs/app/getting-started/deploying#nodejs-server) | Yes               |\n| [Docker container](/docs/app/getting-started/deploying#docker)      | Yes               |\n| [Static export](/docs/app/getting-started/deploying#static-export)  | No                |\n| [Adapters](/docs/app/getting-started/deploying#adapters)            | Platform-specific |\n\nLearn how to [configure caching](/docs/app/guides/self-hosting#caching-and-isr) when self-hosting Next.js.\n\n## Version History\n\n| Version   | Changes                                                     |\n| --------- | ----------------------------------------------------------- |\n| `v16.0.0` | `\"use cache\"` is enabled with the Cache Components feature. |\n| `v15.0.0` | `\"use cache\"` is introduced as an experimental feature.     |"
  },
  {
    "id": "use-client.mdx#0",
    "metadata": {
      "title": "use client",
      "description": "Learn how to use the use client directive to render a component on the client."
    },
    "content": "---\ntitle: use client\ndescription: Learn how to use the use client directive to render a component on the client.\n---\n\nThe `'use client'` directive declares an entry point for the components to be rendered on the **client side** and should be used when creating interactive user interfaces (UI) that require client-side JavaScript capabilities, such as state management, event handling, and access to browser APIs. This is a React feature.\n\n> **Good to know:**\n>\n> You do not need to add the `'use client'` directive to every file that contains Client Components. You only need to add it to the files whose components you want to render directly within Server Components. The `'use client'` directive defines the client-server [boundary](https://nextjs.org/docs/app/building-your-application/rendering#network-boundary), and the components exported from such a file serve as entry points to the client."
  },
  {
    "id": "use-client.mdx#1",
    "metadata": {
      "title": "use client",
      "description": "Learn how to use the use client directive to render a component on the client."
    },
    "content": "## Usage\n\nTo declare an entry point for the Client Components, add the `'use client'` directive **at the top of the file**, before any imports:\n\n```tsx filename=\"app/components/counter.tsx\" highlight={1} switcher\n'use client'\n\nimport { useState } from 'react'\n\nexport default function Counter() {\n  const [count, setCount] = useState(0)\n\n  return (\n    <div>\n      <p>Count: {count}</p>\n      <button onClick={() => setCount(count + 1)}>Increment</button>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/components/counter.js\" highlight={1} switcher\n'use client'\n\nimport { useState } from 'react'\n\nexport default function Counter() {\n  const [count, setCount] = useState(0)\n\n  return (\n    <div>\n      <p>Count: {count}</p>\n      <button onClick={() => setCount(count + 1)}>Increment</button>\n    </div>\n  )\n}"
  },
  {
    "id": "use-client.mdx#2",
    "metadata": {
      "title": "use client",
      "description": "Learn how to use the use client directive to render a component on the client."
    },
    "content": "```\n\nWhen using the `'use client'` directive, the props of the Client Components must be [serializable](https://react.dev/reference/rsc/use-client#serializable-types). This means the props need to be in a format that React can serialize when sending data from the server to the client.\n\n```tsx filename=\"app/components/counter.tsx\" highlight={4} switcher\n'use client'\n\nexport default function Counter({\n  onClick /* ❌ Function is not serializable */,\n}) {\n  return (\n    <div>\n      <button onClick={onClick}>Increment</button>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/components/counter.js\" highlight={4} switcher\n'use client'\n\nexport default function Counter({\n  onClick /* ❌ Function is not serializable */,\n}) {\n  return (\n    <div>\n      <button onClick={onClick}>Increment</button>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "use-client.mdx#3",
    "metadata": {
      "title": "use client",
      "description": "Learn how to use the use client directive to render a component on the client."
    },
    "content": "## Nesting Client Components within Server Components\n\nCombining Server and Client Components allows you to build applications that are both performant and interactive:\n\n1. **Server Components**: Use for static content, data fetching, and SEO-friendly elements.\n2. **Client Components**: Use for interactive elements that require state, effects, or browser APIs.\n3. **Component composition**: Nest Client Components within Server Components as needed for a clear separation of server and client logic.\n\nIn the following example:\n\n- `Header` is a Server Component handling static content.\n- `Counter` is a Client Component enabling interactivity within the page.\n\n```tsx filename=\"app/page.tsx\" highlight={2,8} switcher\nimport Header from './header'\nimport Counter from './counter' // This is a Client Component\n\nexport default function Page() {\n  return (\n    <div>\n      <Header />\n      <Counter />\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" highlight={2,8} switcher\nimport Header from './header'\nimport Counter from './counter' // This is a Client Component\n\nexport default function Page() {\n  return (\n    <div>\n      <Header />\n      <Counter />\n    </div>\n  )\n}\n```"
  },
  {
    "id": "use-client.mdx#4",
    "metadata": {
      "title": "use client",
      "description": "Learn how to use the use client directive to render a component on the client."
    },
    "content": "## Reference\n\nSee the [React documentation](https://react.dev/reference/rsc/use-client) for more information on `'use client'`."
  },
  {
    "id": "use-server.mdx#0",
    "metadata": {
      "title": "use server",
      "description": "Learn how to use the use server directive to execute code on the server."
    },
    "content": "---\ntitle: use server\ndescription: Learn how to use the use server directive to execute code on the server.\n---\n\nThe `use server` directive designates a function or file to be executed on the **server side**. It can be used at the top of a file to indicate that all functions in the file are server-side, or inline at the top of a function to mark the function as a [Server Function](https://19.react.dev/reference/rsc/server-functions). This is a React feature."
  },
  {
    "id": "use-server.mdx#1",
    "metadata": {
      "title": "use server",
      "description": "Learn how to use the use server directive to execute code on the server."
    },
    "content": "## Using `use server` at the top of a file\n\nThe following example shows a file with a `use server` directive at the top. All functions in the file are executed on the server.\n\n```tsx filename=\"app/actions.ts\" highlight={1} switcher\n'use server'\nimport { db } from '@/lib/db' // Your database client\n\nexport async function createUser(data: { name: string; email: string }) {\n  const user = await db.user.create({ data })\n  return user\n}\n```\n\n```jsx filename=\"app/actions.js\" highlight={1} switcher\n'use server'\nimport { db } from '@/lib/db' // Your database client\n\nexport async function createUser(data) {\n  const user = await db.user.create({ data })\n  return user\n}\n```"
  },
  {
    "id": "use-server.mdx#2",
    "metadata": {
      "title": "use server",
      "description": "Learn how to use the use server directive to execute code on the server."
    },
    "content": "### Using Server Functions in a Client Component\n\nTo use Server Functions in Client Components you need to create your Server Functions in a dedicated file using the `use server` directive at the top of the file. These Server Functions can then be imported into Client and Server Components and executed.\n\nAssuming you have a `fetchUsers` Server Function in `actions.ts`:\n\n```tsx filename=\"app/actions.ts\" highlight={1} switcher\n'use server'\nimport { db } from '@/lib/db' // Your database client\n\nexport async function fetchUsers() {\n  const users = await db.user.findMany()\n  return users\n}\n```\n\n```jsx filename=\"app/actions.js\" highlight={1} switcher\n'use server'\nimport { db } from '@/lib/db' // Your database client\n\nexport async function fetchUsers() {\n  const users = await db.user.findMany()\n  return users\n}\n```\n\nThen you can import the `fetchUsers` Server Function into a Client Component and execute it on the client-side.\n\n```tsx filename=\"app/components/my-button.tsx\" highlight={1,2,8} switcher\n'use client'\nimport { fetchUsers } from '../actions'\n\nexport default function MyButton() {\n  return <button onClick={() => fetchUsers()}>Fetch Users</button>\n}"
  },
  {
    "id": "use-server.mdx#3",
    "metadata": {
      "title": "use server",
      "description": "Learn how to use the use server directive to execute code on the server."
    },
    "content": "```\n\n```jsx filename=\"app/components/my-button.js\" highlight={1,2,8} switcher\n'use client'\nimport { fetchUsers } from '../actions'\n\nexport default function MyButton() {\n  return <button onClick={() => fetchUsers()}>Fetch Users</button>\n}\n```"
  },
  {
    "id": "use-server.mdx#4",
    "metadata": {
      "title": "use server",
      "description": "Learn how to use the use server directive to execute code on the server."
    },
    "content": "## Using `use server` inline\n\nIn the following example, `use server` is used inline at the top of a function to mark it as a [Server Function](https://19.react.dev/reference/rsc/server-functions):\n\n```tsx filename=\"app/posts/[id]/page.tsx\" switcher highlight={8}\nimport { EditPost } from './edit-post'\nimport { revalidatePath } from 'next/cache'\n\nexport default async function PostPage({ params }: { params: { id: string } }) {\n  const post = await getPost(params.id)\n\n  async function updatePost(formData: FormData) {\n    'use server'\n    await savePost(params.id, formData)\n    revalidatePath(`/posts/${params.id}`)\n  }\n\n  return <EditPost updatePostAction={updatePost} post={post} />\n}\n```\n\n```jsx filename=\"app/posts/[id]/page.js\" switcher highlight={8}\nimport { EditPost } from './edit-post'\nimport { revalidatePath } from 'next/cache'\n\nexport default async function PostPage({ params }) {\n  const post = await getPost(params.id)\n\n  async function updatePost(formData) {\n    'use server'\n    await savePost(params.id, formData)\n    revalidatePath(`/posts/${params.id}`)\n  }\n\n  return <EditPost updatePostAction={updatePost} post={post} />\n}\n```"
  },
  {
    "id": "use-server.mdx#5",
    "metadata": {
      "title": "use server",
      "description": "Learn how to use the use server directive to execute code on the server."
    },
    "content": "## Security considerations\n\nWhen using the `use server` directive, it's important to ensure that all server-side logic is secure and that sensitive data remains protected.\n\n### Authentication and authorization\n\nAlways authenticate and authorize users before performing sensitive server-side operations.\n\n```tsx filename=\"app/actions.ts\" highlight={1,7,8,9,10} switcher\n'use server'\n\nimport { db } from '@/lib/db' // Your database client\nimport { authenticate } from '@/lib/auth' // Your authentication library\n\nexport async function createUser(\n  data: { name: string; email: string },\n  token: string\n) {\n  const user = authenticate(token)\n  if (!user) {\n    throw new Error('Unauthorized')\n  }\n  const newUser = await db.user.create({ data })\n  return newUser\n}\n```\n\n```jsx filename=\"app/actions.js\" highlight={1,7,8,9,10} switcher\n'use server'\n\nimport { db } from '@/lib/db' // Your database client\nimport { authenticate } from '@/lib/auth' // Your authentication library\n\nexport async function createUser(data, token) {\n  const user = authenticate(token)\n  if (!user) {\n    throw new Error('Unauthorized')\n  }\n  const newUser = await db.user.create({ data })\n  return newUser\n}\n```"
  },
  {
    "id": "use-server.mdx#6",
    "metadata": {
      "title": "use server",
      "description": "Learn how to use the use server directive to execute code on the server."
    },
    "content": "## Reference\n\nSee the [React documentation](https://react.dev/reference/rsc/use-server) for more information on `use server`."
  },
  {
    "id": "font.mdx#0",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "---\ntitle: Font Module\nnav_title: Font\ndescription: Optimizing loading web fonts with the built-in `next/font` loaders.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n[`next/font`](/docs/app/api-reference/components/font) automatically optimizes your fonts (including custom fonts) and removes external network requests for improved privacy and performance.\n\nIt includes **built-in automatic self-hosting** for any font file. This means you can optimally load web fonts with no [layout shift](https://web.dev/articles/cls).\n\nYou can also conveniently use all [Google Fonts](https://fonts.google.com/). CSS and font files are downloaded at build time and self-hosted with the rest of your static assets. **No requests are sent to Google by the browser.**\n\n<AppOnly>\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { Inter } from 'next/font/google'\n\n// If loading a variable font, you don't need to specify the font weight\nconst inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n})"
  },
  {
    "id": "font.mdx#1",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "// If loading a variable font, you don't need to specify the font weight\nconst inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n})\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\" className={inter.className}>\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "font.mdx#2",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { Inter } from 'next/font/google'\n\n// If loading a variable font, you don't need to specify the font weight\nconst inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n})\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\" className={inter.className}>\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nTo use the font in all your pages, add it to [`_app.js` file](/docs/pages/building-your-application/routing/custom-app) under `/pages` as shown below:\n\n```jsx filename=\"pages/_app.js\"\nimport { Inter } from 'next/font/google'\n\n// If loading a variable font, you don't need to specify the font weight\nconst inter = Inter({ subsets: ['latin'] })\n\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <main className={inter.className}>\n      <Component {...pageProps} />\n    </main>\n  )\n}\n```\n\n</PagesOnly>\n\n> **🎥 Watch:** Learn more about using `next/font` → [YouTube (6 minutes)](https://www.youtube.com/watch?v=L8_98i_bMMA)."
  },
  {
    "id": "font.mdx#3",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "## Reference"
  },
  {
    "id": "font.mdx#4",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "| Key                                         | `font/google`       | `font/local`        | Type                       | Required          |\n| ------------------------------------------- | ------------------- | ------------------- | -------------------------- | ----------------- |\n| [`src`](#src)                               | <Cross size={18} /> | <Check size={18} /> | String or Array of Objects | Yes               |\n| [`weight`](#weight)                         | <Check size={18} /> | <Check size={18} /> | String or Array            | Required/Optional |\n| [`style`](#style)                           | <Check size={18} /> | <Check size={18} /> | String or Array            | -                 |\n| [`subsets`](#subsets)                       | <Check size={18} /> | <Cross size={18} /> | Array of Strings           | -                 |\n| [`axes`](#axes)                             | <Check size={18} /> | <Cross size={18} /> | Array of Strings           | -                 |\n| [`display`](#display)                       | <Check size={18} /> | <Check size={18} /> | String                     | -                 |"
  },
  {
    "id": "font.mdx#5",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "| [`display`](#display)                       | <Check size={18} /> | <Check size={18} /> | String                     | -                 |\n| [`preload`](#preload)                       | <Check size={18} /> | <Check size={18} /> | Boolean                    | -                 |\n| [`fallback`](#fallback)                     | <Check size={18} /> | <Check size={18} /> | Array of Strings           | -                 |\n| [`adjustFontFallback`](#adjustfontfallback) | <Check size={18} /> | <Check size={18} /> | Boolean or String          | -                 |\n| [`variable`](#variable)                     | <Check size={18} /> | <Check size={18} /> | String                     | -                 |\n| [`declarations`](#declarations)             | <Cross size={18} /> | <Check size={18} /> | Array of Objects           | -                 |"
  },
  {
    "id": "font.mdx#6",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### `src`\n\nThe path of the font file as a string or an array of objects (with type `Array<{path: string, weight?: string, style?: string}>`) relative to the directory where the font loader function is called.\n\nUsed in `next/font/local`\n\n- Required\n\nExamples:\n\n- `src:'./fonts/my-font.woff2'` where `my-font.woff2` is placed in a directory named `fonts` inside the `app` directory\n- `src:[{path: './inter/Inter-Thin.ttf', weight: '100',},{path: './inter/Inter-Regular.ttf',weight: '400',},{path: './inter/Inter-Bold-Italic.ttf', weight: '700',style: 'italic',},]`\n- if the font loader function is called in `app/page.tsx` using `src:'../styles/fonts/my-font.ttf'`, then `my-font.ttf` is placed in `styles/fonts` at the root of the project"
  },
  {
    "id": "font.mdx#7",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### `weight`\n\nThe font [`weight`](https://fonts.google.com/knowledge/glossary/weight) with the following possibilities:\n\n- A string with possible values of the weights available for the specific font or a range of values if it's a [variable](https://fonts.google.com/variablefonts) font\n- An array of weight values if the font is not a [variable google font](https://fonts.google.com/variablefonts). It applies to `next/font/google` only.\n\nUsed in `next/font/google` and `next/font/local`\n\n- Required if the font being used is **not** [variable](https://fonts.google.com/variablefonts)\n\nExamples:\n\n- `weight: '400'`: A string for a single weight value - for the font [`Inter`](https://fonts.google.com/specimen/Inter?query=inter), the possible values are `'100'`, `'200'`, `'300'`, `'400'`, `'500'`, `'600'`, `'700'`, `'800'`, `'900'` or `'variable'` where `'variable'` is the default)\n- `weight: '100 900'`: A string for the range between `100` and `900` for a variable font\n- `weight: ['100','400','900']`: An array of 3 possible values for a non variable font"
  },
  {
    "id": "font.mdx#8",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### `style`\n\nThe font [`style`](https://developer.mozilla.org/docs/Web/CSS/font-style) with the following possibilities:\n\n- A string [value](https://developer.mozilla.org/docs/Web/CSS/font-style#values) with default value of `'normal'`\n- An array of style values if the font is not a [variable google font](https://fonts.google.com/variablefonts). It applies to `next/font/google` only.\n\nUsed in `next/font/google` and `next/font/local`\n\n- Optional\n\nExamples:\n\n- `style: 'italic'`: A string - it can be `normal` or `italic` for `next/font/google`\n- `style: 'oblique'`: A string - it can take any value for `next/font/local` but is expected to come from [standard font styles](https://developer.mozilla.org/docs/Web/CSS/font-style)\n- `style: ['italic','normal']`: An array of 2 values for `next/font/google` - the values are from `normal` and `italic`"
  },
  {
    "id": "font.mdx#9",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### `subsets`\n\nThe font [`subsets`](https://fonts.google.com/knowledge/glossary/subsetting) defined by an array of string values with the names of each subset you would like to be [preloaded](/docs/app/api-reference/components/font#specifying-a-subset). Fonts specified via `subsets` will have a link preload tag injected into the head when the [`preload`](#preload) option is true, which is the default.\n\nUsed in `next/font/google`\n\n- Optional\n\nExamples:\n\n- `subsets: ['latin']`: An array with the subset `latin`\n\nYou can find a list of all subsets on the Google Fonts page for your font."
  },
  {
    "id": "font.mdx#10",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### `axes`\n\nSome variable fonts have extra `axes` that can be included. By default, only the font weight is included to keep the file size down. The possible values of `axes` depend on the specific font.\n\nUsed in `next/font/google`\n\n- Optional\n\nExamples:\n\n- `axes: ['slnt']`: An array with value `slnt` for the `Inter` variable font which has `slnt` as additional `axes` as shown [here](https://fonts.google.com/variablefonts?vfquery=inter#font-families). You can find the possible `axes` values for your font by using the filter on the [Google variable fonts page](https://fonts.google.com/variablefonts#font-families) and looking for axes other than `wght`\n\n### `display`\n\nThe font [`display`](https://developer.mozilla.org/docs/Web/CSS/@font-face/font-display) with possible string [values](https://developer.mozilla.org/docs/Web/CSS/@font-face/font-display#values) of `'auto'`, `'block'`, `'swap'`, `'fallback'` or `'optional'` with default value of `'swap'`.\n\nUsed in `next/font/google` and `next/font/local`\n\n- Optional\n\nExamples:\n\n- `display: 'optional'`: A string assigned to the `optional` value"
  },
  {
    "id": "font.mdx#11",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### `preload`\n\nA boolean value that specifies whether the font should be [preloaded](/docs/app/api-reference/components/font#preloading) or not. The default is `true`.\n\nUsed in `next/font/google` and `next/font/local`\n\n- Optional\n\nExamples:\n\n- `preload: false`\n\n### `fallback`\n\nThe fallback font to use if the font cannot be loaded. An array of strings of fallback fonts with no default.\n\n- Optional\n\nUsed in `next/font/google` and `next/font/local`\n\nExamples:\n\n- `fallback: ['system-ui', 'arial']`: An array setting the fallback fonts to `system-ui` or `arial`"
  },
  {
    "id": "font.mdx#12",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### `adjustFontFallback`\n\n- For `next/font/google`: A boolean value that sets whether an automatic fallback font should be used to reduce [Cumulative Layout Shift](https://web.dev/cls/). The default is `true`.\n- For `next/font/local`: A string or boolean `false` value that sets whether an automatic fallback font should be used to reduce [Cumulative Layout Shift](https://web.dev/cls/). The possible values are `'Arial'`, `'Times New Roman'` or `false`. The default is `'Arial'`.\n\nUsed in `next/font/google` and `next/font/local`\n\n- Optional\n\nExamples:\n\n- `adjustFontFallback: false`: for `next/font/google`\n- `adjustFontFallback: 'Times New Roman'`: for `next/font/local`\n\n### `variable`\n\nA string value to define the CSS variable name to be used if the style is applied with the [CSS variable method](#css-variables).\n\nUsed in `next/font/google` and `next/font/local`\n\n- Optional\n\nExamples:\n\n- `variable: '--my-font'`: The CSS variable `--my-font` is declared"
  },
  {
    "id": "font.mdx#13",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### `declarations`\n\nAn array of font face [descriptor](https://developer.mozilla.org/docs/Web/CSS/@font-face#descriptors) key-value pairs that define the generated `@font-face` further.\n\nUsed in `next/font/local`\n\n- Optional\n\nExamples:\n\n- `declarations: [{ prop: 'ascent-override', value: '90%' }]`"
  },
  {
    "id": "font.mdx#14",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "## Examples"
  },
  {
    "id": "font.mdx#15",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "## Google Fonts\n\nTo use a Google font, import it from `next/font/google` as a function. We recommend using [variable fonts](https://fonts.google.com/variablefonts) for the best performance and flexibility.\n\n<AppOnly>\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { Inter } from 'next/font/google'\n\n// If loading a variable font, you don't need to specify the font weight\nconst inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n})\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\" className={inter.className}>\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { Inter } from 'next/font/google'\n\n// If loading a variable font, you don't need to specify the font weight\nconst inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n})\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\" className={inter.className}>\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "font.mdx#16",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\nIf you can't use a variable font, you will **need to specify a weight**:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { Roboto } from 'next/font/google'\n\nconst roboto = Roboto({\n  weight: '400',\n  subsets: ['latin'],\n  display: 'swap',\n})\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\" className={roboto.className}>\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { Roboto } from 'next/font/google'\n\nconst roboto = Roboto({\n  weight: '400',\n  subsets: ['latin'],\n  display: 'swap',\n})\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\" className={roboto.className}>\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "font.mdx#17",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\nTo use the font in all your pages, add it to [`_app.js` file](/docs/pages/building-your-application/routing/custom-app) under `/pages` as shown below:\n\n```jsx filename=\"pages/_app.js\"\nimport { Inter } from 'next/font/google'\n\n// If loading a variable font, you don't need to specify the font weight\nconst inter = Inter({ subsets: ['latin'] })\n\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <main className={inter.className}>\n      <Component {...pageProps} />\n    </main>\n  )\n}\n```\n\nIf you can't use a variable font, you will **need to specify a weight**:\n\n```jsx filename=\"pages/_app.js\"\nimport { Roboto } from 'next/font/google'\n\nconst roboto = Roboto({\n  weight: '400',\n  subsets: ['latin'],\n})\n\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <main className={roboto.className}>\n      <Component {...pageProps} />\n    </main>\n  )\n}\n```\n\n</PagesOnly>\n\nYou can specify multiple weights and/or styles by using an array:\n\n```jsx filename=\"app/layout.js\"\nconst roboto = Roboto({\n  weight: ['400', '700'],\n  style: ['normal', 'italic'],\n  subsets: ['latin'],\n  display: 'swap',\n})"
  },
  {
    "id": "font.mdx#18",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n> **Good to know**: Use an underscore (\\_) for font names with multiple words. E.g. `Roboto Mono` should be imported as `Roboto_Mono`.\n\n<PagesOnly>"
  },
  {
    "id": "font.mdx#19",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### Apply the font in `<head>`\n\nYou can also use the font without a wrapper and `className` by injecting it inside the `<head>` as follows:\n\n```jsx filename=\"pages/_app.js\"\nimport { Inter } from 'next/font/google'\n\nconst inter = Inter({ subsets: ['latin'] })\n\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <>\n      <style jsx global>{`\n        html {\n          font-family: ${inter.style.fontFamily};\n        }\n      `}</style>\n      <Component {...pageProps} />\n    </>\n  )\n}\n```\n\n### Single page usage\n\nTo use the font on a single page, add it to the specific page as shown below:\n\n```jsx filename=\"pages/index.js\"\nimport { Inter } from 'next/font/google'\n\nconst inter = Inter({ subsets: ['latin'] })\n\nexport default function Home() {\n  return (\n    <div className={inter.className}>\n      <p>Hello World</p>\n    </div>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "font.mdx#20",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### Specifying a subset\n\nGoogle Fonts are automatically [subset](https://fonts.google.com/knowledge/glossary/subsetting). This reduces the size of the font file and improves performance. You'll need to define which of these subsets you want to preload. Failing to specify any subsets while [`preload`](/docs/app/api-reference/components/font#preload) is `true` will result in a warning.\n\nThis can be done by adding it to the function call:\n\n<AppOnly>\n\n```tsx filename=\"app/layout.tsx\" switcher\nconst inter = Inter({ subsets: ['latin'] })\n```\n\n```jsx filename=\"app/layout.js\" switcher\nconst inter = Inter({ subsets: ['latin'] })\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/_app.js\"\nconst inter = Inter({ subsets: ['latin'] })\n```\n\n</PagesOnly>\n\nView the [Font API Reference](/docs/app/api-reference/components/font) for more information."
  },
  {
    "id": "font.mdx#21",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "## Using Multiple Fonts\n\nYou can import and use multiple fonts in your application. There are two approaches you can take.\n\nThe first approach is to create a utility function that exports a font, imports it, and applies its `className` where needed. This ensures the font is preloaded only when it's rendered:\n\n```ts filename=\"app/fonts.ts\" switcher\nimport { Inter, Roboto_Mono } from 'next/font/google'\n\nexport const inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n})\n\nexport const roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  display: 'swap',\n})\n```\n\n```js filename=\"app/fonts.js\" switcher\nimport { Inter, Roboto_Mono } from 'next/font/google'\n\nexport const inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n})\n\nexport const roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  display: 'swap',\n})\n```\n\n<AppOnly>\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { inter } from './fonts'\n\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    <html lang=\"en\" className={inter.className}>\n      <body>\n        <div>{children}</div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "font.mdx#22",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { inter } from './fonts'\n\nexport default function Layout({ children }) {\n  return (\n    <html lang=\"en\" className={inter.className}>\n      <body>\n        <div>{children}</div>\n      </body>\n    </html>\n  )\n}\n```\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { roboto_mono } from './fonts'\n\nexport default function Page() {\n  return (\n    <>\n      <h1 className={roboto_mono.className}>My page</h1>\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { roboto_mono } from './fonts'\n\nexport default function Page() {\n  return (\n    <>\n      <h1 className={roboto_mono.className}>My page</h1>\n    </>\n  )\n}"
  },
  {
    "id": "font.mdx#23",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n</AppOnly>\n\nIn the example above, `Inter` will be applied globally, and `Roboto Mono` can be imported and applied as needed.\n\nAlternatively, you can create a [CSS variable](/docs/app/api-reference/components/font#variable) and use it with your preferred CSS solution:\n\n<AppOnly>\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { Inter, Roboto_Mono } from 'next/font/google'\nimport styles from './global.css'\n\nconst inter = Inter({\n  subsets: ['latin'],\n  variable: '--font-inter',\n  display: 'swap',\n})\n\nconst roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  variable: '--font-roboto-mono',\n  display: 'swap',\n})\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\" className={`${inter.variable} ${roboto_mono.variable}`}>\n      <body>\n        <h1>My App</h1>\n        <div>{children}</div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "font.mdx#24",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { Inter, Roboto_Mono } from 'next/font/google'\n\nconst inter = Inter({\n  subsets: ['latin'],\n  variable: '--font-inter',\n  display: 'swap',\n})\n\nconst roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  variable: '--font-roboto-mono',\n  display: 'swap',\n})\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\" className={`${inter.variable} ${roboto_mono.variable}`}>\n      <body>\n        <h1>My App</h1>\n        <div>{children}</div>\n      </body>\n    </html>\n  )\n}\n```\n\n</AppOnly>\n\n```css filename=\"app/global.css\"\nhtml {\n  font-family: var(--font-inter);\n}\n\nh1 {\n  font-family: var(--font-roboto-mono);\n}\n```\n\nIn the example above, `Inter` will be applied globally, and any `<h1>` tags will be styled with `Roboto Mono`.\n\n> **Recommendation**: Use multiple fonts conservatively since each new font is an additional resource the client has to download."
  },
  {
    "id": "font.mdx#25",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### Local Fonts\n\nImport `next/font/local` and specify the `src` of your local font file. We recommend using [variable fonts](https://fonts.google.com/variablefonts) for the best performance and flexibility.\n\n<AppOnly>\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport localFont from 'next/font/local'\n\n// Font files can be colocated inside of `app`\nconst myFont = localFont({\n  src: './my-font.woff2',\n  display: 'swap',\n})\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\" className={myFont.className}>\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport localFont from 'next/font/local'\n\n// Font files can be colocated inside of `app`\nconst myFont = localFont({\n  src: './my-font.woff2',\n  display: 'swap',\n})\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\" className={myFont.className}>\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "font.mdx#26",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/_app.js\"\nimport localFont from 'next/font/local'\n\n// Font files can be colocated inside of `pages`\nconst myFont = localFont({ src: './my-font.woff2' })\n\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <main className={myFont.className}>\n      <Component {...pageProps} />\n    </main>\n  )\n}\n```\n\n</PagesOnly>\n\nIf you want to use multiple files for a single font family, `src` can be an array:\n\n```js\nconst roboto = localFont({\n  src: [\n    {\n      path: './Roboto-Regular.woff2',\n      weight: '400',\n      style: 'normal',\n    },\n    {\n      path: './Roboto-Italic.woff2',\n      weight: '400',\n      style: 'italic',\n    },\n    {\n      path: './Roboto-Bold.woff2',\n      weight: '700',\n      style: 'normal',\n    },\n    {\n      path: './Roboto-BoldItalic.woff2',\n      weight: '700',\n      style: 'italic',\n    },\n  ],\n})\n```\n\nView the [Font API Reference](/docs/app/api-reference/components/font) for more information."
  },
  {
    "id": "font.mdx#27",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### With Tailwind CSS\n\n`next/font` integrates seamlessly with [Tailwind CSS](https://tailwindcss.com/) using [CSS variables](/docs/app/api-reference/components/font#css-variables).\n\nIn the example below, we use the `Inter` and `Roboto_Mono` fonts from `next/font/google` (you can use any Google Font or Local Font). Use the `variable` option to define a CSS variable name, such as `inter` and `roboto_mono` for these fonts, respectively. Then, apply `inter.variable` and `roboto_mono.variable` to include the CSS variables in your HTML document.\n\n> **Good to know**: You can add these variables to the `<html>` or `<body>` tag, depending on your preference, styling needs or project requirements.\n\n<AppOnly>\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { Inter, Roboto_Mono } from 'next/font/google'\n\nconst inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n  variable: '--font-inter',\n})\n\nconst roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  display: 'swap',\n  variable: '--font-roboto-mono',\n})"
  },
  {
    "id": "font.mdx#28",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "const roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  display: 'swap',\n  variable: '--font-roboto-mono',\n})\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html\n      lang=\"en\"\n      className={`${inter.variable} ${roboto_mono.variable} antialiased`}\n    >\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "font.mdx#29",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { Inter, Roboto_Mono } from 'next/font/google'\n\nconst inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n  variable: '--font-inter',\n})\n\nconst roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  display: 'swap',\n  variable: '--font-roboto-mono',\n})\n\nexport default function RootLayout({ children }) {\n  return (\n    <html\n      lang=\"en\"\n      className={`${inter.variable} ${roboto_mono.variable} antialiased`}\n    >\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/_app.js\"\nimport { Inter } from 'next/font/google'\n\nconst inter = Inter({\n  subsets: ['latin'],\n  variable: '--font-inter',\n})\n\nconst roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  display: 'swap',\n  variable: '--font-roboto-mono',\n})\n\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <main className={`${inter.variable} ${roboto_mono.variable} font-sans`}>\n      <Component {...pageProps} />\n    </main>\n  )\n}"
  },
  {
    "id": "font.mdx#30",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n</PagesOnly>\n\nFinally, add the CSS variable to your [Tailwind CSS config](/docs/app/getting-started/css#tailwind-css):\n\n```css filename=\"global.css\"\n@import 'tailwindcss';\n\n@theme inline {\n  --font-sans: var(--font-inter);\n  --font-mono: var(--font-roboto-mono);\n}\n```"
  },
  {
    "id": "font.mdx#31",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### Tailwind CSS v3\n\n```js filename=\"tailwind.config.js\"\n/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\n    './pages/**/*.{js,ts,jsx,tsx}',\n    './components/**/*.{js,ts,jsx,tsx}',\n    './app/**/*.{js,ts,jsx,tsx}',\n  ],\n  theme: {\n    extend: {\n      fontFamily: {\n        sans: ['var(--font-inter)'],\n        mono: ['var(--font-roboto-mono)'],\n      },\n    },\n  },\n  plugins: [],\n}\n```\n\nYou can now use the `font-sans` and `font-mono` utility classes to apply the font to your elements.\n\n```html\n<p class=\"font-sans ...\">The quick brown fox ...</p>\n<p class=\"font-mono ...\">The quick brown fox ...</p>\n```"
  },
  {
    "id": "font.mdx#32",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### Applying Styles\n\nYou can apply the font styles in three ways:\n\n- [`className`](#classname)\n- [`style`](#style-1)\n- [CSS Variables](#css-variables)\n\n#### `className`\n\nReturns a read-only CSS `className` for the loaded font to be passed to an HTML element.\n\n```tsx\n<p className={inter.className}>Hello, Next.js!</p>\n```\n\n#### `style`\n\nReturns a read-only CSS `style` object for the loaded font to be passed to an HTML element, including `style.fontFamily` to access the font family name and fallback fonts.\n\n```tsx\n<p style={inter.style}>Hello World</p>\n```"
  },
  {
    "id": "font.mdx#33",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "#### CSS Variables\n\nIf you would like to set your styles in an external style sheet and specify additional options there, use the CSS variable method.\n\nIn addition to importing the font, also import the CSS file where the CSS variable is defined and set the variable option of the font loader object as follows:\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { Inter } from 'next/font/google'\nimport styles from '../styles/component.module.css'\n\nconst inter = Inter({\n  variable: '--font-inter',\n})\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { Inter } from 'next/font/google'\nimport styles from '../styles/component.module.css'\n\nconst inter = Inter({\n  variable: '--font-inter',\n})\n```\n\nTo use the font, set the `className` of the parent container of the text you would like to style to the font loader's `variable` value and the `className` of the text to the `styles` property from the external CSS file.\n\n```tsx filename=\"app/page.tsx\" switcher\n<main className={inter.variable}>\n  <p className={styles.text}>Hello World</p>\n</main>\n```\n\n```jsx filename=\"app/page.js\" switcher\n<main className={inter.variable}>\n  <p className={styles.text}>Hello World</p>\n</main>"
  },
  {
    "id": "font.mdx#34",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\n<main className={inter.variable}>\n  <p className={styles.text}>Hello World</p>\n</main>\n```\n\nDefine the `text` selector class in the `component.module.css` CSS file as follows:\n\n```css filename=\"styles/component.module.css\"\n.text {\n  font-family: var(--font-inter);\n  font-weight: 200;\n  font-style: italic;\n}\n```\n\nIn the example above, the text `Hello World` is styled using the `Inter` font and the generated font fallback with `font-weight: 200` and `font-style: italic`."
  },
  {
    "id": "font.mdx#35",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### Using a font definitions file\n\nEvery time you call the `localFont` or Google font function, that font will be hosted as one instance in your application. Therefore, if you need to use the same font in multiple places, you should load it in one place and import the related font object where you need it. This is done using a font definitions file.\n\nFor example, create a `fonts.ts` file in a `styles` folder at the root of your app directory.\n\nThen, specify your font definitions as follows:\n\n```ts filename=\"styles/fonts.ts\" switcher\nimport { Inter, Lora, Source_Sans_3 } from 'next/font/google'\nimport localFont from 'next/font/local'\n\n// define your variable fonts\nconst inter = Inter()\nconst lora = Lora()\n// define 2 weights of a non-variable font\nconst sourceCodePro400 = Source_Sans_3({ weight: '400' })\nconst sourceCodePro700 = Source_Sans_3({ weight: '700' })\n// define a custom local font where GreatVibes-Regular.ttf is stored in the styles folder\nconst greatVibes = localFont({ src: './GreatVibes-Regular.ttf' })\n\nexport { inter, lora, sourceCodePro400, sourceCodePro700, greatVibes }"
  },
  {
    "id": "font.mdx#36",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n```js filename=\"styles/fonts.js\" switcher\nimport { Inter, Lora, Source_Sans_3 } from 'next/font/google'\nimport localFont from 'next/font/local'\n\n// define your variable fonts\nconst inter = Inter()\nconst lora = Lora()\n// define 2 weights of a non-variable font\nconst sourceCodePro400 = Source_Sans_3({ weight: '400' })\nconst sourceCodePro700 = Source_Sans_3({ weight: '700' })\n// define a custom local font where GreatVibes-Regular.ttf is stored in the styles folder\nconst greatVibes = localFont({ src: './GreatVibes-Regular.ttf' })\n\nexport { inter, lora, sourceCodePro400, sourceCodePro700, greatVibes }\n```\n\nYou can now use these definitions in your code as follows:\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { inter, lora, sourceCodePro700, greatVibes } from '../styles/fonts'\n\nexport default function Page() {\n  return (\n    <div>\n      <p className={inter.className}>Hello world using Inter font</p>\n      <p style={lora.style}>Hello world using Lora font</p>\n      <p className={sourceCodePro700.className}>\n        Hello world using Source_Sans_3 font with weight 700\n      </p>\n      <p className={greatVibes.className}>My title in Great Vibes font</p>\n    </div>\n  )\n}"
  },
  {
    "id": "font.mdx#37",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nimport { inter, lora, sourceCodePro700, greatVibes } from '../styles/fonts'\n\nexport default function Page() {\n  return (\n    <div>\n      <p className={inter.className}>Hello world using Inter font</p>\n      <p style={lora.style}>Hello world using Lora font</p>\n      <p className={sourceCodePro700.className}>\n        Hello world using Source_Sans_3 font with weight 700\n      </p>\n      <p className={greatVibes.className}>My title in Great Vibes font</p>\n    </div>\n  )\n}\n```\n\nTo make it easier to access the font definitions in your code, you can define a path alias in your `tsconfig.json` or `jsconfig.json` files as follows:\n\n```json filename=\"tsconfig.json\"\n{\n  \"compilerOptions\": {\n    \"paths\": {\n      \"@/fonts\": [\"./styles/fonts\"]\n    }\n  }\n}\n```\n\nYou can now import any font definition as follows:\n\n```tsx filename=\"app/about/page.tsx\" switcher\nimport { greatVibes, sourceCodePro400 } from '@/fonts'\n```\n\n```jsx filename=\"app/about/page.js\" switcher\nimport { greatVibes, sourceCodePro400 } from '@/fonts'\n```"
  },
  {
    "id": "font.mdx#38",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "### Preloading\n\n<AppOnly>\n\nWhen a font function is called on a page of your site, it is not globally available and preloaded on all routes. Rather, the font is only preloaded on the related routes based on the type of file where it is used:\n\n- If it's a [unique page](/docs/app/api-reference/file-conventions/page), it is preloaded on the unique route for that page.\n- If it's a [layout](/docs/app/api-reference/file-conventions/layout), it is preloaded on all the routes wrapped by the layout.\n- If it's the [root layout](/docs/app/api-reference/file-conventions/layout#root-layout), it is preloaded on all routes.\n\n</AppOnly>\n\n<PagesOnly>\n\nWhen a font function is called on a page of your site, it is not globally available and preloaded on all routes. Rather, the font is only preloaded on the related route/s based on the type of file where it is used:\n\n- if it's a [unique page](/docs/pages/building-your-application/routing/pages-and-layouts), it is preloaded on the unique route for that page\n- if it's in the [custom App](/docs/pages/building-your-application/routing/custom-app), it is preloaded on all the routes of the site under `/pages`\n\n</PagesOnly>"
  },
  {
    "id": "font.mdx#39",
    "metadata": {
      "title": "Font Module",
      "description": "Optimizing loading web fonts with the built-in `next/font` loaders."
    },
    "content": "## Version Changes\n\n| Version   | Changes                                                               |\n| --------- | --------------------------------------------------------------------- |\n| `v13.2.0` | `@next/font` renamed to `next/font`. Installation no longer required. |\n| `v13.0.0` | `@next/font` was added.                                               |"
  },
  {
    "id": "form.mdx#0",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "---\ntitle: Form Component\ndescription: Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation.\n---\n\nThe `<Form>` component extends the HTML `<form>` element to provide <AppOnly>[**prefetching**](/docs/app/getting-started/linking-and-navigating#prefetching) of [loading UI](/docs/app/api-reference/file-conventions/loading),</AppOnly> **client-side navigation** on submission, and **progressive enhancement**.\n\nIt's useful for forms that update URL search params as it reduces the boilerplate code needed to achieve the above.\n\nBasic usage:\n\n<AppOnly>\n\n```tsx filename=\"/app/ui/search.tsx\" switcher\nimport Form from 'next/form'\n\nexport default function Page() {\n  return (\n    <Form action=\"/search\">\n      {/* On submission, the input value will be appended to\n          the URL, e.g. /search?query=abc */}\n      <input name=\"query\" />\n      <button type=\"submit\">Submit</button>\n    </Form>\n  )\n}"
  },
  {
    "id": "form.mdx#1",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "```\n\n```jsx filename=\"/app/ui/search.js\" switcher\nimport Form from 'next/form'\n\nexport default function Search() {\n  return (\n    <Form action=\"/search\">\n      {/* On submission, the input value will be appended to\n          the URL, e.g. /search?query=abc */}\n      <input name=\"query\" />\n      <button type=\"submit\">Submit</button>\n    </Form>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"/ui/search.js\" switcher\nimport Form from 'next/form'\n\nexport default function Page() {\n  return (\n    <Form action=\"/search\">\n      {/* On submission, the input value will be appended to\n          the URL, e.g. /search?query=abc */}\n      <input name=\"query\" />\n      <button type=\"submit\">Submit</button>\n    </Form>\n  )\n}\n```\n\n```jsx filename=\"/ui/search.js\" switcher\nimport Form from 'next/form'\n\nexport default function Search() {\n  return (\n    <Form action=\"/search\">\n      {/* On submission, the input value will be appended to\n          the URL, e.g. /search?query=abc */}\n      <input name=\"query\" />\n      <button type=\"submit\">Submit</button>\n    </Form>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "form.mdx#2",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "## Reference\n\nThe behavior of the `<Form>` component depends on whether the `action` prop is passed a `string` or `function`.\n\n<AppOnly>\n\n- When `action` is a **string**, the `<Form>` behaves like a native HTML form that uses a **`GET`** method. The form data is encoded into the URL as search params, and when the form is submitted, it navigates to the specified URL. In addition, Next.js:\n  - [Prefetches](/docs/app/getting-started/linking-and-navigating#prefetching) the path when the form becomes visible, this preloads shared UI (e.g. `layout.js` and `loading.js`), resulting in faster navigation.\n  - Performs a [client-side navigation](/docs/app/getting-started/linking-and-navigating#client-side-transitions) instead of a full page reload when the form is submitted. This retains shared UI and client-side state.\n- When `action` is a **function** (Server Action), `<Form>` behaves like a [React form](https://react.dev/reference/react-dom/components/form), executing the action when the form is submitted.\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "form.mdx#3",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "</AppOnly>\n\n<PagesOnly>\n\n- When `action` is a **string**, the `<Form>` behaves like a native HTML form that uses a **`GET`** method. The form data is encoded into the URL as search params, and when the form is submitted, it navigates to the specified URL. In addition, Next.js:\n  - Performs a [client-side navigation](/docs/app/getting-started/linking-and-navigating#client-side-transitions) instead of a full page reload when the form is submitted. This retains shared UI and client-side state.\n\n</PagesOnly>"
  },
  {
    "id": "form.mdx#4",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "### `action` (string) Props\n\n<PagesOnly>\n\nWhen `action` is a string, the `<Form>` component supports the following props:\n\n| Prop      | Example            | Type                            | Required |\n| --------- | ------------------ | ------------------------------- | -------- |\n| `action`  | `action=\"/search\"` | `string` (URL or relative path) | Yes      |\n| `replace` | `replace={false}`  | `boolean`                       | -        |\n| `scroll`  | `scroll={true}`    | `boolean`                       | -        |\n\n- **`action`**: The URL or path to navigate to when the form is submitted.\n  - An empty string `\"\"` will navigate to the same route with updated search params.\n- **`replace`**: Replaces the current history state instead of pushing a new one to the [browser's history](https://developer.mozilla.org/en-US/docs/Web/API/History_API) stack. Default is `false`.\n- **`scroll`**: Controls the scroll behavior during navigation. Defaults to `true`, this means it will scroll to the top of the new route, and maintain the scroll position for backwards and forwards navigation.\n\n</PagesOnly>\n\n<AppOnly>\n\nWhen `action` is a string, the `<Form>` component supports the following props:"
  },
  {
    "id": "form.mdx#5",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "</PagesOnly>\n\n<AppOnly>\n\nWhen `action` is a string, the `<Form>` component supports the following props:\n\n| Prop       | Example            | Type                            | Required |\n| ---------- | ------------------ | ------------------------------- | -------- |\n| `action`   | `action=\"/search\"` | `string` (URL or relative path) | Yes      |\n| `replace`  | `replace={false}`  | `boolean`                       | -        |\n| `scroll`   | `scroll={true}`    | `boolean`                       | -        |\n| `prefetch` | `prefetch={true}`  | `boolean`                       | -        |"
  },
  {
    "id": "form.mdx#6",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "- **`action`**: The URL or path to navigate to when the form is submitted.\n  - An empty string `\"\"` will navigate to the same route with updated search params.\n- **`replace`**: Replaces the current history state instead of pushing a new one to the [browser's history](https://developer.mozilla.org/en-US/docs/Web/API/History_API) stack. Default is `false`.\n- **`scroll`**: Controls the scroll behavior during navigation. Defaults to `true`, this means it will scroll to the top of the new route, and maintain the scroll position for backwards and forwards navigation.\n- **`prefetch`**: Controls whether the path should be prefetched when the form becomes visible in the user's viewport. Defaults to `true`."
  },
  {
    "id": "form.mdx#7",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "### `action` (function) Props\n\nWhen `action` is a function, the `<Form>` component supports the following prop:\n\n| Prop     | Example             | Type                       | Required |\n| -------- | ------------------- | -------------------------- | -------- |\n| `action` | `action={myAction}` | `function` (Server Action) | Yes      |\n\n- **`action`**: The Server Action to be called when the form is submitted. See the [React docs](https://react.dev/reference/react-dom/components/form#props) for more.\n\n> **Good to know**: When `action` is a function, the `replace` and `scroll` props are ignored.\n\n</AppOnly>"
  },
  {
    "id": "form.mdx#8",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "### Caveats\n\n<AppOnly>\n\n- **`formAction`**: Can be used in a `<button>` or `<input type=\"submit\">` fields to override the `action` prop. Next.js will perform a client-side navigation, however, this approach doesn't support prefetching.\n  - When using [`basePath`](/docs/app/api-reference/config/next-config-js/basePath), you must also include it in the `formAction` path. e.g. `formAction=\"/base-path/search\"`.\n- **`key`**: Passing a `key` prop to a string `action` is not supported. If you'd like to trigger a re-render or perform a mutation, consider using a function `action` instead.\n\n</AppOnly>"
  },
  {
    "id": "form.mdx#9",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "</AppOnly>\n\n- **`onSubmit`**: Can be used to handle form submission logic. However, calling `event.preventDefault()` will override `<Form>` behavior such as navigating to the specified URL.\n- **[`method`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form#method), [`encType`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form#enctype), [`target`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form#target)**: Are not supported as they override `<Form>` behavior.\n  - Similarly, `formMethod`, `formEncType`, and `formTarget` can be used to override the `method`, `encType`, and `target` props respectively, and using them will fallback to native browser behavior.\n  - If you need to use these props, use the HTML `<form>` element instead.\n- **`<input type=\"file\">`**: Using this input type when the `action` is a string will match browser behavior by submitting the filename instead of the file object.\n\n<AppOnly>"
  },
  {
    "id": "form.mdx#10",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "## Examples"
  },
  {
    "id": "form.mdx#11",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "### Search form that leads to a search result page\n\nYou can create a search form that navigates to a search results page by passing the path as an `action`:\n\n```tsx filename=\"/app/page.tsx\" switcher\nimport Form from 'next/form'\n\nexport default function Page() {\n  return (\n    <Form action=\"/search\">\n      <input name=\"query\" />\n      <button type=\"submit\">Submit</button>\n    </Form>\n  )\n}\n```\n\n```jsx filename=\"/app/page.js\" switcher\nimport Form from 'next/form'\n\nexport default function Page() {\n  return (\n    <Form action=\"/search\">\n      <input name=\"query\" />\n      <button type=\"submit\">Submit</button>\n    </Form>\n  )\n}"
  },
  {
    "id": "form.mdx#12",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "```\n\nWhen the user updates the query input field and submits the form, the form data will be encoded into the URL as search params, e.g. `/search?query=abc`.\n\n> **Good to know**: If you pass an empty string `\"\"` to `action`, the form will navigate to the same route with updated search params.\n\nOn the results page, you can access the query using the [`searchParams`](/docs/app/api-reference/file-conventions/page#searchparams-optional) `page.js` prop and use it to fetch data from an external source.\n\n```tsx filename=\"/app/search/page.tsx\" switcher\nimport { getSearchResults } from '@/lib/search'\n\nexport default async function SearchPage({\n  searchParams,\n}: {\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}) {\n  const results = await getSearchResults((await searchParams).query)\n\n  return <div>...</div>\n}\n```\n\n```jsx filename=\"/app/search/page.js\" switcher\nimport { getSearchResults } from '@/lib/search'\n\nexport default async function SearchPage({ searchParams }) {\n  const results = await getSearchResults((await searchParams).query)\n\n  return <div>...</div>\n}"
  },
  {
    "id": "form.mdx#13",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "```\n\nWhen the `<Form>` becomes visible in the user's viewport, shared UI (such as `layout.js` and `loading.js`) on the `/search` page will be prefetched. On submission, the form will immediately navigate to the new route and show loading UI while the results are being fetched. You can design the fallback UI using [`loading.js`](/docs/app/api-reference/file-conventions/loading):\n\n```tsx filename=\"/app/search/loading.tsx\" switcher\nexport default function Loading() {\n  return <div>Loading...</div>\n}\n```\n\n```jsx filename=\"/app/search/loading.js\" switcher\nexport default function Loading() {\n  return <div>Loading...</div>\n}\n```\n\nTo cover cases when shared UI hasn't yet loaded, you can show instant feedback to the user using [`useFormStatus`](https://react.dev/reference/react-dom/hooks/useFormStatus).\n\nFirst, create a component that displays a loading state when the form is pending:\n\n```tsx filename=\"/app/ui/search-button.tsx\" switcher\n'use client'\nimport { useFormStatus } from 'react-dom'\n\nexport default function SearchButton() {\n  const status = useFormStatus()\n  return (\n    <button type=\"submit\">{status.pending ? 'Searching...' : 'Search'}</button>\n  )\n}"
  },
  {
    "id": "form.mdx#14",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "```\n\n```jsx filename=\"/app/ui/search-button.js\" switcher\n'use client'\nimport { useFormStatus } from 'react-dom'\n\nexport default function SearchButton() {\n  const status = useFormStatus()\n  return (\n    <button type=\"submit\">{status.pending ? 'Searching...' : 'Search'}</button>\n  )\n}\n```\n\nThen, update the search form page to use the `SearchButton` component:\n\n```tsx filename=\"/app/page.tsx\" switcher\nimport Form from 'next/form'\nimport { SearchButton } from '@/ui/search-button'\n\nexport default function Page() {\n  return (\n    <Form action=\"/search\">\n      <input name=\"query\" />\n      <SearchButton />\n    </Form>\n  )\n}\n```\n\n```jsx filename=\"/app/ui/search-button.js\" switcher\nimport Form from 'next/form'\nimport { SearchButton } from '@/ui/search-button'\n\nexport default function Page() {\n  return (\n    <Form action=\"/search\">\n      <input name=\"query\" />\n      <SearchButton />\n    </Form>\n  )\n}\n```"
  },
  {
    "id": "form.mdx#15",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "### Mutations with Server Actions\n\nYou can perform mutations by passing a function to the `action` prop.\n\n```tsx filename=\"/app/posts/create/page.tsx\" switcher\nimport Form from 'next/form'\nimport { createPost } from '@/posts/actions'\n\nexport default function Page() {\n  return (\n    <Form action={createPost}>\n      <input name=\"title\" />\n      {/* ... */}\n      <button type=\"submit\">Create Post</button>\n    </Form>\n  )\n}\n```\n\n```jsx filename=\"/app/posts/create/page.js\" switcher\nimport Form from 'next/form'\nimport { createPost } from '@/posts/actions'\n\nexport default function Page() {\n  return (\n    <Form action={createPost}>\n      <input name=\"title\" />\n      {/* ... */}\n      <button type=\"submit\">Create Post</button>\n    </Form>\n  )\n}"
  },
  {
    "id": "form.mdx#16",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "```\n\nAfter a mutation, it's common to redirect to the new resource. You can use the [`redirect`](/docs/app/guides/redirecting) function from `next/navigation` to navigate to the new post page.\n\n> **Good to know**: Since the \"destination\" of the form submission is not known until the action is executed, `<Form>` cannot automatically prefetch shared UI.\n\n```tsx filename=\"/app/posts/actions.ts\" switcher\n'use server'\nimport { redirect } from 'next/navigation'\n\nexport async function createPost(formData: FormData) {\n  // Create a new post\n  // ...\n\n  // Redirect to the new post\n  redirect(`/posts/${data.id}`)\n}\n```\n\n```jsx filename=\"/app/posts/actions.js\" switcher\n'use server'\nimport { redirect } from 'next/navigation'\n\nexport async function createPost(formData) {\n  // Create a new post\n  // ...\n\n  // Redirect to the new post\n  redirect(`/posts/${data.id}`)\n}"
  },
  {
    "id": "form.mdx#17",
    "metadata": {
      "title": "Form Component",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "```\n\nThen, in the new page, you can fetch data using the `params` prop:\n\n```tsx filename=\"/app/posts/[id]/page.tsx\" switcher\nimport { getPost } from '@/posts/data'\n\nexport default async function PostPage({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n  const data = await getPost(id)\n\n  return (\n    <div>\n      <h1>{data.title}</h1>\n      {/* ... */}\n    </div>\n  )\n}\n```\n\n```jsx filename=\"/app/posts/[id]/page.js\" switcher\nimport { getPost } from '@/posts/data'\n\nexport default async function PostPage({ params }) {\n  const { id } = await params\n  const data = await getPost(id)\n\n  return (\n    <div>\n      <h1>{data.title}</h1>\n      {/* ... */}\n    </div>\n  )\n}\n```\n\nSee the [Server Actions](/docs/app/getting-started/updating-data) docs for more examples.\n\n</AppOnly>"
  },
  {
    "id": "image.mdx#0",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "---\ntitle: Image Component\ndescription: Optimize Images in your Next.js Application using the built-in `next/image` Component.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nThe Next.js Image component extends the HTML `<img>` element for automatic image optimization.\n\n```jsx filename=\"app/page.js\"\nimport Image from 'next/image'\n\nexport default function Page() {\n  return (\n    <Image\n      src=\"/profile.png\"\n      width={500}\n      height={500}\n      alt=\"Picture of the author\"\n    />\n  )\n}\n```\n\n<PagesOnly>\n\n> **Good to know**: If you are using a version of Next.js prior to 13, you'll want to use the [next/legacy/image](/docs/pages/api-reference/components/image-legacy) documentation since the component was renamed.\n\n</PagesOnly>"
  },
  {
    "id": "image.mdx#1",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "## Reference"
  },
  {
    "id": "image.mdx#2",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Props\n\nThe following props are available:"
  },
  {
    "id": "image.mdx#3",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "<div style={{ overflowX: 'auto', width: '100%' }}>\n| Prop                                      | Example                                  | Type            | Status     |\n| ----------------------------------------- | ---------------------------------------- | --------------- | ---------- |\n| [`src`](#src)                             | `src=\"/profile.png\"`                     | String          | Required   |\n| [`alt`](#alt)                             | `alt=\"Picture of the author\"`            | String          | Required   |\n| [`width`](#width-and-height)                         | `width={500}`                            | Integer (px)    | -   |\n| [`height`](#width-and-height)                       | `height={500}`                           | Integer (px)    | -   |\n| [`fill`](#fill)                           | `fill={true}`                            | Boolean         | -          |\n| [`loader`](#loader)                       | `loader={imageLoader}`                   | Function        | -          |\n| [`sizes`](#sizes)                         | `sizes=\"(max-width: 768px) 100vw, 33vw\"` | String          | -          |"
  },
  {
    "id": "image.mdx#4",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| [`sizes`](#sizes)                         | `sizes=\"(max-width: 768px) 100vw, 33vw\"` | String          | -          |\n| [`quality`](#quality)                     | `quality={80}`                           | Integer (1-100) | -          |\n| [`preload`](#preload)                     | `preload={true}`                         | Boolean         | -          |\n| [`placeholder`](#placeholder)             | `placeholder=\"blur\"`                     | String          | -          |\n| [`style`](#style)                         | `style={{objectFit: \"contain\"}}`         | Object          | -          |\n| [`onLoadingComplete`](#onloadingcomplete) | `onLoadingComplete={img => done())}`     | Function        | Deprecated |\n| [`onLoad`](#onload)                       | `onLoad={event => done())}`              | Function        | -          |\n| [`onError`](#onerror)                     | `onError(event => fail()}`               | Function        | -          |\n| [`loading`](#loading)                     | `loading=\"lazy\"`                         | String          | -          |\n| [`blurDataURL`](#blurdataurl)             | `blurDataURL=\"data:image/jpeg...\"`       | String          | -          |"
  },
  {
    "id": "image.mdx#5",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| [`blurDataURL`](#blurdataurl)             | `blurDataURL=\"data:image/jpeg...\"`       | String          | -          |\n| [`unoptimized`](#unoptimized)             | `unoptimized={true}`                     | Boolean         | -          |\n| [`overrideSrc`](#overridesrc)             | `overrideSrc=\"/seo.png\"`                 | String          | -          |\n| [`decoding`](#decoding)                   | `decoding=\"async\"`                       | String          | -          |\n</div>"
  },
  {
    "id": "image.mdx#6",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `src`\n\nThe source of the image. Can be one of the following:\n\nAn internal path string.\n\n```jsx\n<Image src=\"/profile.png\" />\n```\n\nAn absolute external URL (must be configured with [remotePatterns](#remotepatterns)).\n\n```jsx\n<Image src=\"https://example.com/profile.png\" />\n```\n\nA static import.\n\n```jsx\nimport profile from './profile.png'\n\nexport default function Page() {\n  return <Image src={profile} />\n}\n```\n\n> **Good to know**: For security reasons, the Image Optimization API using the default [loader](#loader) will _not_ forward headers when fetching the `src` image.\n> If the `src` image requires authentication, consider using the [unoptimized](#unoptimized) property to disable Image Optimization."
  },
  {
    "id": "image.mdx#7",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `alt`\n\nThe `alt` property is used to describe the image for screen readers and search engines. It is also the fallback text if images have been disabled or an error occurs while loading the image.\n\nIt should contain text that could replace the image [without changing the meaning of the page](https://html.spec.whatwg.org/multipage/images.html#general-guidelines). It is not meant to supplement the image and should not repeat information that is already provided in the captions above or below the image.\n\nIf the image is [purely decorative](https://html.spec.whatwg.org/multipage/images.html#a-purely-decorative-image-that-doesn't-add-any-information) or [not intended for the user](https://html.spec.whatwg.org/multipage/images.html#an-image-not-intended-for-the-user), the `alt` property should be an empty string (`alt=\"\"`).\n\n> Learn more about [image accessibility guidelines](https://html.spec.whatwg.org/multipage/images.html#alt)."
  },
  {
    "id": "image.mdx#8",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `width` and `height`\n\nThe `width` and `height` properties represent the [intrinsic](https://developer.mozilla.org/en-US/docs/Glossary/Intrinsic_Size) image size in pixels. This property is used to infer the correct **aspect ratio** used by browsers to reserve space for the image and avoid layout shift during loading. It does not determine the _rendered size_ of the image, which is controlled by CSS.\n\n```jsx\n<Image src=\"/profile.png\" width={500} height={500} />\n```\n\nYou **must** set both `width` and `height` properties unless:\n\n- The image is statically imported.\n- The image has the [`fill` property](#fill)\n\nIf the height and width are unknown, we recommend using the [`fill` property](#fill)."
  },
  {
    "id": "image.mdx#9",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `fill`\n\nA boolean that causes the image to expand to the size of the parent element.\n\n```js\n<Image src=\"/profile.png\" fill={true} />\n```\n\n**Positioning**:\n\n- The parent element **must** assign `position: \"relative\"`, `\"fixed\"`, `\"absolute\"`.\n- By default, the `<img>` element uses `position: \"absolute\"`.\n\n**Object Fit**:\n\nIf no styles are applied to the image, the image will stretch to fit the container. You can use `objectFit` to control cropping and scaling.\n\n- `\"contain\"`: The image will be scaled down to fit the container and preserve aspect ratio.\n- `\"cover\"`: The image will fill the container and be cropped.\n\n> Learn more about [`position`](https://developer.mozilla.org/en-US/docs/Web/CSS/position) and [`object-fit`](https://developer.mozilla.org/docs/Web/CSS/object-fit)."
  },
  {
    "id": "image.mdx#10",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `loader`\n\nA custom function used to generate the image URL. The function receives the following parameters, and returns a URL string for the image:\n\n- [`src`](#src)\n- [`width`](#width-and-height)\n- [`quality`](#quality)\n\n<AppOnly>\n\n```js\n'use client'\n\nimport Image from 'next/image'\n\nconst imageLoader = ({ src, width, quality }) => {\n  return `https://example.com/${src}?w=${width}&q=${quality || 75}`\n}\n\nexport default function Page() {\n  return (\n    <Image\n      loader={imageLoader}\n      src=\"me.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    />\n  )\n}\n```\n\n> **Good to know**: Using props like `onLoad`, which accept a function, requires using [Client Components](https://react.dev/reference/rsc/use-client) to serialize the provided function.\n\n</AppOnly>\n\n<PagesOnly>\n\n```js\nimport Image from 'next/image'\n\nconst imageLoader = ({ src, width, quality }) => {\n  return `https://example.com/${src}?w=${width}&q=${quality || 75}`\n}\n\nexport default function Page() {\n  return (\n    <Image\n      loader={imageLoader}\n      src=\"me.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    />\n  )\n}"
  },
  {
    "id": "image.mdx#11",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "```\n\n</PagesOnly>\n\nAlternatively, you can use the [loaderFile](#loaderfile) configuration in `next.config.js` to configure every instance of `next/image` in your application, without passing a prop."
  },
  {
    "id": "image.mdx#12",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `sizes`\n\nDefine the sizes of the image at different breakpoints. Used by the browser to choose the most appropriate size from the generated `srcset`.\n\n```jsx\nimport Image from 'next/image'\n\nexport default function Page() {\n  return (\n    <div className=\"grid-element\">\n      <Image\n        fill\n        src=\"/example.png\"\n        sizes=\"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw\"\n      />\n    </div>\n  )\n}\n```\n\n`sizes` should be used when:\n\n- The image is using the [`fill`](#fill) prop\n- CSS is used to make the image responsive\n\nIf `sizes` is missing, the browser assumes the image will be as wide as the viewport (`100vw`). This can cause unnecessarily large images to be downloaded.\n\nIn addition, `sizes` affects how `srcset` is generated:\n\n- Without `sizes`: Next.js generates a limited `srcset` (e.g. 1x, 2x), suitable for fixed-size images.\n- With `sizes`: Next.js generates a full `srcset` (e.g. 640w, 750w, etc.), optimized for responsive layouts.\n\n> Learn more about `srcset` and `sizes` on [web.dev](https://web.dev/learn/design/responsive-images/#sizes) and [mdn](https://developer.mozilla.org/docs/Web/HTML/Element/img#sizes)."
  },
  {
    "id": "image.mdx#13",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `quality`\n\nAn integer between `1` and `100` that sets the quality of the optimized image. Higher values increase file size and visual fidelity. Lower values reduce file size but may affect sharpness.\n\n```jsx\n// Default quality is 75\n<Image quality={75} />\n```\n\nIf you’ve configured [qualities](#qualities) in `next.config.js`, the value must match one of the allowed entries.\n\n> **Good to know**: If the original image is already low quality, setting a high quality value will increase the file size without improving appearance.\n\n#### `style`\n\nAllows passing CSS styles to the underlying image element.\n\n```jsx\nconst imageStyle = {\n  borderRadius: '50%',\n  border: '1px solid #fff',\n  width: '100px',\n  height: 'auto',\n}\n\nexport default function ProfileImage() {\n  return <Image src=\"...\" style={imageStyle} />\n}\n```\n\n> **Good to know**: If you’re using the `style` prop to set a custom width, be sure to also set `height: 'auto'` to preserve the image’s aspect ratio."
  },
  {
    "id": "image.mdx#14",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `preload`\n\nA boolean that indicates if the image should be preloaded.\n\n```jsx\n// Default preload is false\n<Image preload={false} />\n```\n\n- `true`: [Preloads](https://web.dev/preload-responsive-images/) the image by inserting a `<link>` in the `<head>`.\n- `false`: Does not preload the image.\n\n**When to use it:**\n\n- The image is the [Largest Contentful Paint (LCP)](https://nextjs.org/learn/seo/web-performance/lcp) element.\n- The image is above the fold, typically the hero image.\n- You want to begin loading the image in the `<head>`, before its discovered later in the `<body>`.\n\n**When not to use it:**\n\n- When you have multiple images that could be considered the [Largest Contentful Paint (LCP)](https://nextjs.org/learn/seo/web-performance/lcp) element depending on the viewport.\n- When the `loading` property is used.\n- When the `fetchPriority` property is used.\n\nIn most cases, you should use `loading=\"eager\"` or `fetchPriority=\"high\"` instead of `preload`.\n\n#### `priority`\n\nStarting with Next.js 16, the `priority` property has been deprecated in favor of the [`preload`](#preload) property in order to make the behavior clear."
  },
  {
    "id": "image.mdx#15",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `priority`\n\nStarting with Next.js 16, the `priority` property has been deprecated in favor of the [`preload`](#preload) property in order to make the behavior clear.\n\n#### `loading`\n\nControls when the image should start loading.\n\n```jsx\n// Defaults to lazy\n<Image loading=\"lazy\" />\n```\n\n- `lazy`: Defer loading the image until it reaches a calculated distance from the viewport.\n- `eager`: Load the image immediately, regardless of its position in the page.\n\nUse `eager` only when you want to ensure the image is loaded immediately.\n\n> Learn more about the [`loading` attribute](https://developer.mozilla.org/docs/Web/HTML/Element/img#loading)."
  },
  {
    "id": "image.mdx#16",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `placeholder`\n\nSpecifies a placeholder to use while the image is loading, improving the perceived loading performance.\n\n```jsx\n// defaults to empty\n<Image placeholder=\"empty\" />\n```\n\n- `empty`: No placeholder while the image is loading.\n- `blur`: Use a blurred version of the image as a placeholder. Must be used with the [`blurDataURL`](#blurdataurl) property.\n- `data:image/...`: Uses the [Data URL](https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/Data_URIs) as the placeholder.\n\n**Examples:**\n\n- [`blur` placeholder](https://image-component.nextjs.gallery/placeholder)\n- [Shimmer effect with data URL `placeholder` prop](https://image-component.nextjs.gallery/shimmer)\n- [Color effect with `blurDataURL` prop](https://image-component.nextjs.gallery/color)\n\n> Learn more about the [`placeholder` attribute](https://developer.mozilla.org/docs/Web/HTML/Element/img#placeholder)."
  },
  {
    "id": "image.mdx#17",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `blurDataURL`\n\nA [Data URL](https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/Data_URIs) to\nbe used as a placeholder image before the image successfully loads. Can be automatically set or used with the [`placeholder=\"blur\"`](#placeholder) property.\n\n```jsx\n<Image placeholder=\"blur\" blurDataURL=\"...\" />\n```\n\nThe image is automatically enlarged and blurred, so a very small image (10px or less) is recommended.\n\n**Automatic**\n\nIf `src` is a static import of a `jpg`, `png`, `webp`, or `avif` file, `blurDataURL` is added automatically—unless the image is animated.\n\n**Manually set**\n\nIf the image is dynamic or remote, you must provide `blurDataURL` yourself. To generate one, you can use:\n\n- [A online tool like png-pixel.com](https://png-pixel.com)\n- [A library like Plaiceholder](https://github.com/joe-bell/plaiceholder)\n\nA large blurDataURL may hurt performance. Keep it small and simple.\n\n**Examples:**\n\n- [Default `blurDataURL` prop](https://image-component.nextjs.gallery/placeholder)\n- [Color effect with `blurDataURL` prop](https://image-component.nextjs.gallery/color)"
  },
  {
    "id": "image.mdx#18",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `onLoad`\n\nA callback function that is invoked once the image is completely loaded and the [placeholder](#placeholder) has been removed.\n\n```jsx\n<Image onLoad={(e) => console.log(e.target.naturalWidth)} />\n```\n\nThe callback function will be called with one argument, the event which has a `target` that references the underlying `<img>` element.\n\n<AppOnly>\n\n> **Good to know**: Using props like `onLoad`, which accept a function, requires using [Client Components](https://react.dev/reference/rsc/use-client) to serialize the provided function.\n\n</AppOnly>\n\n#### `onError`\n\nA callback function that is invoked if the image fails to load.\n\n```jsx\n<Image onError={(e) => console.error(e.target.id)} />\n```\n\n<AppOnly>\n\n> **Good to know**: Using props like `onError`, which accept a function, requires using [Client Components](https://react.dev/reference/rsc/use-client) to serialize the provided function.\n\n</AppOnly>"
  },
  {
    "id": "image.mdx#19",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `unoptimized`\n\nA boolean that indicates if the image should be optimized. This is useful for images that do not benefit from optimization such as small images (less than 1KB), vector images (SVG), or animated images (GIF).\n\n```js\nimport Image from 'next/image'\n\nconst UnoptimizedImage = (props) => {\n  // Default is false\n  return <Image {...props} unoptimized />\n}\n```\n\n- `true`: The source image will be served as-is from the `src` instead of changing quality, size, or format.\n- `false`: The source image will be optimized.\n\nSince Next.js 12.3.0, this prop can be assigned to all images by updating `next.config.js` with the following configuration:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    unoptimized: true,\n  },\n}\n```"
  },
  {
    "id": "image.mdx#20",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `overrideSrc`\n\nWhen providing the `src` prop to the `<Image>` component, both the `srcset` and `src` attributes are generated automatically for the resulting `<img>`.\n\n```jsx filename=\"input.js\"\n<Image src=\"/profile.jpg\" />\n```\n\n```html filename=\"output.html\"\n<img\n  srcset=\"\n    /_next/image?url=%2Fprofile.jpg&w=640&q=75 1x,\n    /_next/image?url=%2Fprofile.jpg&w=828&q=75 2x\n  \"\n  src=\"/_next/image?url=%2Fprofile.jpg&w=828&q=75\"\n/>\n```\n\nIn some cases, it is not desirable to have the `src` attribute generated and you may wish to override it using the `overrideSrc` prop.\n\nFor example, when upgrading an existing website from `<img>` to `<Image>`, you may wish to maintain the same `src` attribute for SEO purposes such as image ranking or avoiding recrawl.\n\n```jsx filename=\"input.js\"\n<Image src=\"/profile.jpg\" overrideSrc=\"/override.jpg\" />\n```\n\n```html filename=\"output.html\"\n<img\n  srcset=\"\n    /_next/image?url=%2Fprofile.jpg&w=640&q=75 1x,\n    /_next/image?url=%2Fprofile.jpg&w=828&q=75 2x\n  \"\n  src=\"/override.jpg\"\n/>\n```"
  },
  {
    "id": "image.mdx#21",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `decoding`\n\nA hint to the browser indicating if it should wait for the image to be decoded before presenting other content updates or not.\n\n```jsx\n// Default is async\n<Image decoding=\"async\" />\n```\n\n- `async`: Asynchronously decode the image and allow other content to be rendered before it completes.\n- `sync`: Synchronously decode the image for atomic presentation with other content.\n- `auto`: No preference. The browser chooses the best approach.\n\n> Learn more about the [`decoding` attribute](https://developer.mozilla.org/docs/Web/HTML/Element/img#decoding)."
  },
  {
    "id": "image.mdx#22",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Other Props\n\nOther properties on the `<Image />` component will be passed to the underlying `img` element with the exception of the following:\n\n- `srcSet`: Use [Device Sizes](#devicesizes) instead.\n\n### Deprecated props\n\n#### `onLoadingComplete`\n\n> **Warning**: Deprecated in Next.js 14, use [`onLoad`](#onload) instead.\n\nA callback function that is invoked once the image is completely loaded and the [placeholder](#placeholder) has been removed.\n\nThe callback function will be called with one argument, a reference to the underlying `<img>` element.\n\n<AppOnly>\n\n```jsx\n'use client'\n\n<Image onLoadingComplete={(img) => console.log(img.naturalWidth)} />\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx\n<Image onLoadingComplete={(img) => console.log(img.naturalWidth)} />\n```\n\n</PagesOnly>\n\n<AppOnly>\n\n> **Good to know**: Using props like `onLoadingComplete`, which accept a function, requires using [Client Components](https://react.dev/reference/rsc/use-client) to serialize the provided function.\n\n</AppOnly>"
  },
  {
    "id": "image.mdx#23",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Configuration options\n\nYou can configure the Image Component in `next.config.js`. The following options are available:\n\n#### `localPatterns`\n\nUse `localPatterns` in your `next.config.js` file to allow images from specific local paths to be optimized and block all others.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    localPatterns: [\n      {\n        pathname: '/assets/images/**',\n        search: '',\n      },\n    ],\n  },\n}\n```\n\nThe example above will ensure the `src` property of `next/image` must start with `/assets/images/` and must not have a query string. Attempting to optimize any other path will respond with `400` Bad Request error.\n\n> **Good to know**: Omitting the `search` property allows all search parameters which could allow malicious actors to optimize URLs you did not intend. Try using a specific value like `search: '?v=2'` to ensure an exact match."
  },
  {
    "id": "image.mdx#24",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `remotePatterns`\n\nUse `remotePatterns` in your `next.config.js` file to allow images from specific external paths and block all others. This ensures that only external images from your account can be served.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    remotePatterns: [new URL('https://example.com/account123/**')],\n  },\n}\n```\n\nYou can also configure `remotePatterns` using the object:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 'example.com',\n        port: '',\n        pathname: '/account123/**',\n        search: '',\n      },\n    ],\n  },\n}"
  },
  {
    "id": "image.mdx#25",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "```\n\nThe example above will ensure the `src` property of `next/image` must start with `https://example.com/account123/` and must not have a query string. Any other protocol, hostname, port, or unmatched path will respond with `400` Bad Request.\n\n**Wildcard Patterns:**\n\nWildcard patterns can be used for both `pathname` and `hostname` and have the following syntax:\n\n- `*` match a single path segment or subdomain\n- `**` match any number of path segments at the end or subdomains at the beginning. This syntax does not work in the middle of the pattern.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: '**.example.com',\n        port: '',\n        search: '',\n      },\n    ],\n  },\n}"
  },
  {
    "id": "image.mdx#26",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "```\n\nThis allows subdomains like `image.example.com`. Query strings and custom ports are still blocked.\n\n> **Good to know**: When omitting `protocol`, `port`, `pathname`, or `search` then the wildcard `**` is implied. This is not recommended because it may allow malicious actors to optimize urls you did not intend.\n\n**Query Strings**:\n\nYou can also restrict query strings using the `search` property:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 'assets.example.com',\n        search: '?v=1727111025337',\n      },\n    ],\n  },\n}\n```\n\nThe example above will ensure the `src` property of `next/image` must start with `https://assets.example.com` and must have the exact query string `?v=1727111025337`. Any other protocol or query string will respond with `400` Bad Request."
  },
  {
    "id": "image.mdx#27",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `loaderFile`\n\n`loaderFiles` allows you to use a custom image optimization service instead of Next.js.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    loader: 'custom',\n    loaderFile: './my/image/loader.js',\n  },\n}\n```\n\nThe path must be relative to the project root. The file must export a default function that returns a URL string:\n\n<AppOnly>\n\n```js filename=\"my/image/loader.js\"\n'use client'\n\nexport default function myImageLoader({ src, width, quality }) {\n  return `https://example.com/${src}?w=${width}&q=${quality || 75}`\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```js filename=\"my/image/loader.js\"\nexport default function myImageLoader({ src, width, quality }) {\n  return `https://example.com/${src}?w=${width}&q=${quality || 75}`\n}\n```\n\n</PagesOnly>\n\n**Example:**\n\n- [Custom Image Loader Configuration](/docs/app/api-reference/config/next-config-js/images#example-loader-configuration)\n\n> Alternatively, you can use the [`loader` prop](#loader) to configure each instance of `next/image`."
  },
  {
    "id": "image.mdx#28",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `path`\n\nIf you want to change or prefix the default path for the Image Optimization API, you can do so with the `path` property. The default value for `path` is `/_next/image`.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    path: '/my-prefix/_next/image',\n  },\n}\n```\n\n#### `deviceSizes`\n\n`deviceSizes` allows you to specify a list of device width breakpoints. These widths are used when the `next/image` component uses [`sizes`](#sizes) prop to ensure the correct image is served for the user's device.\n\nIf no configuration is provided, the default below is used:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],\n  },\n}\n```"
  },
  {
    "id": "image.mdx#29",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `imageSizes`\n\n`imageSizes` allows you to specify a list of image widths. These widths are concatenated with the array of [device sizes](#devicesizes) to form the full array of sizes used to generate image [srcset](https://developer.mozilla.org/docs/Web/API/HTMLImageElement/srcset).\n\nIf no configuration is provided, the default below is used:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    imageSizes: [32, 48, 64, 96, 128, 256, 384],\n  },\n}\n```\n\n`imageSizes` is only used for images which provide a [`sizes`](#sizes) prop, which indicates that the image is less than the full width of the screen. Therefore, the sizes in `imageSizes` should all be smaller than the smallest size in `deviceSizes`."
  },
  {
    "id": "image.mdx#30",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `qualities`\n\n`qualities` allows you to specify a list of image quality values.\n\nIf not configuration is provided, the default below is used:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    qualities: [75],\n  },\n}\n```\n\n> **Good to know**: This field is required starting with Next.js 16 because unrestricted access could allow malicious actors to optimize more qualities than you intended.\n\nYou can add more image qualities to the allowlist, such as the following:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    qualities: [25, 50, 75, 100],\n  },\n}\n```\n\nIn the example above, only four qualities are allowed: 25, 50, 75, and 100.\n\nIf the [`quality`](#quality) prop does not match a value in this array, the closest allowed value will be used.\n\nIf the REST API is visited directly with a quality that does not match a value in this array, the server will return a 400 Bad Request response."
  },
  {
    "id": "image.mdx#31",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `formats`\n\n`formats` allows you to specify a list of image formats to be used.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    // Default\n    formats: ['image/webp'],\n  },\n}\n```\n\nNext.js automatically detects the browser's supported image formats via the request's `Accept` header in order to determine the best output format.\n\nIf the `Accept` header matches more than one of the configured formats, the first match in the array is used. Therefore, the array order matters. If there is no match (or the source image is animated), it will use the original image's format.\n\nYou can enable AVIF support, which will fallback to the original format of the src image if the browser [does not support AVIF](https://caniuse.com/avif):\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    formats: ['image/avif'],\n  },\n}"
  },
  {
    "id": "image.mdx#32",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "```\n\n> **Good to know**:\n>\n> - We still recommend using WebP for most use cases.\n> - AVIF generally takes 50% longer to encode but it compresses 20% smaller compared to WebP. This means that the first time an image is requested, it will typically be slower, but subsequent requests that are cached will be faster.\n> - If you self-host with a Proxy/CDN in front of Next.js, you must configure the Proxy to forward the `Accept` header."
  },
  {
    "id": "image.mdx#33",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `minimumCacheTTL`\n\n`minimumCacheTTL` allows you to configure the Time to Live (TTL) in seconds for cached optimized images. In many cases, it's better to use a [Static Image Import](/docs/app/getting-started/images#local-images) which will automatically hash the file contents and cache the image forever with a `Cache-Control` header of `immutable`.\n\nIf no configuration is provided, the default below is used.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    minimumCacheTTL: 14400, // 4 hours\n  },\n}\n```\n\nYou can increase the TTL to reduce the number of revalidations and potentially lower cost:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    minimumCacheTTL: 2678400, // 31 days\n  },\n}"
  },
  {
    "id": "image.mdx#34",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "```\n\nThe expiration (or rather Max Age) of the optimized image is defined by either the `minimumCacheTTL` or the upstream image `Cache-Control` header, whichever is larger.\n\nIf you need to change the caching behavior per image, you can configure [`headers`](/docs/app/api-reference/config/next-config-js/headers) to set the `Cache-Control` header on the upstream image (e.g. `/some-asset.jpg`, not `/_next/image` itself).\n\nThere is no mechanism to invalidate the cache at this time, so its best to keep `minimumCacheTTL` low. Otherwise you may need to manually change the [`src`](#src) prop or delete the cached file `<distDir>/cache/images`."
  },
  {
    "id": "image.mdx#35",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `disableStaticImages`\n\n`disableStaticImages` allows you to disable static image imports.\n\nThe default behavior allows you to import static files such as `import icon from './icon.png'` and then pass that to the `src` property. In some cases, you may wish to disable this feature if it conflicts with other plugins that expect the import to behave differently.\n\nYou can disable static image imports inside your `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    disableStaticImages: true,\n  },\n}\n```\n\n#### `maximumRedirects`\n\nThe default image optimization loader will follow HTTP redirects when fetching remote images up to 3 times.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    maximumRedirects: 3,\n  },\n}\n```\n\nYou can configure the number of redirects to follow when fetching remote images. Setting the value to `0` will disable following redirects.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    maximumRedirects: 0,\n  },\n}\n```"
  },
  {
    "id": "image.mdx#36",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `dangerouslyAllowLocalIP`\n\nIn rare cases when self-hosting Next.js on a private network, you may want to allow optimizing images from local IP addresses on the same network. This is not recommended for most users because it could allow malicious users to access content on your internal network.\n\nBy default, the value is false.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    dangerouslyAllowLocalIP: false,\n  },\n}\n```\n\nIf you need to optimize remote images hosted elsewhere in your local network, you can set the value to true.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    dangerouslyAllowLocalIP: true,\n  },\n}\n```"
  },
  {
    "id": "image.mdx#37",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `dangerouslyAllowSVG`\n\n`dangerouslyAllowSVG` allows you to serve SVG images.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    dangerouslyAllowSVG: true,\n  },\n}\n```\n\nBy default, Next.js does not optimize SVG images for a few reasons:\n\n- SVG is a vector format meaning it can be resized losslessly.\n- SVG has many of the same features as HTML/CSS, which can lead to vulnerabilities without proper [Content Security Policy (CSP) headers](/docs/app/api-reference/config/next-config-js/headers#content-security-policy).\n\nWe recommend using the [`unoptimized`](#unoptimized) prop when the [`src`](#src) prop is known to be SVG. This happens automatically when `src` ends with `\".svg\"`.\n\n```jsx\n<Image src=\"/my-image.svg\" unoptimized />\n```\n\nIn addition, it is strongly recommended to also set `contentDispositionType` to force the browser to download the image, as well as `contentSecurityPolicy` to prevent scripts embedded in the image from executing.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    dangerouslyAllowSVG: true,\n    contentDispositionType: 'attachment',\n    contentSecurityPolicy: \"default-src 'self'; script-src 'none'; sandbox;\",\n  },\n}\n```"
  },
  {
    "id": "image.mdx#38",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `contentDispositionType`\n\n`contentDispositionType` allows you to configure the [`Content-Disposition`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition#as_a_response_header_for_the_main_body) header.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    contentDispositionType: 'inline',\n  },\n}\n```"
  },
  {
    "id": "image.mdx#39",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "#### `contentSecurityPolicy`\n\n`contentSecurityPolicy` allows you to configure the [`Content-Security-Policy`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP) header for images. This is particularly important when using [`dangerouslyAllowSVG`](#dangerouslyallowsvg) to prevent scripts embedded in the image from executing.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    contentSecurityPolicy: \"default-src 'self'; script-src 'none'; sandbox;\",\n  },\n}\n```\n\nBy default, the [loader](#loader) sets the [`Content-Disposition`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition#as_a_response_header_for_the_main_body) header to `attachment` for added protection since the API can serve arbitrary remote images.\n\nThe default value is `attachment` which forces the browser to download the image when visiting directly. This is particularly important when [`dangerouslyAllowSVG`](#dangerouslyallowsvg) is true.\n\nYou can optionally configure `inline` to allow the browser to render the image when visiting directly, without downloading it."
  },
  {
    "id": "image.mdx#40",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Deprecated configuration options\n\n#### `domains`\n\n> **Warning**: Deprecated since Next.js 14 in favor of strict [`remotePatterns`](#remotepatterns) in order to protect your application from malicious users.\n\nSimilar to [`remotePatterns`](#remotepatterns), the `domains` configuration can be used to provide a list of allowed hostnames for external images. However, the `domains` configuration does not support wildcard pattern matching and it cannot restrict protocol, port, or pathname.\n\nSince most remote image servers are shared between multiple tenants, it's safer to use `remotePatterns` to ensure only the intended images are optimized.\n\nBelow is an example of the `domains` property in the `next.config.js` file:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    domains: ['assets.acme.com'],\n  },\n}\n```"
  },
  {
    "id": "image.mdx#41",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "## Functions\n\n### `getImageProps`\n\nThe `getImageProps` function can be used to get the props that would be passed to the underlying `<img>` element, and instead pass them to another component, style, canvas, etc.\n\n```jsx\nimport { getImageProps } from 'next/image'\n\nconst { props } = getImageProps({\n  src: 'https://example.com/image.jpg',\n  alt: 'A scenic mountain view',\n  width: 1200,\n  height: 800,\n})\n\nfunction ImageWithCaption() {\n  return (\n    <figure>\n      <img {...props} />\n      <figcaption>A scenic mountain view</figcaption>\n    </figure>\n  )\n}\n```\n\nThis also avoid calling React `useState()` so it can lead to better performance, but it cannot be used with the [`placeholder`](#placeholder) prop because the placeholder will never be removed."
  },
  {
    "id": "image.mdx#42",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "## Known browser bugs\n\nThis `next/image` component uses browser native [lazy loading](https://caniuse.com/loading-lazy-attr), which may fallback to eager loading for older browsers before Safari 15.4. When using the blur-up placeholder, older browsers before Safari 12 will fallback to empty placeholder. When using styles with `width`/`height` of `auto`, it is possible to cause [Layout Shift](https://web.dev/cls/) on older browsers before Safari 15 that don't [preserve the aspect ratio](https://caniuse.com/mdn-html_elements_img_aspect_ratio_computed_from_attributes). For more details, see [this MDN video](https://www.youtube.com/watch?v=4-d_SoCHeWE)."
  },
  {
    "id": "image.mdx#43",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "- [Safari 15 - 16.3](https://bugs.webkit.org/show_bug.cgi?id=243601) display a gray border while loading. Safari 16.4 [fixed this issue](https://webkit.org/blog/13966/webkit-features-in-safari-16-4/#:~:text=Now%20in%20Safari%2016.4%2C%20a%20gray%20line%20no%20longer%20appears%20to%20mark%20the%20space%20where%20a%20lazy%2Dloaded%20image%20will%20appear%20once%20it%E2%80%99s%20been%20loaded.). Possible solutions:\n  - Use CSS `@supports (font: -apple-system-body) and (-webkit-appearance: none) { img[loading=\"lazy\"] { clip-path: inset(0.6px) } }`\n  - Use [`loading=\"eager\"`](#loading) if the image is above the fold\n- [Firefox 67+](https://bugzilla.mozilla.org/show_bug.cgi?id=1556156) displays a white background while loading. Possible solutions:\n  - Enable [AVIF `formats`](#formats)\n  - Use [`placeholder`](#placeholder)"
  },
  {
    "id": "image.mdx#44",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "## Examples"
  },
  {
    "id": "image.mdx#45",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Styling images\n\nStyling the Image component is similar to styling a normal `<img>` element, but there are a few guidelines to keep in mind:\n\nUse `className` or `style`, not `styled-jsx`. In most cases, we recommend using the `className` prop. This can be an imported [CSS Module](/docs/app/getting-started/css), a [global stylesheet](/docs/app/getting-started/css#global-css), etc.\n\n```jsx\nimport styles from './styles.module.css'\n\nexport default function MyImage() {\n  return <Image className={styles.image} src=\"/my-image.png\" alt=\"My Image\" />\n}\n```\n\nYou can also use the `style` prop to assign inline styles.\n\n```jsx\nexport default function MyImage() {\n  return (\n    <Image style={{ borderRadius: '8px' }} src=\"/my-image.png\" alt=\"My Image\" />\n  )\n}\n```\n\nWhen using `fill`, the parent element must have `position: relative` or `display: block`. This is necessary for the proper rendering of the image element in that layout mode.\n\n```jsx\n<div style={{ position: 'relative' }}>\n  <Image fill src=\"/my-image.png\" alt=\"My Image\" />\n</div>\n```\n\nYou cannot use [styled-jsx](/docs/app/guides/css-in-js) because it's scoped to the current component (unless you mark the style as `global`)."
  },
  {
    "id": "image.mdx#46",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Responsive images with a static export\n\nWhen you import a static image, Next.js automatically sets its width and height based on the file. You can make the image responsive by setting the style:\n\n<Image\n  alt=\"Responsive image filling the width and height of its parent container\"\n  srcLight=\"/docs/light/responsive-image.png\"\n  srcDark=\"/docs/dark/responsive-image.png\"\n  width=\"1600\"\n  height=\"629\"\n/>\n\n```jsx\nimport Image from 'next/image'\nimport mountains from '../public/mountains.jpg'\n\nexport default function Responsive() {\n  return (\n    <div style={{ display: 'flex', flexDirection: 'column' }}>\n      <Image\n        alt=\"Mountains\"\n        // Importing an image will\n        // automatically set the width and height\n        src={mountains}\n        sizes=\"100vw\"\n        // Make the image display full width\n        // and preserve its aspect ratio\n        style={{\n          width: '100%',\n          height: 'auto',\n        }}\n      />\n    </div>\n  )\n}\n```"
  },
  {
    "id": "image.mdx#47",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Responsive images with a remote URL\n\nIf the source image is a dynamic or a remote URL, you must provide the width and height props so Next.js can calculate the aspect ratio:\n\n```jsx filename=\"components/page.js\"\nimport Image from 'next/image'\n\nexport default function Page({ photoUrl }) {\n  return (\n    <Image\n      src={photoUrl}\n      alt=\"Picture of the author\"\n      sizes=\"100vw\"\n      style={{\n        width: '100%',\n        height: 'auto',\n      }}\n      width={500}\n      height={300}\n    />\n  )\n}\n```\n\nTry it out:\n\n- [Demo the image responsive to viewport](https://image-component.nextjs.gallery/responsive)"
  },
  {
    "id": "image.mdx#48",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Responsive image with `fill`\n\nIf you don't know the aspect ratio of the image, you can add the [`fill` prop](#fill) with the `objectFit` prop set to `cover`. This will make the image fill the full width of its parent container.\n\n<Image\n  alt=\"Grid of images filling parent container width\"\n  srcLight=\"/docs/light/fill-container.png\"\n  srcDark=\"/docs/dark/fill-container.png\"\n  width=\"1600\"\n  height=\"529\"\n/>\n\n```jsx\nimport Image from 'next/image'\nimport mountains from '../public/mountains.jpg'\n\nexport default function Fill() {\n  return (\n    <div\n      style={{\n        display: 'grid',\n        gridGap: '8px',\n        gridTemplateColumns: 'repeat(auto-fit, minmax(400px, auto))',\n      }}\n    >\n      <div style={{ position: 'relative', width: '400px' }}>\n        <Image\n          alt=\"Mountains\"\n          src={mountains}\n          fill\n          sizes=\"(min-width: 808px) 50vw, 100vw\"\n          style={{\n            objectFit: 'cover', // cover, contain, none\n          }}\n        />\n      </div>\n      {/* And more images in the grid... */}\n    </div>\n  )\n}\n```"
  },
  {
    "id": "image.mdx#49",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Background Image\n\nUse the `fill` prop to make the image cover the entire screen area:\n\n<Image\n  alt=\"Background image taking full width and height of page\"\n  srcLight=\"/docs/light/background-image.png\"\n  srcDark=\"/docs/dark/background-image.png\"\n  width=\"1600\"\n  height=\"427\"\n/>\n\n```jsx\nimport Image from 'next/image'\nimport mountains from '../public/mountains.jpg'\n\nexport default function Background() {\n  return (\n    <Image\n      alt=\"Mountains\"\n      src={mountains}\n      placeholder=\"blur\"\n      quality={100}\n      fill\n      sizes=\"100vw\"\n      style={{\n        objectFit: 'cover',\n      }}\n    />\n  )\n}\n```\n\nFor examples of the Image component used with the various styles, see the [Image Component Demo](https://image-component.nextjs.gallery)."
  },
  {
    "id": "image.mdx#50",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Remote images\n\nTo use a remote image, the `src` property should be a URL string.\n\n```jsx filename=\"app/page.js\"\nimport Image from 'next/image'\n\nexport default function Page() {\n  return (\n    <Image\n      src=\"https://s3.amazonaws.com/my-bucket/profile.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    />\n  )\n}"
  },
  {
    "id": "image.mdx#51",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "```\n\nSince Next.js does not have access to remote files during the build process, you'll need to provide the [`width`](/docs/app/api-reference/components/image#width-and-height), [`height`](/docs/app/api-reference/components/image#width-and-height) and optional [`blurDataURL`](/docs/app/api-reference/components/image#blurdataurl) props manually.\n\nThe `width` and `height` attributes are used to infer the correct aspect ratio of image and avoid layout shift from the image loading in. The `width` and `height` do _not_ determine the rendered size of the image file.\n\nTo safely allow optimizing images, define a list of supported URL patterns in `next.config.js`. Be as specific as possible to prevent malicious usage. For example, the following configuration will only allow images from a specific AWS S3 bucket:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 's3.amazonaws.com',\n        port: '',\n        pathname: '/my-bucket/**',\n        search: '',\n      },\n    ],\n  },\n}\n```"
  },
  {
    "id": "image.mdx#52",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Theme detection\n\nIf you want to display a different image for light and dark mode, you can create a new component that wraps two `<Image>` components and reveals the correct one based on a CSS media query.\n\n```css filename=\"components/theme-image.module.css\"\n.imgDark {\n  display: none;\n}\n\n@media (prefers-color-scheme: dark) {\n  .imgLight {\n    display: none;\n  }\n  .imgDark {\n    display: unset;\n  }\n}\n```\n\n```tsx filename=\"components/theme-image.tsx\" switcher\nimport styles from './theme-image.module.css'\nimport Image, { ImageProps } from 'next/image'\n\ntype Props = Omit<ImageProps, 'src' | 'preload' | 'loading'> & {\n  srcLight: string\n  srcDark: string\n}\n\nconst ThemeImage = (props: Props) => {\n  const { srcLight, srcDark, ...rest } = props\n\n  return (\n    <>\n      <Image {...rest} src={srcLight} className={styles.imgLight} />\n      <Image {...rest} src={srcDark} className={styles.imgDark} />\n    </>\n  )\n}"
  },
  {
    "id": "image.mdx#53",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "```\n\n```jsx filename=\"components/theme-image.js\" switcher\nimport styles from './theme-image.module.css'\nimport Image from 'next/image'\n\nconst ThemeImage = (props) => {\n  const { srcLight, srcDark, ...rest } = props\n\n  return (\n    <>\n      <Image {...rest} src={srcLight} className={styles.imgLight} />\n      <Image {...rest} src={srcDark} className={styles.imgDark} />\n    </>\n  )\n}\n```\n\n> **Good to know**: The default behavior of `loading=\"lazy\"` ensures that only the correct image is loaded. You cannot use `preload` or `loading=\"eager\"` because that would cause both images to load. Instead, you can use [`fetchPriority=\"high\"`](https://developer.mozilla.org/docs/Web/API/HTMLImageElement/fetchPriority).\n\nTry it out:\n\n- [Demo light/dark mode theme detection](https://image-component.nextjs.gallery/theme)"
  },
  {
    "id": "image.mdx#54",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Art direction\n\nIf you want to display a different image for mobile and desktop, sometimes called [Art Direction](https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images#art_direction), you can provide different `src`, `width`, `height`, and `quality` props to `getImageProps()`.\n\n```jsx filename=\"app/page.js\"\nimport { getImageProps } from 'next/image'\n\nexport default function Home() {\n  const common = { alt: 'Art Direction Example', sizes: '100vw' }\n  const {\n    props: { srcSet: desktop },\n  } = getImageProps({\n    ...common,\n    width: 1440,\n    height: 875,\n    quality: 80,\n    src: '/desktop.jpg',\n  })\n  const {\n    props: { srcSet: mobile, ...rest },\n  } = getImageProps({\n    ...common,\n    width: 750,\n    height: 1334,\n    quality: 70,\n    src: '/mobile.jpg',\n  })\n\n  return (\n    <picture>\n      <source media=\"(min-width: 1000px)\" srcSet={desktop} />\n      <source media=\"(min-width: 500px)\" srcSet={mobile} />\n      <img {...rest} style={{ width: '100%', height: 'auto' }} />\n    </picture>\n  )\n}\n```"
  },
  {
    "id": "image.mdx#55",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "### Background CSS\n\nYou can even convert the `srcSet` string to the [`image-set()`](https://developer.mozilla.org/en-US/docs/Web/CSS/image/image-set) CSS function to optimize a background image.\n\n```jsx filename=\"app/page.js\"\nimport { getImageProps } from 'next/image'\n\nfunction getBackgroundImage(srcSet = '') {\n  const imageSet = srcSet\n    .split(', ')\n    .map((str) => {\n      const [url, dpi] = str.split(' ')\n      return `url(\"${url}\") ${dpi}`\n    })\n    .join(', ')\n  return `image-set(${imageSet})`\n}\n\nexport default function Home() {\n  const {\n    props: { srcSet },\n  } = getImageProps({ alt: '', width: 128, height: 128, src: '/img.png' })\n  const backgroundImage = getBackgroundImage(srcSet)\n  const style = { height: '100vh', width: '100vw', backgroundImage }\n\n  return (\n    <main style={style}>\n      <h1>Hello World</h1>\n    </main>\n  )\n}\n```"
  },
  {
    "id": "image.mdx#56",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "## Version History"
  },
  {
    "id": "image.mdx#57",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| Version    | Changes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |\n| ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |"
  },
  {
    "id": "image.mdx#58",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v16.0.0`  | `qualities` default configuration changed to `[75]`, `preload` prop added, `priority` prop deprecated, `dangerouslyAllowLocalIP` config added, `maximumRedirects` config added.                                                                                                                                                                                                                                                                                                            |\n| `v15.3.0`  | `remotePatterns` added support for array of `URL` objects.                                                                                                                                                                                                                                                                                                                                                                                                                                 |"
  },
  {
    "id": "image.mdx#59",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v15.0.0`  | `contentDispositionType` configuration default changed to `attachment`.                                                                                                                                                                                                                                                                                                                                                                                                                    |\n| `v14.2.23` | `qualities` configuration added.                                                                                                                                                                                                                                                                                                                                                                                                                                                           |"
  },
  {
    "id": "image.mdx#60",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v14.2.15` | `decoding` prop added and `localPatterns` configuration added.                                                                                                                                                                                                                                                                                                                                                                                                                             |\n| `v14.2.14` | `remotePatterns.search` prop added.                                                                                                                                                                                                                                                                                                                                                                                                                                                        |"
  },
  {
    "id": "image.mdx#61",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v14.2.0`  | `overrideSrc` prop added.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n| `v14.1.0`  | `getImageProps()` is stable.                                                                                                                                                                                                                                                                                                                                                                                                                                                               |"
  },
  {
    "id": "image.mdx#62",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v14.0.0`  | `onLoadingComplete` prop and `domains` config deprecated.                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n| `v13.4.14` | `placeholder` prop support for `data:/image...`                                                                                                                                                                                                                                                                                                                                                                                                                                            |"
  },
  {
    "id": "image.mdx#63",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v13.2.0`  | `contentDispositionType` configuration added.                                                                                                                                                                                                                                                                                                                                                                                                                                              |\n| `v13.0.6`  | `ref` prop added.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |"
  },
  {
    "id": "image.mdx#64",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v13.0.0`  | The `next/image` import was renamed to `next/legacy/image`. The `next/future/image` import was renamed to `next/image`. A [codemod is available](/docs/app/guides/upgrading/codemods#next-image-to-legacy-image) to safely and automatically rename your imports. `<span>` wrapper removed. `layout`, `objectFit`, `objectPosition`, `lazyBoundary`, `lazyRoot` props removed. `alt` is required. `onLoadingComplete` receives reference to `img` element. Built-in loader config removed. |\n| `v12.3.0`  | `remotePatterns` and `unoptimized` configuration is stable.                                                                                                                                                                                                                                                                                                                                                                                                                                |"
  },
  {
    "id": "image.mdx#65",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v12.2.0`  | Experimental `remotePatterns` and experimental `unoptimized` configuration added. `layout=\"raw\"` removed.                                                                                                                                                                                                                                                                                                                                                                                  |\n| `v12.1.1`  | `style` prop added. Experimental support for `layout=\"raw\"` added.                                                                                                                                                                                                                                                                                                                                                                                                                         |"
  },
  {
    "id": "image.mdx#66",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v12.1.0`  | `dangerouslyAllowSVG` and `contentSecurityPolicy` configuration added.                                                                                                                                                                                                                                                                                                                                                                                                                     |\n| `v12.0.9`  | `lazyRoot` prop added.                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |"
  },
  {
    "id": "image.mdx#67",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v12.0.0`  | `formats` configuration added.<br/>AVIF support added.<br/>Wrapper `<div>` changed to `<span>`.                                                                                                                                                                                                                                                                                                                                                                                            |\n| `v11.1.0`  | `onLoadingComplete` and `lazyBoundary` props added.                                                                                                                                                                                                                                                                                                                                                                                                                                        |"
  },
  {
    "id": "image.mdx#68",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v11.0.0`  | `src` prop support for static import.<br/>`placeholder` prop added.<br/>`blurDataURL` prop added.                                                                                                                                                                                                                                                                                                                                                                                          |\n| `v10.0.5`  | `loader` prop added.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |"
  },
  {
    "id": "image.mdx#69",
    "metadata": {
      "title": "Image Component",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "| `v10.0.1`  | `layout` prop added.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |\n| `v10.0.0`  | `next/image` introduced.                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Components",
      "description": "API Reference for Next.js built-in components."
    },
    "content": "---\ntitle: Components\ndescription: API Reference for Next.js built-in components.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "link.mdx#0",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "---\ntitle: Link Component\ndescription: Enable fast client-side navigation with the built-in `next/link` component.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n`<Link>` is a React component that extends the HTML `<a>` element to provide [prefetching](/docs/app/getting-started/linking-and-navigating#prefetching) and client-side navigation between routes. It is the primary way to navigate between routes in Next.js.\n\nBasic usage:\n\n<AppOnly>\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return <Link href=\"/dashboard\">Dashboard</Link>\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return <Link href=\"/dashboard\">Dashboard</Link>\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return <Link href=\"/dashboard\">Dashboard</Link>\n}"
  },
  {
    "id": "link.mdx#1",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return <Link href=\"/dashboard\">Dashboard</Link>\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return <Link href=\"/dashboard\">Dashboard</Link>\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "link.mdx#2",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "## Reference\n\nThe following props can be passed to the `<Link>` component:\n\n<PagesOnly>\n\n| Prop                        | Example                  | Type              | Required |\n| --------------------------- | ------------------------ | ----------------- | -------- |\n| [`href`](#href-required)    | `href=\"/dashboard\"`      | String or Object  | Yes      |\n| [`as`](#as)                 | `as=\"/post/abc\"`         | String or Object  | -        |\n| [`replace`](#replace)       | `replace={false}`        | Boolean           | -        |\n| [`scroll`](#scroll)         | `scroll={false}`         | Boolean           | -        |\n| [`prefetch`](#prefetch)     | `prefetch={false}`       | Boolean           | -        |\n| [`shallow`](#shallow)       | `shallow={false}`        | Boolean           | -        |\n| [`locale`](#locale)         | `locale=\"fr\"`            | String or Boolean | -        |\n| [`onNavigate`](#onnavigate) | `onNavigate={(e) => {}}` | Function          | -        |\n\n</PagesOnly>\n\n<AppOnly>"
  },
  {
    "id": "link.mdx#3",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "</PagesOnly>\n\n<AppOnly>\n\n| Prop                        | Example                  | Type             | Required |\n| --------------------------- | ------------------------ | ---------------- | -------- |\n| [`href`](#href-required)    | `href=\"/dashboard\"`      | String or Object | Yes      |\n| [`replace`](#replace)       | `replace={false}`        | Boolean          | -        |\n| [`scroll`](#scroll)         | `scroll={false}`         | Boolean          | -        |\n| [`prefetch`](#prefetch)     | `prefetch={false}`       | Boolean or null  | -        |\n| [`onNavigate`](#onnavigate) | `onNavigate={(e) => {}}` | Function         | -        |\n\n</AppOnly>\n\n> **Good to know**: `<a>` tag attributes such as `className` or `target=\"_blank\"` can be added to `<Link>` as props and will be passed to the underlying `<a>` element."
  },
  {
    "id": "link.mdx#4",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### `href` (required)\n\nThe path or URL to navigate to.\n\n<AppOnly>\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Link from 'next/link'\n\n// Navigate to /about?name=test\nexport default function Page() {\n  return (\n    <Link\n      href={{\n        pathname: '/about',\n        query: { name: 'test' },\n      }}\n    >\n      About\n    </Link>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport Link from 'next/link'\n\n// Navigate to /about?name=test\nexport default function Page() {\n  return (\n    <Link\n      href={{\n        pathname: '/about',\n        query: { name: 'test' },\n      }}\n    >\n      About\n    </Link>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Link from 'next/link'\n\n// Navigate to /about?name=test\nexport default function Home() {\n  return (\n    <Link\n      href={{\n        pathname: '/about',\n        query: { name: 'test' },\n      }}\n    >\n      About\n    </Link>\n  )\n}"
  },
  {
    "id": "link.mdx#5",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Link from 'next/link'\n\n// Navigate to /about?name=test\nexport default function Home() {\n  return (\n    <Link\n      href={{\n        pathname: '/about',\n        query: { name: 'test' },\n      }}\n    >\n      About\n    </Link>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "link.mdx#6",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### `replace`\n\n**Defaults to `false`.** When `true`, `next/link` will replace the current history state instead of adding a new URL into the [browser's history](https://developer.mozilla.org/docs/Web/API/History_API) stack.\n\n<AppOnly>\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link href=\"/dashboard\" replace>\n      Dashboard\n    </Link>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link href=\"/dashboard\" replace>\n      Dashboard\n    </Link>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/dashboard\" replace>\n      Dashboard\n    </Link>\n  )\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/dashboard\" replace>\n      Dashboard\n    </Link>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "link.mdx#7",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### `scroll`\n\n**Defaults to `true`.** The default scrolling behavior of `<Link>` in Next.js **is to maintain scroll position**, similar to how browsers handle back and forwards navigation. When you navigate to a new [Page](/docs/app/api-reference/file-conventions/page), scroll position will stay the same as long as the Page is visible in the viewport. However, if the Page is not visible in the viewport, Next.js will scroll to the top of the first Page element.\n\nWhen `scroll = {false}`, Next.js will not attempt to scroll to the first Page element.\n\n> **Good to know**: Next.js checks if `scroll: false` before managing scroll behavior. If scrolling is enabled, it identifies the relevant DOM node for navigation and inspects each top-level element. All non-scrollable elements and those without rendered HTML are bypassed, this includes sticky or fixed positioned elements, and non-visible elements such as those calculated with `getBoundingClientRect`. Next.js then continues through siblings until it identifies a scrollable element that is visible in the viewport.\n\n<AppOnly>\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Link from 'next/link'"
  },
  {
    "id": "link.mdx#8",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "<AppOnly>\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link href=\"/dashboard\" scroll={false}>\n      Dashboard\n    </Link>\n  )\n}"
  },
  {
    "id": "link.mdx#9",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link href=\"/dashboard\" scroll={false}>\n      Dashboard\n    </Link>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/dashboard\" scroll={false}>\n      Dashboard\n    </Link>\n  )\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/dashboard\" scroll={false}>\n      Dashboard\n    </Link>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "link.mdx#10",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### `prefetch`\n\n<AppOnly>\n\nPrefetching happens when a `<Link />` component enters the user's viewport (initially or through scroll). Next.js prefetches and loads the linked route (denoted by the `href`) and its data in the background to improve the performance of client-side navigations. If the prefetched data has expired by the time the user hovers over a `<Link />`, Next.js will attempt to prefetch it again. **Prefetching is only enabled in production**.\n\nThe following values can be passed to the `prefetch` prop:\n\n- **`\"auto\"` or `null` (default)**: Prefetch behavior depends on whether the route is static or dynamic. For static routes, the full route will be prefetched (including all its data). For dynamic routes, the partial route down to the nearest segment with a [`loading.js`](/docs/app/api-reference/file-conventions/loading#instant-loading-states) boundary will be prefetched.\n- `true`: The full route will be prefetched for both static and dynamic routes.\n- `false`: Prefetching will never happen both on entering the viewport and on hover.\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Link from 'next/link'"
  },
  {
    "id": "link.mdx#11",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```tsx filename=\"app/page.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link href=\"/dashboard\" prefetch={false}>\n      Dashboard\n    </Link>\n  )\n}"
  },
  {
    "id": "link.mdx#12",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link href=\"/dashboard\" prefetch={false}>\n      Dashboard\n    </Link>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nPrefetching happens when a `<Link />` component enters the user's viewport (initially or through scroll). Next.js prefetches and loads the linked route (denoted by the `href`) and data in the background to improve the performance of client-side navigation's. **Prefetching is only enabled in production**.\n\nThe following values can be passed to the `prefetch` prop:\n\n- **`true` (default)**: The full route and its data will be prefetched.\n- `false`: Prefetching will not happen when entering the viewport, but will happen on hover. If you want to completely remove fetching on hover as well, consider using an `<a>` tag or [incrementally adopting](/docs/app/guides/migrating/app-router-migration) the App Router, which enables disabling prefetching on hover too.\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/dashboard\" prefetch={false}>\n      Dashboard\n    </Link>\n  )\n}"
  },
  {
    "id": "link.mdx#13",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/dashboard\" prefetch={false}>\n      Dashboard\n    </Link>\n  )\n}\n```"
  },
  {
    "id": "link.mdx#14",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### `shallow`\n\nUpdate the path of the current page without rerunning [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props), [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props) or [`getInitialProps`](/docs/pages/api-reference/functions/get-initial-props). Defaults to `false`.\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/dashboard\" shallow={false}>\n      Dashboard\n    </Link>\n  )\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/dashboard\" shallow={false}>\n      Dashboard\n    </Link>\n  )\n}\n```"
  },
  {
    "id": "link.mdx#15",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### `locale`\n\nThe active locale is automatically prepended. `locale` allows for providing a different locale. When `false` `href` has to include the locale as the default behavior is disabled.\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <>\n      {/* Default behavior: locale is prepended */}\n      <Link href=\"/dashboard\">Dashboard (with locale)</Link>\n\n      {/* Disable locale prepending */}\n      <Link href=\"/dashboard\" locale={false}>\n        Dashboard (without locale)\n      </Link>\n\n      {/* Specify a different locale */}\n      <Link href=\"/dashboard\" locale=\"fr\">\n        Dashboard (French)\n      </Link>\n    </>\n  )\n}"
  },
  {
    "id": "link.mdx#16",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <>\n      {/* Default behavior: locale is prepended */}\n      <Link href=\"/dashboard\">Dashboard (with locale)</Link>\n\n      {/* Disable locale prepending */}\n      <Link href=\"/dashboard\" locale={false}>\n        Dashboard (without locale)\n      </Link>\n\n      {/* Specify a different locale */}\n      <Link href=\"/dashboard\" locale=\"fr\">\n        Dashboard (French)\n      </Link>\n    </>\n  )\n}\n```"
  },
  {
    "id": "link.mdx#17",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### `as`\n\nOptional decorator for the path that will be shown in the browser URL bar. Before Next.js 9.5.3 this was used for dynamic routes, check our [previous docs](https://github.com/vercel/next.js/blob/v9.5.2/docs/api-reference/next/link.md#dynamic-routes) to see how it worked.\n\nWhen this path differs from the one provided in `href` the previous `href`/`as` behavior is used as shown in the [previous docs](https://github.com/vercel/next.js/blob/v9.5.2/docs/api-reference/next/link.md#dynamic-routes).\n\n</PagesOnly>"
  },
  {
    "id": "link.mdx#18",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### `onNavigate`\n\nAn event handler called during client-side navigation. The handler receives an event object that includes a `preventDefault()` method, allowing you to cancel the navigation if needed.\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link\n      href=\"/dashboard\"\n      onNavigate={(e) => {\n        // Only executes during SPA navigation\n        console.log('Navigating...')\n\n        // Optionally prevent navigation\n        // e.preventDefault()\n      }}\n    >\n      Dashboard\n    </Link>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link\n      href=\"/dashboard\"\n      onNavigate={(e) => {\n        // Only executes during SPA navigation\n        console.log('Navigating...')\n\n        // Optionally prevent navigation\n        // e.preventDefault()\n      }}\n    >\n      Dashboard\n    </Link>\n  )\n}"
  },
  {
    "id": "link.mdx#19",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n> **Good to know**: While `onClick` and `onNavigate` may seem similar, they serve different purposes. `onClick` executes for all click events, while `onNavigate` only runs during client-side navigation. Some key differences:\n>\n> - When using modifier keys (`Ctrl`/`Cmd` + Click), `onClick` executes but `onNavigate` doesn't since Next.js prevents default navigation for new tabs.\n> - External URLs won't trigger `onNavigate` since it's only for client-side and same-origin navigations.\n> - Links with the `download` attribute will work with `onClick` but not `onNavigate` since the browser will treat the linked URL as a download."
  },
  {
    "id": "link.mdx#20",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "## Examples\n\nThe following examples demonstrate how to use the `<Link>` component in different scenarios.\n\n<AppOnly>\n\n### Linking to dynamic route segments\n\nWhen linking to [dynamic segments](/docs/app/api-reference/file-conventions/dynamic-routes), you can use [template literals and interpolation](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Template_literals) to generate a list of links. For example, to generate a list of blog posts:\n\n```tsx filename=\"app/blog/post-list.tsx\" switcher\nimport Link from 'next/link'\n\ninterface Post {\n  id: number\n  title: string\n  slug: string\n}\n\nexport default function PostList({ posts }: { posts: Post[] }) {\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.id}>\n          <Link href={`/blog/${post.slug}`}>{post.title}</Link>\n        </li>\n      ))}\n    </ul>\n  )\n}\n```\n\n```jsx filename=\"app/blog/post-list.js\" switcher\nimport Link from 'next/link'\n\nexport default function PostList({ posts }) {\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.id}>\n          <Link href={`/blog/${post.slug}`}>{post.title}</Link>\n        </li>\n      ))}\n    </ul>\n  )\n}\n```"
  },
  {
    "id": "link.mdx#21",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### Checking active links\n\nYou can use [`usePathname()`](/docs/app/api-reference/functions/use-pathname) to determine if a link is active. For example, to add a class to the active link, you can check if the current `pathname` matches the `href` of the link:\n\n```tsx filename=\"app/ui/nav-links.tsx\" switcher\n'use client'\n\nimport { usePathname } from 'next/navigation'\nimport Link from 'next/link'\n\nexport function Links() {\n  const pathname = usePathname()\n\n  return (\n    <nav>\n      <Link className={`link ${pathname === '/' ? 'active' : ''}`} href=\"/\">\n        Home\n      </Link>\n\n      <Link\n        className={`link ${pathname === '/about' ? 'active' : ''}`}\n        href=\"/about\"\n      >\n        About\n      </Link>\n    </nav>\n  )\n}"
  },
  {
    "id": "link.mdx#22",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```jsx filename=\"app/ui/nav-links.js\" switcher\n'use client'\n\nimport { usePathname } from 'next/navigation'\nimport Link from 'next/link'\n\nexport function Links() {\n  const pathname = usePathname()\n\n  return (\n    <nav>\n      <Link className={`link ${pathname === '/' ? 'active' : ''}`} href=\"/\">\n        Home\n      </Link>\n\n      <Link\n        className={`link ${pathname === '/about' ? 'active' : ''}`}\n        href=\"/about\"\n      >\n        About\n      </Link>\n    </nav>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "link.mdx#23",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### Linking to dynamic route segments\n\nFor [dynamic route segments](/docs/pages/building-your-application/routing/dynamic-routes#convention), it can be handy to use template literals to create the link's path.\n\nFor example, you can generate a list of links to the dynamic route `pages/blog/[slug].js`\n\n```tsx filename=\"pages/blog/index.tsx\" switcher\nimport Link from 'next/link'\n\nfunction Posts({ posts }) {\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.id}>\n          <Link href={`/blog/${post.slug}`}>{post.title}</Link>\n        </li>\n      ))}\n    </ul>\n  )\n}\n```\n\n```jsx filename=\"pages/blog/index.js\" switcher\nimport Link from 'next/link'\n\nfunction Posts({ posts }) {\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.id}>\n          <Link href={`/blog/${post.slug}`}>{post.title}</Link>\n        </li>\n      ))}\n    </ul>\n  )\n}\n\nexport default Posts\n```\n\n</PagesOnly>"
  },
  {
    "id": "link.mdx#24",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### Scrolling to an `id`\n\nIf you'd like to scroll to a specific `id` on navigation, you can append your URL with a `#` hash link or just pass a hash link to the `href` prop. This is possible since `<Link>` renders to an `<a>` element.\n\n```jsx\n<Link href=\"/dashboard#settings\">Settings</Link>\n\n// Output\n<a href=\"/dashboard#settings\">Settings</a>\n```\n\n<AppOnly>\n\n> **Good to know**:\n>\n> - Next.js will scroll to the [Page](/docs/app/api-reference/file-conventions/page) if it is not visible in the viewport upon navigation.\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "link.mdx#25",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### Passing a URL Object\n\n`Link` can also receive a URL object and it will automatically format it to create the URL string:\n\n```tsx filename=\"pages/index.ts\" switcher\nimport Link from 'next/link'\n\nfunction Home() {\n  return (\n    <ul>\n      <li>\n        <Link\n          href={{\n            pathname: '/about',\n            query: { name: 'test' },\n          }}\n        >\n          About us\n        </Link>\n      </li>\n      <li>\n        <Link\n          href={{\n            pathname: '/blog/[slug]',\n            query: { slug: 'my-post' },\n          }}\n        >\n          Blog Post\n        </Link>\n      </li>\n    </ul>\n  )\n}\n\nexport default Home\n```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Link from 'next/link'\n\nfunction Home() {\n  return (\n    <ul>\n      <li>\n        <Link\n          href={{\n            pathname: '/about',\n            query: { name: 'test' },\n          }}\n        >\n          About us\n        </Link>\n      </li>\n      <li>\n        <Link\n          href={{\n            pathname: '/blog/[slug]',\n            query: { slug: 'my-post' },\n          }}\n        >\n          Blog Post\n        </Link>\n      </li>\n    </ul>\n  )\n}\n\nexport default Home"
  },
  {
    "id": "link.mdx#26",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\nThe above example has a link to:\n\n- A predefined route: `/about?name=test`\n- A [dynamic route](/docs/pages/building-your-application/routing/dynamic-routes#convention): `/blog/my-post`\n\nYou can use every property as defined in the [Node.js URL module documentation](https://nodejs.org/api/url.html#url_url_strings_and_url_objects).\n\n</PagesOnly>"
  },
  {
    "id": "link.mdx#27",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### Replace the URL instead of push\n\nThe default behavior of the `Link` component is to `push` a new URL into the `history` stack. You can use the `replace` prop to prevent adding a new entry, as in the following example:\n\n<AppOnly>\n\n```tsx filename=\"app/page.js\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link href=\"/about\" replace>\n      About us\n    </Link>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link href=\"/about\" replace>\n      About us\n    </Link>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/index.js\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/about\" replace>\n      About us\n    </Link>\n  )\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/about\" replace>\n      About us\n    </Link>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "link.mdx#28",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### Disable scrolling to the top of the page\n\n<AppOnly>\n\nThe default scrolling behavior of `<Link>` in Next.js **is to maintain scroll position**, similar to how browsers handle back and forwards navigation. When you navigate to a new [Page](/docs/app/api-reference/file-conventions/page), scroll position will stay the same as long as the Page is visible in the viewport.\n\nHowever, if the Page is not visible in the viewport, Next.js will scroll to the top of the first Page element. If you'd like to disable this behavior, you can pass `scroll={false}` to the `<Link>` component, or `scroll: false` to `router.push()` or `router.replace()`.\n\n```jsx filename=\"app/page.js\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link href=\"/#hashid\" scroll={false}>\n      Disables scrolling to the top\n    </Link>\n  )\n}\n```\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Page() {\n  return (\n    <Link href=\"/#hashid\" scroll={false}>\n      Disables scrolling to the top\n    </Link>\n  )\n}"
  },
  {
    "id": "link.mdx#29",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\nUsing `router.push()` or `router.replace()`:\n\n```jsx\n// useRouter\nimport { useRouter } from 'next/navigation'\n\nconst router = useRouter()\n\nrouter.push('/dashboard', { scroll: false })\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nThe default behavior of `Link` is to scroll to the top of the page. When there is a hash defined it will scroll to the specific id, like a normal `<a>` tag. To prevent scrolling to the top / hash `scroll={false}` can be added to `Link`:\n\n```jsx filename=\"pages/index.js\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/#hashid\" scroll={false}>\n      Disables scrolling to the top\n    </Link>\n  )\n}\n```\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Home() {\n  return (\n    <Link href=\"/#hashid\" scroll={false}>\n      Disables scrolling to the top\n    </Link>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "link.mdx#30",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### Prefetching links in Proxy\n\nIt's common to use [Proxy](/docs/app/api-reference/file-conventions/proxy) for authentication or other purposes that involve rewriting the user to a different page. In order for the `<Link />` component to properly prefetch links with rewrites via Proxy, you need to tell Next.js both the URL to display and the URL to prefetch. This is required to avoid un-necessary fetches to proxy to know the correct route to prefetch.\n\nFor example, if you want to serve a `/dashboard` route that has authenticated and visitor views, you can add the following in your Proxy to redirect the user to the correct page:\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextResponse } from 'next/server'\n\nexport function proxy(request: Request) {\n  const nextUrl = request.nextUrl\n  if (nextUrl.pathname === '/dashboard') {\n    if (request.cookies.authToken) {\n      return NextResponse.rewrite(new URL('/auth/dashboard', request.url))\n    } else {\n      return NextResponse.rewrite(new URL('/public/dashboard', request.url))\n    }\n  }\n}"
  },
  {
    "id": "link.mdx#31",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\n\nexport function proxy(request) {\n  const nextUrl = request.nextUrl\n  if (nextUrl.pathname === '/dashboard') {\n    if (request.cookies.authToken) {\n      return NextResponse.rewrite(new URL('/auth/dashboard', request.url))\n    } else {\n      return NextResponse.rewrite(new URL('/public/dashboard', request.url))\n    }\n  }\n}\n```\n\nIn this case, you would want to use the following code in your `<Link />` component:\n\n<AppOnly>\n\n```tsx filename=\"app/page.tsx\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport useIsAuthed from './hooks/useIsAuthed' // Your auth hook\n\nexport default function Page() {\n  const isAuthed = useIsAuthed()\n  const path = isAuthed ? '/auth/dashboard' : '/public/dashboard'\n  return (\n    <Link as=\"/dashboard\" href={path}>\n      Dashboard\n    </Link>\n  )\n}"
  },
  {
    "id": "link.mdx#32",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```js filename=\"app/page.js\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport useIsAuthed from './hooks/useIsAuthed' // Your auth hook\n\nexport default function Page() {\n  const isAuthed = useIsAuthed()\n  const path = isAuthed ? '/auth/dashboard' : '/public/dashboard'\n  return (\n    <Link as=\"/dashboard\" href={path}>\n      Dashboard\n    </Link>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```tsx filename=\"pages/index.tsx\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport useIsAuthed from './hooks/useIsAuthed' // Your auth hook\n\nexport default function Home() {\n  const isAuthed = useIsAuthed()\n  const path = isAuthed ? '/auth/dashboard' : '/public/dashboard'\n  return (\n    <Link as=\"/dashboard\" href={path}>\n      Dashboard\n    </Link>\n  )\n}\n```\n\n```js filename=\"pages/index.js\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport useIsAuthed from './hooks/useIsAuthed' // Your auth hook\n\nexport default function Home() {\n  const isAuthed = useIsAuthed()\n  const path = isAuthed ? '/auth/dashboard' : '/public/dashboard'\n  return (\n    <Link as=\"/dashboard\" href={path}>\n      Dashboard\n    </Link>\n  )\n}"
  },
  {
    "id": "link.mdx#33",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n> **Good to know**: If you're using [Dynamic Routes](/docs/pages/building-your-application/routing/dynamic-routes#convention), you'll need to adapt your `as` and `href` props. For example, if you have a Dynamic Route like `/dashboard/authed/[user]` that you want to present differently via proxy, you would write: `<Link href={{ pathname: '/dashboard/authed/[user]', query: { user: username } }} as=\"/dashboard/[user]\">Profile</Link>`.\n\n</PagesOnly>\n\n<AppOnly>"
  },
  {
    "id": "link.mdx#34",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "### Blocking navigation\n\nYou can use the `onNavigate` prop to block navigation when certain conditions are met, such as when a form has unsaved changes. When you need to block navigation across multiple components in your app (like preventing navigation from any link while a form is being edited), React Context provides a clean way to share this blocking state. First, create a context to track the navigation blocking state:\n\n```tsx filename=\"app/contexts/navigation-blocker.tsx\" switcher\n'use client'\n\nimport { createContext, useState, useContext } from 'react'\n\ninterface NavigationBlockerContextType {\n  isBlocked: boolean\n  setIsBlocked: (isBlocked: boolean) => void\n}\n\nexport const NavigationBlockerContext =\n  createContext<NavigationBlockerContextType>({\n    isBlocked: false,\n    setIsBlocked: () => {},\n  })\n\nexport function NavigationBlockerProvider({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  const [isBlocked, setIsBlocked] = useState(false)\n\n  return (\n    <NavigationBlockerContext.Provider value={{ isBlocked, setIsBlocked }}>\n      {children}\n    </NavigationBlockerContext.Provider>\n  )\n}"
  },
  {
    "id": "link.mdx#35",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "return (\n    <NavigationBlockerContext.Provider value={{ isBlocked, setIsBlocked }}>\n      {children}\n    </NavigationBlockerContext.Provider>\n  )\n}\n\nexport function useNavigationBlocker() {\n  return useContext(NavigationBlockerContext)\n}"
  },
  {
    "id": "link.mdx#36",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```jsx filename=\"app/contexts/navigation-blocker.js\" switcher\n'use client'\n\nimport { createContext, useState, useContext } from 'react'\n\nexport const NavigationBlockerContext = createContext({\n  isBlocked: false,\n  setIsBlocked: () => {},\n})\n\nexport function NavigationBlockerProvider({ children }) {\n  const [isBlocked, setIsBlocked] = useState(false)\n\n  return (\n    <NavigationBlockerContext.Provider value={{ isBlocked, setIsBlocked }}>\n      {children}\n    </NavigationBlockerContext.Provider>\n  )\n}\n\nexport function useNavigationBlocker() {\n  return useContext(NavigationBlockerContext)\n}\n```\n\nCreate a form component that uses the context:\n\n```tsx filename=\"app/components/form.tsx\" switcher\n'use client'\n\nimport { useNavigationBlocker } from '../contexts/navigation-blocker'\n\nexport default function Form() {\n  const { setIsBlocked } = useNavigationBlocker()\n\n  return (\n    <form\n      onSubmit={(e) => {\n        e.preventDefault()\n        setIsBlocked(false)\n      }}\n      onChange={() => setIsBlocked(true)}\n    >\n      <input type=\"text\" name=\"name\" />\n      <button type=\"submit\">Save</button>\n    </form>\n  )\n}"
  },
  {
    "id": "link.mdx#37",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```jsx filename=\"app/components/form.js\" switcher\n'use client'\n\nimport { useNavigationBlocker } from '../contexts/navigation-blocker'\n\nexport default function Form() {\n  const { setIsBlocked } = useNavigationBlocker()\n\n  return (\n    <form\n      onSubmit={(e) => {\n        e.preventDefault()\n        setIsBlocked(false)\n      }}\n      onChange={() => setIsBlocked(true)}\n    >\n      <input type=\"text\" name=\"name\" />\n      <button type=\"submit\">Save</button>\n    </form>\n  )\n}"
  },
  {
    "id": "link.mdx#38",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\nCreate a custom Link component that blocks navigation:\n\n```tsx filename=\"app/components/custom-link.tsx\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useNavigationBlocker } from '../contexts/navigation-blocker'\n\ninterface CustomLinkProps extends React.ComponentProps<typeof Link> {\n  children: React.ReactNode\n}\n\nexport function CustomLink({ children, ...props }: CustomLinkProps) {\n  const { isBlocked } = useNavigationBlocker()\n\n  return (\n    <Link\n      onNavigate={(e) => {\n        if (\n          isBlocked &&\n          !window.confirm('You have unsaved changes. Leave anyway?')\n        ) {\n          e.preventDefault()\n        }\n      }}\n      {...props}\n    >\n      {children}\n    </Link>\n  )\n}"
  },
  {
    "id": "link.mdx#39",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```jsx filename=\"app/components/custom-link.js\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useNavigationBlocker } from '../contexts/navigation-blocker'\n\nexport function CustomLink({ children, ...props }) {\n  const { isBlocked } = useNavigationBlocker()\n\n  return (\n    <Link\n      onNavigate={(e) => {\n        if (\n          isBlocked &&\n          !window.confirm('You have unsaved changes. Leave anyway?')\n        ) {\n          e.preventDefault()\n        }\n      }}\n      {...props}\n    >\n      {children}\n    </Link>\n  )\n}\n```\n\nCreate a navigation component:\n\n```tsx filename=\"app/components/nav.tsx\" switcher\n'use client'\n\nimport { CustomLink as Link } from './custom-link'\n\nexport default function Nav() {\n  return (\n    <nav>\n      <Link href=\"/\">Home</Link>\n      <Link href=\"/about\">About</Link>\n    </nav>\n  )\n}\n```\n\n```jsx filename=\"app/components/nav.js\" switcher\n'use client'\n\nimport { CustomLink as Link } from './custom-link'\n\nexport default function Nav() {\n  return (\n    <nav>\n      <Link href=\"/\">Home</Link>\n      <Link href=\"/about\">About</Link>\n    </nav>\n  )\n}"
  },
  {
    "id": "link.mdx#40",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\nFinally, wrap your app with the `NavigationBlockerProvider` in the root layout and use the components in your page:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { NavigationBlockerProvider } from './contexts/navigation-blocker'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <NavigationBlockerProvider>{children}</NavigationBlockerProvider>\n      </body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { NavigationBlockerProvider } from './contexts/navigation-blocker'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <NavigationBlockerProvider>{children}</NavigationBlockerProvider>\n      </body>\n    </html>\n  )\n}\n```\n\nThen, use the `Nav` and `Form` components in your page:\n\n```tsx filename=\"app/page.tsx\" switcher\nimport Nav from './components/nav'\nimport Form from './components/form'\n\nexport default function Page() {\n  return (\n    <div>\n      <Nav />\n      <main>\n        <h1>Welcome to the Dashboard</h1>\n        <Form />\n      </main>\n    </div>\n  )\n}"
  },
  {
    "id": "link.mdx#41",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nimport Nav from './components/nav'\nimport Form from './components/form'\n\nexport default function Page() {\n  return (\n    <div>\n      <Nav />\n      <main>\n        <h1>Welcome to the Dashboard</h1>\n        <Form />\n      </main>\n    </div>\n  )\n}\n```\n\nWhen a user tries to navigate away using `CustomLink` while the form has unsaved changes, they'll be prompted to confirm before leaving.\n\n</AppOnly>"
  },
  {
    "id": "link.mdx#42",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "## Version history"
  },
  {
    "id": "link.mdx#43",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "| Version   | Changes                                                                                                                                                                      |\n| --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `v15.4.0` | Add `auto` as an alias to the default `prefetch` behavior.                                                                                                                   |\n| `v15.3.0` | Add `onNavigate` API                                                                                                                                                         |\n| `v13.0.0` | No longer requires a child `<a>` tag. A [codemod](/docs/app/guides/upgrading/codemods#remove-a-tags-from-link-components) is provided to automatically update your codebase. |\n| `v10.0.0` | `href` props pointing to a dynamic route are automatically resolved and no longer require an `as` prop.                                                                      |"
  },
  {
    "id": "link.mdx#44",
    "metadata": {
      "title": "Link Component",
      "description": "Enable fast client-side navigation with the built-in `next/link` component."
    },
    "content": "| `v10.0.0` | `href` props pointing to a dynamic route are automatically resolved and no longer require an `as` prop.                                                                      |\n| `v8.0.0`  | Improved prefetching performance.                                                                                                                                            |\n| `v1.0.0`  | `next/link` introduced.                                                                                                                                                      |"
  },
  {
    "id": "script.mdx#0",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "---\ntitle: Script Component\ndescription: Optimize third-party scripts in your Next.js application using the built-in `next/script` Component.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nThis API reference will help you understand how to use [props](#props) available for the Script Component. For features and usage, please see the [Optimizing Scripts](/docs/app/guides/scripts) page.\n\n```tsx filename=\"app/dashboard/page.tsx\" switcher\nimport Script from 'next/script'\n\nexport default function Dashboard() {\n  return (\n    <>\n      <Script src=\"https://example.com/script.js\" />\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/dashboard/page.js\" switcher\nimport Script from 'next/script'\n\nexport default function Dashboard() {\n  return (\n    <>\n      <Script src=\"https://example.com/script.js\" />\n    </>\n  )\n}\n```"
  },
  {
    "id": "script.mdx#1",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "## Props\n\nHere's a summary of the props available for the Script Component:\n\n| Prop                    | Example                           | Type     | Required                              |\n| ----------------------- | --------------------------------- | -------- | ------------------------------------- |\n| [`src`](#src)           | `src=\"http://example.com/script\"` | String   | Required unless inline script is used |\n| [`strategy`](#strategy) | `strategy=\"lazyOnload\"`           | String   | -                                     |\n| [`onLoad`](#onload)     | `onLoad={onLoadFunc}`             | Function | -                                     |\n| [`onReady`](#onready)   | `onReady={onReadyFunc}`           | Function | -                                     |\n| [`onError`](#onerror)   | `onError={onErrorFunc}`           | Function | -                                     |\n\n## Required Props\n\nThe `<Script />` component requires the following properties.\n\n### `src`\n\nA path string specifying the URL of an external script. This can be either an absolute external URL or an internal path. The `src` property is required unless an inline script is used."
  },
  {
    "id": "script.mdx#2",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "## Optional Props\n\nThe `<Script />` component accepts a number of additional properties beyond those which are required.\n\n### `strategy`\n\nThe loading strategy of the script. There are four different strategies that can be used:\n\n- `beforeInteractive`: Load before any Next.js code and before any page hydration occurs.\n- `afterInteractive`: (**default**) Load early but after some hydration on the page occurs.\n- `lazyOnload`: Load during browser idle time.\n- `worker`: (experimental) Load in a web worker."
  },
  {
    "id": "script.mdx#3",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "### `beforeInteractive`\n\nScripts that load with the `beforeInteractive` strategy are injected into the initial HTML from the server, downloaded before any Next.js module, and executed in the order they are placed.\n\nScripts denoted with this strategy are preloaded and fetched before any first-party code, but their execution **does not block page hydration from occurring**.\n\n<AppOnly>\n\n`beforeInteractive` scripts must be placed inside the root layout (`app/layout.tsx`) and are designed to load scripts that are needed by the entire site (i.e. the script will load when any page in the application has been loaded server-side).\n\n</AppOnly>\n\n<PagesOnly>\n\n`beforeInteractive` scripts must be placed inside the `Document` Component (`pages/_document.js`) and are designed to load scripts that are needed by the entire site (i.e. the script will load when any page in the application has been loaded server-side).\n\n</PagesOnly>\n\n**This strategy should only be used for critical scripts that need to be fetched as soon as possible.**\n\n<AppOnly>\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport Script from 'next/script'"
  },
  {
    "id": "script.mdx#4",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "**This strategy should only be used for critical scripts that need to be fetched as soon as possible.**\n\n<AppOnly>\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport Script from 'next/script'\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>\n        {children}\n        <Script\n          src=\"https://example.com/script.js\"\n          strategy=\"beforeInteractive\"\n        />\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "script.mdx#5",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nimport Script from 'next/script'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        {children}\n        <Script\n          src=\"https://example.com/script.js\"\n          strategy=\"beforeInteractive\"\n        />\n      </body>\n    </html>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx filename=\"pages/_document.js\"\nimport { Html, Head, Main, NextScript } from 'next/document'\nimport Script from 'next/script'\n\nexport default function Document() {\n  return (\n    <Html>\n      <Head />\n      <body>\n        <Main />\n        <NextScript />\n        <Script\n          src=\"https://example.com/script.js\"\n          strategy=\"beforeInteractive\"\n        />\n      </body>\n    </Html>\n  )\n}\n```\n\n</PagesOnly>\n\n> **Good to know**: Scripts with `beforeInteractive` will always be injected inside the `head` of the HTML document regardless of where it's placed in the component.\n\nSome examples of scripts that should be fetched as soon as possible with `beforeInteractive` include:\n\n- Bot detectors\n- Cookie consent managers"
  },
  {
    "id": "script.mdx#6",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "### `afterInteractive`\n\nScripts that use the `afterInteractive` strategy are injected into the HTML client-side and will load after some (or all) hydration occurs on the page. **This is the default strategy** of the Script component and should be used for any script that needs to load as soon as possible but not before any first-party Next.js code.\n\n`afterInteractive` scripts can be placed inside of any page or layout and will only load and execute when that page (or group of pages) is opened in the browser.\n\n```jsx filename=\"app/page.js\"\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script src=\"https://example.com/script.js\" strategy=\"afterInteractive\" />\n    </>\n  )\n}\n```\n\nSome examples of scripts that are good candidates for `afterInteractive` include:\n\n- Tag managers\n- Analytics"
  },
  {
    "id": "script.mdx#7",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "### `lazyOnload`\n\nScripts that use the `lazyOnload` strategy are injected into the HTML client-side during browser idle time and will load after all resources on the page have been fetched. This strategy should be used for any background or low priority scripts that do not need to load early.\n\n`lazyOnload` scripts can be placed inside of any page or layout and will only load and execute when that page (or group of pages) is opened in the browser.\n\n```jsx filename=\"app/page.js\"\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script src=\"https://example.com/script.js\" strategy=\"lazyOnload\" />\n    </>\n  )\n}\n```\n\nExamples of scripts that do not need to load immediately and can be fetched with `lazyOnload` include:\n\n- Chat support plugins\n- Social media widgets"
  },
  {
    "id": "script.mdx#8",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "### `worker`\n\n> **Warning:** The `worker` strategy is not yet stable and does not yet work with the App Router. Use with caution.\n\nScripts that use the `worker` strategy are off-loaded to a web worker in order to free up the main thread and ensure that only critical, first-party resources are processed on it. While this strategy can be used for any script, it is an advanced use case that is not guaranteed to support all third-party scripts.\n\nTo use `worker` as a strategy, the `nextScriptWorkers` flag must be enabled in `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  experimental: {\n    nextScriptWorkers: true,\n  },\n}\n```\n\n`worker` scripts can **only currently be used in the `pages/` directory**:\n\n```tsx filename=\"pages/home.tsx\" switcher\nimport Script from 'next/script'\n\nexport default function Home() {\n  return (\n    <>\n      <Script src=\"https://example.com/script.js\" strategy=\"worker\" />\n    </>\n  )\n}\n```\n\n```jsx filename=\"pages/home.js\" switcher\nimport Script from 'next/script'\n\nexport default function Home() {\n  return (\n    <>\n      <Script src=\"https://example.com/script.js\" strategy=\"worker\" />\n    </>\n  )\n}\n```"
  },
  {
    "id": "script.mdx#9",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "### `onLoad`\n\n> **Warning:** `onLoad` does not yet work with Server Components and can only be used in Client Components. Further, `onLoad` can't be used with `beforeInteractive` – consider using `onReady` instead.\n\nSome third-party scripts require users to run JavaScript code once after the script has finished loading in order to instantiate content or call a function. If you are loading a script with either `afterInteractive` or `lazyOnload` as a loading strategy, you can execute code after it has loaded using the `onLoad` property.\n\nHere's an example of executing a lodash method only after the library has been loaded.\n\n```tsx filename=\"app/page.tsx\" switcher\n'use client'\n\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.20/lodash.min.js\"\n        onLoad={() => {\n          console.log(_.sample([1, 2, 3, 4]))\n        }}\n      />\n    </>\n  )\n}"
  },
  {
    "id": "script.mdx#10",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\n'use client'\n\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.20/lodash.min.js\"\n        onLoad={() => {\n          console.log(_.sample([1, 2, 3, 4]))\n        }}\n      />\n    </>\n  )\n}\n```"
  },
  {
    "id": "script.mdx#11",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "### `onReady`\n\n> **Warning:** `onReady` does not yet work with Server Components and can only be used in Client Components.\n\nSome third-party scripts require users to run JavaScript code after the script has finished loading and every time the component is mounted (after a route navigation for example). You can execute code after the script's load event when it first loads and then after every subsequent component re-mount using the `onReady` property.\n\nHere's an example of how to re-instantiate a Google Maps JS embed every time the component is mounted:\n\n<AppOnly>\n\n```tsx filename=\"app/page.tsx\" switcher\n'use client'\n\nimport { useRef } from 'react'\nimport Script from 'next/script'\n\nexport default function Page() {\n  const mapRef = useRef()\n\n  return (\n    <>\n      <div ref={mapRef}></div>\n      <Script\n        id=\"google-maps\"\n        src=\"https://maps.googleapis.com/maps/api/js\"\n        onReady={() => {\n          new google.maps.Map(mapRef.current, {\n            center: { lat: -34.397, lng: 150.644 },\n            zoom: 8,\n          })\n        }}\n      />\n    </>\n  )\n}"
  },
  {
    "id": "script.mdx#12",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\n'use client'\n\nimport { useRef } from 'react'\nimport Script from 'next/script'\n\nexport default function Page() {\n  const mapRef = useRef()\n\n  return (\n    <>\n      <div ref={mapRef}></div>\n      <Script\n        id=\"google-maps\"\n        src=\"https://maps.googleapis.com/maps/api/js\"\n        onReady={() => {\n          new google.maps.Map(mapRef.current, {\n            center: { lat: -34.397, lng: 150.644 },\n            zoom: 8,\n          })\n        }}\n      />\n    </>\n  )\n}\n```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx\nimport { useRef } from 'react'\nimport Script from 'next/script'\n\nexport default function Page() {\n  const mapRef = useRef()\n\n  return (\n    <>\n      <div ref={mapRef}></div>\n      <Script\n        id=\"google-maps\"\n        src=\"https://maps.googleapis.com/maps/api/js\"\n        onReady={() => {\n          new google.maps.Map(mapRef.current, {\n            center: { lat: -34.397, lng: 150.644 },\n            zoom: 8,\n          })\n        }}\n      />\n    </>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "script.mdx#13",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "### `onError`\n\n> **Warning:** `onError` does not yet work with Server Components and can only be used in Client Components. `onError` cannot be used with the `beforeInteractive` loading strategy.\n\nSometimes it is helpful to catch when a script fails to load. These errors can be handled with the `onError` property:\n\n<AppOnly>\n\n```tsx filename=\"app/page.tsx\" switcher\n'use client'\n\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://example.com/script.js\"\n        onError={(e: Error) => {\n          console.error('Script failed to load', e)\n        }}\n      />\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\n'use client'\n\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://example.com/script.js\"\n        onError={(e) => {\n          console.error('Script failed to load', e)\n        }}\n      />\n    </>\n  )\n}"
  },
  {
    "id": "script.mdx#14",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\n```jsx\nimport Script from 'next/script'\n\nexport default function Page() {\n  return (\n    <>\n      <Script\n        src=\"https://example.com/script.js\"\n        onError={(e: Error) => {\n          console.error('Script failed to load', e)\n        }}\n      />\n    </>\n  )\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "script.mdx#15",
    "metadata": {
      "title": "Script Component",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "## Version History\n\n| Version   | Changes                                                                   |\n| --------- | ------------------------------------------------------------------------- |\n| `v13.0.0` | `beforeInteractive` and `afterInteractive` is modified to support `app`.  |\n| `v12.2.4` | `onReady` prop added.                                                     |\n| `v12.2.2` | Allow `next/script` with `beforeInteractive` to be placed in `_document`. |\n| `v11.0.0` | `next/script` introduced.                                                 |"
  },
  {
    "id": "app-icons.mdx#0",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "---\ntitle: favicon, icon, and apple-icon\ndescription: API Reference for the Favicon, Icon and Apple Icon file conventions.\n---\n\nThe `favicon`, `icon`, or `apple-icon` file conventions allow you to set icons for your application.\n\nThey are useful for adding app icons that appear in places like web browser tabs, phone home screens, and search engine results.\n\nThere are two ways to set app icons:\n\n- [Using image files (.ico, .jpg, .png)](#image-files-ico-jpg-png)\n- [Using code to generate an icon (.js, .ts, .tsx)](#generate-icons-using-code-js-ts-tsx)"
  },
  {
    "id": "app-icons.mdx#1",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "## Image files (.ico, .jpg, .png)\n\nUse an image file to set an app icon by placing a `favicon`, `icon`, or `apple-icon` image file within your `/app` directory.\nThe `favicon` image can only be located in the top level of `app/`.\n\nNext.js will evaluate the file and automatically add the appropriate tags to your app's `<head>` element.\n\n| File convention             | Supported file types                    | Valid locations |\n| --------------------------- | --------------------------------------- | --------------- |\n| [`favicon`](#favicon)       | `.ico`                                  | `app/`          |\n| [`icon`](#icon)             | `.ico`, `.jpg`, `.jpeg`, `.png`, `.svg` | `app/**/*`      |\n| [`apple-icon`](#apple-icon) | `.jpg`, `.jpeg`, `.png`                 | `app/**/*`      |\n\n### `favicon`\n\nAdd a `favicon.ico` image file to the root `/app` route segment.\n\n```html filename=\"<head> output\"\n<link rel=\"icon\" href=\"/favicon.ico\" sizes=\"any\" />\n```\n\n### `icon`\n\nAdd an `icon.(ico|jpg|jpeg|png|svg)` image file.\n\n```html filename=\"<head> output\"\n<link\n  rel=\"icon\"\n  href=\"/icon?<generated>\"\n  type=\"image/<generated>\"\n  sizes=\"<generated>\"\n/>\n```"
  },
  {
    "id": "app-icons.mdx#2",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "### `apple-icon`\n\nAdd an `apple-icon.(jpg|jpeg|png)` image file.\n\n```html filename=\"<head> output\"\n<link\n  rel=\"apple-touch-icon\"\n  href=\"/apple-icon?<generated>\"\n  type=\"image/<generated>\"\n  sizes=\"<generated>\"\n/>\n```\n\n> **Good to know**:\n>\n> - You can set multiple icons by adding a number suffix to the file name. For example, `icon1.png`, `icon2.png`, etc. Numbered files will sort lexically.\n> - Favicons can only be set in the root `/app` segment. If you need more granularity, you can use [`icon`](#icon).\n> - The appropriate `<link>` tags and attributes such as `rel`, `href`, `type`, and `sizes` are determined by the icon type and metadata of the evaluated file.\n> - For example, a 32 by 32px `.png` file will have `type=\"image/png\"` and `sizes=\"32x32\"` attributes.\n> - `sizes=\"any\"` is added to icons when the extension is `.svg` or the image size of the file is not determined. More details in this [favicon handbook](https://evilmartians.com/chronicles/how-to-favicon-in-2021-six-files-that-fit-most-needs)."
  },
  {
    "id": "app-icons.mdx#3",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "## Generate icons using code (.js, .ts, .tsx)\n\nIn addition to using [literal image files](#image-files-ico-jpg-png), you can programmatically **generate** icons using code.\n\nGenerate an app icon by creating an `icon` or `apple-icon` route that default exports a function.\n\n| File convention | Supported file types |\n| --------------- | -------------------- |\n| `icon`          | `.js`, `.ts`, `.tsx` |\n| `apple-icon`    | `.js`, `.ts`, `.tsx` |\n\nThe easiest way to generate an icon is to use the [`ImageResponse`](/docs/app/api-reference/functions/image-response) API from `next/og`.\n\n```tsx filename=\"app/icon.tsx\" switcher\nimport { ImageResponse } from 'next/og'\n\n// Image metadata\nexport const size = {\n  width: 32,\n  height: 32,\n}\nexport const contentType = 'image/png'"
  },
  {
    "id": "app-icons.mdx#4",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "```tsx filename=\"app/icon.tsx\" switcher\nimport { ImageResponse } from 'next/og'\n\n// Image metadata\nexport const size = {\n  width: 32,\n  height: 32,\n}\nexport const contentType = 'image/png'\n\n// Image generation\nexport default function Icon() {\n  return new ImageResponse(\n    (\n      // ImageResponse JSX element\n      <div\n        style={{\n          fontSize: 24,\n          background: 'black',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          color: 'white',\n        }}\n      >\n        A\n      </div>\n    ),\n    // ImageResponse options\n    {\n      // For convenience, we can re-use the exported icons size metadata\n      // config to also set the ImageResponse's width and height.\n      ...size,\n    }\n  )\n}"
  },
  {
    "id": "app-icons.mdx#5",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "```\n\n```jsx filename=\"app/icon.js\" switcher\nimport { ImageResponse } from 'next/og'\n\n// Image metadata\nexport const size = {\n  width: 32,\n  height: 32,\n}\nexport const contentType = 'image/png'\n\n// Image generation\nexport default function Icon() {\n  return new ImageResponse(\n    (\n      // ImageResponse JSX element\n      <div\n        style={{\n          fontSize: 24,\n          background: 'black',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          color: 'white',\n        }}\n      >\n        A\n      </div>\n    ),\n    // ImageResponse options\n    {\n      // For convenience, we can re-use the exported icons size metadata\n      // config to also set the ImageResponse's width and height.\n      ...size,\n    }\n  )\n}\n```\n\n```html filename=\"<head> output\"\n<link rel=\"icon\" href=\"/icon?<generated>\" type=\"image/png\" sizes=\"32x32\" />"
  },
  {
    "id": "app-icons.mdx#6",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "```\n\n```html filename=\"<head> output\"\n<link rel=\"icon\" href=\"/icon?<generated>\" type=\"image/png\" sizes=\"32x32\" />\n```\n\n> **Good to know**:\n>\n> - By default, generated icons are [**statically optimized**](/docs/app/guides/caching#static-rendering) (generated at build time and cached) unless they use [Dynamic APIs](/docs/app/guides/caching#dynamic-rendering) or uncached data.\n> - You can generate multiple icons in the same file using [`generateImageMetadata`](/docs/app/api-reference/functions/generate-image-metadata).\n> - You cannot generate a `favicon` icon. Use [`icon`](#icon) or a [favicon.ico](#favicon) file instead.\n> - App icons are special Route Handlers that are cached by default unless they use a [Dynamic API](/docs/app/guides/caching#dynamic-apis) or [dynamic config](/docs/app/guides/caching#segment-config-options) option."
  },
  {
    "id": "app-icons.mdx#7",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "### Props\n\nThe default export function receives the following props:"
  },
  {
    "id": "app-icons.mdx#8",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "#### `params` (optional)\n\nA promise that resolves to an object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) object from the root segment down to the segment `icon` or `apple-icon` is colocated in.\n\n> **Good to know**: If you use [`generateImageMetadata`](/docs/app/api-reference/functions/generate-image-metadata), the function will also receive an `id` prop that is a promise resolving to the `id` value from one of the items returned by `generateImageMetadata`.\n\n```tsx filename=\"app/shop/[slug]/icon.tsx\" switcher\nexport default async function Icon({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = await params\n  // ...\n}\n```\n\n```jsx filename=\"app/shop/[slug]/icon.js\" switcher\nexport default async function Icon({ params }) {\n  const { slug } = await params\n  // ...\n}"
  },
  {
    "id": "app-icons.mdx#9",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "```\n\n```jsx filename=\"app/shop/[slug]/icon.js\" switcher\nexport default async function Icon({ params }) {\n  const { slug } = await params\n  // ...\n}\n```\n\n| Route                           | URL         | `params`                           |\n| ------------------------------- | ----------- | ---------------------------------- |\n| `app/shop/icon.js`              | `/shop`     | `undefined`                        |\n| `app/shop/[slug]/icon.js`       | `/shop/1`   | `Promise<{ slug: '1' }>`           |\n| `app/shop/[tag]/[item]/icon.js` | `/shop/1/2` | `Promise<{ tag: '1', item: '2' }>` |"
  },
  {
    "id": "app-icons.mdx#10",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "### Returns\n\nThe default export function should return a `Blob` | `ArrayBuffer` | `TypedArray` | `DataView` | `ReadableStream` | `Response`.\n\n> **Good to know**: `ImageResponse` satisfies this return type."
  },
  {
    "id": "app-icons.mdx#11",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "### Config exports\n\nYou can optionally configure the icon's metadata by exporting `size` and `contentType` variables from the `icon` or `apple-icon` route.\n\n| Option                        | Type                                                                                                            |\n| ----------------------------- | --------------------------------------------------------------------------------------------------------------- |\n| [`size`](#size)               | `{ width: number; height: number }`                                                                             |\n| [`contentType`](#contenttype) | `string` - [image MIME type](https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/MIME_types#image_types) |\n\n#### `size`\n\n```tsx filename=\"icon.tsx | apple-icon.tsx\" switcher\nexport const size = { width: 32, height: 32 }\n\nexport default function Icon() {}\n```\n\n```jsx filename=\"icon.js | apple-icon.js\" switcher\nexport const size = { width: 32, height: 32 }\n\nexport default function Icon() {}\n```\n\n```html filename=\"<head> output\"\n<link rel=\"icon\" sizes=\"32x32\" />\n```"
  },
  {
    "id": "app-icons.mdx#12",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "#### `contentType`\n\n```tsx filename=\"icon.tsx | apple-icon.tsx\" switcher\nexport const contentType = 'image/png'\n\nexport default function Icon() {}\n```\n\n```jsx filename=\"icon.js | apple-icon.js\" switcher\nexport const contentType = 'image/png'\n\nexport default function Icon() {}\n```\n\n```html filename=\"<head> output\"\n<link rel=\"icon\" type=\"image/png\" />\n```\n\n#### Route Segment Config\n\n`icon` and `apple-icon` are specialized [Route Handlers](/docs/app/api-reference/file-conventions/route) that can use the same [route segment configuration](/docs/app/api-reference/file-conventions/route-segment-config) options as Pages and Layouts."
  },
  {
    "id": "app-icons.mdx#13",
    "metadata": {
      "title": "favicon, icon, and apple-icon",
      "description": "API Reference for the Favicon, Icon and Apple Icon file conventions."
    },
    "content": "## Version History\n\n| Version   | Changes                                              |\n| --------- | ---------------------------------------------------- |\n| `v16.0.0` | `params` is now a promise that resolves to an object |\n| `v13.3.0` | `favicon` `icon` and `apple-icon` introduced         |"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Metadata Files API Reference",
      "description": "API documentation for the metadata file conventions."
    },
    "content": "---\ntitle: Metadata Files API Reference\nnav_title: Metadata Files\ndescription: API documentation for the metadata file conventions.\n---\n\nThis section of the docs covers **Metadata file conventions**. File-based metadata can be defined by adding special metadata files to route segments.\n\nEach file convention can be defined using a static file (e.g. `opengraph-image.jpg`), or a dynamic variant that uses code to generate the file (e.g. `opengraph-image.js`).\n\nOnce a file is defined, Next.js will automatically serve the file (with hashes in production for caching) and update the relevant head elements with the correct metadata, such as the asset's URL, file type, and image size."
  },
  {
    "id": "index.mdx#1",
    "metadata": {
      "title": "Metadata Files API Reference",
      "description": "API documentation for the metadata file conventions."
    },
    "content": "> **Good to know**:\n>\n> - Special Route Handlers like [`sitemap.ts`](/docs/app/api-reference/file-conventions/metadata/sitemap), [`opengraph-image.tsx`](/docs/app/api-reference/file-conventions/metadata/opengraph-image), and [`icon.tsx`](/docs/app/api-reference/file-conventions/metadata/app-icons), and other [metadata files](/docs/app/api-reference/file-conventions/metadata) are cached by default.\n> - If using along with [`proxy.ts`](/docs/app/api-reference/file-conventions/proxy), [configure the matcher](/docs/app/api-reference/file-conventions/proxy#matcher) to exclude the metadata files."
  },
  {
    "id": "manifest.mdx#0",
    "metadata": {
      "title": "manifest.json",
      "description": "API Reference for manifest.json file."
    },
    "content": "---\ntitle: manifest.json\ndescription: API Reference for manifest.json file.\n---\n\nAdd or generate a `manifest.(json|webmanifest)` file that matches the [Web Manifest Specification](https://developer.mozilla.org/docs/Web/Manifest) in the **root** of `app` directory to provide information about your web application for the browser.\n\n## Static Manifest file\n\n```json filename=\"app/manifest.json | app/manifest.webmanifest\"\n{\n  \"name\": \"My Next.js Application\",\n  \"short_name\": \"Next.js App\",\n  \"description\": \"An application built with Next.js\",\n  \"start_url\": \"/\"\n  // ...\n}\n```"
  },
  {
    "id": "manifest.mdx#1",
    "metadata": {
      "title": "manifest.json",
      "description": "API Reference for manifest.json file."
    },
    "content": "## Generate a Manifest file\n\nAdd a `manifest.js` or `manifest.ts` file that returns a [`Manifest` object](#manifest-object).\n\n> Good to know: `manifest.js` is special Route Handlers that is cached by default unless it uses a [Dynamic API](/docs/app/guides/caching#dynamic-apis) or [dynamic config](/docs/app/guides/caching#segment-config-options) option.\n\n```ts filename=\"app/manifest.ts\" switcher\nimport type { MetadataRoute } from 'next'\n\nexport default function manifest(): MetadataRoute.Manifest {\n  return {\n    name: 'Next.js App',\n    short_name: 'Next.js App',\n    description: 'Next.js App',\n    start_url: '/',\n    display: 'standalone',\n    background_color: '#fff',\n    theme_color: '#fff',\n    icons: [\n      {\n        src: '/favicon.ico',\n        sizes: 'any',\n        type: 'image/x-icon',\n      },\n    ],\n  }\n}"
  },
  {
    "id": "manifest.mdx#2",
    "metadata": {
      "title": "manifest.json",
      "description": "API Reference for manifest.json file."
    },
    "content": "```\n\n```js filename=\"app/manifest.js\" switcher\nexport default function manifest() {\n  return {\n    name: 'Next.js App',\n    short_name: 'Next.js App',\n    description: 'Next.js App',\n    start_url: '/',\n    display: 'standalone',\n    background_color: '#fff',\n    theme_color: '#fff',\n    icons: [\n      {\n        src: '/favicon.ico',\n        sizes: 'any',\n        type: 'image/x-icon',\n      },\n    ],\n  }\n}\n```"
  },
  {
    "id": "manifest.mdx#3",
    "metadata": {
      "title": "manifest.json",
      "description": "API Reference for manifest.json file."
    },
    "content": "### Manifest Object\n\nThe manifest object contains an extensive list of options that may be updated due to new web standards. For information on all the current options, refer to the `MetadataRoute.Manifest` type in your code editor if using [TypeScript](/docs/app/api-reference/config/typescript#ide-plugin) or see the [MDN](https://developer.mozilla.org/docs/Web/Manifest) docs."
  },
  {
    "id": "opengraph-image.mdx#0",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "---\ntitle: opengraph-image and twitter-image\ndescription: API Reference for the Open Graph Image and Twitter Image file conventions.\n---\n\nThe `opengraph-image` and `twitter-image` file conventions allow you to set Open Graph and Twitter images for a route segment.\n\nThey are useful for setting the images that appear on social networks and messaging apps when a user shares a link to your site.\n\nThere are two ways to set Open Graph and Twitter images:\n\n- [Using image files (.jpg, .png, .gif)](#image-files-jpg-png-gif)\n- [Using code to generate images (.js, .ts, .tsx)](#generate-images-using-code-js-ts-tsx)"
  },
  {
    "id": "opengraph-image.mdx#1",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "## Image files (.jpg, .png, .gif)\n\nUse an image file to set a route segment's shared image by placing an `opengraph-image` or `twitter-image` image file in the segment.\n\nNext.js will evaluate the file and automatically add the appropriate tags to your app's `<head>` element.\n\n| File convention                                 | Supported file types            |\n| ----------------------------------------------- | ------------------------------- |\n| [`opengraph-image`](#opengraph-image)           | `.jpg`, `.jpeg`, `.png`, `.gif` |\n| [`twitter-image`](#twitter-image)               | `.jpg`, `.jpeg`, `.png`, `.gif` |\n| [`opengraph-image.alt`](#opengraph-imagealttxt) | `.txt`                          |\n| [`twitter-image.alt`](#twitter-imagealttxt)     | `.txt`                          |\n\n> **Good to know**:\n>\n> The `twitter-image` file size must not exceed [5MB](https://developer.x.com/en/docs/x-for-websites/cards/overview/summary), and the `opengraph-image` file size must not exceed [8MB](https://developers.facebook.com/docs/sharing/webmasters/images). If the image file size exceeds these limits, the build will fail."
  },
  {
    "id": "opengraph-image.mdx#2",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "### `opengraph-image`\n\nAdd an `opengraph-image.(jpg|jpeg|png|gif)` image file to any route segment.\n\n```html filename=\"<head> output\"\n<meta property=\"og:image\" content=\"<generated>\" />\n<meta property=\"og:image:type\" content=\"<generated>\" />\n<meta property=\"og:image:width\" content=\"<generated>\" />\n<meta property=\"og:image:height\" content=\"<generated>\" />\n```\n\n### `twitter-image`\n\nAdd a `twitter-image.(jpg|jpeg|png|gif)` image file to any route segment.\n\n```html filename=\"<head> output\"\n<meta name=\"twitter:image\" content=\"<generated>\" />\n<meta name=\"twitter:image:type\" content=\"<generated>\" />\n<meta name=\"twitter:image:width\" content=\"<generated>\" />\n<meta name=\"twitter:image:height\" content=\"<generated>\" />\n```\n\n### `opengraph-image.alt.txt`\n\nAdd an accompanying `opengraph-image.alt.txt` file in the same route segment as the `opengraph-image.(jpg|jpeg|png|gif)` image it's alt text.\n\n```txt filename=\"opengraph-image.alt.txt\"\nAbout Acme\n```\n\n```html filename=\"<head> output\"\n<meta property=\"og:image:alt\" content=\"About Acme\" />\n```"
  },
  {
    "id": "opengraph-image.mdx#3",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "### `twitter-image.alt.txt`\n\nAdd an accompanying `twitter-image.alt.txt` file in the same route segment as the `twitter-image.(jpg|jpeg|png|gif)` image it's alt text.\n\n```txt filename=\"twitter-image.alt.txt\"\nAbout Acme\n```\n\n```html filename=\"<head> output\"\n<meta property=\"twitter:image:alt\" content=\"About Acme\" />\n```"
  },
  {
    "id": "opengraph-image.mdx#4",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "## Generate images using code (.js, .ts, .tsx)\n\nIn addition to using [literal image files](#image-files-jpg-png-gif), you can programmatically **generate** images using code.\n\nGenerate a route segment's shared image by creating an `opengraph-image` or `twitter-image` route that default exports a function.\n\n| File convention   | Supported file types |\n| ----------------- | -------------------- |\n| `opengraph-image` | `.js`, `.ts`, `.tsx` |\n| `twitter-image`   | `.js`, `.ts`, `.tsx` |\n\n> **Good to know**:\n>\n> - By default, generated images are [**statically optimized**](/docs/app/guides/caching#static-rendering) (generated at build time and cached) unless they use [Dynamic APIs](/docs/app/guides/caching#dynamic-rendering) or uncached data.\n> - You can generate multiple Images in the same file using [`generateImageMetadata`](/docs/app/api-reference/functions/generate-image-metadata).\n> - `opengraph-image.js` and `twitter-image.js` are special Route Handlers that is cached by default unless it uses a [Dynamic API](/docs/app/guides/caching#dynamic-apis) or [dynamic config](/docs/app/guides/caching#segment-config-options) option."
  },
  {
    "id": "opengraph-image.mdx#5",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "The easiest way to generate an image is to use the [ImageResponse](/docs/app/api-reference/functions/image-response) API from `next/og`.\n\n```tsx filename=\"app/about/opengraph-image.tsx\" switcher\nimport { ImageResponse } from 'next/og'\nimport { readFile } from 'node:fs/promises'\nimport { join } from 'node:path'\n\n// Image metadata\nexport const alt = 'About Acme'\nexport const size = {\n  width: 1200,\n  height: 630,\n}\n\nexport const contentType = 'image/png'\n\n// Image generation\nexport default async function Image() {\n  // Font loading, process.cwd() is Next.js project directory\n  const interSemiBold = await readFile(\n    join(process.cwd(), 'assets/Inter-SemiBold.ttf')\n  )"
  },
  {
    "id": "opengraph-image.mdx#6",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "return new ImageResponse(\n    (\n      // ImageResponse JSX element\n      <div\n        style={{\n          fontSize: 128,\n          background: 'white',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        About Acme\n      </div>\n    ),\n    // ImageResponse options\n    {\n      // For convenience, we can re-use the exported opengraph-image\n      // size config to also set the ImageResponse's width and height.\n      ...size,\n      fonts: [\n        {\n          name: 'Inter',\n          data: interSemiBold,\n          style: 'normal',\n          weight: 400,\n        },\n      ],\n    }\n  )\n}"
  },
  {
    "id": "opengraph-image.mdx#7",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "```\n\n```jsx filename=\"app/about/opengraph-image.js\" switcher\nimport { ImageResponse } from 'next/og'\nimport { readFile } from 'node:fs/promises'\nimport { join } from 'node:path'\n\n// Image metadata\nexport const alt = 'About Acme'\nexport const size = {\n  width: 1200,\n  height: 630,\n}\n\nexport const contentType = 'image/png'\n\n// Image generation\nexport default async function Image() {\n  // Font loading, process.cwd() is Next.js project directory\n  const interSemiBold = await readFile(\n    join(process.cwd(), 'assets/Inter-SemiBold.ttf')\n  )"
  },
  {
    "id": "opengraph-image.mdx#8",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "return new ImageResponse(\n    (\n      // ImageResponse JSX element\n      <div\n        style={{\n          fontSize: 128,\n          background: 'white',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        About Acme\n      </div>\n    ),\n    // ImageResponse options\n    {\n      // For convenience, we can re-use the exported opengraph-image\n      // size config to also set the ImageResponse's width and height.\n      ...size,\n      fonts: [\n        {\n          name: 'Inter',\n          data: interSemiBold,\n          style: 'normal',\n          weight: 400,\n        },\n      ],\n    }\n  )\n}"
  },
  {
    "id": "opengraph-image.mdx#9",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "```\n\n```html filename=\"<head> output\"\n<meta property=\"og:image\" content=\"<generated>\" />\n<meta property=\"og:image:alt\" content=\"About Acme\" />\n<meta property=\"og:image:type\" content=\"image/png\" />\n<meta property=\"og:image:width\" content=\"1200\" />\n<meta property=\"og:image:height\" content=\"630\" />\n```"
  },
  {
    "id": "opengraph-image.mdx#10",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "### Props\n\nThe default export function receives the following props:"
  },
  {
    "id": "opengraph-image.mdx#11",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "#### `params` (optional)\n\nA promise that resolves to an object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) object from the root segment down to the segment `opengraph-image` or `twitter-image` is colocated in.\n\n> **Good to know**: If you use [`generateImageMetadata`](/docs/app/api-reference/functions/generate-image-metadata), the function will also receive an `id` prop that is a promise resolving to the `id` value from one of the items returned by `generateImageMetadata`.\n\n```tsx filename=\"app/shop/[slug]/opengraph-image.tsx\" switcher\nexport default async function Image({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = await params\n  // ...\n}\n```\n\n```jsx filename=\"app/shop/[slug]/opengraph-image.js\" switcher\nexport default async function Image({ params }) {\n  const { slug } = await params\n  // ...\n}"
  },
  {
    "id": "opengraph-image.mdx#12",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "```\n\n```jsx filename=\"app/shop/[slug]/opengraph-image.js\" switcher\nexport default async function Image({ params }) {\n  const { slug } = await params\n  // ...\n}\n```\n\n| Route                                      | URL         | `params`                           |\n| ------------------------------------------ | ----------- | ---------------------------------- |\n| `app/shop/opengraph-image.js`              | `/shop`     | `undefined`                        |\n| `app/shop/[slug]/opengraph-image.js`       | `/shop/1`   | `Promise<{ slug: '1' }>`           |\n| `app/shop/[tag]/[item]/opengraph-image.js` | `/shop/1/2` | `Promise<{ tag: '1', item: '2' }>` |"
  },
  {
    "id": "opengraph-image.mdx#13",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "### Returns\n\nThe default export function should return a `Blob` | `ArrayBuffer` | `TypedArray` | `DataView` | `ReadableStream` | `Response`.\n\n> **Good to know**: `ImageResponse` satisfies this return type."
  },
  {
    "id": "opengraph-image.mdx#14",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "### Config exports\n\nYou can optionally configure the image's metadata by exporting `alt`, `size`, and `contentType` variables from `opengraph-image` or `twitter-image` route.\n\n| Option                        | Type                                                                                                            |\n| ----------------------------- | --------------------------------------------------------------------------------------------------------------- |\n| [`alt`](#alt)                 | `string`                                                                                                        |\n| [`size`](#size)               | `{ width: number; height: number }`                                                                             |\n| [`contentType`](#contenttype) | `string` - [image MIME type](https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/MIME_types#image_types) |"
  },
  {
    "id": "opengraph-image.mdx#15",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "#### `alt`\n\n```tsx filename=\"opengraph-image.tsx | twitter-image.tsx\" switcher\nexport const alt = 'My images alt text'\n\nexport default function Image() {}\n```\n\n```jsx filename=\"opengraph-image.js | twitter-image.js\" switcher\nexport const alt = 'My images alt text'\n\nexport default function Image() {}\n```\n\n```html filename=\"<head> output\"\n<meta property=\"og:image:alt\" content=\"My images alt text\" />\n```\n\n#### `size`\n\n```tsx filename=\"opengraph-image.tsx | twitter-image.tsx\" switcher\nexport const size = { width: 1200, height: 630 }\n\nexport default function Image() {}\n```\n\n```jsx filename=\"opengraph-image.js | twitter-image.js\" switcher\nexport const size = { width: 1200, height: 630 }\n\nexport default function Image() {}\n```\n\n```html filename=\"<head> output\"\n<meta property=\"og:image:width\" content=\"1200\" />\n<meta property=\"og:image:height\" content=\"630\" />\n```"
  },
  {
    "id": "opengraph-image.mdx#16",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "#### `contentType`\n\n```tsx filename=\"opengraph-image.tsx | twitter-image.tsx\" switcher\nexport const contentType = 'image/png'\n\nexport default function Image() {}\n```\n\n```jsx filename=\"opengraph-image.js | twitter-image.js\" switcher\nexport const contentType = 'image/png'\n\nexport default function Image() {}\n```\n\n```html filename=\"<head> output\"\n<meta property=\"og:image:type\" content=\"image/png\" />\n```\n\n#### Route Segment Config\n\n`opengraph-image` and `twitter-image` are specialized [Route Handlers](/docs/app/api-reference/file-conventions/route) that can use the same [route segment configuration](/docs/app/api-reference/file-conventions/route-segment-config) options as Pages and Layouts."
  },
  {
    "id": "opengraph-image.mdx#17",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "### Examples"
  },
  {
    "id": "opengraph-image.mdx#18",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "#### Using external data\n\nThis example uses the `params` object and external data to generate the image.\n\n> **Good to know**:\n> By default, this generated image will be [statically optimized](/docs/app/guides/caching#static-rendering). You can configure the individual `fetch` [`options`](/docs/app/api-reference/functions/fetch) or route segments [options](/docs/app/api-reference/file-conventions/route-segment-config#revalidate) to change this behavior.\n\n```tsx filename=\"app/posts/[slug]/opengraph-image.tsx\" switcher\nimport { ImageResponse } from 'next/og'\n\nexport const alt = 'About Acme'\nexport const size = {\n  width: 1200,\n  height: 630,\n}\nexport const contentType = 'image/png'\n\nexport default async function Image({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = await params\n  const post = await fetch(`https://.../posts/${slug}`).then((res) =>\n    res.json()\n  )"
  },
  {
    "id": "opengraph-image.mdx#19",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "return new ImageResponse(\n    (\n      <div\n        style={{\n          fontSize: 48,\n          background: 'white',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        {post.title}\n      </div>\n    ),\n    {\n      ...size,\n    }\n  )\n}"
  },
  {
    "id": "opengraph-image.mdx#20",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "```\n\n```jsx filename=\"app/posts/[slug]/opengraph-image.js\" switcher\nimport { ImageResponse } from 'next/og'\n\nexport const alt = 'About Acme'\nexport const size = {\n  width: 1200,\n  height: 630,\n}\nexport const contentType = 'image/png'\n\nexport default async function Image({ params }) {\n  const { slug } = await params\n  const post = await fetch(`https://.../posts/${slug}`).then((res) =>\n    res.json()\n  )\n\n  return new ImageResponse(\n    (\n      <div\n        style={{\n          fontSize: 48,\n          background: 'white',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        {post.title}\n      </div>\n    ),\n    {\n      ...size,\n    }\n  )\n}\n```"
  },
  {
    "id": "opengraph-image.mdx#21",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "#### Using Node.js runtime with local assets\n\nThese examples use the Node.js runtime to fetch a local image from the file system and pass it to the `<img>` `src` attribute, either as a base64 string or an `ArrayBuffer`. Place the local asset relative to the project root, not the example source file.\n\n```tsx filename=\"app/opengraph-image.tsx\" switcher\nimport { ImageResponse } from 'next/og'\nimport { join } from 'node:path'\nimport { readFile } from 'node:fs/promises'\n\nexport default async function Image() {\n  const logoData = await readFile(join(process.cwd(), 'logo.png'), 'base64')\n  const logoSrc = `data:image/png;base64,${logoData}`\n\n  return new ImageResponse(\n    (\n      <div\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        <img src={logoSrc} height=\"100\" />\n      </div>\n    )\n  )\n}"
  },
  {
    "id": "opengraph-image.mdx#22",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "```\n\n```jsx filename=\"app/opengraph-image.js\" switcher\nimport { ImageResponse } from 'next/og'\nimport { join } from 'node:path'\nimport { readFile } from 'node:fs/promises'\n\nexport default async function Image() {\n  const logoData = await readFile(join(process.cwd(), 'logo.png'), 'base64')\n  const logoSrc = `data:image/png;base64,${logoData}`\n\n  return new ImageResponse(\n    (\n      <div\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        <img src={logoSrc} height=\"100\" />\n      </div>\n    )\n  )\n}"
  },
  {
    "id": "opengraph-image.mdx#23",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "```\n\nPassing an `ArrayBuffer` to the `src` attribute of an `<img>` element is not part of the HTML spec. The rendering engine used by `next/og` supports it, but because TypeScript definitions follow the spec, you need a `@ts-expect-error` directive or similar to use this [feature](https://github.com/vercel/satori/issues/606#issuecomment-2144000453).\n\n```tsx filename=\"app/opengraph-image.tsx\" switcher\nimport { ImageResponse } from 'next/og'\nimport { join } from 'node:path'\nimport { readFile } from 'node:fs/promises'\n\nexport default async function Image() {\n  const logoData = await readFile(join(process.cwd(), 'logo.png'))\n  const logoSrc = Uint8Array.from(logoData).buffer\n\n  return new ImageResponse(\n    (\n      <div\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        {/* @ts-expect-error Satori accepts ArrayBuffer/typed arrays for <img src> at runtime */}\n        <img src={logoSrc} height=\"100\" />\n      </div>\n    )\n  )\n}"
  },
  {
    "id": "opengraph-image.mdx#24",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "```\n\n```jsx filename=\"app/opengraph-image.js\" switcher\nimport { ImageResponse } from 'next/og'\nimport { join } from 'node:path'\nimport { readFile } from 'node:fs/promises'\n\nexport default async function Image() {\n  const logoData = await readFile(join(process.cwd(), 'logo.png'))\n  const logoSrc = Uint8Array.from(logoData).buffer\n\n  return new ImageResponse(\n    (\n      <div\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        <img src={logoSrc} height=\"100\" />\n      </div>\n    )\n  )\n}\n```"
  },
  {
    "id": "opengraph-image.mdx#25",
    "metadata": {
      "title": "opengraph-image and twitter-image",
      "description": "API Reference for the Open Graph Image and Twitter Image file conventions."
    },
    "content": "## Version History\n\n| Version   | Changes                                              |\n| --------- | ---------------------------------------------------- |\n| `v16.0.0` | `params` is now a promise that resolves to an object |\n| `v13.3.0` | `opengraph-image` and `twitter-image` introduced.    |"
  },
  {
    "id": "robots.mdx#0",
    "metadata": {
      "title": "robots.txt",
      "description": "API Reference for robots.txt file."
    },
    "content": "---\ntitle: robots.txt\ndescription: API Reference for robots.txt file.\n---\n\nAdd or generate a `robots.txt` file that matches the [Robots Exclusion Standard](https://en.wikipedia.org/wiki/Robots.txt#Standard) in the **root** of `app` directory to tell search engine crawlers which URLs they can access on your site.\n\n## Static `robots.txt`\n\n```txt filename=\"app/robots.txt\"\nUser-Agent: *\nAllow: /\nDisallow: /private/\n\nSitemap: https://acme.com/sitemap.xml\n```"
  },
  {
    "id": "robots.mdx#1",
    "metadata": {
      "title": "robots.txt",
      "description": "API Reference for robots.txt file."
    },
    "content": "## Generate a Robots file\n\nAdd a `robots.js` or `robots.ts` file that returns a [`Robots` object](#robots-object).\n\n> **Good to know**: `robots.js` is a special Route Handlers that is cached by default unless it uses a [Dynamic API](/docs/app/guides/caching#dynamic-apis) or [dynamic config](/docs/app/guides/caching#segment-config-options) option.\n\n```ts filename=\"app/robots.ts\" switcher\nimport type { MetadataRoute } from 'next'\n\nexport default function robots(): MetadataRoute.Robots {\n  return {\n    rules: {\n      userAgent: '*',\n      allow: '/',\n      disallow: '/private/',\n    },\n    sitemap: 'https://acme.com/sitemap.xml',\n  }\n}\n```\n\n```js filename=\"app/robots.js\" switcher\nexport default function robots() {\n  return {\n    rules: {\n      userAgent: '*',\n      allow: '/',\n      disallow: '/private/',\n    },\n    sitemap: 'https://acme.com/sitemap.xml',\n  }\n}\n```\n\nOutput:\n\n```txt\nUser-Agent: *\nAllow: /\nDisallow: /private/\n\nSitemap: https://acme.com/sitemap.xml\n```"
  },
  {
    "id": "robots.mdx#2",
    "metadata": {
      "title": "robots.txt",
      "description": "API Reference for robots.txt file."
    },
    "content": "### Customizing specific user agents\n\nYou can customise how individual search engine bots crawl your site by passing an array of user agents to the `rules` property. For example:\n\n```ts filename=\"app/robots.ts\" switcher\nimport type { MetadataRoute } from 'next'\n\nexport default function robots(): MetadataRoute.Robots {\n  return {\n    rules: [\n      {\n        userAgent: 'Googlebot',\n        allow: ['/'],\n        disallow: '/private/',\n      },\n      {\n        userAgent: ['Applebot', 'Bingbot'],\n        disallow: ['/'],\n      },\n    ],\n    sitemap: 'https://acme.com/sitemap.xml',\n  }\n}\n```\n\n```js filename=\"app/robots.js\" switcher\nexport default function robots() {\n  return {\n    rules: [\n      {\n        userAgent: 'Googlebot',\n        allow: ['/'],\n        disallow: ['/private/'],\n      },\n      {\n        userAgent: ['Applebot', 'Bingbot'],\n        disallow: ['/'],\n      },\n    ],\n    sitemap: 'https://acme.com/sitemap.xml',\n  }\n}\n```\n\nOutput:\n\n```txt\nUser-Agent: Googlebot\nAllow: /\nDisallow: /private/\n\nUser-Agent: Applebot\nDisallow: /\n\nUser-Agent: Bingbot\nDisallow: /\n\nSitemap: https://acme.com/sitemap.xml\n```"
  },
  {
    "id": "robots.mdx#3",
    "metadata": {
      "title": "robots.txt",
      "description": "API Reference for robots.txt file."
    },
    "content": "### Robots object\n\n```tsx\ntype Robots = {\n  rules:\n    | {\n        userAgent?: string | string[]\n        allow?: string | string[]\n        disallow?: string | string[]\n        crawlDelay?: number\n      }\n    | Array<{\n        userAgent: string | string[]\n        allow?: string | string[]\n        disallow?: string | string[]\n        crawlDelay?: number\n      }>\n  sitemap?: string | string[]\n  host?: string\n}\n```"
  },
  {
    "id": "robots.mdx#4",
    "metadata": {
      "title": "robots.txt",
      "description": "API Reference for robots.txt file."
    },
    "content": "## Version History\n\n| Version   | Changes              |\n| --------- | -------------------- |\n| `v13.3.0` | `robots` introduced. |"
  },
  {
    "id": "sitemap.mdx#0",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "---\ntitle: sitemap.xml\ndescription: API Reference for the sitemap.xml file.\nrelated:\n  title: Next Steps\n  description: Learn how to use the generateSitemaps function.\n  links:\n    - app/api-reference/functions/generate-sitemaps\n---\n\n`sitemap.(xml|js|ts)` is a special file that matches the [Sitemaps XML format](https://www.sitemaps.org/protocol.html) to help search engine crawlers index your site more efficiently.\n\n### Sitemap files (.xml)\n\nFor smaller applications, you can create a `sitemap.xml` file and place it in the root of your `app` directory.\n\n```xml filename=\"app/sitemap.xml\"\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n  <url>\n    <loc>https://acme.com</loc>\n    <lastmod>2023-04-06T15:02:24.021Z</lastmod>\n    <changefreq>yearly</changefreq>\n    <priority>1</priority>\n  </url>\n  <url>\n    <loc>https://acme.com/about</loc>\n    <lastmod>2023-04-06T15:02:24.021Z</lastmod>\n    <changefreq>monthly</changefreq>\n    <priority>0.8</priority>\n  </url>\n  <url>\n    <loc>https://acme.com/blog</loc>\n    <lastmod>2023-04-06T15:02:24.021Z</lastmod>\n    <changefreq>weekly</changefreq>\n    <priority>0.5</priority>\n  </url>\n</urlset>\n```"
  },
  {
    "id": "sitemap.mdx#1",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "### Generating a sitemap using code (.js, .ts)\n\nYou can use the `sitemap.(js|ts)` file convention to programmatically **generate** a sitemap by exporting a default function that returns an array of URLs. If using TypeScript, a [`Sitemap`](#returns) type is available.\n\n> **Good to know**: `sitemap.js` is a special Route Handler that is cached by default unless it uses a [Dynamic API](/docs/app/guides/caching#dynamic-apis) or [dynamic config](/docs/app/guides/caching#segment-config-options) option.\n\n```ts filename=\"app/sitemap.ts\" switcher\nimport type { MetadataRoute } from 'next'\n\nexport default function sitemap(): MetadataRoute.Sitemap {\n  return [\n    {\n      url: 'https://acme.com',\n      lastModified: new Date(),\n      changeFrequency: 'yearly',\n      priority: 1,\n    },\n    {\n      url: 'https://acme.com/about',\n      lastModified: new Date(),\n      changeFrequency: 'monthly',\n      priority: 0.8,\n    },\n    {\n      url: 'https://acme.com/blog',\n      lastModified: new Date(),\n      changeFrequency: 'weekly',\n      priority: 0.5,\n    },\n  ]\n}"
  },
  {
    "id": "sitemap.mdx#2",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "```\n\n```js filename=\"app/sitemap.js\" switcher\nexport default function sitemap() {\n  return [\n    {\n      url: 'https://acme.com',\n      lastModified: new Date(),\n      changeFrequency: 'yearly',\n      priority: 1,\n    },\n    {\n      url: 'https://acme.com/about',\n      lastModified: new Date(),\n      changeFrequency: 'monthly',\n      priority: 0.8,\n    },\n    {\n      url: 'https://acme.com/blog',\n      lastModified: new Date(),\n      changeFrequency: 'weekly',\n      priority: 0.5,\n    },\n  ]\n}\n```\n\nOutput:\n\n```xml filename=\"acme.com/sitemap.xml\"\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n  <url>\n    <loc>https://acme.com</loc>\n    <lastmod>2023-04-06T15:02:24.021Z</lastmod>\n    <changefreq>yearly</changefreq>\n    <priority>1</priority>\n  </url>\n  <url>\n    <loc>https://acme.com/about</loc>\n    <lastmod>2023-04-06T15:02:24.021Z</lastmod>\n    <changefreq>monthly</changefreq>\n    <priority>0.8</priority>\n  </url>\n  <url>\n    <loc>https://acme.com/blog</loc>\n    <lastmod>2023-04-06T15:02:24.021Z</lastmod>\n    <changefreq>weekly</changefreq>\n    <priority>0.5</priority>\n  </url>\n</urlset>\n```"
  },
  {
    "id": "sitemap.mdx#3",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "### Image Sitemaps\n\nYou can use `images` property to create image sitemaps. Learn more details in the [Google Developer Docs](https://developers.google.com/search/docs/crawling-indexing/sitemaps/image-sitemaps).\n\n```ts filename=\"app/sitemap.ts\" switcher\nimport type { MetadataRoute } from 'next'\n\nexport default function sitemap(): MetadataRoute.Sitemap {\n  return [\n    {\n      url: 'https://example.com',\n      lastModified: '2021-01-01',\n      changeFrequency: 'weekly',\n      priority: 0.5,\n      images: ['https://example.com/image.jpg'],\n    },\n  ]\n}\n```\n\nOutput:\n\n```xml filename=\"acme.com/sitemap.xml\"\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<urlset\n  xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\"\n  xmlns:image=\"http://www.google.com/schemas/sitemap-image/1.1\"\n>\n  <url>\n    <loc>https://example.com</loc>\n    <image:image>\n      <image:loc>https://example.com/image.jpg</image:loc>\n    </image:image>\n    <lastmod>2021-01-01</lastmod>\n    <changefreq>weekly</changefreq>\n    <priority>0.5</priority>\n  </url>\n</urlset>\n```"
  },
  {
    "id": "sitemap.mdx#4",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "### Video Sitemaps\n\nYou can use `videos` property to create video sitemaps. Learn more details in the [Google Developer Docs](https://developers.google.com/search/docs/crawling-indexing/sitemaps/video-sitemaps).\n\n```ts filename=\"app/sitemap.ts\" switcher\nimport type { MetadataRoute } from 'next'\n\nexport default function sitemap(): MetadataRoute.Sitemap {\n  return [\n    {\n      url: 'https://example.com',\n      lastModified: '2021-01-01',\n      changeFrequency: 'weekly',\n      priority: 0.5,\n      videos: [\n        {\n          title: 'example',\n          thumbnail_loc: 'https://example.com/image.jpg',\n          description: 'this is the description',\n        },\n      ],\n    },\n  ]\n}"
  },
  {
    "id": "sitemap.mdx#5",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "```\n\nOutput:\n\n```xml filename=\"acme.com/sitemap.xml\"\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<urlset\n  xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\"\n  xmlns:video=\"http://www.google.com/schemas/sitemap-video/1.1\"\n>\n  <url>\n    <loc>https://example.com</loc>\n    <video:video>\n      <video:title>example</video:title>\n      <video:thumbnail_loc>https://example.com/image.jpg</video:thumbnail_loc>\n      <video:description>this is the description</video:description>\n    </video:video>\n    <lastmod>2021-01-01</lastmod>\n    <changefreq>weekly</changefreq>\n    <priority>0.5</priority>\n  </url>\n</urlset>\n```"
  },
  {
    "id": "sitemap.mdx#6",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "### Generate a localized Sitemap\n\n```ts filename=\"app/sitemap.ts\" switcher\nimport type { MetadataRoute } from 'next'\n\nexport default function sitemap(): MetadataRoute.Sitemap {\n  return [\n    {\n      url: 'https://acme.com',\n      lastModified: new Date(),\n      alternates: {\n        languages: {\n          es: 'https://acme.com/es',\n          de: 'https://acme.com/de',\n        },\n      },\n    },\n    {\n      url: 'https://acme.com/about',\n      lastModified: new Date(),\n      alternates: {\n        languages: {\n          es: 'https://acme.com/es/about',\n          de: 'https://acme.com/de/about',\n        },\n      },\n    },\n    {\n      url: 'https://acme.com/blog',\n      lastModified: new Date(),\n      alternates: {\n        languages: {\n          es: 'https://acme.com/es/blog',\n          de: 'https://acme.com/de/blog',\n        },\n      },\n    },\n  ]\n}"
  },
  {
    "id": "sitemap.mdx#7",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "```\n\n```js filename=\"app/sitemap.js\" switcher\nexport default function sitemap() {\n  return [\n    {\n      url: 'https://acme.com',\n      lastModified: new Date(),\n      alternates: {\n        languages: {\n          es: 'https://acme.com/es',\n          de: 'https://acme.com/de',\n        },\n      },\n    },\n    {\n      url: 'https://acme.com/about',\n      lastModified: new Date(),\n      alternates: {\n        languages: {\n          es: 'https://acme.com/es/about',\n          de: 'https://acme.com/de/about',\n        },\n      },\n    },\n    {\n      url: 'https://acme.com/blog',\n      lastModified: new Date(),\n      alternates: {\n        languages: {\n          es: 'https://acme.com/es/blog',\n          de: 'https://acme.com/de/blog',\n        },\n      },\n    },\n  ]\n}"
  },
  {
    "id": "sitemap.mdx#8",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "```\n\nOutput:\n\n```xml filename=\"acme.com/sitemap.xml\"\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\">\n  <url>\n    <loc>https://acme.com</loc>\n    <xhtml:link\n      rel=\"alternate\"\n      hreflang=\"es\"\n      href=\"https://acme.com/es\"/>\n    <xhtml:link\n      rel=\"alternate\"\n      hreflang=\"de\"\n      href=\"https://acme.com/de\"/>\n    <lastmod>2023-04-06T15:02:24.021Z</lastmod>\n  </url>\n  <url>\n    <loc>https://acme.com/about</loc>\n    <xhtml:link\n      rel=\"alternate\"\n      hreflang=\"es\"\n      href=\"https://acme.com/es/about\"/>\n    <xhtml:link\n      rel=\"alternate\"\n      hreflang=\"de\"\n      href=\"https://acme.com/de/about\"/>\n    <lastmod>2023-04-06T15:02:24.021Z</lastmod>\n  </url>\n  <url>\n    <loc>https://acme.com/blog</loc>\n    <xhtml:link\n      rel=\"alternate\"\n      hreflang=\"es\"\n      href=\"https://acme.com/es/blog\"/>\n    <xhtml:link\n      rel=\"alternate\"\n      hreflang=\"de\"\n      href=\"https://acme.com/de/blog\"/>\n    <lastmod>2023-04-06T15:02:24.021Z</lastmod>\n  </url>\n</urlset>\n```"
  },
  {
    "id": "sitemap.mdx#9",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "### Generating multiple sitemaps\n\nWhile a single sitemap will work for most applications. For large web applications, you may need to split a sitemap into multiple files.\n\nThere are two ways you can create multiple sitemaps:\n\n- By nesting `sitemap.(xml|js|ts)` inside multiple route segments e.g. `app/sitemap.xml` and `app/products/sitemap.xml`.\n- By using the [`generateSitemaps`](/docs/app/api-reference/functions/generate-sitemaps) function.\n\nFor example, to split a sitemap using `generateSitemaps`, return an array of objects with the sitemap `id`. Then, use the `id` to generate the unique sitemaps.\n\n```ts filename=\"app/product/sitemap.ts\" switcher\nimport type { MetadataRoute } from 'next'\nimport { BASE_URL } from '@/app/lib/constants'\n\nexport async function generateSitemaps() {\n  // Fetch the total number of products and calculate the number of sitemaps needed\n  return [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]\n}"
  },
  {
    "id": "sitemap.mdx#10",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "export async function generateSitemaps() {\n  // Fetch the total number of products and calculate the number of sitemaps needed\n  return [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]\n}\n\nexport default async function sitemap(props: {\n  id: Promise<number>\n}): Promise<MetadataRoute.Sitemap> {\n  const id = await props.id\n  // Google's limit is 50,000 URLs per sitemap\n  const start = id * 50000\n  const end = start + 50000\n  const products = await getProducts(\n    `SELECT id, date FROM products WHERE id BETWEEN ${start} AND ${end}`\n  )\n  return products.map((product) => ({\n    url: `${BASE_URL}/product/${product.id}`,\n    lastModified: product.date,\n  }))\n}"
  },
  {
    "id": "sitemap.mdx#11",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "```\n\n```js filename=\"app/product/sitemap.js\" switcher\nimport { BASE_URL } from '@/app/lib/constants'\n\nexport async function generateSitemaps() {\n  // Fetch the total number of products and calculate the number of sitemaps needed\n  return [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]\n}\n\nexport default async function sitemap(props) {\n  const id = await props.id\n  // Google's limit is 50,000 URLs per sitemap\n  const start = id * 50000\n  const end = start + 50000\n  const products = await getProducts(\n    `SELECT id, date FROM products WHERE id BETWEEN ${start} AND ${end}`\n  )\n  return products.map((product) => ({\n    url: `${BASE_URL}/product/${product.id}`,\n    lastModified: product.date,\n  }))\n}\n```\n\nYour generated sitemaps will be available at `/.../sitemap/[id]`. For example, `/product/sitemap/1.xml`.\n\nSee the [`generateSitemaps` API reference](/docs/app/api-reference/functions/generate-sitemaps) for more information."
  },
  {
    "id": "sitemap.mdx#12",
    "metadata": {
      "title": "sitemap.xml",
      "description": "API Reference for the sitemap.xml file."
    },
    "content": "## Returns\n\nThe default function exported from `sitemap.(xml|ts|js)` should return an array of objects with the following properties:\n\n```tsx\ntype Sitemap = Array<{\n  url: string\n  lastModified?: string | Date\n  changeFrequency?:\n    | 'always'\n    | 'hourly'\n    | 'daily'\n    | 'weekly'\n    | 'monthly'\n    | 'yearly'\n    | 'never'\n  priority?: number\n  alternates?: {\n    languages?: Languages<string>\n  }\n}>\n```\n\n## Version History\n\n| Version    | Changes                                                      |\n| ---------- | ------------------------------------------------------------ |\n| `v16.0.0`  | `id` is now a promise that resolves to a number.             |\n| `v14.2.0`  | Add localizations support.                                   |\n| `v13.4.14` | Add `changeFrequency` and `priority` attributes to sitemaps. |\n| `v13.3.0`  | `sitemap` introduced.                                        |"
  },
  {
    "id": "default.mdx#0",
    "metadata": {
      "title": "default.js",
      "description": "API Reference for the default.js file."
    },
    "content": "---\ntitle: default.js\ndescription: API Reference for the default.js file.\nrelated:\n  title: Learn more about Parallel Routes\n  links:\n    - app/api-reference/file-conventions/parallel-routes\n---\n\nThe `default.js` file is used to render a fallback within [Parallel Routes](/docs/app/api-reference/file-conventions/parallel-routes) when Next.js cannot recover a [slot's](/docs/app/api-reference/file-conventions/parallel-routes#slots) active state after a full-page load.\n\nDuring [soft navigation](/docs/app/getting-started/linking-and-navigating#client-side-transitions), Next.js keeps track of the active _state_ (subpage) for each slot. However, for hard navigations (full-page load), Next.js cannot recover the active state. In this case, a `default.js` file can be rendered for subpages that don't match the current URL.\n\nConsider the following folder structure. The `@team` slot has a `settings` page, but `@analytics` does not.\n\n<Image\n  alt=\"Parallel Routes unmatched routes\"\n  srcLight=\"/docs/light/parallel-routes-unmatched-routes.png\"\n  srcDark=\"/docs/dark/parallel-routes-unmatched-routes.png\"\n  width=\"1600\"\n  height=\"930\"\n/>"
  },
  {
    "id": "default.mdx#1",
    "metadata": {
      "title": "default.js",
      "description": "API Reference for the default.js file."
    },
    "content": "When navigating to `/settings`, the `@team` slot will render the `settings` page while maintaining the currently active page for the `@analytics` slot.\n\nOn refresh, Next.js will render a `default.js` for `@analytics`. If `default.js` doesn't exist, an error is returned for named slots (`@team`, `@analytics`, etc) and requires you to define a `default.js` in order to continue. If you want to preserve the old behavior of returning a 404 in these situations, you can create a `default.js` that contains:\n\n```tsx filename=\"app/@team/default.js\"\nimport { notFound } from 'next/navigation'\n\nexport default function Default() {\n  notFound()\n}"
  },
  {
    "id": "default.mdx#2",
    "metadata": {
      "title": "default.js",
      "description": "API Reference for the default.js file."
    },
    "content": "```\n\nAdditionally, since `children` is an implicit slot, you also need to create a `default.js` file to render a fallback for `children` when Next.js cannot recover the active state of the parent page. If you don't create a `default.js` for the `children` slot, it will return a 404 page for the route."
  },
  {
    "id": "default.mdx#3",
    "metadata": {
      "title": "default.js",
      "description": "API Reference for the default.js file."
    },
    "content": "## Reference"
  },
  {
    "id": "default.mdx#4",
    "metadata": {
      "title": "default.js",
      "description": "API Reference for the default.js file."
    },
    "content": "### `params` (optional)\n\nA promise that resolves to an object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) from the root segment down to the slot's subpages. For example:\n\n```tsx filename=\"app/[artist]/@sidebar/default.js\" switcher\nexport default async function Default({\n  params,\n}: {\n  params: Promise<{ artist: string }>\n}) {\n  const { artist } = await params\n}\n```\n\n```jsx filename=\"app/[artist]/@sidebar/default.js\" switcher\nexport default async function Default({ params }) {\n  const { artist } = await params\n}"
  },
  {
    "id": "default.mdx#5",
    "metadata": {
      "title": "default.js",
      "description": "API Reference for the default.js file."
    },
    "content": "```\n\n```jsx filename=\"app/[artist]/@sidebar/default.js\" switcher\nexport default async function Default({ params }) {\n  const { artist } = await params\n}\n```\n\n| Example                                    | URL          | `params`                                     |\n| ------------------------------------------ | ------------ | -------------------------------------------- |\n| `app/[artist]/@sidebar/default.js`         | `/zack`      | `Promise<{ artist: 'zack' }>`                |\n| `app/[artist]/[album]/@sidebar/default.js` | `/zack/next` | `Promise<{ artist: 'zack', album: 'next' }>` |\n\n- Since the `params` prop is a promise. You must use `async/await` or React's [`use`](https://react.dev/reference/react/use) function to access the values.\n  - In version 14 and earlier, `params` was a synchronous prop. To help with backwards compatibility, you can still access it synchronously in Next.js 15, but this behavior will be deprecated in the future."
  },
  {
    "id": "dynamic-routes.mdx#0",
    "metadata": {
      "title": "Dynamic Route Segments",
      "description": "Dynamic Route Segments can be used to programmatically generate route segments from dynamic data."
    },
    "content": "---\ntitle: Dynamic Route Segments\nnav_title: Dynamic Segments\ndescription: Dynamic Route Segments can be used to programmatically generate route segments from dynamic data.\nrelated:\n  title: Next Steps\n  description: For more information on what to do next, we recommend the following sections\n  links:\n    - app/api-reference/functions/generate-static-params\n---\n\nWhen you don't know the exact route segment names ahead of time and want to create routes from dynamic data, you can use Dynamic Segments that are filled in at request time or prerendered at build time."
  },
  {
    "id": "dynamic-routes.mdx#1",
    "metadata": {
      "title": "Dynamic Route Segments",
      "description": "Dynamic Route Segments can be used to programmatically generate route segments from dynamic data."
    },
    "content": "## Convention\n\nA Dynamic Segment can be created by wrapping a folder's name in square brackets: `[folderName]`. For example, a blog could include the following route `app/blog/[slug]/page.js` where `[slug]` is the Dynamic Segment for blog posts.\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = await params\n  return <div>My Post: {slug}</div>\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nexport default async function Page({ params }) {\n  const { slug } = await params\n  return <div>My Post: {slug}</div>\n}"
  },
  {
    "id": "dynamic-routes.mdx#2",
    "metadata": {
      "title": "Dynamic Route Segments",
      "description": "Dynamic Route Segments can be used to programmatically generate route segments from dynamic data."
    },
    "content": "```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nexport default async function Page({ params }) {\n  const { slug } = await params\n  return <div>My Post: {slug}</div>\n}\n```\n\nDynamic Segments are passed as the `params` prop to [`layout`](/docs/app/api-reference/file-conventions/layout), [`page`](/docs/app/api-reference/file-conventions/page), [`route`](/docs/app/api-reference/file-conventions/route), and [`generateMetadata`](/docs/app/api-reference/functions/generate-metadata#generatemetadata-function) functions.\n\n| Route                     | Example URL | `params`        |\n| ------------------------- | ----------- | --------------- |\n| `app/blog/[slug]/page.js` | `/blog/a`   | `{ slug: 'a' }` |\n| `app/blog/[slug]/page.js` | `/blog/b`   | `{ slug: 'b' }` |\n| `app/blog/[slug]/page.js` | `/blog/c`   | `{ slug: 'c' }` |"
  },
  {
    "id": "dynamic-routes.mdx#3",
    "metadata": {
      "title": "Dynamic Route Segments",
      "description": "Dynamic Route Segments can be used to programmatically generate route segments from dynamic data."
    },
    "content": "### In Client Components\n\nIn a Client Component **page**, dynamic segments from props can be accessed using the [`use`](https://react.dev/reference/react/use) hook.\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\n'use client'\nimport { use } from 'react'\n\nexport default function BlogPostPage({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = use(params)\n\n  return (\n    <div>\n      <p>{slug}</p>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\n'use client'\nimport { use } from 'react'\nimport { useParams } from 'next/navigation'\n\nexport default function BlogPostPage({ params }) {\n  const { slug } = use(params)\n\n  return (\n    <div>\n      <p>{slug}</p>\n    </div>\n  )\n}\n```\n\nAlternatively Client Components can use the [`useParams`](/docs/app/api-reference/functions/use-params) hook to access the `params` anywhere in the Client Component tree."
  },
  {
    "id": "dynamic-routes.mdx#4",
    "metadata": {
      "title": "Dynamic Route Segments",
      "description": "Dynamic Route Segments can be used to programmatically generate route segments from dynamic data."
    },
    "content": "### Catch-all Segments\n\nDynamic Segments can be extended to **catch-all** subsequent segments by adding an ellipsis inside the brackets `[...folderName]`.\n\nFor example, `app/shop/[...slug]/page.js` will match `/shop/clothes`, but also `/shop/clothes/tops`, `/shop/clothes/tops/t-shirts`, and so on.\n\n| Route                        | Example URL   | `params`                    |\n| ---------------------------- | ------------- | --------------------------- |\n| `app/shop/[...slug]/page.js` | `/shop/a`     | `{ slug: ['a'] }`           |\n| `app/shop/[...slug]/page.js` | `/shop/a/b`   | `{ slug: ['a', 'b'] }`      |\n| `app/shop/[...slug]/page.js` | `/shop/a/b/c` | `{ slug: ['a', 'b', 'c'] }` |"
  },
  {
    "id": "dynamic-routes.mdx#5",
    "metadata": {
      "title": "Dynamic Route Segments",
      "description": "Dynamic Route Segments can be used to programmatically generate route segments from dynamic data."
    },
    "content": "### Optional Catch-all Segments\n\nCatch-all Segments can be made **optional** by including the parameter in double square brackets: `[[...folderName]]`.\n\nFor example, `app/shop/[[...slug]]/page.js` will **also** match `/shop`, in addition to `/shop/clothes`, `/shop/clothes/tops`, `/shop/clothes/tops/t-shirts`.\n\nThe difference between **catch-all** and **optional catch-all** segments is that with optional, the route without the parameter is also matched (`/shop` in the example above).\n\n| Route                          | Example URL   | `params`                    |\n| ------------------------------ | ------------- | --------------------------- |\n| `app/shop/[[...slug]]/page.js` | `/shop`       | `{ slug: undefined }`       |\n| `app/shop/[[...slug]]/page.js` | `/shop/a`     | `{ slug: ['a'] }`           |\n| `app/shop/[[...slug]]/page.js` | `/shop/a/b`   | `{ slug: ['a', 'b'] }`      |\n| `app/shop/[[...slug]]/page.js` | `/shop/a/b/c` | `{ slug: ['a', 'b', 'c'] }` |"
  },
  {
    "id": "dynamic-routes.mdx#6",
    "metadata": {
      "title": "Dynamic Route Segments",
      "description": "Dynamic Route Segments can be used to programmatically generate route segments from dynamic data."
    },
    "content": "### TypeScript\n\nWhen using TypeScript, you can add types for `params` depending on your configured route segment — use [`PageProps<'/route'>`](/docs/app/api-reference/file-conventions/page#page-props-helper), [`LayoutProps<'/route'>`](/docs/app/api-reference/file-conventions/layout#layout-props-helper), or [`RouteContext<'/route'>`](/docs/app/api-reference/file-conventions/route#route-context-helper) to type `params` in `page`, `layout`, and `route` respectively.\n\nRoute `params` values are typed as `string`, `string[]`, or `undefined` (for optional catch-all segments), because their values aren't known until runtime. Users can enter any URL into the address bar, and these broad types help ensure that your application code handles all these possible cases."
  },
  {
    "id": "dynamic-routes.mdx#7",
    "metadata": {
      "title": "Dynamic Route Segments",
      "description": "Dynamic Route Segments can be used to programmatically generate route segments from dynamic data."
    },
    "content": "| Route                               | `params` Type Definition                 |\n| ----------------------------------- | ---------------------------------------- |\n| `app/blog/[slug]/page.js`           | `{ slug: string }`                       |\n| `app/shop/[...slug]/page.js`        | `{ slug: string[] }`                     |\n| `app/shop/[[...slug]]/page.js`      | `{ slug?: string[] }`                    |\n| `app/[categoryId]/[itemId]/page.js` | `{ categoryId: string, itemId: string }` |\n\nIf you're working on a route where `params` can only have a fixed number of valid values, such as a `[locale]` param with a known set of language codes, you can use runtime validation to handle any invalid params a user may enter, and let the rest of your application work with the narrower type from your known set.\n\n```tsx filename=\"/app/[locale]/page.tsx\"\nimport { notFound } from 'next/navigation'\nimport type { Locale } from '@i18n/types'\nimport { isValidLocale } from '@i18n/utils'\n\nfunction assertValidLocale(value: string): asserts value is Locale {\n  if (!isValidLocale(value)) notFound()\n}"
  },
  {
    "id": "dynamic-routes.mdx#8",
    "metadata": {
      "title": "Dynamic Route Segments",
      "description": "Dynamic Route Segments can be used to programmatically generate route segments from dynamic data."
    },
    "content": "function assertValidLocale(value: string): asserts value is Locale {\n  if (!isValidLocale(value)) notFound()\n}\n\nexport default async function Page(props: PageProps<'/[locale]'>) {\n  const { locale } = await props.params // locale is typed as string\n  assertValidLocale(locale)\n  // locale is now typed as Locale\n}\n```"
  },
  {
    "id": "dynamic-routes.mdx#9",
    "metadata": {
      "title": "Dynamic Route Segments",
      "description": "Dynamic Route Segments can be used to programmatically generate route segments from dynamic data."
    },
    "content": "## Behavior\n\n- Since the `params` prop is a promise. You must use `async`/`await` or React's use function to access the values.\n  - In version 14 and earlier, `params` was a synchronous prop. To help with backwards compatibility, you can still access it synchronously in Next.js 15, but this behavior will be deprecated in the future."
  },
  {
    "id": "dynamic-routes.mdx#10",
    "metadata": {
      "title": "Dynamic Route Segments",
      "description": "Dynamic Route Segments can be used to programmatically generate route segments from dynamic data."
    },
    "content": "## Examples\n\n### With `generateStaticParams`\n\nThe [`generateStaticParams`](/docs/app/api-reference/functions/generate-static-params) function can be used to [statically generate](/docs/app/guides/caching#static-rendering) routes at build time instead of on-demand at request time.\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  return posts.map((post) => ({\n    slug: post.slug,\n  }))\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  return posts.map((post) => ({\n    slug: post.slug,\n  }))\n}\n```\n\nWhen using `fetch` inside the `generateStaticParams` function, the requests are [automatically deduplicated](/docs/app/guides/caching#request-memoization). This avoids multiple network calls for the same data Layouts, Pages, and other `generateStaticParams` functions, speeding up build time."
  },
  {
    "id": "error.mdx#0",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "---\ntitle: error.js\ndescription: API reference for the error.js special file.\nrelated:\n  title: Learn more about error handling\n  links:\n    - app/getting-started/error-handling\n---\n\nAn **error** file allows you to handle unexpected runtime errors and display fallback UI.\n\n<Image\n  alt=\"error.js special file\"\n  srcLight=\"/docs/light/error-special-file.png\"\n  srcDark=\"/docs/dark/error-special-file.png\"\n  width=\"1600\"\n  height=\"606\"\n/>\n\n```tsx filename=\"app/dashboard/error.tsx\" switcher\n'use client' // Error boundaries must be Client Components\n\nimport { useEffect } from 'react'\n\nexport default function Error({\n  error,\n  reset,\n}: {\n  error: Error & { digest?: string }\n  reset: () => void\n}) {\n  useEffect(() => {\n    // Log the error to an error reporting service\n    console.error(error)\n  }, [error])\n\n  return (\n    <div>\n      <h2>Something went wrong!</h2>\n      <button\n        onClick={\n          // Attempt to recover by trying to re-render the segment\n          () => reset()\n        }\n      >\n        Try again\n      </button>\n    </div>\n  )\n}"
  },
  {
    "id": "error.mdx#1",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/error.js\" switcher\n'use client' // Error boundaries must be Client Components\n\nimport { useEffect } from 'react'\n\nexport default function Error({ error, reset }) {\n  useEffect(() => {\n    // Log the error to an error reporting service\n    console.error(error)\n  }, [error])\n\n  return (\n    <div>\n      <h2>Something went wrong!</h2>\n      <button\n        onClick={\n          // Attempt to recover by trying to re-render the segment\n          () => reset()\n        }\n      >\n        Try again\n      </button>\n    </div>\n  )\n}"
  },
  {
    "id": "error.mdx#2",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "```\n\n`error.js` wraps a route segment and its nested children in a [React Error Boundary](https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary). When an error throws within the boundary, the `error` component shows as the fallback UI.\n\n<Image\n  alt=\"How error.js works\"\n  srcLight=\"/docs/light/error-overview.png\"\n  srcDark=\"/docs/dark/error-overview.png\"\n  width=\"1600\"\n  height=\"903\"\n/>\n\n> **Good to know**:\n>\n> - The [React DevTools](https://react.dev/learn/react-developer-tools) allow you to toggle error boundaries to test error states.\n> - If you want errors to bubble up to the parent error boundary, you can `throw` when rendering the `error` component."
  },
  {
    "id": "error.mdx#3",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "## Reference"
  },
  {
    "id": "error.mdx#4",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "### Props\n\n#### `error`\n\nAn instance of an [`Error`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error) object forwarded to the `error.js` Client Component.\n\n> **Good to know:** During development, the `Error` object forwarded to the client will be serialized and include the `message` of the original error for easier debugging. However, **this behavior is different in production** to avoid leaking potentially sensitive details included in the error to the client.\n\n#### `error.message`\n\n- Errors forwarded from Client Components show the original `Error` message.\n- Errors forwarded from Server Components show a generic message with an identifier. This is to prevent leaking sensitive details. You can use the identifier, under `errors.digest`, to match the corresponding server-side logs.\n\n#### `error.digest`\n\nAn automatically generated hash of the error thrown. It can be used to match the corresponding error in server-side logs."
  },
  {
    "id": "error.mdx#5",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "#### `reset`\n\nThe cause of an error can sometimes be temporary. In these cases, trying again might resolve the issue.\n\nAn error component can use the `reset()` function to prompt the user to attempt to recover from the error. When executed, the function will try to re-render the error boundary's contents. If successful, the fallback error component is replaced with the result of the re-render.\n\n```tsx filename=\"app/dashboard/error.tsx\" switcher\n'use client' // Error boundaries must be Client Components\n\nexport default function Error({\n  error,\n  reset,\n}: {\n  error: Error & { digest?: string }\n  reset: () => void\n}) {\n  return (\n    <div>\n      <h2>Something went wrong!</h2>\n      <button onClick={() => reset()}>Try again</button>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/dashboard/error.js\" switcher\n'use client' // Error boundaries must be Client Components\n\nexport default function Error({ error, reset }) {\n  return (\n    <div>\n      <h2>Something went wrong!</h2>\n      <button onClick={() => reset()}>Try again</button>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "error.mdx#6",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "## Examples"
  },
  {
    "id": "error.mdx#7",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "### Global Error\n\nWhile less common, you can handle errors in the root layout or template using `global-error.jsx`, located in the root app directory, even when leveraging [internationalization](/docs/app/guides/internationalization). Global error UI must define its own `<html>` and `<body>` tags, global styles, fonts, or other dependencies that your error page requires. This file replaces the root layout or template when active.\n\n> **Good to know**: Error boundaries must be [Client Components](/docs/app/getting-started/server-and-client-components#using-client-components), which means that [`metadata` and `generateMetadata`](/docs/app/getting-started/metadata-and-og-images) exports are not supported in `global-error.jsx`. As an alternative, you can use the React [`<title>`](https://react.dev/reference/react-dom/components/title) component.\n\n```tsx filename=\"app/global-error.tsx\" switcher\n'use client' // Error boundaries must be Client Components"
  },
  {
    "id": "error.mdx#8",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "```tsx filename=\"app/global-error.tsx\" switcher\n'use client' // Error boundaries must be Client Components\n\nexport default function GlobalError({\n  error,\n  reset,\n}: {\n  error: Error & { digest?: string }\n  reset: () => void\n}) {\n  return (\n    // global-error must include html and body tags\n    <html>\n      <body>\n        <h2>Something went wrong!</h2>\n        <button onClick={() => reset()}>Try again</button>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "error.mdx#9",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "```\n\n```jsx filename=\"app/global-error.js\" switcher\n'use client' // Error boundaries must be Client Components\n\nexport default function GlobalError({ error, reset }) {\n  return (\n    // global-error must include html and body tags\n    <html>\n      <body>\n        <h2>Something went wrong!</h2>\n        <button onClick={() => reset()}>Try again</button>\n      </body>\n    </html>\n  )\n}\n```"
  },
  {
    "id": "error.mdx#10",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "### Graceful error recovery with a custom error boundary\n\nWhen rendering fails on the client, it can be useful to show the last known server rendered UI for a better user experience.\n\nThe `GracefullyDegradingErrorBoundary` is an example of a custom error boundary that captures and preserves the current HTML before an error occurs. If a rendering error happens, it re-renders the captured HTML and displays a persistent notification bar to inform the user.\n\n```tsx filename=\"app/dashboard/error.tsx\" switcher\n'use client'\n\nimport React, { Component, ErrorInfo, ReactNode } from 'react'\n\ninterface ErrorBoundaryProps {\n  children: ReactNode\n  onError?: (error: Error, errorInfo: ErrorInfo) => void\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean\n}\n\nexport class GracefullyDegradingErrorBoundary extends Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  private contentRef: React.RefObject<HTMLDivElement | null>\n\n  constructor(props: ErrorBoundaryProps) {\n    super(props)\n    this.state = { hasError: false }\n    this.contentRef = React.createRef()\n  }\n\n  static getDerivedStateFromError(_: Error): ErrorBoundaryState {\n    return { hasError: true }\n  }"
  },
  {
    "id": "error.mdx#11",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "static getDerivedStateFromError(_: Error): ErrorBoundaryState {\n    return { hasError: true }\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    if (this.props.onError) {\n      this.props.onError(error, errorInfo)\n    }\n  }\n\n  render() {\n    if (this.state.hasError) {\n      // Render the current HTML content without hydration\n      return (\n        <>\n          <div\n            ref={this.contentRef}\n            suppressHydrationWarning\n            dangerouslySetInnerHTML={{\n              __html: this.contentRef.current?.innerHTML || '',\n            }}\n          />\n          <div className=\"fixed bottom-0 left-0 right-0 bg-red-600 text-white py-4 px-6 text-center\">\n            <p className=\"font-semibold\">\n              An error occurred during page rendering\n            </p>\n          </div>\n        </>\n      )\n    }\n\n    return <div ref={this.contentRef}>{this.props.children}</div>\n  }\n}\n\nexport default GracefullyDegradingErrorBoundary"
  },
  {
    "id": "error.mdx#12",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/error.js\" switcher\n'use client'\n\nimport React, { Component, createRef } from 'react'\n\nclass GracefullyDegradingErrorBoundary extends Component {\n  constructor(props) {\n    super(props)\n    this.state = { hasError: false }\n    this.contentRef = createRef()\n  }\n\n  static getDerivedStateFromError(_) {\n    return { hasError: true }\n  }\n\n  componentDidCatch(error, errorInfo) {\n    if (this.props.onError) {\n      this.props.onError(error, errorInfo)\n    }\n  }\n\n  render() {\n    if (this.state.hasError) {\n      // Render the current HTML content without hydration\n      return (\n        <>\n          <div\n            ref={this.contentRef}\n            suppressHydrationWarning\n            dangerouslySetInnerHTML={{\n              __html: this.contentRef.current?.innerHTML || '',\n            }}\n          />\n          <div className=\"fixed bottom-0 left-0 right-0 bg-red-600 text-white py-4 px-6 text-center\">\n            <p className=\"font-semibold\">\n              An error occurred during page rendering\n            </p>\n          </div>\n        </>\n      )\n    }\n\n    return <div ref={this.contentRef}>{this.props.children}</div>\n  }\n}"
  },
  {
    "id": "error.mdx#13",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "return <div ref={this.contentRef}>{this.props.children}</div>\n  }\n}\n\nexport default GracefullyDegradingErrorBoundary\n```"
  },
  {
    "id": "error.mdx#14",
    "metadata": {
      "title": "error.js",
      "description": "API reference for the error.js special file."
    },
    "content": "## Version History\n\n| Version   | Changes                                     |\n| --------- | ------------------------------------------- |\n| `v15.2.0` | Also display `global-error` in development. |\n| `v13.1.0` | `global-error` introduced.                  |\n| `v13.0.0` | `error` introduced.                         |"
  },
  {
    "id": "forbidden.mdx#0",
    "metadata": {
      "title": "forbidden.js",
      "description": "API reference for the forbidden.js special file."
    },
    "content": "---\ntitle: forbidden.js\ndescription: API reference for the forbidden.js special file.\nrelated:\n  links:\n    - app/api-reference/functions/forbidden\nversion: experimental\n---\n\nThe **forbidden** file is used to render UI when the [`forbidden`](/docs/app/api-reference/functions/forbidden) function is invoked during authentication. Along with allowing you to customize the UI, Next.js will return a `403` status code.\n\n```tsx filename=\"app/forbidden.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Forbidden() {\n  return (\n    <div>\n      <h2>Forbidden</h2>\n      <p>You are not authorized to access this resource.</p>\n      <Link href=\"/\">Return Home</Link>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/forbidden.jsx\" switcher\nimport Link from 'next/link'\n\nexport default function Forbidden() {\n  return (\n    <div>\n      <h2>Forbidden</h2>\n      <p>You are not authorized to access this resource.</p>\n      <Link href=\"/\">Return Home</Link>\n    </div>\n  )\n}\n```\n\n## Reference\n\n### Props\n\n`forbidden.js` components do not accept any props."
  },
  {
    "id": "forbidden.mdx#1",
    "metadata": {
      "title": "forbidden.js",
      "description": "API reference for the forbidden.js special file."
    },
    "content": "## Reference\n\n### Props\n\n`forbidden.js` components do not accept any props.\n\n## Version History\n\n| Version   | Changes                    |\n| --------- | -------------------------- |\n| `v15.1.0` | `forbidden.js` introduced. |"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "File-system conventions",
      "description": "API Reference for Next.js file-system conventions."
    },
    "content": "---\ntitle: File-system conventions\ndescription: API Reference for Next.js file-system conventions.\n---"
  },
  {
    "id": "instrumentation-client.mdx#0",
    "metadata": {
      "title": "instrumentation-client.js",
      "description": "Learn how to add client-side instrumentation to track and monitor your Next.js application's frontend performance."
    },
    "content": "---\ntitle: instrumentation-client.js\ndescription: Learn how to add client-side instrumentation to track and monitor your Next.js application's frontend performance.\n---\n\nThe `instrumentation-client.js|ts` file allows you to add monitoring, analytics code, and other side-effects that run before your application becomes interactive. This is useful for setting up performance tracking, error monitoring, polyfills, or any other client-side observability tools.\n\nTo use it, place the file in the **root** of your application or inside a `src` folder."
  },
  {
    "id": "instrumentation-client.mdx#1",
    "metadata": {
      "title": "instrumentation-client.js",
      "description": "Learn how to add client-side instrumentation to track and monitor your Next.js application's frontend performance."
    },
    "content": "## Usage\n\nUnlike [server-side instrumentation](/docs/app/guides/instrumentation), you do not need to export any specific functions. You can write your monitoring code directly in the file:\n\n```ts filename=\"instrumentation-client.ts\" switcher\n// Set up performance monitoring\nperformance.mark('app-init')\n\n// Initialize analytics\nconsole.log('Analytics initialized')\n\n// Set up error tracking\nwindow.addEventListener('error', (event) => {\n  // Send to your error tracking service\n  reportError(event.error)\n})\n```\n\n```js filename=\"instrumentation-client.js\" switcher\n// Set up performance monitoring\nperformance.mark('app-init')\n\n// Initialize analytics\nconsole.log('Analytics initialized')\n\n// Set up error tracking\nwindow.addEventListener('error', (event) => {\n  // Send to your error tracking service\n  reportError(event.error)\n})\n```\n\n**Error handling:** Implement try-catch blocks around your instrumentation code to ensure robust monitoring. This prevents individual tracking failures from affecting other instrumentation features."
  },
  {
    "id": "instrumentation-client.mdx#2",
    "metadata": {
      "title": "instrumentation-client.js",
      "description": "Learn how to add client-side instrumentation to track and monitor your Next.js application's frontend performance."
    },
    "content": "## Router navigation tracking\n\nYou can export an `onRouterTransitionStart` function to receive notifications when navigation begins:\n\n```ts filename=\"instrumentation-client.ts\" switcher\nperformance.mark('app-init')\n\nexport function onRouterTransitionStart(\n  url: string,\n  navigationType: 'push' | 'replace' | 'traverse'\n) {\n  console.log(`Navigation started: ${navigationType} to ${url}`)\n  performance.mark(`nav-start-${Date.now()}`)\n}\n```\n\n```js filename=\"instrumentation-client.js\" switcher\nperformance.mark('app-init')\n\nexport function onRouterTransitionStart(url, navigationType) {\n  console.log(`Navigation started: ${navigationType} to ${url}`)\n  performance.mark(`nav-start-${Date.now()}`)\n}\n```\n\nThe `onRouterTransitionStart` function receives two parameters:\n\n- `url: string` - The URL being navigated to\n- `navigationType: 'push' | 'replace' | 'traverse'` - The type of navigation\n\n## Performance considerations\n\nKeep instrumentation code lightweight.\n\nNext.js monitors initialization time in development and will log warnings if it takes longer than 16ms, which could impact smooth page loading."
  },
  {
    "id": "instrumentation-client.mdx#3",
    "metadata": {
      "title": "instrumentation-client.js",
      "description": "Learn how to add client-side instrumentation to track and monitor your Next.js application's frontend performance."
    },
    "content": "## Execution timing\n\nThe `instrumentation-client.js` file executes at a specific point in the application lifecycle:\n\n1. **After** the HTML document is loaded\n2. **Before** React hydration begins\n3. **Before** user interactions are possible\n\nThis timing makes it ideal for setting up error tracking, analytics, and performance monitoring that needs to capture early application lifecycle events."
  },
  {
    "id": "instrumentation-client.mdx#4",
    "metadata": {
      "title": "instrumentation-client.js",
      "description": "Learn how to add client-side instrumentation to track and monitor your Next.js application's frontend performance."
    },
    "content": "## Examples\n\n### Error tracking\n\nInitialize error tracking before React starts and add navigation breadcrumbs for better debugging context.\n\n```ts filename=\"instrumentation-client.ts\" switcher\nimport Monitor from './lib/monitoring'\n\nMonitor.initialize()\n\nexport function onRouterTransitionStart(url: string) {\n  Monitor.pushEvent({\n    message: `Navigation to ${url}`,\n    category: 'navigation',\n  })\n}\n```\n\n```js filename=\"instrumentation-client.js\" switcher\nimport Monitor from './lib/monitoring'\n\nMonitor.initialize()\n\nexport function onRouterTransitionStart(url) {\n  Monitor.pushEvent({\n    message: `Navigation to ${url}`,\n    category: 'navigation',\n  })\n}\n```"
  },
  {
    "id": "instrumentation-client.mdx#5",
    "metadata": {
      "title": "instrumentation-client.js",
      "description": "Learn how to add client-side instrumentation to track and monitor your Next.js application's frontend performance."
    },
    "content": "### Analytics tracking\n\nInitialize analytics and track navigation events with detailed metadata for user behavior analysis.\n\n```ts filename=\"instrumentation-client.ts\" switcher\nimport { analytics } from './lib/analytics'\n\nanalytics.init()\n\nexport function onRouterTransitionStart(url: string, navigationType: string) {\n  analytics.track('page_navigation', {\n    url,\n    type: navigationType,\n    timestamp: Date.now(),\n  })\n}\n```\n\n```js filename=\"instrumentation-client.js\" switcher\nimport { analytics } from './lib/analytics'\n\nanalytics.init()\n\nexport function onRouterTransitionStart(url, navigationType) {\n  analytics.track('page_navigation', {\n    url,\n    type: navigationType,\n    timestamp: Date.now(),\n  })\n}\n```"
  },
  {
    "id": "instrumentation-client.mdx#6",
    "metadata": {
      "title": "instrumentation-client.js",
      "description": "Learn how to add client-side instrumentation to track and monitor your Next.js application's frontend performance."
    },
    "content": "### Performance monitoring\n\nTrack Time to Interactive and navigation performance using the Performance Observer API and performance marks.\n\n```ts filename=\"instrumentation-client.ts\" switcher\nconst startTime = performance.now()\n\nconst observer = new PerformanceObserver(\n  (list: PerformanceObserverEntryList) => {\n    for (const entry of list.getEntries()) {\n      if (entry instanceof PerformanceNavigationTiming) {\n        console.log('Time to Interactive:', entry.loadEventEnd - startTime)\n      }\n    }\n  }\n)\n\nobserver.observe({ entryTypes: ['navigation'] })\n\nexport function onRouterTransitionStart(url: string) {\n  performance.mark(`nav-start-${url}`)\n}\n```\n\n```js filename=\"instrumentation-client.js\" switcher\nconst startTime = performance.now()\n\nconst observer = new PerformanceObserver((list) => {\n  for (const entry of list.getEntries()) {\n    if (entry instanceof PerformanceNavigationTiming) {\n      console.log('Time to Interactive:', entry.loadEventEnd - startTime)\n    }\n  }\n})\n\nobserver.observe({ entryTypes: ['navigation'] })\n\nexport function onRouterTransitionStart(url) {\n  performance.mark(`nav-start-${url}`)\n}\n```"
  },
  {
    "id": "instrumentation-client.mdx#7",
    "metadata": {
      "title": "instrumentation-client.js",
      "description": "Learn how to add client-side instrumentation to track and monitor your Next.js application's frontend performance."
    },
    "content": "### Polyfills\n\nLoad polyfills before application code runs. Use static imports for immediate loading and dynamic imports for conditional loading based on feature detection.\n\n```ts filename=\"instrumentation-client.ts\" switcher\nimport './lib/polyfills'\n\nif (!window.ResizeObserver) {\n  import('./lib/polyfills/resize-observer').then((mod) => {\n    window.ResizeObserver = mod.default\n  })\n}\n```\n\n```js filename=\"instrumentation-client.js\" switcher\nimport './lib/polyfills'\n\nif (!window.ResizeObserver) {\n  import('./lib/polyfills/resize-observer').then((mod) => {\n    window.ResizeObserver = mod.default\n  })\n}\n```"
  },
  {
    "id": "instrumentation-client.mdx#8",
    "metadata": {
      "title": "instrumentation-client.js",
      "description": "Learn how to add client-side instrumentation to track and monitor your Next.js application's frontend performance."
    },
    "content": "## Version history\n\n| Version | Changes                             |\n| ------- | ----------------------------------- |\n| `v15.3` | `instrumentation-client` introduced |"
  },
  {
    "id": "instrumentation.mdx#0",
    "metadata": {
      "title": "instrumentation.js",
      "description": "API reference for the instrumentation.js file."
    },
    "content": "---\ntitle: instrumentation.js\ndescription: API reference for the instrumentation.js file.\nrelated:\n  title: Learn more about Instrumentation\n  links:\n    - app/guides/instrumentation\n---\n\nThe `instrumentation.js|ts` file is used to integrate observability tools into your application, allowing you to track the performance and behavior, and to debug issues in production.\n\nTo use it, place the file in the **root** of your application or inside a [`src` folder](/docs/app/api-reference/file-conventions/src-folder) if using one."
  },
  {
    "id": "instrumentation.mdx#1",
    "metadata": {
      "title": "instrumentation.js",
      "description": "API reference for the instrumentation.js file."
    },
    "content": "## Exports\n\n### `register` (optional)\n\nThe file exports a `register` function that is called **once** when a new Next.js server instance is initiated. `register` can be an async function.\n\n```ts filename=\"instrumentation.ts\" switcher\nimport { registerOTel } from '@vercel/otel'\n\nexport function register() {\n  registerOTel('next-app')\n}\n```\n\n```js filename=\"instrumentation.js\" switcher\nimport { registerOTel } from '@vercel/otel'\n\nexport function register() {\n  registerOTel('next-app')\n}\n```"
  },
  {
    "id": "instrumentation.mdx#2",
    "metadata": {
      "title": "instrumentation.js",
      "description": "API reference for the instrumentation.js file."
    },
    "content": "### `onRequestError` (optional)\n\nYou can optionally export an `onRequestError` function to track **server** errors to any custom observability provider.\n\n- If you're running any async tasks in `onRequestError`, make sure they're awaited. `onRequestError` will be triggered when the Next.js server captures the error.\n- The `error` instance might not be the original error instance thrown, as it may be processed by React if encountered during Server Components rendering. If this happens, you can use `digest` property on an error to identify the actual error type.\n\n```ts filename=\"instrumentation.ts\" switcher\nimport { type Instrumentation } from 'next'\n\nexport const onRequestError: Instrumentation.onRequestError = async (\n  err,\n  request,\n  context\n) => {\n  await fetch('https://.../report-error', {\n    method: 'POST',\n    body: JSON.stringify({\n      message: err.message,\n      request,\n      context,\n    }),\n    headers: {\n      'Content-Type': 'application/json',\n    },\n  })\n}"
  },
  {
    "id": "instrumentation.mdx#3",
    "metadata": {
      "title": "instrumentation.js",
      "description": "API reference for the instrumentation.js file."
    },
    "content": "```\n\n```js filename=\"instrumentation.js\" switcher\nexport async function onRequestError(err, request, context) {\n  await fetch('https://.../report-error', {\n    method: 'POST',\n    body: JSON.stringify({\n      message: err.message,\n      request,\n      context,\n    }),\n    headers: {\n      'Content-Type': 'application/json',\n    },\n  })\n}\n```"
  },
  {
    "id": "instrumentation.mdx#4",
    "metadata": {
      "title": "instrumentation.js",
      "description": "API reference for the instrumentation.js file."
    },
    "content": "#### Parameters\n\nThe function accepts three parameters: `error`, `request`, and `context`.\n\n```ts filename=\"Types\"\nexport function onRequestError(\n  error: { digest: string } & Error,\n  request: {\n    path: string // resource path, e.g. /blog?name=foo\n    method: string // request method. e.g. GET, POST, etc\n    headers: { [key: string]: string | string[] }\n  },\n  context: {\n    routerKind: 'Pages Router' | 'App Router' // the router type\n    routePath: string // the route file path, e.g. /app/blog/[dynamic]\n    routeType: 'render' | 'route' | 'action' | 'proxy' // the context in which the error occurred\n    renderSource:\n      | 'react-server-components'\n      | 'react-server-components-payload'\n      | 'server-rendering'\n    revalidateReason: 'on-demand' | 'stale' | undefined // undefined is a normal request without revalidation\n    renderType: 'dynamic' | 'dynamic-resume' // 'dynamic-resume' for PPR\n  }\n): void | Promise<void>"
  },
  {
    "id": "instrumentation.mdx#5",
    "metadata": {
      "title": "instrumentation.js",
      "description": "API reference for the instrumentation.js file."
    },
    "content": "```\n\n- `error`: The caught error itself (type is always `Error`), and a `digest` property which is the unique ID of the error.\n- `request`: Read-only request information associated with the error.\n- `context`: The context in which the error occurred. This can be the type of router (App or Pages Router), and/or (Server Components (`'render'`), Route Handlers (`'route'`), Server Actions (`'action'`), or Proxy (`'proxy'`))."
  },
  {
    "id": "instrumentation.mdx#6",
    "metadata": {
      "title": "instrumentation.js",
      "description": "API reference for the instrumentation.js file."
    },
    "content": "### Specifying the runtime\n\nThe `instrumentation.js` file works in both the Node.js and Edge runtime, however, you can use `process.env.NEXT_RUNTIME` to target a specific runtime.\n\n```js filename=\"instrumentation.js\"\nexport function register() {\n  if (process.env.NEXT_RUNTIME === 'edge') {\n    return require('./register.edge')\n  } else {\n    return require('./register.node')\n  }\n}\n\nexport function onRequestError() {\n  if (process.env.NEXT_RUNTIME === 'edge') {\n    return require('./on-request-error.edge')\n  } else {\n    return require('./on-request-error.node')\n  }\n}\n```"
  },
  {
    "id": "instrumentation.mdx#7",
    "metadata": {
      "title": "instrumentation.js",
      "description": "API reference for the instrumentation.js file."
    },
    "content": "## Version History\n\n| Version   | Changes                                                 |\n| --------- | ------------------------------------------------------- |\n| `v15.0.0` | `onRequestError` introduced, `instrumentation` stable   |\n| `v14.0.4` | Turbopack support for `instrumentation`                 |\n| `v13.2.0` | `instrumentation` introduced as an experimental feature |"
  },
  {
    "id": "intercepting-routes.mdx#0",
    "metadata": {
      "title": "Intercepting Routes",
      "description": "Use intercepting routes to load a new route within the current layout while masking the browser URL, useful for advanced routing patterns such as modals."
    },
    "content": "---\ntitle: Intercepting Routes\ndescription: Use intercepting routes to load a new route within the current layout while masking the browser URL, useful for advanced routing patterns such as modals.\nrelated:\n  title: Next Steps\n  description: Learn how to create modals with Intercepted and Parallel Routes.\n  links:\n    - app/api-reference/file-conventions/parallel-routes\n---\n\nIntercepting routes allows you to load a route from another part of your application within the current layout. This routing paradigm can be useful when you want to display the content of a route without the user switching to a different context.\n\nFor example, when clicking on a photo in a feed, you can display the photo in a modal, overlaying the feed. In this case, Next.js intercepts the `/photo/123` route, masks the URL, and overlays it over `/feed`.\n\n<Image\n  alt=\"Intercepting routes soft navigation\"\n  srcLight=\"/docs/light/intercepting-routes-soft-navigate.png\"\n  srcDark=\"/docs/dark/intercepting-routes-soft-navigate.png\"\n  width=\"1600\"\n  height=\"617\"\n/>"
  },
  {
    "id": "intercepting-routes.mdx#1",
    "metadata": {
      "title": "Intercepting Routes",
      "description": "Use intercepting routes to load a new route within the current layout while masking the browser URL, useful for advanced routing patterns such as modals."
    },
    "content": "However, when navigating to the photo by clicking a shareable URL or by refreshing the page, the entire photo page should render instead of the modal. No route interception should occur.\n\n<Image\n  alt=\"Intercepting routes hard navigation\"\n  srcLight=\"/docs/light/intercepting-routes-hard-navigate.png\"\n  srcDark=\"/docs/dark/intercepting-routes-hard-navigate.png\"\n  width=\"1600\"\n  height=\"604\"\n/>"
  },
  {
    "id": "intercepting-routes.mdx#2",
    "metadata": {
      "title": "Intercepting Routes",
      "description": "Use intercepting routes to load a new route within the current layout while masking the browser URL, useful for advanced routing patterns such as modals."
    },
    "content": "## Convention\n\nIntercepting routes can be defined with the `(..)` convention, which is similar to relative path convention `../` but for route segments.\n\nYou can use:\n\n- `(.)` to match segments on the **same level**\n- `(..)` to match segments **one level above**\n- `(..)(..)` to match segments **two levels above**\n- `(...)` to match segments from the **root** `app` directory\n\nFor example, you can intercept the `photo` segment from within the `feed` segment by creating a `(..)photo` directory.\n\n<Image\n  alt=\"Intercepting routes folder structure\"\n  srcLight=\"/docs/light/intercepted-routes-files.png\"\n  srcDark=\"/docs/dark/intercepted-routes-files.png\"\n  width=\"1600\"\n  height=\"604\"\n/>\n\n> **Good to know:** The `(..)` convention is based on _route segments_, not the file-system. For example, it does not consider `@slot` folders in [Parallel Routes](/docs/app/api-reference/file-conventions/parallel-routes)."
  },
  {
    "id": "intercepting-routes.mdx#3",
    "metadata": {
      "title": "Intercepting Routes",
      "description": "Use intercepting routes to load a new route within the current layout while masking the browser URL, useful for advanced routing patterns such as modals."
    },
    "content": "## Examples"
  },
  {
    "id": "intercepting-routes.mdx#4",
    "metadata": {
      "title": "Intercepting Routes",
      "description": "Use intercepting routes to load a new route within the current layout while masking the browser URL, useful for advanced routing patterns such as modals."
    },
    "content": "### Modals\n\nIntercepting Routes can be used together with [Parallel Routes](/docs/app/api-reference/file-conventions/parallel-routes) to create modals. This allows you to solve common challenges when building modals, such as:\n\n- Making the modal content **shareable through a URL**.\n- **Preserving context** when the page is refreshed, instead of closing the modal.\n- **Closing the modal on backwards navigation** rather than going to the previous route.\n- **Reopening the modal on forwards navigation**.\n\nConsider the following UI pattern, where a user can open a photo modal from a gallery using client-side navigation, or navigate to the photo page directly from a shareable URL:\n\n<Image\n  alt=\"Intercepting routes modal example\"\n  srcLight=\"/docs/light/intercepted-routes-modal-example.png\"\n  srcDark=\"/docs/dark/intercepted-routes-modal-example.png\"\n  width=\"1600\"\n  height=\"976\"\n/>\n\nIn the above example, the path to the `photo` segment can use the `(..)` matcher since `@modal` is a slot and **not** a segment. This means that the `photo` route is only one segment level higher, despite being two file-system levels higher."
  },
  {
    "id": "intercepting-routes.mdx#5",
    "metadata": {
      "title": "Intercepting Routes",
      "description": "Use intercepting routes to load a new route within the current layout while masking the browser URL, useful for advanced routing patterns such as modals."
    },
    "content": "See the [Parallel Routes](/docs/app/api-reference/file-conventions/parallel-routes#modals) documentation for a step-by-step example, or see our [image gallery example](https://github.com/vercel-labs/nextgram).\n\n> **Good to know:**\n>\n> - Other examples could include opening a login modal in a top navbar while also having a dedicated `/login` page, or opening a shopping cart in a side modal."
  },
  {
    "id": "layout.mdx#0",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "---\ntitle: layout.js\ndescription: API reference for the layout.js file.\n---\n\nThe `layout` file is used to define a layout in your Next.js application.\n\n```tsx filename=\"app/dashboard/layout.tsx\" switcher\nexport default function DashboardLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return <section>{children}</section>\n}\n```\n\n```jsx filename=\"app/dashboard/layout.js\" switcher\nexport default function DashboardLayout({ children }) {\n  return <section>{children}</section>\n}\n```\n\nA **root layout** is the top-most layout in the root `app` directory. It is used to define the `<html>` and `<body>` tags and other globally shared UI.\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  )\n}\n```"
  },
  {
    "id": "layout.mdx#1",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "## Reference"
  },
  {
    "id": "layout.mdx#2",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "### Props\n\n#### `children` (required)\n\nLayout components should accept and use a `children` prop. During rendering, `children` will be populated with the route segments the layout is wrapping. These will primarily be the component of a child [Layout](/docs/app/api-reference/file-conventions/page) (if it exists) or [Page](/docs/app/api-reference/file-conventions/page), but could also be other special files like [Loading](/docs/app/api-reference/file-conventions/loading) or [Error](/docs/app/getting-started/error-handling) when applicable."
  },
  {
    "id": "layout.mdx#3",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "#### `params` (optional)\n\nA promise that resolves to an object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) object from the root segment down to that layout.\n\n```tsx filename=\"app/dashboard/[team]/layout.tsx\" switcher\nexport default async function Layout({\n  children,\n  params,\n}: {\n  children: React.ReactNode\n  params: Promise<{ team: string }>\n}) {\n  const { team } = await params\n}\n```\n\n```jsx filename=\"app/dashboard/[team]/layout.js\" switcher\nexport default async function Layout({ children, params }) {\n  const { team } = await params\n}"
  },
  {
    "id": "layout.mdx#4",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/[team]/layout.js\" switcher\nexport default async function Layout({ children, params }) {\n  const { team } = await params\n}\n```\n\n| Example Route                     | URL            | `params`                           |\n| --------------------------------- | -------------- | ---------------------------------- |\n| `app/dashboard/[team]/layout.js`  | `/dashboard/1` | `Promise<{ team: '1' }>`           |\n| `app/shop/[tag]/[item]/layout.js` | `/shop/1/2`    | `Promise<{ tag: '1', item: '2' }>` |\n| `app/blog/[...slug]/layout.js`    | `/blog/1/2`    | `Promise<{ slug: ['1', '2'] }>`    |\n\n- Since the `params` prop is a promise. You must use `async/await` or React's [`use`](https://react.dev/reference/react/use) function to access the values.\n  - In version 14 and earlier, `params` was a synchronous prop. To help with backwards compatibility, you can still access it synchronously in Next.js 15, but this behavior will be deprecated in the future."
  },
  {
    "id": "layout.mdx#5",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "### Layout Props Helper\n\nYou can type layouts with `LayoutProps` to get a strongly typed `params` and named slots inferred from your directory structure. `LayoutProps` is a globally available helper.\n\n```tsx filename=\"app/dashboard/layout.tsx\"\nexport default function Layout(props: LayoutProps<'/dashboard'>) {\n  return (\n    <section>\n      {props.children}\n      {/* If you have app/dashboard/@analytics, it appears as a typed slot: */}\n      {/* {props.analytics} */}\n    </section>\n  )\n}\n```\n\n> **Good to know**:\n>\n> - Types are generated during `next dev`, `next build` or `next typegen`.\n> - After type generation, the `LayoutProps` helper is globally available. It doesn't need to be imported."
  },
  {
    "id": "layout.mdx#6",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "### Root Layout\n\nThe `app` directory **must** include a **root layout**, which is the top-most layout in the root `app` directory. Typically, the root layout is `app/layout.js`.\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html>\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return (\n    <html>\n      <body>{children}</body>\n    </html>\n  )\n}"
  },
  {
    "id": "layout.mdx#7",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function RootLayout({ children }) {\n  return (\n    <html>\n      <body>{children}</body>\n    </html>\n  )\n}\n```\n\n- The root layout **must** define `<html>` and `<body>` tags.\n  - You should **not** manually add `<head>` tags such as `<title>` and `<meta>` to root layouts. Instead, you should use the [Metadata API](/docs/app/getting-started/metadata-and-og-images) which automatically handles advanced requirements such as streaming and de-duplicating `<head>` elements.\n- You can use [route groups](/docs/app/api-reference/file-conventions/route-groups) to create **multiple root layouts**.\n  - Navigating **across multiple root layouts** will cause a **full page load** (as opposed to a client-side navigation). For example, navigating from `/cart` that uses `app/(shop)/layout.js` to `/blog` that uses `app/(marketing)/layout.js` will cause a full page load. This **only** applies to multiple root layouts.\n- The root layout can be under a **dynamic segment**, for example when implementing [internationalization](/docs/app/guides/internationalization) with `app/[lang]/layout.js`."
  },
  {
    "id": "layout.mdx#8",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "## Caveats"
  },
  {
    "id": "layout.mdx#9",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "### Request Object\n\nLayouts are cached in the client during navigation to avoid unnecessary server requests.\n\n[Layouts](/docs/app/api-reference/file-conventions/layout) do not rerender. They can be cached and reused to avoid unnecessary computation when navigating between pages. By restricting layouts from accessing the raw request, Next.js can prevent the execution of potentially slow or expensive user code within the layout, which could negatively impact performance.\n\nTo access the request object, you can use [`headers`](/docs/app/api-reference/functions/headers) and [`cookies`](/docs/app/api-reference/functions/cookies) APIs in [Server Components](/docs/app/getting-started/server-and-client-components) and Functions.\n\n```tsx filename=\"app/shop/layout.tsx\" switcher\nimport { cookies } from 'next/headers'\n\nexport default async function Layout({ children }) {\n  const cookieStore = await cookies()\n  const theme = cookieStore.get('theme')\n  return '...'\n}"
  },
  {
    "id": "layout.mdx#10",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "```\n\n```jsx filename=\"app/shop/layout.js\" switcher\nimport { cookies } from 'next/headers'\n\nexport default async function Layout({ children }) {\n  const cookieStore = await cookies()\n  const theme = cookieStore.get('theme')\n  return '...'\n}\n```"
  },
  {
    "id": "layout.mdx#11",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "### Query params\n\nLayouts do not rerender on navigation, so they cannot access search params which would otherwise become stale.\n\nTo access updated query parameters, you can use the Page [`searchParams`](/docs/app/api-reference/file-conventions/page#searchparams-optional) prop, or read them inside a Client Component using the [`useSearchParams`](/docs/app/api-reference/functions/use-search-params) hook. Since Client Components re-render on navigation, they have access to the latest query parameters.\n\n```tsx filename=\"app/ui/search.tsx\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function Search() {\n  const searchParams = useSearchParams()\n\n  const search = searchParams.get('search')\n\n  return '...'\n}\n```\n\n```jsx filename=\"app/ui/search.js\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function Search() {\n  const searchParams = useSearchParams()\n\n  const search = searchParams.get('search')\n\n  return '...'\n}"
  },
  {
    "id": "layout.mdx#12",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "```\n\n```tsx filename=\"app/shop/layout.tsx\" switcher\nimport Search from '@/app/ui/search'\n\nexport default function Layout({ children }) {\n  return (\n    <>\n      <Search />\n      {children}\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/shop/layout.js\" switcher\nimport Search from '@/app/ui/search'\n\nexport default function Layout({ children }) {\n  return (\n    <>\n      <Search />\n      {children}\n    </>\n  )\n}\n```"
  },
  {
    "id": "layout.mdx#13",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "### Pathname\n\nLayouts do not re-render on navigation, so they do not access pathname which would otherwise become stale.\n\nTo access the current pathname, you can read it inside a Client Component using the [`usePathname`](/docs/app/api-reference/functions/use-pathname) hook. Since Client Components re-render during navigation, they have access to the latest pathname.\n\n```tsx filename=\"app/ui/breadcrumbs.tsx\" switcher\n'use client'\n\nimport { usePathname } from 'next/navigation'\n\n// Simplified breadcrumbs logic\nexport default function Breadcrumbs() {\n  const pathname = usePathname()\n  const segments = pathname.split('/')\n\n  return (\n    <nav>\n      {segments.map((segment, index) => (\n        <span key={index}>\n          {' > '}\n          {segment}\n        </span>\n      ))}\n    </nav>\n  )\n}"
  },
  {
    "id": "layout.mdx#14",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "```\n\n```jsx filename=\"app/ui/breadcrumbs.js\" switcher\n'use client'\n\nimport { usePathname } from 'next/navigation'\n\n// Simplified breadcrumbs logic\nexport default function Breadcrumbs() {\n  const pathname = usePathname()\n  const segments = pathname.split('/')\n\n  return (\n    <nav>\n      {segments.map((segment, index) => (\n        <span key={index}>\n          {' > '}\n          {segment}\n        </span>\n      ))}\n    </nav>\n  )\n}\n```\n\n```tsx filename=\"app/docs/layout.tsx\" switcher\nimport { Breadcrumbs } from '@/app/ui/Breadcrumbs'\n\nexport default function Layout({ children }) {\n  return (\n    <>\n      <Breadcrumbs />\n      <main>{children}</main>\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/docs/layout.js\" switcher\nimport { Breadcrumbs } from '@/app/ui/Breadcrumbs'\n\nexport default function Layout({ children }) {\n  return (\n    <>\n      <Breadcrumbs />\n      <main>{children}</main>\n    </>\n  )\n}\n```"
  },
  {
    "id": "layout.mdx#15",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "### Fetching Data\n\nLayouts cannot pass data to their `children`. However, you can fetch the same data in a route more than once, and use React [`cache`](https://react.dev/reference/react/cache) to dedupe the requests without affecting performance.\n\nAlternatively, when using [`fetch`](/docs/app/api-reference/functions/fetch)in Next.js, requests are automatically deduped.\n\n```tsx filename=\"app/lib/data.ts\" switcher\nexport async function getUser(id: string) {\n  const res = await fetch(`https://.../users/${id}`)\n  return res.json()\n}\n```\n\n```tsx filename=\"app/dashboard/layout.tsx\" switcher\nimport { getUser } from '@/app/lib/data'\nimport { UserName } from '@/app/ui/user-name'\n\nexport default async function Layout({ children }) {\n  const user = await getUser('1')\n\n  return (\n    <>\n      <nav>\n        {/* ... */}\n        <UserName user={user.name} />\n      </nav>\n      {children}\n    </>\n  )\n}"
  },
  {
    "id": "layout.mdx#16",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/layout.js\" switcher\nimport { getUser } from '@/app/lib/data'\nimport { UserName } from '@/app/ui/user-name'\n\nexport default async function Layout({ children }) {\n  const user = await getUser('1')\n\n  return (\n    <>\n      <nav>\n        {/* ... */}\n        <UserName user={user.name} />\n      </nav>\n      {children}\n    </>\n  )\n}\n```\n\n```tsx filename=\"app/dashboard/page.tsx\" switcher\nimport { getUser } from '@/app/lib/data'\nimport { UserName } from '@/app/ui/user-name'\n\nexport default async function Page() {\n  const user = await getUser('1')\n\n  return (\n    <div>\n      <h1>Welcome {user.name}</h1>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/dashboard/page.js\" switcher\nimport { getUser } from '@/app/lib/data'\nimport { UserName } from '@/app/ui/user-name'\n\nexport default async function Page() {\n  const user = await getUser('1')\n\n  return (\n    <div>\n      <h1>Welcome {user.name}</h1>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "layout.mdx#17",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "### Accessing child segments\n\nLayouts do not have access to the route segments below itself. To access all route segments, you can use [`useSelectedLayoutSegment`](/docs/app/api-reference/functions/use-selected-layout-segment) or [`useSelectedLayoutSegments`](/docs/app/api-reference/functions/use-selected-layout-segments) in a Client Component.\n\n```tsx filename=\"app/ui/nav-link.tsx\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useSelectedLayoutSegment } from 'next/navigation'\n\nexport default function NavLink({\n  slug,\n  children,\n}: {\n  slug: string\n  children: React.ReactNode\n}) {\n  const segment = useSelectedLayoutSegment()\n  const isActive = slug === segment\n\n  return (\n    <Link\n      href={`/blog/${slug}`}\n      // Change style depending on whether the link is active\n      style={{ fontWeight: isActive ? 'bold' : 'normal' }}\n    >\n      {children}\n    </Link>\n  )\n}"
  },
  {
    "id": "layout.mdx#18",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "```\n\n```jsx filename=\"app/ui/nav-link.js\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useSelectedLayoutSegment } from 'next/navigation'\n\nexport default function NavLinks({ slug, children }) {\n  const segment = useSelectedLayoutSegment()\n  const isActive = slug === segment\n\n  return (\n    <Link\n      href={`/blog/${slug}`}\n      style={{ fontWeight: isActive ? 'bold' : 'normal' }}\n    >\n      {children}\n    </Link>\n  )\n}\n```\n\n```tsx filename=\"app/blog/layout.tsx\" switcher\nimport { NavLink } from './nav-link'\nimport getPosts from './get-posts'\n\nexport default async function Layout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  const featuredPosts = await getPosts()\n  return (\n    <div>\n      {featuredPosts.map((post) => (\n        <div key={post.id}>\n          <NavLink slug={post.slug}>{post.title}</NavLink>\n        </div>\n      ))}\n      <div>{children}</div>\n    </div>\n  )\n}"
  },
  {
    "id": "layout.mdx#19",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "```\n\n```jsx filename=\"app/blog/layout.js\" switcher\nimport { NavLink } from './nav-link'\nimport getPosts from './get-posts'\n\nexport default async function Layout({ children }) {\n  const featuredPosts = await getPosts()\n  return (\n    <div>\n      {featuredPosts.map((post) => (\n        <div key={post.id}>\n          <NavLink slug={post.slug}>{post.title}</NavLink>\n        </div>\n      ))}\n      <div>{children}</div>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "layout.mdx#20",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "## Examples\n\n### Metadata\n\nYou can modify the `<head>` HTML elements such as `title` and `meta` using the [`metadata` object](/docs/app/api-reference/functions/generate-metadata#the-metadata-object) or [`generateMetadata` function](/docs/app/api-reference/functions/generate-metadata#generatemetadata-function).\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: 'Next.js',\n}\n\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return '...'\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport const metadata = {\n  title: 'Next.js',\n}\n\nexport default function Layout({ children }) {\n  return '...'\n}\n```\n\n> **Good to know**: You should **not** manually add `<head>` tags such as `<title>` and `<meta>` to root layouts. Instead, use the [Metadata APIs](/docs/app/api-reference/functions/generate-metadata) which automatically handles advanced requirements such as streaming and de-duplicating `<head>` elements."
  },
  {
    "id": "layout.mdx#21",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "### Active Nav Links\n\nYou can use the [`usePathname`](/docs/app/api-reference/functions/use-pathname) hook to determine if a nav link is active.\n\nSince `usePathname` is a client hook, you need to extract the nav links into a Client Component, which can be imported into your layout:\n\n```tsx filename=\"app/ui/nav-links.tsx\" switcher\n'use client'\n\nimport { usePathname } from 'next/navigation'\nimport Link from 'next/link'\n\nexport function NavLinks() {\n  const pathname = usePathname()\n\n  return (\n    <nav>\n      <Link className={`link ${pathname === '/' ? 'active' : ''}`} href=\"/\">\n        Home\n      </Link>\n\n      <Link\n        className={`link ${pathname === '/about' ? 'active' : ''}`}\n        href=\"/about\"\n      >\n        About\n      </Link>\n    </nav>\n  )\n}"
  },
  {
    "id": "layout.mdx#22",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "```\n\n```jsx filename=\"app/ui/nav-links.js\" switcher\n'use client'\n\nimport { usePathname } from 'next/navigation'\nimport Link from 'next/link'\n\nexport function Links() {\n  const pathname = usePathname()\n\n  return (\n    <nav>\n      <Link className={`link ${pathname === '/' ? 'active' : ''}`} href=\"/\">\n        Home\n      </Link>\n\n      <Link\n        className={`link ${pathname === '/about' ? 'active' : ''}`}\n        href=\"/about\"\n      >\n        About\n      </Link>\n    </nav>\n  )\n}\n```\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { NavLinks } from '@/app/ui/nav-links'\n\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <NavLinks />\n        <main>{children}</main>\n      </body>\n    </html>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport { NavLinks } from '@/app/ui/nav-links'\n\nexport default function Layout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <NavLinks />\n        <main>{children}</main>\n      </body>\n    </html>\n  )\n}\n```"
  },
  {
    "id": "layout.mdx#23",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "### Displaying content based on `params`\n\nUsing [dynamic route segments](/docs/app/api-reference/file-conventions/dynamic-routes), you can display or fetch specific content based on the `params` prop.\n\n```tsx filename=\"app/dashboard/layout.tsx\" switcher\nexport default async function DashboardLayout({\n  children,\n  params,\n}: {\n  children: React.ReactNode\n  params: Promise<{ team: string }>\n}) {\n  const { team } = await params\n\n  return (\n    <section>\n      <header>\n        <h1>Welcome to {team}'s Dashboard</h1>\n      </header>\n      <main>{children}</main>\n    </section>\n  )\n}\n```\n\n```jsx filename=\"app/dashboard/layout.js\" switcher\nexport default async function DashboardLayout({ children, params }) {\n  const { team } = await params\n\n  return (\n    <section>\n      <header>\n        <h1>Welcome to {team}'s Dashboard</h1>\n      </header>\n      <main>{children}</main>\n    </section>\n  )\n}\n```"
  },
  {
    "id": "layout.mdx#24",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "### Reading `params` in Client Components\n\nTo use `params` in a Client Component (which cannot be `async`), you can use React's [`use`](https://react.dev/reference/react/use) function to read the promise:\n\n```tsx filename=\"app/page.tsx\" switcher\n'use client'\n\nimport { use } from 'react'\n\nexport default function Page({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = use(params)\n}\n```\n\n```js filename=\"app/page.js\" switcher\n'use client'\n\nimport { use } from 'react'\n\nexport default function Page({ params }) {\n  const { slug } = use(params)\n}\n```"
  },
  {
    "id": "layout.mdx#25",
    "metadata": {
      "title": "layout.js",
      "description": "API reference for the layout.js file."
    },
    "content": "## Version History\n\n| Version      | Changes                                                                                       |\n| ------------ | --------------------------------------------------------------------------------------------- |\n| `v15.0.0-RC` | `params` is now a promise. A [codemod](/docs/app/guides/upgrading/codemods#150) is available. |\n| `v13.0.0`    | `layout` introduced.                                                                          |"
  },
  {
    "id": "loading.mdx#0",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "---\ntitle: loading.js\ndescription: API reference for the loading.js file.\n---\n\nThe special file `loading.js` helps you create meaningful Loading UI with [React Suspense](https://react.dev/reference/react/Suspense). With this convention, you can show an [instant loading state](#instant-loading-states) from the server while the content of a route segment streams in. The new content is automatically swapped in once complete.\n\n<Image\n  alt=\"Loading UI\"\n  srcLight=\"/docs/light/loading-ui.png\"\n  srcDark=\"/docs/dark/loading-ui.png\"\n  width=\"1600\"\n  height=\"691\"\n/>\n\n```tsx filename=\"app/feed/loading.tsx\" switcher\nexport default function Loading() {\n  // Or a custom loading skeleton component\n  return <p>Loading...</p>\n}\n```\n\n```jsx filename=\"app/feed/loading.js\" switcher\nexport default function Loading() {\n  // Or a custom loading skeleton component\n  return <p>Loading...</p>\n}"
  },
  {
    "id": "loading.mdx#1",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "```\n\n```jsx filename=\"app/feed/loading.js\" switcher\nexport default function Loading() {\n  // Or a custom loading skeleton component\n  return <p>Loading...</p>\n}\n```\n\nInside the `loading.js` file, you can add any light-weight loading UI. You may find it helpful to use the [React Developer Tools](https://react.dev/learn/react-developer-tools) to manually toggle Suspense boundaries.\n\nBy default, this file is a [Server Component](/docs/app/getting-started/server-and-client-components) - but can also be used as a Client Component through the `\"use client\"` directive."
  },
  {
    "id": "loading.mdx#2",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "## Reference\n\n### Parameters\n\nLoading UI components do not accept any parameters."
  },
  {
    "id": "loading.mdx#3",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "## Behavior\n\n### Navigation\n\n- The Fallback UI is [prefetched](/docs/app/getting-started/linking-and-navigating#prefetching), making navigation immediate unless prefetching hasn't completed.\n- Navigation is interruptible, meaning changing routes does not need to wait for the content of the route to fully load before navigating to another route.\n- Shared layouts remain interactive while new route segments load."
  },
  {
    "id": "loading.mdx#4",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "### Instant Loading States\n\nAn instant loading state is fallback UI that is shown immediately upon navigation. You can pre-render loading indicators such as skeletons and spinners, or a small but meaningful part of future screens such as a cover photo, title, etc. This helps users understand the app is responding and provides a better user experience.\n\nCreate a loading state by adding a `loading.js` file inside a folder.\n\n<Image\n  alt=\"loading.js special file\"\n  srcLight=\"/docs/light/loading-special-file.png\"\n  srcDark=\"/docs/dark/loading-special-file.png\"\n  width=\"1600\"\n  height=\"606\"\n/>\n\n```tsx filename=\"app/dashboard/loading.tsx\" switcher\nexport default function Loading() {\n  // You can add any UI inside Loading, including a Skeleton.\n  return <LoadingSkeleton />\n}\n```\n\n```jsx filename=\"app/dashboard/loading.js\" switcher\nexport default function Loading() {\n  // You can add any UI inside Loading, including a Skeleton.\n  return <LoadingSkeleton />\n}"
  },
  {
    "id": "loading.mdx#5",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/loading.js\" switcher\nexport default function Loading() {\n  // You can add any UI inside Loading, including a Skeleton.\n  return <LoadingSkeleton />\n}\n```\n\nIn the same folder, `loading.js` will be nested inside `layout.js`. It will automatically wrap the `page.js` file and any children below in a `<Suspense>` boundary.\n\n<Image\n  alt=\"loading.js overview\"\n  srcLight=\"/docs/light/loading-overview.png\"\n  srcDark=\"/docs/dark/loading-overview.png\"\n  width=\"1600\"\n  height=\"768\"\n/>"
  },
  {
    "id": "loading.mdx#6",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "### SEO\n\n- For bots that only scrape static HTML, and cannot execute JavaScript like a full browser, such as Twitterbot, Next.js resolves [`generateMetadata`](/docs/app/api-reference/functions/generate-metadata) before streaming UI, and metadata is placed in the `<head>` of the initial HTML.\n- Otherwise, [streaming metadata](/docs/app/api-reference/functions/generate-metadata#streaming-metadata) may be used. Next.js automatically detects user agents to choose between blocking and streaming behavior.\n- Since streaming is server-rendered, it does not impact SEO. You can use the [Rich Results Test](https://search.google.com/test/rich-results) tool from Google to see how your page appears to Google's web crawlers and view the serialized HTML ([source](https://web.dev/rendering-on-the-web/#seo-considerations))."
  },
  {
    "id": "loading.mdx#7",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "### Status Codes\n\nWhen streaming, a `200` status code will be returned to signal that the request was successful.\n\nThe server can still communicate errors or issues to the client within the streamed content itself, for example, when using [`redirect`](/docs/app/api-reference/functions/redirect) or [`notFound`](/docs/app/api-reference/functions/not-found). Because the response headers have already been sent to the client, the status code of the response cannot be updated.\n\nFor example, when a 404 page is streamed to the client, Next.js includes a `<meta name=\"robots\" content=\"noindex\">` tag in the streamed HTML. This prevents search engines from indexing that URL even if the HTTP status is 200. See Google’s guidance on the [`robots` meta tag](https://developers.google.com/search/docs/crawling-indexing/robots-meta-tag).\n\nSome crawlers may label these responses as “soft 404s”. In the streaming case, this does not lead to indexation because the page is explicitly marked `noindex` in the HTML.\n\nIf you need a 404 status, for compliance or analytics, ensure the resource exists before the response body is streamed, so that the server can set the HTTP status code."
  },
  {
    "id": "loading.mdx#8",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "If you need a 404 status, for compliance or analytics, ensure the resource exists before the response body is streamed, so that the server can set the HTTP status code.\n\nYou can run this check in [`proxy`](/docs/app/api-reference/file-conventions/proxy) to rewrite missing slugs to a not-found route, or [produce a 404 response](/docs/app/api-reference/file-conventions/proxy#producing-a-response). Keep proxy checks fast, and avoid fetching full content there.\n\n<details>\n<summary>When is the response body streamed?</summary>\n\nThe response body starts streaming when a Suspense fallback renders (for example, a `loading.tsx`) or when a Server Component suspends under a `Suspense` boundary. Place `notFound()` before those boundaries and before any `await` that may suspend.\n\nTo start streaming, the response headers must be set. This is why it is not possible to change the status code after streaming started.\n\n</details>"
  },
  {
    "id": "loading.mdx#9",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "### Browser limits\n\n[Some browsers](https://bugs.webkit.org/show_bug.cgi?id=252413) buffer a streaming response. You may not see the streamed response until the response exceeds 1024 bytes. This typically only affects “hello world” applications, but not real applications."
  },
  {
    "id": "loading.mdx#10",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "## Platform Support\n\n| Deployment Option                                                   | Supported         |\n| ------------------------------------------------------------------- | ----------------- |\n| [Node.js server](/docs/app/getting-started/deploying#nodejs-server) | Yes               |\n| [Docker container](/docs/app/getting-started/deploying#docker)      | Yes               |\n| [Static export](/docs/app/getting-started/deploying#static-export)  | No                |\n| [Adapters](/docs/app/getting-started/deploying#adapters)            | Platform-specific |\n\nLearn how to [configure streaming](/docs/app/guides/self-hosting#streaming-and-suspense) when self-hosting Next.js."
  },
  {
    "id": "loading.mdx#11",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "## Examples"
  },
  {
    "id": "loading.mdx#12",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "### Streaming with Suspense\n\nIn addition to `loading.js`, you can also manually create Suspense Boundaries for your own UI components. The App Router supports streaming with [Suspense](https://react.dev/reference/react/Suspense).\n\n`<Suspense>` works by wrapping a component that performs an asynchronous action (e.g. fetch data), showing fallback UI (e.g. skeleton, spinner) while it's happening, and then swapping in your component once the action completes.\n\n```tsx filename=\"app/dashboard/page.tsx\" switcher\nimport { Suspense } from 'react'\nimport { PostFeed, Weather } from './Components'\n\nexport default function Posts() {\n  return (\n    <section>\n      <Suspense fallback={<p>Loading feed...</p>}>\n        <PostFeed />\n      </Suspense>\n      <Suspense fallback={<p>Loading weather...</p>}>\n        <Weather />\n      </Suspense>\n    </section>\n  )\n}"
  },
  {
    "id": "loading.mdx#13",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/page.js\" switcher\nimport { Suspense } from 'react'\nimport { PostFeed, Weather } from './Components'\n\nexport default function Posts() {\n  return (\n    <section>\n      <Suspense fallback={<p>Loading feed...</p>}>\n        <PostFeed />\n      </Suspense>\n      <Suspense fallback={<p>Loading weather...</p>}>\n        <Weather />\n      </Suspense>\n    </section>\n  )\n}\n```\n\nBy using Suspense, you get the benefits of:\n\n1. **Streaming Server Rendering** - Progressively rendering HTML from the server to the client.\n2. **Selective Hydration** - React prioritizes what components to make interactive first based on user interaction.\n\nFor more Suspense examples and use cases, please see the [React Documentation](https://react.dev/reference/react/Suspense)."
  },
  {
    "id": "loading.mdx#14",
    "metadata": {
      "title": "loading.js",
      "description": "API reference for the loading.js file."
    },
    "content": "## Version History\n\n| Version   | Changes               |\n| --------- | --------------------- |\n| `v13.0.0` | `loading` introduced. |"
  },
  {
    "id": "mdx-components.mdx#0",
    "metadata": {
      "title": "mdx-components.js",
      "description": "API reference for the mdx-components.js file."
    },
    "content": "---\ntitle: mdx-components.js\ndescription: API reference for the mdx-components.js file.\nrelated:\n  title: Learn more about MDX Components\n  links:\n    - app/guides/mdx\n---\n\nThe `mdx-components.js|tsx` file is **required** to use [`@next/mdx` with App Router](/docs/app/guides/mdx) and will not work without it. Additionally, you can use it to [customize styles](/docs/app/guides/mdx#using-custom-styles-and-components).\n\nUse the file `mdx-components.tsx` (or `.js`) in the root of your project to define MDX Components. For example, at the same level as `pages` or `app`, or inside `src` if applicable.\n\n```tsx filename=\"mdx-components.tsx\" switcher\nimport type { MDXComponents } from 'mdx/types'\n\nconst components: MDXComponents = {}\n\nexport function useMDXComponents(): MDXComponents {\n  return components\n}\n```\n\n```js filename=\"mdx-components.js\" switcher\nconst components = {}\n\nexport function useMDXComponents() {\n  return components\n}\n```"
  },
  {
    "id": "mdx-components.mdx#1",
    "metadata": {
      "title": "mdx-components.js",
      "description": "API reference for the mdx-components.js file."
    },
    "content": "## Exports\n\n### `useMDXComponents` function\n\nThe file must export a single function named `useMDXComponents`. This function does not accept any arguments.\n\n```tsx filename=\"mdx-components.tsx\" switcher\nimport type { MDXComponents } from 'mdx/types'\n\nconst components: MDXComponents = {}\n\nexport function useMDXComponents(): MDXComponents {\n  return components\n}\n```\n\n```js filename=\"mdx-components.js\" switcher\nconst components = {}\n\nexport function useMDXComponents() {\n  return components\n}\n```\n\n## Version History\n\n| Version   | Changes              |\n| --------- | -------------------- |\n| `v13.1.2` | MDX Components added |"
  },
  {
    "id": "not-found.mdx#0",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "---\ntitle: not-found.js\ndescription: API reference for the not-found.js file.\n---\n\nNext.js provides two conventions to handle not found cases:\n\n- **`not-found.js`**: Used when you call the [`notFound`](/docs/app/api-reference/functions/not-found) function in a route segment.\n- **`global-not-found.js`**: Used to define a global 404 page for unmatched routes across your entire app. This is handled at the routing level and doesn't depend on rendering a layout or page."
  },
  {
    "id": "not-found.mdx#1",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "## `not-found.js`\n\nThe **not-found** file is used to render UI when the [`notFound`](/docs/app/api-reference/functions/not-found) function is thrown within a route segment. Along with serving a custom UI, Next.js will return a `200` HTTP status code for streamed responses, and `404` for non-streamed responses.\n\n```tsx filename=\"app/not-found.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function NotFound() {\n  return (\n    <div>\n      <h2>Not Found</h2>\n      <p>Could not find requested resource</p>\n      <Link href=\"/\">Return Home</Link>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/blog/not-found.js\" switcher\nimport Link from 'next/link'\n\nexport default function NotFound() {\n  return (\n    <div>\n      <h2>Not Found</h2>\n      <p>Could not find requested resource</p>\n      <Link href=\"/\">Return Home</Link>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "not-found.mdx#2",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "## `global-not-found.js` (experimental)\n\nThe `global-not-found.js` file lets you define a 404 page for your entire application. Unlike `not-found.js`, which works at the route level, this is used when a requested URL doesn't match any route at all. Next.js **skips rendering** and directly returns this global page.\n\nThe `global-not-found.js` file bypasses your app's normal rendering, which means you'll need to import any global styles, fonts, or other dependencies that your 404 page requires.\n\n> **Good to know**: A smaller version of your global styles, and a simpler font family could improve performance of this page.\n\n`global-not-found.js` is useful when you can't build a 404 page using a combination of `layout.js` and `not-found.js`. This can happen in two cases:\n\n- Your app has multiple root layouts (e.g. `app/(admin)/layout.tsx` and `app/(shop)/layout.tsx`), so there's no single layout to compose a global 404 from.\n- Your root layout is defined using top-level dynamic segments (e.g. `app/[country]/layout.tsx`), which makes composing a consistent 404 page harder.\n\nTo enable it, add the `globalNotFound` flag in `next.config.ts`:"
  },
  {
    "id": "not-found.mdx#3",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "To enable it, add the `globalNotFound` flag in `next.config.ts`:\n\n```tsx filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    globalNotFound: true,\n  },\n}\n\nexport default nextConfig"
  },
  {
    "id": "not-found.mdx#4",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "```\n\nThen, create a file in the root of the `app` directory: `app/global-not-found.js`:\n\n```tsx filename=\"app/global-not-found.tsx\" switcher\n// Import global styles and fonts\nimport './globals.css'\nimport { Inter } from 'next/font/google'\nimport type { Metadata } from 'next'\n\nconst inter = Inter({ subsets: ['latin'] })\n\nexport const metadata: Metadata = {\n  title: '404 - Page Not Found',\n  description: 'The page you are looking for does not exist.',\n}\n\nexport default function GlobalNotFound() {\n  return (\n    <html lang=\"en\" className={inter.className}>\n      <body>\n        <h1>404 - Page Not Found</h1>\n        <p>This page does not exist.</p>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "not-found.mdx#5",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "```\n\n```jsx filename=\"app/global-not-found.js\" switcher\n// Import global styles and fonts\nimport './globals.css'\nimport { Inter } from 'next/font/google'\n\nconst inter = Inter({ subsets: ['latin'] })\n\nexport const metadata = {\n  title: '404 - Page Not Found',\n  description: 'The page you are looking for does not exist.',\n}\n\nexport default function GlobalNotFound() {\n  return (\n    <html lang=\"en\" className={inter.className}>\n      <body>\n        <h1>404 - Page Not Found</h1>\n        <p>This page does not exist.</p>\n      </body>\n    </html>\n  )\n}\n```\n\nUnlike `not-found.js`, this file must return a full HTML document, including `<html>` and `<body>` tags."
  },
  {
    "id": "not-found.mdx#6",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "## Reference\n\n### Props\n\n`not-found.js` or `global-not-found.js` components do not accept any props.\n\n> **Good to know**: In addition to catching expected `notFound()` errors, the root `app/not-found.js` and `app/global-not-found.js` files handle any unmatched URLs for your whole application. This means users that visit a URL that is not handled by your app will be shown the exported UI."
  },
  {
    "id": "not-found.mdx#7",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "## Examples"
  },
  {
    "id": "not-found.mdx#8",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "### Data Fetching\n\nBy default, `not-found` is a Server Component. You can mark it as `async` to fetch and display data:\n\n```tsx filename=\"app/not-found.tsx\" switcher\nimport Link from 'next/link'\nimport { headers } from 'next/headers'\n\nexport default async function NotFound() {\n  const headersList = await headers()\n  const domain = headersList.get('host')\n  const data = await getSiteData(domain)\n  return (\n    <div>\n      <h2>Not Found: {data.name}</h2>\n      <p>Could not find requested resource</p>\n      <p>\n        View <Link href=\"/blog\">all posts</Link>\n      </p>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/not-found.jsx\" switcher\nimport Link from 'next/link'\nimport { headers } from 'next/headers'\n\nexport default async function NotFound() {\n  const headersList = await headers()\n  const domain = headersList.get('host')\n  const data = await getSiteData(domain)\n  return (\n    <div>\n      <h2>Not Found: {data.name}</h2>\n      <p>Could not find requested resource</p>\n      <p>\n        View <Link href=\"/blog\">all posts</Link>\n      </p>\n    </div>\n  )\n}"
  },
  {
    "id": "not-found.mdx#9",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "```\n\nIf you need to use Client Component hooks like `usePathname` to display content based on the path, you must fetch data on the client-side instead."
  },
  {
    "id": "not-found.mdx#10",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "### Metadata\n\nFor `global-not-found.js`, you can export a `metadata` object or a [`generateMetadata`](/docs/app/api-reference/functions/generate-metadata) function to customize the `<title>`, `<meta>`, and other head tags for your 404 page:\n\n> **Good to know**: Next.js automatically injects `<meta name=\"robots\" content=\"noindex\" />` for pages that return a 404 status code, including `global-not-found.js` pages.\n\n```tsx filename=\"app/global-not-found.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: 'Not Found',\n  description: 'The page you are looking for does not exist.',\n}\n\nexport default function GlobalNotFound() {\n  return (\n    <html lang=\"en\">\n      <body>\n        <div>\n          <h1>Not Found</h1>\n          <p>The page you are looking for does not exist.</p>\n        </div>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "not-found.mdx#11",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "```\n\n```jsx filename=\"app/global-not-found.js\" switcher\nexport const metadata = {\n  title: 'Not Found',\n  description: 'The page you are looking for does not exist.',\n}\n\nexport default function GlobalNotFound() {\n  return (\n    <html lang=\"en\">\n      <body>\n        <div>\n          <h1>Not Found</h1>\n          <p>The page you are looking for does not exist.</p>\n        </div>\n      </body>\n    </html>\n  )\n}\n```"
  },
  {
    "id": "not-found.mdx#12",
    "metadata": {
      "title": "not-found.js",
      "description": "API reference for the not-found.js file."
    },
    "content": "## Version History\n\n| Version   | Changes                                             |\n| --------- | --------------------------------------------------- |\n| `v15.4.0` | `global-not-found.js` introduced (experimental).    |\n| `v13.3.0` | Root `app/not-found` handles global unmatched URLs. |\n| `v13.0.0` | `not-found` introduced.                             |"
  },
  {
    "id": "page.mdx#0",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "---\ntitle: page.js\ndescription: API reference for the page.js file.\n---\n\nThe `page` file allows you to define UI that is **unique** to a route. You can create a page by default exporting a component from the file:\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nexport default function Page({\n  params,\n  searchParams,\n}: {\n  params: Promise<{ slug: string }>\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}) {\n  return <h1>My Page</h1>\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nexport default function Page({ params, searchParams }) {\n  return <h1>My Page</h1>\n}\n```\n\n## Good to know\n\n- The `.js`, `.jsx`, or `.tsx` file extensions can be used for `page`.\n- A `page` is always the **leaf** of the route subtree.\n- A `page` file is required to make a route segment **publicly accessible**.\n- Pages are [Server Components](https://react.dev/reference/rsc/server-components) by default, but can be set to a [Client Component](https://react.dev/reference/rsc/use-client)."
  },
  {
    "id": "page.mdx#1",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "## Reference"
  },
  {
    "id": "page.mdx#2",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "### Props"
  },
  {
    "id": "page.mdx#3",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "#### `params` (optional)\n\nA promise that resolves to an object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) from the root segment down to that page.\n\n```tsx filename=\"app/shop/[slug]/page.tsx\" switcher\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = await params\n}\n```\n\n```jsx filename=\"app/shop/[slug]/page.js\" switcher\nexport default async function Page({ params }) {\n  const { slug } = await params\n}"
  },
  {
    "id": "page.mdx#4",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "```\n\n```jsx filename=\"app/shop/[slug]/page.js\" switcher\nexport default async function Page({ params }) {\n  const { slug } = await params\n}\n```\n\n| Example Route                        | URL         | `params`                                |\n| ------------------------------------ | ----------- | --------------------------------------- |\n| `app/shop/[slug]/page.js`            | `/shop/1`   | `Promise<{ slug: '1' }>`                |\n| `app/shop/[category]/[item]/page.js` | `/shop/1/2` | `Promise<{ category: '1', item: '2' }>` |\n| `app/shop/[...slug]/page.js`         | `/shop/1/2` | `Promise<{ slug: ['1', '2'] }>`         |\n\n- Since the `params` prop is a promise, you must use `async/await` or React's [`use`](https://react.dev/reference/react/use) function to access the values.\n  - In version 14 and earlier, `params` was a synchronous prop. To help with backwards compatibility, you can still access it synchronously in Next.js 15, but this behavior will be deprecated in the future."
  },
  {
    "id": "page.mdx#5",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "#### `searchParams` (optional)\n\nA promise that resolves to an object containing the [search parameters](https://developer.mozilla.org/docs/Learn/Common_questions/What_is_a_URL#parameters) of the current URL. For example:\n\n```tsx filename=\"app/shop/page.tsx\" switcher\nexport default async function Page({\n  searchParams,\n}: {\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}) {\n  const filters = (await searchParams).filters\n}\n```\n\n```jsx filename=\"app/shop/page.js\" switcher\nexport default async function Page({ searchParams }) {\n  const filters = (await searchParams).filters\n}\n```\n\nClient Component **pages** can also access `searchParams` using React’s [`use`](https://react.dev/reference/react/use) hook:\n\n```tsx filename=\"app/shop/page.tsx\" switcher\n'use client'\nimport { use } from 'react'\n\nexport default function Page({\n  searchParams,\n}: {\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}) {\n  const filters = use(searchParams).filters\n}\n```\n\n```jsx filename=\"app/page.jsx\" switcher\n'use client'\nimport { use } from 'react'\n\nexport default function Page({ searchParams }) {\n  const filters = use(searchParams).filters\n}"
  },
  {
    "id": "page.mdx#6",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "```\n\n```jsx filename=\"app/page.jsx\" switcher\n'use client'\nimport { use } from 'react'\n\nexport default function Page({ searchParams }) {\n  const filters = use(searchParams).filters\n}\n```\n\n| Example URL     | `searchParams`                |\n| --------------- | ----------------------------- |\n| `/shop?a=1`     | `Promise<{ a: '1' }>`         |\n| `/shop?a=1&b=2` | `Promise<{ a: '1', b: '2' }>` |\n| `/shop?a=1&a=2` | `Promise<{ a: ['1', '2'] }>`  |\n\n- Since the `searchParams` prop is a promise. You must use `async/await` or React's [`use`](https://react.dev/reference/react/use) function to access the values.\n  - In version 14 and earlier, `searchParams` was a synchronous prop. To help with backwards compatibility, you can still access it synchronously in Next.js 15, but this behavior will be deprecated in the future.\n- `searchParams` is a **[Dynamic API](/docs/app/guides/caching#dynamic-rendering)** whose values cannot be known ahead of time. Using it will opt the page into **[dynamic rendering](/docs/app/guides/caching#dynamic-rendering)** at request time.\n- `searchParams` is a plain JavaScript object, not a `URLSearchParams` instance."
  },
  {
    "id": "page.mdx#7",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "### Page Props Helper\n\nYou can type pages with `PageProps` to get strongly typed `params` and `searchParams` from the route literal. `PageProps` is a globally available helper.\n\n```tsx filename=\"app/blog/[slug]/page.tsx\"\nexport default async function Page(props: PageProps<'/blog/[slug]'>) {\n  const { slug } = await props.params\n  const query = await props.searchParams\n  return <h1>Blog Post: {slug}</h1>\n}\n```\n\n> **Good to know**\n>\n> - Using a literal route (e.g. `'/blog/[slug]'`) enables autocomplete and strict keys for `params`.\n> - Static routes resolve `params` to `{}`.\n> - Types are generated during `next dev`, `next build`, or with `next typegen`.\n> - After type generation, the `PageProps` helper is globally available. It doesn't need to be imported."
  },
  {
    "id": "page.mdx#8",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "## Examples\n\n### Displaying content based on `params`\n\nUsing [dynamic route segments](/docs/app/api-reference/file-conventions/dynamic-routes), you can display or fetch specific content for the page based on the `params` prop.\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = await params\n  return <h1>Blog Post: {slug}</h1>\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nexport default async function Page({ params }) {\n  const { slug } = await params\n  return <h1>Blog Post: {slug}</h1>\n}\n```"
  },
  {
    "id": "page.mdx#9",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "### Handling filtering with `searchParams`\n\nYou can use the `searchParams` prop to handle filtering, pagination, or sorting based on the query string of the URL.\n\n```tsx filename=\"app/shop/page.tsx\" switcher\nexport default async function Page({\n  searchParams,\n}: {\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}) {\n  const { page = '1', sort = 'asc', query = '' } = await searchParams\n\n  return (\n    <div>\n      <h1>Product Listing</h1>\n      <p>Search query: {query}</p>\n      <p>Current page: {page}</p>\n      <p>Sort order: {sort}</p>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/shop/page.js\" switcher\nexport default async function Page({ searchParams }) {\n  const { page = '1', sort = 'asc', query = '' } = await searchParams\n\n  return (\n    <div>\n      <h1>Product Listing</h1>\n      <p>Search query: {query}</p>\n      <p>Current page: {page}</p>\n      <p>Sort order: {sort}</p>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "page.mdx#10",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "### Reading `searchParams` and `params` in Client Components\n\nTo use `searchParams` and `params` in a Client Component (which cannot be `async`), you can use React's [`use`](https://react.dev/reference/react/use) function to read the promise:\n\n```tsx filename=\"app/page.tsx\" switcher\n'use client'\n\nimport { use } from 'react'\n\nexport default function Page({\n  params,\n  searchParams,\n}: {\n  params: Promise<{ slug: string }>\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}) {\n  const { slug } = use(params)\n  const { query } = use(searchParams)\n}\n```\n\n```js filename=\"app/page.js\" switcher\n'use client'\n\nimport { use } from 'react'\n\nexport default function Page({ params, searchParams }) {\n  const { slug } = use(params)\n  const { query } = use(searchParams)\n}\n```"
  },
  {
    "id": "page.mdx#11",
    "metadata": {
      "title": "page.js",
      "description": "API reference for the page.js file."
    },
    "content": "## Version History\n\n| Version      | Changes                                                                                                          |\n| ------------ | ---------------------------------------------------------------------------------------------------------------- |\n| `v15.0.0-RC` | `params` and `searchParams` are now promises. A [codemod](/docs/app/guides/upgrading/codemods#150) is available. |\n| `v13.0.0`    | `page` introduced.                                                                                               |"
  },
  {
    "id": "parallel-routes.mdx#0",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "---\ntitle: Parallel Routes\ndescription: Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications.\nrelated:\n  links:\n    - app/api-reference/file-conventions/default\n---\n\nParallel Routes allows you to simultaneously or conditionally render one or more pages within the same layout. They are useful for highly dynamic sections of an app, such as dashboards and feeds on social sites.\n\nFor example, considering a dashboard, you can use parallel routes to simultaneously render the `team` and `analytics` pages:\n\n<Image\n  alt=\"Parallel Routes Diagram\"\n  srcLight=\"/docs/light/parallel-routes.png\"\n  srcDark=\"/docs/dark/parallel-routes.png\"\n  width=\"1600\"\n  height=\"942\"\n/>"
  },
  {
    "id": "parallel-routes.mdx#1",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "## Convention"
  },
  {
    "id": "parallel-routes.mdx#2",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "### Slots\n\nParallel routes are created using named **slots**. Slots are defined with the `@folder` convention. For example, the following file structure defines two slots: `@analytics` and `@team`:\n\n<Image\n  alt=\"Parallel Routes File-system Structure\"\n  srcLight=\"/docs/light/parallel-routes-file-system.png\"\n  srcDark=\"/docs/dark/parallel-routes-file-system.png\"\n  width=\"1600\"\n  height=\"687\"\n/>\n\nSlots are passed as props to the shared parent layout. For the example above, the component in `app/layout.js` now accepts the `@analytics` and `@team` slots props, and can render them in parallel alongside the `children` prop:\n\n```tsx filename=\"app/layout.tsx\" switcher\nexport default function Layout({\n  children,\n  team,\n  analytics,\n}: {\n  children: React.ReactNode\n  analytics: React.ReactNode\n  team: React.ReactNode\n}) {\n  return (\n    <>\n      {children}\n      {team}\n      {analytics}\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function Layout({ children, team, analytics }) {\n  return (\n    <>\n      {children}\n      {team}\n      {analytics}\n    </>\n  )\n}"
  },
  {
    "id": "parallel-routes.mdx#3",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nexport default function Layout({ children, team, analytics }) {\n  return (\n    <>\n      {children}\n      {team}\n      {analytics}\n    </>\n  )\n}\n```\n\nHowever, slots are **not** route segments and do not affect the URL structure. For example, for `/@analytics/views`, the URL will be `/views` since `@analytics` is a slot. Slots are combined with the regular [Page](/docs/app/api-reference/file-conventions/page) component to form the final page associated with the route segment. Because of this, you cannot have separate [static](/docs/app/guides/caching#static-rendering) and [dynamic](/docs/app/guides/caching#dynamic-rendering) slots at the same route segment level. If one slot is dynamic, all slots at that level must be dynamic.\n\n> **Good to know**:\n>\n> - The `children` prop is an implicit slot that does not need to be mapped to a folder. This means `app/page.js` is equivalent to `app/@children/page.js`."
  },
  {
    "id": "parallel-routes.mdx#4",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "### `default.js`\n\nYou can define a `default.js` file to render as a fallback for unmatched slots during the initial load or full-page reload.\n\nConsider the following folder structure. The `@team` slot has a `/settings` page, but `@analytics` does not.\n\n<Image\n  alt=\"Parallel Routes unmatched routes\"\n  srcLight=\"/docs/light/parallel-routes-unmatched-routes.png\"\n  srcDark=\"/docs/dark/parallel-routes-unmatched-routes.png\"\n  width=\"1600\"\n  height=\"930\"\n/>\n\nWhen navigating to `/settings`, the `@team` slot will render the `/settings` page while maintaining the currently active page for the `@analytics` slot.\n\nOn refresh, Next.js will render a `default.js` for `@analytics`. If `default.js` doesn't exist, a `404` is rendered instead.\n\nAdditionally, since `children` is an implicit slot, you also need to create a `default.js` file to render a fallback for `children` when Next.js cannot recover the active state of the parent page."
  },
  {
    "id": "parallel-routes.mdx#5",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "## Behavior\n\nBy default, Next.js keeps track of the active _state_ (or subpage) for each slot. However, the content rendered within a slot will depend on the type of navigation:\n\n- [**Soft Navigation**](/docs/app/getting-started/linking-and-navigating#client-side-transitions): During client-side navigation, Next.js will perform a [partial render](/docs/app/getting-started/linking-and-navigating#client-side-transitions), changing the subpage within the slot, while maintaining the other slot's active subpages, even if they don't match the current URL.\n- **Hard Navigation**: After a full-page load (browser refresh), Next.js cannot determine the active state for the slots that don't match the current URL. Instead, it will render a [`default.js`](#defaultjs) file for the unmatched slots, or `404` if `default.js` doesn't exist.\n\n> **Good to know**:\n>\n> - The `404` for unmatched routes helps ensure that you don't accidentally render a parallel route on a page that it was not intended for."
  },
  {
    "id": "parallel-routes.mdx#6",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "## Examples\n\n### With `useSelectedLayoutSegment(s)`\n\nBoth [`useSelectedLayoutSegment`](/docs/app/api-reference/functions/use-selected-layout-segment) and [`useSelectedLayoutSegments`](/docs/app/api-reference/functions/use-selected-layout-segments) accept a `parallelRoutesKey` parameter, which allows you to read the active route segment within a slot.\n\n```tsx filename=\"app/layout.tsx\" switcher\n'use client'\n\nimport { useSelectedLayoutSegment } from 'next/navigation'\n\nexport default function Layout({ auth }: { auth: React.ReactNode }) {\n  const loginSegment = useSelectedLayoutSegment('auth')\n  // ...\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\n'use client'\n\nimport { useSelectedLayoutSegment } from 'next/navigation'\n\nexport default function Layout({ auth }) {\n  const loginSegment = useSelectedLayoutSegment('auth')\n  // ...\n}\n```\n\nWhen a user navigates to `app/@auth/login` (or `/login` in the URL bar), `loginSegment` will be equal to the string `\"login\"`."
  },
  {
    "id": "parallel-routes.mdx#7",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "### Conditional Routes\n\nYou can use Parallel Routes to conditionally render routes based on certain conditions, such as user role. For example, to render a different dashboard page for the `/admin` or `/user` roles:\n\n<Image\n  alt=\"Conditional routes diagram\"\n  srcLight=\"/docs/light/conditional-routes-ui.png\"\n  srcDark=\"/docs/dark/conditional-routes-ui.png\"\n  width=\"1600\"\n  height=\"898\"\n/>\n\n```tsx filename=\"app/dashboard/layout.tsx\" switcher\nimport { checkUserRole } from '@/lib/auth'\n\nexport default function Layout({\n  user,\n  admin,\n}: {\n  user: React.ReactNode\n  admin: React.ReactNode\n}) {\n  const role = checkUserRole()\n  return role === 'admin' ? admin : user\n}\n```\n\n```jsx filename=\"app/dashboard/layout.js\" switcher\nimport { checkUserRole } from '@/lib/auth'\n\nexport default function Layout({ user, admin }) {\n  const role = checkUserRole()\n  return role === 'admin' ? admin : user\n}\n```"
  },
  {
    "id": "parallel-routes.mdx#8",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "### Tab Groups\n\nYou can add a `layout` inside a slot to allow users to navigate the slot independently. This is useful for creating tabs.\n\nFor example, the `@analytics` slot has two subpages: `/page-views` and `/visitors`.\n\n<Image\n  alt=\"Analytics slot with two subpages and a layout\"\n  srcLight=\"/docs/light/parallel-routes-tab-groups.png\"\n  srcDark=\"/docs/dark/parallel-routes-tab-groups.png\"\n  width=\"1600\"\n  height=\"768\"\n/>\n\nWithin `@analytics`, create a [`layout`](/docs/app/api-reference/file-conventions/layout) file to share the tabs between the two pages:\n\n```tsx filename=\"app/@analytics/layout.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    <>\n      <nav>\n        <Link href=\"/page-views\">Page Views</Link>\n        <Link href=\"/visitors\">Visitors</Link>\n      </nav>\n      <div>{children}</div>\n    </>\n  )\n}"
  },
  {
    "id": "parallel-routes.mdx#9",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "```\n\n```jsx filename=\"app/@analytics/layout.js\" switcher\nimport Link from 'next/link'\n\nexport default function Layout({ children }) {\n  return (\n    <>\n      <nav>\n        <Link href=\"/page-views\">Page Views</Link>\n        <Link href=\"/visitors\">Visitors</Link>\n      </nav>\n      <div>{children}</div>\n    </>\n  )\n}\n```"
  },
  {
    "id": "parallel-routes.mdx#10",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "### Modals\n\nParallel Routes can be used together with [Intercepting Routes](/docs/app/api-reference/file-conventions/intercepting-routes) to create modals that support deep linking. This allows you to solve common challenges when building modals, such as:\n\n- Making the modal content **shareable through a URL**.\n- **Preserving context** when the page is refreshed, instead of closing the modal.\n- **Closing the modal on backwards navigation** rather than going to the previous route.\n- **Reopening the modal on forwards navigation**.\n\nConsider the following UI pattern, where a user can open a login modal from a layout using client-side navigation, or access a separate `/login` page:\n\n<Image\n  alt=\"Parallel Routes Diagram\"\n  srcLight=\"/docs/light/parallel-routes-auth-modal.png\"\n  srcDark=\"/docs/dark/parallel-routes-auth-modal.png\"\n  width=\"1600\"\n  height=\"687\"\n/>\n\nTo implement this pattern, start by creating a `/login` route that renders your **main** login page.\n\n<Image\n  alt=\"Parallel Routes Diagram\"\n  srcLight=\"/docs/light/parallel-routes-modal-login-page.png\"\n  srcDark=\"/docs/dark/parallel-routes-modal-login-page.png\"\n  width=\"1600\"\n  height=\"768\"\n/>"
  },
  {
    "id": "parallel-routes.mdx#11",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "<Image\n  alt=\"Parallel Routes Diagram\"\n  srcLight=\"/docs/light/parallel-routes-modal-login-page.png\"\n  srcDark=\"/docs/dark/parallel-routes-modal-login-page.png\"\n  width=\"1600\"\n  height=\"768\"\n/>\n\n```tsx filename=\"app/login/page.tsx\" switcher\nimport { Login } from '@/app/ui/login'\n\nexport default function Page() {\n  return <Login />\n}"
  },
  {
    "id": "parallel-routes.mdx#12",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "```\n\n```jsx filename=\"app/login/page.js\" switcher\nimport { Login } from '@/app/ui/login'\n\nexport default function Page() {\n  return <Login />\n}\n```\n\nThen, inside the `@auth` slot, add [`default.js`](/docs/app/api-reference/file-conventions/default) file that returns `null`. This ensures that the modal is not rendered when it's not active.\n\n```tsx filename=\"app/@auth/default.tsx\" switcher\nexport default function Default() {\n  return null\n}\n```\n\n```jsx filename=\"app/@auth/default.js\" switcher\nexport default function Default() {\n  return null\n}\n```\n\nInside your `@auth` slot, intercept the `/login` route by importing the `<Modal>` component and its children into the `@auth/(.)login/page.tsx` file, and updating the folder name to `/@auth/(.)login/page.tsx`.\n\n```tsx filename=\"app/@auth/(.)login/page.tsx\" switcher\nimport { Modal } from '@/app/ui/modal'\nimport { Login } from '@/app/ui/login'\n\nexport default function Page() {\n  return (\n    <Modal>\n      <Login />\n    </Modal>\n  )\n}"
  },
  {
    "id": "parallel-routes.mdx#13",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "```\n\n```jsx filename=\"app/@auth/(.)login/page.js\" switcher\nimport { Modal } from '@/app/ui/modal'\nimport { Login } from '@/app/ui/login'\n\nexport default function Page() {\n  return (\n    <Modal>\n      <Login />\n    </Modal>\n  )\n}\n```\n\n> **Good to know:**\n>\n> - The convention `(.)` is used for intercepting routes. See [Intercepting Routes](/docs/app/api-reference/file-conventions/intercepting-routes#convention) docs for more information.\n> - By separating the `<Modal>` functionality from the modal content (`<Login>`), you can ensure any content inside the modal, e.g. [forms](/docs/app/guides/forms), are Server Components. See [Interleaving Client and Server Components](/docs/app/getting-started/server-and-client-components#examples#supported-pattern-passing-server-components-to-client-components-as-props) for more information."
  },
  {
    "id": "parallel-routes.mdx#14",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "#### Opening the modal\n\nNow, you can leverage the Next.js router to open and close the modal. This ensures the URL is correctly updated when the modal is open, and when navigating backwards and forwards.\n\nTo open the modal, pass the `@auth` slot as a prop to the parent layout and render it alongside the `children` prop.\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport Link from 'next/link'\n\nexport default function Layout({\n  auth,\n  children,\n}: {\n  auth: React.ReactNode\n  children: React.ReactNode\n}) {\n  return (\n    <>\n      <nav>\n        <Link href=\"/login\">Open modal</Link>\n      </nav>\n      <div>{auth}</div>\n      <div>{children}</div>\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nimport Link from 'next/link'\n\nexport default function Layout({ auth, children }) {\n  return (\n    <>\n      <nav>\n        <Link href=\"/login\">Open modal</Link>\n      </nav>\n      <div>{auth}</div>\n      <div>{children}</div>\n    </>\n  )\n}\n```\n\nWhen the user clicks the `<Link>`, the modal will open instead of navigating to the `/login` page. However, on refresh or initial load, navigating to `/login` will take the user to the main login page."
  },
  {
    "id": "parallel-routes.mdx#15",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "#### Closing the modal\n\nYou can close the modal by calling `router.back()` or by using the `Link` component.\n\n```tsx filename=\"app/ui/modal.tsx\" switcher\n'use client'\n\nimport { useRouter } from 'next/navigation'\n\nexport function Modal({ children }: { children: React.ReactNode }) {\n  const router = useRouter()\n\n  return (\n    <>\n      <button\n        onClick={() => {\n          router.back()\n        }}\n      >\n        Close modal\n      </button>\n      <div>{children}</div>\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/ui/modal.js\" switcher\n'use client'\n\nimport { useRouter } from 'next/navigation'\n\nexport function Modal({ children }) {\n  const router = useRouter()\n\n  return (\n    <>\n      <button\n        onClick={() => {\n          router.back()\n        }}\n      >\n        Close modal\n      </button>\n      <div>{children}</div>\n    </>\n  )\n}"
  },
  {
    "id": "parallel-routes.mdx#16",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "```\n\nWhen using the `Link` component to navigate away from a page that shouldn't render the `@auth` slot anymore, we need to make sure the parallel route matches to a component that returns `null`. For example, when navigating back to the root page, we create a `@auth/page.tsx` component:\n\n```tsx filename=\"app/ui/modal.tsx\" switcher\nimport Link from 'next/link'\n\nexport function Modal({ children }: { children: React.ReactNode }) {\n  return (\n    <>\n      <Link href=\"/\">Close modal</Link>\n      <div>{children}</div>\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/ui/modal.js\" switcher\nimport Link from 'next/link'\n\nexport function Modal({ children }) {\n  return (\n    <>\n      <Link href=\"/\">Close modal</Link>\n      <div>{children}</div>\n    </>\n  )\n}\n```\n\n```tsx filename=\"app/@auth/page.tsx\" switcher\nexport default function Page() {\n  return null\n}\n```\n\n```jsx filename=\"app/@auth/page.js\" switcher\nexport default function Page() {\n  return null\n}\n```\n\nOr if navigating to any other page (such as `/foo`, `/foo/bar`, etc), you can use a catch-all slot:\n\n```tsx filename=\"app/@auth/[...catchAll]/page.tsx\" switcher\nexport default function CatchAll() {\n  return null\n}"
  },
  {
    "id": "parallel-routes.mdx#17",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "```\n\n```jsx filename=\"app/@auth/[...catchAll]/page.js\" switcher\nexport default function CatchAll() {\n  return null\n}\n```\n\n> **Good to know:**\n>\n> - We use a catch-all route in our `@auth` slot to close the modal because of how parallel routes behave. Since client-side navigations to a route that no longer match the slot will remain visible, we need to match the slot to a route that returns `null` to close the modal.\n> - Other examples could include opening a photo modal in a gallery while also having a dedicated `/photo/[id]` page, or opening a shopping cart in a side modal.\n> - [View an example](https://github.com/vercel-labs/nextgram) of modals with Intercepted and Parallel Routes."
  },
  {
    "id": "parallel-routes.mdx#18",
    "metadata": {
      "title": "Parallel Routes",
      "description": "Simultaneously render one or more pages in the same view that can be navigated independently. A pattern for highly dynamic applications."
    },
    "content": "### Loading and Error UI\n\nParallel Routes can be streamed independently, allowing you to define independent error and loading states for each route:\n\n<Image\n  alt=\"Parallel routes enable custom error and loading states\"\n  srcLight=\"/docs/light/parallel-routes-cinematic-universe.png\"\n  srcDark=\"/docs/dark/parallel-routes-cinematic-universe.png\"\n  width=\"1600\"\n  height=\"1218\"\n/>\n\nSee the [Loading UI](/docs/app/api-reference/file-conventions/loading) and [Error Handling](/docs/app/getting-started/error-handling) documentation for more information."
  },
  {
    "id": "proxy.mdx#0",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "---\ntitle: proxy.js\ndescription: API reference for the proxy.js file.\nrelated:\n  title: Learn more about Proxy\n  links:\n    - app/api-reference/functions/next-request\n    - app/api-reference/functions/next-response\n---\n\n> **Note**: The `middleware` file convention is deprecated and has been renamed to `proxy`. See [Migration to Proxy](#migration-to-proxy) for more details.\n\nThe `proxy.js|ts` file is used to write [Proxy](/docs/app/getting-started/proxy) and run code on the server before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly.\n\nProxy executes before routes are rendered. It's particularly useful for implementing custom server-side logic like authentication, logging, or handling redirects."
  },
  {
    "id": "proxy.mdx#1",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "Proxy executes before routes are rendered. It's particularly useful for implementing custom server-side logic like authentication, logging, or handling redirects.\n\n> **Good to know**:\n>\n> Proxy is meant to be invoked separately of your render code and in optimized cases deployed to your CDN for fast redirect/rewrite handling, you should not attempt relying on shared modules or globals.\n>\n> To pass information from Proxy to your application, use [headers](#setting-headers), [cookies](#using-cookies), [rewrites](/docs/app/api-reference/functions/next-response#rewrite), [redirects](/docs/app/api-reference/functions/next-response#redirect), or the URL.\n\nCreate a `proxy.ts` (or `.js`) file in the project root, or inside `src` if applicable, so that it is located at the same level as `pages` or `app`.\n\nIf you’ve customized [`pageExtensions`](/docs/app/api-reference/config/next-config-js/pageExtensions), for example to `.page.ts` or `.page.js`, name your file `proxy.page.ts` or `proxy.page.js` accordingly.\n\n```tsx filename=\"proxy.ts\" switcher\nimport { NextResponse, NextRequest } from 'next/server'"
  },
  {
    "id": "proxy.mdx#2",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```tsx filename=\"proxy.ts\" switcher\nimport { NextResponse, NextRequest } from 'next/server'\n\n// This function can be marked `async` if using `await` inside\nexport function proxy(request: NextRequest) {\n  return NextResponse.redirect(new URL('/home', request.url))\n}\n\nexport const config = {\n  matcher: '/about/:path*',\n}"
  },
  {
    "id": "proxy.mdx#3",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\n\n// This function can be marked `async` if using `await` inside\nexport function proxy(request) {\n  return NextResponse.redirect(new URL('/home', request.url))\n}\n\nexport const config = {\n  matcher: '/about/:path*',\n}\n```"
  },
  {
    "id": "proxy.mdx#4",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "## Exports\n\n### Proxy function\n\nThe file must export a single function, either as a default export or named `proxy`. Note that multiple proxy from the same file are not supported.\n\n```js filename=\"proxy.js\"\n// Example of default export\nexport default function proxy(request) {\n  // Proxy logic\n}\n```\n\n### Config object (optional)\n\nOptionally, a config object can be exported alongside the Proxy function. This object includes the [matcher](#matcher) to specify paths where the Proxy applies."
  },
  {
    "id": "proxy.mdx#5",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "### Matcher\n\nThe `matcher` option allows you to target specific paths for the Proxy to run on. You can specify these paths in several ways:\n\n- For a single path: Directly use a string to define the path, like `'/about'`.\n- For multiple paths: Use an array to list multiple paths, such as `matcher: ['/about', '/contact']`, which applies the Proxy to both `/about` and `/contact`.\n\n```js filename=\"proxy.js\"\nexport const config = {\n  matcher: ['/about/:path*', '/dashboard/:path*'],\n}\n```\n\nAdditionally, the `matcher` option supports complex path specifications using regular expressions. For example, you can exclude certain paths with a regular expression matcher:\n\n```js filename=\"proxy.js\"\nexport const config = {\n  matcher: [\n    // Exclude API routes, static files, image optimizations, and .png files\n    '/((?!api|_next/static|_next/image|.*\\\\.png$).*)',\n  ],\n}"
  },
  {
    "id": "proxy.mdx#6",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```\n\nThis enables precise control over which paths to include or exclude.\n\nThe `matcher` option accepts an array of objects with the following keys:\n\n- `source`: The path or pattern used to match the request paths. It can be a string for direct path matching or a pattern for more complex matching.\n- `locale` (optional): A boolean that, when set to `false`, ignores locale-based routing in path matching.\n- `has` (optional): Specifies conditions based on the presence of specific request elements such as headers, query parameters, or cookies.\n- `missing` (optional): Focuses on conditions where certain request elements are absent, like missing headers or cookies.\n\n```js filename=\"proxy.js\"\nexport const config = {\n  matcher: [\n    {\n      source: '/api/:path*',\n      locale: false,\n      has: [\n        { type: 'header', key: 'Authorization', value: 'Bearer Token' },\n        { type: 'query', key: 'userId', value: '123' },\n      ],\n      missing: [{ type: 'cookie', key: 'session', value: 'active' }],\n    },\n  ],\n}"
  },
  {
    "id": "proxy.mdx#7",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```\n\nConfigured matchers:\n\n1. MUST start with `/`\n2. Can include named parameters: `/about/:path` matches `/about/a` and `/about/b` but not `/about/a/c`\n3. Can have modifiers on named parameters (starting with `:`): `/about/:path*` matches `/about/a/b/c` because `*` is _zero or more_. `?` is _zero or one_ and `+` _one or more_\n4. Can use regular expression enclosed in parenthesis: `/about/(.*)` is the same as `/about/:path*`\n5. Are anchored to the start of the path: `/about` matches `/about` and `/about/team` but not `/blog/about`\n\nRead more details on [path-to-regexp](https://github.com/pillarjs/path-to-regexp#path-to-regexp-1) documentation.\n\n> **Good to know**:\n>\n> - The `matcher` values need to be constants so they can be statically analyzed at build-time. Dynamic values such as variables will be ignored.\n> - For backward compatibility, Next.js always considers `/public` as `/public/index`. Therefore, a matcher of `/public/:path` will match."
  },
  {
    "id": "proxy.mdx#8",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "## Params\n\n### `request`\n\nWhen defining Proxy, the default export function accepts a single parameter, `request`. This parameter is an instance of `NextRequest`, which represents the incoming HTTP request.\n\n```tsx filename=\"proxy.ts\" switcher\nimport type { NextRequest } from 'next/server'\n\nexport function proxy(request: NextRequest) {\n  // Proxy logic goes here\n}\n```\n\n```js filename=\"proxy.js\" switcher\nexport function proxy(request) {\n  // Proxy logic goes here\n}\n```\n\n> **Good to know**:\n>\n> - `NextRequest` is a type that represents incoming HTTP requests in Next.js Proxy, whereas [`NextResponse`](#nextresponse) is a class used to manipulate and send back HTTP responses."
  },
  {
    "id": "proxy.mdx#9",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "## NextResponse\n\nThe `NextResponse` API allows you to:\n\n- `redirect` the incoming request to a different URL\n- `rewrite` the response by displaying a given URL\n- Set request headers for API Routes, `getServerSideProps`, and `rewrite` destinations\n- Set response cookies\n- Set response headers\n\n<AppOnly>\n\nTo produce a response from Proxy, you can:\n\n1. `rewrite` to a route ([Page](/docs/app/api-reference/file-conventions/page) or [Route Handler](/docs/app/api-reference/file-conventions/route)) that produces a response\n2. return a `NextResponse` directly. See [Producing a Response](#producing-a-response)\n\n> **Good to know**: For redirects, you can also use `Response.redirect` instead of `NextResponse.redirect`.\n\n</AppOnly>\n\n<PagesOnly>\n\nTo produce a response from Proxy, you can:\n\n1. `rewrite` to a route ([Page](/docs/pages/building-your-application/routing/pages-and-layouts) or [Edge API Route](/docs/pages/building-your-application/routing/api-routes)) that produces a response\n2. return a `NextResponse` directly. See [Producing a Response](#producing-a-response)\n\n</PagesOnly>"
  },
  {
    "id": "proxy.mdx#10",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "## Execution order\n\nProxy will be invoked for **every route in your project**. Given this, it's crucial to use [matchers](#matcher) to precisely target or exclude specific routes. The following is the execution order:\n\n1. `headers` from `next.config.js`\n2. `redirects` from `next.config.js`\n3. Proxy (`rewrites`, `redirects`, etc.)\n4. `beforeFiles` (`rewrites`) from `next.config.js`\n5. Filesystem routes (`public/`, `_next/static/`, `pages/`, `app/`, etc.)\n6. `afterFiles` (`rewrites`) from `next.config.js`\n7. Dynamic Routes (`/blog/[slug]`)\n8. `fallback` (`rewrites`) from `next.config.js`\n\n## Runtime\n\nProxy defaults to using the Node.js runtime. The [`runtime`](/docs/app/api-reference/file-conventions/route-segment-config#runtime) config option is not available in Proxy files. Setting the `runtime` config option in Proxy will throw an error."
  },
  {
    "id": "proxy.mdx#11",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "## Advanced Proxy flags\n\nIn `v13.1` of Next.js two additional flags were introduced for proxy, `skipMiddlewareUrlNormalize` and `skipTrailingSlashRedirect` to handle advanced use cases.\n\n`skipTrailingSlashRedirect` disables Next.js redirects for adding or removing trailing slashes. This allows custom handling inside proxy to maintain the trailing slash for some paths but not others, which can make incremental migrations easier.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  skipTrailingSlashRedirect: true,\n}\n```\n\n```js filename=\"proxy.js\"\nconst legacyPrefixes = ['/docs', '/blog']\n\nexport default async function proxy(req) {\n  const { pathname } = req.nextUrl\n\n  if (legacyPrefixes.some((prefix) => pathname.startsWith(prefix))) {\n    return NextResponse.next()\n  }\n\n  // apply trailing slash handling\n  if (\n    !pathname.endsWith('/') &&\n    !pathname.match(/((?!\\.well-known(?:\\/.*)?)(?:[^/]+\\/)*[^/]+\\.\\w+)/)\n  ) {\n    return NextResponse.redirect(\n      new URL(`${req.nextUrl.pathname}/`, req.nextUrl)\n    )\n  }\n}"
  },
  {
    "id": "proxy.mdx#12",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```\n\n`skipMiddlewareUrlNormalize` allows for disabling the URL normalization in Next.js to make handling direct visits and client-transitions the same. In some advanced cases, this option provides full control by using the original URL.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  skipMiddlewareUrlNormalize: true,\n}\n```\n\n```js filename=\"proxy.js\"\nexport default async function proxy(req) {\n  const { pathname } = req.nextUrl\n\n  // GET /_next/data/build-id/hello.json\n\n  console.log(pathname)\n  // with the flag this now /_next/data/build-id/hello.json\n  // without the flag this would be normalized to /hello\n}\n```"
  },
  {
    "id": "proxy.mdx#13",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "## Examples\n\n### Conditional Statements\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n\nexport function proxy(request: NextRequest) {\n  if (request.nextUrl.pathname.startsWith('/about')) {\n    return NextResponse.rewrite(new URL('/about-2', request.url))\n  }\n\n  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n    return NextResponse.rewrite(new URL('/dashboard/user', request.url))\n  }\n}\n```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\n\nexport function proxy(request) {\n  if (request.nextUrl.pathname.startsWith('/about')) {\n    return NextResponse.rewrite(new URL('/about-2', request.url))\n  }\n\n  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n    return NextResponse.rewrite(new URL('/dashboard/user', request.url))\n  }\n}\n```"
  },
  {
    "id": "proxy.mdx#14",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "### Using Cookies\n\nCookies are regular headers. On a `Request`, they are stored in the `Cookie` header. On a `Response` they are in the `Set-Cookie` header. Next.js provides a convenient way to access and manipulate these cookies through the `cookies` extension on `NextRequest` and `NextResponse`.\n\n1. For incoming requests, `cookies` comes with the following methods: `get`, `getAll`, `set`, and `delete` cookies. You can check for the existence of a cookie with `has` or remove all cookies with `clear`.\n2. For outgoing responses, `cookies` have the following methods `get`, `getAll`, `set`, and `delete`.\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n\nexport function proxy(request: NextRequest) {\n  // Assume a \"Cookie:nextjs=fast\" header to be present on the incoming request\n  // Getting cookies from the request using the `RequestCookies` API\n  let cookie = request.cookies.get('nextjs')\n  console.log(cookie) // => { name: 'nextjs', value: 'fast', Path: '/' }\n  const allCookies = request.cookies.getAll()\n  console.log(allCookies) // => [{ name: 'nextjs', value: 'fast' }]"
  },
  {
    "id": "proxy.mdx#15",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "request.cookies.has('nextjs') // => true\n  request.cookies.delete('nextjs')\n  request.cookies.has('nextjs') // => false\n\n  // Setting cookies on the response using the `ResponseCookies` API\n  const response = NextResponse.next()\n  response.cookies.set('vercel', 'fast')\n  response.cookies.set({\n    name: 'vercel',\n    value: 'fast',\n    path: '/',\n  })\n  cookie = response.cookies.get('vercel')\n  console.log(cookie) // => { name: 'vercel', value: 'fast', Path: '/' }\n  // The outgoing response will have a `Set-Cookie:vercel=fast;path=/` header.\n\n  return response\n}"
  },
  {
    "id": "proxy.mdx#16",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\n\nexport function proxy(request) {\n  // Assume a \"Cookie:nextjs=fast\" header to be present on the incoming request\n  // Getting cookies from the request using the `RequestCookies` API\n  let cookie = request.cookies.get('nextjs')\n  console.log(cookie) // => { name: 'nextjs', value: 'fast', Path: '/' }\n  const allCookies = request.cookies.getAll()\n  console.log(allCookies) // => [{ name: 'nextjs', value: 'fast' }]\n\n  request.cookies.has('nextjs') // => true\n  request.cookies.delete('nextjs')\n  request.cookies.has('nextjs') // => false\n\n  // Setting cookies on the response using the `ResponseCookies` API\n  const response = NextResponse.next()\n  response.cookies.set('vercel', 'fast')\n  response.cookies.set({\n    name: 'vercel',\n    value: 'fast',\n    path: '/',\n  })\n  cookie = response.cookies.get('vercel')\n  console.log(cookie) // => { name: 'vercel', value: 'fast', Path: '/' }\n  // The outgoing response will have a `Set-Cookie:vercel=fast;path=/` header.\n\n  return response\n}\n```"
  },
  {
    "id": "proxy.mdx#17",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "### Setting Headers\n\nYou can set request and response headers using the `NextResponse` API (setting _request_ headers is available since Next.js v13.0.0).\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n\nexport function proxy(request: NextRequest) {\n  // Clone the request headers and set a new header `x-hello-from-proxy1`\n  const requestHeaders = new Headers(request.headers)\n  requestHeaders.set('x-hello-from-proxy1', 'hello')\n\n  // You can also set request headers in NextResponse.next\n  const response = NextResponse.next({\n    request: {\n      // New request headers\n      headers: requestHeaders,\n    },\n  })\n\n  // Set a new response header `x-hello-from-proxy2`\n  response.headers.set('x-hello-from-proxy2', 'hello')\n  return response\n}"
  },
  {
    "id": "proxy.mdx#18",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\n\nexport function proxy(request) {\n  // Clone the request headers and set a new header `x-hello-from-proxy1`\n  const requestHeaders = new Headers(request.headers)\n  requestHeaders.set('x-hello-from-proxy1', 'hello')\n\n  // You can also set request headers in NextResponse.next\n  const response = NextResponse.next({\n    request: {\n      // New request headers\n      headers: requestHeaders,\n    },\n  })\n\n  // Set a new response header `x-hello-from-proxy2`\n  response.headers.set('x-hello-from-proxy2', 'hello')\n  return response\n}\n```\n\nNote that the snippet uses:\n\n- `NextResponse.next({ request: { headers: requestHeaders } })` to make `requestHeaders` available upstream\n- **NOT** `NextResponse.next({ headers: requestHeaders })` which makes `requestHeaders` available to clients\n\nLearn more in [NextResponse headers in Proxy](/docs/app/api-reference/functions/next-response#next).\n\n> **Good to know**: Avoid setting large headers as it might cause [431 Request Header Fields Too Large](https://developer.mozilla.org/docs/Web/HTTP/Status/431) error depending on your backend web server configuration."
  },
  {
    "id": "proxy.mdx#19",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "### CORS\n\nYou can set CORS headers in Proxy to allow cross-origin requests, including [simple](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests) and [preflighted](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#preflighted_requests) requests.\n\n```tsx filename=\"proxy.ts\" switcher\nimport { NextRequest, NextResponse } from 'next/server'\n\nconst allowedOrigins = ['https://acme.com', 'https://my-app.org']\n\nconst corsOptions = {\n  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n}\n\nexport function proxy(request: NextRequest) {\n  // Check the origin from the request\n  const origin = request.headers.get('origin') ?? ''\n  const isAllowedOrigin = allowedOrigins.includes(origin)\n\n  // Handle preflighted requests\n  const isPreflight = request.method === 'OPTIONS'\n\n  if (isPreflight) {\n    const preflightHeaders = {\n      ...(isAllowedOrigin && { 'Access-Control-Allow-Origin': origin }),\n      ...corsOptions,\n    }\n    return NextResponse.json({}, { headers: preflightHeaders })\n  }\n\n  // Handle simple requests\n  const response = NextResponse.next()"
  },
  {
    "id": "proxy.mdx#20",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "// Handle simple requests\n  const response = NextResponse.next()\n\n  if (isAllowedOrigin) {\n    response.headers.set('Access-Control-Allow-Origin', origin)\n  }\n\n  Object.entries(corsOptions).forEach(([key, value]) => {\n    response.headers.set(key, value)\n  })\n\n  return response\n}\n\nexport const config = {\n  matcher: '/api/:path*',\n}"
  },
  {
    "id": "proxy.mdx#21",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```\n\n```jsx filename=\"proxy.js\" switcher\nimport { NextResponse } from 'next/server'\n\nconst allowedOrigins = ['https://acme.com', 'https://my-app.org']\n\nconst corsOptions = {\n  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n}\n\nexport function proxy(request) {\n  // Check the origin from the request\n  const origin = request.headers.get('origin') ?? ''\n  const isAllowedOrigin = allowedOrigins.includes(origin)\n\n  // Handle preflighted requests\n  const isPreflight = request.method === 'OPTIONS'\n\n  if (isPreflight) {\n    const preflightHeaders = {\n      ...(isAllowedOrigin && { 'Access-Control-Allow-Origin': origin }),\n      ...corsOptions,\n    }\n    return NextResponse.json({}, { headers: preflightHeaders })\n  }\n\n  // Handle simple requests\n  const response = NextResponse.next()\n\n  if (isAllowedOrigin) {\n    response.headers.set('Access-Control-Allow-Origin', origin)\n  }\n\n  Object.entries(corsOptions).forEach(([key, value]) => {\n    response.headers.set(key, value)\n  })\n\n  return response\n}\n\nexport const config = {\n  matcher: '/api/:path*',\n}"
  },
  {
    "id": "proxy.mdx#22",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```\n\n<AppOnly>\n\n> **Good to know:** You can configure CORS headers for individual routes in [Route Handlers](/docs/app/api-reference/file-conventions/route#cors).\n\n</AppOnly>"
  },
  {
    "id": "proxy.mdx#23",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "### Producing a response\n\nYou can respond from Proxy directly by returning a `Response` or `NextResponse` instance. (This is available since [Next.js v13.1.0](https://nextjs.org/blog/next-13-1#nextjs-advanced-proxy))\n\n```ts filename=\"proxy.ts\" switcher\nimport type { NextRequest } from 'next/server'\nimport { isAuthenticated } from '@lib/auth'\n\n// Limit the proxy to paths starting with `/api/`\nexport const config = {\n  matcher: '/api/:function*',\n}\n\nexport function proxy(request: NextRequest) {\n  // Call our authentication function to check the request\n  if (!isAuthenticated(request)) {\n    // Respond with JSON indicating an error message\n    return Response.json(\n      { success: false, message: 'authentication failed' },\n      { status: 401 }\n    )\n  }\n}"
  },
  {
    "id": "proxy.mdx#24",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { isAuthenticated } from '@lib/auth'\n\n// Limit the proxy to paths starting with `/api/`\nexport const config = {\n  matcher: '/api/:function*',\n}\n\nexport function proxy(request) {\n  // Call our authentication function to check the request\n  if (!isAuthenticated(request)) {\n    // Respond with JSON indicating an error message\n    return Response.json(\n      { success: false, message: 'authentication failed' },\n      { status: 401 }\n    )\n  }\n}\n```"
  },
  {
    "id": "proxy.mdx#25",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "### Negative matching\n\nThe `matcher` config allows full regex so matching like negative lookaheads or character matching is supported. An example of a negative lookahead to match all except specific paths can be seen here:\n\n```js filename=\"proxy.js\"\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico, sitemap.xml, robots.txt (metadata files)\n     */\n    '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n  ],\n}"
  },
  {
    "id": "proxy.mdx#26",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```\n\nYou can also bypass Proxy for certain requests by using the `missing` or `has` arrays, or a combination of both:\n\n```js filename=\"proxy.js\"\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico, sitemap.xml, robots.txt (metadata files)\n     */\n    {\n      source:\n        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n      missing: [\n        { type: 'header', key: 'next-router-prefetch' },\n        { type: 'header', key: 'purpose', value: 'prefetch' },\n      ],\n    },\n\n    {\n      source:\n        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n      has: [\n        { type: 'header', key: 'next-router-prefetch' },\n        { type: 'header', key: 'purpose', value: 'prefetch' },\n      ],\n    },\n\n    {\n      source:\n        '/((?!api|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n      has: [{ type: 'header', key: 'x-present' }],\n      missing: [{ type: 'header', key: 'x-missing', value: 'prefetch' }],\n    },\n  ],\n}"
  },
  {
    "id": "proxy.mdx#27",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "```\n\n> **Good to know**:\n>\n> Even when `_next/data` is excluded in a negative matcher pattern, proxy will still be invoked for `_next/data` routes. This is intentional behavior to prevent accidental security issues where you might protect a page but forget to protect the corresponding data route.\n\n```js filename=\"proxy.js\"\nexport const config = {\n  matcher:\n    '/((?!api|_next/data|_next/static|_next/image|favicon.ico|sitemap.xml|robots.txt).*)',\n}\n\n// Proxy will still run for /_next/data/* routes despite being excluded\n```"
  },
  {
    "id": "proxy.mdx#28",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "### `waitUntil` and `NextFetchEvent`\n\nThe `NextFetchEvent` object extends the native [`FetchEvent`](https://developer.mozilla.org/docs/Web/API/FetchEvent) object, and includes the [`waitUntil()`](https://developer.mozilla.org/docs/Web/API/ExtendableEvent/waitUntil) method.\n\nThe `waitUntil()` method takes a promise as an argument, and extends the lifetime of the Proxy until the promise settles. This is useful for performing work in the background.\n\n```ts filename=\"proxy.ts\"\nimport { NextResponse } from 'next/server'\nimport type { NextFetchEvent, NextRequest } from 'next/server'\n\nexport function proxy(req: NextRequest, event: NextFetchEvent) {\n  event.waitUntil(\n    fetch('https://my-analytics-platform.com', {\n      method: 'POST',\n      body: JSON.stringify({ pathname: req.nextUrl.pathname }),\n    })\n  )\n\n  return NextResponse.next()\n}\n```"
  },
  {
    "id": "proxy.mdx#29",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "### Unit testing (experimental)\n\nStarting in Next.js 15.1, the `next/experimental/testing/server` package contains utilities to help unit test proxy files. Unit testing proxy can help ensure that it's only run on desired paths and that custom routing logic works as intended before code reaches production.\n\nThe `unstable_doesProxyMatch` function can be used to assert whether proxy will run for the provided URL, headers, and cookies.\n\n```js\nimport { unstable_doesProxyMatch } from 'next/experimental/testing/server'\n\nexpect(\n  unstable_doesProxyMatch({\n    config,\n    nextConfig,\n    url: '/test',\n  })\n).toEqual(false)\n```\n\nThe entire proxy function can also be tested.\n\n```js\nimport { isRewrite, getRewrittenUrl } from 'next/experimental/testing/server'\n\nconst request = new NextRequest('https://nextjs.org/docs')\nconst response = await proxy(request)\nexpect(isRewrite(response)).toEqual(true)\nexpect(getRewrittenUrl(response)).toEqual('https://other-domain.com/docs')\n// getRedirectUrl could also be used if the response were a redirect\n```"
  },
  {
    "id": "proxy.mdx#30",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "## Platform support\n\n| Deployment Option                                                   | Supported         |\n| ------------------------------------------------------------------- | ----------------- |\n| [Node.js server](/docs/app/getting-started/deploying#nodejs-server) | Yes               |\n| [Docker container](/docs/app/getting-started/deploying#docker)      | Yes               |\n| [Static export](/docs/app/getting-started/deploying#static-export)  | No                |\n| [Adapters](/docs/app/getting-started/deploying#adapters)            | Platform-specific |\n\nLearn how to [configure Proxy](/docs/app/guides/self-hosting#proxy) when self-hosting Next.js."
  },
  {
    "id": "proxy.mdx#31",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "## Migration to Proxy\n\n### Why the Change\n\nThe reason behind the renaming of `middleware` is that the term \"middleware\" can often be confused with Express.js middleware, leading to a misinterpretation of its purpose. Also, Middleware is highly capable, so it may encourage the usage; however, this feature is recommended to be used as a last resort.\n\nNext.js is moving forward to provide better APIs with better ergonomics so that developers can achieve their goals without Middleware. This is the reason behind the renaming of `middleware`.\n\n### Why \"Proxy\"\n\nThe name Proxy clarifies what Middleware is capable of. The term \"proxy\" implies that it has a network boundary in front of the app, which is the behavior of Middleware. Also, Middleware defaults to run at the [Edge Runtime](/docs/app/api-reference/edge), which can run closer to the client, separated from the app's region. These behaviors align better with the term \"proxy\" and provide a clearer purpose of the feature."
  },
  {
    "id": "proxy.mdx#32",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "### How to Migrate\n\nWe recommend users avoid relying on Middleware unless no other options exist. Our goal is to give them APIs with better ergonomics so they can achieve their goals without Middleware.\n\nThe term “middleware” often confuses users with Express.js middleware, which can encourage misuse. To clarify our direction, we are renaming the file convention to “proxy.” This highlights that we are moving away from Middleware, breaking down its overloaded features, and making the Proxy clear in its purpose.\n\nNext.js provides a codemod to migrate from `middleware.ts` to `proxy.ts`. You can run the following command to migrate:\n\n```bash\nnpx @next/codemod@canary middleware-to-proxy .\n```\n\nThe codemod will rename the file and the function name from `middleware` to `proxy`.\n\n```diff\n// middleware.ts -> proxy.ts\n\n- export function middleware() {\n+ export function proxy() {\n```"
  },
  {
    "id": "proxy.mdx#33",
    "metadata": {
      "title": "proxy.js",
      "description": "API reference for the proxy.js file."
    },
    "content": "## Version history\n\n| Version   | Changes                                                                                       |\n| --------- | --------------------------------------------------------------------------------------------- |\n| `v16.0.0` | Middleware is deprecated and renamed to Proxy                                                 |\n| `v15.5.0` | Middleware can now use the Node.js runtime (stable)                                           |\n| `v15.2.0` | Middleware can now use the Node.js runtime (experimental)                                     |\n| `v13.1.0` | Advanced Middleware flags added                                                               |\n| `v13.0.0` | Middleware can modify request headers, response headers, and send responses                   |\n| `v12.2.0` | Middleware is stable, please see the [upgrade guide](/docs/messages/middleware-upgrade-guide) |\n| `v12.0.9` | Enforce absolute URLs in Edge Runtime ([PR](https://github.com/vercel/next.js/pull/33410))    |\n| `v12.0.0` | Middleware (Beta) added                                                                       |"
  },
  {
    "id": "public-folder.mdx#0",
    "metadata": {
      "title": "public Folder",
      "description": "Next.js allows you to serve static files, like images, in the public directory. You can learn how it works here."
    },
    "content": "---\ntitle: public Folder\nnav_title: public\ndescription: Next.js allows you to serve static files, like images, in the public directory. You can learn how it works here.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js can serve static files, like images, under a folder called `public` in the root directory. Files inside `public` can then be referenced by your code starting from the base URL (`/`).\n\nFor example, the file `public/avatars/me.png` can be viewed by visiting the `/avatars/me.png` path. The code to display that image might look like:\n\n```jsx filename=\"avatar.js\"\nimport Image from 'next/image'\n\nexport function Avatar({ id, alt }) {\n  return <Image src={`/avatars/${id}.png`} alt={alt} width=\"64\" height=\"64\" />\n}\n\nexport function AvatarOfMe() {\n  return <Avatar id=\"me\" alt=\"A portrait of me\" />\n}\n```"
  },
  {
    "id": "public-folder.mdx#1",
    "metadata": {
      "title": "public Folder",
      "description": "Next.js allows you to serve static files, like images, in the public directory. You can learn how it works here."
    },
    "content": "## Caching\n\nNext.js cannot safely cache assets in the `public` folder because they may change. The default caching headers applied are:\n\n```jsx\nCache-Control: public, max-age=0\n```\n\n## Robots, Favicons, and others\n\n<PagesOnly>\n\nThe folder is also useful for `robots.txt`, `favicon.ico`, Google Site Verification, and any other static files (including `.html`). But make sure to not have a static file with the same name as a file in the `pages/` directory, as this will result in an error. [Read more](/docs/messages/conflicting-public-file-page).\n\n</PagesOnly>\n\n<AppOnly>\n\nFor static metadata files, such as `robots.txt`, `favicon.ico`, etc, you should use [special metadata files](/docs/app/api-reference/file-conventions/metadata) inside the `app` folder.\n\n</AppOnly>"
  },
  {
    "id": "route-groups.mdx#0",
    "metadata": {
      "title": "Route Groups",
      "description": "Route Groups can be used to partition your Next.js application into different sections."
    },
    "content": "---\ntitle: Route Groups\ndescription: Route Groups can be used to partition your Next.js application into different sections.\n---\n\nRoute Groups are a folder convention that let you organize routes by category or team.\n\n## Convention\n\nA route group can be created by wrapping a folder's name in parenthesis: `(folderName)`.\n\nThis convention indicates the folder is for organizational purposes and should **not be included** in the route's URL path.\n\n<Image\n  alt=\"An example folder structure using route groups\"\n  srcLight=\"/docs/light/project-organization-route-groups.png\"\n  srcDark=\"/docs/dark/project-organization-route-groups.png\"\n  width=\"1600\"\n  height=\"849\"\n/>\n\n## Use cases\n\n- Organizing routes by team, concern, or feature.\n- Defining multiple [root layouts](/docs/app/api-reference/file-conventions/layout#root-layout).\n- Opting specific route segments into sharing a layout, while keeping others out."
  },
  {
    "id": "route-groups.mdx#1",
    "metadata": {
      "title": "Route Groups",
      "description": "Route Groups can be used to partition your Next.js application into different sections."
    },
    "content": "## Caveats\n\n- **Full page load**: If you navigate between routes that use different root layouts, it'll trigger a full page reload. For example, navigating from `/cart` that uses `app/(shop)/layout.js` to `/blog` that uses `app/(marketing)/layout.js`. This **only** applies to multiple root layouts.\n- **Conflicting paths**: Routes in different groups should not resolve to the same URL path. For example, `(marketing)/about/page.js` and `(shop)/about/page.js` would both resolve to `/about` and cause an error.\n- **Top-level root layout**: If you use multiple root layouts without a top-level `layout.js` file, make sure your home route (/) is defined within one of the route groups, e.g. app/(marketing)/page.js."
  },
  {
    "id": "route-segment-config.mdx#0",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "---\ntitle: Route Segment Config\ndescription: Learn about how to configure options for Next.js route segments.\n---\n\n> **Good to know**:\n>\n> - The options outlined on this page are disabled if the [`cacheComponents`](/docs/app/api-reference/config/next-config-js/cacheComponents) flag is on, and will eventually be deprecated in the future.\n> - Route Segment options only take effect in Server Component Pages, Layouts, or Route Handlers.\n> - `generateStaticParams` cannot be used inside a `'use client'` file.\n\nThe Route Segment options allows you to configure the behavior of a [Page](/docs/app/api-reference/file-conventions/layout), [Layout](/docs/app/api-reference/file-conventions/layout), or [Route Handler](/docs/app/api-reference/file-conventions/route) by directly exporting the following variables:"
  },
  {
    "id": "route-segment-config.mdx#1",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "| Option                                | Type                                                                                                                      | Default                    |\n| ------------------------------------- | ------------------------------------------------------------------------------------------------------------------------- | -------------------------- |\n| [`dynamic`](#dynamic)                 | `'auto' \\| 'force-dynamic' \\| 'error' \\| 'force-static'`                                                                  | `'auto'`                   |\n| [`dynamicParams`](#dynamicparams)     | `boolean`                                                                                                                 | `true`                     |\n| [`revalidate`](#revalidate)           | `false \\| 0 \\| number`                                                                                                    | `false`                    |\n| [`fetchCache`](#fetchcache)           | `'auto' \\| 'default-cache' \\| 'only-cache' \\| 'force-cache' \\| 'force-no-store' \\| 'default-no-store' \\| 'only-no-store'` | `'auto'`                   |"
  },
  {
    "id": "route-segment-config.mdx#2",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "| [`fetchCache`](#fetchcache)           | `'auto' \\| 'default-cache' \\| 'only-cache' \\| 'force-cache' \\| 'force-no-store' \\| 'default-no-store' \\| 'only-no-store'` | `'auto'`                   |\n| [`runtime`](#runtime)                 | `'nodejs' \\| 'edge'`                                                                                                      | `'nodejs'`                 |\n| [`preferredRegion`](#preferredregion) | `'auto' \\| 'global' \\| 'home' \\| string \\| string[]`                                                                      | `'auto'`                   |\n| [`maxDuration`](#maxduration)         | `number`                                                                                                                  | Set by deployment platform |"
  },
  {
    "id": "route-segment-config.mdx#3",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "## Options"
  },
  {
    "id": "route-segment-config.mdx#4",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "### `dynamic`\n\nChange the dynamic behavior of a layout or page to fully static or fully dynamic.\n\n```tsx filename=\"layout.tsx | page.tsx | route.ts\" switcher\nexport const dynamic = 'auto'\n// 'auto' | 'force-dynamic' | 'error' | 'force-static'\n```\n\n```js filename=\"layout.js | page.js | route.js\" switcher\nexport const dynamic = 'auto'\n// 'auto' | 'force-dynamic' | 'error' | 'force-static'"
  },
  {
    "id": "route-segment-config.mdx#5",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "```\n\n> **Good to know**: The new model in the `app` directory favors granular caching control at the `fetch` request level over the binary all-or-nothing model of `getServerSideProps` and `getStaticProps` at the page-level in the `pages` directory. The `dynamic` option is a way to opt back in to the previous model as a convenience and provides a simpler migration path.\n\n- **`'auto'`** (default): The default option to cache as much as possible without preventing any components from opting into dynamic behavior.\n- **`'force-dynamic'`**: Force [dynamic rendering](/docs/app/guides/caching#dynamic-rendering), which will result in routes being rendered for each user at request time. This option is equivalent to:\n  - Setting the option of every `fetch()` request in a layout or page to `{ cache: 'no-store', next: { revalidate: 0 } }`.\n  - Setting the segment config to `export const fetchCache = 'force-no-store'`"
  },
  {
    "id": "route-segment-config.mdx#6",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "- **`'error'`**: Force static rendering and cache the data of a layout or page by causing an error if any components use [Dynamic APIs](/docs/app/guides/caching#dynamic-rendering) or uncached data. This option is equivalent to:\n  - `getStaticProps()` in the `pages` directory.\n  - Setting the option of every `fetch()` request in a layout or page to `{ cache: 'force-cache' }`.\n  - Setting the segment config to `fetchCache = 'only-cache'`.\n- **`'force-static'`**: Force static rendering and cache the data of a layout or page by forcing [`cookies`](/docs/app/api-reference/functions/cookies), [`headers()`](/docs/app/api-reference/functions/headers) and [`useSearchParams()`](/docs/app/api-reference/functions/use-search-params) to return empty values. It is possible to [`revalidate`](#revalidate), [`revalidatePath`](/docs/app/api-reference/functions/revalidatePath), or [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag), in pages or layouts rendered with `force-static`."
  },
  {
    "id": "route-segment-config.mdx#7",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "> **Good to know**:\n>\n> - Instructions on [how to migrate](/docs/app/guides/migrating/app-router-migration#step-6-migrating-data-fetching-methods) from `getServerSideProps` and `getStaticProps` to `dynamic: 'force-dynamic'` and `dynamic: 'error'` can be found in the [upgrade guide](/docs/app/guides/migrating/app-router-migration#step-6-migrating-data-fetching-methods)."
  },
  {
    "id": "route-segment-config.mdx#8",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "### `dynamicParams`\n\nControl what happens when a dynamic segment is visited that was not generated with [generateStaticParams](/docs/app/api-reference/functions/generate-static-params).\n\n```tsx filename=\"layout.tsx | page.tsx\" switcher\nexport const dynamicParams = true // true | false\n```\n\n```js filename=\"layout.js | page.js | route.js\" switcher\nexport const dynamicParams = true // true | false\n```\n\n- **`true`** (default): Dynamic segments not included in `generateStaticParams` are generated on demand.\n- **`false`**: Dynamic segments not included in `generateStaticParams` will return a 404.\n\n> **Good to know**:\n>\n> - This option replaces the `fallback: true | false | blocking` option of `getStaticPaths` in the `pages` directory.\n> - To statically render all paths the first time they're visited, you'll need to return an empty array in `generateStaticParams` or utilize `export const dynamic = 'force-static'`.\n> - When `dynamicParams = true`, the segment uses [Streaming Server Rendering](/docs/app/getting-started/linking-and-navigating#streaming)."
  },
  {
    "id": "route-segment-config.mdx#9",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "### `revalidate`\n\nSet the default revalidation time for a layout or page. This option does not override the `revalidate` value set by individual `fetch` requests.\n\n```tsx filename=\"layout.tsx | page.tsx | route.ts\" switcher\nexport const revalidate = false\n// false | 0 | number\n```\n\n```js filename=\"layout.js | page.js | route.js\" switcher\nexport const revalidate = false\n// false | 0 | number"
  },
  {
    "id": "route-segment-config.mdx#10",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "```\n\n- **`false`** (default): The default heuristic to cache any `fetch` requests that set their `cache` option to `'force-cache'` or are discovered before a [Dynamic API](/docs/app/guides/caching#dynamic-rendering) is used. Semantically equivalent to `revalidate: Infinity` which effectively means the resource should be cached indefinitely. It is still possible for individual `fetch` requests to use `cache: 'no-store'` or `revalidate: 0` to avoid being cached and make the route dynamically rendered. Or set `revalidate` to a positive number lower than the route default to increase the revalidation frequency of a route.\n- **`0`**: Ensure a layout or page is always [dynamically rendered](/docs/app/guides/caching#dynamic-rendering) even if no Dynamic APIs or uncached data fetches are discovered. This option changes the default of `fetch` requests that do not set a `cache` option to `'no-store'` but leaves `fetch` requests that opt into `'force-cache'` or use a positive `revalidate` as is.\n- **`number`**: (in seconds) Set the default revalidation frequency of a layout or page to `n` seconds."
  },
  {
    "id": "route-segment-config.mdx#11",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "> **Good to know**:\n>\n> - The revalidate value needs to be statically analyzable. For example `revalidate = 600` is valid, but `revalidate = 60 * 10` is not.\n> - The revalidate value is not available when using `runtime = 'edge'`.\n> - In Development, Pages are _always_ rendered on-demand and are never cached. This allows you to see changes immediately without waiting for a revalidation period to pass."
  },
  {
    "id": "route-segment-config.mdx#12",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "#### Revalidation Frequency\n\n- The lowest `revalidate` across each layout and page of a single route will determine the revalidation frequency of the _entire_ route. This ensures that child pages are revalidated as frequently as their parent layouts.\n- Individual `fetch` requests can set a lower `revalidate` than the route's default `revalidate` to increase the revalidation frequency of the entire route. This allows you to dynamically opt-in to more frequent revalidation for certain routes based on some criteria."
  },
  {
    "id": "route-segment-config.mdx#13",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "### `fetchCache`\n\n<details>\n  <summary>This is an advanced option that should only be used if you specifically need to override the default behavior.</summary>\n\nBy default, Next.js **will cache** any `fetch()` requests that are reachable **before** any [Dynamic APIs](/docs/app/guides/caching#dynamic-rendering) are used and **will not cache** `fetch` requests that are discovered **after** Dynamic APIs are used.\n\n`fetchCache` allows you to override the default `cache` option of all `fetch` requests in a layout or page.\n\n```tsx filename=\"layout.tsx | page.tsx | route.ts\" switcher\nexport const fetchCache = 'auto'\n// 'auto' | 'default-cache' | 'only-cache'\n// 'force-cache' | 'force-no-store' | 'default-no-store' | 'only-no-store'\n```\n\n```js filename=\"layout.js | page.js | route.js\" switcher\nexport const fetchCache = 'auto'\n// 'auto' | 'default-cache' | 'only-cache'\n// 'force-cache' | 'force-no-store' | 'default-no-store' | 'only-no-store'"
  },
  {
    "id": "route-segment-config.mdx#14",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "```"
  },
  {
    "id": "route-segment-config.mdx#15",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "- **`'auto'`** (default): The default option to cache `fetch` requests before Dynamic APIs with the `cache` option they provide and not cache `fetch` requests after Dynamic APIs.\n- **`'default-cache'`**: Allow any `cache` option to be passed to `fetch` but if no option is provided then set the `cache` option to `'force-cache'`. This means that even `fetch` requests after Dynamic APIs are considered static.\n- **`'only-cache'`**: Ensure all `fetch` requests opt into caching by changing the default to `cache: 'force-cache'` if no option is provided and causing an error if any `fetch` requests use `cache: 'no-store'`.\n- **`'force-cache'`**: Ensure all `fetch` requests opt into caching by setting the `cache` option of all `fetch` requests to `'force-cache'`.\n- **`'default-no-store'`**: Allow any `cache` option to be passed to `fetch` but if no option is provided then set the `cache` option to `'no-store'`. This means that even `fetch` requests before Dynamic APIs are considered dynamic."
  },
  {
    "id": "route-segment-config.mdx#16",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "- **`'only-no-store'`**: Ensure all `fetch` requests opt out of caching by changing the default to `cache: 'no-store'` if no option is provided and causing an error if any `fetch` requests use `cache: 'force-cache'`\n- **`'force-no-store'`**: Ensure all `fetch` requests opt out of caching by setting the `cache` option of all `fetch` requests to `'no-store'`. This forces all `fetch` requests to be re-fetched every request even if they provide a `'force-cache'` option."
  },
  {
    "id": "route-segment-config.mdx#17",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "#### Cross-route segment behavior\n\n- Any options set across each layout and page of a single route need to be compatible with each other.\n  - If both the `'only-cache'` and `'force-cache'` are provided, then `'force-cache'` wins. If both `'only-no-store'` and `'force-no-store'` are provided, then `'force-no-store'` wins. The force option changes the behavior across the route so a single segment with `'force-*'` would prevent any errors caused by `'only-*'`.\n  - The intention of the `'only-*'` and `'force-*'` options is to guarantee the whole route is either fully static or fully dynamic. This means:\n    - A combination of `'only-cache'` and `'only-no-store'` in a single route is not allowed.\n    - A combination of `'force-cache'` and `'force-no-store'` in a single route is not allowed.\n  - A parent cannot provide `'default-no-store'` if a child provides `'auto'` or `'*-cache'` since that could make the same fetch have different behavior.\n- It is generally recommended to leave shared parent layouts as `'auto'` and customize the options where child segments diverge.\n\n</details>"
  },
  {
    "id": "route-segment-config.mdx#18",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "### `runtime`\n\nWe recommend using the Node.js runtime for rendering your application. This option cannot be used in [Proxy](/docs/app/api-reference/file-conventions/proxy).\n\n> **Good to know**: Using `runtime: 'edge'` is **not supported** for Cache Components.\n\n```tsx filename=\"layout.tsx | page.tsx | route.ts\" switcher\nexport const runtime = 'nodejs'\n// 'nodejs' | 'edge'\n```\n\n```js filename=\"layout.js | page.js | route.js\" switcher\nexport const runtime = 'nodejs'\n// 'nodejs' | 'edge'\n```\n\n- **`'nodejs'`** (default)\n- **`'edge'`**\n\n### `preferredRegion`\n\n```tsx filename=\"layout.tsx | page.tsx | route.ts\" switcher\nexport const preferredRegion = 'auto'\n// 'auto' | 'global' | 'home' | ['iad1', 'sfo1']\n```\n\n```js filename=\"layout.js | page.js | route.js\" switcher\nexport const preferredRegion = 'auto'\n// 'auto' | 'global' | 'home' | ['iad1', 'sfo1']\n```\n\nSupport for `preferredRegion`, and regions supported, is dependent on your deployment platform.\n\n> **Good to know**:\n>\n> - If a `preferredRegion` is not specified, it will inherit the option of the nearest parent layout.\n> - The root layout defaults to `all` regions."
  },
  {
    "id": "route-segment-config.mdx#19",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "### `maxDuration`\n\nBy default, Next.js does not limit the execution of server-side logic (rendering a page or handling an API).\nDeployment platforms can use `maxDuration` from the Next.js build output to add specific execution limits.\n\n**Note**: This setting requires Next.js `13.4.10` or higher.\n\n```tsx filename=\"layout.tsx | page.tsx | route.ts\" switcher\nexport const maxDuration = 5\n```\n\n```js filename=\"layout.js | page.js | route.js\" switcher\nexport const maxDuration = 5\n```\n\n> **Good to know**:\n>\n> - If using [Server Actions](/docs/app/getting-started/updating-data), set the `maxDuration` at the page level to change the default timeout of all Server Actions used on the page.\n\n### `generateStaticParams`\n\nThe `generateStaticParams` function can be used in combination with [dynamic route segments](/docs/app/api-reference/file-conventions/dynamic-routes) to define the list of route segment parameters that will be statically generated at build time instead of on-demand at request time.\n\nSee the [API reference](/docs/app/api-reference/functions/generate-static-params) for more details."
  },
  {
    "id": "route-segment-config.mdx#20",
    "metadata": {
      "title": "Route Segment Config",
      "description": "Learn about how to configure options for Next.js route segments."
    },
    "content": "## Version History\n\n| Version      |                                                                                                                                                                                                                |\n| ------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `v16.0.0`    | `export const experimental_ppr = true` removed. A [codemod](/docs/app/guides/upgrading/codemods#remove-experimental_ppr-route-segment-config-from-app-router-pages-and-layouts) is available.                  |\n| `v15.0.0-RC` | `export const runtime = \"experimental-edge\"` deprecated. A [codemod](/docs/app/guides/upgrading/codemods#transform-app-router-route-segment-config-runtime-value-from-experimental-edge-to-edge) is available. |"
  },
  {
    "id": "route.mdx#0",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "---\ntitle: route.js\ndescription: API reference for the route.js special file.\n---\n\nRoute Handlers allow you to create custom request handlers for a given route using the Web [Request](https://developer.mozilla.org/docs/Web/API/Request) and [Response](https://developer.mozilla.org/docs/Web/API/Response) APIs.\n\n```ts filename=\"route.ts\" switcher\nexport async function GET() {\n  return Response.json({ message: 'Hello World' })\n}\n```\n\n```js filename=\"route.js\" switcher\nexport async function GET() {\n  return Response.json({ message: 'Hello World' })\n}\n```"
  },
  {
    "id": "route.mdx#1",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "## Reference"
  },
  {
    "id": "route.mdx#2",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### HTTP Methods\n\nA **route** file allows you to create custom request handlers for a given route. The following [HTTP methods](https://developer.mozilla.org/docs/Web/HTTP/Methods) are supported: `GET`, `POST`, `PUT`, `PATCH`, `DELETE`, `HEAD`, and `OPTIONS`.\n\n```ts filename=\"route.ts\" switcher\nexport async function GET(request: Request) {}\n\nexport async function HEAD(request: Request) {}\n\nexport async function POST(request: Request) {}\n\nexport async function PUT(request: Request) {}\n\nexport async function DELETE(request: Request) {}\n\nexport async function PATCH(request: Request) {}\n\n// If `OPTIONS` is not defined, Next.js will automatically implement `OPTIONS` and set the appropriate Response `Allow` header depending on the other methods defined in the Route Handler.\nexport async function OPTIONS(request: Request) {}"
  },
  {
    "id": "route.mdx#3",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "```\n\n```js filename=\"route.js\" switcher\nexport async function GET(request) {}\n\nexport async function HEAD(request) {}\n\nexport async function POST(request) {}\n\nexport async function PUT(request) {}\n\nexport async function DELETE(request) {}\n\nexport async function PATCH(request) {}\n\n// If `OPTIONS` is not defined, Next.js will automatically implement `OPTIONS` and set the appropriate Response `Allow` header depending on the other methods defined in the Route Handler.\nexport async function OPTIONS(request) {}\n```"
  },
  {
    "id": "route.mdx#4",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Parameters\n\n#### `request` (optional)\n\nThe `request` object is a [NextRequest](/docs/app/api-reference/functions/next-request) object, which is an extension of the Web [Request](https://developer.mozilla.org/docs/Web/API/Request) API. `NextRequest` gives you further control over the incoming request, including easily accessing `cookies` and an extended, parsed, URL object `nextUrl`.\n\n```ts filename=\"route.ts\" switcher\nimport type { NextRequest } from 'next/server'\n\nexport async function GET(request: NextRequest) {\n  const url = request.nextUrl\n}\n```\n\n```js filename=\"route.js\" switcher\nexport async function GET(request) {\n  const url = request.nextUrl\n}\n```"
  },
  {
    "id": "route.mdx#5",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "#### `context` (optional)\n\n- **`params`**: a promise that resolves to an object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) for the current route.\n\n```ts filename=\"app/dashboard/[team]/route.ts\" switcher\nexport async function GET(\n  request: Request,\n  { params }: { params: Promise<{ team: string }> }\n) {\n  const { team } = await params\n}\n```\n\n```js filename=\"app/dashboard/[team]/route.js\" switcher\nexport async function GET(request, { params }) {\n  const { team } = await params\n}\n```\n\n| Example                          | URL            | `params`                           |\n| -------------------------------- | -------------- | ---------------------------------- |\n| `app/dashboard/[team]/route.js`  | `/dashboard/1` | `Promise<{ team: '1' }>`           |\n| `app/shop/[tag]/[item]/route.js` | `/shop/1/2`    | `Promise<{ tag: '1', item: '2' }>` |\n| `app/blog/[...slug]/route.js`    | `/blog/1/2`    | `Promise<{ slug: ['1', '2'] }>`    |"
  },
  {
    "id": "route.mdx#6",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Route Context Helper\n\nYou can type the Route Handler context using `RouteContext` to get strongly typed `params` from a route literal. `RouteContext` is a globally available helper.\n\n```ts filename=\"app/users/[id]/route.ts\"\nimport type { NextRequest } from 'next/server'\n\nexport async function GET(_req: NextRequest, ctx: RouteContext<'/users/[id]'>) {\n  const { id } = await ctx.params\n  return Response.json({ id })\n}\n```\n\n> **Good to know**\n>\n> - Types are generated during `next dev`, `next build` or `next typegen`.\n> - After type generation, the `RouteContext` helper is globally available. It doesn't need to be imported."
  },
  {
    "id": "route.mdx#7",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "## Examples"
  },
  {
    "id": "route.mdx#8",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Cookies\n\nYou can read or set cookies with [`cookies`](/docs/app/api-reference/functions/cookies) from `next/headers`.\n\n```ts filename=\"route.ts\" switcher\nimport { cookies } from 'next/headers'\n\nexport async function GET(request: NextRequest) {\n  const cookieStore = await cookies()\n\n  const a = cookieStore.get('a')\n  const b = cookieStore.set('b', '1')\n  const c = cookieStore.delete('c')\n}\n```\n\n```js filename=\"route.js\" switcher\nimport { cookies } from 'next/headers'\n\nexport async function GET(request) {\n  const cookieStore = await cookies()\n\n  const a = cookieStore.get('a')\n  const b = cookieStore.set('b', '1')\n  const c = cookieStore.delete('c')\n}\n```\n\nAlternatively, you can return a new `Response` using the [`Set-Cookie`](https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie) header.\n\n```ts filename=\"app/api/route.ts\" switcher\nimport { cookies } from 'next/headers'\n\nexport async function GET(request: Request) {\n  const cookieStore = await cookies()\n  const token = cookieStore.get('token')\n\n  return new Response('Hello, Next.js!', {\n    status: 200,\n    headers: { 'Set-Cookie': `token=${token.value}` },\n  })\n}"
  },
  {
    "id": "route.mdx#9",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "```\n\n```js filename=\"app/api/route.js\" switcher\nimport { cookies } from 'next/headers'\n\nexport async function GET(request) {\n  const cookieStore = await cookies()\n  const token = cookieStore.get('token')\n\n  return new Response('Hello, Next.js!', {\n    status: 200,\n    headers: { 'Set-Cookie': `token=${token.value}` },\n  })\n}\n```\n\nYou can also use the underlying Web APIs to read cookies from the request ([`NextRequest`](/docs/app/api-reference/functions/next-request)):\n\n```ts filename=\"app/api/route.ts\" switcher\nimport { type NextRequest } from 'next/server'\n\nexport async function GET(request: NextRequest) {\n  const token = request.cookies.get('token')\n}\n```\n\n```js filename=\"app/api/route.js\" switcher\nexport async function GET(request) {\n  const token = request.cookies.get('token')\n}\n```"
  },
  {
    "id": "route.mdx#10",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Headers\n\nYou can read headers with [`headers`](/docs/app/api-reference/functions/headers) from `next/headers`.\n\n```ts filename=\"route.ts\" switcher\nimport { headers } from 'next/headers'\nimport type { NextRequest } from 'next/server'\n\nexport async function GET(request: NextRequest) {\n  const headersList = await headers()\n  const referer = headersList.get('referer')\n}\n```\n\n```js filename=\"route.js\" switcher\nimport { headers } from 'next/headers'\n\nexport async function GET(request) {\n  const headersList = await headers()\n  const referer = headersList.get('referer')\n}\n```\n\nThis `headers` instance is read-only. To set headers, you need to return a new `Response` with new `headers`.\n\n```ts filename=\"app/api/route.ts\" switcher\nimport { headers } from 'next/headers'\n\nexport async function GET(request: Request) {\n  const headersList = await headers()\n  const referer = headersList.get('referer')\n\n  return new Response('Hello, Next.js!', {\n    status: 200,\n    headers: { referer: referer },\n  })\n}"
  },
  {
    "id": "route.mdx#11",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "```\n\n```js filename=\"app/api/route.js\" switcher\nimport { headers } from 'next/headers'\n\nexport async function GET(request) {\n  const headersList = await headers()\n  const referer = headersList.get('referer')\n\n  return new Response('Hello, Next.js!', {\n    status: 200,\n    headers: { referer: referer },\n  })\n}\n```\n\nYou can also use the underlying Web APIs to read headers from the request ([`NextRequest`](/docs/app/api-reference/functions/next-request)):\n\n```ts filename=\"app/api/route.ts\" switcher\nimport { type NextRequest } from 'next/server'\n\nexport async function GET(request: NextRequest) {\n  const requestHeaders = new Headers(request.headers)\n}\n```\n\n```js filename=\"app/api/route.js\" switcher\nexport async function GET(request) {\n  const requestHeaders = new Headers(request.headers)\n}\n```"
  },
  {
    "id": "route.mdx#12",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Revalidating Cached Data\n\nYou can [revalidate cached data](/docs/app/guides/incremental-static-regeneration) using the `revalidate` route segment config option.\n\n```ts filename=\"app/posts/route.ts\" switcher\nexport const revalidate = 60\n\nexport async function GET() {\n  const data = await fetch('https://api.vercel.app/blog')\n  const posts = await data.json()\n\n  return Response.json(posts)\n}\n```\n\n```js filename=\"app/posts/route.js\" switcher\nexport const revalidate = 60\n\nexport async function GET() {\n  const data = await fetch('https://api.vercel.app/blog')\n  const posts = await data.json()\n\n  return Response.json(posts)\n}\n```\n\n### Redirects\n\n```ts filename=\"app/api/route.ts\" switcher\nimport { redirect } from 'next/navigation'\n\nexport async function GET(request: Request) {\n  redirect('https://nextjs.org/')\n}\n```\n\n```js filename=\"app/api/route.js\" switcher\nimport { redirect } from 'next/navigation'\n\nexport async function GET(request) {\n  redirect('https://nextjs.org/')\n}\n```"
  },
  {
    "id": "route.mdx#13",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Dynamic Route Segments\n\nRoute Handlers can use [Dynamic Segments](/docs/app/api-reference/file-conventions/dynamic-routes) to create request handlers from dynamic data.\n\n```ts filename=\"app/items/[slug]/route.ts\" switcher\nexport async function GET(\n  request: Request,\n  { params }: { params: Promise<{ slug: string }> }\n) {\n  const { slug } = await params // 'a', 'b', or 'c'\n}\n```\n\n```js filename=\"app/items/[slug]/route.js\" switcher\nexport async function GET(request, { params }) {\n  const { slug } = await params // 'a', 'b', or 'c'\n}\n```\n\n| Route                       | Example URL | `params`                 |\n| --------------------------- | ----------- | ------------------------ |\n| `app/items/[slug]/route.js` | `/items/a`  | `Promise<{ slug: 'a' }>` |\n| `app/items/[slug]/route.js` | `/items/b`  | `Promise<{ slug: 'b' }>` |\n| `app/items/[slug]/route.js` | `/items/c`  | `Promise<{ slug: 'c' }>` |"
  },
  {
    "id": "route.mdx#14",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### URL Query Parameters\n\nThe request object passed to the Route Handler is a `NextRequest` instance, which includes [some additional convenience methods](/docs/app/api-reference/functions/next-request#nexturl), such as those for more easily handling query parameters.\n\n```ts filename=\"app/api/search/route.ts\" switcher\nimport { type NextRequest } from 'next/server'\n\nexport function GET(request: NextRequest) {\n  const searchParams = request.nextUrl.searchParams\n  const query = searchParams.get('query')\n  // query is \"hello\" for /api/search?query=hello\n}\n```\n\n```js filename=\"app/api/search/route.js\" switcher\nexport function GET(request) {\n  const searchParams = request.nextUrl.searchParams\n  const query = searchParams.get('query')\n  // query is \"hello\" for /api/search?query=hello\n}\n```"
  },
  {
    "id": "route.mdx#15",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Streaming\n\nStreaming is commonly used in combination with Large Language Models (LLMs), such as OpenAI, for AI-generated content. Learn more about the [AI SDK](https://sdk.vercel.ai/docs/introduction).\n\n```ts filename=\"app/api/chat/route.ts\" switcher\nimport { openai } from '@ai-sdk/openai'\nimport { StreamingTextResponse, streamText } from 'ai'\n\nexport async function POST(req: Request) {\n  const { messages } = await req.json()\n  const result = await streamText({\n    model: openai('gpt-4-turbo'),\n    messages,\n  })\n\n  return new StreamingTextResponse(result.toAIStream())\n}\n```\n\n```js filename=\"app/api/chat/route.js\" switcher\nimport { openai } from '@ai-sdk/openai'\nimport { StreamingTextResponse, streamText } from 'ai'\n\nexport async function POST(req) {\n  const { messages } = await req.json()\n  const result = await streamText({\n    model: openai('gpt-4-turbo'),\n    messages,\n  })\n\n  return new StreamingTextResponse(result.toAIStream())\n}"
  },
  {
    "id": "route.mdx#16",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "```\n\nThese abstractions use the Web APIs to create a stream. You can also use the underlying Web APIs directly.\n\n```ts filename=\"app/api/route.ts\" switcher\n// https://developer.mozilla.org/docs/Web/API/ReadableStream#convert_async_iterator_to_stream\nfunction iteratorToStream(iterator: any) {\n  return new ReadableStream({\n    async pull(controller) {\n      const { value, done } = await iterator.next()\n\n      if (done) {\n        controller.close()\n      } else {\n        controller.enqueue(value)\n      }\n    },\n  })\n}\n\nfunction sleep(time: number) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, time)\n  })\n}\n\nconst encoder = new TextEncoder()\n\nasync function* makeIterator() {\n  yield encoder.encode('<p>One</p>')\n  await sleep(200)\n  yield encoder.encode('<p>Two</p>')\n  await sleep(200)\n  yield encoder.encode('<p>Three</p>')\n}\n\nexport async function GET() {\n  const iterator = makeIterator()\n  const stream = iteratorToStream(iterator)\n\n  return new Response(stream)\n}"
  },
  {
    "id": "route.mdx#17",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "```\n\n```js filename=\"app/api/route.js\" switcher\n// https://developer.mozilla.org/docs/Web/API/ReadableStream#convert_async_iterator_to_stream\nfunction iteratorToStream(iterator) {\n  return new ReadableStream({\n    async pull(controller) {\n      const { value, done } = await iterator.next()\n\n      if (done) {\n        controller.close()\n      } else {\n        controller.enqueue(value)\n      }\n    },\n  })\n}\n\nfunction sleep(time) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, time)\n  })\n}\n\nconst encoder = new TextEncoder()\n\nasync function* makeIterator() {\n  yield encoder.encode('<p>One</p>')\n  await sleep(200)\n  yield encoder.encode('<p>Two</p>')\n  await sleep(200)\n  yield encoder.encode('<p>Three</p>')\n}\n\nexport async function GET() {\n  const iterator = makeIterator()\n  const stream = iteratorToStream(iterator)\n\n  return new Response(stream)\n}\n```"
  },
  {
    "id": "route.mdx#18",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Request Body\n\nYou can read the `Request` body using the standard Web API methods:\n\n```ts filename=\"app/items/route.ts\" switcher\nexport async function POST(request: Request) {\n  const res = await request.json()\n  return Response.json({ res })\n}\n```\n\n```js filename=\"app/items/route.js\" switcher\nexport async function POST(request) {\n  const res = await request.json()\n  return Response.json({ res })\n}\n```"
  },
  {
    "id": "route.mdx#19",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Request Body FormData\n\nYou can read the `FormData` using the `request.formData()` function:\n\n```ts filename=\"app/items/route.ts\" switcher\nexport async function POST(request: Request) {\n  const formData = await request.formData()\n  const name = formData.get('name')\n  const email = formData.get('email')\n  return Response.json({ name, email })\n}\n```\n\n```js filename=\"app/items/route.js\" switcher\nexport async function POST(request) {\n  const formData = await request.formData()\n  const name = formData.get('name')\n  const email = formData.get('email')\n  return Response.json({ name, email })\n}\n```\n\nSince `formData` data are all strings, you may want to use [`zod-form-data`](https://www.npmjs.com/zod-form-data) to validate the request and retrieve data in the format you prefer (e.g. `number`)."
  },
  {
    "id": "route.mdx#20",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### CORS\n\nYou can set CORS headers for a specific Route Handler using the standard Web API methods:\n\n```ts filename=\"app/api/route.ts\" switcher\nexport async function GET(request: Request) {\n  return new Response('Hello, Next.js!', {\n    status: 200,\n    headers: {\n      'Access-Control-Allow-Origin': '*',\n      'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n    },\n  })\n}\n```\n\n```js filename=\"app/api/route.js\" switcher\nexport async function GET(request) {\n  return new Response('Hello, Next.js!', {\n    status: 200,\n    headers: {\n      'Access-Control-Allow-Origin': '*',\n      'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n    },\n  })\n}\n```\n\n> **Good to know**:\n>\n> - To add CORS headers to multiple Route Handlers, you can use [Proxy](/docs/app/api-reference/file-conventions/proxy#cors) or the [`next.config.js` file](/docs/app/api-reference/config/next-config-js/headers#cors)."
  },
  {
    "id": "route.mdx#21",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Webhooks\n\nYou can use a Route Handler to receive webhooks from third-party services:\n\n```ts filename=\"app/api/route.ts\" switcher\nexport async function POST(request: Request) {\n  try {\n    const text = await request.text()\n    // Process the webhook payload\n  } catch (error) {\n    return new Response(`Webhook error: ${error.message}`, {\n      status: 400,\n    })\n  }\n\n  return new Response('Success!', {\n    status: 200,\n  })\n}\n```\n\n```js filename=\"app/api/route.js\" switcher\nexport async function POST(request) {\n  try {\n    const text = await request.text()\n    // Process the webhook payload\n  } catch (error) {\n    return new Response(`Webhook error: ${error.message}`, {\n      status: 400,\n    })\n  }\n\n  return new Response('Success!', {\n    status: 200,\n  })\n}\n```\n\nNotably, unlike API Routes with the Pages Router, you do not need to use `bodyParser` to use any additional configuration."
  },
  {
    "id": "route.mdx#22",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Non-UI Responses\n\nYou can use Route Handlers to return non-UI content. Note that [`sitemap.xml`](/docs/app/api-reference/file-conventions/metadata/sitemap#generating-a-sitemap-using-code-js-ts), [`robots.txt`](/docs/app/api-reference/file-conventions/metadata/robots#generate-a-robots-file), [`app icons`](/docs/app/api-reference/file-conventions/metadata/app-icons#generate-icons-using-code-js-ts-tsx), and [open graph images](/docs/app/api-reference/file-conventions/metadata/opengraph-image) all have built-in support.\n\n```ts filename=\"app/rss.xml/route.ts\" switcher\nexport async function GET() {\n  return new Response(\n    `<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<rss version=\"2.0\">\n\n<channel>\n  <title>Next.js Documentation</title>\n  <link>https://nextjs.org/docs</link>\n  <description>The React Framework for the Web</description>\n</channel>\n\n</rss>`,\n    {\n      headers: {\n        'Content-Type': 'text/xml',\n      },\n    }\n  )\n}"
  },
  {
    "id": "route.mdx#23",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "```\n\n```js filename=\"app/rss.xml/route.js\" switcher\nexport async function GET() {\n  return new Response(`<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<rss version=\"2.0\">\n\n<channel>\n  <title>Next.js Documentation</title>\n  <link>https://nextjs.org/docs</link>\n  <description>The React Framework for the Web</description>\n</channel>\n\n</rss>`)\n}\n```"
  },
  {
    "id": "route.mdx#24",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "### Segment Config Options\n\nRoute Handlers use the same [route segment configuration](/docs/app/api-reference/file-conventions/route-segment-config) as pages and layouts.\n\n```ts filename=\"app/items/route.ts\" switcher\nexport const dynamic = 'auto'\nexport const dynamicParams = true\nexport const revalidate = false\nexport const fetchCache = 'auto'\nexport const runtime = 'nodejs'\nexport const preferredRegion = 'auto'\n```\n\n```js filename=\"app/items/route.js\" switcher\nexport const dynamic = 'auto'\nexport const dynamicParams = true\nexport const revalidate = false\nexport const fetchCache = 'auto'\nexport const runtime = 'nodejs'\nexport const preferredRegion = 'auto'\n```\n\nSee the [API reference](/docs/app/api-reference/file-conventions/route-segment-config) for more details."
  },
  {
    "id": "route.mdx#25",
    "metadata": {
      "title": "route.js",
      "description": "API reference for the route.js special file."
    },
    "content": "## Version History\n\n| Version      | Changes                                                                                              |\n| ------------ | ---------------------------------------------------------------------------------------------------- |\n| `v15.0.0-RC` | `context.params` is now a promise. A [codemod](/docs/app/guides/upgrading/codemods#150) is available |\n| `v15.0.0-RC` | The default caching for `GET` handlers was changed from static to dynamic                            |\n| `v13.2.0`    | Route Handlers are introduced.                                                                       |"
  },
  {
    "id": "src-folder.mdx#0",
    "metadata": {
      "title": "src Folder",
      "description": "Save pages under the `src` folder as an alternative to the root `pages` directory."
    },
    "content": "---\ntitle: src Folder\nnav_title: src\ndescription: Save pages under the `src` folder as an alternative to the root `pages` directory.\nrelated:\n  links:\n    - app/getting-started/project-structure\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nAs an alternative to having the special Next.js `app` or `pages` directories in the root of your project, Next.js also supports the common pattern of placing application code under the `src` folder.\n\nThis separates application code from project configuration files which mostly live in the root of a project, which is preferred by some individuals and teams.\n\nTo use the `src` folder, move the `app` Router folder or `pages` Router folder to `src/app` or `src/pages` respectively.\n\n<Image\n  alt=\"An example folder structure with the `src` folder\"\n  srcLight=\"/docs/light/project-organization-src-directory.png\"\n  srcDark=\"/docs/dark/project-organization-src-directory.png\"\n  width=\"1600\"\n  height=\"687\"\n/>"
  },
  {
    "id": "src-folder.mdx#1",
    "metadata": {
      "title": "src Folder",
      "description": "Save pages under the `src` folder as an alternative to the root `pages` directory."
    },
    "content": "> **Good to know**:\n>\n> - The `/public` directory should remain in the root of your project.\n> - Config files like `package.json`, `next.config.js` and `tsconfig.json` should remain in the root of your project.\n> - `.env.*` files should remain in the root of your project.\n> - `src/app` or `src/pages` will be ignored if `app` or `pages` are present in the root directory.\n> - If you're using `src`, you'll probably also move other application folders such as `/components` or `/lib`.\n> - If you're using Proxy, ensure it is placed inside the `src` folder.\n> - If you're using Tailwind CSS, you'll need to add the `/src` prefix to the `tailwind.config.js` file in the [content section](https://tailwindcss.com/docs/content-configuration).\n> - If you are using TypeScript paths for imports such as `@/*`, you should update the `paths` object in `tsconfig.json` to include `src/`."
  },
  {
    "id": "template.mdx#0",
    "metadata": {
      "title": "template.js",
      "description": "API Reference for the template.js file."
    },
    "content": "---\ntitle: template.js\ndescription: API Reference for the template.js file.\n---\n\nA **template** file is similar to a [layout](/docs/app/getting-started/layouts-and-pages#creating-a-layout) in that it wraps a layout or page. Unlike layouts that persist across routes and maintain state, templates are given a unique key, meaning children Client Components reset their state on navigation.\n\nThey are useful when you need to:\n\n- Resynchronize `useEffect` on navigation.\n- Reset the state of a child Client Components on navigation. For example, an input field.\n- To change default framework behavior. For example, Suspense boundaries inside layouts only show a fallback on first load, while templates show it on every navigation."
  },
  {
    "id": "template.mdx#1",
    "metadata": {
      "title": "template.js",
      "description": "API Reference for the template.js file."
    },
    "content": "## Convention\n\nA template can be defined by exporting a default React component from a `template.js` file. The component should accept a `children` prop.\n\n<Image\n  alt=\"template.js special file\"\n  srcLight=\"/docs/light/template-special-file.png\"\n  srcDark=\"/docs/dark/template-special-file.png\"\n  width=\"1600\"\n  height=\"444\"\n/>\n\n```tsx filename=\"app/template.tsx\" switcher\nexport default function Template({ children }: { children: React.ReactNode }) {\n  return <div>{children}</div>\n}\n```\n\n```jsx filename=\"app/template.js\" switcher\nexport default function Template({ children }) {\n  return <div>{children}</div>\n}\n```\n\nIn terms of nesting, `template.js` is rendered between a layout and its children. Here's a simplified output:\n\n```jsx filename=\"Output\"\n<Layout>\n  {/* Note that the template is given a unique key. */}\n  <Template key={routeParam}>{children}</Template>\n</Layout>\n```\n\n## Props\n\n### `children` (required)\n\nTemplate accepts a `children` prop.\n\n```jsx filename=\"Output\"\n<Layout>\n  {/* Note that the template is automatically given a unique key. */}\n  <Template key={routeParam}>{children}</Template>\n</Layout>\n```"
  },
  {
    "id": "template.mdx#2",
    "metadata": {
      "title": "template.js",
      "description": "API Reference for the template.js file."
    },
    "content": "## Behavior\n\n- **Server Components**: By default, templates are Server Components.\n- **With navigation**: Templates receive a unique key for their own segment level. They remount when that segment (including its dynamic params) changes. Navigations within deeper segments do not remount higher-level templates. Search params do not trigger remounts.\n- **State reset**: Any Client Component inside the template will reset its state on navigation.\n- **Effect re-run**: Effects like `useEffect` will re-synchronize as the component remounts.\n- **DOM reset**: DOM elements inside the template are fully recreated."
  },
  {
    "id": "template.mdx#3",
    "metadata": {
      "title": "template.js",
      "description": "API Reference for the template.js file."
    },
    "content": "### Templates during navigation and remounting\n\nThis section illustrates how templates behave during navigation. It shows, step by step, which templates remount on each route change and why.\n\nUsing this project tree:\n\n```\napp\n├── about\n│   ├── page.tsx\n├── blog\n│   ├── [slug]\n│   │   └── page.tsx\n│   ├── page.tsx\n│   └── template.tsx\n├── layout.tsx\n├── page.tsx\n└── template.tsx\n```\n\nStarting at `/`, the React tree looks roughly like this.\n\n> Note: The `key` values shown in the examples are illustrative, the values in your application may differ.\n\n```jsx filename=\"Output\"\n<RootLayout>\n  {/* app/template.tsx */}\n  <Template key=\"/\">\n    <Page />\n  </Template>\n</RootLayout>\n```\n\nNavigating to `/about` (first segment changes), the root template key changes, it remounts:\n\n```jsx filename=\"Output\"\n<RootLayout>\n  {/* app/template.tsx */}\n  <Template key=\"/about\">\n    <AboutPage />\n  </Template>\n</RootLayout>"
  },
  {
    "id": "template.mdx#4",
    "metadata": {
      "title": "template.js",
      "description": "API Reference for the template.js file."
    },
    "content": "```\n\nNavigating to `/blog` (first segment changes), the root template key changes, it remounts and the blog-level template mounts:\n\n```jsx filename=\"Output\"\n<RootLayout>\n  {/* app/template.tsx (root) */}\n  <Template key=\"/blog\">\n    {/* app/blog/template.tsx */}\n    <Template key=\"/blog\">\n      <BlogIndexPage />\n    </Template>\n  </Template>\n</RootLayout>\n```\n\nNavigating within the same first segment to `/blog/first-post` (child segment changes), the root template key doesn't change, but the blog-level template key changes, it remounts:\n\n```jsx filename=\"Output\"\n<RootLayout>\n  {/* app/template.tsx (root) */}\n  <Template key=\"/blog\">\n    {/* app/blog/template.tsx */}\n    {/* remounts because the child segment at this level changed */}\n    <Template key=\"/blog/first-post\">\n      <BlogPostPage slug=\"first-post\" />\n    </Template>\n  </Template>\n</RootLayout>"
  },
  {
    "id": "template.mdx#5",
    "metadata": {
      "title": "template.js",
      "description": "API Reference for the template.js file."
    },
    "content": "```\n\nNavigating to `/blog/second-post` (same first segment, different child segment), the root template key doesn't change, but the blog-level template key changes, it remounts again:\n\n```jsx filename=\"Output\"\n<RootLayout>\n  {/* app/template.tsx (root) */}\n  <Template key=\"/blog\">\n    {/* app/blog/template.tsx */}\n    {/* remounts again due to changed child segment */}\n    <Template key=\"/blog/second-post\">\n      <BlogPostPage slug=\"second-post\" />\n    </Template>\n  </Template>\n</RootLayout>\n```"
  },
  {
    "id": "template.mdx#6",
    "metadata": {
      "title": "template.js",
      "description": "API Reference for the template.js file."
    },
    "content": "## Version History\n\n| Version   | Changes                |\n| --------- | ---------------------- |\n| `v13.0.0` | `template` introduced. |"
  },
  {
    "id": "unauthorized.mdx#0",
    "metadata": {
      "title": "unauthorized.js",
      "description": "API reference for the unauthorized.js special file."
    },
    "content": "---\ntitle: unauthorized.js\ndescription: API reference for the unauthorized.js special file.\nrelated:\n  links:\n    - app/api-reference/functions/unauthorized\nversion: experimental\n---\n\nThe **unauthorized** file is used to render UI when the [`unauthorized`](/docs/app/api-reference/functions/unauthorized) function is invoked during authentication. Along with allowing you to customize the UI, Next.js will return a `401` status code.\n\n```tsx filename=\"app/unauthorized.tsx\" switcher\nimport Login from '@/app/components/Login'\n\nexport default function Unauthorized() {\n  return (\n    <main>\n      <h1>401 - Unauthorized</h1>\n      <p>Please log in to access this page.</p>\n      <Login />\n    </main>\n  )\n}\n```\n\n```jsx filename=\"app/unauthorized.js\" switcher\nimport Login from '@/app/components/Login'\n\nexport default function Unauthorized() {\n  return (\n    <main>\n      <h1>401 - Unauthorized</h1>\n      <p>Please log in to access this page.</p>\n      <Login />\n    </main>\n  )\n}\n```\n\n## Reference\n\n### Props\n\n`unauthorized.js` components do not accept any props."
  },
  {
    "id": "unauthorized.mdx#1",
    "metadata": {
      "title": "unauthorized.js",
      "description": "API reference for the unauthorized.js special file."
    },
    "content": "## Examples"
  },
  {
    "id": "unauthorized.mdx#2",
    "metadata": {
      "title": "unauthorized.js",
      "description": "API reference for the unauthorized.js special file."
    },
    "content": "### Displaying login UI to unauthenticated users\n\nYou can use [`unauthorized`](/docs/app/api-reference/functions/unauthorized) function to render the `unauthorized.js` file with a login UI.\n\n```tsx filename=\"app/dashboard/page.tsx\" switcher\nimport { verifySession } from '@/app/lib/dal'\nimport { unauthorized } from 'next/navigation'\n\nexport default async function DashboardPage() {\n  const session = await verifySession()\n\n  if (!session) {\n    unauthorized()\n  }\n\n  return <div>Dashboard</div>\n}\n```\n\n```jsx filename=\"app/dashboard/page.js\" switcher\nimport { verifySession } from '@/app/lib/dal'\nimport { unauthorized } from 'next/navigation'\n\nexport default async function DashboardPage() {\n  const session = await verifySession()\n\n  if (!session) {\n    unauthorized()\n  }\n\n  return <div>Dashboard</div>\n}\n```\n\n```tsx filename=\"app/unauthorized.tsx\" switcher\nimport Login from '@/app/components/Login'\n\nexport default function UnauthorizedPage() {\n  return (\n    <main>\n      <h1>401 - Unauthorized</h1>\n      <p>Please log in to access this page.</p>\n      <Login />\n    </main>\n  )\n}"
  },
  {
    "id": "unauthorized.mdx#3",
    "metadata": {
      "title": "unauthorized.js",
      "description": "API reference for the unauthorized.js special file."
    },
    "content": "```\n\n```jsx filename=\"app/unauthorized.js\" switcher\nimport Login from '@/app/components/Login'\n\nexport default function UnauthorizedPage() {\n  return (\n    <main>\n      <h1>401 - Unauthorized</h1>\n      <p>Please log in to access this page.</p>\n      <Login />\n    </main>\n  )\n}\n```"
  },
  {
    "id": "unauthorized.mdx#4",
    "metadata": {
      "title": "unauthorized.js",
      "description": "API reference for the unauthorized.js special file."
    },
    "content": "## Version History\n\n| Version   | Changes                       |\n| --------- | ----------------------------- |\n| `v15.1.0` | `unauthorized.js` introduced. |"
  },
  {
    "id": "after.mdx#0",
    "metadata": {
      "title": "after",
      "description": "API Reference for the after function."
    },
    "content": "---\ntitle: after\ndescription: API Reference for the after function.\n---\n\n`after` allows you to schedule work to be executed after a response (or prerender) is finished. This is useful for tasks and other side effects that should not block the response, such as logging and analytics.\n\nIt can be used in [Server Components](/docs/app/getting-started/server-and-client-components) (including [`generateMetadata`](/docs/app/api-reference/functions/generate-metadata)), [Server Actions](/docs/app/getting-started/updating-data), [Route Handlers](/docs/app/api-reference/file-conventions/route), and [Proxy](/docs/app/api-reference/file-conventions/proxy).\n\nThe function accepts a callback that will be executed after the response (or prerender) is finished:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport { after } from 'next/server'\n// Custom logging function\nimport { log } from '@/app/utils'\n\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  after(() => {\n    // Execute after the layout is rendered and sent to the user\n    log()\n  })\n  return <>{children}</>\n}"
  },
  {
    "id": "after.mdx#1",
    "metadata": {
      "title": "after",
      "description": "API Reference for the after function."
    },
    "content": "```\n\n```jsx filename=\"app/layout.jsx\" switcher\nimport { after } from 'next/server'\n// Custom logging function\nimport { log } from '@/app/utils'\n\nexport default function Layout({ children }) {\n  after(() => {\n    // Execute after the layout is rendered and sent to the user\n    log()\n  })\n  return <>{children}</>\n}\n```\n\n> **Good to know:** `after` is not a [Dynamic API](/docs/app/guides/caching#dynamic-rendering) and calling it does not cause a route to become dynamic. If it's used within a static page, the callback will execute at build time, or whenever a page is revalidated."
  },
  {
    "id": "after.mdx#2",
    "metadata": {
      "title": "after",
      "description": "API Reference for the after function."
    },
    "content": "## Reference\n\n### Parameters\n\n- A callback function which will be executed after the response (or prerender) is finished.\n\n### Duration\n\n`after` will run for the platform's default or configured max duration of your route. If your platform supports it, you can configure the timeout limit using the [`maxDuration`](/docs/app/api-reference/file-conventions/route-segment-config#maxduration) route segment config.\n\n## Good to know\n\n- `after` will be executed even if the response didn't complete successfully. Including when an error is thrown or when `notFound` or `redirect` is called.\n- You can use React `cache` to deduplicate functions called inside `after`.\n- `after` can be nested inside other `after` calls, for example, you can create utility functions that wrap `after` calls to add additional functionality."
  },
  {
    "id": "after.mdx#3",
    "metadata": {
      "title": "after",
      "description": "API Reference for the after function."
    },
    "content": "## Examples"
  },
  {
    "id": "after.mdx#4",
    "metadata": {
      "title": "after",
      "description": "API Reference for the after function."
    },
    "content": "### With request APIs\n\nYou can use request APIs such as [`cookies`](/docs/app/api-reference/functions/cookies) and [`headers`](/docs/app/api-reference/functions/headers) inside `after` in [Server Actions](/docs/app/getting-started/updating-data) and [Route Handlers](/docs/app/api-reference/file-conventions/route). This is useful for logging activity after a mutation. For example:\n\n```ts filename=\"app/api/route.ts\" highlight={2,7-9} switcher\nimport { after } from 'next/server'\nimport { cookies, headers } from 'next/headers'\nimport { logUserAction } from '@/app/utils'\n\nexport async function POST(request: Request) {\n  // Perform mutation\n  // ...\n\n  // Log user activity for analytics\n  after(async () => {\n    const userAgent = (await headers().get('user-agent')) || 'unknown'\n    const sessionCookie =\n      (await cookies().get('session-id'))?.value || 'anonymous'\n\n    logUserAction({ sessionCookie, userAgent })\n  })\n\n  return new Response(JSON.stringify({ status: 'success' }), {\n    status: 200,\n    headers: { 'Content-Type': 'application/json' },\n  })\n}"
  },
  {
    "id": "after.mdx#5",
    "metadata": {
      "title": "after",
      "description": "API Reference for the after function."
    },
    "content": "```\n\n```js filename=\"app/api/route.js\" highlight={2,7-9} switcher\nimport { after } from 'next/server'\nimport { cookies, headers } from 'next/headers'\nimport { logUserAction } from '@/app/utils'\n\nexport async function POST(request) {\n  // Perform mutation\n  // ...\n\n  // Log user activity for analytics\n  after(async () => {\n    const userAgent = (await headers().get('user-agent')) || 'unknown'\n    const sessionCookie =\n      (await cookies().get('session-id'))?.value || 'anonymous'\n\n    logUserAction({ sessionCookie, userAgent })\n  })\n\n  return new Response(JSON.stringify({ status: 'success' }), {\n    status: 200,\n    headers: { 'Content-Type': 'application/json' },\n  })\n}\n```\n\nHowever, you cannot use these request APIs inside `after` in [Server Components](/docs/app/getting-started/server-and-client-components). This is because Next.js needs to know which part of the tree access the request APIs to support [Cache Components](/docs/app/getting-started/cache-components), but `after` runs after React's rendering lifecycle."
  },
  {
    "id": "after.mdx#6",
    "metadata": {
      "title": "after",
      "description": "API Reference for the after function."
    },
    "content": "## Platform Support\n\n| Deployment Option                                                   | Supported         |\n| ------------------------------------------------------------------- | ----------------- |\n| [Node.js server](/docs/app/getting-started/deploying#nodejs-server) | Yes               |\n| [Docker container](/docs/app/getting-started/deploying#docker)      | Yes               |\n| [Static export](/docs/app/getting-started/deploying#static-export)  | No                |\n| [Adapters](/docs/app/getting-started/deploying#adapters)            | Platform-specific |\n\nLearn how to [configure `after`](/docs/app/guides/self-hosting#after) when self-hosting Next.js.\n\n<details id=\"after-serverless\">\n  <summary>Reference: supporting `after` for serverless platforms</summary>\n\nUsing `after` in a serverless context requires waiting for asynchronous tasks to finish after the response has been sent. In Next.js and Vercel, this is achieved using a primitive called `waitUntil(promise)`, which extends the lifetime of a serverless invocation until all promises passed to [`waitUntil`](https://vercel.com/docs/functions/functions-api-reference#waituntil) have settled."
  },
  {
    "id": "after.mdx#7",
    "metadata": {
      "title": "after",
      "description": "API Reference for the after function."
    },
    "content": "If you want your users to be able to run `after`, you will have to provide your implementation of `waitUntil` that behaves in an analogous way.\n\nWhen `after` is called, Next.js will access `waitUntil` like this:\n\n```jsx\nconst RequestContext = globalThis[Symbol.for('@next/request-context')]\nconst contextValue = RequestContext?.get()\nconst waitUntil = contextValue?.waitUntil"
  },
  {
    "id": "after.mdx#8",
    "metadata": {
      "title": "after",
      "description": "API Reference for the after function."
    },
    "content": "```\n\nWhich means that `globalThis[Symbol.for('@next/request-context')]` is expected to contain an object like this:\n\n```tsx\ntype NextRequestContext = {\n  get(): NextRequestContextValue | undefined\n}\n\ntype NextRequestContextValue = {\n  waitUntil?: (promise: Promise<any>) => void\n}\n```\n\nHere is an example of the implementation.\n\n```tsx\nimport { AsyncLocalStorage } from 'node:async_hooks'\n\nconst RequestContextStorage = new AsyncLocalStorage<NextRequestContextValue>()\n\n// Define and inject the accessor that next.js will use\nconst RequestContext: NextRequestContext = {\n  get() {\n    return RequestContextStorage.getStore()\n  },\n}\nglobalThis[Symbol.for('@next/request-context')] = RequestContext\n\nconst handler = (req, res) => {\n  const contextValue = { waitUntil: YOUR_WAITUNTIL }\n  // Provide the value\n  return RequestContextStorage.run(contextValue, () => nextJsHandler(req, res))\n}\n```\n\n</details>"
  },
  {
    "id": "after.mdx#9",
    "metadata": {
      "title": "after",
      "description": "API Reference for the after function."
    },
    "content": "## Version History\n\n| Version History | Description                  |\n| --------------- | ---------------------------- |\n| `v15.1.0`       | `after` became stable.       |\n| `v15.0.0-rc`    | `unstable_after` introduced. |"
  },
  {
    "id": "cacheLife.mdx#0",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "---\ntitle: cacheLife\ndescription: Learn how to use the cacheLife function to set the cache expiration time for a cached function or component.\nrelated:\n  title: Related\n  description: View related API references.\n  links:\n    - app/api-reference/config/next-config-js/cacheComponents\n    - app/api-reference/directives/use-cache\n    - app/api-reference/functions/revalidateTag\n    - app/api-reference/functions/cacheTag\n---\n\nThe `cacheLife` function is used to set the cache lifetime of a function or component. It should be used alongside the [`use cache`](/docs/app/api-reference/directives/use-cache) directive, and within the scope of the function or component."
  },
  {
    "id": "cacheLife.mdx#1",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "## Usage\n\n### Basic setup\n\nTo use `cacheLife`, first enable the [`cacheComponents` flag](/docs/app/api-reference/config/next-config-js/cacheComponents) in your `next.config.js` file:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  cacheComponents: true,\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\nconst nextConfig = {\n  cacheComponents: true,\n}\n\nexport default nextConfig\n```"
  },
  {
    "id": "cacheLife.mdx#2",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "### Using preset profiles\n\nNext.js provides preset cache profiles that cover common caching needs. Each profile balances three factors:\n\n- How long users see cached content without checking for updates (client-side)\n- How often fresh content is generated on the server\n- When old content expires completely\n\nChoose a profile based on how frequently your content changes:\n\n- **`seconds`** - Real-time data (stock prices, live scores)\n- **`minutes`** - Frequently updated (social feeds, news)\n- **`hours`** - Multiple daily updates (product inventory, weather)\n- **`days`** - Daily updates (blog posts, articles)\n- **`weeks`** - Weekly updates (podcasts, newsletters)\n- **`max`** - Rarely changes (legal pages, archived content)\n\nImport `cacheLife` and pass a profile name:\n\n```tsx filename=\"app/blog/page.tsx\" highlight={1,5}\n'use cache'\nimport { cacheLife } from 'next/cache'\n\nexport default async function BlogPage() {\n  cacheLife('days') // Blog content updated daily\n\n  const posts = await getBlogPosts()\n  return <div>{/* render posts */}</div>\n}"
  },
  {
    "id": "cacheLife.mdx#3",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "```\n\nThe profile name tells Next.js how to cache the entire function's output. If you need more control over timing values, see the [Reference](#reference) section below.\n\n> **Good to know**: The `use cache` directive can be placed at the file level or at the top of a function or component, and `cacheLife` must be called within its scope."
  },
  {
    "id": "cacheLife.mdx#4",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "## Reference"
  },
  {
    "id": "cacheLife.mdx#5",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "### Cache profile properties\n\nCache profiles control caching behavior through three timing properties:\n\n- **[`stale`](#stale)**: How long the client can use cached data without checking the server\n- **[`revalidate`](#revalidate)**: After this time, the next request will trigger a background refresh\n- **[`expire`](#expire)**: After this time with no requests, the next one waits for fresh content\n\n#### `stale`\n\n**Client-side:** How long the client can use cached data without checking the server.\n\nDuring this time, the client-side router displays cached content immediately without any network request. After this period expires, the router must check with the server on the next navigation or request. This provides instant page loads from the client cache, but data may be outdated.\n\n```tsx\ncacheLife({ stale: 300 }) // 5 minutes\n```"
  },
  {
    "id": "cacheLife.mdx#6",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "#### `revalidate`\n\nHow often the server regenerates cached content in the background.\n\n- When a request arrives after this period, the server:\n  1. Serves the cached version immediately (if available)\n  2. Regenerates content in the background\n  3. Updates the cache with fresh content\n- Similar to [Incremental Static Regeneration (ISR)](/docs/app/guides/incremental-static-regeneration)\n\n```tsx\ncacheLife({ revalidate: 900 }) // 15 minutes\n```\n\n#### `expire`\n\nMaximum time before the server must regenerate cached content.\n\n- After this period with no traffic, the server regenerates content synchronously on the next request\n- When you set both `revalidate` and `expire`, `expire` must be longer than `revalidate`. Next.js validates this and raises an error for invalid configurations.\n\n```tsx\ncacheLife({ expire: 3600 }) // 1 hour\n```"
  },
  {
    "id": "cacheLife.mdx#7",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "### Preset cache profiles\n\nIf you don't specify a profile, Next.js uses the `default` profile. We recommend explicitly setting a profile to make caching behavior clear.\n\n| **Profile** | **Use Case**                           | `stale`    | `revalidate` | `expire` |\n| ----------- | -------------------------------------- | ---------- | ------------ | -------- |\n| `default`   | Standard content                       | 5 minutes  | 15 minutes   | 1 year   |\n| `seconds`   | Real-time data                         | 30 seconds | 1 second     | 1 minute |\n| `minutes`   | Frequently updated content             | 5 minutes  | 1 minute     | 1 hour   |\n| `hours`     | Content updated multiple times per day | 5 minutes  | 1 hour       | 1 day    |\n| `days`      | Content updated daily                  | 5 minutes  | 1 day        | 1 week   |\n| `weeks`     | Content updated weekly                 | 5 minutes  | 1 week       | 30 days  |\n| `max`       | Stable content that rarely changes     | 5 minutes  | 30 days      | 1 year   |"
  },
  {
    "id": "cacheLife.mdx#8",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "### Custom cache profiles\n\nDefine reusable cache profiles in your `next.config.ts` file:\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  cacheComponents: true,\n  cacheLife: {\n    biweekly: {\n      stale: 60 * 60 * 24 * 14, // 14 days\n      revalidate: 60 * 60 * 24, // 1 day\n      expire: 60 * 60 * 24 * 14, // 14 days\n    },\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\nconst nextConfig = {\n  cacheComponents: true,\n  cacheLife: {\n    biweekly: {\n      stale: 60 * 60 * 24 * 14, // 14 days\n      revalidate: 60 * 60 * 24, // 1 day\n      expire: 60 * 60 * 24 * 14, // 14 days\n    },\n  },\n}\n\nmodule.exports = nextConfig\n```\n\nThe example above caches for 14 days, checks for updates daily, and expires the cache after 14 days. You can then reference this profile throughout your application by its name:\n\n```tsx filename=\"app/page.tsx\" highlight={5}\n'use cache'\nimport { cacheLife } from 'next/cache'\n\nexport default async function Page() {\n  cacheLife('biweekly')\n  return <div>Page</div>\n}\n```"
  },
  {
    "id": "cacheLife.mdx#9",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "### Overriding the default cache profiles\n\nWhile the default cache profiles provide a useful way to think about how fresh or stale any given part of cacheable output can be, you may prefer different named profiles to better align with your applications caching strategies.\n\nYou can override the default named cache profiles by creating a new configuration with the same name as the defaults.\n\nThe example below shows how to override the default `\"days\"` cache profile:\n\n```ts filename=\"next.config.ts\"\nconst nextConfig = {\n  cacheComponents: true,\n  cacheLife: {\n    // Override the 'days' profile\n    days: {\n      stale: 3600, // 1 hour\n      revalidate: 900, // 15 minutes\n      expire: 86400, // 1 day\n    },\n  },\n}\n\nexport default nextConfig\n```"
  },
  {
    "id": "cacheLife.mdx#10",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "### Inline cache profiles\n\nFor one-off cases, pass a profile object directly to `cacheLife`:\n\n```tsx filename=\"app/page.tsx\"\n'use cache'\nimport { cacheLife } from 'next/cache'\n\nexport default async function Page() {\n  cacheLife({\n    stale: 3600,\n    revalidate: 900,\n    expire: 86400,\n  })\n\n  return <div>Page</div>\n}\n```\n\nInline profiles apply only to the specific function or component. For reusable configurations, define custom profiles in `next.config.ts`.\n\nUsing `cacheLife({})` with an empty object applies the `default` profile values."
  },
  {
    "id": "cacheLife.mdx#11",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "### Client router cache behavior\n\nThe `stale` property controls the client-side router cache, not the `Cache-Control` header:\n\n- The server sends the stale time via the `x-nextjs-stale-time` response header\n- The client router uses this value to determine when to revalidate\n- **Minimum of 30 seconds is enforced** to ensure prefetched links remain usable\n\nThis 30-second minimum prevents prefetched data from expiring before users can click on links. It only applies to time-based expiration.\n\nWhen you call revalidation functions from a Server Action ([`revalidateTag`](/docs/app/api-reference/functions/revalidateTag), [`revalidatePath`](/docs/app/api-reference/functions/revalidatePath), [`updateTag`](/docs/app/api-reference/functions/updateTag), or [`refresh`](/docs/app/api-reference/functions/refresh)), the entire client cache is immediately cleared, bypassing the stale time."
  },
  {
    "id": "cacheLife.mdx#12",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "> **Good to know**: The `stale` property in `cacheLife` differs from [`staleTimes`](/docs/app/api-reference/config/next-config-js/staleTimes). While `staleTimes` is a global setting affecting all routes, `cacheLife` allows per-function or per-route configuration. Updating `staleTimes.static` also updates the `stale` value of the `default` cache profile."
  },
  {
    "id": "cacheLife.mdx#13",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "## Examples\n\n### Using preset profiles\n\nThe simplest way to configure caching is using preset profiles. Choose one that matches your content's update pattern:\n\n```tsx filename=\"app/blog/[slug]/page.tsx\"\nimport { cacheLife } from 'next/cache'\n\nexport default async function BlogPost() {\n  'use cache'\n  cacheLife('days') // Blog posts updated daily\n\n  const post = await fetchBlogPost()\n  return <article>{post.content}</article>\n}\n```\n\n```tsx filename=\"app/products/[id]/page.tsx\"\nimport { cacheLife } from 'next/cache'\n\nexport default async function ProductPage() {\n  'use cache'\n  cacheLife('hours') // Product data updated multiple times per day\n\n  const product = await fetchProduct()\n  return <div>{product.name}</div>\n}\n```"
  },
  {
    "id": "cacheLife.mdx#14",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "### Custom profiles for specific needs\n\nDefine custom profiles when preset options don't match your requirements:\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  cacheComponents: true,\n  cacheLife: {\n    editorial: {\n      stale: 600, // 10 minutes\n      revalidate: 3600, // 1 hour\n      expire: 86400, // 1 day\n    },\n    marketing: {\n      stale: 300, // 5 minutes\n      revalidate: 1800, // 30 minutes\n      expire: 43200, // 12 hours\n    },\n  },\n}\n\nexport default nextConfig\n```\n\nThen use these profiles throughout your application:\n\n```tsx filename=\"app/editorial/page.tsx\"\nimport { cacheLife } from 'next/cache'\n\nexport default async function EditorialPage() {\n  'use cache'\n  cacheLife('editorial')\n  // ...\n}\n```"
  },
  {
    "id": "cacheLife.mdx#15",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "### Inline profiles for unique cases\n\nUse inline profiles when a specific function needs one-off caching behavior:\n\n```tsx filename=\"app/api/limited-offer/route.ts\"\nimport { cacheLife } from 'next/cache'\nimport { getDb } from '@lib/db'\n\nasync function getLimitedOffer() {\n  'use cache'\n\n  cacheLife({\n    stale: 60, // 1 minute\n    revalidate: 300, // 5 minutes\n    expire: 3600, // 1 hour\n  })\n\n  const offer = await getDb().offer.findFirst({\n    where: { type: 'limited' },\n    orderBy: { created_at: 'desc' },\n  })\n\n  return offer\n}\n\nexport async function GET() {\n  const offer = await getLimitedOffer()\n\n  return Response.json(offer)\n}\n```\n\n### Caching individual functions\n\nApply caching to utility functions for granular control:\n\n```tsx filename=\"lib/api.ts\"\nimport { cacheLife } from 'next/cache'\n\nexport async function getSettings() {\n  'use cache'\n  cacheLife('max') // Settings rarely change\n\n  return await fetchSettings()\n}\n```\n\n```tsx filename=\"lib/stats.ts\"\nimport { cacheLife } from 'next/cache'\n\nexport async function getRealtimeStats() {\n  'use cache'\n  cacheLife('seconds') // Stats update constantly\n\n  return await fetchStats()\n}\n```"
  },
  {
    "id": "cacheLife.mdx#16",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "### Nested caching behavior\n\nWhen components with different cache profiles are nested, Next.js respects the shortest duration among them:\n\n```tsx filename=\"app/dashboard/page.tsx\"\nimport { cacheLife } from 'next/cache'\nimport { RealtimeWidget } from './realtime-widget'\n\nexport default async function Dashboard() {\n  'use cache'\n  cacheLife('hours') // Dashboard cached for hours\n\n  return (\n    <div>\n      <h1>Dashboard</h1>\n      <RealtimeWidget />\n    </div>\n  )\n}\n```\n\n```tsx filename=\"app/dashboard/realtime-widget.tsx\"\nimport { cacheLife } from 'next/cache'\n\nexport async function RealtimeWidget() {\n  'use cache'\n  cacheLife('seconds') // Widget needs fresh data\n\n  const data = await fetchRealtimeData()\n  return <div>{data.value}</div>\n}"
  },
  {
    "id": "cacheLife.mdx#17",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to use the cacheLife function to set the cache expiration time for a cached function or component."
    },
    "content": "```\n\nIn this example, the outer `Dashboard` component specifies the `hours` profile, but it contains `RealtimeWidget` which uses the `seconds` profile. The shortest duration from the nested profiles takes precedence, ensuring the widget gets fresh data while the rest of the dashboard can be cached longer.\n\n> **Good to know**: This shortest-duration behavior ensures that no part of your page serves stale data longer than its most frequently updated component requires."
  },
  {
    "id": "cacheTag.mdx#0",
    "metadata": {
      "title": "cacheTag",
      "description": "Learn how to use the cacheTag function to manage cache invalidation in your Next.js application."
    },
    "content": "---\ntitle: cacheTag\ndescription: Learn how to use the cacheTag function to manage cache invalidation in your Next.js application.\nrelated:\n  title: Related\n  description: View related API references.\n  links:\n    - app/api-reference/config/next-config-js/cacheComponents\n    - app/api-reference/directives/use-cache\n    - app/api-reference/functions/revalidateTag\n    - app/api-reference/functions/cacheLife\n---\n\nThe `cacheTag` function allows you to tag cached data for on-demand invalidation. By associating tags with cache entries, you can selectively purge or revalidate specific cache entries without affecting other cached data."
  },
  {
    "id": "cacheTag.mdx#1",
    "metadata": {
      "title": "cacheTag",
      "description": "Learn how to use the cacheTag function to manage cache invalidation in your Next.js application."
    },
    "content": "## Usage\n\nTo use `cacheTag`, enable the [`cacheComponents` flag](/docs/app/api-reference/config/next-config-js/cacheComponents) in your `next.config.js` file:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  cacheComponents: true,\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\nconst nextConfig = {\n  cacheComponents: true,\n}\n\nexport default nextConfig\n```\n\nThe `cacheTag` function takes one or more string values.\n\n```tsx filename=\"app/data.ts\" switcher\nimport { cacheTag } from 'next/cache'\n\nexport async function getData() {\n  'use cache'\n  cacheTag('my-data')\n  const data = await fetch('/api/data')\n  return data\n}\n```\n\n```jsx filename=\"app/data.js\" switcher\nimport { cacheTag } from 'next/cache'\n\nexport async function getData() {\n  'use cache'\n  cacheTag('my-data')\n  const data = await fetch('/api/data')\n  return data\n}"
  },
  {
    "id": "cacheTag.mdx#2",
    "metadata": {
      "title": "cacheTag",
      "description": "Learn how to use the cacheTag function to manage cache invalidation in your Next.js application."
    },
    "content": "```\n\nYou can then purge the cache on-demand using [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) API in another function, for example, a [route handler](/docs/app/api-reference/file-conventions/route) or [Server Action](/docs/app/getting-started/updating-data):\n\n```tsx filename=\"app/action.ts\" switcher\n'use server'\n\nimport { revalidateTag } from 'next/cache'\n\nexport default async function submit() {\n  await addPost()\n  revalidateTag('my-data')\n}\n```\n\n```jsx filename=\"app/action.js\" switcher\n'use server'\n\nimport { revalidateTag } from 'next/cache'\n\nexport default async function submit() {\n  await addPost()\n  revalidateTag('my-data')\n}\n```"
  },
  {
    "id": "cacheTag.mdx#3",
    "metadata": {
      "title": "cacheTag",
      "description": "Learn how to use the cacheTag function to manage cache invalidation in your Next.js application."
    },
    "content": "## Good to know\n\n- **Idempotent Tags**: Applying the same tag multiple times has no additional effect.\n- **Multiple Tags**: You can assign multiple tags to a single cache entry by passing multiple string values to `cacheTag`.\n\n```tsx\ncacheTag('tag-one', 'tag-two')\n```\n\n- **Limits**: The max length for a custom tag is 256 characters and the max tag items is 128."
  },
  {
    "id": "cacheTag.mdx#4",
    "metadata": {
      "title": "cacheTag",
      "description": "Learn how to use the cacheTag function to manage cache invalidation in your Next.js application."
    },
    "content": "## Examples\n\n### Tagging components or functions\n\nTag your cached data by calling `cacheTag` within a cached function or component:\n\n```tsx filename=\"app/components/bookings.tsx\" switcher\nimport { cacheTag } from 'next/cache'\n\ninterface BookingsProps {\n  type: string\n}\n\nexport async function Bookings({ type = 'haircut' }: BookingsProps) {\n  'use cache'\n  cacheTag('bookings-data')\n\n  async function getBookingsData() {\n    const data = await fetch(`/api/bookings?type=${encodeURIComponent(type)}`)\n    return data\n  }\n\n  return //...\n}\n```\n\n```jsx filename=\"app/components/bookings.js\" switcher\nimport { cacheTag } from 'next/cache'\n\nexport async function Bookings({ type = 'haircut' }) {\n  'use cache'\n  cacheTag('bookings-data')\n\n  async function getBookingsData() {\n    const data = await fetch(`/api/bookings?type=${encodeURIComponent(type)}`)\n    return data\n  }\n\n  return //...\n}\n```"
  },
  {
    "id": "cacheTag.mdx#5",
    "metadata": {
      "title": "cacheTag",
      "description": "Learn how to use the cacheTag function to manage cache invalidation in your Next.js application."
    },
    "content": "### Creating tags from external data\n\nYou can use the data returned from an async function to tag the cache entry.\n\n```tsx filename=\"app/components/bookings.tsx\" switcher\nimport { cacheTag } from 'next/cache'\n\ninterface BookingsProps {\n  type: string\n}\n\nexport async function Bookings({ type = 'haircut' }: BookingsProps) {\n  async function getBookingsData() {\n    'use cache'\n    const data = await fetch(`/api/bookings?type=${encodeURIComponent(type)}`)\n    cacheTag('bookings-data', data.id)\n    return data\n  }\n  return //...\n}\n```\n\n```jsx filename=\"app/components/bookings.js\" switcher\nimport { cacheTag } from 'next/cache'\n\nexport async function Bookings({ type = 'haircut' }) {\n  async function getBookingsData() {\n    'use cache'\n    const data = await fetch(`/api/bookings?type=${encodeURIComponent(type)}`)\n    cacheTag('bookings-data', data.id)\n    return data\n  }\n  return //...\n}\n```"
  },
  {
    "id": "cacheTag.mdx#6",
    "metadata": {
      "title": "cacheTag",
      "description": "Learn how to use the cacheTag function to manage cache invalidation in your Next.js application."
    },
    "content": "### Invalidating tagged cache\n\nUsing [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag), you can invalidate the cache for a specific tag when needed:\n\n```tsx filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { revalidateTag } from 'next/cache'\n\nexport async function updateBookings() {\n  await updateBookingData()\n  revalidateTag('bookings-data')\n}\n```\n\n```jsx filename=\"app/actions.js\" switcher\n'use server'\n\nimport { revalidateTag } from 'next/cache'\n\nexport async function updateBookings() {\n  await updateBookingData()\n  revalidateTag('bookings-data')\n}\n```"
  },
  {
    "id": "connection.mdx#0",
    "metadata": {
      "title": "connection",
      "description": "API Reference for the connection function."
    },
    "content": "---\ntitle: connection\ndescription: API Reference for the connection function.\n---\n\nThe `connection()` function allows you to indicate rendering should wait for an incoming user request before continuing.\n\nIt's useful when a component doesn't use [Dynamic APIs](/docs/app/guides/caching#dynamic-rendering), but you want it to be dynamically rendered at runtime and not statically rendered at build time. This usually occurs when you access external information that you intentionally want to change the result of a render, such as `Math.random()` or `new Date()`.\n\n```ts filename=\"app/page.tsx\" switcher\nimport { connection } from 'next/server'\n\nexport default async function Page() {\n  await connection()\n  // Everything below will be excluded from prerendering\n  const rand = Math.random()\n  return <span>{rand}</span>\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { connection } from 'next/server'\n\nexport default async function Page() {\n  await connection()\n  // Everything below will be excluded from prerendering\n  const rand = Math.random()\n  return <span>{rand}</span>\n}\n```"
  },
  {
    "id": "connection.mdx#1",
    "metadata": {
      "title": "connection",
      "description": "API Reference for the connection function."
    },
    "content": "## Reference\n\n### Type\n\n```jsx\nfunction connection(): Promise<void>\n```\n\n### Parameters\n\n- The function does not accept any parameters.\n\n### Returns\n\n- The function returns a `void` Promise. It is not meant to be consumed.\n\n## Good to know\n\n- `connection` replaces [`unstable_noStore`](/docs/app/api-reference/functions/unstable_noStore) to better align with the future of Next.js.\n- The function is only necessary when dynamic rendering is required and common Dynamic APIs are not used.\n\n### Version History\n\n| Version      | Changes                  |\n| ------------ | ------------------------ |\n| `v15.0.0`    | `connection` stabilized. |\n| `v15.0.0-RC` | `connection` introduced. |"
  },
  {
    "id": "cookies.mdx#0",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "---\ntitle: cookies\ndescription: API Reference for the cookies function.\n---\n\n`cookies` is an **async** function that allows you to read the HTTP incoming request cookies in [Server Components](/docs/app/getting-started/server-and-client-components), and read/write outgoing request cookies in [Server Actions](/docs/app/getting-started/updating-data) or [Route Handlers](/docs/app/api-reference/file-conventions/route).\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { cookies } from 'next/headers'\n\nexport default async function Page() {\n  const cookieStore = await cookies()\n  const theme = cookieStore.get('theme')\n  return '...'\n}\n```\n\n```js filename=\"app/page.js\" switcher\nimport { cookies } from 'next/headers'\n\nexport default async function Page() {\n  const cookieStore = await cookies()\n  const theme = cookieStore.get('theme')\n  return '...'\n}\n```"
  },
  {
    "id": "cookies.mdx#1",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "## Reference"
  },
  {
    "id": "cookies.mdx#2",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "### Methods\n\nThe following methods are available:"
  },
  {
    "id": "cookies.mdx#3",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "| Method                      | Return Type      | Description                                                                     |\n| --------------------------- | ---------------- | ------------------------------------------------------------------------------- |\n| `get('name')`               | Object           | Accepts a cookie name and returns an object with the name and value.            |\n| `getAll()`                  | Array of objects | Returns a list of all the cookies with a matching name.                         |\n| `has('name')`               | Boolean          | Accepts a cookie name and returns a boolean based on if the cookie exists.      |\n| `set(name, value, options)` | -                | Accepts a cookie name, value, and options and sets the outgoing request cookie. |\n| `delete(name)`              | -                | Accepts a cookie name and deletes the cookie.                                   |\n| `clear()`                   | -                | Deletes all cookies.                                                            |\n| `toString()`                | String           | Returns a string representation of the cookies.                                 |"
  },
  {
    "id": "cookies.mdx#4",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "### Options\n\nWhen setting a cookie, the following properties from the `options` object are supported:"
  },
  {
    "id": "cookies.mdx#5",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "| Option        | Type                                   | Description                                                                        |\n| ------------- | -------------------------------------- | ---------------------------------------------------------------------------------- |\n| `name`        | String                                 | Specifies the name of the cookie.                                                  |\n| `value`       | String                                 | Specifies the value to be stored in the cookie.                                    |\n| `expires`     | Date                                   | Defines the exact date when the cookie will expire.                                |\n| `maxAge`      | Number                                 | Sets the cookie’s lifespan in seconds.                                             |\n| `domain`      | String                                 | Specifies the domain where the cookie is available.                                |\n| `path`        | String, default: `'/'`                 | Limits the cookie's scope to a specific path within the domain.                    |"
  },
  {
    "id": "cookies.mdx#6",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "| `path`        | String, default: `'/'`                 | Limits the cookie's scope to a specific path within the domain.                    |\n| `secure`      | Boolean                                | Ensures the cookie is sent only over HTTPS connections for added security.         |\n| `httpOnly`    | Boolean                                | Restricts the cookie to HTTP requests, preventing client-side access.              |\n| `sameSite`    | Boolean, `'lax'`, `'strict'`, `'none'` | Controls the cookie's cross-site request behavior.                                 |\n| `priority`    | String (`\"low\"`, `\"medium\"`, `\"high\"`) | Specifies the cookie's priority                                                    |\n| `partitioned` | Boolean                                | Indicates whether the cookie is [partitioned](https://github.com/privacycg/CHIPS). |"
  },
  {
    "id": "cookies.mdx#7",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "The only option with a default value is `path`.\n\nTo learn more about these options, see the [MDN docs](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)."
  },
  {
    "id": "cookies.mdx#8",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "## Good to know"
  },
  {
    "id": "cookies.mdx#9",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "- `cookies` is an **asynchronous** function that returns a promise. You must use `async/await` or React's [`use`](https://react.dev/reference/react/use) function to access cookies.\n  - In version 14 and earlier, `cookies` was a synchronous function. To help with backwards compatibility, you can still access it synchronously in Next.js 15, but this behavior will be deprecated in the future.\n- `cookies` is a [Dynamic API](/docs/app/guides/caching#dynamic-rendering) whose returned values cannot be known ahead of time. Using it in a layout or page will opt a route into [dynamic rendering](/docs/app/guides/caching#dynamic-rendering).\n- The `.delete` method can only be called:\n  - In a [Server Action](/docs/app/getting-started/updating-data) or [Route Handler](/docs/app/api-reference/file-conventions/route).\n  - If it belongs to the same domain from which `.set` is called. For wildcard domains, the specific subdomain must be an exact match. Additionally, the code must be executed on the same protocol (HTTP or HTTPS) as the cookie you want to delete."
  },
  {
    "id": "cookies.mdx#10",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "- HTTP does not allow setting cookies after streaming starts, so you must use `.set` in a [Server Action](/docs/app/getting-started/updating-data) or [Route Handler](/docs/app/api-reference/file-conventions/route)."
  },
  {
    "id": "cookies.mdx#11",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "## Understanding Cookie Behavior in Server Components\n\nWhen working with cookies in Server Components, it's important to understand that cookies are fundamentally a client-side storage mechanism:\n\n- **Reading cookies** works in Server Components because you're accessing the cookie data that the client's browser sends to the server in the HTTP request headers.\n- **Setting cookies** cannot be done directly in a Server Component, even when using a Route Handler or Server Action. This is because cookies are actually stored by the browser, not the server.\n\nThe server can only send instructions (via `Set-Cookie` headers) to tell the browser to store cookies - the actual storage happens on the client side. This is why cookie operations that modify state (`.set`, `.delete`, `.clear`) must be performed in a Route Handler or Server Action where the response headers can be properly set."
  },
  {
    "id": "cookies.mdx#12",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "## Understanding Cookie Behavior in Server Actions\n\nAfter you set or delete a cookie in a Server Action, Next.js re-renders the current page and its layouts on the server so the UI reflects the new cookie value. See the [Caching guide](/docs/app/guides/caching#cookies).\n\nThe UI is not unmounted, but effects that depend on data coming from the server will re-run.\n\nTo refresh cached data too, call [`revalidatePath`](/docs/app/api-reference/functions/revalidatePath) or [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) inside the action."
  },
  {
    "id": "cookies.mdx#13",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "## Examples\n\n### Getting a cookie\n\nYou can use the `(await cookies()).get('name')` method to get a single cookie:\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { cookies } from 'next/headers'\n\nexport default async function Page() {\n  const cookieStore = await cookies()\n  const theme = cookieStore.get('theme')\n  return '...'\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { cookies } from 'next/headers'\n\nexport default async function Page() {\n  const cookieStore = await cookies()\n  const theme = cookieStore.get('theme')\n  return '...'\n}\n```"
  },
  {
    "id": "cookies.mdx#14",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "### Getting all cookies\n\nYou can use the `(await cookies()).getAll()` method to get all cookies with a matching name. If `name` is unspecified, it returns all the available cookies.\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { cookies } from 'next/headers'\n\nexport default async function Page() {\n  const cookieStore = await cookies()\n  return cookieStore.getAll().map((cookie) => (\n    <div key={cookie.name}>\n      <p>Name: {cookie.name}</p>\n      <p>Value: {cookie.value}</p>\n    </div>\n  ))\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { cookies } from 'next/headers'\n\nexport default async function Page() {\n  const cookieStore = await cookies()\n  return cookieStore.getAll().map((cookie) => (\n    <div key={cookie.name}>\n      <p>Name: {cookie.name}</p>\n      <p>Value: {cookie.value}</p>\n    </div>\n  ))\n}\n```"
  },
  {
    "id": "cookies.mdx#15",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "### Setting a cookie\n\nYou can use the `(await cookies()).set(name, value, options)` method in a [Server Action](/docs/app/getting-started/updating-data) or [Route Handler](/docs/app/api-reference/file-conventions/route) to set a cookie. The [`options` object](#options) is optional.\n\n```tsx filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { cookies } from 'next/headers'\n\nexport async function create(data) {\n  const cookieStore = await cookies()\n\n  cookieStore.set('name', 'lee')\n  // or\n  cookieStore.set('name', 'lee', { secure: true })\n  // or\n  cookieStore.set({\n    name: 'name',\n    value: 'lee',\n    httpOnly: true,\n    path: '/',\n  })\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { cookies } from 'next/headers'\n\nexport async function create(data) {\n  const cookieStore = await cookies()\n\n  cookieStore.set('name', 'lee')\n  // or\n  cookieStore.set('name', 'lee', { secure: true })\n  // or\n  cookieStore.set({\n    name: 'name',\n    value: 'lee',\n    httpOnly: true,\n    path: '/',\n  })\n}\n```"
  },
  {
    "id": "cookies.mdx#16",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "### Checking if a cookie exists\n\nYou can use the `(await cookies()).has(name)` method to check if a cookie exists:\n\n```tsx filename=\"app/page.ts\" switcher\nimport { cookies } from 'next/headers'\n\nexport default async function Page() {\n  const cookieStore = await cookies()\n  const hasCookie = cookieStore.has('theme')\n  return '...'\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { cookies } from 'next/headers'\n\nexport default async function Page() {\n  const cookieStore = await cookies()\n  const hasCookie = cookieStore.has('theme')\n  return '...'\n}\n```"
  },
  {
    "id": "cookies.mdx#17",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "### Deleting cookies\n\nThere are three ways you can delete a cookie.\n\nUsing the `delete()` method:\n\n```tsx filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { cookies } from 'next/headers'\n\nexport async function deleteCookie(data) {\n  const cookieStore = await cookies()\n  cookieStore.delete('name')\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { cookies } from 'next/headers'\n\nexport async function deleteCookie(data) {\n  const cookieStore = await cookies()\n  cookieStore.delete('name')\n}\n```\n\nSetting a new cookie with the same name and an empty value:\n\n```tsx filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { cookies } from 'next/headers'\n\nexport async function deleteCookie(data) {\n  const cookieStore = await cookies()\n  cookieStore.set('name', '')\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { cookies } from 'next/headers'\n\nexport async function deleteCookie(data) {\n  const cookieStore = await cookies()\n  cookieStore.set('name', '')\n}"
  },
  {
    "id": "cookies.mdx#18",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "```\n\nSetting the `maxAge` to 0 will immediately expire a cookie. `maxAge` accepts a value in seconds.\n\n```tsx filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { cookies } from 'next/headers'\n\nexport async function deleteCookie(data) {\n  const cookieStore = await cookies()\n  cookieStore.set('name', 'value', { maxAge: 0 })\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { cookies } from 'next/headers'\n\nexport async function deleteCookie(data) {\n  const cookieStore = await cookies()\n  cookieStore.set('name', 'value', { maxAge: 0 })\n}\n```"
  },
  {
    "id": "cookies.mdx#19",
    "metadata": {
      "title": "cookies",
      "description": "API Reference for the cookies function."
    },
    "content": "## Version History\n\n| Version      | Changes                                                                                                |\n| ------------ | ------------------------------------------------------------------------------------------------------ |\n| `v15.0.0-RC` | `cookies` is now an async function. A [codemod](/docs/app/guides/upgrading/codemods#150) is available. |\n| `v13.0.0`    | `cookies` introduced.                                                                                  |"
  },
  {
    "id": "draft-mode.mdx#0",
    "metadata": {
      "title": "draftMode",
      "description": "API Reference for the draftMode function."
    },
    "content": "---\ntitle: draftMode\ndescription: API Reference for the draftMode function.\nrelated:\n  title: Next Steps\n  description: Learn how to use Draft Mode with this step-by-step guide.\n  links:\n    - app/guides/draft-mode\n---\n\n`draftMode` is an **async** function allows you to enable and disable [Draft Mode](/docs/app/guides/draft-mode), as well as check if Draft Mode is enabled in a [Server Component](/docs/app/getting-started/server-and-client-components).\n\n```tsx filename=\"app/page.ts\" switcher\nimport { draftMode } from 'next/headers'\n\nexport default async function Page() {\n  const { isEnabled } = await draftMode()\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { draftMode } from 'next/headers'\n\nexport default async function Page() {\n  const { isEnabled } = await draftMode()\n}\n```"
  },
  {
    "id": "draft-mode.mdx#1",
    "metadata": {
      "title": "draftMode",
      "description": "API Reference for the draftMode function."
    },
    "content": "## Reference\n\nThe following methods and properties are available:\n\n| Method      | Description                                                                       |\n| ----------- | --------------------------------------------------------------------------------- |\n| `isEnabled` | A boolean value that indicates if Draft Mode is enabled.                          |\n| `enable()`  | Enables Draft Mode in a Route Handler by setting a cookie (`__prerender_bypass`). |\n| `disable()` | Disables Draft Mode in a Route Handler by deleting a cookie.                      |"
  },
  {
    "id": "draft-mode.mdx#2",
    "metadata": {
      "title": "draftMode",
      "description": "API Reference for the draftMode function."
    },
    "content": "## Good to know\n\n- `draftMode` is an **asynchronous** function that returns a promise. You must use `async/await` or React's [`use`](https://react.dev/reference/react/use) function.\n  - In version 14 and earlier, `draftMode` was a synchronous function. To help with backwards compatibility, you can still access it synchronously in Next.js 15, but this behavior will be deprecated in the future.\n- A new bypass cookie value will be generated each time you run `next build`. This ensures that the bypass cookie can’t be guessed.\n- To test Draft Mode locally over HTTP, your browser will need to allow third-party cookies and local storage access."
  },
  {
    "id": "draft-mode.mdx#3",
    "metadata": {
      "title": "draftMode",
      "description": "API Reference for the draftMode function."
    },
    "content": "## Examples\n\n### Enabling Draft Mode\n\nTo enable Draft Mode, create a new [Route Handler](/docs/app/api-reference/file-conventions/route) and call the `enable()` method:\n\n```tsx filename=\"app/draft/route.ts\" switcher\nimport { draftMode } from 'next/headers'\n\nexport async function GET(request: Request) {\n  const draft = await draftMode()\n  draft.enable()\n  return new Response('Draft mode is enabled')\n}\n```\n\n```js filename=\"app/draft/route.js\" switcher\nimport { draftMode } from 'next/headers'\n\nexport async function GET(request) {\n  const draft = await draftMode()\n  draft.enable()\n  return new Response('Draft mode is enabled')\n}\n```"
  },
  {
    "id": "draft-mode.mdx#4",
    "metadata": {
      "title": "draftMode",
      "description": "API Reference for the draftMode function."
    },
    "content": "### Disabling Draft Mode\n\nBy default, the Draft Mode session ends when the browser is closed.\n\nTo disable Draft Mode manually, call the `disable()` method in your [Route Handler](/docs/app/api-reference/file-conventions/route):\n\n```tsx filename=\"app/draft/route.ts\" switcher\nimport { draftMode } from 'next/headers'\n\nexport async function GET(request: Request) {\n  const draft = await draftMode()\n  draft.disable()\n  return new Response('Draft mode is disabled')\n}\n```\n\n```js filename=\"app/draft/route.js\" switcher\nimport { draftMode } from 'next/headers'\n\nexport async function GET(request) {\n  const draft = await draftMode()\n  draft.disable()\n  return new Response('Draft mode is disabled')\n}\n```\n\nThen, send a request to invoke the Route Handler. If calling the route using the [`<Link>` component](/docs/app/api-reference/components/link), you must pass `prefetch={false}` to prevent accidentally deleting the cookie on prefetch."
  },
  {
    "id": "draft-mode.mdx#5",
    "metadata": {
      "title": "draftMode",
      "description": "API Reference for the draftMode function."
    },
    "content": "### Checking if Draft Mode is enabled\n\nYou can check if Draft Mode is enabled in a Server Component with the `isEnabled` property:\n\n```tsx filename=\"app/page.ts\" switcher\nimport { draftMode } from 'next/headers'\n\nexport default async function Page() {\n  const { isEnabled } = await draftMode()\n  return (\n    <main>\n      <h1>My Blog Post</h1>\n      <p>Draft Mode is currently {isEnabled ? 'Enabled' : 'Disabled'}</p>\n    </main>\n  )\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { draftMode } from 'next/headers'\n\nexport default async function Page() {\n  const { isEnabled } = await draftMode()\n  return (\n    <main>\n      <h1>My Blog Post</h1>\n      <p>Draft Mode is currently {isEnabled ? 'Enabled' : 'Disabled'}</p>\n    </main>\n  )\n}\n```"
  },
  {
    "id": "draft-mode.mdx#6",
    "metadata": {
      "title": "draftMode",
      "description": "API Reference for the draftMode function."
    },
    "content": "## Version History\n\n| Version      | Changes                                                                                                  |\n| ------------ | -------------------------------------------------------------------------------------------------------- |\n| `v15.0.0-RC` | `draftMode` is now an async function. A [codemod](/docs/app/guides/upgrading/codemods#150) is available. |\n| `v13.4.0`    | `draftMode` introduced.                                                                                  |"
  },
  {
    "id": "fetch.mdx#0",
    "metadata": {
      "title": "fetch",
      "description": "API reference for the extended fetch function."
    },
    "content": "---\ntitle: fetch\ndescription: API reference for the extended fetch function.\n---\n\nNext.js extends the [Web `fetch()` API](https://developer.mozilla.org/docs/Web/API/Fetch_API) to allow each request on the server to set its own persistent caching and revalidation semantics.\n\nIn the browser, the `cache` option indicates how a fetch request will interact with the _browser's_ HTTP cache. With this extension, `cache` indicates how a _server-side_ fetch request will interact with the framework's persistent [Data Cache](/docs/app/guides/caching#data-cache).\n\nYou can call `fetch` with `async` and `await` directly within Server Components.\n\n```tsx filename=\"app/page.tsx\" switcher\nexport default async function Page() {\n  let data = await fetch('https://api.vercel.app/blog')\n  let posts = await data.json()\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.id}>{post.title}</li>\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "fetch.mdx#1",
    "metadata": {
      "title": "fetch",
      "description": "API reference for the extended fetch function."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\" switcher\nexport default async function Page() {\n  let data = await fetch('https://api.vercel.app/blog')\n  let posts = await data.json()\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.id}>{post.title}</li>\n      ))}\n    </ul>\n  )\n}\n```"
  },
  {
    "id": "fetch.mdx#2",
    "metadata": {
      "title": "fetch",
      "description": "API reference for the extended fetch function."
    },
    "content": "## `fetch(url, options)`\n\nSince Next.js extends the [Web `fetch()` API](https://developer.mozilla.org/docs/Web/API/Fetch_API), you can use any of the [native options available](https://developer.mozilla.org/docs/Web/API/fetch#parameters)."
  },
  {
    "id": "fetch.mdx#3",
    "metadata": {
      "title": "fetch",
      "description": "API reference for the extended fetch function."
    },
    "content": "### `options.cache`\n\nConfigure how the request should interact with Next.js [Data Cache](/docs/app/guides/caching#data-cache).\n\n```ts\nfetch(`https://...`, { cache: 'force-cache' | 'no-store' })\n```\n\n- **`auto no cache`** (default): Next.js fetches the resource from the remote server on every request in development, but will fetch once during `next build` because the route will be statically prerendered. If [Dynamic APIs](/docs/app/guides/caching#dynamic-rendering) are detected on the route, Next.js will fetch the resource on every request.\n- **`no-store`**: Next.js fetches the resource from the remote server on every request, even if Dynamic APIs are not detected on the route.\n- **`force-cache`**: Next.js looks for a matching request in its Data Cache.\n  - If there is a match and it is fresh, it will be returned from the cache.\n  - If there is no match or a stale match, Next.js will fetch the resource from the remote server and update the cache with the downloaded resource."
  },
  {
    "id": "fetch.mdx#4",
    "metadata": {
      "title": "fetch",
      "description": "API reference for the extended fetch function."
    },
    "content": "### `options.next.revalidate`\n\n```ts\nfetch(`https://...`, { next: { revalidate: false | 0 | number } })\n```\n\nSet the cache lifetime of a resource (in seconds). [Data Cache](/docs/app/guides/caching#data-cache).\n\n- **`false`** - Cache the resource indefinitely. Semantically equivalent to `revalidate: Infinity`. The HTTP cache may evict older resources over time.\n- **`0`** - Prevent the resource from being cached.\n- **`number`** - (in seconds) Specify the resource should have a cache lifetime of at most `n` seconds.\n\n> **Good to know**:\n>\n> - If an individual `fetch()` request sets a `revalidate` number lower than the [default `revalidate`](/docs/app/api-reference/file-conventions/route-segment-config#revalidate) of a route, the whole route revalidation interval will be decreased.\n> - If two fetch requests with the same URL in the same route have different `revalidate` values, the lower value will be used.\n> - Conflicting options such as `{ revalidate: 3600, cache: 'no-store' }` are not allowed, both will be ignored, and in development mode a warning will be printed to the terminal."
  },
  {
    "id": "fetch.mdx#5",
    "metadata": {
      "title": "fetch",
      "description": "API reference for the extended fetch function."
    },
    "content": "### `options.next.tags`\n\n```ts\nfetch(`https://...`, { next: { tags: ['collection'] } })\n```\n\nSet the cache tags of a resource. Data can then be revalidated on-demand using [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag). The max length for a custom tag is 256 characters and the max tag items is 128."
  },
  {
    "id": "fetch.mdx#6",
    "metadata": {
      "title": "fetch",
      "description": "API reference for the extended fetch function."
    },
    "content": "## Troubleshooting\n\n### Fetch default `auto no store` and `cache: 'no-store'` not showing fresh data in development\n\nNext.js caches `fetch` responses in Server Components across Hot Module Replacement (HMR) in local development for faster responses and to reduce costs for billed API calls.\n\nBy default, the [HMR cache](/docs/app/api-reference/config/next-config-js/serverComponentsHmrCache) applies to all fetch requests, including those with the default `auto no cache` and `cache: 'no-store'` option. This means uncached requests will not show fresh data between HMR refreshes. However, the cache will be cleared on navigation or full-page reloads.\n\nSee the [`serverComponentsHmrCache`](/docs/app/api-reference/config/next-config-js/serverComponentsHmrCache) docs for more information.\n\n### Hard refresh and caching in development\n\nIn development mode, if the request includes the `cache-control: no-cache` header, `options.cache`, `options.next.revalidate`, and `options.next.tags` are ignored, and the `fetch` request is served from the source.\n\nBrowsers typically include `cache-control: no-cache` when the cache is disabled in developer tools or during a hard refresh."
  },
  {
    "id": "fetch.mdx#7",
    "metadata": {
      "title": "fetch",
      "description": "API reference for the extended fetch function."
    },
    "content": "## Version History\n\n| Version   | Changes             |\n| --------- | ------------------- |\n| `v13.0.0` | `fetch` introduced. |"
  },
  {
    "id": "forbidden.mdx#0",
    "metadata": {
      "title": "forbidden",
      "description": "API Reference for the forbidden function."
    },
    "content": "---\ntitle: forbidden\ndescription: API Reference for the forbidden function.\nversion: experimental\nrelated:\n  links:\n    - app/api-reference/file-conventions/forbidden\n---\n\nThe `forbidden` function throws an error that renders a Next.js 403 error page. It's useful for handling authorization errors in your application. You can customize the UI using the [`forbidden.js` file](/docs/app/api-reference/file-conventions/forbidden).\n\nTo start using `forbidden`, enable the experimental [`authInterrupts`](/docs/app/api-reference/config/next-config-js/authInterrupts) configuration option in your `next.config.js` file:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    authInterrupts: true,\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  experimental: {\n    authInterrupts: true,\n  },\n}"
  },
  {
    "id": "forbidden.mdx#1",
    "metadata": {
      "title": "forbidden",
      "description": "API Reference for the forbidden function."
    },
    "content": "```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  experimental: {\n    authInterrupts: true,\n  },\n}\n```\n\n`forbidden` can be invoked in [Server Components](/docs/app/getting-started/server-and-client-components), [Server Actions](/docs/app/getting-started/updating-data), and [Route Handlers](/docs/app/api-reference/file-conventions/route).\n\n```tsx filename=\"app/auth/page.tsx\" switcher\nimport { verifySession } from '@/app/lib/dal'\nimport { forbidden } from 'next/navigation'\n\nexport default async function AdminPage() {\n  const session = await verifySession()\n\n  // Check if the user has the 'admin' role\n  if (session.role !== 'admin') {\n    forbidden()\n  }\n\n  // Render the admin page for authorized users\n  return <></>\n}\n```\n\n```jsx filename=\"app/auth/page.js\" switcher\nimport { verifySession } from '@/app/lib/dal'\nimport { forbidden } from 'next/navigation'\n\nexport default async function AdminPage() {\n  const session = await verifySession()\n\n  // Check if the user has the 'admin' role\n  if (session.role !== 'admin') {\n    forbidden()\n  }\n\n  // Render the admin page for authorized users\n  return <></>\n}\n```"
  },
  {
    "id": "forbidden.mdx#2",
    "metadata": {
      "title": "forbidden",
      "description": "API Reference for the forbidden function."
    },
    "content": "## Good to know\n\n- The `forbidden` function cannot be called in the [root layout](/docs/app/api-reference/file-conventions/layout#root-layout)."
  },
  {
    "id": "forbidden.mdx#3",
    "metadata": {
      "title": "forbidden",
      "description": "API Reference for the forbidden function."
    },
    "content": "## Examples"
  },
  {
    "id": "forbidden.mdx#4",
    "metadata": {
      "title": "forbidden",
      "description": "API Reference for the forbidden function."
    },
    "content": "### Role-based route protection\n\nYou can use `forbidden` to restrict access to certain routes based on user roles. This ensures that users who are authenticated but lack the required permissions cannot access the route.\n\n```tsx filename=\"app/admin/page.tsx\" switcher\nimport { verifySession } from '@/app/lib/dal'\nimport { forbidden } from 'next/navigation'\n\nexport default async function AdminPage() {\n  const session = await verifySession()\n\n  // Check if the user has the 'admin' role\n  if (session.role !== 'admin') {\n    forbidden()\n  }\n\n  // Render the admin page for authorized users\n  return (\n    <main>\n      <h1>Admin Dashboard</h1>\n      <p>Welcome, {session.user.name}!</p>\n    </main>\n  )\n}\n```\n\n```jsx filename=\"app/admin/page.js\" switcher\nimport { verifySession } from '@/app/lib/dal'\nimport { forbidden } from 'next/navigation'\n\nexport default async function AdminPage() {\n  const session = await verifySession()\n\n  // Check if the user has the 'admin' role\n  if (session.role !== 'admin') {\n    forbidden()\n  }\n\n  // Render the admin page for authorized users\n  return (\n    <main>\n      <h1>Admin Dashboard</h1>\n      <p>Welcome, {session.user.name}!</p>\n    </main>\n  )\n}\n```"
  },
  {
    "id": "forbidden.mdx#5",
    "metadata": {
      "title": "forbidden",
      "description": "API Reference for the forbidden function."
    },
    "content": "### Mutations with Server Actions\n\nWhen implementing mutations in Server Actions, you can use `forbidden` to only allow users with a specific role to update sensitive data.\n\n```ts filename=\"app/actions/update-role.ts\" switcher\n'use server'\n\nimport { verifySession } from '@/app/lib/dal'\nimport { forbidden } from 'next/navigation'\nimport db from '@/app/lib/db'\n\nexport async function updateRole(formData: FormData) {\n  const session = await verifySession()\n\n  // Ensure only admins can update roles\n  if (session.role !== 'admin') {\n    forbidden()\n  }\n\n  // Perform the role update for authorized users\n  // ...\n}\n```\n\n```js filename=\"app/actions/update-role.js\" switcher\n'use server'\n\nimport { verifySession } from '@/app/lib/dal'\nimport { forbidden } from 'next/navigation'\nimport db from '@/app/lib/db'\n\nexport async function updateRole(formData) {\n  const session = await verifySession()\n\n  // Ensure only admins can update roles\n  if (session.role !== 'admin') {\n    forbidden()\n  }\n\n  // Perform the role update for authorized users\n  // ...\n}\n```"
  },
  {
    "id": "forbidden.mdx#6",
    "metadata": {
      "title": "forbidden",
      "description": "API Reference for the forbidden function."
    },
    "content": "## Version History\n\n| Version   | Changes                 |\n| --------- | ----------------------- |\n| `v15.1.0` | `forbidden` introduced. |"
  },
  {
    "id": "generate-image-metadata.mdx#0",
    "metadata": {
      "title": "generateImageMetadata",
      "description": "Learn how to generate multiple images in a single Metadata API special file."
    },
    "content": "---\ntitle: generateImageMetadata\ndescription: Learn how to generate multiple images in a single Metadata API special file.\nrelated:\n  title: Next Steps\n  description: View all the Metadata API options.\n  links:\n    - app/api-reference/file-conventions/metadata\n---\n\nYou can use `generateImageMetadata` to generate different versions of one image or return multiple images for one route segment. This is useful for when you want to avoid hard-coding metadata values, such as for icons."
  },
  {
    "id": "generate-image-metadata.mdx#1",
    "metadata": {
      "title": "generateImageMetadata",
      "description": "Learn how to generate multiple images in a single Metadata API special file."
    },
    "content": "## Parameters\n\n`generateImageMetadata` function accepts the following parameters:\n\n#### `params` (optional)\n\nAn object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) object from the root segment down to the segment `generateImageMetadata` is called from.\n\n```tsx filename=\"icon.tsx\" switcher\nexport function generateImageMetadata({\n  params,\n}: {\n  params: { slug: string }\n}) {\n  // ...\n}\n```\n\n```jsx filename=\"icon.js\" switcher\nexport function generateImageMetadata({ params }) {\n  // ...\n}\n```\n\n| Route                           | URL         | `params`                  |\n| ------------------------------- | ----------- | ------------------------- |\n| `app/shop/icon.js`              | `/shop`     | `undefined`               |\n| `app/shop/[slug]/icon.js`       | `/shop/1`   | `{ slug: '1' }`           |\n| `app/shop/[tag]/[item]/icon.js` | `/shop/1/2` | `{ tag: '1', item: '2' }` |"
  },
  {
    "id": "generate-image-metadata.mdx#2",
    "metadata": {
      "title": "generateImageMetadata",
      "description": "Learn how to generate multiple images in a single Metadata API special file."
    },
    "content": "## Returns\n\nThe `generateImageMetadata` function should return an `array` of objects containing the image's metadata such as `alt` and `size`. In addition, each item **must** include an `id` value which will be passed as a promise to the props of the image generating function.\n\n| Image Metadata Object | Type                                |\n| --------------------- | ----------------------------------- |\n| `id`                  | `string` (required)                 |\n| `alt`                 | `string`                            |\n| `size`                | `{ width: number; height: number }` |\n| `contentType`         | `string`                            |\n\n```tsx filename=\"icon.tsx\" switcher\nimport { ImageResponse } from 'next/og'\n\nexport function generateImageMetadata() {\n  return [\n    {\n      contentType: 'image/png',\n      size: { width: 48, height: 48 },\n      id: 'small',\n    },\n    {\n      contentType: 'image/png',\n      size: { width: 72, height: 72 },\n      id: 'medium',\n    },\n  ]\n}"
  },
  {
    "id": "generate-image-metadata.mdx#3",
    "metadata": {
      "title": "generateImageMetadata",
      "description": "Learn how to generate multiple images in a single Metadata API special file."
    },
    "content": "export default async function Icon({ id }: { id: Promise<string | number> }) {\n  const iconId = await id\n  return new ImageResponse(\n    (\n      <div\n        style={{\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          fontSize: 88,\n          background: '#000',\n          color: '#fafafa',\n        }}\n      >\n        Icon {iconId}\n      </div>\n    )\n  )\n}"
  },
  {
    "id": "generate-image-metadata.mdx#4",
    "metadata": {
      "title": "generateImageMetadata",
      "description": "Learn how to generate multiple images in a single Metadata API special file."
    },
    "content": "```\n\n```jsx filename=\"icon.js\" switcher\nimport { ImageResponse } from 'next/og'\n\nexport function generateImageMetadata() {\n  return [\n    {\n      contentType: 'image/png',\n      size: { width: 48, height: 48 },\n      id: 'small',\n    },\n    {\n      contentType: 'image/png',\n      size: { width: 72, height: 72 },\n      id: 'medium',\n    },\n  ]\n}\n\nexport default async function Icon({ id }) {\n  const iconId = await id\n  return new ImageResponse(\n    (\n      <div\n        style={{\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          fontSize: 88,\n          background: '#000',\n          color: '#fafafa',\n        }}\n      >\n        Icon {iconId}\n      </div>\n    )\n  )\n}\n```"
  },
  {
    "id": "generate-image-metadata.mdx#5",
    "metadata": {
      "title": "generateImageMetadata",
      "description": "Learn how to generate multiple images in a single Metadata API special file."
    },
    "content": "## Image generation function props\n\nWhen using `generateImageMetadata`, the default export image generation function receives the following props:\n\n#### `id`\n\nA promise that resolves to the `id` value from one of the items returned by `generateImageMetadata`. The `id` will be a `string` or `number` depending on what was returned from `generateImageMetadata`.\n\n```tsx filename=\"icon.tsx\" switcher\nexport default async function Icon({ id }: { id: Promise<string | number> }) {\n  const iconId = await id\n  // Use iconId to generate the image\n}\n```\n\n```jsx filename=\"icon.js\" switcher\nexport default async function Icon({ id }) {\n  const iconId = await id\n  // Use iconId to generate the image\n}\n```"
  },
  {
    "id": "generate-image-metadata.mdx#6",
    "metadata": {
      "title": "generateImageMetadata",
      "description": "Learn how to generate multiple images in a single Metadata API special file."
    },
    "content": "#### `params` (optional)\n\nA promise that resolves to an object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) from the root segment down to the segment the image is colocated in.\n\n```tsx filename=\"icon.tsx\" switcher\nexport default async function Icon({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = await params\n  // Use slug to generate the image\n}\n```\n\n```jsx filename=\"icon.js\" switcher\nexport default async function Icon({ params }) {\n  const { slug } = await params\n  // Use slug to generate the image\n}\n```"
  },
  {
    "id": "generate-image-metadata.mdx#7",
    "metadata": {
      "title": "generateImageMetadata",
      "description": "Learn how to generate multiple images in a single Metadata API special file."
    },
    "content": "### Examples"
  },
  {
    "id": "generate-image-metadata.mdx#8",
    "metadata": {
      "title": "generateImageMetadata",
      "description": "Learn how to generate multiple images in a single Metadata API special file."
    },
    "content": "#### Using external data\n\nThis example uses the `params` object and external data to generate multiple [Open Graph images](/docs/app/api-reference/file-conventions/metadata/opengraph-image) for a route segment.\n\n```tsx filename=\"app/products/[id]/opengraph-image.tsx\" switcher\nimport { ImageResponse } from 'next/og'\nimport { getCaptionForImage, getOGImages } from '@/app/utils/images'\n\nexport async function generateImageMetadata({\n  params,\n}: {\n  params: { id: string }\n}) {\n  const images = await getOGImages(params.id)\n\n  return images.map((image, idx) => ({\n    id: idx,\n    size: { width: 1200, height: 600 },\n    alt: image.text,\n    contentType: 'image/png',\n  }))\n}\n\nexport default async function Image({\n  params,\n  id,\n}: {\n  params: Promise<{ id: string }>\n  id: Promise<number>\n}) {\n  const productId = (await params).id\n  const imageId = await id\n  const text = await getCaptionForImage(productId, imageId)\n\n  return new ImageResponse(\n    (\n      <div\n        style={\n          {\n            // ...\n          }\n        }\n      >\n        {text}\n      </div>\n    )\n  )\n}"
  },
  {
    "id": "generate-image-metadata.mdx#9",
    "metadata": {
      "title": "generateImageMetadata",
      "description": "Learn how to generate multiple images in a single Metadata API special file."
    },
    "content": "```\n\n```jsx filename=\"app/products/[id]/opengraph-image.js\" switcher\nimport { ImageResponse } from 'next/og'\nimport { getCaptionForImage, getOGImages } from '@/app/utils/images'\n\nexport async function generateImageMetadata({ params }) {\n  const images = await getOGImages(params.id)\n\n  return images.map((image, idx) => ({\n    id: idx,\n    size: { width: 1200, height: 600 },\n    alt: image.text,\n    contentType: 'image/png',\n  }))\n}\n\nexport default async function Image({ params, id }) {\n  const productId = (await params).id\n  const imageId = await id\n  const text = await getCaptionForImage(productId, imageId)\n\n  return new ImageResponse(\n    (\n      <div\n        style={\n          {\n            // ...\n          }\n        }\n      >\n        {text}\n      </div>\n    )\n  )\n}\n```"
  },
  {
    "id": "generate-image-metadata.mdx#10",
    "metadata": {
      "title": "generateImageMetadata",
      "description": "Learn how to generate multiple images in a single Metadata API special file."
    },
    "content": "## Version History\n\n| Version   | Changes                                                                                             |\n| --------- | --------------------------------------------------------------------------------------------------- |\n| `v16.0.0` | `id` passed to the Image generation function is now a promise that resolves to `string` or `number` |\n| `v16.0.0` | `params` passed to the Image generation function is now a promise that resolves to an object        |\n| `v13.3.0` | `generateImageMetadata` introduced.                                                                 |"
  },
  {
    "id": "generate-metadata.mdx#0",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "---\ntitle: generateMetadata\ndescription: Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability.\nrelated:\n  title: Next Steps\n  description: View all the Metadata API options.\n  links:\n    - app/api-reference/file-conventions/metadata\n    - app/api-reference/functions/generate-viewport\n---\n\nYou can use the `metadata` object or the `generateMetadata` function to define metadata.\n\n## The `metadata` object\n\nTo define static metadata, export a [`Metadata` object](#metadata-fields) from a `layout.js` or `page.js` file.\n\n```tsx filename=\"layout.tsx | page.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: '...',\n  description: '...',\n}\n\nexport default function Page() {}\n```\n\n```jsx filename=\"layout.js | page.js\" switcher\nexport const metadata = {\n  title: '...',\n  description: '...',\n}\n\nexport default function Page() {}\n```\n\n> See the [Metadata Fields](#metadata-fields) for a complete list of supported options."
  },
  {
    "id": "generate-metadata.mdx#1",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "## `generateMetadata` function\n\nDynamic metadata depends on **dynamic information**, such as the current route parameters, external data, or `metadata` in parent segments, can be set by exporting a `generateMetadata` function that returns a [`Metadata` object](#metadata-fields).\n\nResolving `generateMetadata` is part of rendering the page. If the page can be pre-rendered and `generateMetadata` doesn't introduce dynamic behavior, the resulting metadata is included in the page’s initial HTML.\n\nOtherwise the metadata resolved from `generateMetadata` [can be streamed](/docs/app/api-reference/functions/generate-metadata#streaming-metadata) after sending the initial UI.\n\n```tsx filename=\"app/products/[id]/page.tsx\" switcher\nimport type { Metadata, ResolvingMetadata } from 'next'\n\ntype Props = {\n  params: Promise<{ id: string }>\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}\n\nexport async function generateMetadata(\n  { params, searchParams }: Props,\n  parent: ResolvingMetadata\n): Promise<Metadata> {\n  // read route params\n  const { id } = await params\n\n  // fetch data\n  const product = await fetch(`https://.../${id}`).then((res) => res.json())"
  },
  {
    "id": "generate-metadata.mdx#2",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "// fetch data\n  const product = await fetch(`https://.../${id}`).then((res) => res.json())\n\n  // optionally access and extend (rather than replace) parent metadata\n  const previousImages = (await parent).openGraph?.images || []\n\n  return {\n    title: product.title,\n    openGraph: {\n      images: ['/some-specific-page-image.jpg', ...previousImages],\n    },\n  }\n}\n\nexport default function Page({ params, searchParams }: Props) {}"
  },
  {
    "id": "generate-metadata.mdx#3",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n```jsx filename=\"app/products/[id]/page.js\" switcher\nexport async function generateMetadata({ params, searchParams }, parent) {\n  // read route params\n  const { id } = await params\n\n  // fetch data\n  const product = await fetch(`https://.../${id}`).then((res) => res.json())\n\n  // optionally access and extend (rather than replace) parent metadata\n  const previousImages = (await parent).openGraph?.images || []\n\n  return {\n    title: product.title,\n    openGraph: {\n      images: ['/some-specific-page-image.jpg', ...previousImages],\n    },\n  }\n}\n\nexport default function Page({ params, searchParams }) {}"
  },
  {
    "id": "generate-metadata.mdx#4",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\nFor type completion of `params` and `searchParams`, you can type the first argument with [`PageProps<'/route'>`](/docs/app/api-reference/file-conventions/page#page-props-helper) or [`LayoutProps<'/route'>`](/docs/app/api-reference/file-conventions/layout#layout-props-helper) for pages and layouts respectively."
  },
  {
    "id": "generate-metadata.mdx#5",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "> **Good to know**:\n>\n> - Metadata can be added to `layout.js` and `page.js` files.\n> - Next.js will automatically resolve the metadata, and create the relevant `<head>` tags for the page.\n> - The `metadata` object and `generateMetadata` function exports are **only supported in Server Components**.\n> - You cannot export both the `metadata` object and `generateMetadata` function from the same route segment.\n> - `fetch` requests inside `generateMetadata` are automatically [memoized](/docs/app/guides/caching#request-memoization) for the same data across `generateMetadata`, `generateStaticParams`, Layouts, Pages, and Server Components.\n> - React [`cache` can be used](/docs/app/guides/caching#react-cache-function) if `fetch` is unavailable.\n> - [File-based metadata](/docs/app/api-reference/file-conventions/metadata) has the higher priority and will override the `metadata` object and `generateMetadata` function."
  },
  {
    "id": "generate-metadata.mdx#6",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "## Reference"
  },
  {
    "id": "generate-metadata.mdx#7",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### Parameters\n\n`generateMetadata` function accepts the following parameters:\n\n- `props` - An object containing the parameters of the current route:\n  - `params` - An object containing the [dynamic route parameters](/docs/app/api-reference/file-conventions/dynamic-routes) object from the root segment down to the segment `generateMetadata` is called from. Examples:\n\n    | Route                           | URL         | `params`                  |\n    | ------------------------------- | ----------- | ------------------------- |\n    | `app/shop/[slug]/page.js`       | `/shop/1`   | `{ slug: '1' }`           |\n    | `app/shop/[tag]/[item]/page.js` | `/shop/1/2` | `{ tag: '1', item: '2' }` |\n    | `app/shop/[...slug]/page.js`    | `/shop/1/2` | `{ slug: ['1', '2'] }`    |\n\n  - `searchParams` - An object containing the current URL's [search params](https://developer.mozilla.org/docs/Learn/Common_questions/What_is_a_URL#parameters). Examples:\n\n    | URL             | `searchParams`       |\n    | --------------- | -------------------- |\n    | `/shop?a=1`     | `{ a: '1' }`         |\n    | `/shop?a=1&b=2` | `{ a: '1', b: '2' }` |\n    | `/shop?a=1&a=2` | `{ a: ['1', '2'] }`  |"
  },
  {
    "id": "generate-metadata.mdx#8",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "- `parent` - A promise of the resolved metadata from parent route segments."
  },
  {
    "id": "generate-metadata.mdx#9",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### Returns\n\n`generateMetadata` should return a [`Metadata` object](#metadata-fields) containing one or more metadata fields.\n\n> **Good to know**:\n>\n> - If metadata doesn't depend on runtime information, it should be defined using the static [`metadata` object](#the-metadata-object) rather than `generateMetadata`.\n> - `fetch` requests are automatically [memoized](/docs/app/guides/caching#request-memoization) for the same data across `generateMetadata`, `generateStaticParams`, Layouts, Pages, and Server Components. React [`cache` can be used](/docs/app/guides/caching#react-cache-function) if `fetch` is unavailable.\n> - `searchParams` are only available in `page.js` segments.\n> - The [`redirect()`](/docs/app/api-reference/functions/redirect) and [`notFound()`](/docs/app/api-reference/functions/not-found) Next.js methods can also be used inside `generateMetadata`."
  },
  {
    "id": "generate-metadata.mdx#10",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### Metadata Fields\n\nThe following fields are supported:"
  },
  {
    "id": "generate-metadata.mdx#11",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "#### `title`\n\nThe `title` attribute is used to set the title of the document. It can be defined as a simple [string](#string) or an optional [template object](#template).\n\n##### String\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  title: 'Next.js',\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<title>Next.js</title>\n```\n\n##### `default`\n\n`title.default` can be used to provide a **fallback title** to child route segments that don't define a `title`.\n\n```tsx filename=\"app/layout.tsx\"\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: {\n    default: 'Acme',\n  },\n}\n```\n\n```tsx filename=\"app/about/page.tsx\"\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {}\n\n// Output: <title>Acme</title>\n```"
  },
  {
    "id": "generate-metadata.mdx#12",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "##### `template`\n\n`title.template` can be used to add a prefix or a suffix to `titles` defined in **child** route segments.\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: {\n    template: '%s | Acme',\n    default: 'Acme', // a default is required when creating a template\n  },\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport const metadata = {\n  title: {\n    template: '%s | Acme',\n    default: 'Acme', // a default is required when creating a template\n  },\n}\n```\n\n```tsx filename=\"app/about/page.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: 'About',\n}\n\n// Output: <title>About | Acme</title>\n```\n\n```jsx filename=\"app/about/page.js\" switcher\nexport const metadata = {\n  title: 'About',\n}\n\n// Output: <title>About | Acme</title>"
  },
  {
    "id": "generate-metadata.mdx#13",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n```jsx filename=\"app/about/page.js\" switcher\nexport const metadata = {\n  title: 'About',\n}\n\n// Output: <title>About | Acme</title>\n```\n\n> **Good to know**:\n>\n> - `title.template` applies to **child** route segments and **not** the segment it's defined in. This means:\n>   - `title.default` is **required** when you add a `title.template`.\n>   - `title.template` defined in `layout.js` will not apply to a `title` defined in a `page.js` of the same route segment.\n>   - `title.template` defined in `page.js` has no effect because a page is always the terminating segment (it doesn't have any children route segments).\n> - `title.template` has **no effect** if a route has not defined a `title` or `title.default`."
  },
  {
    "id": "generate-metadata.mdx#14",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "##### `absolute`\n\n`title.absolute` can be used to provide a title that **ignores** `title.template` set in parent segments.\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: {\n    template: '%s | Acme',\n  },\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport const metadata = {\n  title: {\n    template: '%s | Acme',\n  },\n}\n```\n\n```tsx filename=\"app/about/page.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: {\n    absolute: 'About',\n  },\n}\n\n// Output: <title>About</title>\n```\n\n```jsx filename=\"app/about/page.js\" switcher\nexport const metadata = {\n  title: {\n    absolute: 'About',\n  },\n}\n\n// Output: <title>About</title>"
  },
  {
    "id": "generate-metadata.mdx#15",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n```jsx filename=\"app/about/page.js\" switcher\nexport const metadata = {\n  title: {\n    absolute: 'About',\n  },\n}\n\n// Output: <title>About</title>\n```\n\n> **Good to know**:\n>\n> - `layout.js`\n>   - `title` (string) and `title.default` define the default title for child segments (that do not define their own `title`). It will augment `title.template` from the closest parent segment if it exists.\n>   - `title.absolute` defines the default title for child segments. It ignores `title.template` from parent segments.\n>   - `title.template` defines a new title template for child segments.\n> - `page.js`\n>   - If a page does not define its own title the closest parents resolved title will be used.\n>   - `title` (string) defines the routes title. It will augment `title.template` from the closest parent segment if it exists.\n>   - `title.absolute` defines the route title. It ignores `title.template` from parent segments.\n>   - `title.template` has no effect in `page.js` because a page is always the terminating segment of a route."
  },
  {
    "id": "generate-metadata.mdx#16",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `description`\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  description: 'The React Framework for the Web',\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"description\" content=\"The React Framework for the Web\" />\n```"
  },
  {
    "id": "generate-metadata.mdx#17",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### Other fields\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  generator: 'Next.js',\n  applicationName: 'Next.js',\n  referrer: 'origin-when-cross-origin',\n  keywords: ['Next.js', 'React', 'JavaScript'],\n  authors: [{ name: 'Seb' }, { name: 'Josh', url: 'https://nextjs.org' }],\n  creator: 'Jiachi Liu',\n  publisher: 'Sebastian Markbåge',\n  formatDetection: {\n    email: false,\n    address: false,\n    telephone: false,\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"application-name\" content=\"Next.js\" />\n<meta name=\"author\" content=\"Seb\" />\n<link rel=\"author\" href=\"https://nextjs.org\" />\n<meta name=\"author\" content=\"Josh\" />\n<meta name=\"generator\" content=\"Next.js\" />\n<meta name=\"keywords\" content=\"Next.js,React,JavaScript\" />\n<meta name=\"referrer\" content=\"origin-when-cross-origin\" />\n<meta name=\"color-scheme\" content=\"dark\" />\n<meta name=\"creator\" content=\"Jiachi Liu\" />\n<meta name=\"publisher\" content=\"Sebastian Markbåge\" />\n<meta name=\"format-detection\" content=\"telephone=no, address=no, email=no\" />\n```"
  },
  {
    "id": "generate-metadata.mdx#18",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "#### `metadataBase`\n\n`metadataBase` is a convenience option to set a base URL prefix for `metadata` fields that require a fully qualified URL.\n\n- `metadataBase` allows URL-based `metadata` fields defined in the **current route segment and below** to use a **relative path** instead of an otherwise required absolute URL.\n- The field's relative path will be composed with `metadataBase` to form a fully qualified URL.\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  metadataBase: new URL('https://acme.com'),\n  alternates: {\n    canonical: '/',\n    languages: {\n      'en-US': '/en-US',\n      'de-DE': '/de-DE',\n    },\n  },\n  openGraph: {\n    images: '/og-image.png',\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<link rel=\"canonical\" href=\"https://acme.com\" />\n<link rel=\"alternate\" hreflang=\"en-US\" href=\"https://acme.com/en-US\" />\n<link rel=\"alternate\" hreflang=\"de-DE\" href=\"https://acme.com/de-DE\" />\n<meta property=\"og:image\" content=\"https://acme.com/og-image.png\" />"
  },
  {
    "id": "generate-metadata.mdx#19",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n> **Good to know**:\n>\n> - `metadataBase` is typically set in root `app/layout.js` to apply to URL-based `metadata` fields across all routes.\n> - All URL-based `metadata` fields that require absolute URLs can be configured with a `metadataBase` option.\n> - `metadataBase` can contain a subdomain e.g. `https://app.acme.com` or base path e.g. `https://acme.com/start/from/here`\n> - If a `metadata` field provides an absolute URL, `metadataBase` will be ignored.\n> - Using a relative path in a URL-based `metadata` field without configuring a `metadataBase` will cause a build error.\n> - Next.js will normalize duplicate slashes between `metadataBase` (e.g. `https://acme.com/`) and a relative field (e.g. `/path`) to a single slash (e.g. `https://acme.com/path`)"
  },
  {
    "id": "generate-metadata.mdx#20",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "#### URL Composition\n\nURL composition favors developer intent over default directory traversal semantics.\n\n- Trailing slashes between `metadataBase` and `metadata` fields are normalized.\n- An \"absolute\" path in a `metadata` field (that typically would replace the whole URL path) is treated as a \"relative\" path (starting from the end of `metadataBase`).\n\nFor example, given the following `metadataBase`:\n\n```tsx filename=\"app/layout.tsx\" switcher\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  metadataBase: new URL('https://acme.com'),\n}\n```\n\n```jsx filename=\"app/layout.js\" switcher\nexport const metadata = {\n  metadataBase: new URL('https://acme.com'),\n}"
  },
  {
    "id": "generate-metadata.mdx#21",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n```jsx filename=\"app/layout.js\" switcher\nexport const metadata = {\n  metadataBase: new URL('https://acme.com'),\n}\n```\n\nAny `metadata` fields that inherit the above `metadataBase` and set their own value will be resolved as follows:\n\n| `metadata` field                 | Resolved URL                     |\n| -------------------------------- | -------------------------------- |\n| `/`                              | `https://acme.com`               |\n| `./`                             | `https://acme.com`               |\n| `payments`                       | `https://acme.com/payments`      |\n| `/payments`                      | `https://acme.com/payments`      |\n| `./payments`                     | `https://acme.com/payments`      |\n| `../payments`                    | `https://acme.com/payments`      |\n| `https://beta.acme.com/payments` | `https://beta.acme.com/payments` |"
  },
  {
    "id": "generate-metadata.mdx#22",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `openGraph`\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  openGraph: {\n    title: 'Next.js',\n    description: 'The React Framework for the Web',\n    url: 'https://nextjs.org',\n    siteName: 'Next.js',\n    images: [\n      {\n        url: 'https://nextjs.org/og.png', // Must be an absolute URL\n        width: 800,\n        height: 600,\n      },\n      {\n        url: 'https://nextjs.org/og-alt.png', // Must be an absolute URL\n        width: 1800,\n        height: 1600,\n        alt: 'My custom alt',\n      },\n    ],\n    videos: [\n      {\n        url: 'https://nextjs.org/video.mp4', // Must be an absolute URL\n        width: 800,\n        height: 600,\n      },\n    ],\n    audio: [\n      {\n        url: 'https://nextjs.org/audio.mp3', // Must be an absolute URL\n      },\n    ],\n    locale: 'en_US',\n    type: 'website',\n  },\n}"
  },
  {
    "id": "generate-metadata.mdx#23",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta property=\"og:title\" content=\"Next.js\" />\n<meta property=\"og:description\" content=\"The React Framework for the Web\" />\n<meta property=\"og:url\" content=\"https://nextjs.org/\" />\n<meta property=\"og:site_name\" content=\"Next.js\" />\n<meta property=\"og:locale\" content=\"en_US\" />\n<meta property=\"og:image\" content=\"https://nextjs.org/og.png\" />\n<meta property=\"og:image:width\" content=\"800\" />\n<meta property=\"og:image:height\" content=\"600\" />\n<meta property=\"og:image\" content=\"https://nextjs.org/og-alt.png\" />\n<meta property=\"og:image:width\" content=\"1800\" />\n<meta property=\"og:image:height\" content=\"1600\" />\n<meta property=\"og:image:alt\" content=\"My custom alt\" />\n<meta property=\"og:video\" content=\"https://nextjs.org/video.mp4\" />\n<meta property=\"og:video:width\" content=\"800\" />\n<meta property=\"og:video:height\" content=\"600\" />\n<meta property=\"og:audio\" content=\"https://nextjs.org/audio.mp3\" />\n<meta property=\"og:type\" content=\"website\" />"
  },
  {
    "id": "generate-metadata.mdx#24",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  openGraph: {\n    title: 'Next.js',\n    description: 'The React Framework for the Web',\n    type: 'article',\n    publishedTime: '2023-01-01T00:00:00.000Z',\n    authors: ['Seb', 'Josh'],\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta property=\"og:title\" content=\"Next.js\" />\n<meta property=\"og:description\" content=\"The React Framework for the Web\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"article:published_time\" content=\"2023-01-01T00:00:00.000Z\" />\n<meta property=\"article:author\" content=\"Seb\" />\n<meta property=\"article:author\" content=\"Josh\" />\n```\n\n> **Good to know**:\n>\n> - It may be more convenient to use the [file-based Metadata API](/docs/app/api-reference/file-conventions/metadata/opengraph-image#image-files-jpg-png-gif) for Open Graph images. Rather than having to sync the config export with actual files, the file-based API will automatically generate the correct metadata for you."
  },
  {
    "id": "generate-metadata.mdx#25",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `robots`\n\n```tsx filename=\"layout.tsx | page.tsx\"\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  robots: {\n    index: true,\n    follow: true,\n    nocache: false,\n    googleBot: {\n      index: true,\n      follow: true,\n      noimageindex: false,\n      'max-video-preview': -1,\n      'max-image-preview': 'large',\n      'max-snippet': -1,\n    },\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"robots\" content=\"index, follow\" />\n<meta\n  name=\"googlebot\"\n  content=\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"\n/>\n```"
  },
  {
    "id": "generate-metadata.mdx#26",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `icons`\n\n> **Good to know**: We recommend using the [file-based Metadata API](/docs/app/api-reference/file-conventions/metadata/app-icons#image-files-ico-jpg-png) for icons where possible. Rather than having to sync the config export with actual files, the file-based API will automatically generate the correct metadata for you.\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  icons: {\n    icon: '/icon.png',\n    shortcut: '/shortcut-icon.png',\n    apple: '/apple-icon.png',\n    other: {\n      rel: 'apple-touch-icon-precomposed',\n      url: '/apple-touch-icon-precomposed.png',\n    },\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<link rel=\"shortcut icon\" href=\"/shortcut-icon.png\" />\n<link rel=\"icon\" href=\"/icon.png\" />\n<link rel=\"apple-touch-icon\" href=\"/apple-icon.png\" />\n<link\n  rel=\"apple-touch-icon-precomposed\"\n  href=\"/apple-touch-icon-precomposed.png\"\n/>"
  },
  {
    "id": "generate-metadata.mdx#27",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  icons: {\n    icon: [\n      { url: '/icon.png' },\n      new URL('/icon.png', 'https://example.com'),\n      { url: '/icon-dark.png', media: '(prefers-color-scheme: dark)' },\n    ],\n    shortcut: ['/shortcut-icon.png'],\n    apple: [\n      { url: '/apple-icon.png' },\n      { url: '/apple-icon-x3.png', sizes: '180x180', type: 'image/png' },\n    ],\n    other: [\n      {\n        rel: 'apple-touch-icon-precomposed',\n        url: '/apple-touch-icon-precomposed.png',\n      },\n    ],\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<link rel=\"shortcut icon\" href=\"/shortcut-icon.png\" />\n<link rel=\"icon\" href=\"/icon.png\" />\n<link rel=\"icon\" href=\"https://example.com/icon.png\" />\n<link rel=\"icon\" href=\"/icon-dark.png\" media=\"(prefers-color-scheme: dark)\" />\n<link rel=\"apple-touch-icon\" href=\"/apple-icon.png\" />\n<link\n  rel=\"apple-touch-icon-precomposed\"\n  href=\"/apple-touch-icon-precomposed.png\"\n/>\n<link\n  rel=\"apple-touch-icon\"\n  href=\"/apple-icon-x3.png\"\n  sizes=\"180x180\"\n  type=\"image/png\"\n/>"
  },
  {
    "id": "generate-metadata.mdx#28",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n> **Good to know**: The `msapplication-*` meta tags are no longer supported in Chromium builds of Microsoft Edge, and thus no longer needed."
  },
  {
    "id": "generate-metadata.mdx#29",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `themeColor`\n\n> **Deprecated**: The `themeColor` option in `metadata` is deprecated as of Next.js 14. Please use the [`viewport` configuration](/docs/app/api-reference/functions/generate-viewport) instead.\n\n### `colorScheme`\n\n> **Deprecated**: The `colorScheme` option in `metadata` is deprecated as of Next.js 14. Please use the [`viewport` configuration](/docs/app/api-reference/functions/generate-viewport) instead.\n\n### `manifest`\n\nA web application manifest, as defined in the [Web Application Manifest specification](https://developer.mozilla.org/docs/Web/Manifest).\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  manifest: 'https://nextjs.org/manifest.json',\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<link rel=\"manifest\" href=\"https://nextjs.org/manifest.json\" />\n```"
  },
  {
    "id": "generate-metadata.mdx#30",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `twitter`\n\nThe Twitter specification is (surprisingly) used for more than just X (formerly known as Twitter).\n\nLearn more about the [Twitter Card markup reference](https://developer.x.com/en/docs/twitter-for-websites/cards/overview/markup).\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  twitter: {\n    card: 'summary_large_image',\n    title: 'Next.js',\n    description: 'The React Framework for the Web',\n    siteId: '1467726470533754880',\n    creator: '@nextjs',\n    creatorId: '1467726470533754880',\n    images: ['https://nextjs.org/og.png'], // Must be an absolute URL\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"twitter:card\" content=\"summary_large_image\" />\n<meta name=\"twitter:site:id\" content=\"1467726470533754880\" />\n<meta name=\"twitter:creator\" content=\"@nextjs\" />\n<meta name=\"twitter:creator:id\" content=\"1467726470533754880\" />\n<meta name=\"twitter:title\" content=\"Next.js\" />\n<meta name=\"twitter:description\" content=\"The React Framework for the Web\" />\n<meta name=\"twitter:image\" content=\"https://nextjs.org/og.png\" />"
  },
  {
    "id": "generate-metadata.mdx#31",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  twitter: {\n    card: 'app',\n    title: 'Next.js',\n    description: 'The React Framework for the Web',\n    siteId: '1467726470533754880',\n    creator: '@nextjs',\n    creatorId: '1467726470533754880',\n    images: {\n      url: 'https://nextjs.org/og.png',\n      alt: 'Next.js Logo',\n    },\n    app: {\n      name: 'twitter_app',\n      id: {\n        iphone: 'twitter_app://iphone',\n        ipad: 'twitter_app://ipad',\n        googleplay: 'twitter_app://googleplay',\n      },\n      url: {\n        iphone: 'https://iphone_url',\n        ipad: 'https://ipad_url',\n      },\n    },\n  },\n}"
  },
  {
    "id": "generate-metadata.mdx#32",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"twitter:site:id\" content=\"1467726470533754880\" />\n<meta name=\"twitter:creator\" content=\"@nextjs\" />\n<meta name=\"twitter:creator:id\" content=\"1467726470533754880\" />\n<meta name=\"twitter:title\" content=\"Next.js\" />\n<meta name=\"twitter:description\" content=\"The React Framework for the Web\" />\n<meta name=\"twitter:card\" content=\"app\" />\n<meta name=\"twitter:image\" content=\"https://nextjs.org/og.png\" />\n<meta name=\"twitter:image:alt\" content=\"Next.js Logo\" />\n<meta name=\"twitter:app:name:iphone\" content=\"twitter_app\" />\n<meta name=\"twitter:app:id:iphone\" content=\"twitter_app://iphone\" />\n<meta name=\"twitter:app:id:ipad\" content=\"twitter_app://ipad\" />\n<meta name=\"twitter:app:id:googleplay\" content=\"twitter_app://googleplay\" />\n<meta name=\"twitter:app:url:iphone\" content=\"https://iphone_url\" />\n<meta name=\"twitter:app:url:ipad\" content=\"https://ipad_url\" />\n<meta name=\"twitter:app:name:ipad\" content=\"twitter_app\" />\n<meta name=\"twitter:app:name:googleplay\" content=\"twitter_app\" />\n```"
  },
  {
    "id": "generate-metadata.mdx#33",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `viewport`\n\n> **Deprecated**: The `viewport` option in `metadata` is deprecated as of Next.js 14. Please use the [`viewport` configuration](/docs/app/api-reference/functions/generate-viewport) instead.\n\n### `verification`\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  verification: {\n    google: 'google',\n    yandex: 'yandex',\n    yahoo: 'yahoo',\n    other: {\n      me: ['my-email', 'my-link'],\n    },\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"google-site-verification\" content=\"google\" />\n<meta name=\"y_key\" content=\"yahoo\" />\n<meta name=\"yandex-verification\" content=\"yandex\" />\n<meta name=\"me\" content=\"my-email\" />\n<meta name=\"me\" content=\"my-link\" />\n```"
  },
  {
    "id": "generate-metadata.mdx#34",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `appleWebApp`\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  itunes: {\n    appId: 'myAppStoreID',\n    appArgument: 'myAppArgument',\n  },\n  appleWebApp: {\n    title: 'Apple Web App',\n    statusBarStyle: 'black-translucent',\n    startupImage: [\n      '/assets/startup/apple-touch-startup-image-768x1004.png',\n      {\n        url: '/assets/startup/apple-touch-startup-image-1536x2008.png',\n        media: '(device-width: 768px) and (device-height: 1024px)',\n      },\n    ],\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta\n  name=\"apple-itunes-app\"\n  content=\"app-id=myAppStoreID, app-argument=myAppArgument\"\n/>\n<meta name=\"mobile-web-app-capable\" content=\"yes\" />\n<meta name=\"apple-mobile-web-app-title\" content=\"Apple Web App\" />\n<link\n  href=\"/assets/startup/apple-touch-startup-image-768x1004.png\"\n  rel=\"apple-touch-startup-image\"\n/>\n<link\n  href=\"/assets/startup/apple-touch-startup-image-1536x2008.png\"\n  media=\"(device-width: 768px) and (device-height: 1024px)\"\n  rel=\"apple-touch-startup-image\"\n/>\n<meta\n  name=\"apple-mobile-web-app-status-bar-style\"\n  content=\"black-translucent\"\n/>\n```"
  },
  {
    "id": "generate-metadata.mdx#35",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `alternates`\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  alternates: {\n    canonical: 'https://nextjs.org',\n    languages: {\n      'en-US': 'https://nextjs.org/en-US',\n      'de-DE': 'https://nextjs.org/de-DE',\n    },\n    media: {\n      'only screen and (max-width: 600px)': 'https://nextjs.org/mobile',\n    },\n    types: {\n      'application/rss+xml': 'https://nextjs.org/rss',\n    },\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<link rel=\"canonical\" href=\"https://nextjs.org\" />\n<link rel=\"alternate\" hreflang=\"en-US\" href=\"https://nextjs.org/en-US\" />\n<link rel=\"alternate\" hreflang=\"de-DE\" href=\"https://nextjs.org/de-DE\" />\n<link\n  rel=\"alternate\"\n  media=\"only screen and (max-width: 600px)\"\n  href=\"https://nextjs.org/mobile\"\n/>\n<link\n  rel=\"alternate\"\n  type=\"application/rss+xml\"\n  href=\"https://nextjs.org/rss\"\n/>\n```"
  },
  {
    "id": "generate-metadata.mdx#36",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `appLinks`\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  appLinks: {\n    ios: {\n      url: 'https://nextjs.org/ios',\n      app_store_id: 'app_store_id',\n    },\n    android: {\n      package: 'com.example.android/package',\n      app_name: 'app_name_android',\n    },\n    web: {\n      url: 'https://nextjs.org/web',\n      should_fallback: true,\n    },\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta property=\"al:ios:url\" content=\"https://nextjs.org/ios\" />\n<meta property=\"al:ios:app_store_id\" content=\"app_store_id\" />\n<meta property=\"al:android:package\" content=\"com.example.android/package\" />\n<meta property=\"al:android:app_name\" content=\"app_name_android\" />\n<meta property=\"al:web:url\" content=\"https://nextjs.org/web\" />\n<meta property=\"al:web:should_fallback\" content=\"true\" />\n```"
  },
  {
    "id": "generate-metadata.mdx#37",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `archives`\n\nDescribes a collection of records, documents, or other materials of historical interest ([source](https://www.w3.org/TR/2011/WD-html5-20110113/links.html#rel-archives)).\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  archives: ['https://nextjs.org/13'],\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<link rel=\"archives\" href=\"https://nextjs.org/13\" />\n```\n\n### `assets`\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  assets: ['https://nextjs.org/assets'],\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<link rel=\"assets\" href=\"https://nextjs.org/assets\" />\n```\n\n### `bookmarks`\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  bookmarks: ['https://nextjs.org/13'],\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<link rel=\"bookmarks\" href=\"https://nextjs.org/13\" />\n```\n\n### `category`\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  category: 'technology',\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"category\" content=\"technology\" />\n```"
  },
  {
    "id": "generate-metadata.mdx#38",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `facebook`\n\nYou can connect a Facebook app or Facebook account to your webpage for certain Facebook Social Plugins [Facebook Documentation](https://developers.facebook.com/docs/plugins/comments/#moderation-setup-instructions)\n\n> **Good to know**: You can specify either appId or admins, but not both.\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  facebook: {\n    appId: '12345678',\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta property=\"fb:app_id\" content=\"12345678\" />\n```\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  facebook: {\n    admins: '12345678',\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta property=\"fb:admins\" content=\"12345678\" />\n```\n\nIf you want to generate multiple fb:admins meta tags you can use array value.\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  facebook: {\n    admins: ['12345678', '87654321'],\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta property=\"fb:admins\" content=\"12345678\" />\n<meta property=\"fb:admins\" content=\"87654321\" />\n```"
  },
  {
    "id": "generate-metadata.mdx#39",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### `pinterest`\n\nYou can enable or disable [Pinterest Rich Pins](https://developers.pinterest.com/docs/web-features/rich-pins-overview/) on your webpage.\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  pinterest: {\n    richPin: true,\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"pinterest-rich-pin\" content=\"true\" />\n```\n\n### `other`\n\nAll metadata options should be covered using the built-in support. However, there may be custom metadata tags specific to your site, or brand new metadata tags just released. You can use the `other` option to render any custom metadata tag.\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  other: {\n    custom: 'meta',\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"custom\" content=\"meta\" />\n```\n\nIf you want to generate multiple same key meta tags you can use array value.\n\n```jsx filename=\"layout.js | page.js\"\nexport const metadata = {\n  other: {\n    custom: ['meta1', 'meta2'],\n  },\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"custom\" content=\"meta1\" /> <meta name=\"custom\" content=\"meta2\" />\n```"
  },
  {
    "id": "generate-metadata.mdx#40",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### Types\n\nYou can add type safety to your metadata by using the `Metadata` type. If you are using the [built-in TypeScript plugin](/docs/app/api-reference/config/typescript) in your IDE, you do not need to manually add the type, but you can still explicitly add it if you want.\n\n#### `metadata` object\n\n```tsx filename=\"layout.tsx | page.tsx\"\nimport type { Metadata } from 'next'\n\nexport const metadata: Metadata = {\n  title: 'Next.js',\n}\n```"
  },
  {
    "id": "generate-metadata.mdx#41",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "#### `generateMetadata` function\n\n##### Regular function\n\n```tsx filename=\"layout.tsx | page.tsx\"\nimport type { Metadata } from 'next'\n\nexport function generateMetadata(): Metadata {\n  return {\n    title: 'Next.js',\n  }\n}\n```\n\n##### Async function\n\n```tsx filename=\"layout.tsx | page.tsx\"\nimport type { Metadata } from 'next'\n\nexport async function generateMetadata(): Promise<Metadata> {\n  return {\n    title: 'Next.js',\n  }\n}\n```\n\n##### With segment props\n\n```tsx filename=\"layout.tsx | page.tsx\"\nimport type { Metadata } from 'next'\n\ntype Props = {\n  params: Promise<{ id: string }>\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}\n\nexport function generateMetadata({ params, searchParams }: Props): Metadata {\n  return {\n    title: 'Next.js',\n  }\n}\n\nexport default function Page({ params, searchParams }: Props) {}\n```\n\n##### With parent metadata\n\n```tsx filename=\"layout.tsx | page.tsx\"\nimport type { Metadata, ResolvingMetadata } from 'next'\n\nexport async function generateMetadata(\n  { params, searchParams }: Props,\n  parent: ResolvingMetadata\n): Promise<Metadata> {\n  return {\n    title: 'Next.js',\n  }\n}\n```"
  },
  {
    "id": "generate-metadata.mdx#42",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "##### JavaScript Projects\n\nFor JavaScript projects, you can use JSDoc to add type safety.\n\n```js filename=\"layout.js | page.js\"\n/** @type {import(\"next\").Metadata} */\nexport const metadata = {\n  title: 'Next.js',\n}\n```"
  },
  {
    "id": "generate-metadata.mdx#43",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### Unsupported Metadata\n\nThe following metadata types do not currently have built-in support. However, they can still be rendered in the layout or page itself."
  },
  {
    "id": "generate-metadata.mdx#44",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "| Metadata                      | Recommendation                                                                                                                                                                                                                               |\n| ----------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `<meta http-equiv=\"...\">`     | Use appropriate HTTP Headers via [`redirect()`](/docs/app/api-reference/functions/redirect), [Proxy](/docs/app/api-reference/file-conventions/proxy#nextresponse), [Security Headers](/docs/app/api-reference/config/next-config-js/headers) |\n| `<base>`                      | Render the tag in the layout or page itself.                                                                                                                                                                                                 |"
  },
  {
    "id": "generate-metadata.mdx#45",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "| `<noscript>`                  | Render the tag in the layout or page itself.                                                                                                                                                                                                 |\n| `<style>`                     | Learn more about [styling in Next.js](/docs/app/getting-started/css).                                                                                                                                                                        |\n| `<script>`                    | Learn more about [using scripts](/docs/app/guides/scripts).                                                                                                                                                                                  |\n| `<link rel=\"stylesheet\" />`   | `import` stylesheets directly in the layout or page itself.                                                                                                                                                                                  |"
  },
  {
    "id": "generate-metadata.mdx#46",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "| `<link rel=\"preload />`       | Use [ReactDOM preload method](#link-relpreload)                                                                                                                                                                                              |\n| `<link rel=\"preconnect\" />`   | Use [ReactDOM preconnect method](#link-relpreconnect)                                                                                                                                                                                        |\n| `<link rel=\"dns-prefetch\" />` | Use [ReactDOM prefetchDNS method](#link-reldns-prefetch)                                                                                                                                                                                     |"
  },
  {
    "id": "generate-metadata.mdx#47",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### Resource hints\n\nThe `<link>` element has a number of `rel` keywords that can be used to hint to the browser that an external resource is likely to be needed. The browser uses this information to apply preloading optimizations depending on the keyword.\n\nWhile the Metadata API doesn't directly support these hints, you can use new [`ReactDOM` methods](https://github.com/facebook/react/pull/26237) to safely insert them into the `<head>` of the document.\n\n```tsx filename=\"app/preload-resources.tsx\" switcher\n'use client'\n\nimport ReactDOM from 'react-dom'\n\nexport function PreloadResources() {\n  ReactDOM.preload('...', { as: '...' })\n  ReactDOM.preconnect('...', { crossOrigin: '...' })\n  ReactDOM.prefetchDNS('...')\n\n  return '...'\n}\n```\n\n```jsx filename=\"app/preload-resources.js\" switcher\n'use client'\n\nimport ReactDOM from 'react-dom'\n\nexport function PreloadResources() {\n  ReactDOM.preload('...', { as: '...' })\n  ReactDOM.preconnect('...', { crossOrigin: '...' })\n  ReactDOM.prefetchDNS('...')\n\n  return '...'\n}\n```"
  },
  {
    "id": "generate-metadata.mdx#48",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "#### `<link rel=\"preload\">`\n\nStart loading a resource early in the page rendering (browser) lifecycle. [MDN Docs](https://developer.mozilla.org/docs/Web/HTML/Attributes/rel/preload).\n\n```tsx\nReactDOM.preload(href: string, options: { as: string })\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<link rel=\"preload\" href=\"...\" as=\"...\" />\n```\n\n##### `<link rel=\"preconnect\">`\n\nPreemptively initiate a connection to an origin. [MDN Docs](https://developer.mozilla.org/docs/Web/HTML/Attributes/rel/preconnect).\n\n```tsx\nReactDOM.preconnect(href: string, options?: { crossOrigin?: string })\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<link rel=\"preconnect\" href=\"...\" crossorigin />\n```"
  },
  {
    "id": "generate-metadata.mdx#49",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "#### `<link rel=\"dns-prefetch\">`\n\nAttempt to resolve a domain name before resources get requested. [MDN Docs](https://developer.mozilla.org/docs/Web/HTML/Attributes/rel/dns-prefetch).\n\n```tsx\nReactDOM.prefetchDNS(href: string)\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<link rel=\"dns-prefetch\" href=\"...\" />\n```\n\n> **Good to know**:\n>\n> - These methods are currently only supported in Client Components, which are still Server Side Rendered on initial page load.\n> - Next.js in-built features such as `next/font`, `next/image` and `next/script` automatically handle relevant resource hints."
  },
  {
    "id": "generate-metadata.mdx#50",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "## Behavior\n\n### Default Fields\n\nThere are two default `meta` tags that are always added even if a route doesn't define metadata:\n\n- The [meta charset tag](https://developer.mozilla.org/docs/Web/HTML/Element/meta#attr-charset) sets the character encoding for the website.\n- The [meta viewport tag](https://developer.mozilla.org/docs/Web/HTML/Viewport_meta_tag) sets the viewport width and scale for the website to adjust for different devices.\n\n```html\n<meta charset=\"utf-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n```\n\n> **Good to know**: You can overwrite the default [`viewport`](/docs/app/api-reference/functions/generate-metadata#viewport) meta tag."
  },
  {
    "id": "generate-metadata.mdx#51",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### Streaming metadata\n\nStreaming metadata allows Next.js to render and send the initial UI to the browser, without waiting for `generateMetadata` to complete.\n\nWhen `generateMetadata` resolves, the resulting metadata tags are appended to the `<body>` tag. We have verified that metadata is interpreted correctly by bots that execute JavaScript and inspect the full DOM (e.g. `Googlebot`).\n\nFor **HTML-limited bots** that can’t execute JavaScript (e.g. `facebookexternalhit`), metadata continues to block page rendering. The resulting metadata will be available in the `<head>` tag.\n\nNext.js automatically detects **HTML-limited bots** by looking at the User Agent header. You can use the [`htmlLimitedBots`](/docs/app/api-reference/config/next-config-js/htmlLimitedBots) option in your Next.js config file to override the default [User Agent list](https://github.com/vercel/next.js/blob/canary/packages/next/src/shared/lib/router/utils/html-bots.ts).\n\nTo fully disable streaming metadata:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst config: NextConfig = {\n  htmlLimitedBots: /.*/,\n}\n\nexport default config"
  },
  {
    "id": "generate-metadata.mdx#52",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  htmlLimitedBots: /.*/,\n}\n```\n\nStreaming metadata improves perceived performance by reducing [TTFB](https://developer.mozilla.org/docs/Glossary/Time_to_first_byte) and can help lowering [LCP](https://developer.mozilla.org/docs/Glossary/Largest_contentful_paint) time.\n\nOverriding `htmlLimitedBots` could lead to longer response times. Streaming metadata is an advanced feature, and the default should be sufficient for most cases."
  },
  {
    "id": "generate-metadata.mdx#53",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### Ordering\n\nMetadata is evaluated in order, starting from the root segment down to the segment closest to the final `page.js` segment. For example:\n\n1. `app/layout.tsx` (Root Layout)\n2. `app/blog/layout.tsx` (Nested Blog Layout)\n3. `app/blog/[slug]/page.tsx` (Blog Page)"
  },
  {
    "id": "generate-metadata.mdx#54",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "### Merging\n\nFollowing the [evaluation order](#ordering), Metadata objects exported from multiple segments in the same route are **shallowly** merged together to form the final metadata output of a route. Duplicate keys are **replaced** based on their ordering.\n\nThis means metadata with nested fields such as [`openGraph`](/docs/app/api-reference/functions/generate-metadata#opengraph) and [`robots`](/docs/app/api-reference/functions/generate-metadata#robots) that are defined in an earlier segment are **overwritten** by the last segment to define them."
  },
  {
    "id": "generate-metadata.mdx#55",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "#### Overwriting fields\n\n```jsx filename=\"app/layout.js\"\nexport const metadata = {\n  title: 'Acme',\n  openGraph: {\n    title: 'Acme',\n    description: 'Acme is a...',\n  },\n}\n```\n\n```jsx filename=\"app/blog/page.js\"\nexport const metadata = {\n  title: 'Blog',\n  openGraph: {\n    title: 'Blog',\n  },\n}\n\n// Output:\n// <title>Blog</title>\n// <meta property=\"og:title\" content=\"Blog\" />\n```\n\nIn the example above:\n\n- `title` from `app/layout.js` is **replaced** by `title` in `app/blog/page.js`.\n- All `openGraph` fields from `app/layout.js` are **replaced** in `app/blog/page.js` because `app/blog/page.js` sets `openGraph` metadata. Note the absence of `openGraph.description`.\n\nIf you'd like to share some nested fields between segments while overwriting others, you can pull them out into a separate variable:\n\n```jsx filename=\"app/shared-metadata.js\"\nexport const openGraphImage = { images: ['http://...'] }\n```\n\n```jsx filename=\"app/page.js\"\nimport { openGraphImage } from './shared-metadata'\n\nexport const metadata = {\n  openGraph: {\n    ...openGraphImage,\n    title: 'Home',\n  },\n}"
  },
  {
    "id": "generate-metadata.mdx#56",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "```\n\n```jsx filename=\"app/page.js\"\nimport { openGraphImage } from './shared-metadata'\n\nexport const metadata = {\n  openGraph: {\n    ...openGraphImage,\n    title: 'Home',\n  },\n}\n```\n\n```jsx filename=\"app/about/page.js\"\nimport { openGraphImage } from '../shared-metadata'\n\nexport const metadata = {\n  openGraph: {\n    ...openGraphImage,\n    title: 'About',\n  },\n}\n```\n\nIn the example above, the OG image is shared between `app/layout.js` and `app/about/page.js` while the titles are different."
  },
  {
    "id": "generate-metadata.mdx#57",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "#### Inheriting fields\n\n```jsx filename=\"app/layout.js\"\nexport const metadata = {\n  title: 'Acme',\n  openGraph: {\n    title: 'Acme',\n    description: 'Acme is a...',\n  },\n}\n```\n\n```jsx filename=\"app/about/page.js\"\nexport const metadata = {\n  title: 'About',\n}\n\n// Output:\n// <title>About</title>\n// <meta property=\"og:title\" content=\"Acme\" />\n// <meta property=\"og:description\" content=\"Acme is a...\" />\n```\n\n**Notes**\n\n- `title` from `app/layout.js` is **replaced** by `title` in `app/about/page.js`.\n- All `openGraph` fields from `app/layout.js` are **inherited** in `app/about/page.js` because `app/about/page.js` doesn't set `openGraph` metadata."
  },
  {
    "id": "generate-metadata.mdx#58",
    "metadata": {
      "title": "generateMetadata",
      "description": "Learn how to add Metadata to your Next.js application for improved search engine optimization (SEO) and web shareability."
    },
    "content": "## Version History\n\n| Version   | Changes                                                                                                                                                 |\n| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `v15.2.0` | Introduced streaming support to `generateMetadata`.                                                                                                     |\n| `v13.2.0` | `viewport`, `themeColor`, and `colorScheme` deprecated in favor of the [`viewport` configuration](/docs/app/api-reference/functions/generate-viewport). |\n| `v13.2.0` | `metadata` and `generateMetadata` introduced.                                                                                                           |"
  },
  {
    "id": "generate-sitemaps.mdx#0",
    "metadata": {
      "title": "generateSitemaps",
      "description": "Learn how to use the generateSiteMaps function to create multiple sitemaps for your application."
    },
    "content": "---\ntitle: generateSitemaps\nnav_title: generateSitemaps\ndescription: Learn how to use the generateSiteMaps function to create multiple sitemaps for your application.\nrelated:\n  title: Next Steps\n  description: Learn how to create sitemaps for your Next.js application.\n  links:\n    - app/api-reference/file-conventions/metadata/sitemap\n---\n\nYou can use the `generateSitemaps` function to generate multiple sitemaps for your application.\n\n## Returns\n\nThe `generateSitemaps` returns an array of objects with an `id` property.\n\n## URLs\n\nYour generated sitemaps will be available at `/.../sitemap/[id].xml`. For example, `/product/sitemap/1.xml`."
  },
  {
    "id": "generate-sitemaps.mdx#1",
    "metadata": {
      "title": "generateSitemaps",
      "description": "Learn how to use the generateSiteMaps function to create multiple sitemaps for your application."
    },
    "content": "## Example\n\nFor example, to split a sitemap using `generateSitemaps`, return an array of objects with the sitemap `id`. Then, use the `id` to generate the unique sitemaps.\n\n```ts filename=\"app/product/sitemap.ts\" switcher\nimport type { MetadataRoute } from 'next'\nimport { BASE_URL } from '@/app/lib/constants'\n\nexport async function generateSitemaps() {\n  // Fetch the total number of products and calculate the number of sitemaps needed\n  return [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]\n}\n\nexport default async function sitemap(props: {\n  id: Promise<number>\n}): Promise<MetadataRoute.Sitemap> {\n  const id = await props.id\n  // Google's limit is 50,000 URLs per sitemap\n  const start = id * 50000\n  const end = start + 50000\n  const products = await getProducts(\n    `SELECT id, date FROM products WHERE id BETWEEN ${start} AND ${end}`\n  )\n  return products.map((product) => ({\n    url: `${BASE_URL}/product/${product.id}`,\n    lastModified: product.date,\n  }))\n}"
  },
  {
    "id": "generate-sitemaps.mdx#2",
    "metadata": {
      "title": "generateSitemaps",
      "description": "Learn how to use the generateSiteMaps function to create multiple sitemaps for your application."
    },
    "content": "```\n\n```js filename=\"app/product/sitemap.js\" switcher\nimport { BASE_URL } from '@/app/lib/constants'\n\nexport async function generateSitemaps() {\n  // Fetch the total number of products and calculate the number of sitemaps needed\n  return [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]\n}\n\nexport default async function sitemap(props) {\n  const id = await props.id\n  // Google's limit is 50,000 URLs per sitemap\n  const start = id * 50000\n  const end = start + 50000\n  const products = await getProducts(\n    `SELECT id, date FROM products WHERE id BETWEEN ${start} AND ${end}`\n  )\n  return products.map((product) => ({\n    url: `${BASE_URL}/product/${product.id}`,\n    lastModified: product.date,\n  }))\n}\n```"
  },
  {
    "id": "generate-sitemaps.mdx#3",
    "metadata": {
      "title": "generateSitemaps",
      "description": "Learn how to use the generateSiteMaps function to create multiple sitemaps for your application."
    },
    "content": "## Version History\n\n| Version   | Changes                                                                                                                                              |\n| --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `v16.0.0` | The `id` values returned from `generateSitemaps` are now passed as a promise to the sitemap function.                                                |\n| `v15.0.0` | `generateSitemaps` now generates consistent URLs between development and production                                                                  |\n| `v13.3.2` | `generateSitemaps` introduced. In development, you can view the generated sitemap on `/.../sitemap.xml/[id]`. For example, `/product/sitemap.xml/1`. |"
  },
  {
    "id": "generate-static-params.mdx#0",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "---\ntitle: generateStaticParams\ndescription: API reference for the generateStaticParams function.\n---\n\nThe `generateStaticParams` function can be used in combination with [dynamic route segments](/docs/app/api-reference/file-conventions/dynamic-routes) to [**statically generate**](/docs/app/guides/caching#static-rendering) routes at build time instead of on-demand at request time.\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\n// Return a list of `params` to populate the [slug] dynamic segment\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  return posts.map((post) => ({\n    slug: post.slug,\n  }))\n}\n\n// Multiple versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ slug: string }>\n}) {\n  const { slug } = await params\n  // ...\n}"
  },
  {
    "id": "generate-static-params.mdx#1",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\n// Return a list of `params` to populate the [slug] dynamic segment\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  return posts.map((post) => ({\n    slug: post.slug,\n  }))\n}\n\n// Multiple versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\nexport default async function Page({ params }) {\n  const { slug } = await params\n  // ...\n}"
  },
  {
    "id": "generate-static-params.mdx#2",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "```\n\n> **Good to know**:\n>\n> - You can use the [`dynamicParams`](/docs/app/api-reference/file-conventions/route-segment-config#dynamicparams) segment config option to control what happens when a dynamic segment is visited that was not generated with `generateStaticParams`.\n> - You must return [an empty array from `generateStaticParams`](#all-paths-at-build-time) or utilize [`export const dynamic = 'force-static'`](/docs/app/api-reference/file-conventions/route-segment-config#dynamic) in order to revalidate (ISR) [paths at runtime](#all-paths-at-runtime).\n> - During `next dev`, `generateStaticParams` will be called when you navigate to a route.\n> - During `next build`, `generateStaticParams` runs before the corresponding Layouts or Pages are generated.\n> - During revalidation (ISR), `generateStaticParams` will not be called again.\n> - `generateStaticParams` replaces the [`getStaticPaths`](/docs/pages/api-reference/functions/get-static-paths) function in the Pages Router."
  },
  {
    "id": "generate-static-params.mdx#3",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "## Parameters\n\n`options.params` (optional)\n\nIf multiple dynamic segments in a route use `generateStaticParams`, the child `generateStaticParams` function is executed once for each set of `params` the parent generates.\n\nThe `params` object contains the populated `params` from the parent `generateStaticParams`, which can be used to [generate the `params` in a child segment](#multiple-dynamic-segments-in-a-route).\n\n## Returns\n\n`generateStaticParams` should return an array of objects where each object represents the populated dynamic segments of a single route.\n\n- Each property in the object is a dynamic segment to be filled in for the route.\n- The properties name is the segment's name, and the properties value is what that segment should be filled in with.\n\n| Example Route                    | `generateStaticParams` Return Type        |\n| -------------------------------- | ----------------------------------------- |\n| `/product/[id]`                  | `{ id: string }[]`                        |\n| `/products/[category]/[product]` | `{ category: string, product: string }[]` |\n| `/products/[...slug]`            | `{ slug: string[] }[]`                    |"
  },
  {
    "id": "generate-static-params.mdx#4",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "## Single Dynamic Segment\n\n```tsx filename=\"app/product/[id]/page.tsx\" switcher\nexport function generateStaticParams() {\n  return [{ id: '1' }, { id: '2' }, { id: '3' }]\n}\n\n// Three versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\n// - /product/1\n// - /product/2\n// - /product/3\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n  // ...\n}\n```\n\n```jsx filename=\"app/product/[id]/page.js\" switcher\nexport function generateStaticParams() {\n  return [{ id: '1' }, { id: '2' }, { id: '3' }]\n}\n\n// Three versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\n// - /product/1\n// - /product/2\n// - /product/3\nexport default async function Page({ params }) {\n  const { id } = await params\n  // ...\n}\n```"
  },
  {
    "id": "generate-static-params.mdx#5",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "## Multiple Dynamic Segments\n\n```tsx filename=\"app/products/[category]/[product]/page.tsx\" switcher\nexport function generateStaticParams() {\n  return [\n    { category: 'a', product: '1' },\n    { category: 'b', product: '2' },\n    { category: 'c', product: '3' },\n  ]\n}\n\n// Three versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\n// - /products/a/1\n// - /products/b/2\n// - /products/c/3\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ category: string; product: string }>\n}) {\n  const { category, product } = await params\n  // ...\n}\n```\n\n```jsx filename=\"app/products/[category]/[product]/page.js\" switcher\nexport function generateStaticParams() {\n  return [\n    { category: 'a', product: '1' },\n    { category: 'b', product: '2' },\n    { category: 'c', product: '3' },\n  ]\n}\n\n// Three versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\n// - /products/a/1\n// - /products/b/2\n// - /products/c/3\nexport default async function Page({ params }) {\n  const { category, product } = await params\n  // ...\n}\n```"
  },
  {
    "id": "generate-static-params.mdx#6",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "## Catch-all Dynamic Segment\n\n```tsx filename=\"app/product/[...slug]/page.tsx\" switcher\nexport function generateStaticParams() {\n  return [{ slug: ['a', '1'] }, { slug: ['b', '2'] }, { slug: ['c', '3'] }]\n}\n\n// Three versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\n// - /product/a/1\n// - /product/b/2\n// - /product/c/3\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ slug: string[] }>\n}) {\n  const { slug } = await params\n  // ...\n}\n```\n\n```jsx filename=\"app/product/[...slug]/page.js\" switcher\nexport function generateStaticParams() {\n  return [{ slug: ['a', '1'] }, { slug: ['b', '2'] }, { slug: ['c', '3'] }]\n}\n\n// Three versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\n// - /product/a/1\n// - /product/b/2\n// - /product/c/3\nexport default async function Page({ params }) {\n  const { slug } = await params\n  // ...\n}\n```"
  },
  {
    "id": "generate-static-params.mdx#7",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "## Examples"
  },
  {
    "id": "generate-static-params.mdx#8",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "### Static Rendering\n\n#### All paths at build time\n\nTo statically render all paths at build time, supply the full list of paths to `generateStaticParams`:\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  return posts.map((post) => ({\n    slug: post.slug,\n  }))\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  return posts.map((post) => ({\n    slug: post.slug,\n  }))\n}\n```"
  },
  {
    "id": "generate-static-params.mdx#9",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "#### Subset of paths at build time\n\nTo statically render a subset of paths at build time, and the rest the first time they're visited at runtime, return a partial list of paths:\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  // Render the first 10 posts at build time\n  return posts.slice(0, 10).map((post) => ({\n    slug: post.slug,\n  }))\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n\n  // Render the first 10 posts at build time\n  return posts.slice(0, 10).map((post) => ({\n    slug: post.slug,\n  }))\n}"
  },
  {
    "id": "generate-static-params.mdx#10",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "```\n\nThen, by using the [`dynamicParams`](/docs/app/api-reference/file-conventions/route-segment-config#dynamicparams) segment config option, you can control what happens when a dynamic segment is visited that was not generated with `generateStaticParams`.\n\n```tsx filename=\"app/blog/[slug]/page.tsx\" switcher\n// All posts besides the top 10 will be a 404\nexport const dynamicParams = false\n\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n  const topPosts = posts.slice(0, 10)\n\n  return topPosts.map((post) => ({\n    slug: post.slug,\n  }))\n}\n```\n\n```jsx filename=\"app/blog/[slug]/page.js\" switcher\n// All posts besides the top 10 will be a 404\nexport const dynamicParams = false\n\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) => res.json())\n  const topPosts = posts.slice(0, 10)\n\n  return topPosts.map((post) => ({\n    slug: post.slug,\n  }))\n}\n```"
  },
  {
    "id": "generate-static-params.mdx#11",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "#### All paths at runtime\n\nTo statically render all paths the first time they're visited, return an empty array (no paths will be rendered at build time) or utilize [`export const dynamic = 'force-static'`](/docs/app/api-reference/file-conventions/route-segment-config#dynamic):\n\n```jsx filename=\"app/blog/[slug]/page.js\"\nexport async function generateStaticParams() {\n  return []\n}\n```\n\n> **Good to know:** You must always return an array from `generateStaticParams`, even if it's empty. Otherwise, the route will be dynamically rendered.\n\n```jsx filename=\"app/changelog/[slug]/page.js\"\nexport const dynamic = 'force-static'\n```"
  },
  {
    "id": "generate-static-params.mdx#12",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "### Disable rendering for unspecified paths\n\nTo prevent unspecified paths from being statically rendered at runtime, add the `export const dynamicParams = false` option in a route segment. When this config option is used, only paths provided by `generateStaticParams` will be served, and unspecified routes will 404 or match (in the case of [catch-all routes](/docs/app/api-reference/file-conventions/dynamic-routes#catch-all-segments))."
  },
  {
    "id": "generate-static-params.mdx#13",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "### Multiple Dynamic Segments in a Route\n\nYou can generate params for dynamic segments above the current layout or page, but **not below**. For example, given the `app/products/[category]/[product]` route:\n\n- `app/products/[category]/[product]/page.js` can generate params for **both** `[category]` and `[product]`.\n- `app/products/[category]/layout.js` can **only** generate params for `[category]`.\n\nThere are two approaches to generating params for a route with multiple dynamic segments:"
  },
  {
    "id": "generate-static-params.mdx#14",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "#### Generate params from the bottom up\n\nGenerate multiple dynamic segments from the child route segment.\n\n```tsx filename=\"app/products/[category]/[product]/page.tsx\" switcher\n// Generate segments for both [category] and [product]\nexport async function generateStaticParams() {\n  const products = await fetch('https://.../products').then((res) => res.json())\n\n  return products.map((product) => ({\n    category: product.category.slug,\n    product: product.id,\n  }))\n}\n\nexport default function Page({\n  params,\n}: {\n  params: Promise<{ category: string; product: string }>\n}) {\n  // ...\n}\n```\n\n```jsx filename=\"app/products/[category]/[product]/page.js\" switcher\n// Generate segments for both [category] and [product]\nexport async function generateStaticParams() {\n  const products = await fetch('https://.../products').then((res) => res.json())\n\n  return products.map((product) => ({\n    category: product.category.slug,\n    product: product.id,\n  }))\n}\n\nexport default function Page({ params }) {\n  // ...\n}\n```"
  },
  {
    "id": "generate-static-params.mdx#15",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "#### Generate params from the top down\n\nGenerate the parent segments first and use the result to generate the child segments.\n\n```tsx filename=\"app/products/[category]/layout.tsx\" switcher\n// Generate segments for [category]\nexport async function generateStaticParams() {\n  const products = await fetch('https://.../products').then((res) => res.json())\n\n  return products.map((product) => ({\n    category: product.category.slug,\n  }))\n}\n\nexport default function Layout({\n  params,\n}: {\n  params: Promise<{ category: string }>\n}) {\n  // ...\n}\n```\n\n```jsx filename=\"app/products/[category]/layout.js\" switcher\n// Generate segments for [category]\nexport async function generateStaticParams() {\n  const products = await fetch('https://.../products').then((res) => res.json())\n\n  return products.map((product) => ({\n    category: product.category.slug,\n  }))\n}\n\nexport default function Layout({ params }) {\n  // ...\n}"
  },
  {
    "id": "generate-static-params.mdx#16",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "```\n\nA child route segment's `generateStaticParams` function is executed once for each segment a parent `generateStaticParams` generates.\n\nThe child `generateStaticParams` function can use the `params` returned from the parent `generateStaticParams` function to dynamically generate its own segments.\n\n```tsx filename=\"app/products/[category]/[product]/page.tsx\" switcher\n// Generate segments for [product] using the `params` passed from\n// the parent segment's `generateStaticParams` function\nexport async function generateStaticParams({\n  params: { category },\n}: {\n  params: { category: string }\n}) {\n  const products = await fetch(\n    `https://.../products?category=${category}`\n  ).then((res) => res.json())\n\n  return products.map((product) => ({\n    product: product.id,\n  }))\n}\n\nexport default function Page({\n  params,\n}: {\n  params: Promise<{ category: string; product: string }>\n}) {\n  // ...\n}"
  },
  {
    "id": "generate-static-params.mdx#17",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "```\n\n```jsx filename=\"app/products/[category]/[product]/page.js\" switcher\n// Generate segments for [product] using the `params` passed from\n// the parent segment's `generateStaticParams` function\nexport async function generateStaticParams({ params: { category } }) {\n  const products = await fetch(\n    `https://.../products?category=${category}`\n  ).then((res) => res.json())\n\n  return products.map((product) => ({\n    product: product.id,\n  }))\n}\n\nexport default function Page({ params }) {\n  // ...\n}"
  },
  {
    "id": "generate-static-params.mdx#18",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "```\n\nNotice that the params argument can be accessed synchronously and includes only parent segment params.\n\nFor type completion, you can make use of the TypeScript `Awaited` helper in combination with either [`Page Props helper`](/docs/app/api-reference/file-conventions/page#page-props-helper) or [`Layout Props helper`](/docs/app/api-reference/file-conventions/layout#layout-props-helper):\n\n```ts filename=\"app/products/[category]/[product]/page.tsx\" switcher\nexport async function generateStaticParams({\n  params: { category },\n}: {\n  params: Awaited<LayoutProps<'/products/[category]'>['params']>\n}) {\n  const products = await fetch(\n    `https://.../products?category=${category}`\n  ).then((res) => res.json())\n\n  return products.map((product) => ({\n    product: product.id,\n  }))\n}\n```\n\n> **Good to know**: `fetch` requests are automatically [memoized](/docs/app/guides/caching#request-memoization) for the same data across all `generate`-prefixed functions, Layouts, Pages, and Server Components. React [`cache` can be used](/docs/app/guides/caching#react-cache-function) if `fetch` is unavailable."
  },
  {
    "id": "generate-static-params.mdx#19",
    "metadata": {
      "title": "generateStaticParams",
      "description": "API reference for the generateStaticParams function."
    },
    "content": "## Version History\n\n| Version   | Changes                            |\n| --------- | ---------------------------------- |\n| `v13.0.0` | `generateStaticParams` introduced. |"
  },
  {
    "id": "generate-viewport.mdx#0",
    "metadata": {
      "title": "generateViewport",
      "description": "API Reference for the generateViewport function."
    },
    "content": "---\ntitle: generateViewport\ndescription: API Reference for the generateViewport function.\nrelated:\n  title: Next Steps\n  description: View all the Metadata API options.\n  links:\n    - app/api-reference/file-conventions/metadata\n---\n\nYou can customize the initial viewport of the page with the static `viewport` object or the dynamic `generateViewport` function.\n\n> **Good to know**:\n>\n> - The `viewport` object and `generateViewport` function exports are **only supported in Server Components**.\n> - You cannot export both the `viewport` object and `generateViewport` function from the same route segment.\n> - If you're coming from migrating `metadata` exports, you can use [metadata-to-viewport-export codemod](/docs/app/guides/upgrading/codemods#metadata-to-viewport-export) to update your changes."
  },
  {
    "id": "generate-viewport.mdx#1",
    "metadata": {
      "title": "generateViewport",
      "description": "API Reference for the generateViewport function."
    },
    "content": "## The `viewport` object\n\nTo define the viewport options, export a `viewport` object from a `layout.jsx` or `page.jsx` file.\n\n```tsx filename=\"layout.tsx | page.tsx\" switcher\nimport type { Viewport } from 'next'\n\nexport const viewport: Viewport = {\n  themeColor: 'black',\n}\n\nexport default function Page() {}\n```\n\n```jsx filename=\"layout.jsx | page.jsx\" switcher\nexport const viewport = {\n  themeColor: 'black',\n}\n\nexport default function Page() {}\n```"
  },
  {
    "id": "generate-viewport.mdx#2",
    "metadata": {
      "title": "generateViewport",
      "description": "API Reference for the generateViewport function."
    },
    "content": "## `generateViewport` function\n\n`generateViewport` should return a [`Viewport` object](#viewport-fields) containing one or more viewport fields.\n\n```tsx filename=\"layout.tsx | page.tsx\" switcher\nexport function generateViewport({ params }) {\n  return {\n    themeColor: '...',\n  }\n}\n```\n\nIn TypeScript, the `params` argument can be typed via [`PageProps<'/route'>`](/docs/app/api-reference/file-conventions/page#page-props-helper) or [`LayoutProps<'/route'>`](/docs/app/api-reference/file-conventions/layout#layout-props-helper) depending on where `generateViewport` is defined.\n\n```jsx filename=\"layout.js | page.js\" switcher\nexport function generateViewport({ params }) {\n  return {\n    themeColor: '...',\n  }\n}\n```\n\n> **Good to know**:\n>\n> - If the viewport doesn't depend on runtime information, it should be defined using the static [`viewport` object](#the-viewport-object) rather than `generateViewport`."
  },
  {
    "id": "generate-viewport.mdx#3",
    "metadata": {
      "title": "generateViewport",
      "description": "API Reference for the generateViewport function."
    },
    "content": "## Viewport Fields"
  },
  {
    "id": "generate-viewport.mdx#4",
    "metadata": {
      "title": "generateViewport",
      "description": "API Reference for the generateViewport function."
    },
    "content": "### `themeColor`\n\nLearn more about [`theme-color`](https://developer.mozilla.org/docs/Web/HTML/Element/meta/name/theme-color).\n\n**Simple theme color**\n\n```tsx filename=\"layout.tsx | page.tsx\" switcher\nimport type { Viewport } from 'next'\n\nexport const viewport: Viewport = {\n  themeColor: 'black',\n}\n```\n\n```jsx filename=\"layout.jsx | page.jsx\" switcher\nexport const viewport = {\n  themeColor: 'black',\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"theme-color\" content=\"black\" />\n```\n\n**With media attribute**\n\n```tsx filename=\"layout.tsx | page.tsx\" switcher\nimport type { Viewport } from 'next'\n\nexport const viewport: Viewport = {\n  themeColor: [\n    { media: '(prefers-color-scheme: light)', color: 'cyan' },\n    { media: '(prefers-color-scheme: dark)', color: 'black' },\n  ],\n}\n```\n\n```jsx filename=\"layout.jsx | page.jsx\" switcher\nexport const viewport = {\n  themeColor: [\n    { media: '(prefers-color-scheme: light)', color: 'cyan' },\n    { media: '(prefers-color-scheme: dark)', color: 'black' },\n  ],\n}"
  },
  {
    "id": "generate-viewport.mdx#5",
    "metadata": {
      "title": "generateViewport",
      "description": "API Reference for the generateViewport function."
    },
    "content": "```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"theme-color\" media=\"(prefers-color-scheme: light)\" content=\"cyan\" />\n<meta name=\"theme-color\" media=\"(prefers-color-scheme: dark)\" content=\"black\" />\n```"
  },
  {
    "id": "generate-viewport.mdx#6",
    "metadata": {
      "title": "generateViewport",
      "description": "API Reference for the generateViewport function."
    },
    "content": "### `width`, `initialScale`, `maximumScale` and `userScalable`\n\n> **Good to know**: The `viewport` meta tag is automatically set, and manual configuration is usually unnecessary as the default is sufficient. However, the information is provided for completeness.\n\n```tsx filename=\"layout.tsx | page.tsx\" switcher\nimport type { Viewport } from 'next'\n\nexport const viewport: Viewport = {\n  width: 'device-width',\n  initialScale: 1,\n  maximumScale: 1,\n  userScalable: false,\n  // Also supported but less commonly used\n  // interactiveWidget: 'resizes-visual',\n}\n```\n\n```jsx filename=\"layout.jsx | page.jsx\" switcher\nexport const viewport = {\n  width: 'device-width',\n  initialScale: 1,\n  maximumScale: 1,\n  userScalable: false,\n  // Also supported but less commonly used\n  // interactiveWidget: 'resizes-visual',\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta\n  name=\"viewport\"\n  content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\"\n/>\n```"
  },
  {
    "id": "generate-viewport.mdx#7",
    "metadata": {
      "title": "generateViewport",
      "description": "API Reference for the generateViewport function."
    },
    "content": "### `colorScheme`\n\nLearn more about [`color-scheme`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta/name#:~:text=color%2Dscheme%3A%20specifies,of%20the%20following%3A).\n\n```tsx filename=\"layout.tsx | page.tsx\" switcher\nimport type { Viewport } from 'next'\n\nexport const viewport: Viewport = {\n  colorScheme: 'dark',\n}\n```\n\n```jsx filename=\"layout.jsx | page.jsx\" switcher\nexport const viewport = {\n  colorScheme: 'dark',\n}\n```\n\n```html filename=\"<head> output\" hideLineNumbers\n<meta name=\"color-scheme\" content=\"dark\" />\n```"
  },
  {
    "id": "generate-viewport.mdx#8",
    "metadata": {
      "title": "generateViewport",
      "description": "API Reference for the generateViewport function."
    },
    "content": "## Types\n\nYou can add type safety to your viewport object by using the `Viewport` type. If you are using the [built-in TypeScript plugin](/docs/app/api-reference/config/typescript) in your IDE, you do not need to manually add the type, but you can still explicitly add it if you want.\n\n### `viewport` object\n\n```tsx\nimport type { Viewport } from 'next'\n\nexport const viewport: Viewport = {\n  themeColor: 'black',\n}\n```\n\n### `generateViewport` function\n\n#### Regular function\n\n```tsx\nimport type { Viewport } from 'next'\n\nexport function generateViewport(): Viewport {\n  return {\n    themeColor: 'black',\n  }\n}\n```\n\n#### With segment props\n\n```tsx\nimport type { Viewport } from 'next'\n\ntype Props = {\n  params: Promise<{ id: string }>\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>\n}\n\nexport function generateViewport({ params, searchParams }: Props): Viewport {\n  return {\n    themeColor: 'black',\n  }\n}\n\nexport default function Page({ params, searchParams }: Props) {}\n```\n\n#### JavaScript Projects\n\nFor JavaScript projects, you can use JSDoc to add type safety.\n\n```js\n/** @type {import(\"next\").Viewport} */\nexport const viewport = {\n  themeColor: 'black',\n}\n```"
  },
  {
    "id": "generate-viewport.mdx#9",
    "metadata": {
      "title": "generateViewport",
      "description": "API Reference for the generateViewport function."
    },
    "content": "## Version History\n\n| Version   | Changes                                       |\n| --------- | --------------------------------------------- |\n| `v14.0.0` | `viewport` and `generateViewport` introduced. |"
  },
  {
    "id": "headers.mdx#0",
    "metadata": {
      "title": "headers",
      "description": "API reference for the headers function."
    },
    "content": "---\ntitle: headers\ndescription: API reference for the headers function.\n---\n\n`headers` is an **async** function that allows you to **read** the HTTP incoming request headers from a [Server Component](/docs/app/getting-started/server-and-client-components).\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { headers } from 'next/headers'\n\nexport default async function Page() {\n  const headersList = await headers()\n  const userAgent = headersList.get('user-agent')\n}\n```\n\n```jsx filename=\"app/page.js\" switcher\nimport { headers } from 'next/headers'\n\nexport default async function Page() {\n  const headersList = await headers()\n  const userAgent = headersList.get('user-agent')\n}\n```"
  },
  {
    "id": "headers.mdx#1",
    "metadata": {
      "title": "headers",
      "description": "API reference for the headers function."
    },
    "content": "## Reference\n\n### Parameters\n\n`headers` does not take any parameters."
  },
  {
    "id": "headers.mdx#2",
    "metadata": {
      "title": "headers",
      "description": "API reference for the headers function."
    },
    "content": "### Returns\n\n`headers` returns a **read-only** [Web Headers](https://developer.mozilla.org/docs/Web/API/Headers) object."
  },
  {
    "id": "headers.mdx#3",
    "metadata": {
      "title": "headers",
      "description": "API reference for the headers function."
    },
    "content": "- [`Headers.entries()`](https://developer.mozilla.org/docs/Web/API/Headers/entries): Returns an [`iterator`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Iteration_protocols) allowing to go through all key/value pairs contained in this object.\n- [`Headers.forEach()`](https://developer.mozilla.org/docs/Web/API/Headers/forEach): Executes a provided function once for each key/value pair in this `Headers` object.\n- [`Headers.get()`](https://developer.mozilla.org/docs/Web/API/Headers/get): Returns a [`String`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) sequence of all the values of a header within a `Headers` object with a given name.\n- [`Headers.has()`](https://developer.mozilla.org/docs/Web/API/Headers/has): Returns a boolean stating whether a `Headers` object contains a certain header.\n- [`Headers.keys()`](https://developer.mozilla.org/docs/Web/API/Headers/keys): Returns an [`iterator`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Iteration_protocols) allowing you to go through all keys of the key/value pairs contained in this object."
  },
  {
    "id": "headers.mdx#4",
    "metadata": {
      "title": "headers",
      "description": "API reference for the headers function."
    },
    "content": "- [`Headers.values()`](https://developer.mozilla.org/docs/Web/API/Headers/values): Returns an [`iterator`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Iteration_protocols) allowing you to go through all values of the key/value pairs contained in this object."
  },
  {
    "id": "headers.mdx#5",
    "metadata": {
      "title": "headers",
      "description": "API reference for the headers function."
    },
    "content": "## Good to know\n\n- `headers` is an **asynchronous** function that returns a promise. You must use `async/await` or React's [`use`](https://react.dev/reference/react/use) function.\n  - In version 14 and earlier, `headers` was a synchronous function. To help with backwards compatibility, you can still access it synchronously in Next.js 15, but this behavior will be deprecated in the future.\n- Since `headers` is read-only, you cannot `set` or `delete` the outgoing request headers.\n- `headers` is a [Dynamic API](/docs/app/guides/caching#dynamic-rendering) whose returned values cannot be known ahead of time. Using it in will opt a route into **[dynamic rendering](/docs/app/guides/caching#dynamic-rendering)**.\n\n## Examples\n\n### Using the Authorization header\n\n```jsx filename=\"app/page.js\"\nimport { headers } from 'next/headers'\n\nexport default async function Page() {\n  const authorization = (await headers()).get('authorization')\n  const res = await fetch('...', {\n    headers: { authorization }, // Forward the authorization header\n  })\n  const user = await res.json()\n\n  return <h1>{user.name}</h1>\n}\n```"
  },
  {
    "id": "headers.mdx#6",
    "metadata": {
      "title": "headers",
      "description": "API reference for the headers function."
    },
    "content": "## Version History\n\n| Version      | Changes                                                                                                |\n| ------------ | ------------------------------------------------------------------------------------------------------ |\n| `v15.0.0-RC` | `headers` is now an async function. A [codemod](/docs/app/guides/upgrading/codemods#150) is available. |\n| `v13.0.0`    | `headers` introduced.                                                                                  |"
  },
  {
    "id": "image-response.mdx#0",
    "metadata": {
      "title": "ImageResponse",
      "description": "API Reference for the ImageResponse constructor."
    },
    "content": "---\ntitle: ImageResponse\ndescription: API Reference for the ImageResponse constructor.\n---\n\nThe `ImageResponse` constructor allows you to generate dynamic images using JSX and CSS. This is useful for generating social media images such as Open Graph images, Twitter cards, and more."
  },
  {
    "id": "image-response.mdx#1",
    "metadata": {
      "title": "ImageResponse",
      "description": "API Reference for the ImageResponse constructor."
    },
    "content": "## Reference\n\n### Parameters\n\nThe following parameters are available for `ImageResponse`:\n\n```jsx\nimport { ImageResponse } from 'next/og'\n\nnew ImageResponse(\n  element: ReactElement,\n  options: {\n    width?: number = 1200\n    height?: number = 630\n    emoji?: 'twemoji' | 'blobmoji' | 'noto' | 'openmoji' = 'twemoji',\n    fonts?: {\n      name: string,\n      data: ArrayBuffer,\n      weight: number,\n      style: 'normal' | 'italic'\n    }[]\n    debug?: boolean = false\n\n    // Options that will be passed to the HTTP response\n    status?: number = 200\n    statusText?: string\n    headers?: Record<string, string>\n  },\n)\n```\n\n> Examples are available in the [Vercel OG Playground](https://og-playground.vercel.app/).\n\n### Supported HTML and CSS features\n\n`ImageResponse` supports common CSS properties including flexbox and absolute positioning, custom fonts, text wrapping, centering, and nested images.\n\nPlease refer to [Satori’s documentation](https://github.com/vercel/satori#css) for a list of supported HTML and CSS features."
  },
  {
    "id": "image-response.mdx#2",
    "metadata": {
      "title": "ImageResponse",
      "description": "API Reference for the ImageResponse constructor."
    },
    "content": "## Behavior\n\n- `ImageResponse` uses [@vercel/og](https://vercel.com/docs/concepts/functions/edge-functions/og-image-generation), [Satori](https://github.com/vercel/satori), and Resvg to convert HTML and CSS into PNG.\n- Only flexbox and a subset of CSS properties are supported. Advanced layouts (e.g. `display: grid`) will not work.\n- Maximum bundle size of `500KB`. The bundle size includes your JSX, CSS, fonts, images, and any other assets. If you exceed the limit, consider reducing the size of any assets or fetching at runtime.\n- Only `ttf`, `otf`, and `woff` font formats are supported. To maximize the font parsing speed, `ttf` or `otf` are preferred over `woff`."
  },
  {
    "id": "image-response.mdx#3",
    "metadata": {
      "title": "ImageResponse",
      "description": "API Reference for the ImageResponse constructor."
    },
    "content": "## Examples"
  },
  {
    "id": "image-response.mdx#4",
    "metadata": {
      "title": "ImageResponse",
      "description": "API Reference for the ImageResponse constructor."
    },
    "content": "### Route Handlers\n\n`ImageResponse` can be used in Route Handlers to generate images dynamically at request time.\n\n```js filename=\"app/api/route.js\"\nimport { ImageResponse } from 'next/og'"
  },
  {
    "id": "image-response.mdx#5",
    "metadata": {
      "title": "ImageResponse",
      "description": "API Reference for the ImageResponse constructor."
    },
    "content": "```js filename=\"app/api/route.js\"\nimport { ImageResponse } from 'next/og'\n\nexport async function GET() {\n  try {\n    return new ImageResponse(\n      (\n        <div\n          style={{\n            height: '100%',\n            width: '100%',\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            justifyContent: 'center',\n            backgroundColor: 'white',\n            padding: '40px',\n          }}\n        >\n          <div\n            style={{\n              fontSize: 60,\n              fontWeight: 'bold',\n              color: 'black',\n              textAlign: 'center',\n            }}\n          >\n            Welcome to My Site\n          </div>\n          <div\n            style={{\n              fontSize: 30,\n              color: '#666',\n              marginTop: '20px',\n            }}\n          >\n            Generated with Next.js ImageResponse\n          </div>\n        </div>\n      ),\n      {\n        width: 1200,\n        height: 630,\n      }\n    )\n  } catch (e) {\n    console.log(`${e.message}`)\n    return new Response(`Failed to generate the image`, {\n      status: 500,\n    })\n  }\n}\n```"
  },
  {
    "id": "image-response.mdx#6",
    "metadata": {
      "title": "ImageResponse",
      "description": "API Reference for the ImageResponse constructor."
    },
    "content": "### File-based Metadata\n\nYou can use `ImageResponse` in a [`opengraph-image.tsx`](/docs/app/api-reference/file-conventions/metadata/opengraph-image) file to generate Open Graph images at build time or dynamically at request time.\n\n```tsx filename=\"app/opengraph-image.tsx\"\nimport { ImageResponse } from 'next/og'\n\n// Image metadata\nexport const alt = 'My site'\nexport const size = {\n  width: 1200,\n  height: 630,\n}\n\nexport const contentType = 'image/png'\n\n// Image generation\nexport default async function Image() {\n  return new ImageResponse(\n    (\n      // ImageResponse JSX element\n      <div\n        style={{\n          fontSize: 128,\n          background: 'white',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        My site\n      </div>\n    ),\n    // ImageResponse options\n    {\n      // For convenience, we can re-use the exported opengraph-image\n      // size config to also set the ImageResponse's width and height.\n      ...size,\n    }\n  )\n}\n```"
  },
  {
    "id": "image-response.mdx#7",
    "metadata": {
      "title": "ImageResponse",
      "description": "API Reference for the ImageResponse constructor."
    },
    "content": "### Custom fonts\n\nYou can use custom fonts in your `ImageResponse` by providing a `fonts` array in the options.\n\n```tsx filename=\"app/opengraph-image.tsx\"\nimport { ImageResponse } from 'next/og'\nimport { readFile } from 'node:fs/promises'\nimport { join } from 'node:path'\n\n// Image metadata\nexport const alt = 'My site'\nexport const size = {\n  width: 1200,\n  height: 630,\n}\n\nexport const contentType = 'image/png'\n\n// Image generation\nexport default async function Image() {\n  // Font loading, process.cwd() is Next.js project directory\n  const interSemiBold = await readFile(\n    join(process.cwd(), 'assets/Inter-SemiBold.ttf')\n  )\n\n  return new ImageResponse(\n    (\n      // ...\n    ),\n    // ImageResponse options\n    {\n      // For convenience, we can re-use the exported opengraph-image\n      // size config to also set the ImageResponse's width and height.\n      ...size,\n      fonts: [\n        {\n          name: 'Inter',\n          data: interSemiBold,\n          style: 'normal',\n          weight: 400,\n        },\n      ],\n    }\n  )\n}\n```"
  },
  {
    "id": "image-response.mdx#8",
    "metadata": {
      "title": "ImageResponse",
      "description": "API Reference for the ImageResponse constructor."
    },
    "content": "## Version History\n\n| Version   | Changes                                               |\n| --------- | ----------------------------------------------------- |\n| `v14.0.0` | `ImageResponse` moved from `next/server` to `next/og` |\n| `v13.3.0` | `ImageResponse` can be imported from `next/server`.   |\n| `v13.0.0` | `ImageResponse` introduced via `@vercel/og` package.  |"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Functions",
      "description": "API Reference for Next.js Functions and Hooks."
    },
    "content": "---\ntitle: Functions\ndescription: API Reference for Next.js Functions and Hooks.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "next-request.mdx#0",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "---\ntitle: NextRequest\ndescription: API Reference for NextRequest.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNextRequest extends the [Web Request API](https://developer.mozilla.org/docs/Web/API/Request) with additional convenience methods."
  },
  {
    "id": "next-request.mdx#1",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "## `cookies`\n\nRead or mutate the [`Set-Cookie`](https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie) header of the request.\n\n### `set(name, value)`\n\nGiven a name, set a cookie with the given value on the request.\n\n```ts\n// Given incoming request /home\n// Set a cookie to hide the banner\n// request will have a `Set-Cookie:show-banner=false;path=/home` header\nrequest.cookies.set('show-banner', 'false')\n```\n\n### `get(name)`\n\nGiven a cookie name, return the value of the cookie. If the cookie is not found, `undefined` is returned. If multiple cookies are found, the first one is returned.\n\n```ts\n// Given incoming request /home\n// { name: 'show-banner', value: 'false', Path: '/home' }\nrequest.cookies.get('show-banner')\n```\n\n### `getAll()`\n\nGiven a cookie name, return the values of the cookie. If no name is given, return all cookies on the request.\n\n```ts\n// Given incoming request /home\n// [\n//   { name: 'experiments', value: 'new-pricing-page', Path: '/home' },\n//   { name: 'experiments', value: 'winter-launch', Path: '/home' },\n// ]\nrequest.cookies.getAll('experiments')\n// Alternatively, get all cookies for the request\nrequest.cookies.getAll()\n```"
  },
  {
    "id": "next-request.mdx#2",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "### `delete(name)`\n\nGiven a cookie name, delete the cookie from the request.\n\n```ts\n// Returns true for deleted, false is nothing is deleted\nrequest.cookies.delete('experiments')\n```\n\n### `has(name)`\n\nGiven a cookie name, return `true` if the cookie exists on the request.\n\n```ts\n// Returns true if cookie exists, false if it does not\nrequest.cookies.has('experiments')\n```\n\n### `clear()`\n\nRemove the `Set-Cookie` header from the request.\n\n```ts\nrequest.cookies.clear()\n```"
  },
  {
    "id": "next-request.mdx#3",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "## `nextUrl`\n\nExtends the native [`URL`](https://developer.mozilla.org/docs/Web/API/URL) API with additional convenience methods, including Next.js specific properties.\n\n```ts\n// Given a request to /home, pathname is /home\nrequest.nextUrl.pathname\n// Given a request to /home?name=lee, searchParams is { 'name': 'lee' }\nrequest.nextUrl.searchParams"
  },
  {
    "id": "next-request.mdx#4",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "```\n\nThe following options are available:\n\n<PagesOnly>"
  },
  {
    "id": "next-request.mdx#5",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "| Property          | Type                      | Description                                                                                                                            |\n| ----------------- | ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- |\n| `basePath`        | `string`                  | The [base path](/docs/pages/api-reference/config/next-config-js/basePath) of the URL.                                                  |\n| `buildId`         | `string` \\| `undefined`   | The build identifier of the Next.js application. Can be [customized](/docs/pages/api-reference/config/next-config-js/generateBuildId). |\n| `defaultLocale`   | `string` \\| `undefined`   | The default locale for [internationalization](/docs/pages/guides/internationalization).                                                |\n| `domainLocale`    |                           |                                                                                                                                        |"
  },
  {
    "id": "next-request.mdx#6",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "| `domainLocale`    |                           |                                                                                                                                        |\n| - `defaultLocale` | `string`                  | The default locale within a domain.                                                                                                    |\n| - `domain`        | `string`                  | The domain associated with a specific locale.                                                                                          |\n| - `http`          | `boolean` \\| `undefined`  | Indicates if the domain is using HTTP.                                                                                                 |\n| `locales`         | `string[]` \\| `undefined` | An array of available locales.                                                                                                         |\n| `locale`          | `string` \\| `undefined`   | The currently active locale.                                                                                                           |"
  },
  {
    "id": "next-request.mdx#7",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "| `locale`          | `string` \\| `undefined`   | The currently active locale.                                                                                                           |\n| `url`             | `URL`                     | The URL object.                                                                                                                        |"
  },
  {
    "id": "next-request.mdx#8",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "</PagesOnly>\n\n<AppOnly>\n\n| Property       | Type                    | Description                                                                                                                          |\n| -------------- | ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------ |\n| `basePath`     | `string`                | The [base path](/docs/app/api-reference/config/next-config-js/basePath) of the URL.                                                  |\n| `buildId`      | `string` \\| `undefined` | The build identifier of the Next.js application. Can be [customized](/docs/app/api-reference/config/next-config-js/generateBuildId). |\n| `pathname`     | `string`                | The pathname of the URL.                                                                                                             |\n| `searchParams` | `Object`                | The search parameters of the URL.                                                                                                    |"
  },
  {
    "id": "next-request.mdx#9",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "> **Note:** The internationalization properties from the Pages Router are not available for usage in the App Router. Learn more about [internationalization with the App Router](/docs/app/guides/internationalization).\n\n</AppOnly>"
  },
  {
    "id": "next-request.mdx#10",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "## Version History\n\n| Version   | Changes                 |\n| --------- | ----------------------- |\n| `v15.0.0` | `ip` and `geo` removed. |"
  },
  {
    "id": "next-response.mdx#0",
    "metadata": {
      "title": "NextResponse",
      "description": "API Reference for NextResponse."
    },
    "content": "---\ntitle: NextResponse\ndescription: API Reference for NextResponse.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNextResponse extends the [Web Response API](https://developer.mozilla.org/docs/Web/API/Response) with additional convenience methods."
  },
  {
    "id": "next-response.mdx#1",
    "metadata": {
      "title": "NextResponse",
      "description": "API Reference for NextResponse."
    },
    "content": "## `cookies`\n\nRead or mutate the [`Set-Cookie`](https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie) header of the response.\n\n### `set(name, value)`\n\nGiven a name, set a cookie with the given value on the response.\n\n```ts\n// Given incoming request /home\nlet response = NextResponse.next()\n// Set a cookie to hide the banner\nresponse.cookies.set('show-banner', 'false')\n// Response will have a `Set-Cookie:show-banner=false;path=/home` header\nreturn response\n```\n\n### `get(name)`\n\nGiven a cookie name, return the value of the cookie. If the cookie is not found, `undefined` is returned. If multiple cookies are found, the first one is returned.\n\n```ts\n// Given incoming request /home\nlet response = NextResponse.next()\n// { name: 'show-banner', value: 'false', Path: '/home' }\nresponse.cookies.get('show-banner')\n```"
  },
  {
    "id": "next-response.mdx#2",
    "metadata": {
      "title": "NextResponse",
      "description": "API Reference for NextResponse."
    },
    "content": "### `getAll()`\n\nGiven a cookie name, return the values of the cookie. If no name is given, return all cookies on the response.\n\n```ts\n// Given incoming request /home\nlet response = NextResponse.next()\n// [\n//   { name: 'experiments', value: 'new-pricing-page', Path: '/home' },\n//   { name: 'experiments', value: 'winter-launch', Path: '/home' },\n// ]\nresponse.cookies.getAll('experiments')\n// Alternatively, get all cookies for the response\nresponse.cookies.getAll()\n```\n\n### `delete(name)`\n\nGiven a cookie name, delete the cookie from the response.\n\n```ts\n// Given incoming request /home\nlet response = NextResponse.next()\n// Returns true for deleted, false if nothing is deleted\nresponse.cookies.delete('experiments')\n```"
  },
  {
    "id": "next-response.mdx#3",
    "metadata": {
      "title": "NextResponse",
      "description": "API Reference for NextResponse."
    },
    "content": "## `json()`\n\nProduce a response with the given JSON body.\n\n```ts filename=\"app/api/route.ts\" switcher\nimport { NextResponse } from 'next/server'\n\nexport async function GET(request: Request) {\n  return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 })\n}\n```\n\n```js filename=\"app/api/route.js\" switcher\nimport { NextResponse } from 'next/server'\n\nexport async function GET(request) {\n  return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 })\n}\n```"
  },
  {
    "id": "next-response.mdx#4",
    "metadata": {
      "title": "NextResponse",
      "description": "API Reference for NextResponse."
    },
    "content": "## `redirect()`\n\nProduce a response that redirects to a [URL](https://developer.mozilla.org/docs/Web/API/URL).\n\n```ts\nimport { NextResponse } from 'next/server'\n\nreturn NextResponse.redirect(new URL('/new', request.url))\n```\n\nThe [URL](https://developer.mozilla.org/docs/Web/API/URL) can be created and modified before being used in the `NextResponse.redirect()` method. For example, you can use the `request.nextUrl` property to get the current URL, and then modify it to redirect to a different URL.\n\n```ts\nimport { NextResponse } from 'next/server'\n\n// Given an incoming request...\nconst loginUrl = new URL('/login', request.url)\n// Add ?from=/incoming-url to the /login URL\nloginUrl.searchParams.set('from', request.nextUrl.pathname)\n// And redirect to the new URL\nreturn NextResponse.redirect(loginUrl)\n```\n\n## `rewrite()`\n\nProduce a response that rewrites (proxies) the given [URL](https://developer.mozilla.org/docs/Web/API/URL) while preserving the original URL.\n\n```ts\nimport { NextResponse } from 'next/server'\n\n// Incoming request: /about, browser shows /about\n// Rewritten request: /proxy, browser shows /about\nreturn NextResponse.rewrite(new URL('/proxy', request.url))\n```"
  },
  {
    "id": "next-response.mdx#5",
    "metadata": {
      "title": "NextResponse",
      "description": "API Reference for NextResponse."
    },
    "content": "## `next()`\n\nThe `next()` method is useful for Proxy, as it allows you to return early and continue routing.\n\n```ts\nimport { NextResponse } from 'next/server'\n\nreturn NextResponse.next()\n```\n\nYou can also forward `headers` upstream when producing the response, using `NextResponse.next({ request: { headers } })`:\n\n```ts\nimport { NextResponse } from 'next/server'\n\n// Given an incoming request...\nconst newHeaders = new Headers(request.headers)\n// Add a new header\nnewHeaders.set('x-version', '123')\n// Forward the modified request headers upstream\nreturn NextResponse.next({\n  request: {\n    // New request headers\n    headers: newHeaders,\n  },\n})"
  },
  {
    "id": "next-response.mdx#6",
    "metadata": {
      "title": "NextResponse",
      "description": "API Reference for NextResponse."
    },
    "content": "```\n\nThis forwards `newHeaders` upstream to the target page, route, or server action, and does not expose them to the client. While this pattern is useful for passing data upstream, it should be used with caution because the headers containing this data may be forwarded to external services.\n\nIn contrast, `NextResponse.next({ headers })` is a shorthand for sending headers from proxy to the client. This is **NOT** good practice and should be avoided. Among other reasons because setting response headers like `Content-Type`, can override framework expectations (for example, the `Content-Type` used by Server Actions), leading to failed submissions or broken streaming responses.\n\n```ts\nimport { type NextRequest, NextResponse } from 'next/server'\n\nasync function proxy(request: NextRequest) {\n  const headers = await injectAuth(request.headers)\n  // DO NOT forward headers like this\n  return NextResponse.next({ headers })\n}"
  },
  {
    "id": "next-response.mdx#7",
    "metadata": {
      "title": "NextResponse",
      "description": "API Reference for NextResponse."
    },
    "content": "```\n\nIn general, avoid copying all incoming request headers because doing so can leak sensitive data to clients or upstream services.\n\nPrefer a defensive approach by creating a subset of incoming request headers using an allow-list. For example, you might discard custom `x-*` headers and only forward known-safe headers:\n\n```ts\nimport { type NextRequest, NextResponse } from 'next/server'\n\nfunction proxy(request: NextRequest) {\n  const incoming = new Headers(request.headers)\n  const forwarded = new Headers()\n\n  for (const [name, value] of incoming) {\n    const headerName = name.toLowerCase()\n    // Keep only known-safe headers, discard custom x-* and other sensitive ones\n    if (\n      !headerName.startsWith('x-') &&\n      headerName !== 'authorization' &&\n      headerName !== 'cookie'\n    ) {\n      // Preserve original header name casing\n      forwarded.set(name, value)\n    }\n  }\n\n  return NextResponse.next({\n    request: {\n      headers: forwarded,\n    },\n  })\n}\n```"
  },
  {
    "id": "not-found.mdx#0",
    "metadata": {
      "title": "notFound",
      "description": "API Reference for the notFound function."
    },
    "content": "---\ntitle: notFound\ndescription: API Reference for the notFound function.\n---\n\nThe `notFound` function allows you to render the [`not-found file`](/docs/app/api-reference/file-conventions/not-found) within a route segment as well as inject a `<meta name=\"robots\" content=\"noindex\" />` tag."
  },
  {
    "id": "not-found.mdx#1",
    "metadata": {
      "title": "notFound",
      "description": "API Reference for the notFound function."
    },
    "content": "## `notFound()`\n\nInvoking the `notFound()` function throws a `NEXT_HTTP_ERROR_FALLBACK;404` error and terminates rendering of the route segment in which it was thrown. Specifying a [**not-found** file](/docs/app/api-reference/file-conventions/not-found) allows you to gracefully handle such errors by rendering a Not Found UI within the segment.\n\n```jsx filename=\"app/user/[id]/page.js\"\nimport { notFound } from 'next/navigation'\n\nasync function fetchUser(id) {\n  const res = await fetch('https://...')\n  if (!res.ok) return undefined\n  return res.json()\n}\n\nexport default async function Profile({ params }) {\n  const { id } = await params\n  const user = await fetchUser(id)\n\n  if (!user) {\n    notFound()\n  }\n\n  // ...\n}\n```\n\n> **Good to know**: `notFound()` does not require you to use `return notFound()` due to using the TypeScript [`never`](https://www.typescriptlang.org/docs/handbook/2/functions.html#never) type.\n\n## Version History\n\n| Version   | Changes                |\n| --------- | ---------------------- |\n| `v13.0.0` | `notFound` introduced. |"
  },
  {
    "id": "permanentRedirect.mdx#0",
    "metadata": {
      "title": "permanentRedirect",
      "description": "API Reference for the permanentRedirect function."
    },
    "content": "---\ntitle: permanentRedirect\ndescription: API Reference for the permanentRedirect function.\nrelated:\n  links:\n    - app/api-reference/functions/redirect\n---\n\nThe `permanentRedirect` function allows you to redirect the user to another URL. `permanentRedirect` can be used in Server Components, Client Components, [Route Handlers](/docs/app/api-reference/file-conventions/route), and [Server Actions](/docs/app/getting-started/updating-data).\n\nWhen used in a streaming context, this will insert a meta tag to emit the redirect on the client side. When used in a server action, it will serve a 303 HTTP redirect response to the caller. Otherwise, it will serve a 308 (Permanent) HTTP redirect response to the caller.\n\nIf a resource doesn't exist, you can use the [`notFound` function](/docs/app/api-reference/functions/not-found) instead.\n\n> **Good to know**: If you prefer to return a 307 (Temporary) HTTP redirect instead of 308 (Permanent), you can use the [`redirect` function](/docs/app/api-reference/functions/redirect) instead."
  },
  {
    "id": "permanentRedirect.mdx#1",
    "metadata": {
      "title": "permanentRedirect",
      "description": "API Reference for the permanentRedirect function."
    },
    "content": "## Parameters\n\nThe `permanentRedirect` function accepts two arguments:\n\n```js\npermanentRedirect(path, type)\n```\n\n| Parameter | Type                                                          | Description                                                 |\n| --------- | ------------------------------------------------------------- | ----------------------------------------------------------- |\n| `path`    | `string`                                                      | The URL to redirect to. Can be a relative or absolute path. |\n| `type`    | `'replace'` (default) or `'push'` (default in Server Actions) | The type of redirect to perform.                            |\n\nBy default, `permanentRedirect` will use `push` (adding a new entry to the browser history stack) in [Server Actions](/docs/app/getting-started/updating-data) and `replace` (replacing the current URL in the browser history stack) everywhere else. You can override this behavior by specifying the `type` parameter.\n\nThe `type` parameter has no effect when used in Server Components.\n\n## Returns\n\n`permanentRedirect` does not return a value."
  },
  {
    "id": "permanentRedirect.mdx#2",
    "metadata": {
      "title": "permanentRedirect",
      "description": "API Reference for the permanentRedirect function."
    },
    "content": "## Returns\n\n`permanentRedirect` does not return a value.\n\n## Example\n\nInvoking the `permanentRedirect()` function throws a `NEXT_REDIRECT` error and terminates rendering of the route segment in which it was thrown.\n\n```jsx filename=\"app/team/[id]/page.js\"\nimport { permanentRedirect } from 'next/navigation'\n\nasync function fetchTeam(id) {\n  const res = await fetch('https://...')\n  if (!res.ok) return undefined\n  return res.json()\n}\n\nexport default async function Profile({ params }) {\n  const { id } = await params\n  const team = await fetchTeam(id)\n  if (!team) {\n    permanentRedirect('/login')\n  }\n\n  // ...\n}\n```\n\n> **Good to know**: `permanentRedirect` does not require you to use `return permanentRedirect()` as it uses the TypeScript [`never`](https://www.typescriptlang.org/docs/handbook/2/functions.html#never) type."
  },
  {
    "id": "redirect.mdx#0",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "---\ntitle: redirect\ndescription: API Reference for the redirect function.\nrelated:\n  links:\n    - app/api-reference/functions/permanentRedirect\n---\n\nThe `redirect` function allows you to redirect the user to another URL. `redirect` can be used while rendering in [Server and Client Components](/docs/app/getting-started/server-and-client-components), [Route Handlers](/docs/app/api-reference/file-conventions/route), and [Server Actions](/docs/app/getting-started/updating-data).\n\nWhen used in a [streaming context](/docs/app/getting-started/linking-and-navigating#streaming), this will insert a meta tag to emit the redirect on the client side. When used in a server action, it will serve a 303 HTTP redirect response to the caller. Otherwise, it will serve a 307 HTTP redirect response to the caller.\n\nIf a resource doesn't exist, you can use the [`notFound` function](/docs/app/api-reference/functions/not-found) instead."
  },
  {
    "id": "redirect.mdx#1",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "## Reference"
  },
  {
    "id": "redirect.mdx#2",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "### Parameters\n\nThe `redirect` function accepts two arguments:\n\n```js\nredirect(path, type)"
  },
  {
    "id": "redirect.mdx#3",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "```\n\n| Parameter | Type                                                          | Description                                                 |\n| --------- | ------------------------------------------------------------- | ----------------------------------------------------------- |\n| `path`    | `string`                                                      | The URL to redirect to. Can be a relative or absolute path. |\n| `type`    | `'replace'` (default) or `'push'` (default in Server Actions) | The type of redirect to perform.                            |\n\nBy default, `redirect` will use `push` (adding a new entry to the browser history stack) in [Server Actions](/docs/app/getting-started/updating-data) and `replace` (replacing the current URL in the browser history stack) everywhere else. You can override this behavior by specifying the `type` parameter.\n\nThe `RedirectType` object contains the available options for the `type` parameter.\n\n```ts\nimport { redirect, RedirectType } from 'next/navigation'\n\nredirect('/redirect-to', RedirectType.replace)\n// or\nredirect('/redirect-to', RedirectType.push)\n```\n\nThe `type` parameter has no effect when used in Server Components."
  },
  {
    "id": "redirect.mdx#4",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "### Returns\n\n`redirect` does not return a value."
  },
  {
    "id": "redirect.mdx#5",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "## Behavior\n\n- In Server Actions and Route Handlers, redirect should be called **outside** the `try` block when using `try/catch` statements.\n- If you prefer to return a 308 (Permanent) HTTP redirect instead of 307 (Temporary), you can use the [`permanentRedirect` function](/docs/app/api-reference/functions/permanentRedirect) instead.\n- `redirect` throws an error so it should be called **outside** the `try` block when using `try/catch` statements.\n- `redirect` can be called in Client Components during the rendering process but not in event handlers. You can use the [`useRouter` hook](/docs/app/api-reference/functions/use-router) instead.\n- `redirect` also accepts absolute URLs and can be used to redirect to external links.\n- If you'd like to redirect before the render process, use [`next.config.js`](/docs/app/guides/redirecting#redirects-in-nextconfigjs) or [Proxy](/docs/app/guides/redirecting#nextresponseredirect-in-proxy)."
  },
  {
    "id": "redirect.mdx#6",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "## Example"
  },
  {
    "id": "redirect.mdx#7",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "### Server Component\n\nInvoking the `redirect()` function throws a `NEXT_REDIRECT` error and terminates rendering of the route segment in which it was thrown.\n\n```tsx filename=\"app/team/[id]/page.tsx\" switcher\nimport { redirect } from 'next/navigation'\n\nasync function fetchTeam(id: string) {\n  const res = await fetch('https://...')\n  if (!res.ok) return undefined\n  return res.json()\n}\n\nexport default async function Profile({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n  const team = await fetchTeam(id)\n\n  if (!team) {\n    redirect('/login')\n  }\n\n  // ...\n}\n```\n\n```jsx filename=\"app/team/[id]/page.js\" switcher\nimport { redirect } from 'next/navigation'\n\nasync function fetchTeam(id) {\n  const res = await fetch('https://...')\n  if (!res.ok) return undefined\n  return res.json()\n}\n\nexport default async function Profile({ params }) {\n  const { id } = await params\n  const team = await fetchTeam(id)\n\n  if (!team) {\n    redirect('/login')\n  }\n\n  // ...\n}\n```\n\n> **Good to know**: `redirect` does not require you to use `return redirect()` as it uses the TypeScript [`never`](https://www.typescriptlang.org/docs/handbook/2/functions.html#never) type."
  },
  {
    "id": "redirect.mdx#8",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "### Client Component\n\n`redirect` can be directly used in a Client Component.\n\n```tsx filename=\"components/client-redirect.tsx\" switcher\n'use client'\n\nimport { redirect, usePathname } from 'next/navigation'\n\nexport function ClientRedirect() {\n  const pathname = usePathname()\n\n  if (pathname.startsWith('/admin') && !pathname.includes('/login')) {\n    redirect('/admin/login')\n  }\n\n  return <div>Login Page</div>\n}\n```\n\n```jsx filename=\"components/client-redirect.jsx\" switcher\n'use client'\n\nimport { redirect, usePathname } from 'next/navigation'\n\nexport function ClientRedirect() {\n  const pathname = usePathname()\n\n  if (pathname.startsWith('/admin') && !pathname.includes('/login')) {\n    redirect('/admin/login')\n  }\n\n  return <div>Login Page</div>\n}"
  },
  {
    "id": "redirect.mdx#9",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "```\n\n> **Good to know**: When using `redirect` in a Client Component on initial page load during Server-Side Rendering (SSR), it will perform a server-side redirect.\n\n`redirect` can be used in a Client Component through a Server Action. If you need to use an event handler to redirect the user, you can use the [`useRouter`](/docs/app/api-reference/functions/use-router) hook.\n\n```tsx filename=\"app/client-redirect.tsx\" switcher\n'use client'\n\nimport { navigate } from './actions'\n\nexport function ClientRedirect() {\n  return (\n    <form action={navigate}>\n      <input type=\"text\" name=\"id\" />\n      <button>Submit</button>\n    </form>\n  )\n}\n```\n\n```jsx filename=\"app/client-redirect.jsx\" switcher\n'use client'\n\nimport { navigate } from './actions'\n\nexport function ClientRedirect() {\n  return (\n    <form action={navigate}>\n      <input type=\"text\" name=\"id\" />\n      <button>Submit</button>\n    </form>\n  )\n}\n```\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { redirect } from 'next/navigation'\n\nexport async function navigate(data: FormData) {\n  redirect(`/posts/${data.get('id')}`)\n}"
  },
  {
    "id": "redirect.mdx#10",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "```\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { redirect } from 'next/navigation'\n\nexport async function navigate(data: FormData) {\n  redirect(`/posts/${data.get('id')}`)\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { redirect } from 'next/navigation'\n\nexport async function navigate(data) {\n  redirect(`/posts/${data.get('id')}`)\n}\n```"
  },
  {
    "id": "redirect.mdx#11",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "## FAQ"
  },
  {
    "id": "redirect.mdx#12",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "### Why does `redirect` use 307 and 308?\n\nWhen using `redirect()` you may notice that the status codes used are `307` for a temporary redirect, and `308` for a permanent redirect. While traditionally a `302` was used for a temporary redirect, and a `301` for a permanent redirect, many browsers changed the request method of the redirect, from a `POST` to `GET` request when using a `302`, regardless of the origins request method.\n\nTaking the following example of a redirect from `/users` to `/people`, if you make a `POST` request to `/users` to create a new user, and are conforming to a `302` temporary redirect, the request method will be changed from a `POST` to a `GET` request. This doesn't make sense, as to create a new user, you should be making a `POST` request to `/people`, and not a `GET` request.\n\nThe introduction of the `307` status code means that the request method is preserved as `POST`.\n\n- `302` - Temporary redirect, will change the request method from `POST` to `GET`\n- `307` - Temporary redirect, will preserve the request method as `POST`"
  },
  {
    "id": "redirect.mdx#13",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "- `302` - Temporary redirect, will change the request method from `POST` to `GET`\n- `307` - Temporary redirect, will preserve the request method as `POST`\n\nThe `redirect()` method uses a `307` by default, instead of a `302` temporary redirect, meaning your requests will _always_ be preserved as `POST` requests.\n\n[Learn more](https://developer.mozilla.org/docs/Web/HTTP/Redirections) about HTTP Redirects."
  },
  {
    "id": "redirect.mdx#14",
    "metadata": {
      "title": "redirect",
      "description": "API Reference for the redirect function."
    },
    "content": "## Version History\n\n| Version   | Changes                |\n| --------- | ---------------------- |\n| `v13.0.0` | `redirect` introduced. |"
  },
  {
    "id": "refresh.mdx#0",
    "metadata": {
      "title": "refresh",
      "description": "API Reference for the refresh function."
    },
    "content": "---\ntitle: refresh\ndescription: API Reference for the refresh function.\n---\n\n`refresh` allows you to refresh the client router from within a [Server Action](/docs/app/getting-started/updating-data).\n\n## Usage\n\n`refresh` can **only** be called from within Server Actions. It cannot be used in Route Handlers, Client Components, or any other context.\n\n## Parameters\n\n```tsx\nrefresh(): void;\n```\n\n## Returns\n\n`refresh` does not return a value."
  },
  {
    "id": "refresh.mdx#1",
    "metadata": {
      "title": "refresh",
      "description": "API Reference for the refresh function."
    },
    "content": "## Parameters\n\n```tsx\nrefresh(): void;\n```\n\n## Returns\n\n`refresh` does not return a value.\n\n## Examples\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { refresh } from 'next/cache'\n\nexport async function createPost(formData: FormData) {\n  const title = formData.get('title')\n  const content = formData.get('content')\n\n  // Create the post in your database\n  const post = await db.post.create({\n    data: { title, content },\n  })\n\n  refresh()\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { refresh } from 'next/cache'\n\nexport async function createPost(formData) {\n  const title = formData.get('title')\n  const content = formData.get('content')\n\n  // Create the post in your database\n  const post = await db.post.create({\n    data: { title, content },\n  })\n\n  refresh()\n}\n```\n\n### Error when used outside Server Actions\n\n```ts filename=\"app/api/posts/route.ts\" switcher\nimport { refresh } from 'next/cache'\n\nexport async function POST() {\n  // This will throw an error\n  refresh()\n}\n```"
  },
  {
    "id": "revalidatePath.mdx#0",
    "metadata": {
      "title": "revalidatePath",
      "description": "API Reference for the revalidatePath function."
    },
    "content": "---\ntitle: revalidatePath\ndescription: API Reference for the revalidatePath function.\n---\n\n`revalidatePath` allows you to invalidate [cached data](/docs/app/guides/caching) on-demand for a specific path.\n\n## Usage\n\n`revalidatePath` can be called in Server Functions and Route Handlers.\n\n`revalidatePath` cannot be called in Client Components or Proxy, as it only works in server environments.\n\n> **Good to know**:\n>\n> - **Server Functions**: Updates the UI immediately (if viewing the affected path). Currently, it also causes all previously visited pages to refresh when navigated to again. This behavior is temporary and will be updated in the future to apply only to the specific path.\n> - **Route Handlers**: Marks the path for revalidation. The revalidation is done on the next visit to the specified path. This means calling `revalidatePath` with a dynamic route segment will not immediately trigger many revalidations at once. The invalidation only happens when the path is next visited."
  },
  {
    "id": "revalidatePath.mdx#1",
    "metadata": {
      "title": "revalidatePath",
      "description": "API Reference for the revalidatePath function."
    },
    "content": "## Parameters\n\n```tsx\nrevalidatePath(path: string, type?: 'page' | 'layout'): void;\n```\n\n- `path`: Either a route pattern corresponding to the data you want to revalidate, for example `/product/[slug]`, or a specific URL, `/product/123`. Do not append `/page` or `/layout`, use the `type` parameter instead. Must not exceed 1024 characters. This value is case-sensitive.\n- `type`: (optional) `'page'` or `'layout'` string to change the type of path to revalidate. If `path` contains a dynamic segment, for example `/product/[slug]`, this parameter is required. If `path` is a specific URL, `/product/1`, omit `type`.\n\nUse a specific URL when you want to refresh a [single page](#revalidating-a-specific-url). Use a route pattern plus `type` to refresh [multiple URLs](#revalidating-a-page-path).\n\n## Returns\n\n`revalidatePath` does not return a value."
  },
  {
    "id": "revalidatePath.mdx#2",
    "metadata": {
      "title": "revalidatePath",
      "description": "API Reference for the revalidatePath function."
    },
    "content": "## Returns\n\n`revalidatePath` does not return a value.\n\n## What can be invalidated\n\nThe path parameter can point to pages, layouts, or route handlers:\n\n- **Pages**: Invalidates the specific page\n- **Layouts**: Invalidates the layout (the `layout.tsx` at that segment), all nested layouts beneath it, and all pages beneath them\n- **Route Handlers**: Invalidates Data Cache entries accessed within route handlers. For example `revalidatePath(\"/api/data\")` invalidates this GET handler:\n\n```ts filename=\"app/api/data/route.ts\"\nexport async function GET() {\n  const data = await fetch('https://api.vercel.app/blog', {\n    cache: 'force-cache',\n  })\n\n  return Response.json(await data.json())\n}\n```"
  },
  {
    "id": "revalidatePath.mdx#3",
    "metadata": {
      "title": "revalidatePath",
      "description": "API Reference for the revalidatePath function."
    },
    "content": "## Relationship with `revalidateTag` and `updateTag`\n\n`revalidatePath`, [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) and [`updateTag`](/docs/app/api-reference/functions/updateTag) serve different purposes:\n\n- **`revalidatePath`**: Invalidates a specific page or layout path\n- **`revalidateTag`**: Marks data with specific tags as **stale**. Applies across all pages that use those tags\n- **`updateTag`**: Expires data with specific tags. Applies across all pages that use those tags\n\nWhen you call `revalidatePath`, only the specified path gets fresh data on the next visit. Other pages that use the same data tags will continue to serve cached data until those specific tags are also revalidated:\n\n```tsx\n// Page A: /blog\nconst posts = await fetch('https://api.vercel.app/blog', {\n  next: { tags: ['posts'] },\n})\n\n// Page B: /dashboard\nconst recentPosts = await fetch('https://api.vercel.app/blog?limit=5', {\n  next: { tags: ['posts'] },\n})"
  },
  {
    "id": "revalidatePath.mdx#4",
    "metadata": {
      "title": "revalidatePath",
      "description": "API Reference for the revalidatePath function."
    },
    "content": "```\n\nAfter calling `revalidatePath('/blog')`:\n\n- **Page A (/blog)**: Shows fresh data (page re-rendered)\n- **Page B (/dashboard)**: Still shows stale data (cache tag 'posts' not invalidated)\n\nLearn about the difference between [`revalidateTag` and `updateTag`](/docs/app/api-reference/functions/updateTag#differences-from-revalidatetag)."
  },
  {
    "id": "revalidatePath.mdx#5",
    "metadata": {
      "title": "revalidatePath",
      "description": "API Reference for the revalidatePath function."
    },
    "content": "### Building revalidation utilities\n\n`revalidatePath` and `updateTag` are complementary primitives that are often used together in utility functions to ensure comprehensive data consistency across your application:\n\n```ts\n'use server'\n\nimport { revalidatePath, updateTag } from 'next/cache'\n\nexport async function updatePost() {\n  await updatePostInDatabase()\n\n  revalidatePath('/blog') // Refresh the blog page\n  updateTag('posts') // Refresh all pages using 'posts' tag\n}\n```\n\nThis pattern ensures that both the specific page and any other pages using the same data remain consistent."
  },
  {
    "id": "revalidatePath.mdx#6",
    "metadata": {
      "title": "revalidatePath",
      "description": "API Reference for the revalidatePath function."
    },
    "content": "## Examples\n\n### Revalidating a specific URL\n\n```ts\nimport { revalidatePath } from 'next/cache'\nrevalidatePath('/blog/post-1')\n```\n\nThis will invalidate one specific URL for revalidation on the next page visit.\n\n### Revalidating a Page path\n\n```ts\nimport { revalidatePath } from 'next/cache'\nrevalidatePath('/blog/[slug]', 'page')\n// or with route groups\nrevalidatePath('/(main)/blog/[slug]', 'page')\n```\n\nThis will invalidate any URL that matches the provided `page` file for revalidation on the next page visit. This will _not_ invalidate pages beneath the specific page. For example, `/blog/[slug]` won't invalidate `/blog/[slug]/[author]`.\n\n### Revalidating a Layout path\n\n```ts\nimport { revalidatePath } from 'next/cache'\nrevalidatePath('/blog/[slug]', 'layout')\n// or with route groups\nrevalidatePath('/(main)/post/[slug]', 'layout')\n```\n\nThis will invalidate any URL that matches the provided `layout` file for revalidation on the next page visit. This will cause pages beneath with the same layout to be invalidated and revalidated on the next visit. For example, in the above case, `/blog/[slug]/[another]` would also be invalidated and revalidated on the next visit."
  },
  {
    "id": "revalidatePath.mdx#7",
    "metadata": {
      "title": "revalidatePath",
      "description": "API Reference for the revalidatePath function."
    },
    "content": "### Revalidating all data\n\n```ts\nimport { revalidatePath } from 'next/cache'\n\nrevalidatePath('/', 'layout')\n```\n\nThis will purge the Client-side Router Cache, and invalidate the Data Cache for revalidation on the next page visit.\n\n### Server Function\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { revalidatePath } from 'next/cache'\n\nexport default async function submit() {\n  await submitForm()\n  revalidatePath('/')\n}\n```"
  },
  {
    "id": "revalidatePath.mdx#8",
    "metadata": {
      "title": "revalidatePath",
      "description": "API Reference for the revalidatePath function."
    },
    "content": "### Route Handler\n\n```ts filename=\"app/api/revalidate/route.ts\" switcher\nimport { revalidatePath } from 'next/cache'\nimport type { NextRequest } from 'next/server'\n\nexport async function GET(request: NextRequest) {\n  const path = request.nextUrl.searchParams.get('path')\n\n  if (path) {\n    revalidatePath(path)\n    return Response.json({ revalidated: true, now: Date.now() })\n  }\n\n  return Response.json({\n    revalidated: false,\n    now: Date.now(),\n    message: 'Missing path to revalidate',\n  })\n}\n```\n\n```js filename=\"app/api/revalidate/route.js\" switcher\nimport { revalidatePath } from 'next/cache'\n\nexport async function GET(request) {\n  const path = request.nextUrl.searchParams.get('path')\n\n  if (path) {\n    revalidatePath(path)\n    return Response.json({ revalidated: true, now: Date.now() })\n  }\n\n  return Response.json({\n    revalidated: false,\n    now: Date.now(),\n    message: 'Missing path to revalidate',\n  })\n}\n```"
  },
  {
    "id": "revalidateTag.mdx#0",
    "metadata": {
      "title": "revalidateTag",
      "description": "API Reference for the revalidateTag function."
    },
    "content": "---\ntitle: revalidateTag\ndescription: API Reference for the revalidateTag function.\n---\n\n`revalidateTag` allows you to invalidate [cached data](/docs/app/guides/caching) on-demand for a specific cache tag.\n\nThis function is ideal for content where a slight delay in updates is acceptable, such as blog posts, product catalogs, or documentation. Users receive stale content while fresh data loads in the background."
  },
  {
    "id": "revalidateTag.mdx#1",
    "metadata": {
      "title": "revalidateTag",
      "description": "API Reference for the revalidateTag function."
    },
    "content": "## Usage\n\n`revalidateTag` can be called in Server Functions and Route Handlers.\n\n`revalidateTag` cannot be called in Client Components or Proxy, as it only works in server environments."
  },
  {
    "id": "revalidateTag.mdx#2",
    "metadata": {
      "title": "revalidateTag",
      "description": "API Reference for the revalidateTag function."
    },
    "content": "### Revalidation Behavior\n\nThe revalidation behavior depends on whether you provide the second argument:\n\n- **With `profile=\"max\"` (recommended)**: The tag entry is marked as stale, and the next time a resource with that tag is visited, it will use stale-while-revalidate semantics. This means the stale content is served while fresh content is fetched in the background.\n- **With a custom cache life profile**: For advanced usage, you can specify any cache life profile that your application has defined, allowing for custom revalidation behaviors tailored to your specific caching requirements.\n- **Without the second argument (deprecated)**: The tag entry is expired immediately, and the next request to that resource will be a blocking revalidate/cache miss. This behavior is now deprecated, and you should either use `profile=\"max\"` or migrate to [`updateTag`](/docs/app/api-reference/functions/updateTag)."
  },
  {
    "id": "revalidateTag.mdx#3",
    "metadata": {
      "title": "revalidateTag",
      "description": "API Reference for the revalidateTag function."
    },
    "content": "> **Good to know**: When using `profile=\"max\"`, `revalidateTag` marks tagged data as stale, but fresh data is only fetched when pages using that tag are next visited. This means calling `revalidateTag` will not immediately trigger many revalidations at once. The invalidation only happens when any page using that tag is next visited."
  },
  {
    "id": "revalidateTag.mdx#4",
    "metadata": {
      "title": "revalidateTag",
      "description": "API Reference for the revalidateTag function."
    },
    "content": "## Parameters\n\n```ts\nrevalidateTag(tag: string, profile: string | { expire?: number }): void;\n```\n\n- `tag`: A string representing the cache tag associated with the data you want to revalidate. Must not exceed 256 characters. This value is case-sensitive.\n- `profile`: A string that specifies the revalidation behavior. The recommended value is `\"max\"` which provides stale-while-revalidate semantics, or any of the other default or custom profiles defined in [`cacheLife`](/docs/app/api-reference/config/next-config-js/cacheLife). Alternatively, you can pass an object with an `expire` property for custom expiration behavior.\n\nTags must first be assigned to cached data. You can do this in two ways:\n\n- Using the [`next.tags`](/docs/app/guides/caching#fetch-optionsnexttags-and-revalidatetag) option with `fetch` for caching external API requests:\n\n```tsx\nfetch(url, { next: { tags: ['posts'] } })\n```\n\n- Using [`cacheTag`](/docs/app/api-reference/functions/cacheTag) inside cached functions or components with the `'use cache'` directive:\n\n```tsx\nimport { cacheTag } from 'next/cache'\n\nasync function getData() {\n  'use cache'\n  cacheTag('posts')\n  // ...\n}"
  },
  {
    "id": "revalidateTag.mdx#5",
    "metadata": {
      "title": "revalidateTag",
      "description": "API Reference for the revalidateTag function."
    },
    "content": "```\n\n> **Good to know**: The single-argument form `revalidateTag(tag)` is deprecated. It currently works if TypeScript errors are suppressed, but this behavior may be removed in a future version. Update to the two-argument signature."
  },
  {
    "id": "revalidateTag.mdx#6",
    "metadata": {
      "title": "revalidateTag",
      "description": "API Reference for the revalidateTag function."
    },
    "content": "## Returns\n\n`revalidateTag` does not return a value.\n\n## Relationship with `revalidatePath`\n\n`revalidateTag` invalidates data with specific tags across all pages that use those tags, while [`revalidatePath`](/docs/app/api-reference/functions/revalidatePath) invalidates specific page or layout paths.\n\n> **Good to know**: These functions serve different purposes and may need to be used together for comprehensive data consistency. For detailed examples and considerations, see [relationship with revalidateTag and updateTag](/docs/app/api-reference/functions/revalidatePath#relationship-with-revalidatetag-and-updatetag) for more information."
  },
  {
    "id": "revalidateTag.mdx#7",
    "metadata": {
      "title": "revalidateTag",
      "description": "API Reference for the revalidateTag function."
    },
    "content": "## Examples\n\nThe following examples demonstrate how to use `revalidateTag` in different contexts. In both cases, we're using `profile=\"max\"` to mark data as stale and use stale-while-revalidate semantics, which is the recommended approach for most use cases.\n\n### Server Action\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { revalidateTag } from 'next/cache'\n\nexport default async function submit() {\n  await addPost()\n  revalidateTag('posts', 'max')\n}\n```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { revalidateTag } from 'next/cache'\n\nexport default async function submit() {\n  await addPost()\n  revalidateTag('posts', 'max')\n}\n```"
  },
  {
    "id": "revalidateTag.mdx#8",
    "metadata": {
      "title": "revalidateTag",
      "description": "API Reference for the revalidateTag function."
    },
    "content": "### Route Handler\n\n```ts filename=\"app/api/revalidate/route.ts\" switcher\nimport type { NextRequest } from 'next/server'\nimport { revalidateTag } from 'next/cache'\n\nexport async function GET(request: NextRequest) {\n  const tag = request.nextUrl.searchParams.get('tag')\n\n  if (tag) {\n    revalidateTag(tag, 'max')\n    return Response.json({ revalidated: true, now: Date.now() })\n  }\n\n  return Response.json({\n    revalidated: false,\n    now: Date.now(),\n    message: 'Missing tag to revalidate',\n  })\n}\n```\n\n```js filename=\"app/api/revalidate/route.js\" switcher\nimport { revalidateTag } from 'next/cache'\n\nexport async function GET(request) {\n  const tag = request.nextUrl.searchParams.get('tag')\n\n  if (tag) {\n    revalidateTag(tag, 'max')\n    return Response.json({ revalidated: true, now: Date.now() })\n  }\n\n  return Response.json({\n    revalidated: false,\n    now: Date.now(),\n    message: 'Missing tag to revalidate',\n  })\n}"
  },
  {
    "id": "revalidateTag.mdx#9",
    "metadata": {
      "title": "revalidateTag",
      "description": "API Reference for the revalidateTag function."
    },
    "content": "```\n\n> **Good to know**: For webhooks or third-party services that need immediate expiration, you can pass `{ expire: 0 }` as the second argument: `revalidateTag(tag, { expire: 0 })`. This pattern is necessary when external systems call your Route Handlers and require data to expire immediately. For all other cases, it's recommended to use [`updateTag`](/docs/app/api-reference/functions/updateTag) in Server Actions for immediate updates instead."
  },
  {
    "id": "unauthorized.mdx#0",
    "metadata": {
      "title": "unauthorized",
      "description": "API Reference for the unauthorized function."
    },
    "content": "---\ntitle: unauthorized\ndescription: API Reference for the unauthorized function.\nversion: experimental\nrelated:\n  links:\n    - app/api-reference/file-conventions/unauthorized\n---\n\nThe `unauthorized` function throws an error that renders a Next.js 401 error page. It's useful for handling authorization errors in your application. You can customize the UI using the [`unauthorized.js` file](/docs/app/api-reference/file-conventions/unauthorized).\n\nTo start using `unauthorized`, enable the experimental [`authInterrupts`](/docs/app/api-reference/config/next-config-js/authInterrupts) configuration option in your `next.config.js` file:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    authInterrupts: true,\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  experimental: {\n    authInterrupts: true,\n  },\n}"
  },
  {
    "id": "unauthorized.mdx#1",
    "metadata": {
      "title": "unauthorized",
      "description": "API Reference for the unauthorized function."
    },
    "content": "```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  experimental: {\n    authInterrupts: true,\n  },\n}\n```\n\n`unauthorized` can be invoked in [Server Components](/docs/app/getting-started/server-and-client-components), [Server Actions](/docs/app/getting-started/updating-data), and [Route Handlers](/docs/app/api-reference/file-conventions/route).\n\n```tsx filename=\"app/dashboard/page.tsx\" switcher\nimport { verifySession } from '@/app/lib/dal'\nimport { unauthorized } from 'next/navigation'\n\nexport default async function DashboardPage() {\n  const session = await verifySession()\n\n  if (!session) {\n    unauthorized()\n  }\n\n  // Render the dashboard for authenticated users\n  return (\n    <main>\n      <h1>Welcome to the Dashboard</h1>\n      <p>Hi, {session.user.name}.</p>\n    </main>\n  )\n}"
  },
  {
    "id": "unauthorized.mdx#2",
    "metadata": {
      "title": "unauthorized",
      "description": "API Reference for the unauthorized function."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/page.js\" switcher\nimport { verifySession } from '@/app/lib/dal'\nimport { unauthorized } from 'next/navigation'\n\nexport default async function DashboardPage() {\n  const session = await verifySession()\n\n  if (!session) {\n    unauthorized()\n  }\n\n  // Render the dashboard for authenticated users\n  return (\n    <main>\n      <h1>Welcome to the Dashboard</h1>\n      <p>Hi, {session.user.name}.</p>\n    </main>\n  )\n}\n```"
  },
  {
    "id": "unauthorized.mdx#3",
    "metadata": {
      "title": "unauthorized",
      "description": "API Reference for the unauthorized function."
    },
    "content": "## Good to know\n\n- The `unauthorized` function cannot be called in the [root layout](/docs/app/api-reference/file-conventions/layout#root-layout)."
  },
  {
    "id": "unauthorized.mdx#4",
    "metadata": {
      "title": "unauthorized",
      "description": "API Reference for the unauthorized function."
    },
    "content": "## Examples"
  },
  {
    "id": "unauthorized.mdx#5",
    "metadata": {
      "title": "unauthorized",
      "description": "API Reference for the unauthorized function."
    },
    "content": "### Displaying login UI to unauthenticated users\n\nYou can use `unauthorized` function to display the `unauthorized.js` file with a login UI.\n\n```tsx filename=\"app/dashboard/page.tsx\" switcher\nimport { verifySession } from '@/app/lib/dal'\nimport { unauthorized } from 'next/navigation'\n\nexport default async function DashboardPage() {\n  const session = await verifySession()\n\n  if (!session) {\n    unauthorized()\n  }\n\n  return <div>Dashboard</div>\n}\n```\n\n```jsx filename=\"app/dashboard/page.js\" switcher\nimport { verifySession } from '@/app/lib/dal'\nimport { unauthorized } from 'next/navigation'\n\nexport default async function DashboardPage() {\n  const session = await verifySession()\n\n  if (!session) {\n    unauthorized()\n  }\n\n  return <div>Dashboard</div>\n}\n```\n\n```tsx filename=\"app/unauthorized.tsx\" switcher\nimport Login from '@/app/components/Login'\n\nexport default function UnauthorizedPage() {\n  return (\n    <main>\n      <h1>401 - Unauthorized</h1>\n      <p>Please log in to access this page.</p>\n      <Login />\n    </main>\n  )\n}"
  },
  {
    "id": "unauthorized.mdx#6",
    "metadata": {
      "title": "unauthorized",
      "description": "API Reference for the unauthorized function."
    },
    "content": "```\n\n```jsx filename=\"app/unauthorized.js\" switcher\nimport Login from '@/app/components/Login'\n\nexport default function UnauthorizedPage() {\n  return (\n    <main>\n      <h1>401 - Unauthorized</h1>\n      <p>Please log in to access this page.</p>\n      <Login />\n    </main>\n  )\n}\n```"
  },
  {
    "id": "unauthorized.mdx#7",
    "metadata": {
      "title": "unauthorized",
      "description": "API Reference for the unauthorized function."
    },
    "content": "### Mutations with Server Actions\n\nYou can invoke `unauthorized` in Server Actions to ensure only authenticated users can perform specific mutations.\n\n```ts filename=\"app/actions/update-profile.ts\" switcher\n'use server'\n\nimport { verifySession } from '@/app/lib/dal'\nimport { unauthorized } from 'next/navigation'\nimport db from '@/app/lib/db'\n\nexport async function updateProfile(data: FormData) {\n  const session = await verifySession()\n\n  // If the user is not authenticated, return a 401\n  if (!session) {\n    unauthorized()\n  }\n\n  // Proceed with mutation\n  // ...\n}\n```\n\n```js filename=\"app/actions/update-profile.js\" switcher\n'use server'\n\nimport { verifySession } from '@/app/lib/dal'\nimport { unauthorized } from 'next/navigation'\nimport db from '@/app/lib/db'\n\nexport async function updateProfile(data) {\n  const session = await verifySession()\n\n  // If the user is not authenticated, return a 401\n  if (!session) {\n    unauthorized()\n  }\n\n  // Proceed with mutation\n  // ...\n}\n```"
  },
  {
    "id": "unauthorized.mdx#8",
    "metadata": {
      "title": "unauthorized",
      "description": "API Reference for the unauthorized function."
    },
    "content": "### Fetching data with Route Handlers\n\nYou can use `unauthorized` in Route Handlers to ensure only authenticated users can access the endpoint.\n\n```tsx filename=\"app/api/profile/route.ts\" switcher\nimport { NextRequest, NextResponse } from 'next/server'\nimport { verifySession } from '@/app/lib/dal'\nimport { unauthorized } from 'next/navigation'\n\nexport async function GET(req: NextRequest): Promise<NextResponse> {\n  // Verify the user's session\n  const session = await verifySession()\n\n  // If no session exists, return a 401 and render unauthorized.tsx\n  if (!session) {\n    unauthorized()\n  }\n\n  // Fetch data\n  // ...\n}\n```\n\n```jsx filename=\"app/api/profile/route.js\" switcher\nimport { verifySession } from '@/app/lib/dal'\nimport { unauthorized } from 'next/navigation'\n\nexport async function GET() {\n  const session = await verifySession()\n\n  // If the user is not authenticated, return a 401 and render unauthorized.tsx\n  if (!session) {\n    unauthorized()\n  }\n\n  // Fetch data\n  // ...\n}\n```"
  },
  {
    "id": "unauthorized.mdx#9",
    "metadata": {
      "title": "unauthorized",
      "description": "API Reference for the unauthorized function."
    },
    "content": "## Version History\n\n| Version   | Changes                    |\n| --------- | -------------------------- |\n| `v15.1.0` | `unauthorized` introduced. |"
  },
  {
    "id": "unstable_cache.mdx#0",
    "metadata": {
      "title": "unstable_cache",
      "description": "API Reference for the unstable_cache function."
    },
    "content": "---\ntitle: unstable_cache\ndescription: API Reference for the unstable_cache function.\n---\n\n> **Warning:** This API will be replaced by [`use cache`](/docs/app/api-reference/directives/use-cache) when it reaches stability.\n\n`unstable_cache` allows you to cache the results of expensive operations, like database queries, and reuse them across multiple requests.\n\n```jsx\nimport { getUser } from './data';\nimport { unstable_cache } from 'next/cache';\n\nconst getCachedUser = unstable_cache(\n  async (id) => getUser(id),\n  ['my-app-user']\n);\n\nexport default async function Component({ userID }) {\n  const user = await getCachedUser(userID);\n  ...\n}\n```\n\n> **Good to know**:\n>\n> - Accessing dynamic data sources such as `headers` or `cookies` inside a cache scope is not supported. If you need this data inside a cached function use `headers` outside of the cached function and pass the required dynamic data in as an argument.\n> - This API uses Next.js' built-in [Data Cache](/docs/app/guides/caching#data-cache) to persist the result across requests and deployments."
  },
  {
    "id": "unstable_cache.mdx#1",
    "metadata": {
      "title": "unstable_cache",
      "description": "API Reference for the unstable_cache function."
    },
    "content": "## Parameters\n\n```jsx\nconst data = unstable_cache(fetchData, keyParts, options)()\n```\n\n- `fetchData`: This is an asynchronous function that fetches the data you want to cache. It must be a function that returns a `Promise`.\n- `keyParts`: This is an extra array of keys that further adds identification to the cache. By default, `unstable_cache` already uses the arguments and the stringified version of your function as the cache key. It is optional in most cases; the only time you need to use it is when you use external variables without passing them as parameters. However, it is important to add closures used within the function if you do not pass them as parameters.\n- `options`: This is an object that controls how the cache behaves. It can contain the following properties:\n  - `tags`: An array of tags that can be used to control cache invalidation. Next.js will not use this to uniquely identify the function.\n  - `revalidate`: The number of seconds after which the cache should be revalidated. Omit or pass `false` to cache indefinitely or until matching `revalidateTag()` or `revalidatePath()` methods are called."
  },
  {
    "id": "unstable_cache.mdx#2",
    "metadata": {
      "title": "unstable_cache",
      "description": "API Reference for the unstable_cache function."
    },
    "content": "## Returns\n\n`unstable_cache` returns a function that when invoked, returns a Promise that resolves to the cached data. If the data is not in the cache, the provided function will be invoked, and its result will be cached and returned.\n\n## Example\n\n```tsx filename=\"app/page.tsx\" switcher\nimport { unstable_cache } from 'next/cache'\n\nexport default async function Page({\n  params,\n}: {\n  params: Promise<{ userId: string }>\n}) {\n  const { userId } = await params\n  const getCachedUser = unstable_cache(\n    async () => {\n      return { id: userId }\n    },\n    [userId], // add the user ID to the cache key\n    {\n      tags: ['users'],\n      revalidate: 60,\n    }\n  )\n\n  //...\n}\n```\n\n```jsx filename=\"app/page.jsx\" switcher\nimport { unstable_cache } from 'next/cache';\n\nexport default async function Page({ params } }) {\n  const { userId } = await params\n  const getCachedUser = unstable_cache(\n    async () => {\n      return { id: userId };\n    },\n    [userId], // add the user ID to the cache key\n    {\n      tags: [\"users\"],\n      revalidate: 60,\n    }\n  );\n\n  //...\n}\n```"
  },
  {
    "id": "unstable_cache.mdx#3",
    "metadata": {
      "title": "unstable_cache",
      "description": "API Reference for the unstable_cache function."
    },
    "content": "## Version History\n\n| Version   | Changes                      |\n| --------- | ---------------------------- |\n| `v14.0.0` | `unstable_cache` introduced. |"
  },
  {
    "id": "unstable_noStore.mdx#0",
    "metadata": {
      "title": "unstable_noStore",
      "description": "API Reference for the unstable_noStore function."
    },
    "content": "---\ntitle: unstable_noStore\ndescription: API Reference for the unstable_noStore function.\nversion: legacy\n---\n\n**In version 15, we recommend using [`connection`](/docs/app/api-reference/functions/connection) instead of `unstable_noStore`.**\n\n`unstable_noStore` can be used to declaratively opt out of static rendering and indicate a particular component should not be cached.\n\n```jsx\nimport { unstable_noStore as noStore } from 'next/cache';\n\nexport default async function ServerComponent() {\n  noStore();\n  const result = await db.query(...);\n  ...\n}\n```\n\n> **Good to know**:\n>\n> - `unstable_noStore` is equivalent to `cache: 'no-store'` on a `fetch`\n> - `unstable_noStore` is preferred over `export const dynamic = 'force-dynamic'` as it is more granular and can be used on a per-component basis\n\n- Using `unstable_noStore` inside [`unstable_cache`](/docs/app/api-reference/functions/unstable_cache) will not opt out of static generation. Instead, it will defer to the cache configuration to determine whether to cache the result or not."
  },
  {
    "id": "unstable_noStore.mdx#1",
    "metadata": {
      "title": "unstable_noStore",
      "description": "API Reference for the unstable_noStore function."
    },
    "content": "## Usage\n\nIf you prefer not to pass additional options to `fetch`, like `cache: 'no-store'`, `next: { revalidate: 0 }` or in cases where `fetch` is not available, you can use `noStore()` as a replacement for all of these use cases.\n\n```jsx\nimport { unstable_noStore as noStore } from 'next/cache';\n\nexport default async function ServerComponent() {\n  noStore();\n  const result = await db.query(...);\n  ...\n}\n```\n\n## Version History\n\n| Version   | Changes                                         |\n| --------- | ----------------------------------------------- |\n| `v15.0.0` | `unstable_noStore` deprecated for `connection`. |\n| `v14.0.0` | `unstable_noStore` introduced.                  |"
  },
  {
    "id": "unstable_rethrow.mdx#0",
    "metadata": {
      "title": "unstable_rethrow",
      "description": "API Reference for the unstable_rethrow function."
    },
    "content": "---\ntitle: unstable_rethrow\ndescription: API Reference for the unstable_rethrow function.\nversion: unstable\n---\n\n`unstable_rethrow` can be used to avoid catching internal errors thrown by Next.js when attempting to handle errors thrown in your application code.\n\nFor example, calling the `notFound` function will throw an internal Next.js error and render the [`not-found.js`](/docs/app/api-reference/file-conventions/not-found) component. However, if used inside the `try` block of a `try/catch` statement, the error will be caught, preventing `not-found.js` from rendering:\n\n```tsx filename=\"@/app/ui/component.tsx\"\nimport { notFound } from 'next/navigation'\n\nexport default async function Page() {\n  try {\n    const post = await fetch('https://.../posts/1').then((res) => {\n      if (res.status === 404) notFound()\n      if (!res.ok) throw new Error(res.statusText)\n      return res.json()\n    })\n  } catch (err) {\n    console.error(err)\n  }\n}"
  },
  {
    "id": "unstable_rethrow.mdx#1",
    "metadata": {
      "title": "unstable_rethrow",
      "description": "API Reference for the unstable_rethrow function."
    },
    "content": "```\n\nYou can use `unstable_rethrow` API to re-throw the internal error and continue with the expected behavior:\n\n```tsx filename=\"@/app/ui/component.tsx\"\nimport { notFound, unstable_rethrow } from 'next/navigation'\n\nexport default async function Page() {\n  try {\n    const post = await fetch('https://.../posts/1').then((res) => {\n      if (res.status === 404) notFound()\n      if (!res.ok) throw new Error(res.statusText)\n      return res.json()\n    })\n  } catch (err) {\n    unstable_rethrow(err)\n    console.error(err)\n  }\n}"
  },
  {
    "id": "unstable_rethrow.mdx#2",
    "metadata": {
      "title": "unstable_rethrow",
      "description": "API Reference for the unstable_rethrow function."
    },
    "content": "```\n\nThe following Next.js APIs rely on throwing an error which should be rethrown and handled by Next.js itself:\n\n- [`notFound()`](/docs/app/api-reference/functions/not-found)\n- [`redirect()`](/docs/app/guides/redirecting#redirect-function)\n- [`permanentRedirect()`](/docs/app/guides/redirecting#permanentredirect-function)\n\nIf a route segment is marked to throw an error unless it's static, a Dynamic API call will also throw an error that should similarly not be caught by the developer. Note that Partial Prerendering (PPR) affects this behavior as well. These APIs are:\n\n- [`cookies`](/docs/app/api-reference/functions/cookies)\n- [`headers`](/docs/app/api-reference/functions/headers)\n- [`searchParams`](/docs/app/api-reference/file-conventions/page#searchparams-optional)\n- `fetch(..., { cache: 'no-store' })`\n- `fetch(..., { next: { revalidate: 0 } })`"
  },
  {
    "id": "unstable_rethrow.mdx#3",
    "metadata": {
      "title": "unstable_rethrow",
      "description": "API Reference for the unstable_rethrow function."
    },
    "content": "> **Good to know**:\n>\n> - This method should be called at the top of the catch block, passing the error object as its only argument. It can also be used within a `.catch` handler of a promise.\n> - You may be able to avoid using `unstable_rethrow` if you encapsulate your API calls that throw and let the **caller** handle the exception.\n> - Only use `unstable_rethrow` if your caught exceptions may include both application errors and framework-controlled exceptions (like `redirect()` or `notFound()`).\n> - Any resource cleanup (like clearing intervals, timers, etc) would have to either happen prior to the call to `unstable_rethrow` or within a `finally` block."
  },
  {
    "id": "updateTag.mdx#0",
    "metadata": {
      "title": "updateTag",
      "description": "API Reference for the updateTag function."
    },
    "content": "---\ntitle: updateTag\ndescription: API Reference for the updateTag function.\n---\n\n`updateTag` allows you to update [cached data](/docs/app/guides/caching) on-demand for a specific cache tag from within [Server Actions](/docs/app/getting-started/updating-data).\n\nThis function is designed for **read-your-own-writes** scenarios, where a user makes a change (like creating a post), and the UI immediately shows the change, rather than stale data.\n\n## Usage\n\n`updateTag` can **only** be called from within [Server Actions](/docs/app/getting-started/updating-data). It cannot be used in Route Handlers, Client Components, or any other context.\n\nIf you need to invalidate cache tags in Route Handlers or other contexts, use [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) instead.\n\n> **Good to know**: `updateTag` immediately expires the cached data for the specified tag. The next request will wait to fetch fresh data rather than serving stale content from the cache, ensuring users see their changes immediately."
  },
  {
    "id": "updateTag.mdx#1",
    "metadata": {
      "title": "updateTag",
      "description": "API Reference for the updateTag function."
    },
    "content": "## Parameters\n\n```tsx\nupdateTag(tag: string): void;\n```\n\n- `tag`: A string representing the cache tag associated with the data you want to update. Must not exceed 256 characters. This value is case-sensitive.\n\nTags must first be assigned to cached data. You can do this in two ways:\n\n- Using the [`next.tags`](/docs/app/guides/caching#fetch-optionsnexttags-and-revalidatetag) option with `fetch` for caching external API requests:\n\n```tsx\nfetch(url, { next: { tags: ['posts'] } })\n```\n\n- Using [`cacheTag`](/docs/app/api-reference/functions/cacheTag) inside cached functions or components with the `'use cache'` directive:\n\n```tsx\nimport { cacheTag } from 'next/cache'\n\nasync function getData() {\n  'use cache'\n  cacheTag('posts')\n  // ...\n}\n```\n\n## Returns\n\n`updateTag` does not return a value."
  },
  {
    "id": "updateTag.mdx#2",
    "metadata": {
      "title": "updateTag",
      "description": "API Reference for the updateTag function."
    },
    "content": "## Returns\n\n`updateTag` does not return a value.\n\n## Differences from revalidateTag\n\nWhile both `updateTag` and `revalidateTag` invalidate cached data, they serve different purposes:\n\n- **`updateTag`**:\n  - Can only be used in Server Actions\n  - Next request waits for fresh data (no stale content served)\n  - Designed for read-your-own-writes scenarios\n\n- **`revalidateTag`**:\n  - Can be used in Server Actions and Route Handlers\n  - With `profile=\"max\"` (recommended): Serves cached data while fetching fresh data in the background (stale-while-revalidate)\n  - With custom profile: Can be configured to any cache life profile for advanced usage\n  - Without profile: legacy behavior which is equivalent to `updateTag`"
  },
  {
    "id": "updateTag.mdx#3",
    "metadata": {
      "title": "updateTag",
      "description": "API Reference for the updateTag function."
    },
    "content": "## Examples"
  },
  {
    "id": "updateTag.mdx#4",
    "metadata": {
      "title": "updateTag",
      "description": "API Reference for the updateTag function."
    },
    "content": "### Server Action with Read-Your-Own-Writes\n\n```ts filename=\"app/actions.ts\" switcher\n'use server'\n\nimport { updateTag } from 'next/cache'\nimport { redirect } from 'next/navigation'\n\nexport async function createPost(formData: FormData) {\n  const title = formData.get('title')\n  const content = formData.get('content')\n\n  // Create the post in your database\n  const post = await db.post.create({\n    data: { title, content },\n  })\n\n  // Invalidate cache tags so the new post is immediately visible\n  // 'posts' tag: affects any page that displays a list of posts\n  updateTag('posts')\n  // 'post-{id}' tag: affects the individual post detail page\n  updateTag(`post-${post.id}`)\n\n  // Redirect to the new post - user will see fresh data, not cached\n  redirect(`/posts/${post.id}`)\n}"
  },
  {
    "id": "updateTag.mdx#5",
    "metadata": {
      "title": "updateTag",
      "description": "API Reference for the updateTag function."
    },
    "content": "```\n\n```js filename=\"app/actions.js\" switcher\n'use server'\n\nimport { updateTag } from 'next/cache'\nimport { redirect } from 'next/navigation'\n\nexport async function createPost(formData) {\n  const title = formData.get('title')\n  const content = formData.get('content')\n\n  // Create the post in your database\n  const post = await db.post.create({\n    data: { title, content },\n  })\n\n  // Invalidate cache tags so the new post is immediately visible\n  // 'posts' tag: affects any page that displays a list of posts\n  updateTag('posts')\n  // 'post-{id}' tag: affects the individual post detail page\n  updateTag(`post-${post.id}`)\n\n  // Redirect to the new post - user will see fresh data, not cached\n  redirect(`/posts/${post.id}`)\n}\n```"
  },
  {
    "id": "updateTag.mdx#6",
    "metadata": {
      "title": "updateTag",
      "description": "API Reference for the updateTag function."
    },
    "content": "### Error when used outside Server Actions\n\n```ts filename=\"app/api/posts/route.ts\" switcher\nimport { updateTag } from 'next/cache'\n\nexport async function POST() {\n  // This will throw an error\n  updateTag('posts')\n  // Error: updateTag can only be called from within a Server Action\n\n  // Use revalidateTag instead in Route Handlers\n  revalidateTag('posts', 'max')\n}\n```"
  },
  {
    "id": "updateTag.mdx#7",
    "metadata": {
      "title": "updateTag",
      "description": "API Reference for the updateTag function."
    },
    "content": "## When to use updateTag\n\nUse `updateTag` when:\n\n- You're in a Server Action\n- You need immediate cache invalidation for read-your-own-writes\n- You want to ensure the next request sees updated data\n\nUse `revalidateTag` instead when:\n\n- You're in a Route Handler or other non-action context\n- You want stale-while-revalidate semantics\n- You're building a webhook or API endpoint for cache invalidation\n\n## Related\n\n- [`revalidateTag`](/docs/app/api-reference/functions/revalidateTag) - For invalidating tags in Route Handlers\n- [`revalidatePath`](/docs/app/api-reference/functions/revalidatePath) - For invalidating specific paths"
  },
  {
    "id": "use-link-status.mdx#0",
    "metadata": {
      "title": "useLinkStatus",
      "description": "API Reference for the useLinkStatus hook."
    },
    "content": "---\ntitle: useLinkStatus\ndescription: API Reference for the useLinkStatus hook.\nrelated:\n  title: Next Steps\n  description: Learn more about the features mentioned in this page by reading the API Reference.\n  links:\n    - app/api-reference/components/link\n    - app/api-reference/file-conventions/loading\n---\n\nThe `useLinkStatus` hook lets you track the **pending** state of a `<Link>`. Use it for subtle, inline feedback, for example a shimmer effect over the clicked link, while navigation completes. Prefer route-level fallbacks with `loading.js`, and prefetching for instant transitions.\n\n`useLinkStatus` is useful when:\n\n- [Prefetching](/docs/app/getting-started/linking-and-navigating#prefetching) is disabled or in progress meaning navigation is blocked.\n- The destination route is dynamic **and** doesn't include a [`loading.js`](/docs/app/api-reference/file-conventions/loading) file that would allow an instant navigation.\n\n```tsx filename=\"app/hint.tsx\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useLinkStatus } from 'next/link'"
  },
  {
    "id": "use-link-status.mdx#1",
    "metadata": {
      "title": "useLinkStatus",
      "description": "API Reference for the useLinkStatus hook."
    },
    "content": "```tsx filename=\"app/hint.tsx\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useLinkStatus } from 'next/link'\n\nfunction Hint() {\n  const { pending } = useLinkStatus()\n  return (\n    <span aria-hidden className={`link-hint ${pending ? 'is-pending' : ''}`} />\n  )\n}\n\nexport default function Header() {\n  return (\n    <header>\n      <Link href=\"/dashboard\" prefetch={false}>\n        <span className=\"label\">Dashboard</span> <Hint />\n      </Link>\n    </header>\n  )\n}"
  },
  {
    "id": "use-link-status.mdx#2",
    "metadata": {
      "title": "useLinkStatus",
      "description": "API Reference for the useLinkStatus hook."
    },
    "content": "```\n\n```jsx filename=\"app/hint.js\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useLinkStatus } from 'next/link'\n\nfunction Hint() {\n  const { pending } = useLinkStatus()\n  return (\n    <span aria-hidden className={`link-hint ${pending ? 'is-pending' : ''}`} />\n  )\n}\n\nexport default function Header() {\n  return (\n    <header>\n      <Link href=\"/dashboard\" prefetch={false}>\n        <span className=\"label\">Dashboard</span> <Hint />\n      </Link>\n    </header>\n  )\n}\n```\n\n> **Good to know**:\n>\n> - `useLinkStatus` must be used within a descendant component of a `Link` component\n> - The hook is most useful when `prefetch={false}` is set on the `Link` component\n> - If the linked route has been prefetched, the pending state will be skipped\n> - When clicking multiple links in quick succession, only the last link's pending state is shown\n> - This hook is not supported in the Pages Router and always returns `{ pending: false }`\n> - Inline indicators can easily introduce layout shifts. Prefer a fixed-size, always-rendered hint element and toggle its opacity, or use an animation."
  },
  {
    "id": "use-link-status.mdx#3",
    "metadata": {
      "title": "useLinkStatus",
      "description": "API Reference for the useLinkStatus hook."
    },
    "content": "## You might not need `useLinkStatus`\n\nBefore adding inline feedback, consider if:\n\n- The destination is static and prefetched in production, so the pending phase may be skipped.\n- The route has a `loading.js` file, enabling instant transitions with a route-level fallback.\n\nNavigation is typically fast. Use `useLinkStatus` as a quick patch when you identify a slow transition, then iterate to fix the root cause with prefetching or a `loading.js` fallback.\n\n## Parameters\n\n```tsx\nconst { pending } = useLinkStatus()\n```\n\n`useLinkStatus` does not take any parameters.\n\n## Returns\n\n`useLinkStatus` returns an object with a single property:\n\n| Property | Type    | Description                                  |\n| -------- | ------- | -------------------------------------------- |\n| pending  | boolean | `true` before history updates, `false` after |"
  },
  {
    "id": "use-link-status.mdx#4",
    "metadata": {
      "title": "useLinkStatus",
      "description": "API Reference for the useLinkStatus hook."
    },
    "content": "## Example"
  },
  {
    "id": "use-link-status.mdx#5",
    "metadata": {
      "title": "useLinkStatus",
      "description": "API Reference for the useLinkStatus hook."
    },
    "content": "### Inline link hint\n\nAdd a subtle, fixed-size hint that doesn’t affect layout to confirm a click when prefetching hasn’t completed.\n\n```tsx filename=\"app/components/loading-indicator.tsx\" switcher\n'use client'\n\nimport { useLinkStatus } from 'next/link'\n\nexport default function LoadingIndicator() {\n  const { pending } = useLinkStatus()\n  return (\n    <span aria-hidden className={`link-hint ${pending ? 'is-pending' : ''}`} />\n  )\n}\n```\n\n```jsx filename=\"app/components/loading-indicator.js\" switcher\n'use client'\n\nimport { useLinkStatus } from 'next/link'\n\nexport default function LoadingIndicator() {\n  const { pending } = useLinkStatus()\n  return (\n    <span aria-hidden className={`link-hint ${pending ? 'is-pending' : ''}`} />\n  )\n}"
  },
  {
    "id": "use-link-status.mdx#6",
    "metadata": {
      "title": "useLinkStatus",
      "description": "API Reference for the useLinkStatus hook."
    },
    "content": "```\n\n```tsx filename=\"app/shop/layout.tsx\" switcher\nimport Link from 'next/link'\nimport LoadingIndicator from './components/loading-indicator'\n\nconst links = [\n  { href: '/shop/electronics', label: 'Electronics' },\n  { href: '/shop/clothing', label: 'Clothing' },\n  { href: '/shop/books', label: 'Books' },\n]\n\nfunction Menubar() {\n  return (\n    <div>\n      {links.map((link) => (\n        <Link key={link.label} href={link.href}>\n          <span className=\"label\">{link.label}</span> <LoadingIndicator />\n        </Link>\n      ))}\n    </div>\n  )\n}\n\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    <div>\n      <Menubar />\n      {children}\n    </div>\n  )\n}"
  },
  {
    "id": "use-link-status.mdx#7",
    "metadata": {
      "title": "useLinkStatus",
      "description": "API Reference for the useLinkStatus hook."
    },
    "content": "```\n\n```jsx filename=\"app/shop/layout.js\" switcher\nimport Link from 'next/link'\nimport LoadingIndicator from './components/loading-indicator'\n\nconst links = [\n  { href: '/shop/electronics', label: 'Electronics' },\n  { href: '/shop/clothing', label: 'Clothing' },\n  { href: '/shop/books', label: 'Books' },\n]\n\nfunction Menubar() {\n  return (\n    <div>\n      {links.map((link) => (\n        <Link key={link.label} href={link.href}>\n          <span className=\"label\">{link.label}</span> <LoadingIndicator />\n        </Link>\n      ))}\n    </div>\n  )\n}\n\nexport default function Layout({ children }) {\n  return (\n    <div>\n      <Menubar />\n      {children}\n    </div>\n  )\n}\n```"
  },
  {
    "id": "use-link-status.mdx#8",
    "metadata": {
      "title": "useLinkStatus",
      "description": "API Reference for the useLinkStatus hook."
    },
    "content": "## Gracefully handling fast navigation\n\nIf the navigation to a new route is fast, users may see an unnecessary flash of the hint. One way to improve the user experience and only show the hint when the navigation takes time to complete is to add an initial animation delay (e.g. 100ms) and start the animation as invisible (e.g. `opacity: 0`).\n\n```css filename=\"app/styles/global.css\"\n.link-hint {\n  display: inline-block;\n  width: 0.6em;\n  height: 0.6em;\n  margin-left: 0.25rem;\n  border-radius: 9999px;\n  background: currentColor;\n  opacity: 0;\n  visibility: hidden; /* reserve space without showing the hint */\n}\n\n.link-hint.is-pending {\n  /* Animation 1: fade in after 100ms and keep final opacity */\n  /* Animation 2: subtle pulsing while pending */\n  visibility: visible;\n  animation-name: fadeIn, pulse;\n  animation-duration: 200ms, 1s;\n  /* Appear only if navigation actually takes time */\n  animation-delay: 100ms, 100ms;\n  animation-timing-function: ease, ease-in-out;\n  animation-iteration-count: 1, infinite;\n  animation-fill-mode: forwards, none;\n}\n\n@keyframes fadeIn {\n  to {\n    opacity: 0.35;\n  }\n}\n@keyframes pulse {\n  50% {\n    opacity: 0.15;\n  }\n}\n```"
  },
  {
    "id": "use-link-status.mdx#9",
    "metadata": {
      "title": "useLinkStatus",
      "description": "API Reference for the useLinkStatus hook."
    },
    "content": "## Version History\n\n| Version   | Changes                     |\n| --------- | --------------------------- |\n| `v15.3.0` | `useLinkStatus` introduced. |"
  },
  {
    "id": "use-params.mdx#0",
    "metadata": {
      "title": "useParams",
      "description": "API Reference for the useParams hook."
    },
    "content": "---\ntitle: useParams\ndescription: API Reference for the useParams hook.\n---\n\n`useParams` is a **Client Component** hook that lets you read a route's [dynamic params](/docs/app/api-reference/file-conventions/dynamic-routes) filled in by the current URL.\n\n```tsx filename=\"app/example-client-component.tsx\" switcher\n'use client'\n\nimport { useParams } from 'next/navigation'\n\nexport default function ExampleClientComponent() {\n  const params = useParams<{ tag: string; item: string }>()\n\n  // Route -> /shop/[tag]/[item]\n  // URL -> /shop/shoes/nike-air-max-97\n  // `params` -> { tag: 'shoes', item: 'nike-air-max-97' }\n  console.log(params)\n\n  return '...'\n}\n```\n\n```jsx filename=\"app/example-client-component.js\" switcher\n'use client'\n\nimport { useParams } from 'next/navigation'\n\nexport default function ExampleClientComponent() {\n  const params = useParams()\n\n  // Route -> /shop/[tag]/[item]\n  // URL -> /shop/shoes/nike-air-max-97\n  // `params` -> { tag: 'shoes', item: 'nike-air-max-97' }\n  console.log(params)\n\n  return '...'\n}\n```\n\n## Parameters\n\n```tsx\nconst params = useParams()\n```\n\n`useParams` does not take any parameters."
  },
  {
    "id": "use-params.mdx#1",
    "metadata": {
      "title": "useParams",
      "description": "API Reference for the useParams hook."
    },
    "content": "## Returns\n\n`useParams` returns an object containing the current route's filled in [dynamic parameters](/docs/app/api-reference/file-conventions/dynamic-routes).\n\n- Each property in the object is an active dynamic segment.\n- The properties name is the segment's name, and the properties value is what the segment is filled in with.\n- The properties value will either be a `string` or array of `string`'s depending on the [type of dynamic segment](/docs/app/api-reference/file-conventions/dynamic-routes).\n- If the route contains no dynamic parameters, `useParams` returns an empty object.\n- If used in Pages Router, `useParams` will return `null` on the initial render and updates with properties following the rules above once the router is ready.\n\nFor example:"
  },
  {
    "id": "use-params.mdx#2",
    "metadata": {
      "title": "useParams",
      "description": "API Reference for the useParams hook."
    },
    "content": "For example:\n\n| Route                           | URL         | `useParams()`             |\n| ------------------------------- | ----------- | ------------------------- |\n| `app/shop/page.js`              | `/shop`     | `{}`                      |\n| `app/shop/[slug]/page.js`       | `/shop/1`   | `{ slug: '1' }`           |\n| `app/shop/[tag]/[item]/page.js` | `/shop/1/2` | `{ tag: '1', item: '2' }` |\n| `app/shop/[...slug]/page.js`    | `/shop/1/2` | `{ slug: ['1', '2'] }`    |"
  },
  {
    "id": "use-params.mdx#3",
    "metadata": {
      "title": "useParams",
      "description": "API Reference for the useParams hook."
    },
    "content": "## Version History\n\n| Version   | Changes                 |\n| --------- | ----------------------- |\n| `v13.3.0` | `useParams` introduced. |"
  },
  {
    "id": "use-pathname.mdx#0",
    "metadata": {
      "title": "usePathname",
      "description": "API Reference for the usePathname hook."
    },
    "content": "---\ntitle: usePathname\ndescription: API Reference for the usePathname hook.\n---\n\n`usePathname` is a **Client Component** hook that lets you read the current URL's **pathname**.\n\n> **Good to know**: When [`cacheComponents`](/docs/app/api-reference/config/next-config-js/cacheComponents) is enabled `usePathname` may require a `Suspense` boundary around it if your route has a dynamic param. If you use `generateStaticParams` the `Suspense` boundary is optional\n\n```tsx filename=\"app/example-client-component.tsx\" switcher\n'use client'\n\nimport { usePathname } from 'next/navigation'\n\nexport default function ExampleClientComponent() {\n  const pathname = usePathname()\n  return <p>Current pathname: {pathname}</p>\n}\n```\n\n```jsx filename=\"app/example-client-component.js\" switcher\n'use client'\n\nimport { usePathname } from 'next/navigation'\n\nexport default function ExampleClientComponent() {\n  const pathname = usePathname()\n  return <p>Current pathname: {pathname}</p>\n}"
  },
  {
    "id": "use-pathname.mdx#1",
    "metadata": {
      "title": "usePathname",
      "description": "API Reference for the usePathname hook."
    },
    "content": "```\n\n`usePathname` intentionally requires using a [Client Component](/docs/app/getting-started/server-and-client-components). It's important to note Client Components are not a de-optimization. They are an integral part of the [Server Components](/docs/app/getting-started/server-and-client-components) architecture.\n\nFor example, a Client Component with `usePathname` will be rendered into HTML on the initial page load. When navigating to a new route, this component does not need to be re-fetched. Instead, the component is downloaded once (in the client JavaScript bundle), and re-renders based on the current state."
  },
  {
    "id": "use-pathname.mdx#2",
    "metadata": {
      "title": "usePathname",
      "description": "API Reference for the usePathname hook."
    },
    "content": "> **Good to know**:\n>\n> - Reading the current URL from a [Server Component](/docs/app/getting-started/server-and-client-components) is not supported. This design is intentional to support layout state being preserved across page navigations.\n> - If your page is being statically pre-rendered and your app has [rewrites](/docs/app/api-reference/config/next-config-js/rewrites) in `next.config` or a [Proxy](/docs/app/api-reference/file-conventions/proxy) file, reading the pathname with `usePathname()` can result in hydration mismatch errors—because the initial value comes from the server and may not match the actual browser pathname after routing. See our [example](#avoid-hydration-mismatch-with-rewrites) for a way to mitigate this issue.\n\n<details>\n\n<summary>Compatibility with Pages Router</summary>"
  },
  {
    "id": "use-pathname.mdx#3",
    "metadata": {
      "title": "usePathname",
      "description": "API Reference for the usePathname hook."
    },
    "content": "<details>\n\n<summary>Compatibility with Pages Router</summary>\n\nIf you have components that use `usePathname` and they are imported into routes within the Pages Router, be aware that `usePathname` may return `null` if the router is not yet initialized. This can occur in cases such as [fallback routes](/docs/pages/api-reference/functions/get-static-paths#fallback-true) or during [Automatic Static Optimization](https://nextjs.org/docs/pages/building-your-application/rendering/static#automatic-static-optimization) in the Pages Router.\n\nTo enhance compatibility between routing systems, if your project contains both an `app` and a `pages` directory, Next.js will automatically adjust the return type of `usePathname`.\n\n</details>"
  },
  {
    "id": "use-pathname.mdx#4",
    "metadata": {
      "title": "usePathname",
      "description": "API Reference for the usePathname hook."
    },
    "content": "## Parameters\n\n```tsx\nconst pathname = usePathname()\n```\n\n`usePathname` does not take any parameters.\n\n## Returns\n\n`usePathname` returns a string of the current URL's pathname. For example:\n\n| URL                 | Returned value        |\n| ------------------- | --------------------- |\n| `/`                 | `'/'`                 |\n| `/dashboard`        | `'/dashboard'`        |\n| `/dashboard?v=2`    | `'/dashboard'`        |\n| `/blog/hello-world` | `'/blog/hello-world'` |"
  },
  {
    "id": "use-pathname.mdx#5",
    "metadata": {
      "title": "usePathname",
      "description": "API Reference for the usePathname hook."
    },
    "content": "## Examples\n\n### Do something in response to a route change\n\n```tsx filename=\"app/example-client-component.tsx\" switcher\n'use client'\n\nimport { useEffect } from 'react'\nimport { usePathname, useSearchParams } from 'next/navigation'\n\nfunction ExampleClientComponent() {\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n  useEffect(() => {\n    // Do something here...\n  }, [pathname, searchParams])\n}\n```\n\n```jsx filename=\"app/example-client-component.js\" switcher\n'use client'\n\nimport { useEffect } from 'react'\nimport { usePathname, useSearchParams } from 'next/navigation'\n\nfunction ExampleClientComponent() {\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n  useEffect(() => {\n    // Do something here...\n  }, [pathname, searchParams])\n}\n```"
  },
  {
    "id": "use-pathname.mdx#6",
    "metadata": {
      "title": "usePathname",
      "description": "API Reference for the usePathname hook."
    },
    "content": "### Avoid hydration mismatch with rewrites\n\nWhen a page is pre-rendered, the HTML is generated for the source pathname. If the page is then reached through a rewrite using `next.config` or `Proxy`, the browser URL may differ, and `usePathname()` will read the rewritten pathname on the client.\n\nTo avoid hydration mismatches, design the UI so that only a small, isolated part depends on the client pathname. Render a stable fallback on the server and update that part after mount.\n\n```tsx filename=\"app/example-client-component.tsx\" switcher\n'use client'\n\nimport { useEffect, useState } from 'react'\nimport { usePathname } from 'next/navigation'\n\nexport default function PathnameBadge() {\n  const pathname = usePathname()\n  const [clientPathname, setClientPathname] = useState('')\n\n  useEffect(() => {\n    setClientPathname(pathname)\n  }, [pathname])\n\n  return (\n    <p>\n      Current pathname: <span>{clientPathname}</span>\n    </p>\n  )\n}"
  },
  {
    "id": "use-pathname.mdx#7",
    "metadata": {
      "title": "usePathname",
      "description": "API Reference for the usePathname hook."
    },
    "content": "```\n\n```jsx filename=\"app/example-client-component.js\" switcher\n'use client'\n\nimport { useEffect, useState } from 'react'\nimport { usePathname } from 'next/navigation'\n\nexport default function PathnameBadge() {\n  const pathname = usePathname()\n  const [clientPathname, setClientPathname] = useState('')\n\n  useEffect(() => {\n    setClientPathname(pathname)\n  }, [pathname])\n\n  return (\n    <p>\n      Current pathname: <span>{clientPathname}</span>\n    </p>\n  )\n}\n```\n\n| Version   | Changes                   |\n| --------- | ------------------------- |\n| `v13.0.0` | `usePathname` introduced. |"
  },
  {
    "id": "use-report-web-vitals.mdx#0",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "API Reference for the useReportWebVitals function."
    },
    "content": "---\ntitle: useReportWebVitals\ndescription: API Reference for the useReportWebVitals function.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nThe `useReportWebVitals` hook allows you to report [Core Web Vitals](https://web.dev/vitals/), and can be used in combination with your analytics service.\n\nNew functions passed to `useReportWebVitals` are called with the available metrics up to that point. To prevent reporting duplicated data, ensure that the callback function reference does not change (as shown in the code examples below).\n\n<PagesOnly>\n\n```jsx filename=\"pages/_app.js\"\nimport { useReportWebVitals } from 'next/web-vitals'\n\nconst logWebVitals = (metric) => {\n  console.log(metric)\n}\n\nfunction MyApp({ Component, pageProps }) {\n  useReportWebVitals(logWebVitals)\n\n  return <Component {...pageProps} />\n}"
  },
  {
    "id": "use-report-web-vitals.mdx#1",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "API Reference for the useReportWebVitals function."
    },
    "content": "```\n\n</PagesOnly>\n\n<AppOnly>\n\n```jsx filename=\"app/_components/web-vitals.js\"\n'use client'\n\nimport { useReportWebVitals } from 'next/web-vitals'\n\nconst logWebVitals = (metric) => {\n  console.log(metric)\n}\n\nexport function WebVitals() {\n  useReportWebVitals(logWebVitals)\n\n  return null\n}\n```\n\n```jsx filename=\"app/layout.js\"\nimport { WebVitals } from './_components/web-vitals'\n\nexport default function Layout({ children }) {\n  return (\n    <html>\n      <body>\n        <WebVitals />\n        {children}\n      </body>\n    </html>\n  )\n}\n```\n\n> Since the `useReportWebVitals` hook requires the `'use client'` directive, the most performant approach is to create a separate component that the root layout imports. This confines the client boundary exclusively to the `WebVitals` component.\n\n</AppOnly>"
  },
  {
    "id": "use-report-web-vitals.mdx#2",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "API Reference for the useReportWebVitals function."
    },
    "content": "## useReportWebVitals\n\nThe `metric` object passed as the hook's argument consists of a number of properties:"
  },
  {
    "id": "use-report-web-vitals.mdx#3",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "API Reference for the useReportWebVitals function."
    },
    "content": "- `id`: Unique identifier for the metric in the context of the current page load\n- `name`: The name of the performance metric. Possible values include names of [Web Vitals](#web-vitals) metrics (TTFB, FCP, LCP, FID, CLS) specific to a web application.\n- `delta`: The difference between the current value and the previous value of the metric. The value is typically in milliseconds and represents the change in the metric's value over time.\n- `entries`: An array of [Performance Entries](https://developer.mozilla.org/docs/Web/API/PerformanceEntry) associated with the metric. These entries provide detailed information about the performance events related to the metric.\n- `navigationType`: Indicates the [type of navigation](https://developer.mozilla.org/docs/Web/API/PerformanceNavigationTiming/type) that triggered the metric collection. Possible values include `\"navigate\"`, `\"reload\"`, `\"back_forward\"`, and `\"prerender\"`."
  },
  {
    "id": "use-report-web-vitals.mdx#4",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "API Reference for the useReportWebVitals function."
    },
    "content": "- `rating`: A qualitative rating of the metric value, providing an assessment of the performance. Possible values are `\"good\"`, `\"needs-improvement\"`, and `\"poor\"`. The rating is typically determined by comparing the metric value against predefined thresholds that indicate acceptable or suboptimal performance.\n- `value`: The actual value or duration of the performance entry, typically in milliseconds. The value provides a quantitative measure of the performance aspect being tracked by the metric. The source of the value depends on the specific metric being measured and can come from various [Performance API](https://developer.mozilla.org/docs/Web/API/Performance_API)s."
  },
  {
    "id": "use-report-web-vitals.mdx#5",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "API Reference for the useReportWebVitals function."
    },
    "content": "## Web Vitals\n\n[Web Vitals](https://web.dev/vitals/) are a set of useful metrics that aim to capture the user\nexperience of a web page. The following web vitals are all included:\n\n- [Time to First Byte](https://developer.mozilla.org/docs/Glossary/Time_to_first_byte) (TTFB)\n- [First Contentful Paint](https://developer.mozilla.org/docs/Glossary/First_contentful_paint) (FCP)\n- [Largest Contentful Paint](https://web.dev/lcp/) (LCP)\n- [First Input Delay](https://web.dev/fid/) (FID)\n- [Cumulative Layout Shift](https://web.dev/cls/) (CLS)\n- [Interaction to Next Paint](https://web.dev/inp/) (INP)\n\nYou can handle all the results of these metrics using the `name` property.\n\n<PagesOnly>\n\n```jsx filename=\"pages/_app.js\"\nimport { useReportWebVitals } from 'next/web-vitals'\n\nconst handleWebVitals = (metric) => {\n  switch (metric.name) {\n    case 'FCP': {\n      // handle FCP results\n    }\n    case 'LCP': {\n      // handle LCP results\n    }\n    // ...\n  }\n}\n\nfunction MyApp({ Component, pageProps }) {\n  useReportWebVitals(handleWebVitals)\n\n  return <Component {...pageProps} />\n}"
  },
  {
    "id": "use-report-web-vitals.mdx#6",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "API Reference for the useReportWebVitals function."
    },
    "content": "```\n\n</PagesOnly>\n\n<AppOnly>\n\n```tsx filename=\"app/components/web-vitals.tsx\" switcher\n'use client'\n\nimport { useReportWebVitals } from 'next/web-vitals'\n\ntype ReportWebVitalsCallback = Parameters<typeof useReportWebVitals>[0]\n\nconst handleWebVitals: ReportWebVitalsCallback = (metric) => {\n  switch (metric.name) {\n    case 'FCP': {\n      // handle FCP results\n    }\n    case 'LCP': {\n      // handle LCP results\n    }\n    // ...\n  }\n}\n\nexport function WebVitals() {\n  useReportWebVitals(handleWebVitals)\n}\n```\n\n```jsx filename=\"app/components/web-vitals.js\" switcher\n'use client'\n\nimport { useReportWebVitals } from 'next/web-vitals'\n\nconst handleWebVitals = (metric) => {\n  switch (metric.name) {\n    case 'FCP': {\n      // handle FCP results\n    }\n    case 'LCP': {\n      // handle LCP results\n    }\n    // ...\n  }\n}\n\nexport function WebVitals() {\n  useReportWebVitals(handleWebVitals)\n}\n```\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "use-report-web-vitals.mdx#7",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "API Reference for the useReportWebVitals function."
    },
    "content": "## Custom Metrics\n\nIn addition to the core metrics listed above, there are some additional custom metrics that\nmeasure the time it takes for the page to hydrate and render:\n\n- `Next.js-hydration`: Length of time it takes for the page to start and finish hydrating (in ms)\n- `Next.js-route-change-to-render`: Length of time it takes for a page to start rendering after a\n  route change (in ms)\n- `Next.js-render`: Length of time it takes for a page to finish render after a route change (in ms)\n\nYou can handle all the results of these metrics separately:\n\n```jsx filename=\"pages/_app.js\"\nimport { useReportWebVitals } from 'next/web-vitals'\n\nfunction handleCustomMetrics(metrics) {\n  switch (metric.name) {\n    case 'Next.js-hydration':\n      // handle hydration results\n      break\n    case 'Next.js-route-change-to-render':\n      // handle route-change to render results\n      break\n    case 'Next.js-render':\n      // handle render results\n      break\n    default:\n      break\n  }\n}\n\nfunction MyApp({ Component, pageProps }) {\n  useReportWebVitals(handleCustomMetrics)\n\n  return <Component {...pageProps} />\n}"
  },
  {
    "id": "use-report-web-vitals.mdx#8",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "API Reference for the useReportWebVitals function."
    },
    "content": "```\n\nThese metrics work in all browsers that support the [User Timing API](https://caniuse.com/#feat=user-timing).\n\n</PagesOnly>"
  },
  {
    "id": "use-report-web-vitals.mdx#9",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "API Reference for the useReportWebVitals function."
    },
    "content": "## Sending results to external systems\n\nYou can send results to any endpoint to measure and track\nreal user performance on your site. For example:\n\n```js\nfunction postWebVitals(metrics) {\n  const body = JSON.stringify(metric)\n  const url = 'https://example.com/analytics'\n\n  // Use `navigator.sendBeacon()` if available, falling back to `fetch()`.\n  if (navigator.sendBeacon) {\n    navigator.sendBeacon(url, body)\n  } else {\n    fetch(url, { body, method: 'POST', keepalive: true })\n  }\n}\n\nuseReportWebVitals(postWebVitals)"
  },
  {
    "id": "use-report-web-vitals.mdx#10",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "API Reference for the useReportWebVitals function."
    },
    "content": "```\n\n> **Good to know**: If you use [Google Analytics](https://analytics.google.com/analytics/web/), using the\n> `id` value can allow you to construct metric distributions manually (to calculate percentiles,\n> etc.)\n\n> ```js\n> useReportWebVitals(metric => {\n>   // Use `window.gtag` if you initialized Google Analytics as this example:\n>   // https://github.com/vercel/next.js/blob/canary/examples/with-google-analytics\n>   window.gtag('event', metric.name, {\n>     value: Math.round(metric.name === 'CLS' ? metric.value * 1000 : metric.value), // values must be integers\n>     event_label: metric.id, // id unique to current page load\n>     non_interaction: true, // avoids affecting bounce rate.\n>   });\n> }\n> ```\n>\n> Read more about [sending results to Google Analytics](https://github.com/GoogleChrome/web-vitals#send-the-results-to-google-analytics)."
  },
  {
    "id": "use-router.mdx#0",
    "metadata": {
      "title": "useRouter",
      "description": "API reference for the useRouter hook."
    },
    "content": "---\ntitle: useRouter\ndescription: API reference for the useRouter hook.\n---\n\nThe `useRouter` hook allows you to programmatically change routes inside [Client Components](/docs/app/getting-started/server-and-client-components).\n\n> **Recommendation:** Use the [`<Link>` component](/docs/app/api-reference/components/link) for navigation unless you have a specific requirement for using `useRouter`.\n\n```tsx filename=\"app/example-client-component.tsx\" switcher\n'use client'\n\nimport { useRouter } from 'next/navigation'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button type=\"button\" onClick={() => router.push('/dashboard')}>\n      Dashboard\n    </button>\n  )\n}\n```\n\n```jsx filename=\"app/example-client-component.js\" switcher\n'use client'\n\nimport { useRouter } from 'next/navigation'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button type=\"button\" onClick={() => router.push('/dashboard')}>\n      Dashboard\n    </button>\n  )\n}\n```"
  },
  {
    "id": "use-router.mdx#1",
    "metadata": {
      "title": "useRouter",
      "description": "API reference for the useRouter hook."
    },
    "content": "## `useRouter()`"
  },
  {
    "id": "use-router.mdx#2",
    "metadata": {
      "title": "useRouter",
      "description": "API reference for the useRouter hook."
    },
    "content": "- `router.push(href: string, { scroll: boolean })`: Perform a client-side navigation to the provided route. Adds a new entry into the [browser's history stack](https://developer.mozilla.org/docs/Web/API/History_API).\n- `router.replace(href: string, { scroll: boolean })`: Perform a client-side navigation to the provided route without adding a new entry into the browser’s history stack.\n- `router.refresh()`: Refresh the current route. Making a new request to the server, re-fetching data requests, and re-rendering Server Components. The client will merge the updated React Server Component payload without losing unaffected client-side React (e.g. `useState`) or browser state (e.g. scroll position).\n- `router.prefetch(href: string, options?: { onInvalidate?: () => void })`: [Prefetch](/docs/app/getting-started/linking-and-navigating#prefetching) the provided route for faster client-side transitions. The optional `onInvalidate` callback is called when the [prefetched data becomes stale](/docs/app/guides/prefetching#extending-or-ejecting-link).\n- `router.back()`: Navigate back to the previous route in the browser’s history stack."
  },
  {
    "id": "use-router.mdx#3",
    "metadata": {
      "title": "useRouter",
      "description": "API reference for the useRouter hook."
    },
    "content": "- `router.back()`: Navigate back to the previous route in the browser’s history stack.\n- `router.forward()`: Navigate forwards to the next page in the browser’s history stack."
  },
  {
    "id": "use-router.mdx#4",
    "metadata": {
      "title": "useRouter",
      "description": "API reference for the useRouter hook."
    },
    "content": "> **Good to know**:\n>\n> - You must not send untrusted or unsanitized URLs to `router.push` or `router.replace`, as this can open your site to cross-site scripting (XSS) vulnerabilities. For example, `javascript:` URLs sent to `router.push` or `router.replace` will be executed in the context of your page.\n> - The `<Link>` component automatically prefetch routes as they become visible in the viewport.\n> - `refresh()` could re-produce the same result if fetch requests are cached. Other Dynamic APIs like `cookies` and `headers` could also change the response.\n> - The `onInvalidate` callback is called at most once per prefetch request. It signals when you may want to trigger a new prefetch for updated route data."
  },
  {
    "id": "use-router.mdx#5",
    "metadata": {
      "title": "useRouter",
      "description": "API reference for the useRouter hook."
    },
    "content": "### Migrating from `next/router`\n\n- The `useRouter` hook should be imported from `next/navigation` and not `next/router` when using the App Router\n- The `pathname` string has been removed and is replaced by [`usePathname()`](/docs/app/api-reference/functions/use-pathname)\n- The `query` object has been removed and is replaced by [`useSearchParams()`](/docs/app/api-reference/functions/use-search-params)\n- `router.events` has been replaced. [See below.](#router-events)\n\n[View the full migration guide](/docs/app/guides/migrating/app-router-migration)."
  },
  {
    "id": "use-router.mdx#6",
    "metadata": {
      "title": "useRouter",
      "description": "API reference for the useRouter hook."
    },
    "content": "## Examples"
  },
  {
    "id": "use-router.mdx#7",
    "metadata": {
      "title": "useRouter",
      "description": "API reference for the useRouter hook."
    },
    "content": "### Router events\n\nYou can listen for page changes by composing other Client Component hooks like `usePathname` and `useSearchParams`.\n\n```jsx filename=\"app/components/navigation-events.js\"\n'use client'\n\nimport { useEffect } from 'react'\nimport { usePathname, useSearchParams } from 'next/navigation'\n\nexport function NavigationEvents() {\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n\n  useEffect(() => {\n    const url = `${pathname}?${searchParams}`\n    console.log(url)\n    // You can now use the current URL\n    // ...\n  }, [pathname, searchParams])\n\n  return '...'\n}\n```\n\nWhich can be imported into a layout.\n\n```jsx filename=\"app/layout.js\" highlight={2,10-12}\nimport { Suspense } from 'react'\nimport { NavigationEvents } from './components/navigation-events'\n\nexport default function Layout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        {children}\n\n        <Suspense fallback={null}>\n          <NavigationEvents />\n        </Suspense>\n      </body>\n    </html>\n  )\n}"
  },
  {
    "id": "use-router.mdx#8",
    "metadata": {
      "title": "useRouter",
      "description": "API reference for the useRouter hook."
    },
    "content": "```\n\n> **Good to know**: `<NavigationEvents>` is wrapped in a [`Suspense` boundary](/docs/app/api-reference/file-conventions/loading#examples) because[`useSearchParams()`](/docs/app/api-reference/functions/use-search-params) causes client-side rendering up to the closest `Suspense` boundary during [static rendering](/docs/app/guides/caching#static-rendering). [Learn more](/docs/app/api-reference/functions/use-search-params#behavior)."
  },
  {
    "id": "use-router.mdx#9",
    "metadata": {
      "title": "useRouter",
      "description": "API reference for the useRouter hook."
    },
    "content": "### Disabling scroll to top\n\nBy default, Next.js will scroll to the top of the page when navigating to a new route. You can disable this behavior by passing `scroll: false` to `router.push()` or `router.replace()`.\n\n```tsx filename=\"app/example-client-component.tsx\" switcher\n'use client'\n\nimport { useRouter } from 'next/navigation'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button\n      type=\"button\"\n      onClick={() => router.push('/dashboard', { scroll: false })}\n    >\n      Dashboard\n    </button>\n  )\n}\n```\n\n```jsx filename=\"app/example-client-component.jsx\" switcher\n'use client'\n\nimport { useRouter } from 'next/navigation'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button\n      type=\"button\"\n      onClick={() => router.push('/dashboard', { scroll: false })}\n    >\n      Dashboard\n    </button>\n  )\n}\n```"
  },
  {
    "id": "use-router.mdx#10",
    "metadata": {
      "title": "useRouter",
      "description": "API reference for the useRouter hook."
    },
    "content": "## Version History\n\n| Version   | Changes                                                           |\n| --------- | ----------------------------------------------------------------- |\n| `v15.4.0` | Optional `onInvalidate` callback for `router.prefetch` introduced |\n| `v13.0.0` | `useRouter` from `next/navigation` introduced.                    |"
  },
  {
    "id": "use-search-params.mdx#0",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "---\ntitle: useSearchParams\ndescription: API Reference for the useSearchParams hook.\n---\n\n`useSearchParams` is a **Client Component** hook that lets you read the current URL's **query string**.\n\n`useSearchParams` returns a **read-only** version of the [`URLSearchParams`](https://developer.mozilla.org/docs/Web/API/URLSearchParams) interface.\n\n```tsx filename=\"app/dashboard/search-bar.tsx\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function SearchBar() {\n  const searchParams = useSearchParams()\n\n  const search = searchParams.get('search')\n\n  // URL -> `/dashboard?search=my-project`\n  // `search` -> 'my-project'\n  return <>Search: {search}</>\n}\n```\n\n```jsx filename=\"app/dashboard/search-bar.js\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function SearchBar() {\n  const searchParams = useSearchParams()\n\n  const search = searchParams.get('search')\n\n  // URL -> `/dashboard?search=my-project`\n  // `search` -> 'my-project'\n  return <>Search: {search}</>\n}\n```\n\n## Parameters\n\n```tsx\nconst searchParams = useSearchParams()\n```\n\n`useSearchParams` does not take any parameters."
  },
  {
    "id": "use-search-params.mdx#1",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "## Returns\n\n`useSearchParams` returns a **read-only** version of the [`URLSearchParams`](https://developer.mozilla.org/docs/Web/API/URLSearchParams) interface, which includes utility methods for reading the URL's query string:\n\n- [`URLSearchParams.get()`](https://developer.mozilla.org/docs/Web/API/URLSearchParams/get): Returns the first value associated with the search parameter. For example:"
  },
  {
    "id": "use-search-params.mdx#2",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "- [`URLSearchParams.get()`](https://developer.mozilla.org/docs/Web/API/URLSearchParams/get): Returns the first value associated with the search parameter. For example:\n\n  | URL                  | `searchParams.get(\"a\")`                                                                                         |\n  | -------------------- | --------------------------------------------------------------------------------------------------------------- |\n  | `/dashboard?a=1`     | `'1'`                                                                                                           |\n  | `/dashboard?a=`      | `''`                                                                                                            |\n  | `/dashboard?b=3`     | `null`                                                                                                          |\n  | `/dashboard?a=1&a=2` | `'1'` _- use [`getAll()`](https://developer.mozilla.org/docs/Web/API/URLSearchParams/getAll) to get all values_ |\n\n- [`URLSearchParams.has()`](https://developer.mozilla.org/docs/Web/API/URLSearchParams/has): Returns a boolean value indicating if the given parameter exists. For example:"
  },
  {
    "id": "use-search-params.mdx#3",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "- [`URLSearchParams.has()`](https://developer.mozilla.org/docs/Web/API/URLSearchParams/has): Returns a boolean value indicating if the given parameter exists. For example:\n\n  | URL              | `searchParams.has(\"a\")` |\n  | ---------------- | ----------------------- |\n  | `/dashboard?a=1` | `true`                  |\n  | `/dashboard?b=3` | `false`                 |\n\n- Learn more about other **read-only** methods of [`URLSearchParams`](https://developer.mozilla.org/docs/Web/API/URLSearchParams), including the [`getAll()`](https://developer.mozilla.org/docs/Web/API/URLSearchParams/getAll), [`keys()`](https://developer.mozilla.org/docs/Web/API/URLSearchParams/keys), [`values()`](https://developer.mozilla.org/docs/Web/API/URLSearchParams/values), [`entries()`](https://developer.mozilla.org/docs/Web/API/URLSearchParams/entries), [`forEach()`](https://developer.mozilla.org/docs/Web/API/URLSearchParams/forEach), and [`toString()`](https://developer.mozilla.org/docs/Web/API/URLSearchParams/toString)."
  },
  {
    "id": "use-search-params.mdx#4",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "> **Good to know**:\n>\n> - `useSearchParams` is a [Client Component](/docs/app/getting-started/server-and-client-components) hook and is **not supported** in [Server Components](/docs/app/getting-started/server-and-client-components) to prevent stale values during [partial rendering](/docs/app/getting-started/linking-and-navigating#client-side-transitions).\n> - If you want to fetch data in a Server Component based on search params, it's often a better option to read the [`searchParams` prop](/docs/app/api-reference/file-conventions/page#searchparams-optional) of the corresponding Page. You can then pass it down by props to any component (Server or Client) within that Page.\n> - If an application includes the `/pages` directory, `useSearchParams` will return `ReadonlyURLSearchParams | null`. The `null` value is for compatibility during migration since search params cannot be known during pre-rendering of a page that doesn't use `getServerSideProps`"
  },
  {
    "id": "use-search-params.mdx#5",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "## Behavior"
  },
  {
    "id": "use-search-params.mdx#6",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "### Static Rendering\n\nIf a route is [statically rendered](/docs/app/guides/caching#static-rendering), calling `useSearchParams` will cause the Client Component tree up to the closest [`Suspense` boundary](/docs/app/api-reference/file-conventions/loading#examples) to be client-side rendered.\n\nThis allows a part of the route to be statically rendered while the dynamic part that uses `useSearchParams` is client-side rendered.\n\nWe recommend wrapping the Client Component that uses `useSearchParams` in a `<Suspense/>` boundary. This will allow any Client Components above it to be statically rendered and sent as part of initial HTML. [Example](/docs/app/api-reference/functions/use-search-params#static-rendering).\n\nFor example:\n\n```tsx filename=\"app/dashboard/search-bar.tsx\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function SearchBar() {\n  const searchParams = useSearchParams()\n\n  const search = searchParams.get('search')\n\n  // This will not be logged on the server when using static rendering\n  console.log(search)\n\n  return <>Search: {search}</>\n}"
  },
  {
    "id": "use-search-params.mdx#7",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/search-bar.js\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function SearchBar() {\n  const searchParams = useSearchParams()\n\n  const search = searchParams.get('search')\n\n  // This will not be logged on the server when using static rendering\n  console.log(search)\n\n  return <>Search: {search}</>\n}\n```\n\n```tsx filename=\"app/dashboard/page.tsx\" switcher\nimport { Suspense } from 'react'\nimport SearchBar from './search-bar'\n\n// This component passed as a fallback to the Suspense boundary\n// will be rendered in place of the search bar in the initial HTML.\n// When the value is available during React hydration the fallback\n// will be replaced with the `<SearchBar>` component.\nfunction SearchBarFallback() {\n  return <>placeholder</>\n}\n\nexport default function Page() {\n  return (\n    <>\n      <nav>\n        <Suspense fallback={<SearchBarFallback />}>\n          <SearchBar />\n        </Suspense>\n      </nav>\n      <h1>Dashboard</h1>\n    </>\n  )\n}"
  },
  {
    "id": "use-search-params.mdx#8",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "```\n\n```jsx filename=\"app/dashboard/page.js\" switcher\nimport { Suspense } from 'react'\nimport SearchBar from './search-bar'\n\n// This component passed as a fallback to the Suspense boundary\n// will be rendered in place of the search bar in the initial HTML.\n// When the value is available during React hydration the fallback\n// will be replaced with the `<SearchBar>` component.\nfunction SearchBarFallback() {\n  return <>placeholder</>\n}\n\nexport default function Page() {\n  return (\n    <>\n      <nav>\n        <Suspense fallback={<SearchBarFallback />}>\n          <SearchBar />\n        </Suspense>\n      </nav>\n      <h1>Dashboard</h1>\n    </>\n  )\n}"
  },
  {
    "id": "use-search-params.mdx#9",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "```"
  },
  {
    "id": "use-search-params.mdx#10",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "> **Good to know**:\n>\n> - In development, routes are rendered on-demand, so `useSearchParams` doesn't suspend and things may appear to work without `Suspense`.\n> - During production builds, a [static page](/docs/app/guides/caching#static-rendering) that calls `useSearchParams` from a Client Component must be wrapped in a `Suspense` boundary, otherwise the build fails with the [Missing Suspense boundary with useSearchParams](/docs/messages/missing-suspense-with-csr-bailout) error.\n> - If you intend the route to be dynamically rendered, prefer using the [`connection`](/docs/app/api-reference/functions/connection) function first in a Server Component to wait for an incoming request, this excludes everything below from prerendering. See what makes a route dynamic in the [Dynamic Rendering guide](/docs/app/guides/caching#dynamic-rendering).\n> - If you're already in a Server Component Page, consider using the [`searchParams` prop](/docs/app/api-reference/file-conventions/page#searchparams-optional) and passing the values to Client Components."
  },
  {
    "id": "use-search-params.mdx#11",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "> - You can also pass the Page [`searchParams` prop](/docs/app/api-reference/file-conventions/page#searchparams-optional) directly to a Client Component and unwrap it with React's `use()`. Although this will suspend, so the Client Component should be wrapped with a `Suspense` boundary."
  },
  {
    "id": "use-search-params.mdx#12",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "### Dynamic Rendering\n\nIf a route is [dynamically rendered](/docs/app/guides/caching#dynamic-rendering), `useSearchParams` will be available on the server during the initial server render of the Client Component.\n\nFor example:\n\n```tsx filename=\"app/dashboard/search-bar.tsx\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function SearchBar() {\n  const searchParams = useSearchParams()\n\n  const search = searchParams.get('search')\n\n  // This will be logged on the server during the initial render\n  // and on the client on subsequent navigations.\n  console.log(search)\n\n  return <>Search: {search}</>\n}\n```\n\n```jsx filename=\"app/dashboard/search-bar.js\" switcher\n'use client'\n\nimport { useSearchParams } from 'next/navigation'\n\nexport default function SearchBar() {\n  const searchParams = useSearchParams()\n\n  const search = searchParams.get('search')\n\n  // This will be logged on the server during the initial render\n  // and on the client on subsequent navigations.\n  console.log(search)\n\n  return <>Search: {search}</>\n}"
  },
  {
    "id": "use-search-params.mdx#13",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "```\n\n```tsx filename=\"app/dashboard/page.tsx\" switcher\nimport { connection } from 'next/server'\nimport SearchBar from './search-bar'\n\nexport default async function Page() {\n  await connection()\n  return (\n    <>\n      <nav>\n        <SearchBar />\n      </nav>\n      <h1>Dashboard</h1>\n    </>\n  )\n}\n```\n\n```jsx filename=\"app/dashboard/page.js\" switcher\nimport { connection } from 'next/server'\nimport SearchBar from './search-bar'\n\nexport default async function Page() {\n  await connection()\n  return (\n    <>\n      <nav>\n        <SearchBar />\n      </nav>\n      <h1>Dashboard</h1>\n    </>\n  )\n}\n```\n\n> **Good to know**:\n>\n> - Previously, setting `export const dynamic = 'force-dynamic'` on the page was used to force dynamic rendering. Prefer using [`connection()`](/docs/app/api-reference/functions/connection) instead, as it semantically ties dynamic rendering to the incoming request."
  },
  {
    "id": "use-search-params.mdx#14",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "### Server Components\n\n#### Pages\n\nTo access search params in [Pages](/docs/app/api-reference/file-conventions/page) (Server Components), use the [`searchParams`](/docs/app/api-reference/file-conventions/page#searchparams-optional) prop.\n\n#### Layouts\n\nUnlike Pages, [Layouts](/docs/app/api-reference/file-conventions/layout) (Server Components) **do not** receive the `searchParams` prop. This is because a shared layout is [not re-rendered during navigation](/docs/app/getting-started/linking-and-navigating#client-side-transitions) which could lead to stale `searchParams` between navigations. View [detailed explanation](/docs/app/api-reference/file-conventions/layout#query-params).\n\nInstead, use the Page [`searchParams`](/docs/app/api-reference/file-conventions/page) prop or the [`useSearchParams`](/docs/app/api-reference/functions/use-search-params) hook in a Client Component, which is re-rendered on the client with the latest `searchParams`."
  },
  {
    "id": "use-search-params.mdx#15",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "## Examples"
  },
  {
    "id": "use-search-params.mdx#16",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "### Updating `searchParams`\n\nYou can use [`useRouter`](/docs/app/api-reference/functions/use-router) or [`Link`](/docs/app/api-reference/components/link) to set new `searchParams`. After a navigation is performed, the current [`page.js`](/docs/app/api-reference/file-conventions/page) will receive an updated [`searchParams` prop](/docs/app/api-reference/file-conventions/page#searchparams-optional).\n\n```tsx filename=\"app/example-client-component.tsx\" switcher\n'use client'\n\nexport default function ExampleClientComponent() {\n  const router = useRouter()\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n\n  // Get a new searchParams string by merging the current\n  // searchParams with a provided key/value pair\n  const createQueryString = useCallback(\n    (name: string, value: string) => {\n      const params = new URLSearchParams(searchParams.toString())\n      params.set(name, value)\n\n      return params.toString()\n    },\n    [searchParams]\n  )\n\n  return (\n    <>\n      <p>Sort By</p>"
  },
  {
    "id": "use-search-params.mdx#17",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "return params.toString()\n    },\n    [searchParams]\n  )\n\n  return (\n    <>\n      <p>Sort By</p>\n\n      {/* using useRouter */}\n      <button\n        onClick={() => {\n          // <pathname>?sort=asc\n          router.push(pathname + '?' + createQueryString('sort', 'asc'))\n        }}\n      >\n        ASC\n      </button>\n\n      {/* using <Link> */}\n      <Link\n        href={\n          // <pathname>?sort=desc\n          pathname + '?' + createQueryString('sort', 'desc')\n        }\n      >\n        DESC\n      </Link>\n    </>\n  )\n}"
  },
  {
    "id": "use-search-params.mdx#18",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "```\n\n```jsx filename=\"app/example-client-component.js\" switcher\n'use client'\n\nexport default function ExampleClientComponent() {\n  const router = useRouter()\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n\n  // Get a new searchParams string by merging the current\n  // searchParams with a provided key/value pair\n  const createQueryString = useCallback(\n    (name, value) => {\n      const params = new URLSearchParams(searchParams)\n      params.set(name, value)\n\n      return params.toString()\n    },\n    [searchParams]\n  )\n\n  return (\n    <>\n      <p>Sort By</p>\n\n      {/* using useRouter */}\n      <button\n        onClick={() => {\n          // <pathname>?sort=asc\n          router.push(pathname + '?' + createQueryString('sort', 'asc'))\n        }}\n      >\n        ASC\n      </button>\n\n      {/* using <Link> */}\n      <Link\n        href={\n          // <pathname>?sort=desc\n          pathname + '?' + createQueryString('sort', 'desc')\n        }\n      >\n        DESC\n      </Link>\n    </>\n  )\n}\n```"
  },
  {
    "id": "use-search-params.mdx#19",
    "metadata": {
      "title": "useSearchParams",
      "description": "API Reference for the useSearchParams hook."
    },
    "content": "## Version History\n\n| Version   | Changes                       |\n| --------- | ----------------------------- |\n| `v13.0.0` | `useSearchParams` introduced. |"
  },
  {
    "id": "use-selected-layout-segment.mdx#0",
    "metadata": {
      "title": "useSelectedLayoutSegment",
      "description": "API Reference for the useSelectedLayoutSegment hook."
    },
    "content": "---\ntitle: useSelectedLayoutSegment\ndescription: API Reference for the useSelectedLayoutSegment hook.\n---\n\n`useSelectedLayoutSegment` is a **Client Component** hook that lets you read the active route segment **one level below** the Layout it is called from.\n\nIt is useful for navigation UI, such as tabs inside a parent layout that change style depending on the active child segment.\n\n```tsx filename=\"app/example-client-component.tsx\" switcher\n'use client'\n\nimport { useSelectedLayoutSegment } from 'next/navigation'\n\nexport default function ExampleClientComponent() {\n  const segment = useSelectedLayoutSegment()\n\n  return <p>Active segment: {segment}</p>\n}\n```\n\n```jsx filename=\"app/example-client-component.js\" switcher\n'use client'\n\nimport { useSelectedLayoutSegment } from 'next/navigation'\n\nexport default function ExampleClientComponent() {\n  const segment = useSelectedLayoutSegment()\n\n  return <p>Active segment: {segment}</p>\n}"
  },
  {
    "id": "use-selected-layout-segment.mdx#1",
    "metadata": {
      "title": "useSelectedLayoutSegment",
      "description": "API Reference for the useSelectedLayoutSegment hook."
    },
    "content": "```\n\n> **Good to know**:\n>\n> - Since `useSelectedLayoutSegment` is a [Client Component](/docs/app/getting-started/server-and-client-components) hook, and Layouts are [Server Components](/docs/app/getting-started/server-and-client-components) by default, `useSelectedLayoutSegment` is usually called via a Client Component that is imported into a Layout.\n> - `useSelectedLayoutSegment` only returns the segment one level down. To return all active segments, see [`useSelectedLayoutSegments`](/docs/app/api-reference/functions/use-selected-layout-segments)"
  },
  {
    "id": "use-selected-layout-segment.mdx#2",
    "metadata": {
      "title": "useSelectedLayoutSegment",
      "description": "API Reference for the useSelectedLayoutSegment hook."
    },
    "content": "## Parameters\n\n```tsx\nconst segment = useSelectedLayoutSegment(parallelRoutesKey?: string)\n```\n\n`useSelectedLayoutSegment` _optionally_ accepts a [`parallelRoutesKey`](/docs/app/api-reference/file-conventions/parallel-routes#with-useselectedlayoutsegments), which allows you to read the active route segment within that slot.\n\n## Returns\n\n`useSelectedLayoutSegment` returns a string of the active segment or `null` if one doesn't exist.\n\nFor example, given the Layouts and URLs below, the returned segment would be:\n\n| Layout                    | Visited URL                    | Returned Segment |\n| ------------------------- | ------------------------------ | ---------------- |\n| `app/layout.js`           | `/`                            | `null`           |\n| `app/layout.js`           | `/dashboard`                   | `'dashboard'`    |\n| `app/dashboard/layout.js` | `/dashboard`                   | `null`           |\n| `app/dashboard/layout.js` | `/dashboard/settings`          | `'settings'`     |\n| `app/dashboard/layout.js` | `/dashboard/analytics`         | `'analytics'`    |\n| `app/dashboard/layout.js` | `/dashboard/analytics/monthly` | `'analytics'`    |"
  },
  {
    "id": "use-selected-layout-segment.mdx#3",
    "metadata": {
      "title": "useSelectedLayoutSegment",
      "description": "API Reference for the useSelectedLayoutSegment hook."
    },
    "content": "## Examples"
  },
  {
    "id": "use-selected-layout-segment.mdx#4",
    "metadata": {
      "title": "useSelectedLayoutSegment",
      "description": "API Reference for the useSelectedLayoutSegment hook."
    },
    "content": "### Creating an active link component\n\nYou can use `useSelectedLayoutSegment` to create an active link component that changes style depending on the active segment. For example, a featured posts list in the sidebar of a blog:\n\n```tsx filename=\"app/blog/blog-nav-link.tsx\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useSelectedLayoutSegment } from 'next/navigation'\n\n// This *client* component will be imported into a blog layout\nexport default function BlogNavLink({\n  slug,\n  children,\n}: {\n  slug: string\n  children: React.ReactNode\n}) {\n  // Navigating to `/blog/hello-world` will return 'hello-world'\n  // for the selected layout segment\n  const segment = useSelectedLayoutSegment()\n  const isActive = slug === segment\n\n  return (\n    <Link\n      href={`/blog/${slug}`}\n      // Change style depending on whether the link is active\n      style={{ fontWeight: isActive ? 'bold' : 'normal' }}\n    >\n      {children}\n    </Link>\n  )\n}"
  },
  {
    "id": "use-selected-layout-segment.mdx#5",
    "metadata": {
      "title": "useSelectedLayoutSegment",
      "description": "API Reference for the useSelectedLayoutSegment hook."
    },
    "content": "```\n\n```jsx filename=\"app/blog/blog-nav-link.js\" switcher\n'use client'\n\nimport Link from 'next/link'\nimport { useSelectedLayoutSegment } from 'next/navigation'\n\n// This *client* component will be imported into a blog layout\nexport default function BlogNavLink({ slug, children }) {\n  // Navigating to `/blog/hello-world` will return 'hello-world'\n  // for the selected layout segment\n  const segment = useSelectedLayoutSegment()\n  const isActive = slug === segment\n\n  return (\n    <Link\n      href={`/blog/${slug}`}\n      // Change style depending on whether the link is active\n      style={{ fontWeight: isActive ? 'bold' : 'normal' }}\n    >\n      {children}\n    </Link>\n  )\n}"
  },
  {
    "id": "use-selected-layout-segment.mdx#6",
    "metadata": {
      "title": "useSelectedLayoutSegment",
      "description": "API Reference for the useSelectedLayoutSegment hook."
    },
    "content": "```\n\n```tsx filename=\"app/blog/layout.tsx\" switcher\n// Import the Client Component into a parent Layout (Server Component)\nimport { BlogNavLink } from './blog-nav-link'\nimport getFeaturedPosts from './get-featured-posts'\n\nexport default async function Layout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  const featuredPosts = await getFeaturedPosts()\n  return (\n    <div>\n      {featuredPosts.map((post) => (\n        <div key={post.id}>\n          <BlogNavLink slug={post.slug}>{post.title}</BlogNavLink>\n        </div>\n      ))}\n      <div>{children}</div>\n    </div>\n  )\n}\n```\n\n```jsx filename=\"app/blog/layout.js\" switcher\n// Import the Client Component into a parent Layout (Server Component)\nimport { BlogNavLink } from './blog-nav-link'\nimport getFeaturedPosts from './get-featured-posts'\n\nexport default async function Layout({ children }) {\n  const featuredPosts = await getFeaturedPosts()\n  return (\n    <div>\n      {featuredPosts.map((post) => (\n        <div key={post.id}>\n          <BlogNavLink slug={post.slug}>{post.title}</BlogNavLink>\n        </div>\n      ))}\n      <div>{children}</div>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "use-selected-layout-segment.mdx#7",
    "metadata": {
      "title": "useSelectedLayoutSegment",
      "description": "API Reference for the useSelectedLayoutSegment hook."
    },
    "content": "## Version History\n\n| Version   | Changes                                |\n| --------- | -------------------------------------- |\n| `v13.0.0` | `useSelectedLayoutSegment` introduced. |"
  },
  {
    "id": "use-selected-layout-segments.mdx#0",
    "metadata": {
      "title": "useSelectedLayoutSegments",
      "description": "API Reference for the useSelectedLayoutSegments hook."
    },
    "content": "---\ntitle: useSelectedLayoutSegments\ndescription: API Reference for the useSelectedLayoutSegments hook.\n---\n\n`useSelectedLayoutSegments` is a **Client Component** hook that lets you read the active route segments **below** the Layout it is called from.\n\nIt is useful for creating UI in parent Layouts that need knowledge of active child segments such as breadcrumbs.\n\n```tsx filename=\"app/example-client-component.tsx\" switcher\n'use client'\n\nimport { useSelectedLayoutSegments } from 'next/navigation'\n\nexport default function ExampleClientComponent() {\n  const segments = useSelectedLayoutSegments()\n\n  return (\n    <ul>\n      {segments.map((segment, index) => (\n        <li key={index}>{segment}</li>\n      ))}\n    </ul>\n  )\n}\n```\n\n```jsx filename=\"app/example-client-component.js\" switcher\n'use client'\n\nimport { useSelectedLayoutSegments } from 'next/navigation'\n\nexport default function ExampleClientComponent() {\n  const segments = useSelectedLayoutSegments()\n\n  return (\n    <ul>\n      {segments.map((segment, index) => (\n        <li key={index}>{segment}</li>\n      ))}\n    </ul>\n  )\n}"
  },
  {
    "id": "use-selected-layout-segments.mdx#1",
    "metadata": {
      "title": "useSelectedLayoutSegments",
      "description": "API Reference for the useSelectedLayoutSegments hook."
    },
    "content": "```\n\n> **Good to know**:\n>\n> - Since `useSelectedLayoutSegments` is a [Client Component](/docs/app/getting-started/server-and-client-components) hook, and Layouts are [Server Components](/docs/app/getting-started/server-and-client-components) by default, `useSelectedLayoutSegments` is usually called via a Client Component that is imported into a Layout.\n> - The returned segments include [Route Groups](/docs/app/api-reference/file-conventions/route-groups), which you might not want to be included in your UI. You can use the [`filter`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter) array method to remove items that start with a bracket."
  },
  {
    "id": "use-selected-layout-segments.mdx#2",
    "metadata": {
      "title": "useSelectedLayoutSegments",
      "description": "API Reference for the useSelectedLayoutSegments hook."
    },
    "content": "## Parameters\n\n```tsx\nconst segments = useSelectedLayoutSegments(parallelRoutesKey?: string)\n```\n\n`useSelectedLayoutSegments` _optionally_ accepts a [`parallelRoutesKey`](/docs/app/api-reference/file-conventions/parallel-routes#with-useselectedlayoutsegments), which allows you to read the active route segment within that slot.\n\n## Returns\n\n`useSelectedLayoutSegments` returns an array of strings containing the active segments one level down from the layout the hook was called from. Or an empty array if none exist.\n\nFor example, given the Layouts and URLs below, the returned segments would be:\n\n| Layout                    | Visited URL           | Returned Segments           |\n| ------------------------- | --------------------- | --------------------------- |\n| `app/layout.js`           | `/`                   | `[]`                        |\n| `app/layout.js`           | `/dashboard`          | `['dashboard']`             |\n| `app/layout.js`           | `/dashboard/settings` | `['dashboard', 'settings']` |\n| `app/dashboard/layout.js` | `/dashboard`          | `[]`                        |\n| `app/dashboard/layout.js` | `/dashboard/settings` | `['settings']`              |"
  },
  {
    "id": "use-selected-layout-segments.mdx#3",
    "metadata": {
      "title": "useSelectedLayoutSegments",
      "description": "API Reference for the useSelectedLayoutSegments hook."
    },
    "content": "## Version History\n\n| Version   | Changes                                 |\n| --------- | --------------------------------------- |\n| `v13.0.0` | `useSelectedLayoutSegments` introduced. |"
  },
  {
    "id": "userAgent.mdx#0",
    "metadata": {
      "title": "userAgent",
      "description": "The userAgent helper extends the Web Request API with additional properties and methods to interact with the user agent object from the request."
    },
    "content": "---\ntitle: userAgent\ndescription: The userAgent helper extends the Web Request API with additional properties and methods to interact with the user agent object from the request.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nThe `userAgent` helper extends the [Web Request API](https://developer.mozilla.org/docs/Web/API/Request) with additional properties and methods to interact with the user agent object from the request.\n\n```ts filename=\"proxy.ts\" switcher\nimport { NextRequest, NextResponse, userAgent } from 'next/server'\n\nexport function proxy(request: NextRequest) {\n  const url = request.nextUrl\n  const { device } = userAgent(request)\n\n  // device.type can be: 'mobile', 'tablet', 'console', 'smarttv',\n  // 'wearable', 'embedded', or undefined (for desktop browsers)\n  const viewport = device.type || 'desktop'\n\n  url.searchParams.set('viewport', viewport)\n  return NextResponse.rewrite(url)\n}"
  },
  {
    "id": "userAgent.mdx#1",
    "metadata": {
      "title": "userAgent",
      "description": "The userAgent helper extends the Web Request API with additional properties and methods to interact with the user agent object from the request."
    },
    "content": "```\n\n```js filename=\"proxy.js\" switcher\nimport { NextResponse, userAgent } from 'next/server'\n\nexport function proxy(request) {\n  const url = request.nextUrl\n  const { device } = userAgent(request)\n\n  // device.type can be: 'mobile', 'tablet', 'console', 'smarttv',\n  // 'wearable', 'embedded', or undefined (for desktop browsers)\n  const viewport = device.type || 'desktop'\n\n  url.searchParams.set('viewport', viewport)\n  return NextResponse.rewrite(url)\n}\n```"
  },
  {
    "id": "userAgent.mdx#2",
    "metadata": {
      "title": "userAgent",
      "description": "The userAgent helper extends the Web Request API with additional properties and methods to interact with the user agent object from the request."
    },
    "content": "## `isBot`\n\nA boolean indicating whether the request comes from a known bot.\n\n## `browser`\n\nAn object containing information about the browser used in the request.\n\n- `name`: A string representing the browser's name, or `undefined` if not identifiable.\n- `version`: A string representing the browser's version, or `undefined`.\n\n## `device`\n\nAn object containing information about the device used in the request.\n\n- `model`: A string representing the model of the device, or `undefined`.\n- `type`: A string representing the type of the device, such as `console`, `mobile`, `tablet`, `smarttv`, `wearable`, `embedded`, or `undefined`.\n- `vendor`: A string representing the vendor of the device, or `undefined`.\n\n## `engine`\n\nAn object containing information about the browser's engine.\n\n- `name`: A string representing the engine's name. Possible values include: `Amaya`, `Blink`, `EdgeHTML`, `Flow`, `Gecko`, `Goanna`, `iCab`, `KHTML`, `Links`, `Lynx`, `NetFront`, `NetSurf`, `Presto`, `Tasman`, `Trident`, `w3m`, `WebKit` or `undefined`.\n- `version`: A string representing the engine's version, or `undefined`."
  },
  {
    "id": "userAgent.mdx#3",
    "metadata": {
      "title": "userAgent",
      "description": "The userAgent helper extends the Web Request API with additional properties and methods to interact with the user agent object from the request."
    },
    "content": "## `os`\n\nAn object containing information about the operating system.\n\n- `name`: A string representing the name of the OS, or `undefined`.\n- `version`: A string representing the version of the OS, or `undefined`.\n\n## `cpu`\n\nAn object containing information about the CPU architecture.\n\n- `architecture`: A string representing the architecture of the CPU. Possible values include: `68k`, `amd64`, `arm`, `arm64`, `armhf`, `avr`, `ia32`, `ia64`, `irix`, `irix64`, `mips`, `mips64`, `pa-risc`, `ppc`, `sparc`, `sparc64` or `undefined`"
  },
  {
    "id": "adapterPath.mdx#0",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "---\ntitle: experimental.adapterPath\ndescription: Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks.\n---\n\nNext.js provides an experimental API that allows you to create custom adapters to hook into the build process. This is useful for deployment platforms or custom build integrations that need to modify the Next.js configuration or process the build output.\n\n## Configuration\n\nTo use an adapter, specify the path to your adapter module in `experimental.adapterPath`:\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    adapterPath: require.resolve('./my-adapter.js'),\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "adapterPath.mdx#1",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "## Creating an Adapter\n\nAn adapter is a module that exports an object implementing the `NextAdapter` interface:\n\n```typescript\nexport interface NextAdapter {\n  name: string\n  modifyConfig?: (\n    config: NextConfigComplete,\n    ctx: {\n      phase: PHASE_TYPE\n    }\n  ) => Promise<NextConfigComplete> | NextConfigComplete\n  onBuildComplete?: (ctx: {\n    routes: {\n      headers: Array<ManifestHeaderRoute>\n      redirects: Array<ManifestRedirectRoute>\n      rewrites: {\n        beforeFiles: Array<ManifestRewriteRoute>\n        afterFiles: Array<ManifestRewriteRoute>\n        fallback: Array<ManifestRewriteRoute>\n      }\n      dynamicRoutes: ReadonlyArray<ManifestRoute>\n    }\n    outputs: AdapterOutputs\n    projectDir: string\n    repoRoot: string\n    distDir: string\n    config: NextConfigComplete\n    nextVersion: string\n  }) => Promise<void> | void\n}\n```"
  },
  {
    "id": "adapterPath.mdx#2",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "### Basic Adapter Structure\n\nHere's a minimal adapter example:\n\n```js filename=\"my-adapter.js\"\n/** @type {import('next').NextAdapter} */\nconst adapter = {\n  name: 'my-custom-adapter',\n\n  async modifyConfig(config, { phase }) {\n    // Modify the Next.js config based on the build phase\n    if (phase === 'phase-production-build') {\n      return {\n        ...config,\n        // Add your modifications\n      }\n    }\n    return config\n  },\n\n  async onBuildComplete({\n    routes,\n    outputs,\n    projectDir,\n    repoRoot,\n    distDir,\n    config,\n    nextVersion,\n  }) {\n    // Process the build output\n    console.log('Build completed with', outputs.pages.length, 'pages')\n\n    // Access different output types\n    for (const page of outputs.pages) {\n      console.log('Page:', page.pathname, 'at', page.filePath)\n    }\n\n    for (const apiRoute of outputs.pagesApi) {\n      console.log('API Route:', apiRoute.pathname, 'at', apiRoute.filePath)\n    }\n\n    for (const appPage of outputs.appPages) {\n      console.log('App Page:', appPage.pathname, 'at', appPage.filePath)\n    }\n\n    for (const prerender of outputs.prerenders) {\n      console.log('Prerendered:', prerender.pathname)\n    }\n  },\n}"
  },
  {
    "id": "adapterPath.mdx#3",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "for (const prerender of outputs.prerenders) {\n      console.log('Prerendered:', prerender.pathname)\n    }\n  },\n}\n\nmodule.exports = adapter\n```"
  },
  {
    "id": "adapterPath.mdx#4",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "## API Reference\n\n### `modifyConfig(config, context)`\n\nCalled for any CLI command that loads the next.config to allow modification of the configuration.\n\n**Parameters:**\n\n- `config`: The complete Next.js configuration object\n- `context.phase`: The current build phase (see [phases](/docs/app/api-reference/config/next-config-js#phase))\n\n**Returns:** The modified configuration object (can be async)"
  },
  {
    "id": "adapterPath.mdx#5",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "### `onBuildComplete(context)`\n\nCalled after the build process completes with detailed information about routes and outputs.\n\n**Parameters:**"
  },
  {
    "id": "adapterPath.mdx#6",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "**Parameters:**\n\n- `routes`: Object containing route manifests for headers, redirects, rewrites, and dynamic routes\n  - `routes.headers`: Array of header route objects with `source`, `sourceRegex`, `headers`, `has`, `missing`, and optional `priority` fields\n  - `routes.redirects`: Array of redirect route objects with `source`, `sourceRegex`, `destination`, `statusCode`, `has`, `missing`, and optional `priority` fields\n  - `routes.rewrites`: Object with `beforeFiles`, `afterFiles`, and `fallback` arrays, each containing rewrite route objects with `source`, `sourceRegex`, `destination`, `has`, and `missing` fields\n  - `routes.dynamicRoutes`: Array of dynamic route objects with `source`, `sourceRegex`, `destination`, `has`, and `missing` fields\n- `outputs`: Detailed information about all build outputs organized by type\n- `projectDir`: Absolute path to the Next.js project directory\n- `repoRoot`: Absolute path to the detected repository root\n- `distDir`: Absolute path to the build output directory\n- `config`: The final Next.js configuration (with `modifyConfig` applied)\n- `nextVersion`: Version of Next.js being used\n- `buildId`: Unique identifier for the current build"
  },
  {
    "id": "adapterPath.mdx#7",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "## Output Types\n\nThe `outputs` object contains arrays of different output types:\n\n### Pages (`outputs.pages`)\n\nReact pages from the `pages/` directory:\n\n```typescript\n{\n  type: 'PAGES'\n  id: string           // Route identifier\n  filePath: string     // Path to the built file\n  pathname: string     // URL pathname\n  sourcePage: string   // Original source file path in pages/ directory\n  runtime: 'nodejs' | 'edge'\n  assets: Record<string, string>  // Traced dependencies (key: relative path from repo root, value: absolute path)\n  wasmAssets?: Record<string, string>  // Bundled wasm files (key: name, value: absolute path)\n  config: {\n    maxDuration?: number\n    preferredRegion?: string | string[]\n    env?: Record<string, string>  // Environment variables (edge runtime only)\n  }\n}\n```"
  },
  {
    "id": "adapterPath.mdx#8",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "### API Routes (`outputs.pagesApi`)\n\nAPI routes from `pages/api/`:\n\n```typescript\n{\n  type: 'PAGES_API'\n  id: string\n  filePath: string\n  pathname: string\n  sourcePage: string   // Original relative source file path\n  runtime: 'nodejs' | 'edge'\n  assets: Record<string, string>\n  wasmAssets?: Record<string, string>\n  config: {\n    maxDuration?: number\n    preferredRegion?: string | string[]\n    env?: Record<string, string>\n  }\n}\n```\n\n### App Pages (`outputs.appPages`)\n\nReact pages from the `app/` directory with `page.{js,ts,jsx,tsx}`:\n\n```typescript\n{\n  type: 'APP_PAGE'\n  id: string\n  filePath: string\n  pathname: string     // Includes .rsc suffix for RSC routes\n  sourcePage: string   // Original relative source file path\n  runtime: 'nodejs' | 'edge'\n  assets: Record<string, string>\n  wasmAssets?: Record<string, string>\n  config: {\n    maxDuration?: number\n    preferredRegion?: string | string[]\n    env?: Record<string, string>\n  }\n}\n```"
  },
  {
    "id": "adapterPath.mdx#9",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "### App Routes (`outputs.appRoutes`)\n\nAPI and metadata routes from `app/` with `route.{js,ts,jsx,tsx}`:\n\n```typescript\n{\n  type: 'APP_ROUTE'\n  id: string\n  filePath: string\n  pathname: string\n  sourcePage: string\n  runtime: 'nodejs' | 'edge'\n  assets: Record<string, string>\n  wasmAssets?: Record<string, string>\n  config: {\n    maxDuration?: number\n    preferredRegion?: string | string[]\n    env?: Record<string, string>\n  }\n}\n```"
  },
  {
    "id": "adapterPath.mdx#10",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "### Prerenders (`outputs.prerenders`)\n\nISR-enabled routes and static prerenders:\n\n```typescript\n{\n  type: 'PRERENDER'\n  id: string\n  pathname: string\n  parentOutputId: string  // ID of the source page/route\n  groupId: number        // Revalidation group identifier (prerenders with same groupId revalidate together)\n  pprChain?: {\n    headers: Record<string, string>  // PPR chain headers (e.g., 'x-nextjs-resume': '1')\n  }\n  parentFallbackMode?: 'blocking' | false | null  // Fallback mode from getStaticPaths\n  fallback?: {\n    filePath: string\n    initialStatus?: number\n    initialHeaders?: Record<string, string | string[]>\n    initialExpiration?: number\n    initialRevalidate?: number\n    postponedState?: string  // PPR postponed state\n  }\n  config: {\n    allowQuery?: string[]     // Allowed query parameters\n    allowHeader?: string[]    // Allowed headers for ISR\n    bypassFor?: RouteHas[]    // Cache bypass conditions\n    renderingMode?: RenderingMode\n    bypassToken?: string\n  }\n}\n```\n\n### Static Files (`outputs.staticFiles`)\n\nStatic assets and auto-statically optimized pages:\n\n```typescript\n{\n  type: 'STATIC_FILE'\n  id: string\n  filePath: string\n  pathname: string\n}\n```"
  },
  {
    "id": "adapterPath.mdx#11",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "### Static Files (`outputs.staticFiles`)\n\nStatic assets and auto-statically optimized pages:\n\n```typescript\n{\n  type: 'STATIC_FILE'\n  id: string\n  filePath: string\n  pathname: string\n}\n```\n\n### Middleware (`outputs.middleware`)\n\nMiddleware function (if present):\n\n```typescript\n{\n  type: 'MIDDLEWARE'\n  id: string\n  filePath: string\n  pathname: string      // Always '/_middleware'\n  sourcePage: string    // Always 'middleware'\n  runtime: 'nodejs' | 'edge'\n  assets: Record<string, string>\n  wasmAssets?: Record<string, string>\n  config: {\n    maxDuration?: number\n    preferredRegion?: string | string[]\n    env?: Record<string, string>\n    matchers?: Array<{\n      source: string\n      sourceRegex: string\n      has: RouteHas[] | undefined\n      missing: RouteHas[] | undefined\n    }>\n  }\n}\n```"
  },
  {
    "id": "adapterPath.mdx#12",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "## Routes Information\n\nThe `routes` object in `onBuildComplete` provides complete routing information with processed patterns ready for deployment:\n\n### Headers\n\nEach header route includes:\n\n- `source`: Original route pattern (e.g., `/about`)\n- `sourceRegex`: Compiled regex for matching requests\n- `headers`: Key-value pairs of headers to apply\n- `has`: Optional conditions that must be met\n- `missing`: Optional conditions that must not be met\n- `priority`: Optional flag for internal routes\n\n### Redirects\n\nEach redirect route includes:\n\n- `source`: Original route pattern\n- `sourceRegex`: Compiled regex for matching\n- `destination`: Target URL (can include captured groups)\n- `statusCode`: HTTP status code (301, 302, 307, 308)\n- `has`: Optional positive conditions\n- `missing`: Optional negative conditions\n- `priority`: Optional flag for internal routes"
  },
  {
    "id": "adapterPath.mdx#13",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "### Rewrites\n\nRewrites are categorized into three phases:\n\n- `beforeFiles`: Checked before filesystem (including pages and public files)\n- `afterFiles`: Checked after pages/public files but before dynamic routes\n- `fallback`: Checked after all other routes\n\nEach rewrite includes `source`, `sourceRegex`, `destination`, `has`, and `missing`.\n\n### Dynamic Routes\n\nGenerated from dynamic route segments (e.g., `[slug]`, `[...path]`). Each includes:\n\n- `source`: Route pattern\n- `sourceRegex`: Compiled regex with named capture groups\n- `destination`: Internal destination with parameter substitution\n- `has`: Optional positive conditions\n- `missing`: Optional negative conditions"
  },
  {
    "id": "adapterPath.mdx#14",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and onBuildComplete callbacks."
    },
    "content": "## Use Cases\n\nCommon use cases for adapters include:\n\n- **Deployment Platform Integration**: Automatically configure build outputs for specific hosting platforms\n- **Asset Processing**: Transform or optimize build outputs\n- **Monitoring Integration**: Collect build metrics and route information\n- **Custom Bundling**: Package outputs in platform-specific formats\n- **Build Validation**: Ensure outputs meet specific requirements\n- **Route Generation**: Use processed route information to generate platform-specific routing configs"
  },
  {
    "id": "allowedDevOrigins.mdx#0",
    "metadata": {
      "title": "allowedDevOrigins",
      "description": "Use `allowedDevOrigins` to configure additional origins that can request the dev server."
    },
    "content": "---\ntitle: allowedDevOrigins\ndescription: Use `allowedDevOrigins` to configure additional origins that can request the dev server.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js does not automatically block cross-origin requests during development, but will block by default in a future major version of Next.js to prevent unauthorized requesting of internal assets/endpoints that are available in development mode.\n\nTo configure a Next.js application to allow requests from origins other than the hostname the server was initialized with (`localhost` by default) you can use the `allowedDevOrigins` config option.\n\n`allowedDevOrigins` allows you to set additional origins that can be used in development mode. For example, to use `local-origin.dev` instead of only `localhost`, open `next.config.js` and add the `allowedDevOrigins` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  allowedDevOrigins: ['local-origin.dev', '*.local-origin.dev'],\n}\n```"
  },
  {
    "id": "appDir.mdx#0",
    "metadata": {
      "title": "appDir",
      "description": "Enable the App Router to use layouts, streaming, and more."
    },
    "content": "---\ntitle: appDir\ndescription: Enable the App Router to use layouts, streaming, and more.\nversion: legacy\n---\n\n> **Good to know**: This option is **no longer** needed as of Next.js 13.4. The App Router is now stable.\n\nThe App Router ([`app` directory](/docs/app)) enables support for [layouts](/docs/app/api-reference/file-conventions/layout), [Server Components](/docs/app/getting-started/server-and-client-components), [streaming](/docs/app/api-reference/file-conventions/loading), and [colocated data fetching](/docs/app/getting-started/fetching-data).\n\nUsing the `app` directory will automatically enable [React Strict Mode](https://react.dev/reference/react/StrictMode). Learn how to [incrementally adopt `app`](/docs/app/guides/migrating/app-router-migration#migrating-from-pages-to-app)."
  },
  {
    "id": "assetPrefix.mdx#0",
    "metadata": {
      "title": "assetPrefix",
      "description": "Learn how to use the assetPrefix config option to configure your CDN."
    },
    "content": "---\ntitle: assetPrefix\ndescription: Learn how to use the assetPrefix config option to configure your CDN.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n<AppOnly>\n\n> **Attention**: [Deploying to Vercel](/docs/app/getting-started/deploying) automatically configures a global CDN for your Next.js project.\n> You do not need to manually setup an Asset Prefix.\n\n</AppOnly>\n\n<PagesOnly>\n\n> **Attention**: [Deploying to Vercel](/docs/pages/getting-started/deploying) automatically configures a global CDN for your Next.js project.\n> You do not need to manually setup an Asset Prefix.\n\n</PagesOnly>\n\n> **Good to know**: Next.js 9.5+ added support for a customizable [Base Path](/docs/app/api-reference/config/next-config-js/basePath), which is better\n> suited for hosting your application on a sub-path like `/docs`.\n> We do not suggest you use a custom Asset Prefix for this use case."
  },
  {
    "id": "assetPrefix.mdx#1",
    "metadata": {
      "title": "assetPrefix",
      "description": "Learn how to use the assetPrefix config option to configure your CDN."
    },
    "content": "## Set up a CDN\n\nTo set up a [CDN](https://en.wikipedia.org/wiki/Content_delivery_network), you can set up an asset prefix and configure your CDN's origin to resolve to the domain that Next.js is hosted on.\n\nOpen `next.config.mjs` and add the `assetPrefix` config based on the [phase](/docs/app/api-reference/config/next-config-js#async-configuration):\n\n```js filename=\"next.config.mjs\"\n// @ts-check\nimport { PHASE_DEVELOPMENT_SERVER } from 'next/constants'\n\nexport default (phase) => {\n  const isDev = phase === PHASE_DEVELOPMENT_SERVER\n  /**\n   * @type {import('next').NextConfig}\n   */\n  const nextConfig = {\n    assetPrefix: isDev ? undefined : 'https://cdn.mydomain.com',\n  }\n  return nextConfig\n}\n```\n\nNext.js will automatically use your asset prefix for the JavaScript and CSS files it loads from the `/_next/` path (`.next/static/` folder). For example, with the above configuration, the following request for a JS chunk:\n\n```\n/_next/static/chunks/4b9b41aaa062cbbfeff4add70f256968c51ece5d.4d708494b3aed70c04f0.js\n```\n\nWould instead become:\n\n```\nhttps://cdn.mydomain.com/_next/static/chunks/4b9b41aaa062cbbfeff4add70f256968c51ece5d.4d708494b3aed70c04f0.js"
  },
  {
    "id": "assetPrefix.mdx#2",
    "metadata": {
      "title": "assetPrefix",
      "description": "Learn how to use the assetPrefix config option to configure your CDN."
    },
    "content": "```\n\nThe exact configuration for uploading your files to a given CDN will depend on your CDN of choice. The only folder you need to host on your CDN is the contents of `.next/static/`, which should be uploaded as `_next/static/` as the above URL request indicates. **Do not upload the rest of your `.next/` folder**, as you should not expose your server code and other configuration to the public.\n\nWhile `assetPrefix` covers requests to `_next/static`, it does not influence the following paths:\n\n<AppOnly>\n\n- Files in the [public](/docs/app/api-reference/file-conventions/public-folder) folder; if you want to serve those assets over a CDN, you'll have to introduce the prefix yourself\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "assetPrefix.mdx#3",
    "metadata": {
      "title": "assetPrefix",
      "description": "Learn how to use the assetPrefix config option to configure your CDN."
    },
    "content": "</AppOnly>\n\n<PagesOnly>\n\n- Files in the [public](/docs/pages/api-reference/file-conventions/public-folder) folder; if you want to serve those assets over a CDN, you'll have to introduce the prefix yourself\n- `/_next/data/` requests for `getServerSideProps` pages. These requests will always be made against the main domain since they're not static.\n- `/_next/data/` requests for `getStaticProps` pages. These requests will always be made against the main domain to support [Incremental Static Generation](/docs/pages/guides/incremental-static-regeneration), even if you're not using it (for consistency).\n\n</PagesOnly>"
  },
  {
    "id": "authInterrupts.mdx#0",
    "metadata": {
      "title": "authInterrupts",
      "description": "Learn how to enable the experimental `authInterrupts` configuration option to use `forbidden` and `unauthorized`."
    },
    "content": "---\ntitle: authInterrupts\ndescription: Learn how to enable the experimental `authInterrupts` configuration option to use `forbidden` and `unauthorized`.\nversion: canary\nrelated:\n  links:\n    - app/api-reference/functions/forbidden\n    - app/api-reference/functions/unauthorized\n    - app/api-reference/file-conventions/forbidden\n    - app/api-reference/file-conventions/unauthorized\n---\n\nThe `authInterrupts` configuration option allows you to use [`forbidden`](/docs/app/api-reference/functions/forbidden) and [`unauthorized`](/docs/app/api-reference/functions/unauthorized) APIs in your application. While these functions are experimental, you must enable the `authInterrupts` option in your `next.config.js` file to use them:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    authInterrupts: true,\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  experimental: {\n    authInterrupts: true,\n  },\n}\n```"
  },
  {
    "id": "basePath.mdx#0",
    "metadata": {
      "title": "basePath",
      "description": "Use `basePath` to deploy a Next.js application under a sub-path of a domain."
    },
    "content": "---\ntitle: basePath\ndescription: Use `basePath` to deploy a Next.js application under a sub-path of a domain.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nTo deploy a Next.js application under a sub-path of a domain you can use the `basePath` config option.\n\n`basePath` allows you to set a path prefix for the application. For example, to use `/docs` instead of `''` (an empty string, the default), open `next.config.js` and add the `basePath` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  basePath: '/docs',\n}\n```\n\n> **Good to know**: This value must be set at build time and cannot be changed without re-building as the value is inlined in the client-side bundles."
  },
  {
    "id": "basePath.mdx#1",
    "metadata": {
      "title": "basePath",
      "description": "Use `basePath` to deploy a Next.js application under a sub-path of a domain."
    },
    "content": "### Links\n\nWhen linking to other pages using `next/link` and `next/router` the `basePath` will be automatically applied.\n\nFor example, using `/about` will automatically become `/docs/about` when `basePath` is set to `/docs`.\n\n```js\nexport default function HomePage() {\n  return (\n    <>\n      <Link href=\"/about\">About Page</Link>\n    </>\n  )\n}\n```\n\nOutput html:\n\n```html\n<a href=\"/docs/about\">About Page</a>\n```\n\nThis makes sure that you don't have to change all links in your application when changing the `basePath` value."
  },
  {
    "id": "basePath.mdx#2",
    "metadata": {
      "title": "basePath",
      "description": "Use `basePath` to deploy a Next.js application under a sub-path of a domain."
    },
    "content": "### Images\n\n<AppOnly>\n\nWhen using the [`next/image`](/docs/app/api-reference/components/image) component, you will need to add the `basePath` in front of `src`.\n\n</AppOnly>\n\n<PagesOnly>\n\nWhen using the [`next/image`](/docs/pages/api-reference/components/image) component, you will need to add the `basePath` in front of `src`.\n\n</PagesOnly>\n\nFor example, using `/docs/me.png` will properly serve your image when `basePath` is set to `/docs`.\n\n```jsx\nimport Image from 'next/image'\n\nfunction Home() {\n  return (\n    <>\n      <h1>My Homepage</h1>\n      <Image\n        src=\"/docs/me.png\"\n        alt=\"Picture of the author\"\n        width={500}\n        height={500}\n      />\n      <p>Welcome to my homepage!</p>\n    </>\n  )\n}\n\nexport default Home\n```"
  },
  {
    "id": "browserDebugInfoInTerminal.mdx#0",
    "metadata": {
      "title": "browserDebugInfoInTerminal",
      "description": "Forward browser console logs and errors to your terminal during development."
    },
    "content": "---\ntitle: browserDebugInfoInTerminal\ndescription: Forward browser console logs and errors to your terminal during development.\nversion: experimental\n---\n\nThe `experimental.browserDebugInfoInTerminal` option forwards console output and runtime errors originating in the browser to the dev server terminal.\n\nThis option is disabled by default. When enabled it only works in development mode."
  },
  {
    "id": "browserDebugInfoInTerminal.mdx#1",
    "metadata": {
      "title": "browserDebugInfoInTerminal",
      "description": "Forward browser console logs and errors to your terminal during development."
    },
    "content": "## Usage\n\nEnable forwarding:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    browserDebugInfoInTerminal: true,\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    browserDebugInfoInTerminal: true,\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "browserDebugInfoInTerminal.mdx#2",
    "metadata": {
      "title": "browserDebugInfoInTerminal",
      "description": "Forward browser console logs and errors to your terminal during development."
    },
    "content": "### Serialization limits\n\nDeeply nested objects/arrays are truncated using **sensible defaults**. You can tweak these limits:\n\n- **depthLimit**: (optional) Limit stringification depth for nested objects/arrays. Default: 5\n- **edgeLimit**: (optional) Max number of properties or elements to include per object or array. Default: 100\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    browserDebugInfoInTerminal: {\n      depthLimit: 5,\n      edgeLimit: 100,\n    },\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    browserDebugInfoInTerminal: {\n      depthLimit: 5,\n      edgeLimit: 100,\n    },\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "browserDebugInfoInTerminal.mdx#3",
    "metadata": {
      "title": "browserDebugInfoInTerminal",
      "description": "Forward browser console logs and errors to your terminal during development."
    },
    "content": "### Source location\n\nSource locations are included by default when this feature is enabled.\n\n```tsx filename=\"app/page.tsx\" highlight={8}\n'use client'\n\nexport default function Home() {\n  return (\n    <button\n      type=\"button\"\n      onClick={() => {\n        console.log('Hello World')\n      }}\n    >\n      Click me\n    </button>\n  )\n}\n```\n\nClicking the button prints this message to the terminal.\n\n```bash filename=\"Terminal\"\n[browser] Hello World (app/page.tsx:8:17)\n```\n\nTo suppress them, set `showSourceLocation: false`.\n\n- **showSourceLocation**: Include source location info when available.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    browserDebugInfoInTerminal: {\n      showSourceLocation: false,\n    },\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    browserDebugInfoInTerminal: {\n      showSourceLocation: false,\n    },\n  },\n}\n\nmodule.exports = nextConfig"
  },
  {
    "id": "browserDebugInfoInTerminal.mdx#4",
    "metadata": {
      "title": "browserDebugInfoInTerminal",
      "description": "Forward browser console logs and errors to your terminal during development."
    },
    "content": "```\n\n| Version   | Changes                                              |\n| --------- | ---------------------------------------------------- |\n| `v15.4.0` | experimental `browserDebugInfoInTerminal` introduced |"
  },
  {
    "id": "cacheComponents.mdx#0",
    "metadata": {
      "title": "cacheComponents",
      "description": "Learn how to enable the cacheComponents flag in Next.js."
    },
    "content": "---\ntitle: cacheComponents\ndescription: Learn how to enable the cacheComponents flag in Next.js.\n---\n\nThe `cacheComponents` flag is a feature in Next.js that causes data fetching operations in the App Router to be excluded from pre-renders unless they are explicitly cached. This can be useful for optimizing the performance of dynamic data fetching in Server Components.\n\nIt is useful if your application requires fresh data fetching during runtime rather than serving from a pre-rendered cache.\n\nIt is expected to be used in conjunction with [`use cache`](/docs/app/api-reference/directives/use-cache) so that your data fetching happens at runtime by default unless you define specific parts of your application to be cached with `use cache` at the page, function, or component level."
  },
  {
    "id": "cacheComponents.mdx#1",
    "metadata": {
      "title": "cacheComponents",
      "description": "Learn how to enable the cacheComponents flag in Next.js."
    },
    "content": "## Usage\n\nTo enable the `cacheComponents` flag, set it to `true` in your `next.config.ts` file:\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  cacheComponents: true,\n}\n\nexport default nextConfig\n```\n\nWhen `cacheComponents` is enabled, you can use the following cache functions and configurations:\n\n- The [`use cache` directive](/docs/app/api-reference/directives/use-cache)\n- The [`cacheLife` function](/docs/app/api-reference/config/next-config-js/cacheLife) with `use cache`\n- The [`cacheTag` function](/docs/app/api-reference/functions/cacheTag)\n\n## Notes\n\n- While `cacheComponents` can optimize performance by ensuring fresh data fetching during runtime, it may also introduce additional latency compared to serving pre-rendered content."
  },
  {
    "id": "cacheComponents.mdx#2",
    "metadata": {
      "title": "cacheComponents",
      "description": "Learn how to enable the cacheComponents flag in Next.js."
    },
    "content": "## Notes\n\n- While `cacheComponents` can optimize performance by ensuring fresh data fetching during runtime, it may also introduce additional latency compared to serving pre-rendered content.\n\n## Version History\n\n| Version | Change                                                                                                                            |\n| ------- | --------------------------------------------------------------------------------------------------------------------------------- |\n| 16.0.0  | `cacheComponents` introduced. This flag controls the `ppr`, `useCache`, and `dynamicIO` flags as a single, unified configuration. |"
  },
  {
    "id": "cacheHandlers.mdx#0",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "---\ntitle: cacheHandlers\ndescription: Configure custom cache handlers for use cache directives in Next.js.\nrelated:\n  title: Related\n  description: View related API references.\n  links:\n    - app/api-reference/directives/use-cache\n    - app/api-reference/directives/use-cache-remote\n    - app/api-reference/directives/use-cache-private\n    - app/api-reference/config/next-config-js/cacheLife\n---\n\nThe `cacheHandlers` configuration allows you to define custom cache storage implementations for [`'use cache'`](/docs/app/api-reference/directives/use-cache) and [`'use cache: remote'`](/docs/app/api-reference/directives/use-cache-remote). This enables you to store cached components and functions in external services or customize the caching behavior. [`'use cache: private'`](/docs/app/api-reference/directives/use-cache-private) is not configurable."
  },
  {
    "id": "cacheHandlers.mdx#1",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "## When to use custom cache handlers\n\n**Most applications don't need custom cache handlers.** The default in-memory cache works well in the typical use case.\n\nCustom cache handlers are for advanced scenarios where you need to either share cache across multiple instances or change where the cache is stored. For example, you can configure a custom `remote` handler for external storage (like a key-value store), then use `'use cache'` in your code for in-memory caching and `'use cache: remote'` for the external storage, allowing different caching strategies within the same application.\n\n**Sharing cache across instances**\n\nThe default in-memory cache is isolated to each Next.js process. If you're running multiple servers or containers, each instance will have its own cache that isn't shared with others and is lost on restart.\n\nCustom handlers let you integrate with shared storage systems (like Redis, Memcached, or DynamoDB) that all your Next.js instances can access.\n\n**Changing storage type**"
  },
  {
    "id": "cacheHandlers.mdx#2",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "Custom handlers let you integrate with shared storage systems (like Redis, Memcached, or DynamoDB) that all your Next.js instances can access.\n\n**Changing storage type**\n\nYou might want to store cache differently than the default in-memory approach. You can implement a custom handler to store cache on disk, in a database, or in an external caching service. Reasons include: persistence across restarts, reducing memory usage, or integrating with existing infrastructure."
  },
  {
    "id": "cacheHandlers.mdx#3",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "## Usage\n\nTo configure custom cache handlers:\n\n1. Define your cache handler in a separate file, see [examples](#examples) for implementation details.\n2. Reference the file path in your Next config file\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  cacheHandlers: {\n    default: require.resolve('./cache-handlers/default-handler.js'),\n    remote: require.resolve('./cache-handlers/remote-handler.js'),\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  cacheHandlers: {\n    default: require.resolve('./cache-handlers/default-handler.js'),\n    remote: require.resolve('./cache-handlers/remote-handler.js'),\n  },\n}\n```"
  },
  {
    "id": "cacheHandlers.mdx#4",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "### Handler types\n\n- **`default`**: Used by the `'use cache'` directive\n- **`remote`**: Used by the `'use cache: remote'` directive\n\nIf you don't configure `cacheHandlers`, Next.js uses an in-memory LRU (Least Recently Used) cache for both `default` and `remote`. You can view the [default implementation](https://github.com/vercel/next.js/blob/canary/packages/next/src/server/lib/cache-handlers/default.ts) as a reference.\n\nYou can also define additional named handlers (e.g., `sessions`, `analytics`) and reference them with `'use cache: <name>'`.\n\nNote that `'use cache: private'` does not use cache handlers and cannot be customized."
  },
  {
    "id": "cacheHandlers.mdx#5",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "## API Reference\n\nA cache handler must implement the [`CacheHandler`](https://github.com/vercel/next.js/blob/canary/packages/next/src/server/lib/cache-handlers/types.ts) interface with the following methods:"
  },
  {
    "id": "cacheHandlers.mdx#6",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "### `get()`\n\nRetrieve a cache entry for the given cache key.\n\n```ts\nget(cacheKey: string, softTags: string[]): Promise<CacheEntry | undefined>\n```\n\n| Parameter  | Type       | Description                                                  |\n| ---------- | ---------- | ------------------------------------------------------------ |\n| `cacheKey` | `string`   | The unique key for the cache entry.                          |\n| `softTags` | `string[]` | Tags to check for staleness (used in some cache strategies). |\n\nReturns a `CacheEntry` object if found, or `undefined` if not found or expired.\n\nYour `get` method should retrieve the cache entry from storage, check if it has expired based on the `revalidate` time, and return `undefined` for missing or expired entries.\n\n```js\nconst cacheHandler = {\n  async get(cacheKey, softTags) {\n    const entry = cache.get(cacheKey)\n    if (!entry) return undefined\n\n    // Check if expired\n    const now = Date.now()\n    if (now > entry.timestamp + entry.revalidate * 1000) {\n      return undefined\n    }\n\n    return entry\n  },\n}\n```"
  },
  {
    "id": "cacheHandlers.mdx#7",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "### `set()`\n\nStore a cache entry for the given cache key.\n\n```ts\nset(cacheKey: string, pendingEntry: Promise<CacheEntry>): Promise<void>\n```\n\n| Parameter      | Type                  | Description                                 |\n| -------------- | --------------------- | ------------------------------------------- |\n| `cacheKey`     | `string`              | The unique key to store the entry under.    |\n| `pendingEntry` | `Promise<CacheEntry>` | A promise that resolves to the cache entry. |\n\nThe entry may still be pending when this is called (i.e., its value stream may still be written to). Your handler should await the promise before processing the entry.\n\nReturns `Promise<void>`.\n\nYour `set` method must await the `pendingEntry` promise before storing it, since the cache entry may still be generating when this method is called. Once resolved, store the entry in your cache system.\n\n```js\nconst cacheHandler = {\n  async set(cacheKey, pendingEntry) {\n    // Wait for the entry to be ready\n    const entry = await pendingEntry\n\n    // Store in your cache system\n    cache.set(cacheKey, entry)\n  },\n}\n```"
  },
  {
    "id": "cacheHandlers.mdx#8",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "### `refreshTags()`\n\nCalled periodically before starting a new request to sync with external tag services.\n\n```ts\nrefreshTags(): Promise<void>\n```\n\nThis is useful if you're coordinating cache invalidation across multiple instances or services. For in-memory caches, this can be a no-op.\n\nReturns `Promise<void>`.\n\nFor in-memory caches, this can be a no-op. For distributed caches, use this to sync tag state from an external service or database before processing requests.\n\n```js\nconst cacheHandler = {\n  async refreshTags() {\n    // For in-memory cache, no action needed\n    // For distributed cache, sync tag state from external service\n  },\n}\n```"
  },
  {
    "id": "cacheHandlers.mdx#9",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "### `getExpiration()`\n\nGet the maximum revalidation timestamp for a set of tags.\n\n```ts\ngetExpiration(tags: string[]): Promise<number>\n```\n\n| Parameter | Type       | Description                            |\n| --------- | ---------- | -------------------------------------- |\n| `tags`    | `string[]` | Array of tags to check expiration for. |\n\nReturns:\n\n- `0` if none of the tags were ever revalidated\n- A timestamp (in milliseconds) representing the most recent revalidation\n- `Infinity` to indicate soft tags should be checked in the `get` method instead\n\nIf you're not tracking tag revalidation timestamps, return `0`. Otherwise, find the most recent revalidation timestamp across all the provided tags. Return `Infinity` if you prefer to handle soft tag checking in the `get` method.\n\n```js\nconst cacheHandler = {\n  async getExpiration(tags) {\n    // Return 0 if not tracking tag revalidation\n    return 0\n\n    // Or return the most recent revalidation timestamp\n    // return Math.max(...tags.map(tag => tagTimestamps.get(tag) || 0));\n  },\n}\n```"
  },
  {
    "id": "cacheHandlers.mdx#10",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "### `updateTags()`\n\nCalled when tags are revalidated or expired.\n\n```ts\nupdateTags(tags: string[], durations?: { expire?: number }): Promise<void>\n```\n\n| Parameter   | Type                  | Description                              |\n| ----------- | --------------------- | ---------------------------------------- |\n| `tags`      | `string[]`            | Array of tags to update.                 |\n| `durations` | `{ expire?: number }` | Optional expiration duration in seconds. |\n\nYour handler should update its internal state to mark these tags as invalidated.\n\nReturns `Promise<void>`.\n\nWhen tags are revalidated, your handler should invalidate all cache entries that have any of those tags. Iterate through your cache and remove entries whose tags match the provided list.\n\n```js\nconst cacheHandler = {\n  async updateTags(tags, durations) {\n    // Invalidate all cache entries with matching tags\n    for (const [key, entry] of cache.entries()) {\n      if (entry.tags.some((tag) => tags.includes(tag))) {\n        cache.delete(key)\n      }\n    }\n  },\n}\n```"
  },
  {
    "id": "cacheHandlers.mdx#11",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "## CacheEntry Type\n\nThe [`CacheEntry`](https://github.com/vercel/next.js/blob/canary/packages/next/src/server/lib/cache-handlers/types.ts) object has the following structure:\n\n```ts\ninterface CacheEntry {\n  value: ReadableStream<Uint8Array>\n  tags: string[]\n  stale: number\n  timestamp: number\n  expire: number\n  revalidate: number\n}"
  },
  {
    "id": "cacheHandlers.mdx#12",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "```\n\n| Property     | Type                         | Description                                                  |\n| ------------ | ---------------------------- | ------------------------------------------------------------ |\n| `value`      | `ReadableStream<Uint8Array>` | The cached data as a stream.                                 |\n| `tags`       | `string[]`                   | Cache tags (excluding soft tags).                            |\n| `stale`      | `number`                     | Duration in seconds for client-side staleness.               |\n| `timestamp`  | `number`                     | When the entry was created (timestamp in milliseconds).      |\n| `expire`     | `number`                     | How long the entry is allowed to be used (in seconds).       |\n| `revalidate` | `number`                     | How long until the entry should be revalidated (in seconds). |"
  },
  {
    "id": "cacheHandlers.mdx#13",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "> **Good to know**:\n>\n> - The `value` is a [`ReadableStream`](https://developer.mozilla.org/docs/Web/API/ReadableStream). Use [`.tee()`](https://developer.mozilla.org/docs/Web/API/ReadableStream/tee) if you need to read and store the stream data.\n> - If the stream errors with partial data, your handler must decide whether to keep the partial cache or discard it."
  },
  {
    "id": "cacheHandlers.mdx#14",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "## Examples"
  },
  {
    "id": "cacheHandlers.mdx#15",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "### Basic in-memory cache handler\n\nHere's a minimal implementation using a `Map` for storage. This example demonstrates the core concepts, but for a production-ready implementation with LRU eviction, error handling, and tag management, see the [default cache handler](https://github.com/vercel/next.js/blob/canary/packages/next/src/server/lib/cache-handlers/default.ts).\n\n```js filename=\"cache-handlers/memory-handler.js\"\nconst cache = new Map()\nconst pendingSets = new Map()\n\nmodule.exports = {\n  async get(cacheKey, softTags) {\n    // Wait for any pending set operation to complete\n    const pendingPromise = pendingSets.get(cacheKey)\n    if (pendingPromise) {\n      await pendingPromise\n    }\n\n    const entry = cache.get(cacheKey)\n    if (!entry) {\n      return undefined\n    }\n\n    // Check if entry has expired\n    const now = Date.now()\n    if (now > entry.timestamp + entry.revalidate * 1000) {\n      return undefined\n    }\n\n    return entry\n  },"
  },
  {
    "id": "cacheHandlers.mdx#16",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "// Check if entry has expired\n    const now = Date.now()\n    if (now > entry.timestamp + entry.revalidate * 1000) {\n      return undefined\n    }\n\n    return entry\n  },\n\n  async set(cacheKey, pendingEntry) {\n    // Create a promise to track this set operation\n    let resolvePending\n    const pendingPromise = new Promise((resolve) => {\n      resolvePending = resolve\n    })\n    pendingSets.set(cacheKey, pendingPromise)\n\n    try {\n      // Wait for the entry to be ready\n      const entry = await pendingEntry\n\n      // Store the entry in the cache\n      cache.set(cacheKey, entry)\n    } finally {\n      resolvePending()\n      pendingSets.delete(cacheKey)\n    }\n  },\n\n  async refreshTags() {\n    // No-op for in-memory cache\n  },\n\n  async getExpiration(tags) {\n    // Return 0 to indicate no tags have been revalidated\n    return 0\n  },\n\n  async updateTags(tags, durations) {\n    // Implement tag-based invalidation\n    for (const [key, entry] of cache.entries()) {\n      if (entry.tags.some((tag) => tags.includes(tag))) {\n        cache.delete(key)\n      }\n    }\n  },\n}\n```"
  },
  {
    "id": "cacheHandlers.mdx#17",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "### External storage pattern\n\nFor durable storage like Redis or a database, you'll need to serialize the cache entries. Here's a simple Redis example:\n\n```js filename=\"cache-handlers/redis-handler.js\"\nconst { createClient } = require('redis')\n\nconst client = createClient({ url: process.env.REDIS_URL })\nclient.connect()\n\nmodule.exports = {\n  async get(cacheKey, softTags) {\n    // Retrieve from Redis\n    const stored = await client.get(cacheKey)\n    if (!stored) return undefined\n\n    // Deserialize the entry\n    const data = JSON.parse(stored)\n\n    // Reconstruct the ReadableStream from stored data\n    return {\n      value: new ReadableStream({\n        start(controller) {\n          controller.enqueue(Buffer.from(data.value, 'base64'))\n          controller.close()\n        },\n      }),\n      tags: data.tags,\n      stale: data.stale,\n      timestamp: data.timestamp,\n      expire: data.expire,\n      revalidate: data.revalidate,\n    }\n  },\n\n  async set(cacheKey, pendingEntry) {\n    const entry = await pendingEntry\n\n    // Read the stream to get the data\n    const reader = entry.value.getReader()\n    const chunks = []"
  },
  {
    "id": "cacheHandlers.mdx#18",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "async set(cacheKey, pendingEntry) {\n    const entry = await pendingEntry\n\n    // Read the stream to get the data\n    const reader = entry.value.getReader()\n    const chunks = []\n\n    try {\n      while (true) {\n        const { done, value } = await reader.read()\n        if (done) break\n        chunks.push(value)\n      }\n    } finally {\n      reader.releaseLock()\n    }\n\n    // Combine chunks and serialize for Redis storage\n    const data = Buffer.concat(chunks.map((chunk) => Buffer.from(chunk)))\n\n    await client.set(\n      cacheKey,\n      JSON.stringify({\n        value: data.toString('base64'),\n        tags: entry.tags,\n        stale: entry.stale,\n        timestamp: entry.timestamp,\n        expire: entry.expire,\n        revalidate: entry.revalidate,\n      }),\n      { EX: entry.expire } // Use Redis TTL for automatic expiration\n    )\n  },\n\n  async refreshTags() {\n    // No-op for basic Redis implementation\n    // Could sync with external tag service if needed\n  },\n\n  async getExpiration(tags) {\n    // Return 0 to indicate no tags have been revalidated\n    // Could query Redis for tag expiration timestamps if tracking them\n    return 0\n  },"
  },
  {
    "id": "cacheHandlers.mdx#19",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "async getExpiration(tags) {\n    // Return 0 to indicate no tags have been revalidated\n    // Could query Redis for tag expiration timestamps if tracking them\n    return 0\n  },\n\n  async updateTags(tags, durations) {\n    // Implement tag-based invalidation if needed\n    // Could iterate over keys with matching tags and delete them\n  },\n}\n```"
  },
  {
    "id": "cacheHandlers.mdx#20",
    "metadata": {
      "title": "cacheHandlers",
      "description": "Configure custom cache handlers for use cache directives in Next.js."
    },
    "content": "## Platform Support\n\n| Deployment Option                                                   | Supported         |\n| ------------------------------------------------------------------- | ----------------- |\n| [Node.js server](/docs/app/getting-started/deploying#nodejs-server) | Yes               |\n| [Docker container](/docs/app/getting-started/deploying#docker)      | Yes               |\n| [Static export](/docs/app/getting-started/deploying#static-export)  | No                |\n| [Adapters](/docs/app/getting-started/deploying#adapters)            | Platform-specific |\n\n## Version History\n\n| Version   | Changes                     |\n| --------- | --------------------------- |\n| `v16.0.0` | `cacheHandlers` introduced. |"
  },
  {
    "id": "cacheLife.mdx#0",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to set up cacheLife configurations in Next.js."
    },
    "content": "---\ntitle: cacheLife\ndescription: Learn how to set up cacheLife configurations in Next.js.\nrelated:\n  title: Related\n  description: View related API references.\n  links:\n    - app/api-reference/directives/use-cache\n    - app/api-reference/config/next-config-js/cacheHandlers\n    - app/api-reference/functions/cacheLife\n---\n\nThe `cacheLife` option allows you to define **custom cache profiles** when using the [`cacheLife`](/docs/app/api-reference/functions/cacheLife) function inside components or functions, and within the scope of the [`use cache` directive](/docs/app/api-reference/directives/use-cache)."
  },
  {
    "id": "cacheLife.mdx#1",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to set up cacheLife configurations in Next.js."
    },
    "content": "## Usage\n\nTo define a profile, enable the [`cacheComponents` flag](/docs/app/api-reference/config/next-config-js/cacheComponents) and add the cache profile in the `cacheLife` object in the `next.config.js` file. For example, a `blog` profile:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  cacheComponents: true,\n  cacheLife: {\n    blog: {\n      stale: 3600, // 1 hour\n      revalidate: 900, // 15 minutes\n      expire: 86400, // 1 day\n    },\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  cacheComponents: true,\n  cacheLife: {\n    blog: {\n      stale: 3600, // 1 hour\n      revalidate: 900, // 15 minutes\n      expire: 86400, // 1 day\n    },\n  },\n}\n```\n\nYou can now use this custom `blog` configuration in your component or function as follows:\n\n```tsx filename=\"app/actions.ts\" highlight={4,5} switcher\nimport { cacheLife } from 'next/cache'\n\nexport async function getCachedData() {\n  'use cache'\n  cacheLife('blog')\n  const data = await fetch('/api/data')\n  return data\n}"
  },
  {
    "id": "cacheLife.mdx#2",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to set up cacheLife configurations in Next.js."
    },
    "content": "```\n\n```jsx filename=\"app/actions.js\" highlight={4,5} switcher\nimport { cacheLife } from 'next/cache'\n\nexport async function getCachedData() {\n  'use cache'\n  cacheLife('blog')\n  const data = await fetch('/api/data')\n  return data\n}\n```"
  },
  {
    "id": "cacheLife.mdx#3",
    "metadata": {
      "title": "cacheLife",
      "description": "Learn how to set up cacheLife configurations in Next.js."
    },
    "content": "## Reference\n\nThe configuration object has key values with the following format:\n\n| **Property** | **Value** | **Description**                                                                                           | **Requirement**                             |\n| ------------ | --------- | --------------------------------------------------------------------------------------------------------- | ------------------------------------------- |\n| `stale`      | `number`  | Duration the client should cache a value without checking the server.                                     | Optional                                    |\n| `revalidate` | `number`  | Frequency at which the cache should refresh on the server; stale values may be served while revalidating. | Optional                                    |\n| `expire`     | `number`  | Maximum duration for which a value can remain stale before switching to dynamic.                          | Optional - Must be longer than `revalidate` |"
  },
  {
    "id": "compress.mdx#0",
    "metadata": {
      "title": "compress",
      "description": "Next.js provides gzip compression to compress rendered content and static files, it only works with the server target. Learn more about it here."
    },
    "content": "---\ntitle: compress\ndescription: Next.js provides gzip compression to compress rendered content and static files, it only works with the server target. Learn more about it here.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nBy default, Next.js uses `gzip` to compress rendered content and static files when using `next start` or a custom server. This is an optimization for applications that do not have compression configured. If compression is _already_ configured in your application via a custom server, Next.js will not add compression.\n\nYou can check if compression is enabled and which algorithm is used by looking at the [`Accept-Encoding`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Encoding) (browser accepted options) and [`Content-Encoding`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Encoding) (currently used) headers in the response."
  },
  {
    "id": "compress.mdx#1",
    "metadata": {
      "title": "compress",
      "description": "Next.js provides gzip compression to compress rendered content and static files, it only works with the server target. Learn more about it here."
    },
    "content": "## Disabling compression\n\nTo disable **compression**, set the `compress` config option to `false`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  compress: false,\n}\n```\n\nWe **do not recommend disabling compression** unless you have compression configured on your server, as compression reduces bandwidth usage and improves the performance of your application. For example, you're using [nginx](https://nginx.org/) and want to switch to `brotli`, set the `compress` option to `false` to allow nginx to handle compression."
  },
  {
    "id": "crossOrigin.mdx#0",
    "metadata": {
      "title": "crossOrigin",
      "description": "Use the `crossOrigin` option to add a crossOrigin tag on the `script` tags generated by `next/script`."
    },
    "content": "---\ntitle: crossOrigin\ndescription: Use the `crossOrigin` option to add a crossOrigin tag on the `script` tags generated by `next/script`.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nUse the `crossOrigin` option to add a [`crossOrigin` attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin) in all `<script>` tags generated by the <AppOnly>[`next/script`](/docs/app/guides/scripts) component</AppOnly> <PagesOnly>[`next/script`](/docs/pages/guides/scripts) and [`next/head`](/docs/pages/api-reference/components/head)components</PagesOnly>, and define how cross-origin requests should be handled.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  crossOrigin: 'anonymous',\n}\n```"
  },
  {
    "id": "crossOrigin.mdx#1",
    "metadata": {
      "title": "crossOrigin",
      "description": "Use the `crossOrigin` option to add a crossOrigin tag on the `script` tags generated by `next/script`."
    },
    "content": "## Options\n\n- `'anonymous'`: Adds [`crossOrigin=\"anonymous\"`](https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin#anonymous) attribute.\n- `'use-credentials'`: Adds [`crossOrigin=\"use-credentials\"`](https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin#use-credentials)."
  },
  {
    "id": "cssChunking.mdx#0",
    "metadata": {
      "title": "cssChunking",
      "description": "Use the `cssChunking` option to control how CSS files are chunked in your Next.js application."
    },
    "content": "---\ntitle: cssChunking\ndescription: Use the `cssChunking` option to control how CSS files are chunked in your Next.js application.\nversion: experimental\n---\n\nCSS Chunking is a strategy used to improve the performance of your web application by splitting and re-ordering CSS files into chunks. This allows you to load only the CSS that is needed for a specific route, instead of loading all the application's CSS at once.\n\nYou can control how CSS files are chunked using the `experimental.cssChunking` option in your `next.config.js` file:\n\n```tsx filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig = {\n  experimental: {\n    cssChunking: true, // default\n  },\n} satisfies NextConfig\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    cssChunking: true, // default\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "cssChunking.mdx#1",
    "metadata": {
      "title": "cssChunking",
      "description": "Use the `cssChunking` option to control how CSS files are chunked in your Next.js application."
    },
    "content": "## Options\n\n- **`true` (default)**: Next.js will try to merge CSS files whenever possible, determining explicit and implicit dependencies between files from import order to reduce the number of chunks and therefore the number of requests.\n- **`false`**: Next.js will not attempt to merge or re-order your CSS files.\n- **`'strict'`**: Next.js will load CSS files in the correct order they are imported into your files, which can lead to more chunks and requests.\n\nYou may consider using `'strict'` if you run into unexpected CSS behavior. For example, if you import `a.css` and `b.css` in different files using a different `import` order (`a` before `b`, or `b` before `a`), `true` will merge the files in any order and assume there are no dependencies between them. However, if `b.css` depends on `a.css`, you may want to use `'strict'` to prevent the files from being merged, and instead, load them in the order they are imported - which can result in more chunks and requests.\n\nFor most applications, we recommend `true` as it leads to fewer requests and better performance."
  },
  {
    "id": "devIndicators.mdx#0",
    "metadata": {
      "title": "devIndicators",
      "description": "Configuration options for the on-screen indicator that gives context about the current route you're viewing during development."
    },
    "content": "---\ntitle: devIndicators\ndescription: Configuration options for the on-screen indicator that gives context about the current route you're viewing during development.\n---\n\n`devIndicators` allows you to configure the on-screen indicator that gives context about the current route you're viewing during development.\n\n```ts filename=\"Types\"\n  devIndicators: false | {\n    position?: 'bottom-right'\n    | 'bottom-left'\n    | 'top-right'\n    | 'top-left', // defaults to 'bottom-left',\n  },\n```\n\nSetting `devIndicators` to `false` will hide the indicator, however Next.js will continue to surface any build or runtime errors that were encountered."
  },
  {
    "id": "devIndicators.mdx#1",
    "metadata": {
      "title": "devIndicators",
      "description": "Configuration options for the on-screen indicator that gives context about the current route you're viewing during development."
    },
    "content": "## Troubleshooting"
  },
  {
    "id": "devIndicators.mdx#2",
    "metadata": {
      "title": "devIndicators",
      "description": "Configuration options for the on-screen indicator that gives context about the current route you're viewing during development."
    },
    "content": "### Indicator not marking a route as static\n\nIf you expect a route to be static and the indicator has marked it as dynamic, it's likely the route has opted out of static rendering.\n\nYou can confirm if a route is [static](/docs/app/guides/caching#static-rendering) or [dynamic](/docs/app/guides/caching#dynamic-rendering) by building your application using `next build --debug`, and checking the output in your terminal. Static (or prerendered) routes will display a `○` symbol, whereas dynamic routes will display a `ƒ` symbol. For example:\n\n```bash filename=\"Build Output\"\nRoute (app)\n┌ ○ /_not-found\n└ ƒ /products/[id]\n\n○  (Static)   prerendered as static content\nƒ  (Dynamic)  server-rendered on demand"
  },
  {
    "id": "devIndicators.mdx#3",
    "metadata": {
      "title": "devIndicators",
      "description": "Configuration options for the on-screen indicator that gives context about the current route you're viewing during development."
    },
    "content": "```\n\n<AppOnly>\n\nThere are two reasons a route might opt out of static rendering:\n\n- The presence of [Dynamic APIs](/docs/app/guides/caching#dynamic-rendering) which rely on runtime information.\n- An [uncached data request](/docs/app/getting-started/fetching-data), like a call to an ORM or database driver.\n\nCheck your route for any of these conditions, and if you are not able to statically render the route, then consider using [`loading.js`](/docs/app/api-reference/file-conventions/loading) or [`<Suspense />`](https://react.dev/reference/react/Suspense) to leverage [streaming](/docs/app/getting-started/linking-and-navigating#streaming).\n\n</AppOnly>\n\n<PagesOnly>\n\nWhen exporting [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props) or [`getInitialProps`](/docs/pages/api-reference/functions/get-initial-props) from a page, it will be marked as dynamic.\n\n</PagesOnly>"
  },
  {
    "id": "devIndicators.mdx#4",
    "metadata": {
      "title": "devIndicators",
      "description": "Configuration options for the on-screen indicator that gives context about the current route you're viewing during development."
    },
    "content": "## Version History\n\n| Version   | Changes                                                                                                                                             |\n| --------- | --------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `v16.0.0` | `appIsrStatus`, `buildActivity`, and `buildActivityPosition` options have been removed.                                                             |\n| `v15.2.0` | Improved on-screen indicator with new `position` option. `appIsrStatus`, `buildActivity`, and `buildActivityPosition` options have been deprecated. |\n| `v15.0.0` | Static on-screen indicator added with `appIsrStatus` option.                                                                                        |"
  },
  {
    "id": "distDir.mdx#0",
    "metadata": {
      "title": "distDir",
      "description": "Set a custom build directory to use instead of the default .next directory."
    },
    "content": "---\ntitle: distDir\ndescription: Set a custom build directory to use instead of the default .next directory.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nYou can specify a name to use for a custom build directory to use instead of `.next`.\n\nOpen `next.config.js` and add the `distDir` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  distDir: 'build',\n}\n```\n\nNow if you run `next build` Next.js will use `build` instead of the default `.next` folder.\n\n> `distDir` **should not** leave your project directory. For example, `../build` is an **invalid** directory."
  },
  {
    "id": "env.mdx#0",
    "metadata": {
      "title": "env",
      "description": "Learn to add and access environment variables in your Next.js application at build time."
    },
    "content": "---\ntitle: env\ndescription: Learn to add and access environment variables in your Next.js application at build time.\nversion: legacy\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n<AppOnly>\n\n> Since the release of [Next.js 9.4](https://nextjs.org/blog/next-9-4) we now have a more intuitive and ergonomic experience for [adding environment variables](/docs/app/guides/environment-variables). Give it a try!\n\n</AppOnly>\n\n<PagesOnly>\n\n> Since the release of [Next.js 9.4](https://nextjs.org/blog/next-9-4) we now have a more intuitive and ergonomic experience for [adding environment variables](/docs/pages/guides/environment-variables). Give it a try!\n\n</PagesOnly>\n\n<AppOnly>\n\n> **Good to know**: environment variables specified in this way will **always** be included in the JavaScript bundle, prefixing the environment variable name with `NEXT_PUBLIC_` only has an effect when specifying them [through the environment or .env files](/docs/app/guides/environment-variables).\n\n</AppOnly>"
  },
  {
    "id": "env.mdx#1",
    "metadata": {
      "title": "env",
      "description": "Learn to add and access environment variables in your Next.js application at build time."
    },
    "content": "</AppOnly>\n\n<PagesOnly>\n\n> **Good to know**: environment variables specified in this way will **always** be included in the JavaScript bundle, prefixing the environment variable name with `NEXT_PUBLIC_` only has an effect when specifying them [through the environment or .env files](/docs/pages/guides/environment-variables).\n\n</PagesOnly>\n\nTo add environment variables to the JavaScript bundle, open `next.config.js` and add the `env` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  env: {\n    customKey: 'my-value',\n  },\n}"
  },
  {
    "id": "env.mdx#2",
    "metadata": {
      "title": "env",
      "description": "Learn to add and access environment variables in your Next.js application at build time."
    },
    "content": "```\n\nNow you can access `process.env.customKey` in your code. For example:\n\n```jsx\nfunction Page() {\n  return <h1>The value of customKey is: {process.env.customKey}</h1>\n}\n\nexport default Page\n```\n\nNext.js will replace `process.env.customKey` with `'my-value'` at build time. Trying to destructure `process.env` variables won't work due to the nature of webpack [DefinePlugin](https://webpack.js.org/plugins/define-plugin/).\n\nFor example, the following line:\n\n```jsx\nreturn <h1>The value of customKey is: {process.env.customKey}</h1>\n```\n\nWill end up being:\n\n```jsx\nreturn <h1>The value of customKey is: {'my-value'}</h1>\n```"
  },
  {
    "id": "expireTime.mdx#0",
    "metadata": {
      "title": "expireTime",
      "description": "Customize stale-while-revalidate expire time for ISR enabled pages."
    },
    "content": "---\ntitle: expireTime\ndescription: Customize stale-while-revalidate expire time for ISR enabled pages.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nYou can specify a custom `stale-while-revalidate` expire time for CDNs to consume in the `Cache-Control` header for ISR enabled pages.\n\nOpen `next.config.js` and add the `expireTime` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  // one hour in seconds\n  expireTime: 3600,\n}\n```\n\nNow when sending the `Cache-Control` header the expire time will be calculated depending on the specific revalidate period.\n\nFor example, if you have a revalidate of 15 minutes on a path and the expire time is one hour the generated `Cache-Control` header will be `s-maxage=900, stale-while-revalidate=2700` so that it can stay stale for 15 minutes less than the configured expire time."
  },
  {
    "id": "exportPathMap.mdx#0",
    "metadata": {
      "title": "exportPathMap",
      "description": "Customize the pages that will be exported as HTML files when using `next export`."
    },
    "content": "---\ntitle: exportPathMap\ndescription: Customize the pages that will be exported as HTML files when using `next export`.\nversion: legacy\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n> This feature is exclusive to `next export` and currently **deprecated** in favor of `getStaticPaths` with `pages` or `generateStaticParams` with `app`.\n\n`exportPathMap` allows you to specify a mapping of request paths to page destinations, to be used during export. Paths defined in `exportPathMap` will also be available when using [`next dev`](/docs/app/api-reference/cli/next#next-dev-options).\n\nLet's start with an example, to create a custom `exportPathMap` for an app with the following pages:\n\n- `pages/index.js`\n- `pages/about.js`\n- `pages/post.js`\n\nOpen `next.config.js` and add the following `exportPathMap` config:"
  },
  {
    "id": "exportPathMap.mdx#1",
    "metadata": {
      "title": "exportPathMap",
      "description": "Customize the pages that will be exported as HTML files when using `next export`."
    },
    "content": "- `pages/index.js`\n- `pages/about.js`\n- `pages/post.js`\n\nOpen `next.config.js` and add the following `exportPathMap` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  exportPathMap: async function (\n    defaultPathMap,\n    { dev, dir, outDir, distDir, buildId }\n  ) {\n    return {\n      '/': { page: '/' },\n      '/about': { page: '/about' },\n      '/p/hello-nextjs': { page: '/post', query: { title: 'hello-nextjs' } },\n      '/p/learn-nextjs': { page: '/post', query: { title: 'learn-nextjs' } },\n      '/p/deploy-nextjs': { page: '/post', query: { title: 'deploy-nextjs' } },\n    }\n  },\n}"
  },
  {
    "id": "exportPathMap.mdx#2",
    "metadata": {
      "title": "exportPathMap",
      "description": "Customize the pages that will be exported as HTML files when using `next export`."
    },
    "content": "```\n\n> **Good to know**: the `query` field in `exportPathMap` cannot be used with [automatically statically optimized pages](/docs/pages/building-your-application/rendering/automatic-static-optimization) or [`getStaticProps` pages](/docs/pages/building-your-application/data-fetching/get-static-props) as they are rendered to HTML files at build-time and additional query information cannot be provided during `next export`.\n\nThe pages will then be exported as HTML files, for example, `/about` will become `/about.html`.\n\n`exportPathMap` is an `async` function that receives 2 arguments: the first one is `defaultPathMap`, which is the default map used by Next.js. The second argument is an object with:"
  },
  {
    "id": "exportPathMap.mdx#3",
    "metadata": {
      "title": "exportPathMap",
      "description": "Customize the pages that will be exported as HTML files when using `next export`."
    },
    "content": "`exportPathMap` is an `async` function that receives 2 arguments: the first one is `defaultPathMap`, which is the default map used by Next.js. The second argument is an object with:\n\n- `dev` - `true` when `exportPathMap` is being called in development. `false` when running `next export`. In development `exportPathMap` is used to define routes.\n- `dir` - Absolute path to the project directory\n- `outDir` - Absolute path to the `out/` directory ([configurable with `-o`](#customizing-the-output-directory)). When `dev` is `true` the value of `outDir` will be `null`.\n- `distDir` - Absolute path to the `.next/` directory (configurable with the [`distDir`](/docs/pages/api-reference/config/next-config-js/distDir) config)\n- `buildId` - The generated build id\n\nThe returned object is a map of pages where the `key` is the `pathname` and the `value` is an object that accepts the following fields:\n\n- `page`: `String` - the page inside the `pages` directory to render\n- `query`: `Object` - the `query` object passed to `getInitialProps` when prerendering. Defaults to `{}`"
  },
  {
    "id": "exportPathMap.mdx#4",
    "metadata": {
      "title": "exportPathMap",
      "description": "Customize the pages that will be exported as HTML files when using `next export`."
    },
    "content": "- `page`: `String` - the page inside the `pages` directory to render\n- `query`: `Object` - the `query` object passed to `getInitialProps` when prerendering. Defaults to `{}`\n\n> The exported `pathname` can also be a filename (for example, `/readme.md`), but you may need to set the `Content-Type` header to `text/html` when serving its content if it is different than `.html`."
  },
  {
    "id": "exportPathMap.mdx#5",
    "metadata": {
      "title": "exportPathMap",
      "description": "Customize the pages that will be exported as HTML files when using `next export`."
    },
    "content": "## Adding a trailing slash\n\nIt is possible to configure Next.js to export pages as `index.html` files and require trailing slashes, `/about` becomes `/about/index.html` and is routable via `/about/`. This was the default behavior prior to Next.js 9.\n\nTo switch back and add a trailing slash, open `next.config.js` and enable the `trailingSlash` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  trailingSlash: true,\n}\n```\n\n## Customizing the output directory\n\n<AppOnly>\n\n[`next export`](/docs/app/guides/static-exports) will use `out` as the default output directory, you can customize this using the `-o` argument, like so:\n\n</AppOnly>\n\n<PagesOnly>\n\n[`next export`](/docs/pages/guides/static-exports) will use `out` as the default output directory, you can customize this using the `-o` argument, like so:\n\n</PagesOnly>\n\n```bash filename=\"Terminal\"\nnext export -o outdir\n```\n\n> **Warning**: Using `exportPathMap` is deprecated and is overridden by `getStaticPaths` inside `pages`. We don't recommend using them together."
  },
  {
    "id": "generateBuildId.mdx#0",
    "metadata": {
      "title": "generateBuildId",
      "description": "Configure the build id, which is used to identify the current build in which your application is being served."
    },
    "content": "---\ntitle: generateBuildId\ndescription: Configure the build id, which is used to identify the current build in which your application is being served.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js generates an ID during `next build` to identify which version of your application is being served. The same build should be used and boot up multiple containers.\n\nIf you are rebuilding for each stage of your environment, you will need to generate a consistent build ID to use between containers. Use the `generateBuildId` command in `next.config.js`:\n\n```jsx filename=\"next.config.js\"\nmodule.exports = {\n  generateBuildId: async () => {\n    // This could be anything, using the latest git hash\n    return process.env.GIT_HASH\n  },\n}\n```"
  },
  {
    "id": "generateEtags.mdx#0",
    "metadata": {
      "title": "generateEtags",
      "description": "Next.js will generate etags for every page by default. Learn more about how to disable etag generation here."
    },
    "content": "---\ntitle: generateEtags\ndescription: Next.js will generate etags for every page by default. Learn more about how to disable etag generation here.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js will generate [etags](https://en.wikipedia.org/wiki/HTTP_ETag) for every page by default. You may want to disable etag generation for HTML pages depending on your cache strategy.\n\nOpen `next.config.js` and disable the `generateEtags` option:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  generateEtags: false,\n}\n```"
  },
  {
    "id": "headers.mdx#0",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "---\ntitle: headers\ndescription: Add custom HTTP headers to your Next.js app.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nHeaders allow you to set custom HTTP headers on the response to an incoming request on a given path.\n\nTo set custom HTTP headers you can use the `headers` key in `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async headers() {\n    return [\n      {\n        source: '/about',\n        headers: [\n          {\n            key: 'x-custom-header',\n            value: 'my custom header value',\n          },\n          {\n            key: 'x-another-custom-header',\n            value: 'my other custom header value',\n          },\n        ],\n      },\n    ]\n  },\n}"
  },
  {
    "id": "headers.mdx#1",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "```\n\n`headers` is an async function that expects an array to be returned holding objects with `source` and `headers` properties:\n\n- `source` is the incoming request path pattern.\n- `headers` is an array of response header objects, with `key` and `value` properties.\n- `basePath`: `false` or `undefined` - if false the basePath won't be included when matching, can be used for external rewrites only.\n- `locale`: `false` or `undefined` - whether the locale should not be included when matching.\n- `has` is an array of [has objects](#header-cookie-and-query-matching) with the `type`, `key` and `value` properties.\n- `missing` is an array of [missing objects](#header-cookie-and-query-matching) with the `type`, `key` and `value` properties.\n\nHeaders are checked before the filesystem which includes pages and `/public` files."
  },
  {
    "id": "headers.mdx#2",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "## Header Overriding Behavior\n\nIf two headers match the same path and set the same header key, the last header key will override the first. Using the below headers, the path `/hello` will result in the header `x-hello` being `world` due to the last header value set being `world`.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async headers() {\n    return [\n      {\n        source: '/:path*',\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'there',\n          },\n        ],\n      },\n      {\n        source: '/hello',\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "headers.mdx#3",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "## Path Matching\n\nPath matches are allowed, for example `/blog/:slug` will match `/blog/first-post` (no nested paths):\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async headers() {\n    return [\n      {\n        source: '/blog/:slug',\n        headers: [\n          {\n            key: 'x-slug',\n            value: ':slug', // Matched parameters can be used in the value\n          },\n          {\n            key: 'x-slug-:slug', // Matched parameters can be used in the key\n            value: 'my other custom header value',\n          },\n        ],\n      },\n    ]\n  },\n}\n```\n\nThe pattern `/blog/:slug` matches `/blog/first-post` and `/blog/post-1` but not a nested path like `/blog/a/b`. Patterns are anchored to the start, `/blog/:slug` will not match `/archive/blog/first-post`.\n\nYou can use modifiers on parameters: `*` (zero or more), `+` (one or more), `?` (zero or one). For example, `/blog/:slug*` matches `/blog`, `/blog/a`, and `/blog/a/b/c`.\n\nRead more details on [path-to-regexp](https://github.com/pillarjs/path-to-regexp) documentation."
  },
  {
    "id": "headers.mdx#4",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "### Wildcard Path Matching\n\nTo match a wildcard path you can use `*` after a parameter, for example `/blog/:slug*` will match `/blog/a/b/c/d/hello-world`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async headers() {\n    return [\n      {\n        source: '/blog/:slug*',\n        headers: [\n          {\n            key: 'x-slug',\n            value: ':slug*', // Matched parameters can be used in the value\n          },\n          {\n            key: 'x-slug-:slug*', // Matched parameters can be used in the key\n            value: 'my other custom header value',\n          },\n        ],\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "headers.mdx#5",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "### Regex Path Matching\n\nTo match a regex path you can wrap the regex in parenthesis after a parameter, for example `/blog/:slug(\\\\d{1,})` will match `/blog/123` but not `/blog/abc`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async headers() {\n    return [\n      {\n        source: '/blog/:post(\\\\d{1,})',\n        headers: [\n          {\n            key: 'x-post',\n            value: ':post',\n          },\n        ],\n      },\n    ]\n  },\n}\n```\n\nThe following characters `(`, `)`, `{`, `}`, `:`, `*`, `+`, `?` are used for regex path matching, so when used in the `source` as non-special values they must be escaped by adding `\\\\` before them:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async headers() {\n    return [\n      {\n        // this will match `/english(default)/something` being requested\n        source: '/english\\\\(default\\\\)/:slug',\n        headers: [\n          {\n            key: 'x-header',\n            value: 'value',\n          },\n        ],\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "headers.mdx#6",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "## Header, Cookie, and Query Matching\n\nTo only apply a header when header, cookie, or query values also match the `has` field or don't match the `missing` field can be used. Both the `source` and all `has` items must match and all `missing` items must not match for the header to be applied.\n\n`has` and `missing` items can have the following fields:\n\n- `type`: `String` - must be either `header`, `cookie`, `host`, or `query`.\n- `key`: `String` - the key from the selected type to match against.\n- `value`: `String` or `undefined` - the value to check for, if undefined any value will match. A regex like string can be used to capture a specific part of the value, e.g. if the value `first-(?<paramName>.*)` is used for `first-second` then `second` will be usable in the destination with `:paramName`."
  },
  {
    "id": "headers.mdx#7",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "```js filename=\"next.config.js\"\nmodule.exports = {\n  async headers() {\n    return [\n      // if the header `x-add-header` is present,\n      // the `x-another-header` header will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-add-header',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: 'hello',\n          },\n        ],\n      },\n      // if the header `x-no-header` is not present,\n      // the `x-another-header` header will be applied\n      {\n        source: '/:path*',\n        missing: [\n          {\n            type: 'header',\n            key: 'x-no-header',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: 'hello',\n          },\n        ],\n      },\n      // if the source, query, and cookie are matched,\n      // the `x-authorized` header will be applied\n      {\n        source: '/specific/:path*',\n        has: [\n          {\n            type: 'query',\n            key: 'page',\n            // the page value will not be available in the"
  },
  {
    "id": "headers.mdx#8",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "{\n        source: '/specific/:path*',\n        has: [\n          {\n            type: 'query',\n            key: 'page',\n            // the page value will not be available in the\n            // header key/values since value is provided and\n            // doesn't use a named capture group e.g. (?<page>home)\n            value: 'home',\n          },\n          {\n            type: 'cookie',\n            key: 'authorized',\n            value: 'true',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-authorized',\n            value: ':authorized',\n          },\n        ],\n      },\n      // if the header `x-authorized` is present and\n      // contains a matching value, the `x-another-header` will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-authorized',\n            value: '(?<authorized>yes|true)',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: ':authorized',\n          },\n        ],\n      },\n      // if the host is `example.com`,\n      // this header will be applied\n      {\n        source: '/:path*',\n        has: [\n          {"
  },
  {
    "id": "headers.mdx#9",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "},\n        ],\n      },\n      // if the host is `example.com`,\n      // this header will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'host',\n            value: 'example.com',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: ':authorized',\n          },\n        ],\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "headers.mdx#10",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "## Headers with basePath support\n\nWhen leveraging [`basePath` support](/docs/app/api-reference/config/next-config-js/basePath) with headers each `source` is automatically prefixed with the `basePath` unless you add `basePath: false` to the header:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  basePath: '/docs',\n\n  async headers() {\n    return [\n      {\n        source: '/with-basePath', // becomes /docs/with-basePath\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        source: '/without-basePath', // is not modified since basePath: false is set\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n        basePath: false,\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "headers.mdx#11",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "## Headers with i18n support\n\n<AppOnly>\n\nWhen leveraging [`i18n` support](/docs/app/guides/internationalization) with headers each `source` is automatically prefixed to handle the configured `locales` unless you add `locale: false` to the header. If `locale: false` is used you must prefix the `source` with a locale for it to be matched correctly.\n\n</AppOnly>\n\n<PagesOnly>\n\nWhen leveraging [`i18n` support](/docs/pages/guides/internationalization) with headers each `source` is automatically prefixed to handle the configured `locales` unless you add `locale: false` to the header. If `locale: false` is used you must prefix the `source` with a locale for it to be matched correctly.\n\n</PagesOnly>\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  i18n: {\n    locales: ['en', 'fr', 'de'],\n    defaultLocale: 'en',\n  },"
  },
  {
    "id": "headers.mdx#12",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "</PagesOnly>\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  i18n: {\n    locales: ['en', 'fr', 'de'],\n    defaultLocale: 'en',\n  },\n\n  async headers() {\n    return [\n      {\n        source: '/with-locale', // automatically handles all locales\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        // does not handle locales automatically since locale: false is set\n        source: '/nl/with-locale-manual',\n        locale: false,\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        // this matches '/' since `en` is the defaultLocale\n        source: '/en',\n        locale: false,\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        // this gets converted to /(en|fr|de)/(.*) so will not match the top-level\n        // `/` or `/fr` routes like /:path* would\n        source: '/(.*)',\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "headers.mdx#13",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "## Cache-Control\n\nNext.js sets the `Cache-Control` header of `public, max-age=31536000, immutable` for truly immutable assets. It cannot be overridden. These immutable files contain a SHA-hash in the file name, so they can be safely cached indefinitely. For example, [Static Image Imports](/docs/app/getting-started/images#local-images). You cannot set `Cache-Control` headers in `next.config.js` for these assets.\n\nHowever, you can set `Cache-Control` headers for other responses or data.\n\n<AppOnly>\n\nLearn more about [caching](/docs/app/guides/caching) with the App Router.\n\n</AppOnly>\n\n<PagesOnly>\n\nIf you need to revalidate the cache of a page that has been [statically generated](/docs/pages/building-your-application/rendering/static-site-generation), you can do so by setting the `revalidate` prop in the page's [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) function.\n\nTo cache the response from an [API Route](/docs/pages/building-your-application/routing/api-routes), you can use `res.setHeader`:\n\n```ts filename=\"pages/api/hello.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\ntype ResponseData = {\n  message: string\n}"
  },
  {
    "id": "headers.mdx#14",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "```ts filename=\"pages/api/hello.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\ntype ResponseData = {\n  message: string\n}\n\nexport default function handler(\n  req: NextApiRequest,\n  res: NextApiResponse<ResponseData>\n) {\n  res.setHeader('Cache-Control', 's-maxage=86400')\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}"
  },
  {
    "id": "headers.mdx#15",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "```\n\n```js filename=\"pages/api/hello.js\" switcher\nexport default function handler(req, res) {\n  res.setHeader('Cache-Control', 's-maxage=86400')\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}"
  },
  {
    "id": "headers.mdx#16",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "```\n\nYou can also use caching headers (`Cache-Control`) inside `getServerSideProps` to cache dynamic responses. For example, using [`stale-while-revalidate`](https://web.dev/stale-while-revalidate/).\n\n```ts filename=\"pages/index.tsx\" switcher\nimport { GetStaticProps, GetStaticPaths, GetServerSideProps } from 'next'\n\n// This value is considered fresh for ten seconds (s-maxage=10).\n// If a request is repeated within the next 10 seconds, the previously\n// cached value will still be fresh. If the request is repeated before 59 seconds,\n// the cached value will be stale but still render (stale-while-revalidate=59).\n//\n// In the background, a revalidation request will be made to populate the cache\n// with a fresh value. If you refresh the page, you will see the new value.\nexport const getServerSideProps = (async (context) => {\n  context.res.setHeader(\n    'Cache-Control',\n    'public, s-maxage=10, stale-while-revalidate=59'\n  )\n\n  return {\n    props: {},\n  }\n}) satisfies GetServerSideProps"
  },
  {
    "id": "headers.mdx#17",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "```\n\n```js filename=\"pages/index.js\" switcher\n// This value is considered fresh for ten seconds (s-maxage=10).\n// If a request is repeated within the next 10 seconds, the previously\n// cached value will still be fresh. If the request is repeated before 59 seconds,\n// the cached value will be stale but still render (stale-while-revalidate=59).\n//\n// In the background, a revalidation request will be made to populate the cache\n// with a fresh value. If you refresh the page, you will see the new value.\nexport async function getServerSideProps({ req, res }) {\n  res.setHeader(\n    'Cache-Control',\n    'public, s-maxage=10, stale-while-revalidate=59'\n  )\n\n  return {\n    props: {},\n  }\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "headers.mdx#18",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "## Options\n\n### CORS\n\n[Cross-Origin Resource Sharing (CORS)](https://developer.mozilla.org/docs/Web/HTTP/CORS) is a security feature that allows you to control which sites can access your resources. You can set the `Access-Control-Allow-Origin` header to allow a specific origin to access your <PagesOnly>API Endpoints</PagesOnly><AppOnly>Route Handlers</AppOnly>.\n\n```js\nasync headers() {\n    return [\n      {\n        source: \"/api/:path*\",\n        headers: [\n          {\n            key: \"Access-Control-Allow-Origin\",\n            value: \"*\", // Set your origin\n          },\n          {\n            key: \"Access-Control-Allow-Methods\",\n            value: \"GET, POST, PUT, DELETE, OPTIONS\",\n          },\n          {\n            key: \"Access-Control-Allow-Headers\",\n            value: \"Content-Type, Authorization\",\n          },\n        ],\n      },\n    ];\n  },\n```"
  },
  {
    "id": "headers.mdx#19",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "### X-DNS-Prefetch-Control\n\n[This header](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control) controls DNS prefetching, allowing browsers to proactively perform domain name resolution on external links, images, CSS, JavaScript, and more. This prefetching is performed in the background, so the [DNS](https://developer.mozilla.org/docs/Glossary/DNS) is more likely to be resolved by the time the referenced items are needed. This reduces latency when the user clicks a link.\n\n```js\n{\n  key: 'X-DNS-Prefetch-Control',\n  value: 'on'\n}\n```\n\n### Strict-Transport-Security\n\n[This header](https://developer.mozilla.org/docs/Web/HTTP/Headers/Strict-Transport-Security) informs browsers it should only be accessed using HTTPS, instead of using HTTP. Using the configuration below, all present and future subdomains will use HTTPS for a `max-age` of 2 years. This blocks access to pages or subdomains that can only be served over HTTP.\n\n```js\n{\n  key: 'Strict-Transport-Security',\n  value: 'max-age=63072000; includeSubDomains; preload'\n}\n```"
  },
  {
    "id": "headers.mdx#20",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "### X-Frame-Options\n\n[This header](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options) indicates whether the site should be allowed to be displayed within an `iframe`. This can prevent against clickjacking attacks.\n\n**This header has been superseded by CSP's `frame-ancestors` option**, which has better support in modern browsers (see [Content Security Policy](/docs/app/guides/content-security-policy) for configuration details).\n\n```js\n{\n  key: 'X-Frame-Options',\n  value: 'SAMEORIGIN'\n}\n```\n\n### Permissions-Policy\n\n[This header](https://developer.mozilla.org/docs/Web/HTTP/Headers/Permissions-Policy) allows you to control which features and APIs can be used in the browser. It was previously named `Feature-Policy`.\n\n```js\n{\n  key: 'Permissions-Policy',\n  value: 'camera=(), microphone=(), geolocation=(), browsing-topics=()'\n}\n```"
  },
  {
    "id": "headers.mdx#21",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "### X-Content-Type-Options\n\n[This header](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Content-Type-Options) prevents the browser from attempting to guess the type of content if the `Content-Type` header is not explicitly set. This can prevent XSS exploits for websites that allow users to upload and share files.\n\nFor example, a user trying to download an image, but having it treated as a different `Content-Type` like an executable, which could be malicious. This header also applies to downloading browser extensions. The only valid value for this header is `nosniff`.\n\n```js\n{\n  key: 'X-Content-Type-Options',\n  value: 'nosniff'\n}\n```\n\n### Referrer-Policy\n\n[This header](https://developer.mozilla.org/docs/Web/HTTP/Headers/Referrer-Policy) controls how much information the browser includes when navigating from the current website (origin) to another.\n\n```js\n{\n  key: 'Referrer-Policy',\n  value: 'origin-when-cross-origin'\n}\n```\n\n### Content-Security-Policy\n\nLearn more about adding a [Content Security Policy](/docs/app/guides/content-security-policy) to your application."
  },
  {
    "id": "headers.mdx#22",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "## Version History\n\n| Version   | Changes          |\n| --------- | ---------------- |\n| `v13.3.0` | `missing` added. |\n| `v10.2.0` | `has` added.     |\n| `v9.5.0`  | Headers added.   |"
  },
  {
    "id": "htmlLimitedBots.mdx#0",
    "metadata": {
      "title": "htmlLimitedBots",
      "description": "Specify a list of user agents that should receive blocking metadata."
    },
    "content": "---\ntitle: htmlLimitedBots\ndescription: Specify a list of user agents that should receive blocking metadata.\n---\n\nThe `htmlLimitedBots` config allows you to specify a list of user agents that should receive blocking metadata instead of [streaming metadata](/docs/app/api-reference/functions/generate-metadata#streaming-metadata).\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst config: NextConfig = {\n  htmlLimitedBots: /MySpecialBot|MyAnotherSpecialBot|SimpleCrawler/,\n}\n\nexport default config\n```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  htmlLimitedBots: /MySpecialBot|MyAnotherSpecialBot|SimpleCrawler/,\n}\n```"
  },
  {
    "id": "htmlLimitedBots.mdx#1",
    "metadata": {
      "title": "htmlLimitedBots",
      "description": "Specify a list of user agents that should receive blocking metadata."
    },
    "content": "## Default list\n\nNext.js includes a default list of HTML limited bots, including:\n\n- Google crawlers (e.g. Mediapartners-Google, AdsBot-Google, Google-PageRenderer)\n- Bingbot\n- Twitterbot\n- Slackbot\n\nSee the full list [here](https://github.com/vercel/next.js/blob/canary/packages/next/src/shared/lib/router/utils/html-bots.ts).\n\nSpecifying a `htmlLimitedBots` config will override the Next.js' default list. However, this is advanced behavior, and the default should be sufficient for most cases.\n\n```ts filename=\"next.config.ts\" switcher\nconst config: NextConfig = {\n  htmlLimitedBots: /MySpecialBot|MyAnotherSpecialBot|SimpleCrawler/,\n}\n\nexport default config\n```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  htmlLimitedBots: /MySpecialBot|MyAnotherSpecialBot|SimpleCrawler/,\n}\n```\n\n## Disabling\n\nTo fully disable streaming metadata:\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst config: NextConfig = {\n  htmlLimitedBots: /.*/,\n}\n\nexport default config\n```\n\n```js filename=\"next.config.js\" switcher\nmodule.exports = {\n  htmlLimitedBots: /.*/,\n}\n```"
  },
  {
    "id": "htmlLimitedBots.mdx#2",
    "metadata": {
      "title": "htmlLimitedBots",
      "description": "Specify a list of user agents that should receive blocking metadata."
    },
    "content": "## Version History\n\n| Version | Changes                              |\n| ------- | ------------------------------------ |\n| 15.2.0  | `htmlLimitedBots` option introduced. |"
  },
  {
    "id": "httpAgentOptions.mdx#0",
    "metadata": {
      "title": "httpAgentOptions",
      "description": "Next.js will automatically use HTTP Keep-Alive by default. Learn more about how to disable HTTP Keep-Alive here."
    },
    "content": "---\ntitle: httpAgentOptions\ndescription: Next.js will automatically use HTTP Keep-Alive by default. Learn more about how to disable HTTP Keep-Alive here.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nIn Node.js versions prior to 18, Next.js automatically polyfills `fetch()` with [undici](/docs/architecture/supported-browsers#polyfills) and enables [HTTP Keep-Alive](https://developer.mozilla.org/docs/Web/HTTP/Headers/Keep-Alive) by default.\n\nTo disable HTTP Keep-Alive for all `fetch()` calls on the server-side, open `next.config.js` and add the `httpAgentOptions` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  httpAgentOptions: {\n    keepAlive: false,\n  },\n}\n```"
  },
  {
    "id": "images.mdx#0",
    "metadata": {
      "title": "images",
      "description": "Custom configuration for the next/image loader"
    },
    "content": "---\ntitle: images\ndescription: Custom configuration for the next/image loader\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nIf you want to use a cloud provider to optimize images instead of using the Next.js built-in Image Optimization API, you can configure `next.config.js` with the following:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    loader: 'custom',\n    loaderFile: './my/image/loader.js',\n  },\n}\n```\n\nThis `loaderFile` must point to a file relative to the root of your Next.js application. The file must export a default function that returns a string, for example:\n\n<AppOnly>\n\n```js filename=\"my/image/loader.js\"\n'use client'\n\nexport default function myImageLoader({ src, width, quality }) {\n  return `https://example.com/${src}?w=${width}&q=${quality || 75}`\n}"
  },
  {
    "id": "images.mdx#1",
    "metadata": {
      "title": "images",
      "description": "Custom configuration for the next/image loader"
    },
    "content": "```\n\nAlternatively, you can use the [`loader` prop](/docs/app/api-reference/components/image#loader) to pass the function to each instance of `next/image`.\n\n> **Good to know**: Customizing the image loader file, which accepts a function, requires using [Client Components](/docs/app/getting-started/server-and-client-components) to serialize the provided function.\n\nTo learn more about configuring the behavior of the built-in [Image Optimization API](/docs/app/api-reference/components/image) and the [Image Component](/docs/app/api-reference/components/image), see [Image Configuration Options](/docs/app/api-reference/components/image#configuration-options) for available options.\n\n</AppOnly>\n\n<PagesOnly>\n\n```js filename=\"my/image/loader.js\"\nexport default function myImageLoader({ src, width, quality }) {\n  return `https://example.com/${src}?w=${width}&q=${quality || 75}`\n}"
  },
  {
    "id": "images.mdx#2",
    "metadata": {
      "title": "images",
      "description": "Custom configuration for the next/image loader"
    },
    "content": "```\n\nAlternatively, you can use the [`loader` prop](/docs/pages/api-reference/components/image#loader) to pass the function to each instance of `next/image`.\n\nTo learn more about configuring the behavior of the built-in [Image Optimization API](/docs/pages/api-reference/components/image) and the [Image Component](/docs/pages/api-reference/components/image), see [Image Configuration Options](/docs/pages/api-reference/components/image#configuration-options) for available options.\n\n</PagesOnly>"
  },
  {
    "id": "images.mdx#3",
    "metadata": {
      "title": "images",
      "description": "Custom configuration for the next/image loader"
    },
    "content": "## Example Loader Configuration\n\n- [Akamai](#akamai)\n- [AWS CloudFront](#aws-cloudfront)\n- [Cloudinary](#cloudinary)\n- [Cloudflare](#cloudflare)\n- [Contentful](#contentful)\n- [Fastly](#fastly)\n- [Gumlet](#gumlet)\n- [ImageEngine](#imageengine)\n- [Imgix](#imgix)\n- [PixelBin](#pixelbin)\n- [Sanity](#sanity)\n- [Sirv](#sirv)\n- [Supabase](#supabase)\n- [Thumbor](#thumbor)\n- [Imagekit](#imagekitio)\n- [Nitrogen AIO](#nitrogen-aio)\n\n### Akamai\n\n```js\n// Docs: https://techdocs.akamai.com/ivm/reference/test-images-on-demand\nexport default function akamaiLoader({ src, width, quality }) {\n  return `https://example.com/${src}?imwidth=${width}`\n}\n```\n\n### AWS CloudFront\n\n```js\n// Docs: https://aws.amazon.com/developer/application-security-performance/articles/image-optimization\nexport default function cloudfrontLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('format', 'auto')\n  url.searchParams.set('width', width.toString())\n  url.searchParams.set('quality', (quality || 75).toString())\n  return url.href\n}\n```"
  },
  {
    "id": "images.mdx#4",
    "metadata": {
      "title": "images",
      "description": "Custom configuration for the next/image loader"
    },
    "content": "### Cloudinary\n\n```js\n// Demo: https://res.cloudinary.com/demo/image/upload/w_300,c_limit,q_auto/turtles.jpg\nexport default function cloudinaryLoader({ src, width, quality }) {\n  const params = ['f_auto', 'c_limit', `w_${width}`, `q_${quality || 'auto'}`]\n  return `https://example.com/${params.join(',')}${src}`\n}\n```\n\n### Cloudflare\n\n```js\n// Docs: https://developers.cloudflare.com/images/transform-images\nexport default function cloudflareLoader({ src, width, quality }) {\n  const params = [`width=${width}`, `quality=${quality || 75}`, 'format=auto']\n  return `https://example.com/cdn-cgi/image/${params.join(',')}/${src}`\n}\n```\n\n### Contentful\n\n```js\n// Docs: https://www.contentful.com/developers/docs/references/images-api/\nexport default function contentfulLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('fm', 'webp')\n  url.searchParams.set('w', width.toString())\n  url.searchParams.set('q', (quality || 75).toString())\n  return url.href\n}\n```"
  },
  {
    "id": "images.mdx#5",
    "metadata": {
      "title": "images",
      "description": "Custom configuration for the next/image loader"
    },
    "content": "### Fastly\n\n```js\n// Docs: https://developer.fastly.com/reference/io/\nexport default function fastlyLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('auto', 'webp')\n  url.searchParams.set('width', width.toString())\n  url.searchParams.set('quality', (quality || 75).toString())\n  return url.href\n}\n```\n\n### Gumlet\n\n```js\n// Docs: https://docs.gumlet.com/reference/image-transform-size\nexport default function gumletLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('format', 'auto')\n  url.searchParams.set('w', width.toString())\n  url.searchParams.set('q', (quality || 75).toString())\n  return url.href\n}\n```\n\n### ImageEngine\n\n```js\n// Docs: https://support.imageengine.io/hc/en-us/articles/360058880672-Directives\nexport default function imageengineLoader({ src, width, quality }) {\n  const compression = 100 - (quality || 50)\n  const params = [`w_${width}`, `cmpr_${compression}`)]\n  return `https://example.com${src}?imgeng=/${params.join('/')`\n}\n```"
  },
  {
    "id": "images.mdx#6",
    "metadata": {
      "title": "images",
      "description": "Custom configuration for the next/image loader"
    },
    "content": "### Imgix\n\n```js\n// Demo: https://static.imgix.net/daisy.png?format=auto&fit=max&w=300\nexport default function imgixLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  const params = url.searchParams\n  params.set('auto', params.getAll('auto').join(',') || 'format')\n  params.set('fit', params.get('fit') || 'max')\n  params.set('w', params.get('w') || width.toString())\n  params.set('q', (quality || 50).toString())\n  return url.href\n}\n```\n\n### PixelBin\n\n```js\n// Doc (Resize): https://www.pixelbin.io/docs/transformations/basic/resize/#width-w\n// Doc (Optimise): https://www.pixelbin.io/docs/optimizations/quality/#image-quality-when-delivering\n// Doc (Auto Format Delivery): https://www.pixelbin.io/docs/optimizations/format/#automatic-format-selection-with-f_auto-url-parameter\nexport default function pixelBinLoader({ src, width, quality }) {\n  const name = '<your-cloud-name>'\n  const opt = `t.resize(w:${width})~t.compress(q:${quality || 75})`\n  return `https://cdn.pixelbin.io/v2/${name}/${opt}/${src}?f_auto=true`\n}\n```"
  },
  {
    "id": "images.mdx#7",
    "metadata": {
      "title": "images",
      "description": "Custom configuration for the next/image loader"
    },
    "content": "### Sanity\n\n```js\n// Docs: https://www.sanity.io/docs/image-urls\nexport default function sanityLoader({ src, width, quality }) {\n  const prj = 'zp7mbokg'\n  const dataset = 'production'\n  const url = new URL(`https://cdn.sanity.io/images/${prj}/${dataset}${src}`)\n  url.searchParams.set('auto', 'format')\n  url.searchParams.set('fit', 'max')\n  url.searchParams.set('w', width.toString())\n  if (quality) {\n    url.searchParams.set('q', quality.toString())\n  }\n  return url.href\n}\n```\n\n### Sirv\n\n```js\n// Docs: https://sirv.com/help/articles/dynamic-imaging/\nexport default function sirvLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  const params = url.searchParams\n  params.set('format', params.getAll('format').join(',') || 'optimal')\n  params.set('w', params.get('w') || width.toString())\n  params.set('q', (quality || 85).toString())\n  return url.href\n}\n```"
  },
  {
    "id": "images.mdx#8",
    "metadata": {
      "title": "images",
      "description": "Custom configuration for the next/image loader"
    },
    "content": "### Supabase\n\n```js\n// Docs: https://supabase.com/docs/guides/storage/image-transformations#nextjs-loader\nexport default function supabaseLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('width', width.toString())\n  url.searchParams.set('quality', (quality || 75).toString())\n  return url.href\n}\n```\n\n### Thumbor\n\n```js\n// Docs: https://thumbor.readthedocs.io/en/latest/\nexport default function thumborLoader({ src, width, quality }) {\n  const params = [`${width}x0`, `filters:quality(${quality || 75})`]\n  return `https://example.com${params.join('/')}${src}`\n}\n```\n\n### ImageKit.io\n\n```js\n// Docs: https://imagekit.io/docs/image-transformation\nexport default function imageKitLoader({ src, width, quality }) {\n  const params = [`w-${width}`, `q-${quality || 80}`]\n  return `https://ik.imagekit.io/your_imagekit_id/${src}?tr=${params.join(',')}`\n}\n```"
  },
  {
    "id": "images.mdx#9",
    "metadata": {
      "title": "images",
      "description": "Custom configuration for the next/image loader"
    },
    "content": "### Nitrogen AIO\n\n```js\n// Docs: https://docs.n7.io/aio/intergrations/\nexport default function aioLoader({ src, width, quality }) {\n  const url = new URL(src, window.location.href)\n  const params = url.searchParams\n  const aioParams = params.getAll('aio')\n  aioParams.push(`w-${width}`)\n  if (quality) {\n    aioParams.push(`q-${quality.toString()}`)\n  }\n  params.set('aio', aioParams.join(';'))\n  return url.href\n}\n```"
  },
  {
    "id": "incrementalCacheHandlerPath.mdx#0",
    "metadata": {
      "title": "Custom Next.js Cache Handler",
      "description": "Configure the Next.js cache used for storing and revalidating data to use any external service like Redis, Memcached, or others."
    },
    "content": "---\ntitle: Custom Next.js Cache Handler\nnav_title: cacheHandler\ndescription: Configure the Next.js cache used for storing and revalidating data to use any external service like Redis, Memcached, or others.\n---\n\nYou can configure the Next.js cache location if you want to persist cached pages and data to durable storage, or share the cache across multiple containers or instances of your Next.js application.\n\n> **Good to know**: The `cacheHandler` (singular) configuration is specifically used by Next.js for server cache operations such as storing and revalidating ISR and route handler responses. It is **not** used by `'use cache'` directives. For `'use cache'` directives, use [`cacheHandlers`](/docs/app/api-reference/config/next-config-js/cacheHandlers) (plural) instead.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  cacheHandler: require.resolve('./cache-handler.js'),\n  cacheMaxMemorySize: 0, // disable default in-memory caching\n}\n```\n\nView an example of a [custom cache handler](/docs/app/guides/self-hosting#configuring-caching) and learn more about the implementation."
  },
  {
    "id": "incrementalCacheHandlerPath.mdx#1",
    "metadata": {
      "title": "Custom Next.js Cache Handler",
      "description": "Configure the Next.js cache used for storing and revalidating data to use any external service like Redis, Memcached, or others."
    },
    "content": "## API Reference\n\nThe cache handler can implement the following methods: `get`, `set`, `revalidateTag`, and `resetRequestCache`.\n\n### `get()`\n\n| Parameter | Type     | Description                  |\n| --------- | -------- | ---------------------------- |\n| `key`     | `string` | The key to the cached value. |\n\nReturns the cached value or `null` if not found.\n\n### `set()`\n\n| Parameter | Type           | Description                      |\n| --------- | -------------- | -------------------------------- |\n| `key`     | `string`       | The key to store the data under. |\n| `data`    | Data or `null` | The data to be cached.           |\n| `ctx`     | `{ tags: [] }` | The cache tags provided.         |\n\nReturns `Promise<void>`.\n\n### `revalidateTag()`\n\n| Parameter | Type                   | Description                   |\n| --------- | ---------------------- | ----------------------------- |\n| `tag`     | `string` or `string[]` | The cache tags to revalidate. |\n\nReturns `Promise<void>`. Learn more about [revalidating data](/docs/app/guides/incremental-static-regeneration) or the [`revalidateTag()`](/docs/app/api-reference/functions/revalidateTag) function."
  },
  {
    "id": "incrementalCacheHandlerPath.mdx#2",
    "metadata": {
      "title": "Custom Next.js Cache Handler",
      "description": "Configure the Next.js cache used for storing and revalidating data to use any external service like Redis, Memcached, or others."
    },
    "content": "### `resetRequestCache()`\n\nThis method resets the temporary in-memory cache for a single request before the next request.\n\nReturns `void`.\n\n**Good to know:**\n\n- `revalidatePath` is a convenience layer on top of cache tags. Calling `revalidatePath` will call your `revalidateTag` function, which you can then choose if you want to tag cache keys based on the path."
  },
  {
    "id": "incrementalCacheHandlerPath.mdx#3",
    "metadata": {
      "title": "Custom Next.js Cache Handler",
      "description": "Configure the Next.js cache used for storing and revalidating data to use any external service like Redis, Memcached, or others."
    },
    "content": "## Platform Support\n\n| Deployment Option                                                   | Supported         |\n| ------------------------------------------------------------------- | ----------------- |\n| [Node.js server](/docs/app/getting-started/deploying#nodejs-server) | Yes               |\n| [Docker container](/docs/app/getting-started/deploying#docker)      | Yes               |\n| [Static export](/docs/app/getting-started/deploying#static-export)  | No                |\n| [Adapters](/docs/app/getting-started/deploying#adapters)            | Platform-specific |\n\nLearn how to [configure ISR](/docs/app/guides/self-hosting#caching-and-isr) when self-hosting Next.js.\n\n## Version History\n\n| Version   | Changes                                                      |\n| --------- | ------------------------------------------------------------ |\n| `v14.1.0` | Renamed to `cacheHandler` and became stable.                 |\n| `v13.4.0` | `incrementalCacheHandlerPath` support for `revalidateTag`.   |\n| `v13.4.0` | `incrementalCacheHandlerPath` support for standalone output. |\n| `v12.2.0` | Experimental `incrementalCacheHandlerPath` added.            |"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "next.config.js",
      "description": "Learn how to configure your application with next.config.js."
    },
    "content": "---\ntitle: next.config.js\ndescription: Learn how to configure your application with next.config.js.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js can be configured through a `next.config.js` file in the root of your project directory (for example, by `package.json`) with a default export.\n\n```js filename=\"next.config.js\"\n// @ts-check\n\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  /* config options here */\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "index.mdx#1",
    "metadata": {
      "title": "next.config.js",
      "description": "Learn how to configure your application with next.config.js."
    },
    "content": "## ECMAScript Modules\n\n`next.config.js` is a regular Node.js module, not a JSON file. It gets used by the Next.js server and build phases, and it's not included in the browser build.\n\nIf you need [ECMAScript modules](https://nodejs.org/api/esm.html), you can use `next.config.mjs`:\n\n```js filename=\"next.config.mjs\"\n// @ts-check\n\n/**\n * @type {import('next').NextConfig}\n */\nconst nextConfig = {\n  /* config options here */\n}\n\nexport default nextConfig\n```\n\n> **Good to know**: `next.config` with the `.cjs` or `.cts` extensions are currently **not** supported."
  },
  {
    "id": "index.mdx#2",
    "metadata": {
      "title": "next.config.js",
      "description": "Learn how to configure your application with next.config.js."
    },
    "content": "## Configuration as a Function\n\nYou can also use a function:\n\n```js filename=\"next.config.mjs\"\n// @ts-check\n\nexport default (phase, { defaultConfig }) => {\n  /**\n   * @type {import('next').NextConfig}\n   */\n  const nextConfig = {\n    /* config options here */\n  }\n  return nextConfig\n}\n```\n\n### Async Configuration\n\nSince Next.js 12.1.0, you can use an async function:\n\n```js filename=\"next.config.js\"\n// @ts-check\n\nmodule.exports = async (phase, { defaultConfig }) => {\n  /**\n   * @type {import('next').NextConfig}\n   */\n  const nextConfig = {\n    /* config options here */\n  }\n  return nextConfig\n}\n```"
  },
  {
    "id": "index.mdx#3",
    "metadata": {
      "title": "next.config.js",
      "description": "Learn how to configure your application with next.config.js."
    },
    "content": "### Phase\n\n`phase` is the current context in which the configuration is loaded. You can see the [available phases](https://github.com/vercel/next.js/blob/5e6b008b561caf2710ab7be63320a3d549474a5b/packages/next/shared/lib/constants.ts#L19-L23). Phases can be imported from `next/constants`:\n\n```js filename=\"next.config.js\"\n// @ts-check\n\nconst { PHASE_DEVELOPMENT_SERVER } = require('next/constants')\n\nmodule.exports = (phase, { defaultConfig }) => {\n  if (phase === PHASE_DEVELOPMENT_SERVER) {\n    return {\n      /* development only config options here */\n    }\n  }\n\n  return {\n    /* config options for all phases except development here */\n  }\n}\n```"
  },
  {
    "id": "index.mdx#4",
    "metadata": {
      "title": "next.config.js",
      "description": "Learn how to configure your application with next.config.js."
    },
    "content": "## TypeScript\n\nIf you are using TypeScript in your project, you can use `next.config.ts` to use TypeScript in your configuration:\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  /* config options here */\n}\n\nexport default nextConfig\n```\n\nThe commented lines are the place where you can put the configs allowed by `next.config.js`, which are [defined in this file](https://github.com/vercel/next.js/blob/canary/packages/next/src/server/config-shared.ts).\n\nHowever, none of the configs are required, and it's not necessary to understand what each config does. Instead, search for the features you need to enable or modify in this section and they will show you what to do.\n\n> Avoid using new JavaScript features not available in your target Node.js version. `next.config.js` will not be parsed by Webpack or Babel.\n\nThis page documents all the available configuration options:"
  },
  {
    "id": "index.mdx#5",
    "metadata": {
      "title": "next.config.js",
      "description": "Learn how to configure your application with next.config.js."
    },
    "content": "## Unit Testing (experimental)\n\nStarting in Next.js 15.1, the `next/experimental/testing/server` package contains utilities to help unit test `next.config.js` files.\n\nThe `unstable_getResponseFromNextConfig` function runs the [`headers`](/docs/app/api-reference/config/next-config-js/headers), [`redirects`](/docs/app/api-reference/config/next-config-js/redirects), and [`rewrites`](/docs/app/api-reference/config/next-config-js/rewrites) functions from `next.config.js` with the provided request information and returns `NextResponse` with the results of the routing.\n\n> The response from `unstable_getResponseFromNextConfig` only considers `next.config.js` fields and does not consider proxy or filesystem routes, so the result in production may be different than the unit test.\n\n```js\nimport {\n  getRedirectUrl,\n  unstable_getResponseFromNextConfig,\n} from 'next/experimental/testing/server'"
  },
  {
    "id": "index.mdx#6",
    "metadata": {
      "title": "next.config.js",
      "description": "Learn how to configure your application with next.config.js."
    },
    "content": "```js\nimport {\n  getRedirectUrl,\n  unstable_getResponseFromNextConfig,\n} from 'next/experimental/testing/server'\n\nconst response = await unstable_getResponseFromNextConfig({\n  url: 'https://nextjs.org/test',\n  nextConfig: {\n    async redirects() {\n      return [{ source: '/test', destination: '/test2', permanent: false }]\n    },\n  },\n})\nexpect(response.status).toEqual(307)\nexpect(getRedirectUrl(response)).toEqual('https://nextjs.org/test2')\n```"
  },
  {
    "id": "inlineCss.mdx#0",
    "metadata": {
      "title": "inlineCss",
      "description": "Enable inline CSS support."
    },
    "content": "---\ntitle: inlineCss\ndescription: Enable inline CSS support.\nversion: experimental\n---\n\n## Usage\n\nExperimental support for inlining CSS in the `<head>`. When this flag is enabled, all places where we normally generate a `<link>` tag will instead have a generated `<style>` tag.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    inlineCss: true,\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    inlineCss: true,\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "inlineCss.mdx#1",
    "metadata": {
      "title": "inlineCss",
      "description": "Enable inline CSS support."
    },
    "content": "## Trade-Offs\n\n### When to Use Inline CSS\n\nInlining CSS can be beneficial in several scenarios:\n\n- **First-Time Visitors**: Since CSS files are render-blocking resources, inlining eliminates the initial download delay that first-time visitors experience, improving page load performance.\n\n- **Performance Metrics**: By removing the additional network requests for CSS files, inlining can significantly improve key metrics like First Contentful Paint (FCP) and Largest Contentful Paint (LCP).\n\n- **Slow Connections**: For users on slower networks where each request adds considerable latency, inlining CSS can provide a noticeable performance boost by reducing network roundtrips.\n\n- **Atomic CSS Bundles (e.g., Tailwind)**: With utility-first frameworks like Tailwind CSS, the size of the styles required for a page is often O(1) relative to the complexity of the design. This makes inlining a compelling choice because the entire set of styles for the current page is lightweight and doesn’t grow with the page size. Inlining Tailwind styles ensures minimal payload and eliminates the need for additional network requests, which can further enhance performance."
  },
  {
    "id": "inlineCss.mdx#2",
    "metadata": {
      "title": "inlineCss",
      "description": "Enable inline CSS support."
    },
    "content": "### When Not to Use Inline CSS\n\nWhile inlining CSS offers significant benefits for performance, there are scenarios where it may not be the best choice:\n\n- **Large CSS Bundles**: If your CSS bundle is too large, inlining it may significantly increase the size of the HTML, resulting in slower Time to First Byte (TTFB) and potentially worse performance for users with slow connections.\n- **Dynamic or Page-Specific CSS**: For applications with highly dynamic styles or pages that use different sets of CSS, inlining may lead to redundancy and bloat, as the full CSS for all pages may need to be inlined repeatedly.\n\n- **Browser Caching**: In cases where visitors frequently return to your site, external CSS files allow browsers to cache styles efficiently, reducing data transfer for subsequent visits. Inlining CSS eliminates this benefit.\n\nEvaluate these trade-offs carefully, and consider combining inlining with other strategies, such as critical CSS extraction or a hybrid approach, for the best results tailored to your site's needs."
  },
  {
    "id": "inlineCss.mdx#3",
    "metadata": {
      "title": "inlineCss",
      "description": "Enable inline CSS support."
    },
    "content": "Evaluate these trade-offs carefully, and consider combining inlining with other strategies, such as critical CSS extraction or a hybrid approach, for the best results tailored to your site's needs.\n\n> **Good to know**:\n>\n> This feature is currently experimental and has some known limitations:\n>\n> - CSS inlining is applied globally and cannot be configured on a per-page basis\n> - Styles are duplicated during initial page load - once within `<style>` tags for SSR and once in the RSC payload\n> - When navigating to statically rendered pages, styles will use `<link>` tags instead of inline CSS to avoid duplication\n> - This feature is not available in development mode and only works in production builds"
  },
  {
    "id": "isolatedDevBuild.mdx#0",
    "metadata": {
      "title": "isolatedDevBuild",
      "description": "Use isolated build outputs for development server to prevent conflicts with production builds."
    },
    "content": "---\ntitle: isolatedDevBuild\ndescription: Use isolated build outputs for development server to prevent conflicts with production builds.\nversion: experimental\n---\n\nThe experimental `isolatedDevBuild` option separates development and production build outputs into different directories. When enabled, the development server (`next dev`) writes its output to `.next/dev` instead of `.next`, preventing conflicts when running `next dev` and `next build` concurrently.\n\nThis is especially helpful when automated tools (for example, AI agents) run `next build` to validate changes while your development server is running, ensuring the dev server is not affected by changes made by the build process.\n\nThis feature is **enabled by default** to keep development and production outputs separate and prevent conflicts."
  },
  {
    "id": "isolatedDevBuild.mdx#1",
    "metadata": {
      "title": "isolatedDevBuild",
      "description": "Use isolated build outputs for development server to prevent conflicts with production builds."
    },
    "content": "## Configuration\n\nTo opt out of this feature, set `isolatedDevBuild` to `false` in your configuration:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    isolatedDevBuild: false, // defaults to true\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.mjs\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    isolatedDevBuild: false, // defaults to true\n  },\n}\n\nexport default nextConfig\n```\n\n## Version History\n\n| Version   | Changes                                        |\n| --------- | ---------------------------------------------- |\n| `v16.0.0` | `experimental.isolatedDevBuild` is introduced. |"
  },
  {
    "id": "logging.mdx#0",
    "metadata": {
      "title": "logging",
      "description": "Configure how data fetches are logged to the console when running Next.js in development mode."
    },
    "content": "---\ntitle: logging\ndescription: Configure how data fetches are logged to the console when running Next.js in development mode.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "logging.mdx#1",
    "metadata": {
      "title": "logging",
      "description": "Configure how data fetches are logged to the console when running Next.js in development mode."
    },
    "content": "## Options\n\n### Fetching\n\nYou can configure the logging level and whether the full URL is logged to the console when running Next.js in development mode.\n\nCurrently, `logging` only applies to data fetching using the `fetch` API. It does not yet apply to other logs inside of Next.js.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  logging: {\n    fetches: {\n      fullUrl: true,\n    },\n  },\n}\n```\n\nAny `fetch` requests that are restored from the [Server Components HMR cache](/docs/app/api-reference/config/next-config-js/serverComponentsHmrCache) are not logged by default. However, this can be enabled by setting `logging.fetches.hmrRefreshes` to `true`.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  logging: {\n    fetches: {\n      hmrRefreshes: true,\n    },\n  },\n}\n```"
  },
  {
    "id": "logging.mdx#2",
    "metadata": {
      "title": "logging",
      "description": "Configure how data fetches are logged to the console when running Next.js in development mode."
    },
    "content": "### Incoming Requests\n\nBy default all the incoming requests will be logged in the console during development. You can use the `incomingRequests` option to decide which requests to ignore.\nSince this is only logged in development, this option doesn't affect production builds.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  logging: {\n    incomingRequests: {\n      ignore: [/\\api\\/v1\\/health/],\n    },\n  },\n}\n```\n\nOr you can disable incoming request logging by setting `incomingRequests` to `false`.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  logging: {\n    incomingRequests: false,\n  },\n}\n```\n\n### Disabling Logging\n\nIn addition, you can disable the development logging by setting `logging` to `false`.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  logging: false,\n}\n```"
  },
  {
    "id": "mdxRs.mdx#0",
    "metadata": {
      "title": "mdxRs",
      "description": "Use the new Rust compiler to compile MDX files in the App Router."
    },
    "content": "---\ntitle: mdxRs\ndescription: Use the new Rust compiler to compile MDX files in the App Router.\nversion: experimental\n---\n\nFor experimental use with `@next/mdx`. Compiles MDX files using the new Rust compiler.\n\n```js filename=\"next.config.js\"\nconst withMDX = require('@next/mdx')()\n\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  pageExtensions: ['ts', 'tsx', 'mdx'],\n  experimental: {\n    mdxRs: true,\n  },\n}\n\nmodule.exports = withMDX(nextConfig)\n```"
  },
  {
    "id": "onDemandEntries.mdx#0",
    "metadata": {
      "title": "onDemandEntries",
      "description": "Configure how Next.js will dispose and keep in memory pages created in development."
    },
    "content": "---\ntitle: onDemandEntries\ndescription: Configure how Next.js will dispose and keep in memory pages created in development.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js exposes some options that give you some control over how the server will dispose or keep in memory built pages in development.\n\nTo change the defaults, open `next.config.js` and add the `onDemandEntries` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  onDemandEntries: {\n    // period (in ms) where the server will keep pages in the buffer\n    maxInactiveAge: 25 * 1000,\n    // number of pages that should be kept simultaneously without being disposed\n    pagesBufferLength: 2,\n  },\n}\n```"
  },
  {
    "id": "optimizePackageImports.mdx#0",
    "metadata": {
      "title": "optimizePackageImports",
      "description": "API Reference for optimizePackageImports Next.js Config Option"
    },
    "content": "---\ntitle: optimizePackageImports\ndescription: API Reference for optimizePackageImports Next.js Config Option\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nSome packages can export hundreds or thousands of modules, which can cause performance issues in development and production.\n\nAdding a package to `experimental.optimizePackageImports` will only load the modules you are actually using, while still giving you the convenience of writing import statements with many named exports.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  experimental: {\n    optimizePackageImports: ['package-name'],\n  },\n}"
  },
  {
    "id": "optimizePackageImports.mdx#1",
    "metadata": {
      "title": "optimizePackageImports",
      "description": "API Reference for optimizePackageImports Next.js Config Option"
    },
    "content": "```\n\nThe following libraries are optimized by default:\n\n- `lucide-react`\n- `date-fns`\n- `lodash-es`\n- `ramda`\n- `antd`\n- `react-bootstrap`\n- `ahooks`\n- `@ant-design/icons`\n- `@headlessui/react`\n- `@headlessui-float/react`\n- `@heroicons/react/20/solid`\n- `@heroicons/react/24/solid`\n- `@heroicons/react/24/outline`\n- `@visx/visx`\n- `@tremor/react`\n- `rxjs`\n- `@mui/material`\n- `@mui/icons-material`\n- `recharts`\n- `react-use`\n- `@material-ui/core`\n- `@material-ui/icons`\n- `@tabler/icons-react`\n- `mui-core`\n- `react-icons/*`\n- `effect`\n- `@effect/*`"
  },
  {
    "id": "output.mdx#0",
    "metadata": {
      "title": "output",
      "description": "Next.js automatically traces which files are needed by each page to allow for easy deployment of your application. Learn how it works here."
    },
    "content": "---\ntitle: output\ndescription: Next.js automatically traces which files are needed by each page to allow for easy deployment of your application. Learn how it works here.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nDuring a build, Next.js will automatically trace each page and its dependencies to determine all of the files that are needed for deploying a production version of your application.\n\nThis feature helps reduce the size of deployments drastically. Previously, when deploying with Docker you would need to have all files from your package's `dependencies` installed to run `next start`. Starting with Next.js 12, you can leverage Output File Tracing in the `.next/` directory to only include the necessary files.\n\nFurthermore, this removes the need for the deprecated `serverless` target which can cause various issues and also creates unnecessary duplication."
  },
  {
    "id": "output.mdx#1",
    "metadata": {
      "title": "output",
      "description": "Next.js automatically traces which files are needed by each page to allow for easy deployment of your application. Learn how it works here."
    },
    "content": "## How it Works\n\nDuring `next build`, Next.js will use [`@vercel/nft`](https://github.com/vercel/nft) to statically analyze `import`, `require`, and `fs` usage to determine all files that a page might load.\n\nNext.js' production server is also traced for its needed files and output at `.next/next-server.js.nft.json` which can be leveraged in production.\n\nTo leverage the `.nft.json` files emitted to the `.next` output directory, you can read the list of files in each trace that are relative to the `.nft.json` file and then copy them to your deployment location."
  },
  {
    "id": "output.mdx#2",
    "metadata": {
      "title": "output",
      "description": "Next.js automatically traces which files are needed by each page to allow for easy deployment of your application. Learn how it works here."
    },
    "content": "## Automatically Copying Traced Files\n\nNext.js can automatically create a `standalone` folder that copies only the necessary files for a production deployment including select files in `node_modules`.\n\nTo leverage this automatic copying you can enable it in your `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  output: 'standalone',\n}\n```\n\nThis will create a folder at `.next/standalone` which can then be deployed on its own without installing `node_modules`.\n\nAdditionally, a minimal `server.js` file is also output which can be used instead of `next start`. This minimal server does not copy the `public` or `.next/static` folders by default as these should ideally be handled by a CDN instead, although these folders can be copied to the `standalone/public` and `standalone/.next/static` folders manually, after which `server.js` file will serve these automatically.\n\nTo copy these manually, you can use the `cp` command-line tool after you `next build`:\n\n```bash filename=\"Terminal\"\ncp -r public .next/standalone/ && cp -r .next/static .next/standalone/.next/"
  },
  {
    "id": "output.mdx#3",
    "metadata": {
      "title": "output",
      "description": "Next.js automatically traces which files are needed by each page to allow for easy deployment of your application. Learn how it works here."
    },
    "content": "```\n\nTo start your minimal `server.js` file locally, run the following command:\n\n```bash filename=\"Terminal\"\nnode .next/standalone/server.js\n```\n\n<AppOnly>\n\n> **Good to know**:\n>\n> - If your project needs to listen to a specific port or hostname, you can define `PORT` or `HOSTNAME` environment variables before running `server.js`. For example, run `PORT=8080 HOSTNAME=0.0.0.0 node server.js` to start the server on `http://0.0.0.0:8080`.\n\n</AppOnly>\n\n<PagesOnly>\n\n> **Good to know**:\n>\n> - `next.config.js` is read during `next build` and serialized into the `server.js` output file.\n> - If your project needs to listen to a specific port or hostname, you can define `PORT` or `HOSTNAME` environment variables before running `server.js`. For example, run `PORT=8080 HOSTNAME=0.0.0.0 node server.js` to start the server on `http://0.0.0.0:8080`.\n\n</PagesOnly>"
  },
  {
    "id": "output.mdx#4",
    "metadata": {
      "title": "output",
      "description": "Next.js automatically traces which files are needed by each page to allow for easy deployment of your application. Learn how it works here."
    },
    "content": "## Caveats\n\n- While tracing in monorepo setups, the project directory is used for tracing by default. For `next build packages/web-app`, `packages/web-app` would be the tracing root and any files outside of that folder will not be included. To include files outside of this folder you can set `outputFileTracingRoot` in your `next.config.js`.\n\n```js filename=\"packages/web-app/next.config.js\"\nconst path = require('path')\n\nmodule.exports = {\n  // this includes files from the monorepo base two directories up\n  outputFileTracingRoot: path.join(__dirname, '../../'),\n}"
  },
  {
    "id": "output.mdx#5",
    "metadata": {
      "title": "output",
      "description": "Next.js automatically traces which files are needed by each page to allow for easy deployment of your application. Learn how it works here."
    },
    "content": "```\n\n- There are some cases in which Next.js might fail to include required files, or might incorrectly include unused files. In those cases, you can leverage `outputFileTracingExcludes` and `outputFileTracingIncludes` respectively in `next.config.js`. Each option accepts an object whose keys are **route globs** (matched with [picomatch](https://www.npmjs.com/package/picomatch#basic-globbing) against the route path, e.g. `/api/hello`) and whose values are **glob patterns resolved from the project root** that specify files to include or exclude in the trace.\n\n> **Good to know**:\n> In a monorepo, `project root` refers to the Next.js project root (the folder containing next.config.js, e.g., packages/web-app), not necessarily the monorepo root.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  outputFileTracingExcludes: {\n    '/api/hello': ['./un-necessary-folder/**/*'],\n  },\n  outputFileTracingIncludes: {\n    '/api/another': ['./necessary-folder/**/*'],\n    '/api/login/\\\\[\\\\[\\\\.\\\\.\\\\.slug\\\\]\\\\]': [\n      './node_modules/aws-crt/dist/bin/**/*',\n    ],\n  },\n}"
  },
  {
    "id": "output.mdx#6",
    "metadata": {
      "title": "output",
      "description": "Next.js automatically traces which files are needed by each page to allow for easy deployment of your application. Learn how it works here."
    },
    "content": "```\n\nUsing a `src/` directory does not change how you write these options:\n\n- **Keys** still match the route path (`'/api/hello'`, `'/products/[id]'`, etc.).\n- **Values** can reference paths under `src/` since they are resolved relative to the project root.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  outputFileTracingIncludes: {\n    '/products/*': ['src/lib/payments/**/*'],\n    '/*': ['src/config/runtime/**/*.json'],\n  },\n  outputFileTracingExcludes: {\n    '/api/*': ['src/temp/**/*', 'public/large-logs/**/*'],\n  },\n}\n```\n\nYou can also target all routes using a global key like `'/*'`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  outputFileTracingIncludes: {\n    '/*': ['src/i18n/locales/**/*.json'],\n  },\n}"
  },
  {
    "id": "output.mdx#7",
    "metadata": {
      "title": "output",
      "description": "Next.js automatically traces which files are needed by each page to allow for easy deployment of your application. Learn how it works here."
    },
    "content": "```\n\nYou can also target all routes using a global key like `'/*'`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  outputFileTracingIncludes: {\n    '/*': ['src/i18n/locales/**/*.json'],\n  },\n}\n```\n\nThese options are applied to server traces and do not affect routes that do not produce a server trace file:\n\n- Edge Runtime routes are not affected.\n- Fully static pages are not affected.\n\nIn monorepos or when you need to include files outside the app folder, combine `outputFileTracingRoot` with includes:\n\n```js filename=\"next.config.js\"\nconst path = require('path')\n\nmodule.exports = {\n  // Trace from the monorepo root\n  outputFileTracingRoot: path.join(__dirname, '../../'),\n  outputFileTracingIncludes: {\n    '/route1': ['../shared/assets/**/*'],\n  },\n}\n```\n\n> **Good to know**:\n>\n> - Prefer forward slashes (`/`) in patterns for cross-platform compatibility.\n> - Keep patterns as narrow as possible to avoid oversized traces (avoid `**/*` at the repo root).\n\nCommon include patterns for native/runtime assets:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  outputFileTracingIncludes: {\n    '/*': ['node_modules/sharp/**/*', 'node_modules/aws-crt/dist/bin/**/*'],\n  },\n}\n```"
  },
  {
    "id": "pageExtensions.mdx#0",
    "metadata": {
      "title": "pageExtensions",
      "description": "Extend the default page extensions used by Next.js when resolving pages in the Pages Router."
    },
    "content": "---\ntitle: pageExtensions\ndescription: Extend the default page extensions used by Next.js when resolving pages in the Pages Router.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n<AppOnly>\n\nBy default, Next.js accepts files with the following extensions: `.tsx`, `.ts`, `.jsx`, `.js`. This can be modified to allow other extensions like markdown (`.md`, `.mdx`).\n\n```js filename=\"next.config.js\"\nconst withMDX = require('@next/mdx')()\n\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  pageExtensions: ['js', 'jsx', 'ts', 'tsx', 'md', 'mdx'],\n}\n\nmodule.exports = withMDX(nextConfig)\n```\n\n</AppOnly>\n\n<PagesOnly>\n\nYou can extend the default Page extensions (`.tsx`, `.ts`, `.jsx`, `.js`) used by Next.js. Inside `next.config.js`, add the `pageExtensions` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  pageExtensions: ['mdx', 'md', 'jsx', 'js', 'tsx', 'ts'],\n}"
  },
  {
    "id": "pageExtensions.mdx#1",
    "metadata": {
      "title": "pageExtensions",
      "description": "Extend the default page extensions used by Next.js when resolving pages in the Pages Router."
    },
    "content": "```\n\nChanging these values affects _all_ Next.js pages, including the following:\n\n- [`proxy.js`](/docs/pages/api-reference/file-conventions/proxy)\n- [`instrumentation.js`](/docs/pages/guides/instrumentation)\n- `pages/_document.js`\n- `pages/_app.js`\n- `pages/api/`\n\nFor example, if you reconfigure `.ts` page extensions to `.page.ts`, you would need to rename pages like `proxy.page.ts`, `instrumentation.page.ts`, `_app.page.ts`."
  },
  {
    "id": "pageExtensions.mdx#2",
    "metadata": {
      "title": "pageExtensions",
      "description": "Extend the default page extensions used by Next.js when resolving pages in the Pages Router."
    },
    "content": "## Including non-page files in the `pages` directory\n\nYou can colocate test files or other files used by components in the `pages` directory. Inside `next.config.js`, add the `pageExtensions` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  pageExtensions: ['page.tsx', 'page.ts', 'page.jsx', 'page.js'],\n}\n```\n\nThen, rename your pages to have a file extension that includes `.page` (e.g. rename `MyPage.tsx` to `MyPage.page.tsx`). Ensure you rename _all_ Next.js pages, including the files mentioned above.\n\n</PagesOnly>"
  },
  {
    "id": "poweredByHeader.mdx#0",
    "metadata": {
      "title": "poweredByHeader",
      "description": "Next.js will add the `x-powered-by` header by default. Learn to opt-out of it here."
    },
    "content": "---\ntitle: poweredByHeader\ndescription: Next.js will add the `x-powered-by` header by default. Learn to opt-out of it here.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nBy default Next.js will add the `x-powered-by` header. To opt-out of it, open `next.config.js` and disable the `poweredByHeader` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  poweredByHeader: false,\n}\n```"
  },
  {
    "id": "productionBrowserSourceMaps.mdx#0",
    "metadata": {
      "title": "productionBrowserSourceMaps",
      "description": "Enables browser source map generation during the production build."
    },
    "content": "---\ntitle: productionBrowserSourceMaps\ndescription: Enables browser source map generation during the production build.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nSource Maps are enabled by default during development. During production builds, they are disabled to prevent you leaking your source on the client, unless you specifically opt-in with the configuration flag.\n\nNext.js provides a configuration flag you can use to enable browser source map generation during the production build:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  productionBrowserSourceMaps: true,\n}\n```\n\nWhen the `productionBrowserSourceMaps` option is enabled, the source maps will be output in the same directory as the JavaScript files. Next.js will automatically serve these files when requested.\n\n- Adding source maps can increase `next build` time\n- Increases memory usage during `next build`"
  },
  {
    "id": "proxyClientMaxBodySize.mdx#0",
    "metadata": {
      "title": "proxyClientMaxBodySize",
      "description": "Configure the maximum request body size when using proxy."
    },
    "content": "---\ntitle: proxyClientMaxBodySize\ndescription: Configure the maximum request body size when using proxy.\nversion: experimental\n---\n\nWhen proxy is used, Next.js automatically clones the request body and buffers it in memory to enable multiple reads - both in proxy and the underlying route handler. To prevent excessive memory usage, this configuration option sets a size limit on the buffered body.\n\nBy default, the maximum body size is **10MB**. If a request body exceeds this limit, the body will only be buffered up to the limit, and a warning will be logged indicating which route exceeded the limit."
  },
  {
    "id": "proxyClientMaxBodySize.mdx#1",
    "metadata": {
      "title": "proxyClientMaxBodySize",
      "description": "Configure the maximum request body size when using proxy."
    },
    "content": "## Options\n\n### String format (recommended)\n\nSpecify the size using a human-readable string format:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    proxyClientMaxBodySize: '1mb',\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    proxyClientMaxBodySize: '1mb',\n  },\n}\n\nmodule.exports = nextConfig\n```\n\nSupported units: `b`, `kb`, `mb`, `gb`\n\n### Number format\n\nAlternatively, specify the size in bytes as a number:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    proxyClientMaxBodySize: 1048576, // 1MB in bytes\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    proxyClientMaxBodySize: 1048576, // 1MB in bytes\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "proxyClientMaxBodySize.mdx#2",
    "metadata": {
      "title": "proxyClientMaxBodySize",
      "description": "Configure the maximum request body size when using proxy."
    },
    "content": "## Behavior\n\nWhen a request body exceeds the configured limit:\n\n1. Next.js will buffer only the first N bytes (up to the limit)\n2. A warning will be logged to the console indicating the route that exceeded the limit\n3. The request will continue processing normally, but only the partial body will be available\n4. The request will **not** fail or return an error to the client\n\nIf your application needs to process the full request body, you should either:\n\n- Increase the `proxyClientMaxBodySize` limit\n- Handle the partial body gracefully in your application logic"
  },
  {
    "id": "proxyClientMaxBodySize.mdx#3",
    "metadata": {
      "title": "proxyClientMaxBodySize",
      "description": "Configure the maximum request body size when using proxy."
    },
    "content": "## Example\n\n```ts filename=\"proxy.ts\"\nimport { NextRequest, NextResponse } from 'next/server'\n\nexport async function proxy(request: NextRequest) {\n  // Next.js automatically buffers the body with the configured size limit\n  // You can read the body in proxy...\n  const body = await request.text()\n\n  // If the body exceeded the limit, only partial data will be available\n  console.log('Body size:', body.length)\n\n  return NextResponse.next()\n}\n```\n\n```ts filename=\"app/api/upload/route.ts\"\nimport { NextRequest, NextResponse } from 'next/server'\n\nexport async function POST(request: NextRequest) {\n  // ...and the body is still available in your route handler\n  const body = await request.text()\n\n  console.log('Body in route handler:', body.length)\n\n  return NextResponse.json({ received: body.length })\n}\n```\n\n## Good to know\n\n- This setting only applies when proxy is used in your application\n- The default limit of 10MB is designed to balance memory usage and typical use cases\n- The limit applies per-request, not globally across all concurrent requests\n- For applications handling large file uploads, consider increasing the limit accordingly"
  },
  {
    "id": "reactCompiler.mdx#0",
    "metadata": {
      "title": "reactCompiler",
      "description": "Enable the React Compiler to automatically optimize component rendering."
    },
    "content": "---\ntitle: reactCompiler\ndescription: Enable the React Compiler to automatically optimize component rendering.\n---\n\nNext.js includes support for the [React Compiler](https://react.dev/learn/react-compiler/introduction), a tool designed to improve performance by automatically optimizing component rendering. This reduces the need for manual memoization using `useMemo` and `useCallback`.\n\nNext.js includes a custom performance optimization written in SWC that makes the React Compiler more efficient. Instead of running the compiler on every file, Next.js analyzes your project and only applies the React Compiler to relevant files. This avoids unnecessary work and leads to faster builds compared to using the Babel plugin on its own."
  },
  {
    "id": "reactCompiler.mdx#1",
    "metadata": {
      "title": "reactCompiler",
      "description": "Enable the React Compiler to automatically optimize component rendering."
    },
    "content": "## How It Works\n\nThe React Compiler runs through a Babel plugin. To keep builds fast, Next.js uses a custom SWC optimization that only applies the React Compiler to relevant files—like those with JSX or React Hooks.\n\nThis avoids compiling everything and keeps the performance cost minimal. You may still see slightly slower builds compared to the default Rust-based compiler, but the impact is small and localized.\n\nTo use it, install the `babel-plugin-react-compiler`:\n\n```bash filename=\"Terminal\"\nnpm install -D babel-plugin-react-compiler\n```\n\nThen, add `reactCompiler` option in `next.config.js`:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  reactCompiler: true,\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  reactCompiler: true,\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "reactCompiler.mdx#2",
    "metadata": {
      "title": "reactCompiler",
      "description": "Enable the React Compiler to automatically optimize component rendering."
    },
    "content": "## Annotations\n\nYou can configure the compiler to run in \"opt-in\" mode as follows:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  reactCompiler: {\n    compilationMode: 'annotation',\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  reactCompiler: {\n    compilationMode: 'annotation',\n  },\n}\n\nmodule.exports = nextConfig\n```\n\nThen, you can annotate specific components or hooks with the `\"use memo\"` directive from React to opt-in:\n\n```ts filename=\"app/page.tsx\" switcher\nexport default function Page() {\n  'use memo'\n  // ...\n}\n```\n\n```js filename=\"app/page.js\" switcher\nexport default function Page() {\n  'use memo'\n  // ...\n}\n```\n\n> **Note:** You can also use the `\"use no memo\"` directive from React for the opposite effect, to opt-out a component or hook."
  },
  {
    "id": "reactMaxHeadersLength.mdx#0",
    "metadata": {
      "title": "reactMaxHeadersLength",
      "description": "The maximum length of the headers that are emitted by React and added to the response."
    },
    "content": "---\ntitle: reactMaxHeadersLength\ndescription: The maximum length of the headers that are emitted by React and added to the response.\n---\n\nDuring static rendering, React can emit headers that can be added to the response. These can be used to improve performance by allowing the browser to preload resources like fonts, scripts, and stylesheets. The default value is `6000`, but you can override this value by configuring the `reactMaxHeadersLength` option in `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  reactMaxHeadersLength: 1000,\n}\n```\n\n> **Good to know**: This option is only available in App Router.\n\nDepending on the type of proxy between the browser and the server, the headers can be truncated. For example, if you are using a reverse proxy that doesn't support long headers, you should set a lower value to ensure that the headers are not truncated."
  },
  {
    "id": "reactStrictMode.mdx#0",
    "metadata": {
      "title": "reactStrictMode",
      "description": "The complete Next.js runtime is now Strict Mode-compliant, learn how to opt-in"
    },
    "content": "---\ntitle: reactStrictMode\ndescription: The complete Next.js runtime is now Strict Mode-compliant, learn how to opt-in\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n> **Good to know**: Since Next.js 13.5.1, Strict Mode is `true` by default with `app` router, so the above configuration is only necessary for `pages`. You can still disable Strict Mode by setting `reactStrictMode: false`.\n\n> **Suggested**: We strongly suggest you enable Strict Mode in your Next.js application to better prepare your application for the future of React.\n\nReact's [Strict Mode](https://react.dev/reference/react/StrictMode) is a development mode only feature for highlighting potential problems in an application. It helps to identify unsafe lifecycles, legacy API usage, and a number of other features.\n\nThe Next.js runtime is Strict Mode-compliant. To opt-in to Strict Mode, configure the following option in your `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  reactStrictMode: true,\n}"
  },
  {
    "id": "reactStrictMode.mdx#1",
    "metadata": {
      "title": "reactStrictMode",
      "description": "The complete Next.js runtime is now Strict Mode-compliant, learn how to opt-in"
    },
    "content": "```\n\nIf you or your team are not ready to use Strict Mode in your entire application, that's OK! You can incrementally migrate on a page-by-page basis using `<React.StrictMode>`."
  },
  {
    "id": "redirects.mdx#0",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "---\ntitle: redirects\ndescription: Add redirects to your Next.js app.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nRedirects allow you to redirect an incoming request path to a different destination path.\n\nTo use redirects you can use the `redirects` key in `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/about',\n        destination: '/',\n        permanent: true,\n      },\n    ]\n  },\n}"
  },
  {
    "id": "redirects.mdx#1",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "```\n\n`redirects` is an async function that expects an array to be returned holding objects with `source`, `destination`, and `permanent` properties:\n\n- `source` is the incoming request path pattern.\n- `destination` is the path you want to route to.\n- `permanent` `true` or `false` - if `true` will use the 308 status code which instructs clients/search engines to cache the redirect forever, if `false` will use the 307 status code which is temporary and is not cached.\n\n> **Why does Next.js use 307 and 308?** Traditionally a 302 was used for a temporary redirect, and a 301 for a permanent redirect, but many browsers changed the request method of the redirect to `GET`, regardless of the original method. For example, if the browser made a request to `POST /v1/users` which returned status code `302` with location `/v2/users`, the subsequent request might be `GET /v2/users` instead of the expected `POST /v2/users`. Next.js uses the 307 temporary redirect, and 308 permanent redirect status codes to explicitly preserve the request method used."
  },
  {
    "id": "redirects.mdx#2",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "- `basePath`: `false` or `undefined` - if false the `basePath` won't be included when matching, can be used for external redirects only.\n- `locale`: `false` or `undefined` - whether the locale should not be included when matching.\n- `has` is an array of [has objects](#header-cookie-and-query-matching) with the `type`, `key` and `value` properties.\n- `missing` is an array of [missing objects](#header-cookie-and-query-matching) with the `type`, `key` and `value` properties.\n\nRedirects are checked before the filesystem which includes pages and `/public` files.\n\nWhen using the Pages Router, redirects are not applied to client-side routing (`Link`, `router.push`) unless [Proxy](/docs/app/api-reference/file-conventions/proxy) is present and matches the path.\n\nWhen a redirect is applied, any query values provided in the request will be passed through to the redirect destination. For example, see the following redirect configuration:\n\n```js\n{\n  source: '/old-blog/:path*',\n  destination: '/blog/:path*',\n  permanent: false\n}"
  },
  {
    "id": "redirects.mdx#3",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "```\n\n> **Good to know**: Remember to include the forward slash `/` before the colon `:` in path parameters of the `source` and `destination` paths, otherwise the path will be treated as a literal string and you run the risk of causing infinite redirects.\n\nWhen `/old-blog/post-1?hello=world` is requested, the client will be redirected to `/blog/post-1?hello=world`."
  },
  {
    "id": "redirects.mdx#4",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "## Path Matching\n\nPath matches are allowed, for example `/old-blog/:slug` will match `/old-blog/first-post` (no nested paths):\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/old-blog/:slug',\n        destination: '/news/:slug', // Matched parameters can be used in the destination\n        permanent: true,\n      },\n    ]\n  },\n}\n```\n\nThe pattern `/old-blog/:slug` matches `/old-blog/first-post` and `/old-blog/post-1` but not `/old-blog/a/b` (no nested paths). Patterns are anchored to the start: `/old-blog/:slug` will not match `/archive/old-blog/first-post`.\n\nYou can use modifiers on parameters: `*` (zero or more), `+` (one or more), `?` (zero or one). For example, `/blog/:slug*` matches `/blog`, `/blog/a`, and `/blog/a/b/c`.\n\nRead more details on [path-to-regexp](https://github.com/pillarjs/path-to-regexp) documentation."
  },
  {
    "id": "redirects.mdx#5",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "### Wildcard Path Matching\n\nTo match a wildcard path you can use `*` after a parameter, for example `/blog/:slug*` will match `/blog/a/b/c/d/hello-world`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/blog/:slug*',\n        destination: '/news/:slug*', // Matched parameters can be used in the destination\n        permanent: true,\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "redirects.mdx#6",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "### Regex Path Matching\n\nTo match a regex path you can wrap the regex in parentheses after a parameter, for example `/post/:slug(\\\\d{1,})` will match `/post/123` but not `/post/abc`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/post/:slug(\\\\d{1,})',\n        destination: '/news/:slug', // Matched parameters can be used in the destination\n        permanent: false,\n      },\n    ]\n  },\n}\n```\n\nThe following characters `(`, `)`, `{`, `}`, `:`, `*`, `+`, `?` are used for regex path matching, so when used in the `source` as non-special values they must be escaped by adding `\\\\` before them:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async redirects() {\n    return [\n      {\n        // this will match `/english(default)/something` being requested\n        source: '/english\\\\(default\\\\)/:slug',\n        destination: '/en-us/:slug',\n        permanent: false,\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "redirects.mdx#7",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "## Header, Cookie, and Query Matching\n\nTo only match a redirect when header, cookie, or query values also match the `has` field or don't match the `missing` field can be used. Both the `source` and all `has` items must match and all `missing` items must not match for the redirect to be applied.\n\n`has` and `missing` items can have the following fields:\n\n- `type`: `String` - must be either `header`, `cookie`, `host`, or `query`.\n- `key`: `String` - the key from the selected type to match against.\n- `value`: `String` or `undefined` - the value to check for, if undefined any value will match. A regex like string can be used to capture a specific part of the value, e.g. if the value `first-(?<paramName>.*)` is used for `first-second` then `second` will be usable in the destination with `:paramName`."
  },
  {
    "id": "redirects.mdx#8",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "```js filename=\"next.config.js\"\nmodule.exports = {\n  async redirects() {\n    return [\n      // if the header `x-redirect-me` is present,\n      // this redirect will be applied\n      {\n        source: '/:path((?!another-page$).*)',\n        has: [\n          {\n            type: 'header',\n            key: 'x-redirect-me',\n          },\n        ],\n        permanent: false,\n        destination: '/another-page',\n      },\n      // if the header `x-do-not-redirect` is present,\n      // this redirect will NOT be applied\n      {\n        source: '/:path((?!another-page$).*)',\n        missing: [\n          {\n            type: 'header',\n            key: 'x-do-not-redirect',\n          },\n        ],\n        permanent: false,\n        destination: '/another-page',\n      },\n      // if the source, query, and cookie are matched,\n      // this redirect will be applied\n      {\n        source: '/specific/:path*',\n        has: [\n          {\n            type: 'query',\n            key: 'page',\n            // the page value will not be available in the\n            // destination since value is provided and doesn't\n            // use a named capture group e.g. (?<page>home)\n            value: 'home',"
  },
  {
    "id": "redirects.mdx#9",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "// destination since value is provided and doesn't\n            // use a named capture group e.g. (?<page>home)\n            value: 'home',\n          },\n          {\n            type: 'cookie',\n            key: 'authorized',\n            value: 'true',\n          },\n        ],\n        permanent: false,\n        destination: '/another/:path*',\n      },\n      // if the header `x-authorized` is present and\n      // contains a matching value, this redirect will be applied\n      {\n        source: '/',\n        has: [\n          {\n            type: 'header',\n            key: 'x-authorized',\n            value: '(?<authorized>yes|true)',\n          },\n        ],\n        permanent: false,\n        destination: '/home?authorized=:authorized',\n      },\n      // if the host is `example.com`,\n      // this redirect will be applied\n      {\n        source: '/:path((?!another-page$).*)',\n        has: [\n          {\n            type: 'host',\n            value: 'example.com',\n          },\n        ],\n        permanent: false,\n        destination: '/another-page',\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "redirects.mdx#10",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "### Redirects with basePath support\n\nWhen leveraging [`basePath` support](/docs/app/api-reference/config/next-config-js/basePath) with redirects each `source` and `destination` is automatically prefixed with the `basePath` unless you add `basePath: false` to the redirect:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  basePath: '/docs',\n\n  async redirects() {\n    return [\n      {\n        source: '/with-basePath', // automatically becomes /docs/with-basePath\n        destination: '/another', // automatically becomes /docs/another\n        permanent: false,\n      },\n      {\n        // does not add /docs since basePath: false is set\n        source: '/without-basePath',\n        destination: 'https://example.com',\n        basePath: false,\n        permanent: false,\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "redirects.mdx#11",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "### Redirects with i18n support\n\n<AppOnly>\n\nWhen implementing redirects with internationalization in the App Router, you can include locales in `next.config.js` redirects, but only as hardcoded paths.\n\nFor dynamic or per-request locale handling, use [dynamic route segments and proxy](/docs/app/guides/internationalization), which can redirect based on the user's preferred language.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async redirects() {\n    return [\n      {\n        // Manually handle locale prefixes for App Router\n        source: '/en/old-path',\n        destination: '/en/new-path',\n        permanent: false,\n      },\n      {\n        // Redirect for all locales using a parameter\n        source: '/:locale/old-path',\n        destination: '/:locale/new-path',\n        permanent: false,\n      },\n      {\n        // Redirect from one locale to another\n        source: '/de/old-path',\n        destination: '/en/new-path',\n        permanent: false,\n      },\n      {\n        // Catch-all redirect for multiple locales\n        source: '/:locale(en|fr|de)/:path*',\n        destination: '/:locale/new-section/:path*',\n        permanent: false,\n      },\n    ]\n  },\n}"
  },
  {
    "id": "redirects.mdx#12",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "```\n\n</AppOnly>\n\n<PagesOnly>\n\nWhen leveraging [`i18n` support](/docs/pages/guides/internationalization) with redirects each `source` and `destination` is automatically prefixed to handle the configured `locales` unless you add `locale: false` to the redirect. If `locale: false` is used you must prefix the `source` and `destination` with a locale for it to be matched correctly.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  i18n: {\n    locales: ['en', 'fr', 'de'],\n    defaultLocale: 'en',\n  },"
  },
  {
    "id": "redirects.mdx#13",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "async redirects() {\n    return [\n      {\n        source: '/with-locale', // automatically handles all locales\n        destination: '/another', // automatically passes the locale on\n        permanent: false,\n      },\n      {\n        // does not handle locales automatically since locale: false is set\n        source: '/nl/with-locale-manual',\n        destination: '/nl/another',\n        locale: false,\n        permanent: false,\n      },\n      {\n        // this matches '/' since `en` is the defaultLocale\n        source: '/en',\n        destination: '/en/another',\n        locale: false,\n        permanent: false,\n      },\n      // it's possible to match all locales even when locale: false is set\n      {\n        source: '/:locale/page',\n        destination: '/en/newpage',\n        permanent: false,\n        locale: false,\n      },\n      {\n        // this gets converted to /(en|fr|de)/(.*) so will not match the top-level\n        // `/` or `/fr` routes like /:path* would\n        source: '/(.*)',\n        destination: '/another',\n        permanent: false,\n      },\n    ]\n  },\n}"
  },
  {
    "id": "redirects.mdx#14",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "```\n\n</PagesOnly>\n\nIn some rare cases, you might need to assign a custom status code for older HTTP Clients to properly redirect. In these cases, you can use the `statusCode` property instead of the `permanent` property, but not both. To ensure IE11 compatibility, a `Refresh` header is automatically added for the 308 status code."
  },
  {
    "id": "redirects.mdx#15",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "## Other Redirects\n\n- Inside [API Routes](/docs/pages/building-your-application/routing/api-routes) and [Route Handlers](/docs/app/api-reference/file-conventions/route), you can redirect based on the incoming request.\n- Inside [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) and [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props), you can redirect specific pages at request-time.\n\n## Version History\n\n| Version   | Changes            |\n| --------- | ------------------ |\n| `v13.3.0` | `missing` added.   |\n| `v10.2.0` | `has` added.       |\n| `v9.5.0`  | `redirects` added. |"
  },
  {
    "id": "rewrites.mdx#0",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "---\ntitle: rewrites\ndescription: Add rewrites to your Next.js app.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nRewrites allow you to map an incoming request path to a different destination path.\n\n<AppOnly>\n\nRewrites act as a URL proxy and mask the destination path, making it appear the user hasn't changed their location on the site. In contrast, [redirects](/docs/app/api-reference/config/next-config-js/redirects) will reroute to a new page and show the URL changes.\n\n</AppOnly>\n\n<PagesOnly>\n\nRewrites act as a URL proxy and mask the destination path, making it appear the user hasn't changed their location on the site. In contrast, [redirects](/docs/pages/api-reference/config/next-config-js/redirects) will reroute to a new page and show the URL changes.\n\n</PagesOnly>\n\nTo use rewrites you can use the `rewrites` key in `next.config.js`:"
  },
  {
    "id": "rewrites.mdx#1",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "</PagesOnly>\n\nTo use rewrites you can use the `rewrites` key in `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/about',\n        destination: '/',\n      },\n    ]\n  },\n}"
  },
  {
    "id": "rewrites.mdx#2",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "```\n\nRewrites are applied to client-side routing. In the example above, navigating to `<Link href=\"/about\">` will serve content from `/` while keeping the URL as `/about`.\n\n`rewrites` is an async function that expects to return either an array or an object of arrays (see below) holding objects with `source` and `destination` properties:\n\n- `source`: `String` - is the incoming request path pattern.\n- `destination`: `String` is the path you want to route to.\n- `basePath`: `false` or `undefined` - if false the basePath won't be included when matching, can be used for external rewrites only.\n- `locale`: `false` or `undefined` - whether the locale should not be included when matching.\n- `has` is an array of [has objects](#header-cookie-and-query-matching) with the `type`, `key` and `value` properties.\n- `missing` is an array of [missing objects](#header-cookie-and-query-matching) with the `type`, `key` and `value` properties."
  },
  {
    "id": "rewrites.mdx#3",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "When the `rewrites` function returns an array, rewrites are applied after checking the filesystem (pages and `/public` files) and before dynamic routes. When the `rewrites` function returns an object of arrays with a specific shape, this behavior can be changed and more finely controlled, as of `v10.1` of Next.js:"
  },
  {
    "id": "rewrites.mdx#4",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return {\n      beforeFiles: [\n        // These rewrites are checked after headers/redirects\n        // and before all files including _next/public files which\n        // allows overriding page files\n        {\n          source: '/some-page',\n          destination: '/somewhere-else',\n          has: [{ type: 'query', key: 'overrideMe' }],\n        },\n      ],\n      afterFiles: [\n        // These rewrites are checked after pages/public files\n        // are checked but before dynamic routes\n        {\n          source: '/non-existent',\n          destination: '/somewhere-else',\n        },\n      ],\n      fallback: [\n        // These rewrites are checked after both pages/public files\n        // and dynamic routes are checked\n        {\n          source: '/:path*',\n          destination: `https://my-old-site.com/:path*`,\n        },\n      ],\n    }\n  },\n}"
  },
  {
    "id": "rewrites.mdx#5",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "```\n\n> **Good to know**: rewrites in `beforeFiles` do not check the filesystem/dynamic routes immediately after matching a source, they continue until all `beforeFiles` have been checked.\n\nThe order Next.js routes are checked is:\n\n<AppOnly>\n\n1. [headers](/docs/app/api-reference/config/next-config-js/headers) are checked/applied\n2. [redirects](/docs/app/api-reference/config/next-config-js/redirects) are checked/applied\n3. [proxy](/docs/app/api-reference/file-conventions/proxy)\n4. `beforeFiles` rewrites are checked/applied\n5. static files from the [public directory](/docs/app/api-reference/file-conventions/public-folder), `_next/static` files, and non-dynamic pages are checked/served\n6. `afterFiles` rewrites are checked/applied, if one of these rewrites is matched we check dynamic routes/static files after each match\n7. `fallback` rewrites are checked/applied, these are applied before rendering the 404 page and after dynamic routes/all static assets have been checked. If you use [fallback: true/'blocking'](/docs/pages/api-reference/functions/get-static-paths#fallback-true) in `getStaticPaths`, the fallback `rewrites` defined in your `next.config.js` will _not_ be run.\n\n</AppOnly>"
  },
  {
    "id": "rewrites.mdx#6",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "</AppOnly>\n\n<PagesOnly>\n\n1. [headers](/docs/pages/api-reference/config/next-config-js/headers) are checked/applied\n2. [redirects](/docs/pages/api-reference/config/next-config-js/redirects) are checked/applied\n3. `beforeFiles` rewrites are checked/applied\n4. static files from the [public directory](/docs/pages/api-reference/file-conventions/public-folder), `_next/static` files, and non-dynamic pages are checked/served\n5. `afterFiles` rewrites are checked/applied, if one of these rewrites is matched we check dynamic routes/static files after each match\n6. `fallback` rewrites are checked/applied, these are applied before rendering the 404 page and after dynamic routes/all static assets have been checked. If you use [fallback: true/'blocking'](/docs/pages/api-reference/functions/get-static-paths#fallback-true) in `getStaticPaths`, the fallback `rewrites` defined in your `next.config.js` will _not_ be run.\n\n</PagesOnly>"
  },
  {
    "id": "rewrites.mdx#7",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "## Rewrite parameters\n\nWhen using parameters in a rewrite the parameters will be passed in the query by default when none of the parameters are used in the `destination`.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/old-about/:path*',\n        destination: '/about', // The :path parameter isn't used here so will be automatically passed in the query\n      },\n    ]\n  },\n}\n```\n\nIf a parameter is used in the destination none of the parameters will be automatically passed in the query.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/docs/:path*',\n        destination: '/:path*', // The :path parameter is used here so will not be automatically passed in the query\n      },\n    ]\n  },\n}"
  },
  {
    "id": "rewrites.mdx#8",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "```\n\nYou can still pass the parameters manually in the query if one is already used in the destination by specifying the query in the `destination`.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/:first/:second',\n        destination: '/:first?second=:second',\n        // Since the :first parameter is used in the destination the :second parameter\n        // will not automatically be added in the query although we can manually add it\n        // as shown above\n      },\n    ]\n  },\n}\n```\n\n> **Good to know**: Static pages from [Automatic Static Optimization](/docs/pages/building-your-application/rendering/automatic-static-optimization) or [prerendering](/docs/pages/building-your-application/data-fetching/get-static-props) params from rewrites will be parsed on the client after hydration and provided in the query."
  },
  {
    "id": "rewrites.mdx#9",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "## Path Matching\n\nPath matches are allowed, for example `/blog/:slug` will match `/blog/first-post` (no nested paths):\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/blog/:slug',\n        destination: '/news/:slug', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}\n```\n\nThe pattern `/blog/:slug` matches `/blog/first-post` and `/blog/post-1` but not `/blog/a/b` (no nested paths). Patterns are anchored to the start: `/blog/:slug` will not match `/archive/blog/first-post`.\n\nYou can use modifiers on parameters: `*` (zero or more), `+` (one or more), `?` (zero or one). For example, `/blog/:slug*` matches `/blog`, `/blog/a`, and `/blog/a/b/c`.\n\nRead more details on [path-to-regexp](https://github.com/pillarjs/path-to-regexp) documentation."
  },
  {
    "id": "rewrites.mdx#10",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "### Wildcard Path Matching\n\nTo match a wildcard path you can use `*` after a parameter, for example `/blog/:slug*` will match `/blog/a/b/c/d/hello-world`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/blog/:slug*',\n        destination: '/news/:slug*', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "rewrites.mdx#11",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "### Regex Path Matching\n\nTo match a regex path you can wrap the regex in parenthesis after a parameter, for example `/blog/:slug(\\\\d{1,})` will match `/blog/123` but not `/blog/abc`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/old-blog/:post(\\\\d{1,})',\n        destination: '/blog/:post', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}\n```\n\nThe following characters `(`, `)`, `{`, `}`, `[`, `]`, `|`, `\\`, `^`, `.`, `:`, `*`, `+`, `-`, `?`, `$` are used for regex path matching, so when used in the `source` as non-special values they must be escaped by adding `\\\\` before them:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return [\n      {\n        // this will match `/english(default)/something` being requested\n        source: '/english\\\\(default\\\\)/:slug',\n        destination: '/en-us/:slug',\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "rewrites.mdx#12",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "## Header, Cookie, and Query Matching\n\nTo only match a rewrite when header, cookie, or query values also match the `has` field or don't match the `missing` field can be used. Both the `source` and all `has` items must match and all `missing` items must not match for the rewrite to be applied.\n\n`has` and `missing` items can have the following fields:\n\n- `type`: `String` - must be either `header`, `cookie`, `host`, or `query`.\n- `key`: `String` - the key from the selected type to match against.\n- `value`: `String` or `undefined` - the value to check for, if undefined any value will match. A regex like string can be used to capture a specific part of the value, e.g. if the value `first-(?<paramName>.*)` is used for `first-second` then `second` will be usable in the destination with `:paramName`."
  },
  {
    "id": "rewrites.mdx#13",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return [\n      // if the header `x-rewrite-me` is present,\n      // this rewrite will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-rewrite-me',\n          },\n        ],\n        destination: '/another-page',\n      },\n      // if the header `x-rewrite-me` is not present,\n      // this rewrite will be applied\n      {\n        source: '/:path*',\n        missing: [\n          {\n            type: 'header',\n            key: 'x-rewrite-me',\n          },\n        ],\n        destination: '/another-page',\n      },\n      // if the source, query, and cookie are matched,\n      // this rewrite will be applied\n      {\n        source: '/specific/:path*',\n        has: [\n          {\n            type: 'query',\n            key: 'page',\n            // the page value will not be available in the\n            // destination since value is provided and doesn't\n            // use a named capture group e.g. (?<page>home)\n            value: 'home',\n          },\n          {\n            type: 'cookie',\n            key: 'authorized',\n            value: 'true',"
  },
  {
    "id": "rewrites.mdx#14",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "// use a named capture group e.g. (?<page>home)\n            value: 'home',\n          },\n          {\n            type: 'cookie',\n            key: 'authorized',\n            value: 'true',\n          },\n        ],\n        destination: '/:path*/home',\n      },\n      // if the header `x-authorized` is present and\n      // contains a matching value, this rewrite will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-authorized',\n            value: '(?<authorized>yes|true)',\n          },\n        ],\n        destination: '/home?authorized=:authorized',\n      },\n      // if the host is `example.com`,\n      // this rewrite will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'host',\n            value: 'example.com',\n          },\n        ],\n        destination: '/another-page',\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "rewrites.mdx#15",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "## Rewriting to an external URL\n\n<details>\n  <summary>Examples</summary>\n\n- [Using Multiple Zones](https://github.com/vercel/next.js/tree/canary/examples/with-zones)\n\n</details>\n\nRewrites allow you to rewrite to an external URL. This is especially useful for incrementally adopting Next.js. The following is an example rewrite for redirecting the `/blog` route of your main app to an external site.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/blog',\n        destination: 'https://example.com/blog',\n      },\n      {\n        source: '/blog/:slug',\n        destination: 'https://example.com/blog/:slug', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}"
  },
  {
    "id": "rewrites.mdx#16",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "```\n\nIf you're using `trailingSlash: true`, you also need to insert a trailing slash in the `source` parameter. If the destination server is also expecting a trailing slash it should be included in the `destination` parameter as well.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  trailingSlash: true,\n  async rewrites() {\n    return [\n      {\n        source: '/blog/',\n        destination: 'https://example.com/blog/',\n      },\n      {\n        source: '/blog/:path*/',\n        destination: 'https://example.com/blog/:path*/',\n      },\n    ]\n  },\n}\n```"
  },
  {
    "id": "rewrites.mdx#17",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "### Incremental adoption of Next.js\n\nYou can also have Next.js fall back to proxying to an existing website after checking all Next.js routes.\n\nThis way you don't have to change the rewrites configuration when migrating more pages to Next.js\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  async rewrites() {\n    return {\n      fallback: [\n        {\n          source: '/:path*',\n          destination: `https://custom-routes-proxying-endpoint.vercel.app/:path*`,\n        },\n      ],\n    }\n  },\n}\n```"
  },
  {
    "id": "rewrites.mdx#18",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "### Rewrites with basePath support\n\nWhen leveraging [`basePath` support](/docs/app/api-reference/config/next-config-js/basePath) with rewrites each `source` and `destination` is automatically prefixed with the `basePath` unless you add `basePath: false` to the rewrite:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  basePath: '/docs',\n\n  async rewrites() {\n    return [\n      {\n        source: '/with-basePath', // automatically becomes /docs/with-basePath\n        destination: '/another', // automatically becomes /docs/another\n      },\n      {\n        // does not add /docs to /without-basePath since basePath: false is set\n        // Note: this can not be used for internal rewrites e.g. `destination: '/another'`\n        source: '/without-basePath',\n        destination: 'https://example.com',\n        basePath: false,\n      },\n    ]\n  },\n}\n```\n\n<PagesOnly>"
  },
  {
    "id": "rewrites.mdx#19",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "### Rewrites with i18n support\n\nWhen leveraging [`i18n` support](/docs/pages/guides/internationalization) with rewrites each `source` and `destination` is automatically prefixed to handle the configured `locales` unless you add `locale: false` to the rewrite. If `locale: false` is used you must prefix the `source` and `destination` with a locale for it to be matched correctly.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  i18n: {\n    locales: ['en', 'fr', 'de'],\n    defaultLocale: 'en',\n  },"
  },
  {
    "id": "rewrites.mdx#20",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "```js filename=\"next.config.js\"\nmodule.exports = {\n  i18n: {\n    locales: ['en', 'fr', 'de'],\n    defaultLocale: 'en',\n  },\n\n  async rewrites() {\n    return [\n      {\n        source: '/with-locale', // automatically handles all locales\n        destination: '/another', // automatically passes the locale on\n      },\n      {\n        // does not handle locales automatically since locale: false is set\n        source: '/nl/with-locale-manual',\n        destination: '/nl/another',\n        locale: false,\n      },\n      {\n        // this matches '/' since `en` is the defaultLocale\n        source: '/en',\n        destination: '/en/another',\n        locale: false,\n      },\n      {\n        // it's possible to match all locales even when locale: false is set\n        source: '/:locale/api-alias/:path*',\n        destination: '/api/:path*',\n        locale: false,\n      },\n      {\n        // this gets converted to /(en|fr|de)/(.*) so will not match the top-level\n        // `/` or `/fr` routes like /:path* would\n        source: '/(.*)',\n        destination: '/another',\n      },\n    ]\n  },\n}"
  },
  {
    "id": "rewrites.mdx#21",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "```\n\n</PagesOnly>"
  },
  {
    "id": "rewrites.mdx#22",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "## Version History\n\n| Version   | Changes          |\n| --------- | ---------------- |\n| `v13.3.0` | `missing` added. |\n| `v10.2.0` | `has` added.     |\n| `v9.5.0`  | Headers added.   |"
  },
  {
    "id": "sassOptions.mdx#0",
    "metadata": {
      "title": "sassOptions",
      "description": "Configure Sass options."
    },
    "content": "---\ntitle: sassOptions\ndescription: Configure Sass options.\n---\n\n`sassOptions` allow you to configure the Sass compiler.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst sassOptions = {\n  additionalData: `\n    $var: red;\n  `,\n}\n\nconst nextConfig: NextConfig = {\n  sassOptions: {\n    ...sassOptions,\n    implementation: 'sass-embedded',\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\n\nconst sassOptions = {\n  additionalData: `\n    $var: red;\n  `,\n}\n\nconst nextConfig = {\n  sassOptions: {\n    ...sassOptions,\n    implementation: 'sass-embedded',\n  },\n}\n\nmodule.exports = nextConfig\n```\n\n> **Good to know:**\n>\n> - `sassOptions` are not typed outside of `implementation` because Next.js does not maintain the other possible properties.\n> - The `functions` property for defining custom Sass functions is only supported with webpack. When using Turbopack, custom Sass functions are not available because Turbopack's Rust-based architecture cannot directly execute JavaScript functions passed through this option."
  },
  {
    "id": "serverActions.mdx#0",
    "metadata": {
      "title": "serverActions",
      "description": "Configure Server Actions behavior in your Next.js application."
    },
    "content": "---\ntitle: serverActions\ndescription: Configure Server Actions behavior in your Next.js application.\n---\n\nOptions for configuring Server Actions behavior in your Next.js application.\n\n## `allowedOrigins`\n\nA list of extra safe origin domains from which Server Actions can be invoked. Next.js compares the origin of a Server Action request with the host domain, ensuring they match to prevent CSRF attacks. If not provided, only the same origin is allowed.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\n\nmodule.exports = {\n  experimental: {\n    serverActions: {\n      allowedOrigins: ['my-proxy.com', '*.my-proxy.com'],\n    },\n  },\n}\n```"
  },
  {
    "id": "serverActions.mdx#1",
    "metadata": {
      "title": "serverActions",
      "description": "Configure Server Actions behavior in your Next.js application."
    },
    "content": "## `bodySizeLimit`\n\nBy default, the maximum size of the request body sent to a Server Action is 1MB, to prevent the consumption of excessive server resources in parsing large amounts of data, as well as potential DDoS attacks.\n\nHowever, you can configure this limit using the `serverActions.bodySizeLimit` option. It can take the number of bytes or any string format supported by bytes, for example `1000`, `'500kb'` or `'3mb'`.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\n\nmodule.exports = {\n  experimental: {\n    serverActions: {\n      bodySizeLimit: '2mb',\n    },\n  },\n}\n```\n\n## Enabling Server Actions (v13)\n\nServer Actions became a stable feature in Next.js 14, and are enabled by default. However, if you are using an earlier version of Next.js, you can enable them by setting `experimental.serverActions` to `true`.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst config = {\n  experimental: {\n    serverActions: true,\n  },\n}\n\nmodule.exports = config\n```"
  },
  {
    "id": "serverComponentsHmrCache.mdx#0",
    "metadata": {
      "title": "serverComponentsHmrCache",
      "description": "Configure whether fetch responses in Server Components are cached across HMR refresh requests."
    },
    "content": "---\ntitle: serverComponentsHmrCache\ndescription: Configure whether fetch responses in Server Components are cached across HMR refresh requests.\nversion: experimental\n---\n\nThe experimental `serverComponentsHmrCache` option allows you to cache `fetch` responses in Server Components across Hot Module Replacement (HMR) refreshes in local development. This results in faster responses and reduced costs for billed API calls.\n\nBy default, the HMR cache applies to all `fetch` requests, including those with the `cache: 'no-store'` option. This means uncached requests will not show fresh data between HMR refreshes. However, the cache will be cleared on navigation or full-page reloads.\n\nYou can disable the HMR cache by setting `serverComponentsHmrCache` to `false` in your `next.config.js` file:\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    serverComponentsHmrCache: false, // defaults to true\n  },\n}\n\nexport default nextConfig"
  },
  {
    "id": "serverComponentsHmrCache.mdx#1",
    "metadata": {
      "title": "serverComponentsHmrCache",
      "description": "Configure whether fetch responses in Server Components are cached across HMR refresh requests."
    },
    "content": "```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    serverComponentsHmrCache: false, // defaults to true\n  },\n}\n\nmodule.exports = nextConfig\n```\n\n> **Good to know:** For better observability, we recommend using the [`logging.fetches`](/docs/app/api-reference/config/next-config-js/logging) option which logs fetch cache hits and misses in the console during development."
  },
  {
    "id": "serverExternalPackages.mdx#0",
    "metadata": {
      "title": "serverExternalPackages",
      "description": "Opt-out specific dependencies from the Server Components bundling and use native Node.js `require`."
    },
    "content": "---\ntitle: serverExternalPackages\ndescription: Opt-out specific dependencies from the Server Components bundling and use native Node.js `require`.\n---\n\nDependencies used inside [Server Components](/docs/app/getting-started/server-and-client-components) and [Route Handlers](/docs/app/api-reference/file-conventions/route) will automatically be bundled by Next.js.\n\nIf a dependency is using Node.js specific features, you can choose to opt-out specific dependencies from the Server Components bundling and use native Node.js `require`.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  serverExternalPackages: ['@acme/ui'],\n}\n\nmodule.exports = nextConfig"
  },
  {
    "id": "serverExternalPackages.mdx#1",
    "metadata": {
      "title": "serverExternalPackages",
      "description": "Opt-out specific dependencies from the Server Components bundling and use native Node.js `require`."
    },
    "content": "```\n\nNext.js includes a [short list of popular packages](https://github.com/vercel/next.js/blob/canary/packages/next/src/lib/server-external-packages.json) that currently are working on compatibility and automatically opt-ed out:"
  },
  {
    "id": "serverExternalPackages.mdx#2",
    "metadata": {
      "title": "serverExternalPackages",
      "description": "Opt-out specific dependencies from the Server Components bundling and use native Node.js `require`."
    },
    "content": "- `@appsignal/nodejs`\n- `@aws-sdk/client-s3`\n- `@aws-sdk/s3-presigned-post`\n- `@blockfrost/blockfrost-js`\n- `@highlight-run/node`\n- `@huggingface/transformers`\n- `@jpg-store/lucid-cardano`\n- `@libsql/client`\n- `@mikro-orm/core`\n- `@mikro-orm/knex`\n- `@node-rs/argon2`\n- `@node-rs/bcrypt`\n- `@prisma/client`\n- `@react-pdf/renderer`\n- `@sentry/profiling-node`\n- `@sparticuz/chromium`\n- `@sparticuz/chromium-min`\n- `@statsig/statsig-node-core`\n- `@swc/core`\n- `@xenova/transformers`\n- `argon2`\n- `autoprefixer`\n- `aws-crt`\n- `bcrypt`\n- `better-sqlite3`\n- `canvas`\n- `chromadb-default-embed`\n- `config`\n- `cpu-features`\n- `cypress`\n- `dd-trace`\n- `eslint`\n- `express`\n- `firebase-admin`\n- `htmlrewriter`\n- `import-in-the-middle`\n- `isolated-vm`\n- `jest`\n- `jsdom`\n- `keyv`\n- `libsql`\n- `mdx-bundler`\n- `mongodb`\n- `mongoose`\n- `newrelic`\n- `next-mdx-remote`\n- `next-seo`\n- `node-cron`\n- `node-pty`\n- `node-web-audio-api`\n- `onnxruntime-node`\n- `oslo`\n- `pg`\n- `playwright`\n- `playwright-core`\n- `postcss`\n- `prettier`\n- `prisma`\n- `puppeteer-core`\n- `puppeteer`\n- `ravendb`\n- `require-in-the-middle`\n- `rimraf`\n- `sharp`\n- `shiki`\n- `sqlite3`\n- `ts-node`\n- `ts-morph`\n- `typescript`"
  },
  {
    "id": "serverExternalPackages.mdx#3",
    "metadata": {
      "title": "serverExternalPackages",
      "description": "Opt-out specific dependencies from the Server Components bundling and use native Node.js `require`."
    },
    "content": "- `postcss`\n- `prettier`\n- `prisma`\n- `puppeteer-core`\n- `puppeteer`\n- `ravendb`\n- `require-in-the-middle`\n- `rimraf`\n- `sharp`\n- `shiki`\n- `sqlite3`\n- `ts-node`\n- `ts-morph`\n- `typescript`\n- `vscode-oniguruma`\n- `webpack`\n- `websocket`\n- `zeromq`"
  },
  {
    "id": "serverExternalPackages.mdx#4",
    "metadata": {
      "title": "serverExternalPackages",
      "description": "Opt-out specific dependencies from the Server Components bundling and use native Node.js `require`."
    },
    "content": "| Version   | Changes                                                                                                        |\n| --------- | -------------------------------------------------------------------------------------------------------------- |\n| `v15.0.0` | Moved from experimental to stable. Renamed from `serverComponentsExternalPackages` to `serverExternalPackages` |"
  },
  {
    "id": "staleTimes.mdx#0",
    "metadata": {
      "title": "staleTimes",
      "description": "Learn how to override the invalidation time of the Client Router Cache."
    },
    "content": "---\ntitle: staleTimes\ndescription: Learn how to override the invalidation time of the Client Router Cache.\nversion: experimental\n---\n\n`staleTimes` is an experimental feature that enables caching of page segments in the [client-side router cache](/docs/app/guides/caching#client-side-router-cache).\n\nYou can enable this experimental feature and provide custom revalidation times by setting the experimental `staleTimes` flag:\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    staleTimes: {\n      dynamic: 30,\n      static: 180,\n    },\n  },\n}\n\nmodule.exports = nextConfig"
  },
  {
    "id": "staleTimes.mdx#1",
    "metadata": {
      "title": "staleTimes",
      "description": "Learn how to override the invalidation time of the Client Router Cache."
    },
    "content": "```\n\nThe `static` and `dynamic` properties correspond with the time period (in seconds) based on different types of [link prefetching](/docs/app/api-reference/components/link#prefetch).\n\n- The `dynamic` property is used when the page is neither statically generated nor fully prefetched (e.g. with `prefetch={true}`).\n  - Default: 0 seconds (not cached)\n- The `static` property is used for statically generated pages, or when the `prefetch` prop on `Link` is set to `true`, or when calling [`router.prefetch`](/docs/app/guides/caching#routerprefetch).\n  - Default: 5 minutes\n\n> **Good to know:**\n>\n> - [Loading boundaries](/docs/app/api-reference/file-conventions/loading) are considered reusable for the `static` period defined in this configuration.\n> - This doesn't affect [partial rendering](/docs/app/getting-started/linking-and-navigating#client-side-transitions), **meaning shared layouts won't automatically be refetched on every navigation, only the page segment that changes.**\n> - This doesn't change [back/forward caching](/docs/app/guides/caching#client-side-router-cache) behavior to prevent layout shift and to prevent losing the browser scroll position."
  },
  {
    "id": "staleTimes.mdx#2",
    "metadata": {
      "title": "staleTimes",
      "description": "Learn how to override the invalidation time of the Client Router Cache."
    },
    "content": "You can learn more about the Client Router Cache [here](/docs/app/guides/caching#client-side-router-cache)."
  },
  {
    "id": "staleTimes.mdx#3",
    "metadata": {
      "title": "staleTimes",
      "description": "Learn how to override the invalidation time of the Client Router Cache."
    },
    "content": "### Version History\n\n| Version   | Changes                                                    |\n| --------- | ---------------------------------------------------------- |\n| `v15.0.0` | The `dynamic` `staleTimes` default changed from 30s to 0s. |\n| `v14.2.0` | Experimental `staleTimes` introduced.                      |"
  },
  {
    "id": "staticGeneration.mdx#0",
    "metadata": {
      "title": "staticGeneration*",
      "description": "Learn how to configure static generation in your Next.js application."
    },
    "content": "---\ntitle: staticGeneration*\ndescription: Learn how to configure static generation in your Next.js application.\nversion: experimental\n---\n\nThe `staticGeneration*` options allow you to configure the Static Generation process for advanced use cases.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    staticGenerationRetryCount: 1,\n    staticGenerationMaxConcurrency: 8,\n    staticGenerationMinPagesPerWorker: 25,\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\nconst nextConfig = {\n  experimental: {\n    staticGenerationRetryCount: 1,\n    staticGenerationMaxConcurrency: 8,\n    staticGenerationMinPagesPerWorker: 25,\n  },\n}\n\nexport default nextConfig\n```\n\n## Config Options\n\nThe following options are available:\n\n- `staticGenerationRetryCount`: The number of times to retry a failed page generation before failing the build.\n- `staticGenerationMaxConcurrency`: The maximum number of pages to be processed per worker.\n- `staticGenerationMinPagesPerWorker`: The minimum number of pages to be processed before starting a new worker."
  },
  {
    "id": "taint.mdx#0",
    "metadata": {
      "title": "taint",
      "description": "Enable tainting Objects and Values."
    },
    "content": "---\ntitle: taint\ndescription: Enable tainting Objects and Values.\nversion: experimental\n---"
  },
  {
    "id": "taint.mdx#1",
    "metadata": {
      "title": "taint",
      "description": "Enable tainting Objects and Values."
    },
    "content": "## Usage\n\nThe `taint` option enables support for experimental React APIs for tainting objects and values. This feature helps prevent sensitive data from being accidentally passed to the client. When enabled, you can use:\n\n- [`experimental_taintObjectReference`](https://react.dev/reference/react/experimental_taintObjectReference) taint objects references.\n- [`experimental_taintUniqueValue`](https://react.dev/reference/react/experimental_taintUniqueValue) to taint unique values.\n\n> **Good to know**: Activating this flag also enables the React `experimental` channel for `app` directory.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    taint: true,\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    taint: true,\n  },\n}\n\nmodule.exports = nextConfig"
  },
  {
    "id": "taint.mdx#2",
    "metadata": {
      "title": "taint",
      "description": "Enable tainting Objects and Values."
    },
    "content": "```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    taint: true,\n  },\n}\n\nmodule.exports = nextConfig\n```\n\n> **Warning:** Do not rely on the taint API as your only mechanism to prevent exposing sensitive data to the client. See our [security recommendations](/blog/security-nextjs-server-components-actions).\n\nThe taint APIs allows you to be defensive, by declaratively and explicitly marking data that is not allowed to pass through the Server-Client boundary. When an object or value, is passed through the Server-Client boundary, React throws an error.\n\nThis is helpful for cases where:\n\n- The methods to read data are out of your control\n- You have to work with sensitive data shapes not defined by you\n- Sensitive data is accessed during Server Component rendering\n\nIt is recommended to model your data and APIs so that sensitive data is not returned to contexts where it is not needed."
  },
  {
    "id": "taint.mdx#3",
    "metadata": {
      "title": "taint",
      "description": "Enable tainting Objects and Values."
    },
    "content": "## Caveats\n\n- Tainting can only keep track of objects by reference. Copying an object creates an untainted version, which loses all guarantees given by the API. You'll need to taint the copy.\n- Tainting cannot keep track of data derived from a tainted value. You also need to taint the derived value.\n- Values are tainted for as long as their lifetime reference is within scope. See the [`experimental_taintUniqueValue` parameters reference](https://react.dev/reference/react/experimental_taintUniqueValue#parameters), for more information."
  },
  {
    "id": "taint.mdx#4",
    "metadata": {
      "title": "taint",
      "description": "Enable tainting Objects and Values."
    },
    "content": "## Examples"
  },
  {
    "id": "taint.mdx#5",
    "metadata": {
      "title": "taint",
      "description": "Enable tainting Objects and Values."
    },
    "content": "### Tainting an object reference\n\nIn this case, the `getUserDetails` function returns data about a given user. We taint the user object reference, so that it cannot cross a Server-Client boundary. For example, assuming `UserCard` is a Client Component.\n\n```ts switcher\nimport { experimental_taintObjectReference } from 'react'\n\nfunction getUserDetails(id: string): UserDetails {\n  const user = await db.queryUserById(id)\n\n  experimental_taintObjectReference(\n    'Do not use the entire user info object. Instead, select only the fields you need.',\n    user\n  )\n\n  return user\n}\n```\n\n```js switcher\nimport { experimental_taintObjectReference } from 'react'\n\nfunction getUserDetails(id) {\n  const user = await db.queryUserById(id)\n\n  experimental_taintObjectReference(\n    'Do not use the entire user info object. Instead, select only the fields you need.',\n    user\n  )\n\n  return user\n}"
  },
  {
    "id": "taint.mdx#6",
    "metadata": {
      "title": "taint",
      "description": "Enable tainting Objects and Values."
    },
    "content": "```\n\nWe can still access individual fields from the tainted `userDetails` object.\n\n```tsx filename=\"app/contact/page.tsx switcher\nexport async function ContactPage({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const { id } = await params\n  const userDetails = await getUserDetails(id)\n\n  return (\n    <UserCard\n      firstName={userDetails.firstName}\n      lastName={userDetails.lastName}\n    />\n  )\n}\n```\n\n```jsx filename=\"app/contact/page.js switcher\nexport async function ContactPage({ params }) {\n  const { id } = await params\n  const userDetails = await getUserDetails(id)\n\n  return (\n    <UserCard\n      firstName={userDetails.firstName}\n      lastName={userDetails.lastName}\n    />\n  )\n}\n```\n\nNow, passing the entire object to the Client Component will throw an error.\n\n```tsx switcher\nexport async function ContactPage({\n  params,\n}: {\n  params: Promise<{ id: string }>\n}) {\n  const userDetails = await getUserDetails(id)\n\n  // Throws an error\n  return <UserCard user={userDetails} />\n}"
  },
  {
    "id": "taint.mdx#7",
    "metadata": {
      "title": "taint",
      "description": "Enable tainting Objects and Values."
    },
    "content": "```\n\n```jsx switcher\nexport async function ContactPage({ params }) {\n  const { id } = await params\n  const userDetails = await getUserDetails(id)\n\n  // Throws an error\n  return <UserCard user={userDetails} />\n}\n```"
  },
  {
    "id": "taint.mdx#8",
    "metadata": {
      "title": "taint",
      "description": "Enable tainting Objects and Values."
    },
    "content": "### Tainting a unique value\n\nIn this case, we can access the server configuration by awaiting calls to `config.getConfigDetails`. However, the system configuration contains the `SERVICE_API_KEY` that we don't want to expose to clients.\n\nWe can taint the `config.SERVICE_API_KEY` value.\n\n```ts switcher\nimport { experimental_taintUniqueValue } from 'react'\n\nfunction getSystemConfig(): SystemConfig {\n  const config = await config.getConfigDetails()\n\n  experimental_taintUniqueValue(\n    'Do not pass configuration tokens to the client',\n    config,\n    config.SERVICE_API_KEY\n  )\n\n  return config\n}\n```\n\n```js switcher\nimport { experimental_taintUniqueValue } from 'react'\n\nfunction getSystemConfig() {\n  const config = await config.getConfigDetails()\n\n  experimental_taintUniqueValue(\n    'Do not pass configuration tokens to the client',\n    config,\n    config.SERVICE_API_KEY\n  )\n\n  return config\n}\n```\n\nWe can still access other properties of the `systemConfig` object.\n\n```tsx\nexport async function Dashboard() {\n  const systemConfig = await getSystemConfig()\n\n  return <ClientDashboard version={systemConfig.SERVICE_API_VERSION} />\n}"
  },
  {
    "id": "taint.mdx#9",
    "metadata": {
      "title": "taint",
      "description": "Enable tainting Objects and Values."
    },
    "content": "```\n\nHowever, passing `SERVICE_API_KEY` to `ClientDashboard` throws an error.\n\n```tsx\nexport async function Dashboard() {\n  const systemConfig = await getSystemConfig()\n  // Someone makes a mistake in a PR\n  const version = systemConfig.SERVICE_API_KEY\n\n  return <ClientDashboard version={version} />\n}\n```\n\nNote that, even though, `systemConfig.SERVICE_API_KEY` is reassigned to a new variable. Passing it to a Client Component still throws an error.\n\nWhereas, a value derived from a tainted unique value, will be exposed to the client.\n\n```tsx\nexport async function Dashboard() {\n  const systemConfig = await getSystemConfig()\n  // Someone makes a mistake in a PR\n  const version = `version::${systemConfig.SERVICE_API_KEY}`\n\n  return <ClientDashboard version={version} />\n}\n```\n\nA better approach is to remove `SERVICE_API_KEY` from the data returned by `getSystemConfig`."
  },
  {
    "id": "trailingSlash.mdx#0",
    "metadata": {
      "title": "trailingSlash",
      "description": "Configure Next.js pages to resolve with or without a trailing slash."
    },
    "content": "---\ntitle: trailingSlash\ndescription: Configure Next.js pages to resolve with or without a trailing slash.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nBy default Next.js will redirect URLs with trailing slashes to their counterpart without a trailing slash. For example `/about/` will redirect to `/about`. You can configure this behavior to act the opposite way, where URLs without trailing slashes are redirected to their counterparts with trailing slashes.\n\nOpen `next.config.js` and add the `trailingSlash` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  trailingSlash: true,\n}"
  },
  {
    "id": "trailingSlash.mdx#1",
    "metadata": {
      "title": "trailingSlash",
      "description": "Configure Next.js pages to resolve with or without a trailing slash."
    },
    "content": "```\n\nWith this option set, URLs like `/about` will redirect to `/about/`.\n\nWhen using `trailingSlash: true`, certain URLs are exceptions and will not have a trailing slash appended:\n\n- Static file URLs, such as files with extensions.\n- Any paths under `.well-known/`.\n\nFor example, the following URLs will remain unchanged: `/file.txt`, `images/photos/picture.png`, and `.well-known/subfolder/config.json`.\n\nWhen used with [`output: \"export\"`](/docs/app/guides/static-exports) configuration, the `/about` page will output `/about/index.html` (instead of the default `/about.html`)."
  },
  {
    "id": "trailingSlash.mdx#2",
    "metadata": {
      "title": "trailingSlash",
      "description": "Configure Next.js pages to resolve with or without a trailing slash."
    },
    "content": "## Version History\n\n| Version  | Changes                |\n| -------- | ---------------------- |\n| `v9.5.0` | `trailingSlash` added. |"
  },
  {
    "id": "transpilePackages.mdx#0",
    "metadata": {
      "title": "transpilePackages",
      "description": "Automatically transpile and bundle dependencies from local packages (like monorepos) or from external dependencies (`node_modules`)."
    },
    "content": "---\ntitle: transpilePackages\ndescription: Automatically transpile and bundle dependencies from local packages (like monorepos) or from external dependencies (`node_modules`).\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js can automatically transpile and bundle dependencies from local packages (like monorepos) or from external dependencies (`node_modules`). This replaces the `next-transpile-modules` package.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  transpilePackages: ['package-name'],\n}\n\nmodule.exports = nextConfig\n```\n\n## Version History\n\n| Version   | Changes                    |\n| --------- | -------------------------- |\n| `v13.0.0` | `transpilePackages` added. |"
  },
  {
    "id": "turbopack.mdx#0",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "---\ntitle: turbopack\ndescription: Configure Next.js with Turbopack-specific options\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nThe `turbopack` option lets you customize [Turbopack](/docs/app/api-reference/turbopack) to transform different files and change how modules are resolved.\n\n> **Good to know**: The `turbopack` option was previously named `experimental.turbo` in Next.js versions 13.0.0 to 15.2.x. The `experimental.turbo` option will be removed in Next.js 16.\n>\n> If you are using an older version of Next.js, run `npx @next/codemod@latest next-experimental-turbo-to-turbopack .` to automatically migrate your configuration.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  turbopack: {\n    // ...\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  turbopack: {\n    // ...\n  },\n}\n\nmodule.exports = nextConfig"
  },
  {
    "id": "turbopack.mdx#1",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  turbopack: {\n    // ...\n  },\n}\n\nmodule.exports = nextConfig\n```\n\n> **Good to know**:\n>\n> - Turbopack for Next.js does not require loaders or loader configuration for built-in functionality. Turbopack has built-in support for CSS and compiling modern JavaScript, so there's no need for `css-loader`, `postcss-loader`, or `babel-loader` if you're using `@babel/preset-env`."
  },
  {
    "id": "turbopack.mdx#2",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "## Reference"
  },
  {
    "id": "turbopack.mdx#3",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "### Options\n\nThe following options are available for the `turbopack` configuration:"
  },
  {
    "id": "turbopack.mdx#4",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "| Option              | Description                                                                                                                              |\n| ------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |\n| `root`              | Sets the application root directory. Should be an absolute path.                                                                         |\n| `rules`             | List of supported webpack loaders to apply when running with Turbopack.                                                                  |\n| `resolveAlias`      | Map aliased imports to modules to load in their place.                                                                                   |\n| `resolveExtensions` | List of extensions to resolve when importing files.                                                                                      |\n| `debugIds`          | Enable generation of [debug IDs](https://github.com/tc39/ecma426/blob/main/proposals/debug-id.md) in JavaScript bundles and source maps. |"
  },
  {
    "id": "turbopack.mdx#5",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "### Supported loaders\n\nThe following loaders have been tested to work with Turbopack's webpack loader implementation, but many other webpack loaders should work as well even if not listed here:\n\n- [`babel-loader`](https://www.npmjs.com/package/babel-loader) [_(Configured automatically if a Babel configuration file is found)_](/docs/app/api-reference/turbopack#language-features)\n- [`@svgr/webpack`](https://www.npmjs.com/package/@svgr/webpack)\n- [`svg-inline-loader`](https://www.npmjs.com/package/svg-inline-loader)\n- [`yaml-loader`](https://www.npmjs.com/package/yaml-loader)\n- [`string-replace-loader`](https://www.npmjs.com/package/string-replace-loader)\n- [`raw-loader`](https://www.npmjs.com/package/raw-loader)\n- [`sass-loader`](https://www.npmjs.com/package/sass-loader) [_(Configured automatically)_](/docs/app/api-reference/turbopack#css-and-styling)\n- [`graphql-tag/loader`](https://www.npmjs.com/package/graphql-tag)"
  },
  {
    "id": "turbopack.mdx#6",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "#### Missing Webpack loader features\n\nTurbopack uses the [`loader-runner`](https://github.com/webpack/loader-runner) library to execute webpack loaders, which provides most of the standard loader API. However, some features are not supported:\n\n**Module loading:**\n\n- [`importModule`](https://webpack.js.org/api/loaders/#thisimportmodule) - No support\n- [`loadModule`](https://webpack.js.org/api/loaders/#thisloadmodule) - No support\n\n**File system and output:**\n\n- [`fs`](https://webpack.js.org/api/loaders/#thisfs) - Partial support: only `fs.readFile` is currently implemented.\n- [`emitFile`](https://webpack.js.org/api/loaders/#thisemitfile) - No support\n\n**Context properties:**\n\n- [`version`](https://webpack.js.org/api/loaders/#thisversion) - No support\n- [`mode`](https://webpack.js.org/api/loaders/#thismode) - No support\n- [`target`](https://webpack.js.org/api/loaders/#thistarget) - No support\n\n**Utilities:**\n\n- [`utils`](https://webpack.js.org/api/loaders/#thisutils) - No support\n- [`resolve`](https://webpack.js.org/api/loaders/#thisresolve) - No support (use [`getResolve`](https://webpack.js.org/api/loaders/#thisgetresolve) instead)"
  },
  {
    "id": "turbopack.mdx#7",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "If you have a loader that is critically dependent upon one of these features please file an issue."
  },
  {
    "id": "turbopack.mdx#8",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "## Examples\n\n### Root directory\n\nTurbopack uses the root directory to resolve modules. Files outside of the project root are not resolved.\n\nThe reason files are not resolved outside of the project root is to improve cache validation, reduce filesystem watching overhead, and reduce the number of resolving steps needed.\n\nNext.js automatically detects the root directory of your project. It does so by looking for one of these files:\n\n- `pnpm-lock.yaml`\n- `package-lock.json`\n- `yarn.lock`\n- `bun.lock`\n- `bun.lockb`\n\nIf you have a different project structure, for example if you don't use workspaces, you can manually set the `root` option:\n\n```js filename=\"next.config.js\"\nconst path = require('path')\nmodule.exports = {\n  turbopack: {\n    root: path.join(__dirname, '..'),\n  },\n}\n```\n\nTo resolve files from linked dependencies outside the project root (via `npm link`, `yarn link`, `pnpm link`, etc.), you must configure the `turbopack.root` to the parent directory of both the project and the linked dependencies.\n\nWhile this expands the scope of filesystem watching, it's typically only necessary during development when actively working on linked packages."
  },
  {
    "id": "turbopack.mdx#9",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "### Configuring webpack loaders\n\nIf you need loader support beyond what's built in, many webpack loaders already work with Turbopack. There are currently some limitations:\n\n- Only a core subset of the webpack loader API is implemented. Currently, there is enough coverage for some popular loaders, and we'll expand our API support in the future.\n- Only loaders that return JavaScript code are supported. Loaders that transform files like stylesheets or images are not currently supported.\n- Options passed to webpack loaders must be plain JavaScript primitives, objects, and arrays. For example, it's not possible to pass `require()` plugin modules as option values.\n\nTo configure loaders, add the names of the loaders you've installed and any options in `next.config.js`, mapping file extensions to a list of loaders. Rules are evaluated in order.\n\nHere is an example below using the [`@svgr/webpack`](https://www.npmjs.com/package/@svgr/webpack) loader, which enables importing `.svg` files and rendering them as React components."
  },
  {
    "id": "turbopack.mdx#10",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "Here is an example below using the [`@svgr/webpack`](https://www.npmjs.com/package/@svgr/webpack) loader, which enables importing `.svg` files and rendering them as React components.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  turbopack: {\n    rules: {\n      '*.svg': {\n        loaders: ['@svgr/webpack'],\n        as: '*.js',\n      },\n    },\n  },\n}"
  },
  {
    "id": "turbopack.mdx#11",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "```\n\n> **Good to know**: Globs used in the `rules` object match based on file name, unless the glob contains a `/` character, which will cause it to match based on the full project-relative file path. Windows file paths are normalized to use unix-style `/` path separators.\n>\n> Turbopack uses a modified version of the [Rust `globset` library](https://docs.rs/globset/latest/globset/).\n\nFor loaders that require configuration options, you can use an object format instead of a string:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  turbopack: {\n    rules: {\n      '*.svg': {\n        loaders: [\n          {\n            loader: '@svgr/webpack',\n            options: {\n              icon: true,\n            },\n          },\n        ],\n        as: '*.js',\n      },\n    },\n  },\n}\n```\n\n> **Good to know**: Prior to Next.js version 13.4.4, `turbopack.rules` was named `turbo.loaders` and only accepted file extensions like `.mdx` instead of `*.mdx`."
  },
  {
    "id": "turbopack.mdx#12",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "### Advanced webpack loader conditions\n\nYou can further restrict where a loader runs using the advanced `condition` syntax:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  turbopack: {\n    rules: {\n      // '*' will match all file paths, but we restrict where our\n      // rule runs with a condition.\n      '*': {\n        condition: {\n          all: [\n            // 'foreign' is a built-in condition.\n            { not: 'foreign' },\n            // 'path' can be a RegExp or a glob string. A RegExp matches\n            // anywhere in the full project-relative file path.\n            { path: /^img\\/[0-9]{3}\\// },\n            {\n              any: [\n                { path: '*.svg' },\n                // 'content' is always a RegExp, and can match\n                // anywhere in the file.\n                { content: /\\<svg\\W/ },\n              ],\n            },\n          ],\n        },\n        loaders: ['@svgr/webpack'],\n        as: '*.js',\n      },\n    },\n  },\n}"
  },
  {
    "id": "turbopack.mdx#13",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "```\n\n- Supported boolean operators are `{all: [...]}`, `{any: [...]}` and `{not: ...}`.\n- Supported customizable operators are `{path: string | RegExp}` and `{content: RegExp}`. If `path` and `content` are specified in the same object, it acts as an implicit `and`.\n\nIn addition, a number of built-in conditions are supported:\n\n- `browser`: Matches code that will execute on the client. Server code can be matched using `{not: 'browser'}`.\n- `foreign`: Matches code in `node_modules`, as well as some Next.js internals. Usually you'll want to restrict loaders to `{not: 'foreign'}`. This can improve performance by reducing the number of files the loader is invoked on.\n- `development`: Matches when using `next dev`.\n- `production`: Matches when using `next build`.\n- `node`: Matches code that will run on the default Node.js runtime.\n- `edge-light`: Matches code that will run on the [Edge runtime](/docs/app/api-reference/edge).\n\nRules can be an object or an array of objects. An array is often useful for modeling disjoint conditions:"
  },
  {
    "id": "turbopack.mdx#14",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "Rules can be an object or an array of objects. An array is often useful for modeling disjoint conditions:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  turbopack: {\n    rules: {\n      '*.svg': [\n        {\n          condition: 'browser',\n          loaders: ['@svgr/webpack'],\n          as: '*.js',\n        },\n        {\n          condition: { not: 'browser' },\n          loaders: [require.resolve('./custom-svg-loader.js')],\n          as: '*.js',\n        },\n      ],\n    },\n  },\n}"
  },
  {
    "id": "turbopack.mdx#15",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "```\n\n> **Good to know**: All matching rules are executed in order."
  },
  {
    "id": "turbopack.mdx#16",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "### Resolving aliases\n\nTurbopack can be configured to modify module resolution through aliases, similar to webpack's [`resolve.alias`](https://webpack.js.org/configuration/resolve/#resolvealias) configuration.\n\nTo configure resolve aliases, map imported patterns to their new destination in `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  turbopack: {\n    resolveAlias: {\n      underscore: 'lodash',\n      mocha: { browser: 'mocha/browser-entry.js' },\n    },\n  },\n}\n```\n\nThis aliases imports of the `underscore` package to the `lodash` package. In other words, `import underscore from 'underscore'` will load the `lodash` module instead of `underscore`.\n\nTurbopack also supports conditional aliasing through this field, similar to Node.js' [conditional exports](https://nodejs.org/docs/latest-v18.x/api/packages.html#conditional-exports). At the moment only the `browser` condition is supported. In the case above, imports of the `mocha` module will be aliased to `mocha/browser-entry.js` when Turbopack targets browser environments."
  },
  {
    "id": "turbopack.mdx#17",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "### Resolving custom extensions\n\nTurbopack can be configured to resolve modules with custom extensions, similar to webpack's [`resolve.extensions`](https://webpack.js.org/configuration/resolve/#resolveextensions) configuration.\n\nTo configure resolve extensions, use the `resolveExtensions` field in `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  turbopack: {\n    resolveExtensions: ['.mdx', '.tsx', '.ts', '.jsx', '.js', '.mjs', '.json'],\n  },\n}\n```\n\nThis overwrites the original resolve extensions with the provided list. Make sure to include the default extensions.\n\nFor more information and guidance for how to migrate your app to Turbopack from webpack, see [Turbopack's documentation on webpack compatibility](https://turbo.build/pack/docs/migrating-from-webpack)."
  },
  {
    "id": "turbopack.mdx#18",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "### Debug IDs\n\nTurbopack can be configured to generate [debug IDs](https://github.com/tc39/ecma426/blob/main/proposals/debug-id.md) in JavaScript bundles and source maps.\n\nTo configure debug IDs, use the `debugIds` field in `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  turbopack: {\n    debugIds: true,\n  },\n}\n```\n\nThe option automatically adds a polyfill for debug IDs to the JavaScript bundle to ensure compatibility. The debug IDs are available in the `globalThis._debugIds` global variable."
  },
  {
    "id": "turbopack.mdx#19",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "## Version History\n\n| Version  | Changes                                         |\n| -------- | ----------------------------------------------- |\n| `16.0.0` | `turbopack.debugIds` was added.                 |\n| `16.0.0` | `turbopack.rules.*.condition` was added.        |\n| `15.3.0` | `experimental.turbo` is changed to `turbopack`. |\n| `13.0.0` | `experimental.turbo` introduced.                |"
  },
  {
    "id": "turbopackFileSystemCache.mdx#0",
    "metadata": {
      "title": "Turbopack FileSystem Caching",
      "description": "Learn how to enable FileSystem Caching for Turbopack builds"
    },
    "content": "---\ntitle: Turbopack FileSystem Caching\nnav_title: turbopackFileSystemCache\ndescription: Learn how to enable FileSystem Caching for Turbopack builds\n---"
  },
  {
    "id": "turbopackFileSystemCache.mdx#1",
    "metadata": {
      "title": "Turbopack FileSystem Caching",
      "description": "Learn how to enable FileSystem Caching for Turbopack builds"
    },
    "content": "## Usage\n\nTurbopack FileSystem Cache enables Turbopack to reduce work across `next dev` or `next build` commands. When enabled, Turbopack will save and restore data to the `.next` folder between builds, which can greatly speed up subsequent builds and dev sessions.\n\n> **Good to know:** The FileSystem Cache feature is Beta and is still under development. Users adopting should expect some stability issues. We recommend first adopting it for development.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    // Enable filesystem caching for `next dev`\n    turbopackFileSystemCacheForDev: true,\n    // Enable filesystem caching for `next build`\n    turbopackFileSystemCacheForBuild: true,\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    // Enable filesystem caching for `next dev`\n    turbopackFileSystemCacheForDev: true,\n    // Enable filesystem caching for `next build`\n    turbopackFileSystemCacheForBuild: true,\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "turbopackFileSystemCache.mdx#2",
    "metadata": {
      "title": "Turbopack FileSystem Caching",
      "description": "Learn how to enable FileSystem Caching for Turbopack builds"
    },
    "content": "## Version Changes\n\n| Version   | Changes                                                        |\n| --------- | -------------------------------------------------------------- |\n| `v16.0.0` | Beta release with separate flags for build and dev             |\n| `v15.5.0` | Persistent caching released as experimental on canary releases |"
  },
  {
    "id": "typedRoutes.mdx#0",
    "metadata": {
      "title": "typedRoutes",
      "description": "Enable support for statically typed links."
    },
    "content": "---\ntitle: typedRoutes\ndescription: Enable support for statically typed links.\n---\n\n> **Note**: This option has been marked as stable, so you should use `typedRoutes` instead of `experimental.typedRoutes`.\n\nSupport for [statically typed links](/docs/app/api-reference/config/typescript#statically-typed-links). This feature requires using TypeScript in your project.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  typedRoutes: true,\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "typescript.mdx#0",
    "metadata": {
      "title": "typescript",
      "description": "Next.js reports TypeScript errors by default. Learn to opt-out of this behavior here."
    },
    "content": "---\ntitle: typescript\ndescription: Next.js reports TypeScript errors by default. Learn to opt-out of this behavior here.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js fails your **production build** (`next build`) when TypeScript errors are present in your project.\n\nIf you'd like Next.js to dangerously produce production code even when your application has errors, you can disable the built-in type checking step.\n\nIf disabled, be sure you are running type checks as part of your build or deploy process, otherwise this can be very dangerous.\n\nOpen `next.config.js` and enable the `ignoreBuildErrors` option in the `typescript` config:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  typescript: {\n    // !! WARN !!\n    // Dangerously allow production builds to successfully complete even if\n    // your project has type errors.\n    // !! WARN !!\n    ignoreBuildErrors: true,\n  },\n}\n```"
  },
  {
    "id": "urlImports.mdx#0",
    "metadata": {
      "title": "urlImports",
      "description": "Configure Next.js to allow importing modules from external URLs."
    },
    "content": "---\ntitle: urlImports\ndescription: Configure Next.js to allow importing modules from external URLs.\nversion: experimental\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nURL imports are an experimental feature that allows you to import modules directly from external servers (instead of from the local disk).\n\n> **Warning**: Only use domains that you trust to download and execute on your machine. Please exercise discretion, and caution until the feature is flagged as stable.\n\nTo opt-in, add the allowed URL prefixes inside `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  experimental: {\n    urlImports: ['https://example.com/assets/', 'https://cdn.skypack.dev'],\n  },\n}\n```\n\nThen, you can import modules directly from URLs:\n\n```js\nimport { a, b, c } from 'https://example.com/assets/some/module.js'\n```\n\nURL Imports can be used everywhere normal package imports can be used."
  },
  {
    "id": "urlImports.mdx#1",
    "metadata": {
      "title": "urlImports",
      "description": "Configure Next.js to allow importing modules from external URLs."
    },
    "content": "## Security Model\n\nThis feature is being designed with **security as the top priority**. To start, we added an experimental flag forcing you to explicitly allow the domains you accept URL imports from. We're working to take this further by limiting URL imports to execute in the browser sandbox using the [Edge Runtime](/docs/app/api-reference/edge).\n\n## Lockfile\n\nWhen using URL imports, Next.js will create a `next.lock` directory containing a lockfile and fetched assets.\nThis directory **must be committed to Git**, not ignored by `.gitignore`.\n\n- When running `next dev`, Next.js will download and add all newly discovered URL Imports to your lockfile.\n- When running `next build`, Next.js will use only the lockfile to build the application for production.\n\nTypically, no network requests are needed and any outdated lockfile will cause the build to fail.\nOne exception is resources that respond with `Cache-Control: no-cache`.\nThese resources will have a `no-cache` entry in the lockfile and will always be fetched from the network on each build."
  },
  {
    "id": "urlImports.mdx#2",
    "metadata": {
      "title": "urlImports",
      "description": "Configure Next.js to allow importing modules from external URLs."
    },
    "content": "## Examples\n\n### Skypack\n\n```js\nimport confetti from 'https://cdn.skypack.dev/canvas-confetti'\nimport { useEffect } from 'react'\n\nexport default () => {\n  useEffect(() => {\n    confetti()\n  })\n  return <p>Hello</p>\n}\n```\n\n### Static Image Imports\n\n```js\nimport Image from 'next/image'\nimport logo from 'https://example.com/assets/logo.png'\n\nexport default () => (\n  <div>\n    <Image src={logo} placeholder=\"blur\" />\n  </div>\n)\n```\n\n### URLs in CSS\n\n```css\n.className {\n  background: url('https://example.com/assets/hero.jpg');\n}\n```\n\n### Asset Imports\n\n```js\nconst logo = new URL('https://example.com/assets/file.txt', import.meta.url)\n\nconsole.log(logo.pathname)\n\n// prints \"/_next/static/media/file.a9727b5d.txt\"\n```"
  },
  {
    "id": "useLightningcss.mdx#0",
    "metadata": {
      "title": "useLightningcss",
      "description": "Enable experimental support for Lightning CSS."
    },
    "content": "---\ntitle: useLightningcss\ndescription: Enable experimental support for Lightning CSS.\nversion: experimental\n---\n\nExperimental support for using [Lightning CSS](https://lightningcss.dev) with webpack. Lightning CSS is a fast CSS transformer and minifier, written in Rust.\n\nIf this option is not set, Next.js on webpack uses [PostCSS](https://postcss.org/) with [`postcss-preset-env`](https://www.npmjs.com/package/postcss-preset-env) by default.\n\nTurbopack uses Lightning CSS by default since Next 14.2. This configuration option has no effect on Turbopack. Turbopack always uses Lightning CSS.\n\n```ts filename=\"next.config.ts\" switcher\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    useLightningcss: false, // default, ignored on Turbopack\n  },\n}\n\nexport default nextConfig\n```\n\n```js filename=\"next.config.js\" switcher\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    useLightningcss: true, // disables PostCSS on webpack\n  },\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "useLightningcss.mdx#1",
    "metadata": {
      "title": "useLightningcss",
      "description": "Enable experimental support for Lightning CSS."
    },
    "content": "## Version History\n\n| Version  | Changes                                                                                                                                                                                      |\n| -------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `15.1.0` | Support for `useSwcCss` was removed from Turbopack.                                                                                                                                          |\n| `14.2.0` | Turbopack's default CSS processor was changed from `@swc/css` to Lightning CSS. `useLightningcss` became ignored on Turbopack, and a legacy `experimental.turbo.useSwcCss` option was added. |"
  },
  {
    "id": "viewTransition.mdx#0",
    "metadata": {
      "title": "viewTransition",
      "description": "Enable ViewTransition API from React in App Router"
    },
    "content": "---\ntitle: viewTransition\ndescription: Enable ViewTransition API from React in App Router\nversion: experimental\n---\n\n`viewTransition` is an experimental flag that enables the new [View Transitions API](https://developer.mozilla.org/en-US/docs/Web/API/View_Transition_API) in React. This API allows you to leverage the native View Transitions browser API to create seamless transitions between UI states.\n\nTo enable this feature, you need to set the `viewTransition` property to `true` in your `next.config.js` file.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    viewTransition: true,\n  },\n}\n\nmodule.exports = nextConfig\n```\n\n> Important Notice: The `<ViewTransition>` Component is already available in React's Canary release channel.\n> `experimental.viewTransition` is only required to enable deeper integration with Next.js features e.g. automatically\n> [adding Transition types](https://react.dev/reference/react/addTransitionType) for navigations. Next.js specific transition types are not implemented yet."
  },
  {
    "id": "viewTransition.mdx#1",
    "metadata": {
      "title": "viewTransition",
      "description": "Enable ViewTransition API from React in App Router"
    },
    "content": "## Usage\n\nYou can import the [`<ViewTransition>` Component](https://react.dev/reference/react/ViewTransition) from React in your application:\n\n```jsx\nimport { ViewTransition } from 'react'\n```\n\n### Live Demo\n\nCheck out our [Next.js View Transition Demo](https://view-transition-example.vercel.app) to see this feature in action.\n\nAs this API evolves, we will update our documentation and share more examples. However, for now, we strongly advise against using this feature in production."
  },
  {
    "id": "webVitalsAttribution.mdx#0",
    "metadata": {
      "title": "webVitalsAttribution",
      "description": "Learn how to use the webVitalsAttribution option to pinpoint the source of Web Vitals issues."
    },
    "content": "---\ntitle: webVitalsAttribution\ndescription: Learn how to use the webVitalsAttribution option to pinpoint the source of Web Vitals issues.\nversion: experimental\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nWhen debugging issues related to Web Vitals, it is often helpful if we can pinpoint the source of the problem.\nFor example, in the case of Cumulative Layout Shift (CLS), we might want to know the first element that shifted when the single largest layout shift occurred.\nOr, in the case of Largest Contentful Paint (LCP), we might want to identify the element corresponding to the LCP for the page.\nIf the LCP element is an image, knowing the URL of the image resource can help us locate the asset we need to optimize."
  },
  {
    "id": "webVitalsAttribution.mdx#1",
    "metadata": {
      "title": "webVitalsAttribution",
      "description": "Learn how to use the webVitalsAttribution option to pinpoint the source of Web Vitals issues."
    },
    "content": "Pinpointing the biggest contributor to the Web Vitals score, aka [attribution](https://github.com/GoogleChrome/web-vitals/blob/4ca38ae64b8d1e899028c692f94d4c56acfc996c/README.md#attribution),\nallows us to obtain more in-depth information like entries for [PerformanceEventTiming](https://developer.mozilla.org/docs/Web/API/PerformanceEventTiming), [PerformanceNavigationTiming](https://developer.mozilla.org/docs/Web/API/PerformanceNavigationTiming) and [PerformanceResourceTiming](https://developer.mozilla.org/docs/Web/API/PerformanceResourceTiming).\n\nAttribution is disabled by default in Next.js but can be enabled **per metric** by specifying the following in `next.config.js`.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  experimental: {\n    webVitalsAttribution: ['CLS', 'LCP'],\n  },\n}"
  },
  {
    "id": "webVitalsAttribution.mdx#2",
    "metadata": {
      "title": "webVitalsAttribution",
      "description": "Learn how to use the webVitalsAttribution option to pinpoint the source of Web Vitals issues."
    },
    "content": "```\n\nValid attribution values are all `web-vitals` metrics specified in the [`NextWebVitalsMetric`](https://github.com/vercel/next.js/blob/442378d21dd56d6e769863eb8c2cb521a463a2e0/packages/next/shared/lib/utils.ts#L43) type."
  },
  {
    "id": "webpack.mdx#0",
    "metadata": {
      "title": "Custom Webpack Config",
      "description": "Learn how to customize the webpack config used by Next.js"
    },
    "content": "---\ntitle: Custom Webpack Config\nnav_title: webpack\ndescription: Learn how to customize the webpack config used by Next.js\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\n> **Good to know**: changes to webpack config are not covered by semver so proceed at your own risk\n\nBefore continuing to add custom webpack configuration to your application make sure Next.js doesn't already support your use-case:\n\n<AppOnly>\n\n- [CSS imports](/docs/app/getting-started/css)\n- [CSS modules](/docs/app/getting-started/css#css-modules)\n- [Sass/SCSS imports](/docs/app/guides/sass)\n- [Sass/SCSS modules](/docs/app/guides/sass)\n\n</AppOnly>\n\n<PagesOnly>\n\n- [CSS imports](/docs/app/getting-started/css)\n- [CSS modules](/docs/app/getting-started/css)\n- [Sass/SCSS imports](/docs/pages/guides/sass)\n- [Sass/SCSS modules](/docs/pages/guides/sass)\n- [Customizing babel configuration](/docs/pages/guides/babel)\n\n</PagesOnly>\n\nSome commonly asked for features are available as plugins:"
  },
  {
    "id": "webpack.mdx#1",
    "metadata": {
      "title": "Custom Webpack Config",
      "description": "Learn how to customize the webpack config used by Next.js"
    },
    "content": "</PagesOnly>\n\nSome commonly asked for features are available as plugins:\n\n- [@next/mdx](https://github.com/vercel/next.js/tree/canary/packages/next-mdx)\n- [@next/bundle-analyzer](https://github.com/vercel/next.js/tree/canary/packages/next-bundle-analyzer)\n\nIn order to extend our usage of `webpack`, you can define a function that extends its config inside `next.config.js`, like so:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  webpack: (\n    config,\n    { buildId, dev, isServer, defaultLoaders, nextRuntime, webpack }\n  ) => {\n    // Important: return the modified config\n    return config\n  },\n}"
  },
  {
    "id": "webpack.mdx#2",
    "metadata": {
      "title": "Custom Webpack Config",
      "description": "Learn how to customize the webpack config used by Next.js"
    },
    "content": "```\n\n> The `webpack` function is executed three times, twice for the server (nodejs / edge runtime) and once for the client. This allows you to distinguish between client and server configuration using the `isServer` property.\n\nThe second argument to the `webpack` function is an object with the following properties:\n\n- `buildId`: `String` - The build id, used as a unique identifier between builds.\n- `dev`: `Boolean` - Indicates if the compilation will be done in development.\n- `isServer`: `Boolean` - It's `true` for server-side compilation, and `false` for client-side compilation.\n- `nextRuntime`: `String | undefined` - The target runtime for server-side compilation; either `\"edge\"` or `\"nodejs\"`, it's `undefined` for client-side compilation.\n- `defaultLoaders`: `Object` - Default loaders used internally by Next.js:\n  - `babel`: `Object` - Default `babel-loader` configuration.\n\nExample usage of `defaultLoaders.babel`:"
  },
  {
    "id": "webpack.mdx#3",
    "metadata": {
      "title": "Custom Webpack Config",
      "description": "Learn how to customize the webpack config used by Next.js"
    },
    "content": "Example usage of `defaultLoaders.babel`:\n\n```js\n// Example config for adding a loader that depends on babel-loader\n// This source was taken from the @next/mdx plugin source:\n// https://github.com/vercel/next.js/tree/canary/packages/next-mdx\nmodule.exports = {\n  webpack: (config, options) => {\n    config.module.rules.push({\n      test: /\\.mdx/,\n      use: [\n        options.defaultLoaders.babel,\n        {\n          loader: '@mdx-js/loader',\n          options: pluginOptions.options,\n        },\n      ],\n    })\n\n    return config\n  },\n}\n```"
  },
  {
    "id": "webpack.mdx#4",
    "metadata": {
      "title": "Custom Webpack Config",
      "description": "Learn how to customize the webpack config used by Next.js"
    },
    "content": "#### `nextRuntime`\n\nNotice that `isServer` is `true` when `nextRuntime` is `\"edge\"` or `\"nodejs\"`, `nextRuntime` `\"edge\"` is currently for proxy and Server Components in edge runtime only."
  },
  {
    "id": "02-typescript.mdx#0",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "---\ntitle: TypeScript\ndescription: Next.js provides a TypeScript-first development experience for building your React application.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js comes with built-in TypeScript, automatically installing the necessary packages and configuring the proper settings when you create a new project with `create-next-app`.\n\nTo add TypeScript to an existing project, rename a file to `.ts` / `.tsx`. Run `next dev` and `next build` to automatically install the necessary dependencies and add a `tsconfig.json` file with the recommended config options.\n\n> **Good to know**: If you already have a `jsconfig.json` file, copy the `paths` compiler option from the old `jsconfig.json` into the new `tsconfig.json` file, and delete the old `jsconfig.json` file.\n\n<AppOnly>"
  },
  {
    "id": "02-typescript.mdx#1",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "## IDE Plugin\n\nNext.js includes a custom TypeScript plugin and type checker, which VSCode and other code editors can use for advanced type-checking and auto-completion.\n\nYou can enable the plugin in VS Code by:\n\n1. Opening the command palette (`Ctrl/⌘` + `Shift` + `P`)\n2. Searching for \"TypeScript: Select TypeScript Version\"\n3. Selecting \"Use Workspace Version\"\n\n<Image\n  alt=\"TypeScript Command Palette\"\n  srcLight=\"/docs/light/typescript-command-palette.png\"\n  srcDark=\"/docs/dark/typescript-command-palette.png\"\n  width=\"1600\"\n  height=\"637\"\n/>\n\nNow, when editing files, the custom plugin will be enabled. When running `next build`, the custom type checker will be used.\n\nThe TypeScript plugin can help with:\n\n- Warning if the invalid values for [segment config options](/docs/app/api-reference/file-conventions/route-segment-config) are passed.\n- Showing available options and in-context documentation.\n- Ensuring the `'use client'` directive is used correctly.\n- Ensuring client hooks (like `useState`) are only used in Client Components.\n\n> **🎥 Watch:** Learn about the built-in TypeScript plugin → [YouTube (3 minutes)](https://www.youtube.com/watch?v=pqMqn9fKEf8)"
  },
  {
    "id": "02-typescript.mdx#2",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "## End-to-End Type Safety\n\nThe Next.js App Router has **enhanced type safety**. This includes:\n\n1. **No serialization of data between fetching function and page**: You can `fetch` directly in components, layouts, and pages on the server. This data _does not_ need to be serialized (converted to a string) to be passed to the client side for consumption in React. Instead, since `app` uses Server Components by default, we can use values like `Date`, `Map`, `Set`, and more without any extra steps. Previously, you needed to manually type the boundary between server and client with Next.js-specific types.\n2. **Streamlined data flow between components**: With the removal of `_app` in favor of root layouts, it is now easier to visualize the data flow between components and pages. Previously, data flowing between individual `pages` and `_app` were difficult to type and could introduce confusing bugs. With [colocated data fetching](/docs/app/getting-started/fetching-data) in the App Router, this is no longer an issue."
  },
  {
    "id": "02-typescript.mdx#3",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "[Data Fetching in Next.js](/docs/app/getting-started/fetching-data) now provides as close to end-to-end type safety as possible without being prescriptive about your database or content provider selection.\n\nWe're able to type the response data as you would expect with normal TypeScript. For example:\n\n```tsx filename=\"app/page.tsx\" switcher\nasync function getData() {\n  const res = await fetch('https://api.example.com/...')\n  // The return value is *not* serialized\n  // You can return Date, Map, Set, etc.\n  return res.json()\n}\n\nexport default async function Page() {\n  const name = await getData()\n\n  return '...'\n}"
  },
  {
    "id": "02-typescript.mdx#4",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "```\n\nFor _complete_ end-to-end type safety, this also requires your database or content provider to support TypeScript. This could be through using an [ORM](https://en.wikipedia.org/wiki/Object%E2%80%93relational_mapping) or type-safe query builder."
  },
  {
    "id": "02-typescript.mdx#5",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "## Route-Aware Type Helpers\n\nNext.js generates global helpers for App Router route types. These are available without imports and are generated during `next dev`, `next build`, or via [`next typegen`](/docs/app/api-reference/cli/next#next-typegen-options):\n\n- [`PageProps`](/docs/app/api-reference/file-conventions/page#page-props-helper)\n- [`LayoutProps`](/docs/app/api-reference/file-conventions/layout#layout-props-helper)\n- [`RouteContext`](/docs/app/api-reference/file-conventions/route#route-context-helper)\n\n</AppOnly>"
  },
  {
    "id": "02-typescript.mdx#6",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "## Examples\n\n### Type Checking Next.js Configuration Files\n\nYou can use TypeScript and import types in your Next.js configuration by using `next.config.ts`.\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  /* config options here */\n}\n\nexport default nextConfig\n```\n\nModule resolution in `next.config.ts` is currently limited to CommonJS. However, ECMAScript Modules (ESM) syntax is available when [using Node.js native TypeScript resolver](#using-nodejs-native-typescript-resolver-for-nextconfigts) for Node.js v22.10.0 and higher.\n\nWhen using the `next.config.js` file, you can add some type checking in your IDE using JSDoc as below:\n\n```js filename=\"next.config.js\"\n// @ts-check\n\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  /* config options here */\n}\n\nmodule.exports = nextConfig\n```"
  },
  {
    "id": "02-typescript.mdx#7",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "### Using Node.js Native TypeScript Resolver for `next.config.ts`\n\n> **Note**: Available on Node.js v22.10.0+ and only when the feature is enabled. Next.js does not enable it.\n\nNext.js detects the [Node.js native TypeScript resolver](https://nodejs.org/api/typescript.html) via [`process.features.typescript`](https://nodejs.org/api/process.html#processfeaturestypescript), added in **v22.10.0**. When present, `next.config.ts` can use native ESM, including top‑level `await` and dynamic `import()`. This mechanism inherits the capabilities and limitations of Node's resolver.\n\nIn Node.js versions **v22.18.0+**, `process.features.typescript` is enabled by default. For versions between **v22.10.0** and **22.17.x**, opt in with `NODE_OPTIONS=--experimental-transform-types`:\n\n```bash filename=\"Terminal\"\nNODE_OPTIONS=--experimental-transform-types next <command>\n```"
  },
  {
    "id": "02-typescript.mdx#8",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "#### For CommonJS Projects (Default)\n\nAlthough `next.config.ts` supports native ESM syntax on CommonJS projects, Node.js will still assume `next.config.ts` is a CommonJS file by default, resulting in Node.js reparsing the file as ESM when module syntax is detected. Therefore, we recommend using the `next.config.mts` file for CommonJS projects to explicitly indicate it's an ESM module:\n\n```ts filename=\"next.config.mts\"\nimport type { NextConfig } from 'next'\n\n// Top-level await and dynamic import are supported\nconst flags = await import('./flags.js').then((m) => m.default ?? m)\n\nconst nextConfig: NextConfig = {\n  /* config options here */\n  typedRoutes: Boolean(flags?.typedRoutes),\n}\n\nexport default nextConfig\n```"
  },
  {
    "id": "02-typescript.mdx#9",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "#### For ESM Projects\n\nWhen `\"type\"` is set to `\"module\"` in `package.json`, your project uses ESM. Learn more about this setting [in the Node.js docs](https://nodejs.org/api/packages.html#type). In this case, you can write `next.config.ts` directly with ESM syntax.\n\n> **Good to know**: When using `\"type\": \"module\"` in your `package.json`, all `.js` and `.ts` files in your project are treated as ESM modules by default. You may need to rename files with CommonJS syntax to `.cjs` or `.cts` extensions if needed."
  },
  {
    "id": "02-typescript.mdx#10",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "### Statically Typed Links\n\nNext.js can statically type links to prevent typos and other errors when using `next/link`, improving type safety when navigating between pages.\n\nWorks in both the Pages and App Router for the `href` prop in `next/link`. In the App Router, it also types `next/navigation` methods like `push`, `replace`, and `prefetch`. It does not type `next/router` methods in Pages Router.\n\nLiteral `href` strings are validated, while non-literal `href`s may require a cast with `as Route`.\n\nTo opt-into this feature, `typedRoutes` need to be enabled and the project needs to be using TypeScript.\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  typedRoutes: true,\n}\n\nexport default nextConfig"
  },
  {
    "id": "02-typescript.mdx#11",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "```\n\nNext.js will generate a link definition in `.next/types` that contains information about all existing routes in your application, which TypeScript can then use to provide feedback in your editor about invalid links.\n\n> **Good to know**: If you set up your project without `create-next-app`, ensure the generated Next.js types are included by adding `.next/types/**/*.ts` to the `include` array in your `tsconfig.json`:\n\n{/* prettier-ignore-start */}\n\n```json filename=\"tsconfig.json\" highlight={4}\n{\n  \"include\": [\n    \"next-env.d.ts\",\n    \".next/types/**/*.ts\",\n    \"**/*.ts\",\n    \"**/*.tsx\"\n  ],\n  \"exclude\": [\"node_modules\"]\n}\n```\n{/* prettier-ignore-end */}\n\nCurrently, support includes any string literal, including dynamic segments. For non-literal strings, you need to manually cast with `as Route`. The example below shows both `next/link` and `next/navigation` usage:\n\n```tsx filename=\"app/example-client.tsx\"\n'use client'\n\nimport type { Route } from 'next'\nimport Link from 'next/link'\nimport { useRouter } from 'next/navigation'\n\nexport default function Example() {\n  const router = useRouter()\n  const slug = 'nextjs'"
  },
  {
    "id": "02-typescript.mdx#12",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "import type { Route } from 'next'\nimport Link from 'next/link'\nimport { useRouter } from 'next/navigation'\n\nexport default function Example() {\n  const router = useRouter()\n  const slug = 'nextjs'\n\n  return (\n    <>\n      {/* Link: literal and dynamic */}\n      <Link href=\"/about\" />\n      <Link href={`/blog/${slug}`} />\n      <Link href={('/blog/' + slug) as Route} />\n      {/* TypeScript error if href is not a valid route */}\n      <Link href=\"/aboot\" />\n\n      {/* Router: literal and dynamic strings are validated */}\n      <button onClick={() => router.push('/about')}>Push About</button>\n      <button onClick={() => router.replace(`/blog/${slug}`)}>\n        Replace Blog\n      </button>\n      <button onClick={() => router.prefetch('/contact')}>\n        Prefetch Contact\n      </button>\n\n      {/* For non-literal strings, cast to Route */}\n      <button onClick={() => router.push(('/blog/' + slug) as Route)}>\n        Push Non-literal Blog\n      </button>\n    </>\n  )\n}"
  },
  {
    "id": "02-typescript.mdx#13",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "```\n\nThe same applies for redirecting routes defined by proxy:\n\n```ts filename=\"proxy.ts\"\nimport { NextRequest, NextResponse } from 'next/server'\n\nexport function proxy(request: NextRequest) {\n  if (request.nextUrl.pathname === '/proxy-redirect') {\n    return NextResponse.redirect(new URL('/', request.url))\n  }\n\n  return NextResponse.next()\n}\n```\n\n```tsx filename=\"app/some/page.tsx\"\nimport type { Route } from 'next'\n\nexport default function Page() {\n  return <Link href={'/proxy-redirect' as Route}>Link Text</Link>\n}\n```\n\nTo accept `href` in a custom component wrapping `next/link`, use a generic:\n\n```tsx\nimport type { Route } from 'next'\nimport Link from 'next/link'\n\nfunction Card<T extends string>({ href }: { href: Route<T> | URL }) {\n  return (\n    <Link href={href}>\n      <div>My Card</div>\n    </Link>\n  )\n}\n```\n\nYou can also type a simple data structure and iterate to render links:\n\n```ts filename=\"components/nav-items.ts\"\nimport type { Route } from 'next'\n\ntype NavItem<T extends string = string> = {\n  href: T\n  label: string\n}\n\nexport const navItems: NavItem<Route>[] = [\n  { href: '/', label: 'Home' },\n  { href: '/about', label: 'About' },\n  { href: '/blog', label: 'Blog' },\n]"
  },
  {
    "id": "02-typescript.mdx#14",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "```\n\nThen, map over the items to render `Link`s:\n\n```tsx filename=\"components/nav.tsx\"\nimport Link from 'next/link'\nimport { navItems } from './nav-items'\n\nexport function Nav() {\n  return (\n    <nav>\n      {navItems.map((item) => (\n        <Link key={item.href} href={item.href}>\n          {item.label}\n        </Link>\n      ))}\n    </nav>\n  )\n}\n```\n\n> **How does it work?**\n>\n> When running `next dev` or `next build`, Next.js generates a hidden `.d.ts` file inside `.next` that contains information about all existing routes in your application (all valid routes as the `href` type of `Link`). This `.d.ts` file is included in `tsconfig.json` and the TypeScript compiler will check that `.d.ts` and provide feedback in your editor about invalid links."
  },
  {
    "id": "02-typescript.mdx#15",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "### Type IntelliSense for Environment Variables\n\nDuring development, Next.js generates a `.d.ts` file in `.next/types` that contains information about the loaded environment variables for your editor's IntelliSense. If the same environment variable key is defined in multiple files, it is deduplicated according to the [Environment Variable Load Order](/docs/app/guides/environment-variables#environment-variable-load-order).\n\nTo opt-into this feature, `experimental.typedEnv` needs to be enabled and the project needs to be using TypeScript.\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  experimental: {\n    typedEnv: true,\n  },\n}\n\nexport default nextConfig\n```\n\n> **Good to know**: Types are generated based on the environment variables loaded at development runtime, which excludes variables from `.env.production*` files by default. To include production-specific variables, run `next dev` with `NODE_ENV=production`.\n\n<AppOnly>"
  },
  {
    "id": "02-typescript.mdx#16",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "### With Async Server Components\n\nTo use an `async` Server Component with TypeScript, ensure you are using TypeScript `5.1.3` or higher and `@types/react` `18.2.8` or higher.\n\nIf you are using an older version of TypeScript, you may see a `'Promise<Element>' is not a valid JSX element` type error. Updating to the latest version of TypeScript and `@types/react` should resolve this issue.\n\n</AppOnly>\n\n<PagesOnly>"
  },
  {
    "id": "02-typescript.mdx#17",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "### Static Generation and Server-side Rendering\n\nFor [`getStaticProps`](/docs/pages/api-reference/functions/get-static-props), [`getStaticPaths`](/docs/pages/api-reference/functions/get-static-paths), and [`getServerSideProps`](/docs/pages/api-reference/functions/get-server-side-props), you can use the `GetStaticProps`, `GetStaticPaths`, and `GetServerSideProps` types respectively:\n\n```tsx filename=\"pages/blog/[slug].tsx\"\nimport type { GetStaticProps, GetStaticPaths, GetServerSideProps } from 'next'\n\nexport const getStaticProps = (async (context) => {\n  // ...\n}) satisfies GetStaticProps\n\nexport const getStaticPaths = (async () => {\n  // ...\n}) satisfies GetStaticPaths\n\nexport const getServerSideProps = (async (context) => {\n  // ...\n}) satisfies GetServerSideProps\n```\n\n> **Good to know:** `satisfies` was added to TypeScript in [4.9](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-9.html). We recommend upgrading to the latest version of TypeScript."
  },
  {
    "id": "02-typescript.mdx#18",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "### With API Routes\n\nThe following is an example of how to use the built-in types for API routes:\n\n```ts filename=\"pages/api/hello.ts\"\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  res.status(200).json({ name: 'John Doe' })\n}\n```\n\nYou can also type the response data:\n\n```ts filename=\"pages/api/hello.ts\"\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\ntype Data = {\n  name: string\n}\n\nexport default function handler(\n  req: NextApiRequest,\n  res: NextApiResponse<Data>\n) {\n  res.status(200).json({ name: 'John Doe' })\n}\n```\n\n### With custom `App`\n\nIf you have a [custom `App`](/docs/pages/building-your-application/routing/custom-app), you can use the built-in type `AppProps` and change file name to `./pages/_app.tsx` like so:\n\n```ts\nimport type { AppProps } from 'next/app'\n\nexport default function MyApp({ Component, pageProps }: AppProps) {\n  return <Component {...pageProps} />\n}\n```\n\n</PagesOnly>"
  },
  {
    "id": "02-typescript.mdx#19",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "### Incremental type checking\n\nSince `v10.2.1` Next.js supports [incremental type checking](https://www.typescriptlang.org/tsconfig#incremental) when enabled in your `tsconfig.json`, this can help speed up type checking in larger applications."
  },
  {
    "id": "02-typescript.mdx#20",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "### Custom `tsconfig` path\n\nIn some cases, you might want to use a different TypeScript configuration for builds or tooling. To do that, set `typescript.tsconfigPath` in `next.config.ts` to point Next.js to another `tsconfig` file.\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  typescript: {\n    tsconfigPath: 'tsconfig.build.json',\n  },\n}\n\nexport default nextConfig\n```\n\nFor example, switch to a different config for production builds:\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst isProd = process.env.NODE_ENV === 'production'\n\nconst nextConfig: NextConfig = {\n  typescript: {\n    tsconfigPath: isProd ? 'tsconfig.build.json' : 'tsconfig.json',\n  },\n}\n\nexport default nextConfig"
  },
  {
    "id": "02-typescript.mdx#21",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "```\n\n<details>\n<summary>Why you might use a separate `tsconfig` for builds</summary>\n\nYou might need to relax checks in scenarios like monorepos, where the build also validates shared dependencies that don't match your project's standards, or when loosening checks in CI to continue delivering while migrating locally to stricter TypeScript settings (and still wanting your IDE to highlight misuse).\n\nFor example, if your project uses `useUnknownInCatchVariables` but some monorepo dependencies still assume `any`:\n\n```json filename=\"tsconfig.build.json\"\n{\n  \"extends\": \"./tsconfig.json\",\n  \"compilerOptions\": {\n    \"useUnknownInCatchVariables\": false\n  }\n}"
  },
  {
    "id": "02-typescript.mdx#22",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "```\n\nThis keeps your editor strict via `tsconfig.json` while allowing the production build to use relaxed settings.\n\n</details>\n\n> **Good to know**:\n>\n> - IDEs typically read `tsconfig.json` for diagnostics and IntelliSense, so you can still see IDE warnings while production builds use the alternate config. Mirror critical options if you want parity in the editor.\n> - In development, only `tsconfig.json` is watched for changes. If you edit a different file name via `typescript.tsconfigPath`, restart the dev server to apply changes.\n> - The configured file is used in `next dev`, `next build`, and `next typegen`."
  },
  {
    "id": "02-typescript.mdx#23",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "### Disabling TypeScript errors in production\n\nNext.js fails your **production build** (`next build`) when TypeScript errors are present in your project.\n\nIf you'd like Next.js to dangerously produce production code even when your application has errors, you can disable the built-in type checking step.\n\nIf disabled, be sure you are running type checks as part of your build or deploy process, otherwise this can be very dangerous.\n\nOpen `next.config.ts` and enable the `ignoreBuildErrors` option in the `typescript` config:\n\n```ts filename=\"next.config.ts\"\nimport type { NextConfig } from 'next'\n\nconst nextConfig: NextConfig = {\n  typescript: {\n    // !! WARN !!\n    // Dangerously allow production builds to successfully complete even if\n    // your project has type errors.\n    // !! WARN !!\n    ignoreBuildErrors: true,\n  },\n}\n\nexport default nextConfig\n```\n\n> **Good to know**: You can run `tsc --noEmit` to check for TypeScript errors yourself before building. This is useful for CI/CD pipelines where you'd like to check for TypeScript errors before deploying."
  },
  {
    "id": "02-typescript.mdx#24",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "### Custom type declarations\n\nWhen you need to declare custom types, you might be tempted to modify `next-env.d.ts`. However, this file is automatically generated, so any changes you make will be overwritten. Instead, you should create a new file, let's call it `new-types.d.ts`, and reference it in your `tsconfig.json`:\n\n```json filename=\"tsconfig.json\"\n{\n  \"compilerOptions\": {\n    \"skipLibCheck\": true\n    //...truncated...\n  },\n  \"include\": [\n    \"new-types.d.ts\",\n    \"next-env.d.ts\",\n    \".next/types/**/*.ts\",\n    \"**/*.ts\",\n    \"**/*.tsx\"\n  ],\n  \"exclude\": [\"node_modules\"]\n}\n```"
  },
  {
    "id": "02-typescript.mdx#25",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "## Version Changes\n\n| Version   | Changes                                                                                                                              |\n| --------- | ------------------------------------------------------------------------------------------------------------------------------------ |\n| `v15.0.0` | [`next.config.ts`](#type-checking-nextjs-configuration-files) support added for TypeScript projects.                                 |\n| `v13.2.0` | Statically typed links are available in beta.                                                                                        |\n| `v12.0.0` | [SWC](/docs/architecture/nextjs-compiler) is now used by default to compile TypeScript and TSX for faster builds.                    |\n| `v10.2.1` | [Incremental type checking](https://www.typescriptlang.org/tsconfig#incremental) support added when enabled in your `tsconfig.json`. |"
  },
  {
    "id": "03-eslint.mdx#0",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "---\ntitle: ESLint Plugin\nnav_title: ESLint\ndescription: Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js provides an ESLint configuration package, [`eslint-config-next`](https://www.npmjs.com/package/eslint-config-next), that makes it easy to catch common issues in your application. It includes the [`@next/eslint-plugin-next`](https://www.npmjs.com/package/@next/eslint-plugin-next) plugin along with recommended rule-sets from [`eslint-plugin-react`](https://www.npmjs.com/package/eslint-plugin-react) and [`eslint-plugin-react-hooks`](https://www.npmjs.com/package/eslint-plugin-react-hooks).\n\nThe package provides two main configurations:"
  },
  {
    "id": "03-eslint.mdx#1",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "The package provides two main configurations:\n\n- **`eslint-config-next`**: Base configuration with Next.js, React, and React Hooks rules. Supports both JavaScript and TypeScript files.\n- **`eslint-config-next/core-web-vitals`**: Includes everything from the base config, plus upgrades rules that impact [Core Web Vitals](https://web.dev/vitals/) from warnings to errors. Recommended for most projects.\n\nAdditionally, for TypeScript projects:\n\n- **`eslint-config-next/typescript`**: Adds TypeScript-specific linting rules from [`typescript-eslint`](https://typescript-eslint.io/). Use this alongside the base or core-web-vitals config."
  },
  {
    "id": "03-eslint.mdx#2",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "## Setup ESLint\n\nGet linting working quickly with the ESLint CLI (flat config):\n\n1. Install ESLint and the Next.js config:\n\n   ```bash package=\"pnpm\"\n   pnpm add -D eslint eslint-config-next\n   ```\n\n   ```bash package=\"npm\"\n   npm i -D eslint eslint-config-next\n   ```\n\n   ```bash package=\"yarn\"\n   yarn add --dev eslint eslint-config-next\n   ```\n\n   ```bash package=\"bun\"\n   bun add -d eslint eslint-config-next\n   ```\n\n2. Create `eslint.config.mjs` with the Next.js config:\n\n   ```js filename=\"eslint.config.mjs\"\n   import { defineConfig, globalIgnores } from 'eslint/config'\n   import nextVitals from 'eslint-config-next/core-web-vitals'\n\n   const eslintConfig = defineConfig([\n     ...nextVitals,\n     // Override default ignores of eslint-config-next.\n     globalIgnores([\n       // Default ignores of eslint-config-next:\n       '.next/**',\n       'out/**',\n       'build/**',\n       'next-env.d.ts',\n     ]),\n   ])\n\n   export default eslintConfig\n   ```\n\n3. Run ESLint:\n\n   ```bash package=\"pnpm\"\n   pnpm exec eslint .\n   ```\n\n   ```bash package=\"npm\"\n   npx eslint .\n   ```\n\n   ```bash package=\"yarn\"\n   yarn eslint .\n   ```\n\n   ```bash package=\"bun\"\n   bunx eslint .\n   ```"
  },
  {
    "id": "03-eslint.mdx#3",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "## Reference\n\nThe `eslint-config-next` package includes the `recommended` rule-sets from the following ESLint plugins:\n\n- [`eslint-plugin-react`](https://www.npmjs.com/package/eslint-plugin-react)\n- [`eslint-plugin-react-hooks`](https://www.npmjs.com/package/eslint-plugin-react-hooks)\n- [`@next/eslint-plugin-next`](https://www.npmjs.com/package/@next/eslint-plugin-next)"
  },
  {
    "id": "03-eslint.mdx#4",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "### Rules\n\nThe `@next/eslint-plugin-next` rules included are:"
  },
  {
    "id": "03-eslint.mdx#5",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "| Enabled in recommended config | Rule                                                                                                                     | Description                                                                                                      |\n| :---------------------------: | ------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------- |\n|      <Check size={18} />      | [@next/next/google-font-display](/docs/messages/google-font-display)                                                     | Enforce font-display behavior with Google Fonts.                                                                 |\n|      <Check size={18} />      | [@next/next/google-font-preconnect](/docs/messages/google-font-preconnect)                                               | Ensure `preconnect` is used with Google Fonts.                                                                   |"
  },
  {
    "id": "03-eslint.mdx#6",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "|      <Check size={18} />      | [@next/next/inline-script-id](/docs/messages/inline-script-id)                                                           | Enforce `id` attribute on `next/script` components with inline content.                                          |\n|      <Check size={18} />      | [@next/next/next-script-for-ga](/docs/messages/next-script-for-ga)                                                       | Prefer `next/script` component when using the inline script for Google Analytics.                                |\n|      <Check size={18} />      | [@next/next/no-assign-module-variable](/docs/messages/no-assign-module-variable)                                         | Prevent assignment to the `module` variable.                                                                     |\n|      <Check size={18} />      | [@next/next/no-async-client-component](/docs/messages/no-async-client-component)                                         | Prevent Client Components from being async functions.                                                            |"
  },
  {
    "id": "03-eslint.mdx#7",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "|      <Check size={18} />      | [@next/next/no-before-interactive-script-outside-document](/docs/messages/no-before-interactive-script-outside-document) | Prevent usage of `next/script`'s `beforeInteractive` strategy outside of `pages/_document.js`.                   |\n|      <Check size={18} />      | [@next/next/no-css-tags](/docs/messages/no-css-tags)                                                                     | Prevent manual stylesheet tags.                                                                                  |\n|      <Check size={18} />      | [@next/next/no-document-import-in-page](/docs/messages/no-document-import-in-page)                                       | Prevent importing `next/document` outside of `pages/_document.js`.                                               |\n|      <Check size={18} />      | [@next/next/no-duplicate-head](/docs/messages/no-duplicate-head)                                                         | Prevent duplicate usage of `<Head>` in `pages/_document.js`.                                                     |"
  },
  {
    "id": "03-eslint.mdx#8",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "|      <Check size={18} />      | [@next/next/no-head-element](/docs/messages/no-head-element)                                                             | Prevent usage of `<head>` element.                                                                               |\n|      <Check size={18} />      | [@next/next/no-head-import-in-document](/docs/messages/no-head-import-in-document)                                       | Prevent usage of `next/head` in `pages/_document.js`.                                                            |\n|      <Check size={18} />      | [@next/next/no-html-link-for-pages](/docs/messages/no-html-link-for-pages)                                               | Prevent usage of `<a>` elements to navigate to internal Next.js pages.                                           |\n|      <Check size={18} />      | [@next/next/no-img-element](/docs/messages/no-img-element)                                                               | Prevent usage of `<img>` element due to slower LCP and higher bandwidth.                                         |"
  },
  {
    "id": "03-eslint.mdx#9",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "|      <Check size={18} />      | [@next/next/no-page-custom-font](/docs/messages/no-page-custom-font)                                                     | Prevent page-only custom fonts.                                                                                  |\n|      <Check size={18} />      | [@next/next/no-script-component-in-head](/docs/messages/no-script-component-in-head)                                     | Prevent usage of `next/script` in `next/head` component.                                                         |\n|      <Check size={18} />      | [@next/next/no-styled-jsx-in-document](/docs/messages/no-styled-jsx-in-document)                                         | Prevent usage of `styled-jsx` in `pages/_document.js`.                                                           |\n|      <Check size={18} />      | [@next/next/no-sync-scripts](/docs/messages/no-sync-scripts)                                                             | Prevent synchronous scripts.                                                                                     |"
  },
  {
    "id": "03-eslint.mdx#10",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "|      <Check size={18} />      | [@next/next/no-title-in-document-head](/docs/messages/no-title-in-document-head)                                         | Prevent usage of `<title>` with `Head` component from `next/document`.                                           |\n|      <Check size={18} />      | @next/next/no-typos                                                                                                      | Prevent common typos in [Next.js's data fetching functions](/docs/pages/building-your-application/data-fetching) |\n|      <Check size={18} />      | [@next/next/no-unwanted-polyfillio](/docs/messages/no-unwanted-polyfillio)                                               | Prevent duplicate polyfills from Polyfill.io.                                                                    |"
  },
  {
    "id": "03-eslint.mdx#11",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "We recommend using an appropriate [integration](https://eslint.org/docs/user-guide/integrations#editors) to view warnings and errors directly in your code editor during development.\n\n<details>\n  <summary>`next lint` removal</summary>\n\nStarting with Next.js 16, `next lint` is removed.\n\nAs part of the removal, the `eslint` option in your Next config file is no longer needed and can be safely removed.\n\n</details>"
  },
  {
    "id": "03-eslint.mdx#12",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "## Examples\n\n### Specifying a root directory within a monorepo\n\nIf you're using `@next/eslint-plugin-next` in a project where Next.js isn't installed in your root directory (such as a monorepo), you can tell `@next/eslint-plugin-next` where to find your Next.js application using the `settings` property in your `eslint.config.mjs`:\n\n```js filename=\"eslint.config.mjs\"\nimport { defineConfig } from 'eslint/config'\nimport eslintNextPlugin from '@next/eslint-plugin-next'\n\nconst eslintConfig = defineConfig([\n  {\n    files: ['**/*.{js,jsx,ts,tsx}'],\n    plugins: {\n      next: eslintNextPlugin,\n    },\n    settings: {\n      next: {\n        rootDir: 'packages/my-app/',\n      },\n    },\n  },\n])\n\nexport default eslintConfig\n```\n\n`rootDir` can be a path (relative or absolute), a glob (i.e. `\"packages/*/\"`), or an array of paths and/or globs."
  },
  {
    "id": "03-eslint.mdx#13",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "### Disabling rules\n\nIf you would like to modify or disable any rules provided by the supported plugins (`react`, `react-hooks`, `next`), you can directly change them using the `rules` property in your `eslint.config.mjs`:\n\n```js filename=\"eslint.config.mjs\"\nimport { defineConfig, globalIgnores } from 'eslint/config'\nimport nextVitals from 'eslint-config-next/core-web-vitals'\n\nconst eslintConfig = defineConfig([\n  ...nextVitals,\n  {\n    rules: {\n      'react/no-unescaped-entities': 'off',\n      '@next/next/no-page-custom-font': 'off',\n    },\n  },\n  // Override default ignores of eslint-config-next.\n  globalIgnores([\n    // Default ignores of eslint-config-next:\n    '.next/**',\n    'out/**',\n    'build/**',\n    'next-env.d.ts',\n  ]),\n])\n\nexport default eslintConfig\n```"
  },
  {
    "id": "03-eslint.mdx#14",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "### With Core Web Vitals\n\nEnable the `eslint-config-next/core-web-vitals` configuration in your ESLint config.\n\n```js filename=\"eslint.config.mjs\"\nimport { defineConfig, globalIgnores } from 'eslint/config'\nimport nextVitals from 'eslint-config-next/core-web-vitals'\n\nconst eslintConfig = defineConfig([\n  ...nextVitals,\n  // Override default ignores of eslint-config-next.\n  globalIgnores([\n    // Default ignores of eslint-config-next:\n    '.next/**',\n    'out/**',\n    'build/**',\n    'next-env.d.ts',\n  ]),\n])\n\nexport default eslintConfig\n```\n\n`eslint-config-next/core-web-vitals` upgrades certain lint rules in `@next/eslint-plugin-next` from warnings to errors to help improve your [Core Web Vitals](https://web.dev/vitals/) metrics.\n\n> The `eslint-config-next/core-web-vitals` configuration is automatically included for new applications built with [Create Next App](/docs/app/api-reference/cli/create-next-app)."
  },
  {
    "id": "03-eslint.mdx#15",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "### With TypeScript\n\nIn addition to the Next.js ESLint rules, `create-next-app --typescript` will also add TypeScript-specific lint rules with `eslint-config-next/typescript` to your config:\n\n```js filename=\"eslint.config.mjs\"\nimport { defineConfig, globalIgnores } from 'eslint/config'\nimport nextVitals from 'eslint-config-next/core-web-vitals'\nimport nextTs from 'eslint-config-next/typescript'\n\nconst eslintConfig = defineConfig([\n  ...nextVitals,\n  ...nextTs,\n  // Override default ignores of eslint-config-next.\n  globalIgnores([\n    // Default ignores of eslint-config-next:\n    '.next/**',\n    'out/**',\n    'build/**',\n    'next-env.d.ts',\n  ]),\n])\n\nexport default eslintConfig\n```\n\nThose rules are based on [`plugin:@typescript-eslint/recommended`](https://typescript-eslint.io/linting/configs#recommended).\nSee [typescript-eslint > Configs](https://typescript-eslint.io/linting/configs) for more details."
  },
  {
    "id": "03-eslint.mdx#16",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "### With Prettier\n\nESLint also contains code formatting rules, which can conflict with your existing [Prettier](https://prettier.io/) setup. We recommend including [eslint-config-prettier](https://github.com/prettier/eslint-config-prettier) in your ESLint config to make ESLint and Prettier work together.\n\nFirst, install the dependency:\n\n```bash package=\"pnpm\"\npnpm add -D eslint-config-prettier\n```\n\n```bash package=\"npm\"\nnpm i -D eslint-config-prettier\n```\n\n```bash package=\"yarn\"\nyarn add --dev eslint-config-prettier\n```\n\n```bash package=\"bun\"\nbun add -d eslint-config-prettier\n```\n\nThen, add `prettier` to your existing ESLint config:\n\n```js filename=\"eslint.config.mjs\"\nimport { defineConfig, globalIgnores } from 'eslint/config'\nimport nextVitals from 'eslint-config-next/core-web-vitals'\nimport prettier from 'eslint-config-prettier/flat'\n\nconst eslintConfig = defineConfig([\n  ...nextVitals,\n  prettier,\n  // Override default ignores of eslint-config-next.\n  globalIgnores([\n    // Default ignores of eslint-config-next:\n    '.next/**',\n    'out/**',\n    'build/**',\n    'next-env.d.ts',\n  ]),\n])\n\nexport default eslintConfig\n```"
  },
  {
    "id": "03-eslint.mdx#17",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "### Running lint on staged files\n\nIf you would like to use ESLint with [lint-staged](https://github.com/okonet/lint-staged) to run the linter on staged git files, add the following to the `.lintstagedrc.js` file in the root of your project:\n\n```js filename=\".lintstagedrc.js\"\nconst path = require('path')\n\nconst buildEslintCommand = (filenames) =>\n  `eslint --fix ${filenames\n    .map((f) => `\"${path.relative(process.cwd(), f)}\"`)\n    .join(' ')}`\n\nmodule.exports = {\n  '*.{js,jsx,ts,tsx}': [buildEslintCommand],\n}\n```"
  },
  {
    "id": "03-eslint.mdx#18",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "## Migrating existing config\n\nIf you already have ESLint configured in your application, there are two approaches to integrate Next.js linting rules, depending on your setup."
  },
  {
    "id": "03-eslint.mdx#19",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "#### Using the plugin directly\n\nUse `@next/eslint-plugin-next` directly if you have any of the following already configured:\n\n- Conflicting plugins installed separately or through another config (such as `airbnb` or `react-app`):\n  - `react`\n  - `react-hooks`\n  - `jsx-a11y`\n  - `import`\n- Custom `parserOptions` different from Next.js defaults (only if you have [customized your Babel configuration](/docs/pages/guides/babel))\n- `eslint-plugin-import` with custom Node.js and/or TypeScript [resolvers](https://github.com/benmosher/eslint-plugin-import#resolvers)\n\nIn these cases, use `@next/eslint-plugin-next` directly to avoid conflicts:\n\nFirst, install the plugin:\n\n```bash package=\"pnpm\"\npnpm add -D @next/eslint-plugin-next\n```\n\n```bash package=\"npm\"\nnpm i -D @next/eslint-plugin-next\n```\n\n```bash package=\"yarn\"\nyarn add --dev @next/eslint-plugin-next\n```\n\n```bash package=\"bun\"\nbun add -d @next/eslint-plugin-next"
  },
  {
    "id": "03-eslint.mdx#20",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "```\n\n```bash package=\"npm\"\nnpm i -D @next/eslint-plugin-next\n```\n\n```bash package=\"yarn\"\nyarn add --dev @next/eslint-plugin-next\n```\n\n```bash package=\"bun\"\nbun add -d @next/eslint-plugin-next\n```\n\nThen add it to your ESLint config:\n\n```js filename=\"eslint.config.mjs\"\nimport { defineConfig } from 'eslint/config'\nimport nextPlugin from '@next/eslint-plugin-next'\n\nconst eslintConfig = defineConfig([\n  // Your other configurations...\n  {\n    files: ['**/*.{js,jsx,ts,tsx}'],\n    plugins: {\n      '@next/next': nextPlugin,\n    },\n    rules: {\n      ...nextPlugin.configs.recommended.rules,\n    },\n  },\n])\n\nexport default eslintConfig\n```\n\nThis approach eliminates the risk of collisions or errors that can occur when the same plugins or parsers are imported across multiple configurations."
  },
  {
    "id": "03-eslint.mdx#21",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "#### Adding to existing config\n\nIf you're adding Next.js to an existing ESLint setup, spread the Next.js config into your array:\n\n```js filename=\"eslint.config.mjs\"\nimport nextConfig from 'eslint-config-next/core-web-vitals'\n// Your other config imports...\n\nconst eslintConfig = [\n  // Your other configurations...\n  ...nextConfig,\n]\n\nexport default eslintConfig"
  },
  {
    "id": "03-eslint.mdx#22",
    "metadata": {
      "title": "ESLint Plugin",
      "description": "Learn how to use and configure the ESLint plugin to catch common issues and problems in a Next.js application."
    },
    "content": "```\n\nWhen you spread `...nextConfig`, you're adding multiple config objects that include file patterns, plugins, rules, ignores, and parser settings. ESLint applies configs in order, so later rules can override earlier ones for matching files.\n\n> **Good to know:** This approach works well for straightforward setups. If you have a complex existing config with specific file patterns or plugin configurations that conflict, consider using the plugin directly (as shown above) for more granular control.\n\n| Version   | Changes                                                                                                                                                                                                             |\n| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `v16.0.0` | `next lint` and the `eslint` next.config.js option were removed in favor of the ESLint CLI. A [codemod](/docs/app/guides/upgrading/codemods#migrate-from-next-lint-to-eslint-cli) is available to help you migrate. |"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Configuration",
      "description": "Learn how to configure Next.js applications."
    },
    "content": "---\ntitle: Configuration\ndescription: Learn how to configure Next.js applications.\n---"
  },
  {
    "id": "create-next-app.mdx#0",
    "metadata": {
      "title": "create-next-app",
      "description": "Create Next.js apps using one command with the create-next-app CLI."
    },
    "content": "---\ntitle: create-next-app\ndescription: Create Next.js apps using one command with the create-next-app CLI.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nThe `create-next-app` CLI allow you to create a new Next.js application using the default template or an [example](https://github.com/vercel/next.js/tree/canary/examples) from a public GitHub repository. It is the easiest way to get started with Next.js.\n\nBasic usage:\n\n```bash filename=\"Terminal\"\nnpx create-next-app@latest [project-name] [options]\n```"
  },
  {
    "id": "create-next-app.mdx#1",
    "metadata": {
      "title": "create-next-app",
      "description": "Create Next.js apps using one command with the create-next-app CLI."
    },
    "content": "## Reference\n\nThe following options are available:"
  },
  {
    "id": "create-next-app.mdx#2",
    "metadata": {
      "title": "create-next-app",
      "description": "Create Next.js apps using one command with the create-next-app CLI."
    },
    "content": "| Options                                 | Description                                                           |\n| --------------------------------------- | --------------------------------------------------------------------- |\n| `-h` or `--help`                        | Show all available options                                            |\n| `-v` or `--version`                     | Output the version number                                             |\n| `--no-*`                                | Negate default options. E.g. `--no-ts`                                |\n| `--ts` or `--typescript`                | Initialize as a TypeScript project (default)                          |\n| `--js` or `--javascript`                | Initialize as a JavaScript project                                    |\n| `--tailwind`                            | Initialize with Tailwind CSS config (default)                         |\n| `--react-compiler`                      | Initialize with React Compiler enabled                                |\n| `--eslint`                              | Initialize with ESLint config                                         |"
  },
  {
    "id": "create-next-app.mdx#3",
    "metadata": {
      "title": "create-next-app",
      "description": "Create Next.js apps using one command with the create-next-app CLI."
    },
    "content": "| `--eslint`                              | Initialize with ESLint config                                         |\n| `--biome`                               | Initialize with Biome config                                          |\n| `--no-linter`                           | Skip linter configuration                                             |\n| `--app`                                 | Initialize as an App Router project                                   |\n| `--api`                                 | Initialize a project with only route handlers                         |\n| `--src-dir`                             | Initialize inside a `src/` directory                                  |\n| `--turbopack`                           | Force enable Turbopack in generated package.json (enabled by default) |\n| `--webpack`                             | Force enable Webpack in generated package.json                        |\n| `--import-alias <alias-to-configure>`   | Specify import alias to use (default \"@/\\*\")                          |\n| `--empty`                               | Initialize an empty project                                           |"
  },
  {
    "id": "create-next-app.mdx#4",
    "metadata": {
      "title": "create-next-app",
      "description": "Create Next.js apps using one command with the create-next-app CLI."
    },
    "content": "| `--empty`                               | Initialize an empty project                                           |\n| `--use-npm`                             | Explicitly tell the CLI to bootstrap the application using npm        |\n| `--use-pnpm`                            | Explicitly tell the CLI to bootstrap the application using pnpm       |\n| `--use-yarn`                            | Explicitly tell the CLI to bootstrap the application using Yarn       |\n| `--use-bun`                             | Explicitly tell the CLI to bootstrap the application using Bun        |\n| `-e` or `--example [name] [github-url]` | An example to bootstrap the app with                                  |\n| `--example-path <path-to-example>`      | Specify the path to the example separately                            |\n| `--reset-preferences`                   | Explicitly tell the CLI to reset any stored preferences               |\n| `--skip-install`                        | Explicitly tell the CLI to skip installing packages                   |\n| `--disable-git`                         | Explicitly tell the CLI to disable git initialization                 |"
  },
  {
    "id": "create-next-app.mdx#5",
    "metadata": {
      "title": "create-next-app",
      "description": "Create Next.js apps using one command with the create-next-app CLI."
    },
    "content": "| `--disable-git`                         | Explicitly tell the CLI to disable git initialization                 |\n| `--yes`                                 | Use previous preferences or defaults for all options                  |"
  },
  {
    "id": "create-next-app.mdx#6",
    "metadata": {
      "title": "create-next-app",
      "description": "Create Next.js apps using one command with the create-next-app CLI."
    },
    "content": "## Examples"
  },
  {
    "id": "create-next-app.mdx#7",
    "metadata": {
      "title": "create-next-app",
      "description": "Create Next.js apps using one command with the create-next-app CLI."
    },
    "content": "### With the default template\n\nTo create a new app using the default template, run the following command in your terminal:\n\n```bash filename=\"Terminal\"\nnpx create-next-app@latest\n```\n\nOn installation, you'll see the following prompts:\n\n```txt filename=\"Terminal\"\nWhat is your project named? my-app\nWould you like to use the recommended Next.js defaults?\n    Yes, use recommended defaults - TypeScript, ESLint, Tailwind CSS, App Router, Turbopack\n    No, reuse previous settings\n    No, customize settings - Choose your own preferences\n```\n\nIf you choose to `customize settings`, you'll see the following prompts:\n\n```txt filename=\"Terminal\"\nWould you like to use TypeScript? No / Yes\nWhich linter would you like to use? ESLint / Biome / None\nWould you like to use React Compiler? No / Yes\nWould you like to use Tailwind CSS? No / Yes\nWould you like your code inside a `src/` directory? No / Yes\nWould you like to use App Router? (recommended) No / Yes\nWould you like to customize the import alias (`@/*` by default)? No / Yes\nWhat import alias would you like configured? @/*"
  },
  {
    "id": "create-next-app.mdx#8",
    "metadata": {
      "title": "create-next-app",
      "description": "Create Next.js apps using one command with the create-next-app CLI."
    },
    "content": "```\n\nAfter the prompts, `create-next-app` will create a folder with your project name and install the required dependencies."
  },
  {
    "id": "create-next-app.mdx#9",
    "metadata": {
      "title": "create-next-app",
      "description": "Create Next.js apps using one command with the create-next-app CLI."
    },
    "content": "### Linter Options\n\n**ESLint**: The traditional and most popular JavaScript linter. Includes Next.js-specific rules from `@next/eslint-plugin-next`.\n\n**Biome**: A fast, modern linter and formatter that combines the functionality of ESLint and Prettier. Includes built-in Next.js and React domain support for optimal performance.\n\n**None**: Skip linter configuration entirely. You can always add a linter later.\n\nOnce you've answered the prompts, a new project will be created with your chosen configuration.\n\n### With an official Next.js example\n\nTo create a new app using an official Next.js example, use the `--example` flag. For example:\n\n```bash filename=\"Terminal\"\nnpx create-next-app@latest --example [example-name] [your-project-name]\n```\n\nYou can view a list of all available examples along with setup instructions in the [Next.js repository](https://github.com/vercel/next.js/tree/canary/examples).\n\n### With any public GitHub example\n\nTo create a new app using any public GitHub example, use the `--example` option with the GitHub repo's URL. For example:\n\n```bash filename=\"Terminal\"\nnpx create-next-app@latest --example \"https://github.com/.../\" [your-project-name]\n```"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "CLI",
      "description": "API Reference for the Next.js Command Line Interface (CLI) tools."
    },
    "content": "---\ntitle: CLI\ndescription: API Reference for the Next.js Command Line Interface (CLI) tools.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js comes with **two** Command Line Interface (CLI) tools:\n\n- **`create-next-app`**: Quickly create a new Next.js application using the default template or an [example](https://github.com/vercel/next.js/tree/canary/examples) from a public GitHub repository.\n- **`next`**: Run the Next.js development server, build your application, and more."
  },
  {
    "id": "next.mdx#0",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "---\ntitle: next CLI\ndescription: Learn how to run and build your application with the Next.js CLI.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nThe Next.js CLI allows you to develop, build, start your application, and more.\n\nBasic usage:\n\n```bash filename=\"Terminal\"\nnpx next [command] [options]\n```"
  },
  {
    "id": "next.mdx#1",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "## Reference\n\nThe following options are available:\n\n| Options             | Description                        |\n| ------------------- | ---------------------------------- |\n| `-h` or `--help`    | Shows all available options        |\n| `-v` or `--version` | Outputs the Next.js version number |"
  },
  {
    "id": "next.mdx#2",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "### Commands\n\nThe following commands are available:"
  },
  {
    "id": "next.mdx#3",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "| Command                                | Description                                                                                                   |\n| -------------------------------------- | ------------------------------------------------------------------------------------------------------------- |\n| [`dev`](#next-dev-options)             | Starts Next.js in development mode with Hot Module Reloading, error reporting, and more.                      |\n| [`build`](#next-build-options)         | Creates an optimized production build of your application. Displaying information about each route.           |\n| [`start`](#next-start-options)         | Starts Next.js in production mode. The application should be compiled with `next build` first.                |\n| [`info`](#next-info-options)           | Prints relevant details about the current system which can be used to report Next.js bugs.                    |\n| [`telemetry`](#next-telemetry-options) | Allows you to enable or disable Next.js' completely anonymous telemetry collection.                           |"
  },
  {
    "id": "next.mdx#4",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "| [`telemetry`](#next-telemetry-options) | Allows you to enable or disable Next.js' completely anonymous telemetry collection.                           |\n| [`typegen`](#next-typegen-options)     | Generates TypeScript definitions for routes, pages, layouts, and route handlers without running a full build. |\n| [`upgrade`](#next-upgrade-options)     | Upgrades your Next.js application to the latest version.                                                      |"
  },
  {
    "id": "next.mdx#5",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "> **Good to know**: Running `next` without a command is an alias for `next dev`."
  },
  {
    "id": "next.mdx#6",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "### `next dev` options\n\n`next dev` starts the application in development mode with Hot Module Reloading (HMR), error reporting, and more. The following options are available when running `next dev`:"
  },
  {
    "id": "next.mdx#7",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "| Option                                   | Description                                                                                                                                          |\n| ---------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `-h, --help`                             | Show all available options.                                                                                                                          |\n| `[directory]`                            | A directory in which to build the application. If not provided, current directory is used.                                                           |\n| `--turbopack`                            | Force enable [Turbopack](/docs/app/api-reference/turbopack) (enabled by default). Also available as `--turbo`.                                       |\n| `--webpack`                              | Use Webpack instead of the default [Turbopack](/docs/app/api-reference/turbopack) bundler for development.                                           |"
  },
  {
    "id": "next.mdx#8",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "| `--webpack`                              | Use Webpack instead of the default [Turbopack](/docs/app/api-reference/turbopack) bundler for development.                                           |\n| `-p` or `--port <port>`                  | Specify a port number on which to start the application. Default: 3000, env: PORT                                                                    |\n| `-H`or `--hostname <hostname>`           | Specify a hostname on which to start the application. Useful for making the application available for other devices on the network. Default: 0.0.0.0 |\n| `--experimental-https`                   | Starts the server with HTTPS and generates a self-signed certificate.                                                                                |\n| `--experimental-https-key <path>`        | Path to a HTTPS key file.                                                                                                                            |\n| `--experimental-https-cert <path>`       | Path to a HTTPS certificate file.                                                                                                                    |"
  },
  {
    "id": "next.mdx#9",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "| `--experimental-https-cert <path>`       | Path to a HTTPS certificate file.                                                                                                                    |\n| `--experimental-https-ca <path>`         | Path to a HTTPS certificate authority file.                                                                                                          |\n| `--experimental-upload-trace <traceUrl>` | Reports a subset of the debugging trace to a remote HTTP URL.                                                                                        |"
  },
  {
    "id": "next.mdx#10",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "### `next build` options\n\n`next build` creates an optimized production build of your application. The output displays information about each route. For example:\n\n```bash filename=\"Terminal\"\nRoute (app)\n┌ ○ /_not-found\n└ ƒ /products/[id]\n\n○  (Static)   prerendered as static content\nƒ  (Dynamic)  server-rendered on demand"
  },
  {
    "id": "next.mdx#11",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "```\n\nThe following options are available for the `next build` command:"
  },
  {
    "id": "next.mdx#12",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "| Option                             | Description                                                                                                                                                                        |\n| ---------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `-h, --help`                       | Show all available options.                                                                                                                                                        |\n| `[directory]`                      | A directory on which to build the application. If not provided, the current directory will be used.                                                                                |\n| `--turbopack`                      | Force enable [Turbopack](/docs/app/api-reference/turbopack) (enabled by default). Also available as `--turbo`.                                                                     |"
  },
  {
    "id": "next.mdx#13",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "| `--webpack`                        | Build using Webpack.                                                                                                                                                               |\n| `-d` or `--debug`                  | Enables a more verbose build output. With this flag enabled additional build output like rewrites, redirects, and headers will be shown.                                           |\n|                                    |\n| `--profile`                        | Enables production [profiling for React](https://react.dev/reference/react/Profiler).                                                                                              |\n| `--no-lint`                        | Disables linting. _Note: linting will be removed from `next build` in Next 16. If you're using Next 15.5+ with a linter other than `eslint`, linting during build will not occur._ |\n| `--no-mangling`                    | Disables [mangling](https://en.wikipedia.org/wiki/Name_mangling). This may affect performance and should only be used for debugging purposes.                                      |"
  },
  {
    "id": "next.mdx#14",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "| `--experimental-app-only`          | Builds only App Router routes.                                                                                                                                                     |\n| `--experimental-build-mode [mode]` | Uses an experimental build mode. (choices: \"compile\", \"generate\", default: \"default\")                                                                                              |\n| `--debug-prerender`                | Debug prerender errors in development.                                                                                                                                             |\n| `--debug-build-paths=<patterns>`   | Build only specific routes for debugging.                                                                                                                                          |"
  },
  {
    "id": "next.mdx#15",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "### `next start` options\n\n`next start` starts the application in production mode. The application should be compiled with [`next build`](#next-build-options) first.\n\nThe following options are available for the `next start` command:"
  },
  {
    "id": "next.mdx#16",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "The following options are available for the `next start` command:\n\n| Option                                  | Description                                                                                                     |\n| --------------------------------------- | --------------------------------------------------------------------------------------------------------------- |\n| `-h` or `--help`                        | Show all available options.                                                                                     |\n| `[directory]`                           | A directory on which to start the application. If no directory is provided, the current directory will be used. |\n| `-p` or `--port <port>`                 | Specify a port number on which to start the application. (default: 3000, env: PORT)                             |\n| `-H` or `--hostname <hostname>`         | Specify a hostname on which to start the application (default: 0.0.0.0).                                        |\n| `--keepAliveTimeout <keepAliveTimeout>` | Specify the maximum amount of milliseconds to wait before closing the inactive connections.                     |"
  },
  {
    "id": "next.mdx#17",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "### `next info` options\n\n`next info` prints relevant details about the current system which can be used to report Next.js bugs when opening a [GitHub issue](https://github.com/vercel/next.js/issues). This information includes Operating System platform/arch/version, Binaries (Node.js, npm, Yarn, pnpm), package versions (`next`, `react`, `react-dom`), and more.\n\nThe output should look like this:\n\n```bash filename=\"Terminal\"\nOperating System:\n  Platform: darwin\n  Arch: arm64\n  Version: Darwin Kernel Version 23.6.0\n  Available memory (MB): 65536\n  Available CPU cores: 10\nBinaries:\n  Node: 20.12.0\n  npm: 10.5.0\n  Yarn: 1.22.19\n  pnpm: 9.6.0\nRelevant Packages:\n  next: 15.0.0-canary.115 // Latest available version is detected (15.0.0-canary.115).\n  eslint-config-next: 14.2.5\n  react: 19.0.0-rc\n  react-dom: 19.0.0\n  typescript: 5.5.4\nNext.js Config:\n  output: N/A"
  },
  {
    "id": "next.mdx#18",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "```\n\nThe following options are available for the `next info` command:\n\n| Option           | Description                                    |\n| ---------------- | ---------------------------------------------- |\n| `-h` or `--help` | Show all available options                     |\n| `--verbose`      | Collects additional information for debugging. |"
  },
  {
    "id": "next.mdx#19",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "### `next telemetry` options\n\nNext.js collects **completely anonymous** telemetry data about general usage. Participation in this anonymous program is optional, and you can opt-out if you prefer not to share information.\n\nThe following options are available for the `next telemetry` command:\n\n| Option       | Description                             |\n| ------------ | --------------------------------------- |\n| `-h, --help` | Show all available options.             |\n| `--enable`   | Enables Next.js' telemetry collection.  |\n| `--disable`  | Disables Next.js' telemetry collection. |\n\nLearn more about [Telemetry](/telemetry)."
  },
  {
    "id": "next.mdx#20",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "### `next typegen` options\n\n`next typegen` generates TypeScript definitions for your application's routes without performing a full build. This is useful for IDE autocomplete and CI type-checking of route usage.\n\nPreviously, route types were only generated during `next dev` or `next build`, which meant running `tsc --noEmit` directly wouldn't validate your route types. Now you can generate types independently and validate them externally:\n\n```bash filename=\"Terminal\"\n# Generate route types first, then validate with TypeScript\nnext typegen && tsc --noEmit\n\n# Or in CI workflows for type checking without building\nnext typegen && npm run type-check"
  },
  {
    "id": "next.mdx#21",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "```\n\nThe following options are available for the `next typegen` command:\n\n| Option        | Description                                                                                  |\n| ------------- | -------------------------------------------------------------------------------------------- |\n| `-h, --help`  | Show all available options.                                                                  |\n| `[directory]` | A directory on which to generate types. If not provided, the current directory will be used. |\n\nOutput files are written to `<distDir>/types` (typically: `.next/dev/types` or `.next/types`, see [`isolatedDevBuild`](/docs/app/api-reference/config/next-config-js/isolatedDevBuild)):\n\n```bash filename=\"Terminal\"\nnext typegen\n# or for a specific app\nnext typegen ./apps/web"
  },
  {
    "id": "next.mdx#22",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "```\n\nAdditionally, `next typegen` generates a `next-env.d.ts` file. We recommend adding `next-env.d.ts` to your `.gitignore` file.\n\nThe `next-env.d.ts` file is included into your `tsconfig.json` file, to make Next.js types available to your project.\n\nTo ensure `next-env.d.ts` is present before type-checking run `next typegen`. The commands `next dev` and `next build` also generate the `next-env.d.ts` file, but it is often undesirable to run these just to type-check, for example in CI/CD environments.\n\n> **Good to know**: `next typegen` loads your Next.js config (`next.config.js`, `next.config.mjs`, or `next.config.ts`) using the production build phase. Ensure any required environment variables and dependencies are available so the config can load correctly."
  },
  {
    "id": "next.mdx#23",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "## `next upgrade` options\n\n`next upgrade` upgrades your Next.js application to the latest version.\n\nThe following options are available for the `next upgrade` command:"
  },
  {
    "id": "next.mdx#24",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "The following options are available for the `next upgrade` command:\n\n| Option                  | Description                                                                                                                                        |\n| ----------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `-h, --help`            | Show all available options.                                                                                                                        |\n| `[directory]`           | A directory with the Next.js application to upgrade. If not provided, the current directory will be used.                                          |\n| `--revision <revision>` | Specify a Next.js version or tag to upgrade to (e.g., `latest`, `canary`, `15.0.0`). Defaults to the release channel you have currently installed. |\n| `--verbose`             | Show verbose output during the upgrade process.                                                                                                    |"
  },
  {
    "id": "next.mdx#25",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "## Examples\n\n### Debugging prerender errors\n\nIf you encounter prerendering errors during `next build`, you can pass the `--debug-prerender` flag to get more detailed output:\n\n```bash filename=\"Terminal\"\nnext build --debug-prerender\n```\n\nThis enables several experimental options to make debugging easier:\n\n- Disables server code minification:\n  - `experimental.serverMinification = false`\n  - `experimental.turbopackMinify = false`\n- Generates source maps for server bundles:\n  - `experimental.serverSourceMaps = true`\n- Enables source map consumption in child processes used for prerendering:\n  - `enablePrerenderSourceMaps = true`\n- Continues building even after the first prerender error, so you can see all issues at once:\n  - `experimental.prerenderEarlyExit = false`\n\nThis helps surface more readable stack traces and code frames in the build output.\n\n> **Warning**: `--debug-prerender` is for debugging in development only. Do not deploy builds generated with `--debug-prerender` to production, as it may impact performance."
  },
  {
    "id": "next.mdx#26",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "### Building specific routes\n\nYou can build only specific routes in the App and Pages Routers using the `--debug-build-paths` option. This is useful for faster debugging when working with large applications. The `--debug-build-paths` option accepts comma-separated file paths and supports glob patterns:\n\n```bash filename=\"Terminal\"\n# Build a specific route\nnext build --debug-build-paths=\"app/page.tsx\"\n\n# Build more than one route\nnext build --debug-build-paths=\"app/page.tsx,pages/index.tsx\"\n\n# Use glob patterns\nnext build --debug-build-paths=\"app/**/page.tsx\"\nnext build --debug-build-paths=\"pages/*.tsx\"\n```\n\n### Changing the default port\n\nBy default, Next.js uses `http://localhost:3000` during development and with `next start`. The default port can be changed with the `-p` option, like so:\n\n```bash filename=\"Terminal\"\nnext dev -p 4000\n```\n\nOr using the `PORT` environment variable:\n\n```bash filename=\"Terminal\"\nPORT=4000 next dev\n```\n\n> **Good to know**: `PORT` cannot be set in `.env` as booting up the HTTP server happens before any other code is initialized."
  },
  {
    "id": "next.mdx#27",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "### Using HTTPS during development\n\nFor certain use cases like webhooks or authentication, you can use [HTTPS](https://developer.mozilla.org/en-US/docs/Glossary/HTTPS) to have a secure environment on `localhost`. Next.js can generate a self-signed certificate with `next dev` using the `--experimental-https` flag:\n\n```bash filename=\"Terminal\"\nnext dev --experimental-https\n```\n\nWith the generated certificate, the Next.js development server will exist at `https://localhost:3000`. The default port `3000` is used unless a port is specified with `-p`, `--port`, or `PORT`.\n\nYou can also provide a custom certificate and key with `--experimental-https-key` and `--experimental-https-cert`. Optionally, you can provide a custom CA certificate with `--experimental-https-ca` as well.\n\n```bash filename=\"Terminal\"\nnext dev --experimental-https --experimental-https-key ./certificates/localhost-key.pem --experimental-https-cert ./certificates/localhost.pem\n```\n\n`next dev --experimental-https` is only intended for development and creates a locally trusted certificate with [`mkcert`](https://github.com/FiloSottile/mkcert). In production, use properly issued certificates from trusted authorities."
  },
  {
    "id": "next.mdx#28",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "### Configuring a timeout for downstream proxies\n\nWhen deploying Next.js behind a downstream proxy (e.g. a load-balancer like AWS ELB/ALB), it's important to configure Next's underlying HTTP server with [keep-alive timeouts](https://nodejs.org/api/http.html#http_server_keepalivetimeout) that are _larger_ than the downstream proxy's timeouts. Otherwise, once a keep-alive timeout is reached for a given TCP connection, Node.js will immediately terminate that connection without notifying the downstream proxy. This results in a proxy error whenever it attempts to reuse a connection that Node.js has already terminated.\n\nTo configure the timeout values for the production Next.js server, pass `--keepAliveTimeout` (in milliseconds) to `next start`, like so:\n\n```bash filename=\"Terminal\"\nnext start --keepAliveTimeout 70000\n```"
  },
  {
    "id": "next.mdx#29",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "### Passing Node.js arguments\n\nYou can pass any [node arguments](https://nodejs.org/api/cli.html#cli_node_options_options) to `next` commands. For example:\n\n```bash filename=\"Terminal\"\nNODE_OPTIONS='--throw-deprecation' next\nNODE_OPTIONS='-r esm' next\nNODE_OPTIONS='--inspect' next\n```\n\n| Version   | Changes                                                                         |\n| --------- | ------------------------------------------------------------------------------- |\n| `v16.0.0` | The JS bundle size metrics have been removed from `next build`                  |\n| `v15.5.0` | Add the `next typegen` command                                                  |\n| `v15.4.0` | Add `--debug-prerender` option for `next build` to help debug prerender errors. |"
  },
  {
    "id": "07-edge.mdx#0",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "---\ntitle: Edge Runtime\ndescription: API Reference for the Edge Runtime.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nNext.js has two server runtimes you can use in your application:\n\n- The **Node.js Runtime** (default), which has access to all Node.js APIs and is used for rendering your application.\n- The **Edge Runtime** which contains a more limited [set of APIs](#reference), used in [Proxy](/docs/app/api-reference/file-conventions/proxy).\n\n## Caveats\n\n- The Edge Runtime does not support all Node.js APIs. Some packages may not work as expected.\n- The Edge Runtime does not support Incremental Static Regeneration (ISR).\n- Both runtimes can support [streaming](/docs/app/api-reference/file-conventions/loading) depending on your deployment adapter."
  },
  {
    "id": "07-edge.mdx#1",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "## Reference\n\nThe Edge Runtime supports the following APIs:"
  },
  {
    "id": "07-edge.mdx#2",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "### Network APIs"
  },
  {
    "id": "07-edge.mdx#3",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| API                                                                             | Description                       |\n| ------------------------------------------------------------------------------- | --------------------------------- |\n| [`Blob`](https://developer.mozilla.org/docs/Web/API/Blob)                       | Represents a blob                 |\n| [`fetch`](https://developer.mozilla.org/docs/Web/API/Fetch_API)                 | Fetches a resource                |\n| [`FetchEvent`](https://developer.mozilla.org/docs/Web/API/FetchEvent)           | Represents a fetch event          |\n| [`File`](https://developer.mozilla.org/docs/Web/API/File)                       | Represents a file                 |\n| [`FormData`](https://developer.mozilla.org/docs/Web/API/FormData)               | Represents form data              |\n| [`Headers`](https://developer.mozilla.org/docs/Web/API/Headers)                 | Represents HTTP headers           |\n| [`Request`](https://developer.mozilla.org/docs/Web/API/Request)                 | Represents an HTTP request        |"
  },
  {
    "id": "07-edge.mdx#4",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`Request`](https://developer.mozilla.org/docs/Web/API/Request)                 | Represents an HTTP request        |\n| [`Response`](https://developer.mozilla.org/docs/Web/API/Response)               | Represents an HTTP response       |\n| [`URLSearchParams`](https://developer.mozilla.org/docs/Web/API/URLSearchParams) | Represents URL search parameters  |\n| [`WebSocket`](https://developer.mozilla.org/docs/Web/API/WebSocket)             | Represents a websocket connection |"
  },
  {
    "id": "07-edge.mdx#5",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "### Encoding APIs\n\n| API                                                                                 | Description                        |\n| ----------------------------------------------------------------------------------- | ---------------------------------- |\n| [`atob`](https://developer.mozilla.org/en-US/docs/Web/API/atob)                     | Decodes a base-64 encoded string   |\n| [`btoa`](https://developer.mozilla.org/en-US/docs/Web/API/btoa)                     | Encodes a string in base-64        |\n| [`TextDecoder`](https://developer.mozilla.org/docs/Web/API/TextDecoder)             | Decodes a Uint8Array into a string |\n| [`TextDecoderStream`](https://developer.mozilla.org/docs/Web/API/TextDecoderStream) | Chainable decoder for streams      |\n| [`TextEncoder`](https://developer.mozilla.org/docs/Web/API/TextEncoder)             | Encodes a string into a Uint8Array |\n| [`TextEncoderStream`](https://developer.mozilla.org/docs/Web/API/TextEncoderStream) | Chainable encoder for streams      |"
  },
  {
    "id": "07-edge.mdx#6",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "### Stream APIs"
  },
  {
    "id": "07-edge.mdx#7",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| API                                                                                                     | Description                             |\n| ------------------------------------------------------------------------------------------------------- | --------------------------------------- |\n| [`ReadableStream`](https://developer.mozilla.org/docs/Web/API/ReadableStream)                           | Represents a readable stream            |\n| [`ReadableStreamBYOBReader`](https://developer.mozilla.org/docs/Web/API/ReadableStreamBYOBReader)       | Represents a reader of a ReadableStream |\n| [`ReadableStreamDefaultReader`](https://developer.mozilla.org/docs/Web/API/ReadableStreamDefaultReader) | Represents a reader of a ReadableStream |\n| [`TransformStream`](https://developer.mozilla.org/docs/Web/API/TransformStream)                         | Represents a transform stream           |\n| [`WritableStream`](https://developer.mozilla.org/docs/Web/API/WritableStream)                           | Represents a writable stream            |"
  },
  {
    "id": "07-edge.mdx#8",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`WritableStream`](https://developer.mozilla.org/docs/Web/API/WritableStream)                           | Represents a writable stream            |\n| [`WritableStreamDefaultWriter`](https://developer.mozilla.org/docs/Web/API/WritableStreamDefaultWriter) | Represents a writer of a WritableStream |"
  },
  {
    "id": "07-edge.mdx#9",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "### Crypto APIs\n\n| API                                                                       | Description                                                                                         |\n| ------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------- |\n| [`crypto`](https://developer.mozilla.org/docs/Web/API/Window/crypto)      | Provides access to the cryptographic functionality of the platform                                  |\n| [`CryptoKey`](https://developer.mozilla.org/docs/Web/API/CryptoKey)       | Represents a cryptographic key                                                                      |\n| [`SubtleCrypto`](https://developer.mozilla.org/docs/Web/API/SubtleCrypto) | Provides access to common cryptographic primitives, like hashing, signing, encryption or decryption |"
  },
  {
    "id": "07-edge.mdx#10",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "### Web Standard APIs"
  },
  {
    "id": "07-edge.mdx#11",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| API                                                                                                                   | Description                                                                                                                                                                                          |\n| --------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| [`AbortController`](https://developer.mozilla.org/docs/Web/API/AbortController)                                       | Allows you to abort one or more DOM requests as and when desired                                                                                                                                     |"
  },
  {
    "id": "07-edge.mdx#12",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)                           | Represents an array of values                                                                                                                                                                        |\n| [`ArrayBuffer`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer)               | Represents a generic, fixed-length raw binary data buffer                                                                                                                                            |\n| [`Atomics`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Atomics)                       | Provides atomic operations as static methods                                                                                                                                                         |"
  },
  {
    "id": "07-edge.mdx#13",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`BigInt`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigInt)                         | Represents a whole number with arbitrary precision                                                                                                                                                   |\n| [`BigInt64Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigInt64Array)           | Represents a typed array of 64-bit signed integers                                                                                                                                                   |\n| [`BigUint64Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigUint64Array)         | Represents a typed array of 64-bit unsigned integers                                                                                                                                                 |"
  },
  {
    "id": "07-edge.mdx#14",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`Boolean`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)                       | Represents a logical entity and can have two values: `true` and `false`                                                                                                                              |\n| [`clearInterval`](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/clearInterval)                 | Cancels a timed, repeating action which was previously established by a call to `setInterval()`                                                                                                      |\n| [`clearTimeout`](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/clearTimeout)                   | Cancels a timed, repeating action which was previously established by a call to `setTimeout()`                                                                                                       |"
  },
  {
    "id": "07-edge.mdx#15",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`console`](https://developer.mozilla.org/docs/Web/API/Console)                                                       | Provides access to the browser's debugging console                                                                                                                                                   |\n| [`DataView`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/DataView)                     | Represents a generic view of an `ArrayBuffer`                                                                                                                                                        |\n| [`Date`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Date)                             | Represents a single moment in time in a platform-independent format                                                                                                                                  |"
  },
  {
    "id": "07-edge.mdx#16",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`decodeURI`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/decodeURI)                   | Decodes a Uniform Resource Identifier (URI) previously created by `encodeURI` or by a similar routine                                                                                                |\n| [`decodeURIComponent`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/decodeURIComponent) | Decodes a Uniform Resource Identifier (URI) component previously created by `encodeURIComponent` or by a similar routine                                                                             |\n| [`DOMException`](https://developer.mozilla.org/docs/Web/API/DOMException)                                             | Represents an error that occurs in the DOM                                                                                                                                                           |"
  },
  {
    "id": "07-edge.mdx#17",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`encodeURI`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeURI)                   | Encodes a Uniform Resource Identifier (URI) by replacing each instance of certain characters by one, two, three, or four escape sequences representing the UTF-8 encoding of the character           |\n| [`encodeURIComponent`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent) | Encodes a Uniform Resource Identifier (URI) component by replacing each instance of certain characters by one, two, three, or four escape sequences representing the UTF-8 encoding of the character |\n| [`Error`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error)                           | Represents an error when trying to execute a statement or accessing a property                                                                                                                       |"
  },
  {
    "id": "07-edge.mdx#18",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`EvalError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/EvalError)                   | Represents an error that occurs regarding the global function `eval()`                                                                                                                               |\n| [`Float32Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Float32Array)             | Represents a typed array of 32-bit floating point numbers                                                                                                                                            |\n| [`Float64Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Float64Array)             | Represents a typed array of 64-bit floating point numbers                                                                                                                                            |"
  },
  {
    "id": "07-edge.mdx#19",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`Function`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function)                     | Represents a function                                                                                                                                                                                |\n| [`Infinity`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Infinity)                     | Represents the mathematical Infinity value                                                                                                                                                           |\n| [`Int8Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int8Array)                   | Represents a typed array of 8-bit signed integers                                                                                                                                                    |"
  },
  {
    "id": "07-edge.mdx#20",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`Int16Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int16Array)                 | Represents a typed array of 16-bit signed integers                                                                                                                                                   |\n| [`Int32Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int32Array)                 | Represents a typed array of 32-bit signed integers                                                                                                                                                   |\n| [`Intl`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Intl)                             | Provides access to internationalization and localization functionality                                                                                                                               |"
  },
  {
    "id": "07-edge.mdx#21",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`isFinite`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/isFinite)                     | Determines whether a value is a finite number                                                                                                                                                        |\n| [`isNaN`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/isNaN)                           | Determines whether a value is `NaN` or not                                                                                                                                                           |\n| [`JSON`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON)                             | Provides functionality to convert JavaScript values to and from the JSON format                                                                                                                      |"
  },
  {
    "id": "07-edge.mdx#22",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`Map`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Map)                               | Represents a collection of values, where each value may occur only once                                                                                                                              |\n| [`Math`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Math)                             | Provides access to mathematical functions and constants                                                                                                                                              |\n| [`Number`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)                         | Represents a numeric value                                                                                                                                                                           |"
  },
  {
    "id": "07-edge.mdx#23",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`Object`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)                         | Represents the object that is the base of all JavaScript objects                                                                                                                                     |\n| [`parseFloat`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/parseFloat)                 | Parses a string argument and returns a floating point number                                                                                                                                         |\n| [`parseInt`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/parseInt)                     | Parses a string argument and returns an integer of the specified radix                                                                                                                               |"
  },
  {
    "id": "07-edge.mdx#24",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`Promise`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)                       | Represents the eventual completion (or failure) of an asynchronous operation, and its resulting value                                                                                                |\n| [`Proxy`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Proxy)                           | Represents an object that is used to define custom behavior for fundamental operations (e.g. property lookup, assignment, enumeration, function invocation, etc)                                     |\n| [`queueMicrotask`](https://developer.mozilla.org/docs/Web/API/queueMicrotask)                                         | Queues a microtask to be executed                                                                                                                                                                    |"
  },
  {
    "id": "07-edge.mdx#25",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`RangeError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/RangeError)                 | Represents an error when a value is not in the set or range of allowed values                                                                                                                        |\n| [`ReferenceError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError)         | Represents an error when a non-existent variable is referenced                                                                                                                                       |\n| [`Reflect`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Reflect)                       | Provides methods for interceptable JavaScript operations                                                                                                                                             |"
  },
  {
    "id": "07-edge.mdx#26",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`RegExp`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/RegExp)                         | Represents a regular expression, allowing you to match combinations of characters                                                                                                                    |\n| [`Set`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Set)                               | Represents a collection of values, where each value may occur only once                                                                                                                              |\n| [`setInterval`](https://developer.mozilla.org/docs/Web/API/setInterval)                                               | Repeatedly calls a function, with a fixed time delay between each call                                                                                                                               |"
  },
  {
    "id": "07-edge.mdx#27",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`setTimeout`](https://developer.mozilla.org/docs/Web/API/setTimeout)                                                 | Calls a function or evaluates an expression after a specified number of milliseconds                                                                                                                 |\n| [`SharedArrayBuffer`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer)   | Represents a generic, fixed-length raw binary data buffer                                                                                                                                            |\n| [`String`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)                         | Represents a sequence of characters                                                                                                                                                                  |"
  },
  {
    "id": "07-edge.mdx#28",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`structuredClone`](https://developer.mozilla.org/docs/Web/API/Web_Workers_API/Structured_clone_algorithm)            | Creates a deep copy of a value                                                                                                                                                                       |\n| [`Symbol`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Symbol)                         | Represents a unique and immutable data type that is used as the key of an object property                                                                                                            |\n| [`SyntaxError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError)               | Represents an error when trying to interpret syntactically invalid code                                                                                                                              |"
  },
  {
    "id": "07-edge.mdx#29",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`TypeError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/TypeError)                   | Represents an error when a value is not of the expected type                                                                                                                                         |\n| [`Uint8Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)                 | Represents a typed array of 8-bit unsigned integers                                                                                                                                                  |\n| [`Uint8ClampedArray`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray)   | Represents a typed array of 8-bit unsigned integers clamped to 0-255                                                                                                                                 |"
  },
  {
    "id": "07-edge.mdx#30",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`Uint32Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array)               | Represents a typed array of 32-bit unsigned integers                                                                                                                                                 |\n| [`URIError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/URIError)                     | Represents an error when a global URI handling function was used in a wrong way                                                                                                                      |\n| [`URL`](https://developer.mozilla.org/docs/Web/API/URL)                                                               | Represents an object providing static methods used for creating object URLs                                                                                                                          |"
  },
  {
    "id": "07-edge.mdx#31",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`URLPattern`](https://developer.mozilla.org/docs/Web/API/URLPattern)                                                 | Represents a URL pattern                                                                                                                                                                             |\n| [`URLSearchParams`](https://developer.mozilla.org/docs/Web/API/URLSearchParams)                                       | Represents a collection of key/value pairs                                                                                                                                                           |\n| [`WeakMap`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakMap)                       | Represents a collection of key/value pairs in which the keys are weakly referenced                                                                                                                   |"
  },
  {
    "id": "07-edge.mdx#32",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`WeakSet`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakSet)                       | Represents a collection of objects in which each object may occur only once                                                                                                                          |\n| [`WebAssembly`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly)               | Provides access to WebAssembly                                                                                                                                                                       |"
  },
  {
    "id": "07-edge.mdx#33",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "### Next.js Specific Polyfills\n\n- [`AsyncLocalStorage`](https://nodejs.org/api/async_context.html#class-asynclocalstorage)\n\n### Environment Variables\n\nYou can use `process.env` to access [Environment Variables](/docs/app/guides/environment-variables) for both `next dev` and `next build`."
  },
  {
    "id": "07-edge.mdx#34",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "### Unsupported APIs\n\nThe Edge Runtime has some restrictions including:\n\n- Native Node.js APIs **are not supported**. For example, you can't read or write to the filesystem.\n- `node_modules` _can_ be used, as long as they implement ES Modules and do not use native Node.js APIs.\n- Calling `require` directly is **not allowed**. Use ES Modules instead.\n\nThe following JavaScript language features are disabled, and **will not work:**"
  },
  {
    "id": "07-edge.mdx#35",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| API                                                                                                                             | Description                                                         |\n| ------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------- |\n| [`eval`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/eval)                                       | Evaluates JavaScript code represented as a string                   |\n| [`new Function(evalString)`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function)               | Creates a new function with the code provided as an argument        |\n| [`WebAssembly.compile`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/compile)         | Compiles a WebAssembly module from a buffer source                  |"
  },
  {
    "id": "07-edge.mdx#36",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "| [`WebAssembly.instantiate`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/instantiate) | Compiles and instantiates a WebAssembly module from a buffer source |"
  },
  {
    "id": "07-edge.mdx#37",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "In rare cases, your code could contain (or import) some dynamic code evaluation statements which _can not be reached at runtime_ and which can not be removed by treeshaking.\nYou can relax the check to allow specific files with your Proxy configuration:\n\n```javascript filename=\"proxy.ts\"\nexport const config = {\n  unstable_allowDynamic: [\n    // allows a single file\n    '/lib/utilities.js',\n    // use a glob to allow anything in the function-bind 3rd party module\n    '**/node_modules/function-bind/**',\n  ],\n}"
  },
  {
    "id": "07-edge.mdx#38",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "```\n\n`unstable_allowDynamic` is a [glob](https://github.com/micromatch/micromatch#matching-features), or an array of globs, ignoring dynamic code evaluation for specific files. The globs are relative to your application root folder.\n\nBe warned that if these statements are executed on the Edge, _they will throw and cause a runtime error_."
  },
  {
    "id": "08-turbopack.mdx#0",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "---\ntitle: Turbopack\ndescription: Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js.\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}\n\nTurbopack is an **incremental bundler** optimized for JavaScript and TypeScript, written in Rust, and built into **Next.js**. You can use Turbopack with both the Pages and App Router for a **much faster** local development experience."
  },
  {
    "id": "08-turbopack.mdx#1",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "## Why Turbopack?\n\nWe built Turbopack to push the performance of Next.js, including:\n\n- **Unified Graph:** Next.js supports multiple output environments (e.g., client and server). Managing multiple compilers and stitching bundles together can be tedious. Turbopack uses a **single, unified graph** for all environments.\n- **Bundling vs Native ESM:** Some tools skip bundling in development and rely on the browser's native ESM. This works well for small apps but can slow down large apps due to excessive network requests. Turbopack **bundles** in dev, but in an optimized way to keep large apps fast.\n- **Incremental Computation:** Turbopack parallelizes work across cores and **caches** results down to the function level. Once a piece of work is done, Turbopack won’t repeat it.\n- **Lazy Bundling:** Turbopack only bundles what is actually requested by the dev server. This lazy approach can reduce initial compile times and memory usage."
  },
  {
    "id": "08-turbopack.mdx#2",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "## Getting started\n\nTurbopack is now the **default bundler** in Next.js. No configuration is needed to use Turbopack:\n\n```json filename=\"package.json\" highlight={3}\n{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\"\n  }\n}\n```\n\n### Using Webpack instead\n\nIf you need to use Webpack instead of Turbopack, you can opt-in with the `--webpack` flag:\n\n```json filename=\"package.json\"\n{\n  \"scripts\": {\n    \"dev\": \"next dev --webpack\",\n    \"build\": \"next build --webpack\",\n    \"start\": \"next start\"\n  }\n}\n```"
  },
  {
    "id": "08-turbopack.mdx#3",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "## Supported features\n\nTurbopack in Next.js has **zero-configuration** for the common use cases. Below is a summary of what is supported out of the box, plus some references to how you can configure Turbopack further when needed."
  },
  {
    "id": "08-turbopack.mdx#4",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "### Language features"
  },
  {
    "id": "08-turbopack.mdx#5",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "| Feature                     | Status        | Notes                                                                                                                                                                                                                                                                                                                                                                                                                   |\n| --------------------------- | ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |"
  },
  {
    "id": "08-turbopack.mdx#6",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "| **JavaScript & TypeScript** | **Supported** | Uses SWC under the hood. Type-checking is not done by Turbopack (run `tsc --watch` or rely on your IDE for type checks).                                                                                                                                                                                                                                                                                                |\n| **ECMAScript (ESNext)**     | **Supported** | Turbopack supports the latest ECMAScript features, matching SWC’s coverage.                                                                                                                                                                                                                                                                                                                                             |"
  },
  {
    "id": "08-turbopack.mdx#7",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "| **CommonJS**                | **Supported** | `require()` syntax is handled out of the box.                                                                                                                                                                                                                                                                                                                                                                           |\n| **ESM**                     | **Supported** | Static and dynamic `import` are fully supported.                                                                                                                                                                                                                                                                                                                                                                        |"
  },
  {
    "id": "08-turbopack.mdx#8",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "| **Babel**                   | **Supported** | Starting in Next.js 16, Turbopack uses Babel automatically if it detects [a configuration file][babel-config]. Unlike in webpack, SWC is always used for Next.js's internal transforms and downleveling to older ECMAScript revisions. Next.js with webpack disables SWC if a Babel configuration file is present. Files in `node_modules` are excluded, unless you [manually configure `babel-loader`][manual-loader]. |"
  },
  {
    "id": "08-turbopack.mdx#9",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "[babel-config]: https://babeljs.io/docs/config-files\n[manual-loader]: /docs/app/api-reference/config/next-config-js/turbopack#configuring-webpack-loaders"
  },
  {
    "id": "08-turbopack.mdx#10",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "### Framework and React features\n\n| Feature                           | Status        | Notes                                                                                                                  |\n| --------------------------------- | ------------- | ---------------------------------------------------------------------------------------------------------------------- |\n| **JSX / TSX**                     | **Supported** | SWC handles JSX/TSX compilation.                                                                                       |\n| **Fast Refresh**                  | **Supported** | No configuration needed.                                                                                               |\n| **React Server Components (RSC)** | **Supported** | For the Next.js App Router. Turbopack ensures correct server/client bundling.                                          |\n| **Root layout creation**          | Unsupported   | Automatic creation of a root layout in App Router is not supported. Turbopack will instruct you to create it manually. |"
  },
  {
    "id": "08-turbopack.mdx#11",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "### CSS and styling"
  },
  {
    "id": "08-turbopack.mdx#12",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "| Feature            | Status                  | Notes                                                                                                                                                                                                                                                                                                                                                                 |\n| ------------------ | ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |"
  },
  {
    "id": "08-turbopack.mdx#13",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "| **Global CSS**     | **Supported**           | Import `.css` files directly in your application.                                                                                                                                                                                                                                                                                                                     |\n| **CSS Modules**    | **Supported**           | `.module.css` files work natively (Lightning CSS).                                                                                                                                                                                                                                                                                                                    |"
  },
  {
    "id": "08-turbopack.mdx#14",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "| **CSS Nesting**    | **Supported**           | Lightning CSS supports [modern CSS nesting](https://lightningcss.dev/).                                                                                                                                                                                                                                                                                               |\n| **@import syntax** | **Supported**           | Combine multiple CSS files.                                                                                                                                                                                                                                                                                                                                           |"
  },
  {
    "id": "08-turbopack.mdx#15",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "| **PostCSS**        | **Supported**           | Automatically processes `postcss.config.js` in a Node.js worker pool. Useful for Tailwind, Autoprefixer, etc.                                                                                                                                                                                                                                                         |\n| **Sass / SCSS**    | **Supported** (Next.js) | For Next.js, Sass is supported out of the box. Custom Sass functions (`sassOptions.functions`) are not supported because Turbopack's Rust-based architecture cannot directly execute JavaScript functions, unlike webpack's Node.js environment. Use webpack if you need this feature. In the future, Turbopack standalone usage will likely require a loader config. |"
  },
  {
    "id": "08-turbopack.mdx#16",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "| **Less**           | Planned via plugins     | Not yet supported by default. Will likely require a loader config once custom loaders are stable.                                                                                                                                                                                                                                                                     |\n| **Lightning CSS**  | **In Use**              | Handles CSS transformations. Some low-usage CSS Modules features (like `:local/:global` as standalone pseudo-classes) are not yet supported. [See below for more details.](#unsupported-and-unplanned-features)                                                                                                                                                       |"
  },
  {
    "id": "08-turbopack.mdx#17",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "### Assets\n\n| Feature                           | Status        | Notes                                                                                                                      |\n| --------------------------------- | ------------- | -------------------------------------------------------------------------------------------------------------------------- |\n| **Static Assets** (images, fonts) | **Supported** | Importing `import img from './img.png'` works out of the box. In Next.js, returns an object for the `<Image />` component. |\n| **JSON Imports**                  | **Supported** | Named or default imports from `.json` are supported.                                                                       |"
  },
  {
    "id": "08-turbopack.mdx#18",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "### Module resolution"
  },
  {
    "id": "08-turbopack.mdx#19",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "| Feature               | Status              | Notes                                                                                                                                                           |\n| --------------------- | ------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| **Path Aliases**      | **Supported**       | Reads `tsconfig.json`'s `paths` and `baseUrl`, matching Next.js behavior.                                                                                       |\n| **Manual Aliases**    | **Supported**       | [Configure `resolveAlias` in `next.config.js`](/docs/app/api-reference/config/next-config-js/turbopack#resolving-aliases) (similar to `webpack.resolve.alias`). |\n| **Custom Extensions** | **Supported**       | [Configure `resolveExtensions` in `next.config.js`](/docs/app/api-reference/config/next-config-js/turbopack#resolving-custom-extensions).                       |"
  },
  {
    "id": "08-turbopack.mdx#20",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "| **AMD**               | Partially Supported | Basic transforms work; advanced AMD usage is limited.                                                                                                           |"
  },
  {
    "id": "08-turbopack.mdx#21",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "### Performance and Fast Refresh\n\n| Feature                  | Status        | Notes                                                                                    |\n| ------------------------ | ------------- | ---------------------------------------------------------------------------------------- |\n| **Fast Refresh**         | **Supported** | Updates JavaScript, TypeScript, and CSS without a full refresh.                          |\n| **Incremental Bundling** | **Supported** | Turbopack lazily builds only what’s requested by the dev server, speeding up large apps. |"
  },
  {
    "id": "08-turbopack.mdx#22",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "## Known gaps with webpack\n\nThere are a number of non-trivial behavior differences between webpack and Turbopack that are important to be aware of when migrating an application. Generally, these are less of a concern for new applications.\n\n### Filesystem Root\n\nTurbopack uses the root directory to resolve modules. Files outside of the project root are not resolved.\n\nFor example, when linking dependencies outside the project root (via `npm link`, `yarn link`, `pnpm link`, etc.), those linked files will not be resolved by default. To resolve these files, you must configure the root option to the parent directory of both the project and the linked dependencies.\n\nYou can configure the filesystem root using [turbopack.root](/docs/app/api-reference/config/next-config-js/turbopack#root-directory) option in `next.config.js`."
  },
  {
    "id": "08-turbopack.mdx#23",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "### CSS Module Ordering\n\nTurbopack will follow JS import order to order [CSS modules](/docs/app/getting-started/css#css-modules) which are not otherwise ordered. For example:\n\n```jsx filename=\"components/BlogPost.jsx\"\nimport utilStyles from './utils.module.css'\nimport buttonStyles from './button.module.css'\nexport default function BlogPost() {\n  return (\n    <div className={utilStyles.container}>\n      <button className={buttonStyles.primary}>Click me</button>\n    </div>\n  )\n}\n```\n\nIn this example, Turbopack will ensure that `utils.module.css` will appear before `button.module.css` in the produced CSS chunk, following the import order\n\nWebpack generally does this as well, but there are cases where it will ignore JS inferred ordering, for example if it infers the JS file is side-effect-free.\n\nThis can lead to subtle rendering changes when adopting Turbopack, if applications have come to rely on an arbitrary ordering. Generally, the solution is easy, e.g. have `button.module.css` `@import utils.module.css` to force the ordering, or identify the conflicting rules and change them to not target the same properties."
  },
  {
    "id": "08-turbopack.mdx#24",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "### Sass node_modules imports\n\nTurbopack supports importing `node_modules` Sass files out of the box. Webpack supports a legacy tilde `~` syntax for this, which is not supported by Turbopack.\n\nFrom:\n\n```scss filename=\"styles/globals.scss\"\n@import '~bootstrap/dist/css/bootstrap.min.css';\n```\n\nTo:\n\n```scss filename=\"styles/globals.scss\"\n@import 'bootstrap/dist/css/bootstrap.min.css';\n```\n\nIf you can't update the imports, you can add a `turbopack.resolveAlias` configuration to map the `~` syntax to the actual path:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  turbopack: {\n    resolveAlias: {\n      '~*': '*',\n    },\n  },\n}\n```"
  },
  {
    "id": "08-turbopack.mdx#25",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "### Bundle Sizes\n\nFrom our testing on production applications, we observed that Turbopack generally produces bundles that are similar in size to Webpack. However, the comparison can be difficult since turbopack tends to produce fewer but larger chunks. Our advice is to focus on higher level metrics like [Core Web Vitals](https://web.dev/articles/vitals) or your own application level metrics to compare performance across the two bundlers. We are however aware of one gap that can occasionally cause a large regression.\n\nTurbopack does not yet have an equivalent to the [Inner Graph Optimization](https://webpack.js.org/configuration/optimization/#optimizationinnergraph) in webpack which is enabled by default. This optimization is useful to tree shake large modules. For example:\n\n```js filename=large.module.js\nimport heavy from 'some-heavy-dependency.js'\n\nexport function usesHeavy() {\n  return heavy.run()\n}\n\nexport const CONSTANT_VALUE = 3"
  },
  {
    "id": "08-turbopack.mdx#26",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "```\n\nIf an application only uses `CONSTANT_VALUE` Turbopack will detect this and delete the `usesHeavy` export but not the corresponding `import`. However, with the Inner Graph Optimization, webpack can delete the `import` too which can drop the dependency as well.\n\nWe are planning to offer an equivalent to the Inner Graph Optimization in Turbopack but it is still under development. If you are affected by this gap, consider manually splitting modules."
  },
  {
    "id": "08-turbopack.mdx#27",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "### Build Caching\n\nWebpack supports [disk build caching](https://webpack.js.org/configuration/cache/#cache) to improve build performance. Turbopack provides a similar opt-in feature, currently in beta. Starting with Next 16, you can enable Turbopack’s filesystem cache by setting the following experimental flags:\n\n- [`experimental.turbopackFileSystemCacheForDev`](/docs/app/api-reference/config/next-config-js/turbopackFileSystemCache)\n- [`experimental.turbopackFileSystemCacheForBuild`](/docs/app/api-reference/config/next-config-js/turbopackFileSystemCache)\n\n> **Good to know:** For this reason, when comparing webpack and Turbopack performance, make sure to delete the `.next` folder between builds to see a fair comparison or enable the turbopack filesystem cache feature."
  },
  {
    "id": "08-turbopack.mdx#28",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "### Webpack plugins\n\nTurbopack does not support webpack plugins. This affects third-party tools that rely on webpack's plugin system for integration. We do support [webpack loaders](/docs/app/api-reference/config/next-config-js/turbopack#configuring-webpack-loaders). If you depend on webpack plugins, you'll need to find Turbopack-compatible alternatives or continue using webpack until equivalent functionality is available."
  },
  {
    "id": "08-turbopack.mdx#29",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "## Unsupported and unplanned features\n\nSome features are not yet implemented or not planned:"
  },
  {
    "id": "08-turbopack.mdx#30",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "- **Legacy CSS Modules features**\n  - Standalone `:local` and `:global` pseudo-classes (only the function variant `:global(...)` is supported).\n  - The `@value` rule (superseded by CSS variables).\n  - `:import` and `:export` ICSS rules.\n  - `composes` in `.module.css` composing a `.css` file. In webpack this would treat the `.css` file as a CSS Module, with Turbopack the `.css` file will always be global. This means that if you want to use `composes` in a CSS Module, you need to change the `.css` file to a `.module.css` file.\n  - `@import` in CSS Modules importing `.css` as a CSS Module. In webpack this would treat the `.css` file as a CSS Module, with Turbopack the `.css` file will always be global. This means that if you want to use `@import` in a CSS Module, you need to change the `.css` file to a `.module.css` file.\n- **`sassOptions.functions`**"
  },
  {
    "id": "08-turbopack.mdx#31",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "- **`sassOptions.functions`**\n  Custom Sass functions defined in `sassOptions.functions` are not supported. This feature allows defining JavaScript functions that can be called from Sass code during compilation. Turbopack's Rust-based architecture cannot directly execute JavaScript functions passed through `sassOptions.functions`, unlike webpack's Node.js-based sass-loader which runs entirely in JavaScript. If you're using custom Sass functions, you'll need to use webpack instead of Turbopack.\n- **`webpack()` configuration** in `next.config.js`\n  Turbopack replaces webpack, so `webpack()` configs are not recognized. Use the [`turbopack` config](/docs/app/api-reference/config/next-config-js/turbopack) instead.\n- **Yarn PnP**\n  Not planned for Turbopack support in Next.js.\n- **`experimental.urlImports`**\n  Not planned for Turbopack.\n- **`experimental.esmExternals`**\n  Not planned. Turbopack does not support the legacy `esmExternals` configuration in Next.js.\n- **Some Next.js Experimental Flags**\n  - `experimental.nextScriptWorkers`\n  - `experimental.sri.algorithm`\n  - `experimental.fallbackNodePolyfills`\n    We plan to implement these in the future."
  },
  {
    "id": "08-turbopack.mdx#32",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "For a full, detailed breakdown of each feature flag and its status, see the [Turbopack API Reference](/docs/app/api-reference/config/next-config-js/turbopack)."
  },
  {
    "id": "08-turbopack.mdx#33",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "## Configuration\n\nTurbopack can be configured via `next.config.js` (or `next.config.ts`) under the `turbopack` key. Configuration options include:\n\n- **`rules`**\n  Define additional [webpack loaders](/docs/app/api-reference/config/next-config-js/turbopack#configuring-webpack-loaders) for file transformations.\n- **`resolveAlias`**\n  Create manual aliases (like `resolve.alias` in webpack).\n- **`resolveExtensions`**\n  Change or extend file extensions for module resolution.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  turbopack: {\n    // Example: adding an alias and custom file extension\n    resolveAlias: {\n      underscore: 'lodash',\n    },\n    resolveExtensions: ['.mdx', '.tsx', '.ts', '.jsx', '.js', '.json'],\n  },\n}\n```\n\nFor more in-depth configuration examples, see the [Turbopack config documentation](/docs/app/api-reference/config/next-config-js/turbopack)."
  },
  {
    "id": "08-turbopack.mdx#34",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "## Generating trace files for performance debugging\n\nIf you encounter performance or memory issues and want to help the Next.js team diagnose them, you can generate a trace file by appending `NEXT_TURBOPACK_TRACING=1` to your dev command:\n\n```bash\nNEXT_TURBOPACK_TRACING=1 next dev\n```\n\nThis will produce a `.next/dev/trace-turbopack` file. Include that file when creating a GitHub issue on the [Next.js repo](https://github.com/vercel/next.js) to help us investigate.\n\nBy default the development server outputs to `.next/dev`. Read more about [isolatedDevBuild](/docs/app/api-reference/config/next-config-js/isolatedDevBuild).\n\n## Summary\n\nTurbopack is a **Rust-based**, **incremental** bundler designed to make local development and builds fast—especially for large applications. It is integrated into Next.js, offering zero-config CSS, React, and TypeScript support."
  },
  {
    "id": "08-turbopack.mdx#35",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "## Version Changes\n\n| Version   | Changes                                                                                                            |\n| --------- | ------------------------------------------------------------------------------------------------------------------ |\n| `v16.0.0` | Turbopack becomes the default bundler for Next.js. Automatic support for Babel when a configuration file is found. |\n| `v15.5.0` | Turbopack support for `build` beta                                                                                 |\n| `v15.3.0` | Experimental support for `build`                                                                                   |\n| `v15.0.0` | Turbopack for `dev` stable                                                                                         |"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "API Reference",
      "description": "Next.js API Reference for the App Router."
    },
    "content": "---\ntitle: API Reference\ndescription: Next.js API Reference for the App Router.\n---"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "App Router",
      "description": "The App Router is a file-system based router that uses React's latest features such as Server Components, Suspense, Server Functions, and more."
    },
    "content": "---\ntitle: App Router\ndescription: The App Router is a file-system based router that uses React's latest features such as Server Components, Suspense, Server Functions, and more.\nrelated:\n  title: Next Steps\n  description: Learn the fundamentals of building an App Router project, from installation to layouts, navigation, server and client components.\n  links:\n    - app/getting-started/installation\n    - app/getting-started/project-structure\n    - app/getting-started/layouts-and-pages\n    - app/getting-started/linking-and-navigating\n    - app/getting-started/server-and-client-components\n---\n\nThe **App Router** is a file-system based router that uses React's latest features such as [Server Components](https://react.dev/reference/rsc/server-components), [Suspense](https://react.dev/reference/react/Suspense), and [Server Functions](https://react.dev/reference/rsc/server-functions)."
  },
  {
    "id": "01-installation.mdx#0",
    "metadata": {
      "title": "Create a new Next.js application",
      "description": "How to create a new Next.js application with `create-next-app`. Set up TypeScript, ESLint,and configure your `next.config.js` file."
    },
    "content": "---\ntitle: Create a new Next.js application\nnav_title: Installation\ndescription: How to create a new Next.js application with `create-next-app`. Set up TypeScript, ESLint,and configure your `next.config.js` file.\nsource: app/getting-started/installation\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "02-project-structure.mdx#0",
    "metadata": {
      "title": "Project Structure and Organization",
      "description": "Learn about the folder and file conventions in a Next.js project, and how to organize your project."
    },
    "content": "---\ntitle: Project Structure and Organization\nnav_title: Project Structure\ndescription: Learn about the folder and file conventions in a Next.js project, and how to organize your project.\nsource: app/getting-started/project-structure\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "04-images.mdx#0",
    "metadata": {
      "title": "Image Optimization",
      "description": "Optimize your images with the built-in `next/image` component."
    },
    "content": "---\ntitle: Image Optimization\nnav_title: Images\ndescription: Optimize your images with the built-in `next/image` component.\nrelated:\n  title: API Reference\n  description: See the API Reference for the full feature set of Next.js Image\n  links:\n    - pages/api-reference/components/image\nsource: app/getting-started/images\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "05-fonts.mdx#0",
    "metadata": {
      "title": "How to use fonts",
      "description": "Learn how to use fonts in Next.js"
    },
    "content": "---\ntitle: How to use fonts\nnav_title: Fonts\ndescription: Learn how to use fonts in Next.js\nrelated:\n  title: API Reference\n  description: See the API Reference for the full feature set of Next.js Font\n  links:\n    - pages/api-reference/components/font\nsource: app/getting-started/fonts\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "06-css.mdx#0",
    "metadata": {
      "title": "How to use CSS in your application",
      "description": "Learn about the different ways to add CSS to your application, including CSS Modules, Global CSS, Tailwind CSS, and more."
    },
    "content": "---\ntitle: How to use CSS in your application\nnav_title: CSS\ndescription: Learn about the different ways to add CSS to your application, including CSS Modules, Global CSS, Tailwind CSS, and more.\nrelated:\n  title: Next Steps\n  description: Learn more about the features mentioned in this page.\n  links:\n    - pages/guides/tailwind-v3-css\n    - pages/guides/sass\n    - pages/guides/css-in-js\nsource: app/getting-started/css\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "11-deploying.mdx#0",
    "metadata": {
      "title": "How to deploy your Next.js application",
      "description": "Learn how to deploy your Next.js application."
    },
    "content": "---\ntitle: How to deploy your Next.js application\nnav_title: Deploying\ndescription: Learn how to deploy your Next.js application.\nsource: app/getting-started/deploying\n---"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Getting Started - Pages Router",
      "description": "Learn how to create full-stack web applications with Next.js with the Pages Router."
    },
    "content": "---\ntitle: Getting Started - Pages Router\nnav_title: Getting Started\ndescription: Learn how to create full-stack web applications with Next.js with the Pages Router.\n---"
  },
  {
    "id": "analytics.mdx#0",
    "metadata": {
      "title": "How to set up analytics",
      "description": "Measure and track page performance using Next.js"
    },
    "content": "---\ntitle: How to set up analytics\nnav_title: Analytics\ndescription: Measure and track page performance using Next.js\nsource: app/guides/analytics\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "authentication.mdx#0",
    "metadata": {
      "title": "How to implement authentication in Next.js",
      "description": "Learn how to implement authentication in Next.js, covering best practices, securing routes, authorization techniques, and session management."
    },
    "content": "---\ntitle: How to implement authentication in Next.js\nnav_title: Authentication\ndescription: Learn how to implement authentication in Next.js, covering best practices, securing routes, authorization techniques, and session management.\nsource: app/guides/authentication\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "babel.mdx#0",
    "metadata": {
      "title": "How to configure Babel in Next.js",
      "description": "Extend the babel preset added by Next.js with your own configs."
    },
    "content": "---\ntitle: How to configure Babel in Next.js\nnav_title: Babel\ndescription: Extend the babel preset added by Next.js with your own configs.\n---\n\n<details>\n  <summary>Examples</summary>\n\n- [Customizing babel configuration](https://github.com/vercel/next.js/tree/canary/examples/with-custom-babel-config)\n\n</details>\n\nNext.js includes the `next/babel` preset to your app, which includes everything needed to compile React applications and server-side code. But if you want to extend the default Babel configs, it's also possible."
  },
  {
    "id": "babel.mdx#1",
    "metadata": {
      "title": "How to configure Babel in Next.js",
      "description": "Extend the babel preset added by Next.js with your own configs."
    },
    "content": "## Adding Presets and Plugins\n\nTo start, you only need to define a `.babelrc` file (or `babel.config.js`) in the root directory of your project. If such a file is found, it will be considered as the _source of truth_, and therefore it needs to define what Next.js needs as well, which is the `next/babel` preset.\n\nHere's an example `.babelrc` file:\n\n```json filename=\".babelrc\"\n{\n  \"presets\": [\"next/babel\"],\n  \"plugins\": []\n}\n```\n\nYou can [take a look at this file](https://github.com/vercel/next.js/blob/canary/packages/next/src/build/babel/preset.ts) to learn about the presets included by `next/babel`.\n\nTo add presets/plugins **without configuring them**, you can do it this way:\n\n```json filename=\".babelrc\"\n{\n  \"presets\": [\"next/babel\"],\n  \"plugins\": [\"@babel/plugin-proposal-do-expressions\"]\n}\n```"
  },
  {
    "id": "babel.mdx#2",
    "metadata": {
      "title": "How to configure Babel in Next.js",
      "description": "Extend the babel preset added by Next.js with your own configs."
    },
    "content": "## Customizing Presets and Plugins\n\nTo add presets/plugins **with custom configuration**, do it on the `next/babel` preset like so:\n\n```json filename=\".babelrc\"\n{\n  \"presets\": [\n    [\n      \"next/babel\",\n      {\n        \"preset-env\": {},\n        \"transform-runtime\": {},\n        \"styled-jsx\": {},\n        \"class-properties\": {}\n      }\n    ]\n  ],\n  \"plugins\": []\n}\n```\n\nTo learn more about the available options for each config, visit babel's [documentation](https://babeljs.io/docs/) site.\n\n> **Good to know**:\n>\n> - Next.js uses the [**current** Node.js version](https://github.com/nodejs/release#release-schedule) for server-side compilations.\n> - The `modules` option on `\"preset-env\"` should be kept to `false`, otherwise webpack code splitting is turned off."
  },
  {
    "id": "ci-build-caching.mdx#0",
    "metadata": {
      "title": "How to configure Continuous Integration (CI) build caching",
      "description": "Learn how to configure CI to cache Next.js builds"
    },
    "content": "---\ntitle: How to configure Continuous Integration (CI) build caching\nnav_title: CI Build Caching\ndescription: Learn how to configure CI to cache Next.js builds\nsource: app/guides/ci-build-caching\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "content-security-policy.mdx#0",
    "metadata": {
      "title": "How to set a Content Security Policy (CSP) for your Next.js application",
      "description": "Learn how to set a Content Security Policy (CSP) for your Next.js application."
    },
    "content": "---\ntitle: How to set a Content Security Policy (CSP) for your Next.js application\nnav_title: Content Security Policy\ndescription: Learn how to set a Content Security Policy (CSP) for your Next.js application.\nsource: app/guides/content-security-policy\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "css-in-js.mdx#0",
    "metadata": {
      "title": "How to use CSS-in-JS libraries",
      "description": "Use CSS-in-JS libraries with Next.js"
    },
    "content": "---\ntitle: How to use CSS-in-JS libraries\nnav_title: CSS-in-JS\ndescription: Use CSS-in-JS libraries with Next.js\nsource: app/guides/css-in-js\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "custom-server.mdx#0",
    "metadata": {
      "title": "How to set up a custom server in Next.js",
      "description": "Start a Next.js app programmatically using a custom server."
    },
    "content": "---\ntitle: How to set up a custom server in Next.js\nnav_title: Custom Server\ndescription: Start a Next.js app programmatically using a custom server.\nsource: app/guides/custom-server\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "debugging.mdx#0",
    "metadata": {
      "title": "How to use debugging tools with Next.js",
      "description": "Learn how to debug your Next.js application with VS Code or Chrome DevTools."
    },
    "content": "---\ntitle: How to use debugging tools with Next.js\nnav_title: Debugging\ndescription: Learn how to debug your Next.js application with VS Code or Chrome DevTools.\nsource: app/guides/debugging\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "draft-mode.mdx#0",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with Pages Router."
    },
    "content": "---\ntitle: How to preview content with Draft Mode in Next.js\nnav_title: Draft Mode\ndescription: Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with Pages Router.\n---\n\nIn the [Pages documentation](/docs/pages/building-your-application/routing/pages-and-layouts) and the [Data Fetching documentation](/docs/pages/building-your-application/data-fetching), we talked about how to pre-render a page at build time (**Static Generation**) using `getStaticProps` and `getStaticPaths`.\n\nStatic Generation is useful when your pages fetch data from a headless CMS. However, it’s not ideal when you’re writing a draft on your headless CMS and want to view the draft immediately on your page. You’d want Next.js to render these pages at **request time** instead of build time and fetch the draft content instead of the published content. You’d want Next.js to bypass Static Generation only for this specific case.\n\nNext.js has a feature called **Draft Mode** which solves this problem. Here are instructions on how to use it."
  },
  {
    "id": "draft-mode.mdx#1",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with Pages Router."
    },
    "content": "## Step 1: Create and access the API route\n\n> Take a look at the [API Routes documentation](/docs/pages/building-your-application/routing/api-routes) first if you’re not familiar with Next.js API Routes.\n\nFirst, create the **API route**. It can have any name - e.g. `pages/api/draft.ts`\n\nIn this API route, you need to call `setDraftMode` on the response object.\n\n```js\nexport default function handler(req, res) {\n  // ...\n  res.setDraftMode({ enable: true })\n  // ...\n}\n```\n\nThis will set a **cookie** to enable draft mode. Subsequent requests containing this cookie will trigger **Draft Mode** changing the behavior for statically generated pages (more on this later).\n\nYou can test this manually by creating an API route like below and accessing it from your browser manually:\n\n```ts filename=\"pages/api/draft.ts\"\n// simple example for testing it manually from your browser.\nexport default function handler(req, res) {\n  res.setDraftMode({ enable: true })\n  res.end('Draft mode is enabled')\n}\n```\n\nIf you open your browser’s developer tools and visit `/api/draft`, you’ll notice a `Set-Cookie` response header with a cookie named `__prerender_bypass`."
  },
  {
    "id": "draft-mode.mdx#2",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with Pages Router."
    },
    "content": "### Securely accessing it from your Headless CMS\n\nIn practice, you’d want to call this API route _securely_ from your headless CMS. The specific steps will vary depending on which headless CMS you’re using, but here are some common steps you could take.\n\nThese steps assume that the headless CMS you’re using supports setting **custom draft URLs**. If it doesn’t, you can still use this method to secure your draft URLs, but you’ll need to construct and access the draft URL manually.\n\n**First**, you should create a **secret token string** using a token generator of your choice. This secret will only be known by your Next.js app and your headless CMS. This secret prevents people who don’t have access to your CMS from accessing draft URLs.\n\n**Second**, if your headless CMS supports setting custom draft URLs, specify the following as the draft URL. This assumes that your draft API route is located at `pages/api/draft.ts`.\n\n```bash filename=\"Terminal\"\nhttps://<your-site>/api/draft?secret=<token>&slug=<path>"
  },
  {
    "id": "draft-mode.mdx#3",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with Pages Router."
    },
    "content": "```\n\n- `<your-site>` should be your deployment domain.\n- `<token>` should be replaced with the secret token you generated.\n- `<path>` should be the path for the page that you want to view. If you want to view `/posts/foo`, then you should use `&slug=/posts/foo`.\n\nYour headless CMS might allow you to include a variable in the draft URL so that `<path>` can be set dynamically based on the CMS’s data like so: `&slug=/posts/{entry.fields.slug}`\n\n**Finally**, in the draft API route:\n\n- Check that the secret matches and that the `slug` parameter exists (if not, the request should fail).\n-\n- Call `res.setDraftMode`.\n- Then redirect the browser to the path specified by `slug`. (The following example uses a [307 redirect](https://developer.mozilla.org/docs/Web/HTTP/Status/307)).\n\n```js\nexport default async (req, res) => {\n  // Check the secret and next parameters\n  // This secret should only be known to this API route and the CMS\n  if (req.query.secret !== 'MY_SECRET_TOKEN' || !req.query.slug) {\n    return res.status(401).json({ message: 'Invalid token' })\n  }"
  },
  {
    "id": "draft-mode.mdx#4",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with Pages Router."
    },
    "content": "// Fetch the headless CMS to check if the provided `slug` exists\n  // getPostBySlug would implement the required fetching logic to the headless CMS\n  const post = await getPostBySlug(req.query.slug)\n\n  // If the slug doesn't exist prevent draft mode from being enabled\n  if (!post) {\n    return res.status(401).json({ message: 'Invalid slug' })\n  }\n\n  // Enable Draft Mode by setting the cookie\n  res.setDraftMode({ enable: true })\n\n  // Redirect to the path from the fetched post\n  // We don't redirect to req.query.slug as that might lead to open redirect vulnerabilities\n  res.redirect(post.slug)\n}"
  },
  {
    "id": "draft-mode.mdx#5",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with Pages Router."
    },
    "content": "```\n\nIf it succeeds, then the browser will be redirected to the path you want to view with the draft mode cookie."
  },
  {
    "id": "draft-mode.mdx#6",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with Pages Router."
    },
    "content": "## Step 2: Update `getStaticProps`\n\nThe next step is to update `getStaticProps` to support draft mode.\n\nIf you request a page which has `getStaticProps` with the cookie set (via `res.setDraftMode`), then `getStaticProps` will be called at **request time** (instead of at build time).\n\nFurthermore, it will be called with a `context` object where `context.draftMode` will be `true`.\n\n```js\nexport async function getStaticProps(context) {\n  if (context.draftMode) {\n    // dynamic data\n  }\n}\n```\n\nWe used `res.setDraftMode` in the draft API route, so `context.draftMode` will be `true`.\n\nIf you’re also using `getStaticPaths`, then `context.params` will also be available."
  },
  {
    "id": "draft-mode.mdx#7",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with Pages Router."
    },
    "content": "### Fetch draft data\n\nYou can update `getStaticProps` to fetch different data based on `context.draftMode`.\n\nFor example, your headless CMS might have a different API endpoint for draft posts. If so, you can modify the API endpoint URL like below:\n\n```js\nexport async function getStaticProps(context) {\n  const url = context.draftMode\n    ? 'https://draft.example.com'\n    : 'https://production.example.com'\n  const res = await fetch(url)\n  // ...\n}\n```\n\nThat’s it! If you access the draft API route (with `secret` and `slug`) from your headless CMS or manually, you should now be able to see the draft content. And if you update your draft without publishing, you should be able to view the draft.\n\nSet this as the draft URL on your headless CMS or access manually, and you should be able to see the draft.\n\n```bash filename=\"Terminal\"\nhttps://<your-site>/api/draft?secret=<token>&slug=<path>\n```"
  },
  {
    "id": "draft-mode.mdx#8",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with Pages Router."
    },
    "content": "## More Details\n\n### Clear the Draft Mode cookie\n\nBy default, the Draft Mode session ends when the browser is closed.\n\nTo clear the Draft Mode cookie manually, create an API route that calls `setDraftMode({ enable: false })`:\n\n```ts filename=\"pages/api/disable-draft.ts\"\nexport default function handler(req, res) {\n  res.setDraftMode({ enable: false })\n}\n```\n\nThen, send a request to `/api/disable-draft` to invoke the API Route. If calling this route using [`next/link`](/docs/pages/api-reference/components/link), you must pass `prefetch={false}` to prevent accidentally deleting the cookie on prefetch.\n\n### Works with `getServerSideProps`\n\nDraft Mode works with `getServerSideProps`, and is available as a `draftMode` key in the [`context`](/docs/pages/api-reference/functions/get-server-side-props#context-parameter) object.\n\n> **Good to know**: You shouldn't set the `Cache-Control` header when using Draft Mode because it cannot be bypassed. Instead, we recommend using [ISR](/docs/pages/guides/incremental-static-regeneration)."
  },
  {
    "id": "draft-mode.mdx#9",
    "metadata": {
      "title": "How to preview content with Draft Mode in Next.js",
      "description": "Next.js has draft mode to toggle between static and dynamic pages. You can learn how it works with Pages Router."
    },
    "content": "### Works with API Routes\n\nAPI Routes will have access to `draftMode` on the request object. For example:\n\n```js\nexport default function myApiRoute(req, res) {\n  if (req.draftMode) {\n    // get draft data\n  }\n}\n```\n\n### Unique per `next build`\n\nA new bypass cookie value will be generated each time you run `next build`.\n\nThis ensures that the bypass cookie can’t be guessed.\n\n> **Good to know**: To test Draft Mode locally over HTTP, your browser will need to allow third-party cookies and local storage access."
  },
  {
    "id": "environment-variables.mdx#0",
    "metadata": {
      "title": "How to use environment variables in Next.js",
      "description": "Learn to add and access environment variables in your Next.js application."
    },
    "content": "---\ntitle: How to use environment variables in Next.js\nnav_title: Environment Variables\ndescription: Learn to add and access environment variables in your Next.js application.\nsource: app/guides/environment-variables\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "forms.mdx#0",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "---\ntitle: How to create forms with API Routes\nnav_title: Forms\ndescription: Learn how to handle form submissions and data mutations with Next.js.\n---\n\nForms enable you to create and update data in web applications. Next.js provides a powerful way to handle data mutations using **API Routes**. This guide will walk you through how to handle form submission on the server."
  },
  {
    "id": "forms.mdx#1",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "## Server Forms\n\nTo handle form submissions on the server, create an API endpoint that securely mutates data.\n\n```ts filename=\"pages/api/submit.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const data = req.body\n  const id = await createItem(data)\n  res.status(200).json({ id })\n}\n```\n\n```js filename=\"pages/api/submit.js\" switcher\nexport default function handler(req, res) {\n  const data = req.body\n  // call your database, etc.\n  // const id = await createItem(data)\n  // ...\n  res.status(200).json({ data })\n}"
  },
  {
    "id": "forms.mdx#2",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "```\n\nThen, call the API Route from the client with an event handler:\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport { FormEvent } from 'react'\n\nexport default function Page() {\n  async function onSubmit(event: FormEvent<HTMLFormElement>) {\n    event.preventDefault()\n\n    const formData = new FormData(event.currentTarget)\n    const response = await fetch('/api/submit', {\n      method: 'POST',\n      body: formData,\n    })\n\n    // Handle response if necessary\n    const data = await response.json()\n    // ...\n  }\n\n  return (\n    <form onSubmit={onSubmit}>\n      <input type=\"text\" name=\"name\" />\n      <button type=\"submit\">Submit</button>\n    </form>\n  )\n}\n```\n\n```jsx filename=\"pages/index.jsx\" switcher\nexport default function Page() {\n  async function onSubmit(event) {\n    event.preventDefault()\n\n    const formData = new FormData(event.target)\n    const response = await fetch('/api/submit', {\n      method: 'POST',\n      body: formData,\n    })\n\n    // Handle response if necessary\n    const data = await response.json()\n    // ...\n  }\n\n  return (\n    <form onSubmit={onSubmit}>\n      <input type=\"text\" name=\"name\" />\n      <button type=\"submit\">Submit</button>\n    </form>\n  )\n}"
  },
  {
    "id": "forms.mdx#3",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "```\n\n> **Good to know:**\n>\n> - API Routes [do not specify CORS headers](https://developer.mozilla.org/docs/Web/HTTP/CORS), meaning they are same-origin only by default.\n> - Since API Routes run on the server, we're able to use sensitive values (like API keys) through [Environment Variables](/docs/pages/guides/environment-variables) without exposing them to the client. This is critical for the security of your application."
  },
  {
    "id": "forms.mdx#4",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "## Form validation\n\nWe recommend using HTML validation like `required` and `type=\"email\"` for basic client-side form validation.\n\nFor more advanced server-side validation, you can use a schema validation library like [zod](https://zod.dev/) to validate the form fields before mutating the data:\n\n```ts filename=\"pages/api/submit.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\nimport { z } from 'zod'\n\nconst schema = z.object({\n  // ...\n})\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const parsed = schema.parse(req.body)\n  // ...\n}\n```\n\n```js filename=\"pages/api/submit.js\" switcher\nimport { z } from 'zod'\n\nconst schema = z.object({\n  // ...\n})\n\nexport default async function handler(req, res) {\n  const parsed = schema.parse(req.body)\n  // ...\n}\n```"
  },
  {
    "id": "forms.mdx#5",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "### Error handling\n\nYou can use React state to show an error message when a form submission fails:\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport React, { useState, FormEvent } from 'react'\n\nexport default function Page() {\n  const [isLoading, setIsLoading] = useState<boolean>(false)\n  const [error, setError] = useState<string | null>(null)\n\n  async function onSubmit(event: FormEvent<HTMLFormElement>) {\n    event.preventDefault()\n    setIsLoading(true)\n    setError(null) // Clear previous errors when a new request starts\n\n    try {\n      const formData = new FormData(event.currentTarget)\n      const response = await fetch('/api/submit', {\n        method: 'POST',\n        body: formData,\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to submit the data. Please try again.')\n      }\n\n      // Handle response if necessary\n      const data = await response.json()\n      // ...\n    } catch (error) {\n      // Capture the error message to display to the user\n      setError(error.message)\n      console.error(error)\n    } finally {\n      setIsLoading(false)\n    }\n  }"
  },
  {
    "id": "forms.mdx#6",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "return (\n    <div>\n      {error && <div style={{ color: 'red' }}>{error}</div>}\n      <form onSubmit={onSubmit}>\n        <input type=\"text\" name=\"name\" />\n        <button type=\"submit\" disabled={isLoading}>\n          {isLoading ? 'Loading...' : 'Submit'}\n        </button>\n      </form>\n    </div>\n  )\n}"
  },
  {
    "id": "forms.mdx#7",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "```\n\n```jsx filename=\"pages/index.jsx\" switcher\nimport React, { useState } from 'react'\n\nexport default function Page() {\n  const [isLoading, setIsLoading] = useState(false)\n  const [error, setError] = useState(null)\n\n  async function onSubmit(event) {\n    event.preventDefault()\n    setIsLoading(true)\n    setError(null) // Clear previous errors when a new request starts\n\n    try {\n      const formData = new FormData(event.currentTarget)\n      const response = await fetch('/api/submit', {\n        method: 'POST',\n        body: formData,\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to submit the data. Please try again.')\n      }\n\n      // Handle response if necessary\n      const data = await response.json()\n      // ...\n    } catch (error) {\n      // Capture the error message to display to the user\n      setError(error.message)\n      console.error(error)\n    } finally {\n      setIsLoading(false)\n    }\n  }"
  },
  {
    "id": "forms.mdx#8",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "return (\n    <div>\n      {error && <div style={{ color: 'red' }}>{error}</div>}\n      <form onSubmit={onSubmit}>\n        <input type=\"text\" name=\"name\" />\n        <button type=\"submit\" disabled={isLoading}>\n          {isLoading ? 'Loading...' : 'Submit'}\n        </button>\n      </form>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "forms.mdx#9",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "## Displaying loading state\n\nYou can use React state to show a loading state when a form is submitting on the server:\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport React, { useState, FormEvent } from 'react'\n\nexport default function Page() {\n  const [isLoading, setIsLoading] = useState<boolean>(false)\n\n  async function onSubmit(event: FormEvent<HTMLFormElement>) {\n    event.preventDefault()\n    setIsLoading(true) // Set loading to true when the request starts\n\n    try {\n      const formData = new FormData(event.currentTarget)\n      const response = await fetch('/api/submit', {\n        method: 'POST',\n        body: formData,\n      })\n\n      // Handle response if necessary\n      const data = await response.json()\n      // ...\n    } catch (error) {\n      // Handle error if necessary\n      console.error(error)\n    } finally {\n      setIsLoading(false) // Set loading to false when the request completes\n    }\n  }\n\n  return (\n    <form onSubmit={onSubmit}>\n      <input type=\"text\" name=\"name\" />\n      <button type=\"submit\" disabled={isLoading}>\n        {isLoading ? 'Loading...' : 'Submit'}\n      </button>\n    </form>\n  )\n}"
  },
  {
    "id": "forms.mdx#10",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "```\n\n```jsx filename=\"pages/index.jsx\" switcher\nimport React, { useState } from 'react'\n\nexport default function Page() {\n  const [isLoading, setIsLoading] = useState(false)\n\n  async function onSubmit(event) {\n    event.preventDefault()\n    setIsLoading(true) // Set loading to true when the request starts\n\n    try {\n      const formData = new FormData(event.currentTarget)\n      const response = await fetch('/api/submit', {\n        method: 'POST',\n        body: formData,\n      })\n\n      // Handle response if necessary\n      const data = await response.json()\n      // ...\n    } catch (error) {\n      // Handle error if necessary\n      console.error(error)\n    } finally {\n      setIsLoading(false) // Set loading to false when the request completes\n    }\n  }\n\n  return (\n    <form onSubmit={onSubmit}>\n      <input type=\"text\" name=\"name\" />\n      <button type=\"submit\" disabled={isLoading}>\n        {isLoading ? 'Loading...' : 'Submit'}\n      </button>\n    </form>\n  )\n}\n```"
  },
  {
    "id": "forms.mdx#11",
    "metadata": {
      "title": "How to create forms with API Routes",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "### Redirecting\n\nIf you would like to redirect the user to a different route after a mutation, you can [`redirect`](/docs/pages/building-your-application/routing/api-routes#response-helpers) to any absolute or relative URL:\n\n```ts filename=\"pages/api/submit.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const id = await addPost()\n  res.redirect(307, `/post/${id}`)\n}\n```\n\n```js filename=\"pages/api/submit.js\" switcher\nexport default async function handler(req, res) {\n  const id = await addPost()\n  res.redirect(307, `/post/${id}`)\n}\n```"
  },
  {
    "id": "incremental-static-regeneration.mdx#0",
    "metadata": {
      "title": "How to implement Incremental Static Regeneration (ISR)",
      "description": "Learn how to create or update static pages at runtime with Incremental Static Regeneration."
    },
    "content": "---\ntitle: How to implement Incremental Static Regeneration (ISR)\nnav_title: ISR\ndescription: Learn how to create or update static pages at runtime with Incremental Static Regeneration.\nsource: app/guides/incremental-static-regeneration\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Guides",
      "description": "Learn how to implement common UI patterns and use cases using Next.js"
    },
    "content": "---\ntitle: Guides\ndescription: Learn how to implement common UI patterns and use cases using Next.js\n---"
  },
  {
    "id": "instrumentation.mdx#0",
    "metadata": {
      "title": "How to set up instrumentation",
      "description": "Learn how to use instrumentation to run code at server startup in your Next.js app"
    },
    "content": "---\ntitle: How to set up instrumentation\nnav_title: Instrumentation\ndescription: Learn how to use instrumentation to run code at server startup in your Next.js app\nsource: app/guides/instrumentation\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "internationalization.mdx#0",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "---\ntitle: How to implement internationalization in Next.js\nnav_title: Internationalization\ndescription: Next.js has built-in support for internationalized routing and language detection. Learn more here.\n---\n\n<details>\n  <summary>Examples</summary>\n\n- [i18n routing](https://github.com/vercel/next.js/tree/canary/examples/i18n-routing-pages)\n\n</details>\n\nNext.js has built-in support for internationalized ([i18n](https://en.wikipedia.org/wiki/Internationalization_and_localization#Naming)) routing since `v10.0.0`. You can provide a list of locales, the default locale, and domain-specific locales and Next.js will automatically handle the routing."
  },
  {
    "id": "internationalization.mdx#1",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "The i18n routing support is currently meant to complement existing i18n library solutions like [`react-intl`](https://formatjs.io/docs/getting-started/installation), [`react-i18next`](https://react.i18next.com/), [`lingui`](https://lingui.dev/), [`rosetta`](https://github.com/lukeed/rosetta), [`next-intl`](https://github.com/amannn/next-intl), [`next-translate`](https://github.com/aralroca/next-translate), [`next-multilingual`](https://github.com/Avansai/next-multilingual), [`tolgee`](https://tolgee.io/integrations/next), [`paraglide-next`](https://inlang.com/m/osslbuzt/paraglide-next-i18n), [`next-intlayer`](https://intlayer.org/doc/environment/nextjs/next-with-page-router), [`gt-react`](https://generaltranslation.com/en/docs/react) and others by streamlining the routes and locale parsing."
  },
  {
    "id": "internationalization.mdx#2",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "## Getting started\n\nTo get started, add the `i18n` config to your `next.config.js` file.\n\nLocales are [UTS Locale Identifiers](https://www.unicode.org/reports/tr35/tr35-59/tr35.html#Identifiers), a standardized format for defining locales.\n\nGenerally a Locale Identifier is made up of a language, region, and script separated by a dash: `language-region-script`. The region and script are optional. An example:\n\n- `en-US` - English as spoken in the United States\n- `nl-NL` - Dutch as spoken in the Netherlands\n- `nl` - Dutch, no specific region\n\nIf user locale is `nl-BE` and it is not listed in your configuration, they will be redirected to `nl` if available, or to the default locale otherwise.\nIf you don't plan to support all regions of a country, it is therefore a good practice to include country locales that will act as fallbacks."
  },
  {
    "id": "internationalization.mdx#3",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "```js filename=\"next.config.js\"\nmodule.exports = {\n  i18n: {\n    // These are all the locales you want to support in\n    // your application\n    locales: ['en-US', 'fr', 'nl-NL'],\n    // This is the default locale you want to be used when visiting\n    // a non-locale prefixed path e.g. `/hello`\n    defaultLocale: 'en-US',\n    // This is a list of locale domains and the default locale they\n    // should handle (these are only required when setting up domain routing)\n    // Note: subdomains must be included in the domain value to be matched e.g. \"fr.example.com\".\n    domains: [\n      {\n        domain: 'example.com',\n        defaultLocale: 'en-US',\n      },\n      {\n        domain: 'example.nl',\n        defaultLocale: 'nl-NL',\n      },\n      {\n        domain: 'example.fr',\n        defaultLocale: 'fr',\n        // an optional http field can also be used to test\n        // locale domains locally with http instead of https\n        http: true,\n      },\n    ],\n  },\n}\n```"
  },
  {
    "id": "internationalization.mdx#4",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "## Locale Strategies\n\nThere are two locale handling strategies: Sub-path Routing and Domain Routing.\n\n### Sub-path Routing\n\nSub-path Routing puts the locale in the url path.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  i18n: {\n    locales: ['en-US', 'fr', 'nl-NL'],\n    defaultLocale: 'en-US',\n  },\n}\n```\n\nWith the above configuration `en-US`, `fr`, and `nl-NL` will be available to be routed to, and `en-US` is the default locale. If you have a `pages/blog.js` the following urls would be available:\n\n- `/blog`\n- `/fr/blog`\n- `/nl-nl/blog`\n\nThe default locale does not have a prefix."
  },
  {
    "id": "internationalization.mdx#5",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "### Domain Routing\n\nBy using domain routing you can configure locales to be served from different domains:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  i18n: {\n    locales: ['en-US', 'fr', 'nl-NL', 'nl-BE'],\n    defaultLocale: 'en-US',\n\n    domains: [\n      {\n        // Note: subdomains must be included in the domain value to be matched\n        // e.g. www.example.com should be used if that is the expected hostname\n        domain: 'example.com',\n        defaultLocale: 'en-US',\n      },\n      {\n        domain: 'example.fr',\n        defaultLocale: 'fr',\n      },\n      {\n        domain: 'example.nl',\n        defaultLocale: 'nl-NL',\n        // specify other locales that should be redirected\n        // to this domain\n        locales: ['nl-BE'],\n      },\n    ],\n  },\n}\n```\n\nFor example if you have `pages/blog.js` the following urls will be available:\n\n- `example.com/blog`\n- `www.example.com/blog`\n- `example.fr/blog`\n- `example.nl/blog`\n- `example.nl/nl-BE/blog`"
  },
  {
    "id": "internationalization.mdx#6",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "## Automatic Locale Detection\n\nWhen a user visits the application root (generally `/`), Next.js will try to automatically detect which locale the user prefers based on the [`Accept-Language`](https://developer.mozilla.org/docs/Web/HTTP/Headers/Accept-Language) header and the current domain.\n\nIf a locale other than the default locale is detected, the user will be redirected to either:\n\n- **When using Sub-path Routing:** The locale prefixed path\n- **When using Domain Routing:** The domain with that locale specified as the default\n\nWhen using Domain Routing, if a user with the `Accept-Language` header `fr;q=0.9` visits `example.com`, they will be redirected to `example.fr` since that domain handles the `fr` locale by default.\n\nWhen using Sub-path Routing, the user would be redirected to `/fr`."
  },
  {
    "id": "internationalization.mdx#7",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "### Prefixing the Default Locale\n\nWith Next.js 12 and [Proxy](/docs/pages/api-reference/file-conventions/proxy), we can add a prefix to the default locale with a [workaround](https://github.com/vercel/next.js/discussions/18419).\n\nFor example, here's a `next.config.js` file with support for a few languages. Note the `\"default\"` locale has been added intentionally.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  i18n: {\n    locales: ['default', 'en', 'de', 'fr'],\n    defaultLocale: 'default',\n    localeDetection: false,\n  },\n  trailingSlash: true,\n}"
  },
  {
    "id": "internationalization.mdx#8",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "```\n\nNext, we can use [Proxy](/docs/pages/api-reference/file-conventions/proxy) to add custom routing rules:\n\n```ts filename=\"proxy.ts\"\nimport { NextRequest, NextResponse } from 'next/server'\n\nconst PUBLIC_FILE = /\\.(.*)$/\n\nexport async function proxy(req: NextRequest) {\n  if (\n    req.nextUrl.pathname.startsWith('/_next') ||\n    req.nextUrl.pathname.includes('/api/') ||\n    PUBLIC_FILE.test(req.nextUrl.pathname)\n  ) {\n    return\n  }\n\n  if (req.nextUrl.locale === 'default') {\n    const locale = req.cookies.get('NEXT_LOCALE')?.value || 'en'\n\n    return NextResponse.redirect(\n      new URL(`/${locale}${req.nextUrl.pathname}${req.nextUrl.search}`, req.url)\n    )\n  }\n}\n```\n\nThis [Proxy](/docs/pages/api-reference/file-conventions/proxy) skips adding the default prefix to [API Routes](/docs/pages/building-your-application/routing/api-routes) and [public](/docs/pages/api-reference/file-conventions/public-folder) files like fonts or images. If a request is made to the default locale, we redirect to our prefix `/en`."
  },
  {
    "id": "internationalization.mdx#9",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "### Disabling Automatic Locale Detection\n\nThe automatic locale detection can be disabled with:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  i18n: {\n    localeDetection: false,\n  },\n}\n```\n\nWhen `localeDetection` is set to `false` Next.js will no longer automatically redirect based on the user's preferred locale and will only provide locale information detected from either the locale based domain or locale path as described above."
  },
  {
    "id": "internationalization.mdx#10",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "## Accessing the locale information\n\nYou can access the locale information via the Next.js router. For example, using the [`useRouter()`](/docs/pages/api-reference/functions/use-router) hook the following properties are available:\n\n- `locale` contains the currently active locale.\n- `locales` contains all configured locales.\n- `defaultLocale` contains the configured default locale.\n\nWhen [pre-rendering](/docs/pages/building-your-application/rendering/static-site-generation) pages with `getStaticProps` or `getServerSideProps`, the locale information is provided in [the context](/docs/pages/building-your-application/data-fetching/get-static-props) provided to the function.\n\nWhen leveraging `getStaticPaths`, the configured locales are provided in the context parameter of the function under `locales` and the configured defaultLocale under `defaultLocale`."
  },
  {
    "id": "internationalization.mdx#11",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "## Transition between locales\n\nYou can use `next/link` or `next/router` to transition between locales.\n\nFor `next/link`, a `locale` prop can be provided to transition to a different locale from the currently active one. If no `locale` prop is provided, the currently active `locale` is used during client-transitions. For example:\n\n```jsx\nimport Link from 'next/link'\n\nexport default function IndexPage(props) {\n  return (\n    <Link href=\"/another\" locale=\"fr\">\n      To /fr/another\n    </Link>\n  )\n}\n```\n\nWhen using the `next/router` methods directly, you can specify the `locale` that should be used via the transition options. For example:\n\n```jsx\nimport { useRouter } from 'next/router'\n\nexport default function IndexPage(props) {\n  const router = useRouter()\n\n  return (\n    <div\n      onClick={() => {\n        router.push('/another', '/another', { locale: 'fr' })\n      }}\n    >\n      to /fr/another\n    </div>\n  )\n}"
  },
  {
    "id": "internationalization.mdx#12",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "```\n\nNote that to handle switching only the `locale` while preserving all routing information such as [dynamic route](/docs/pages/building-your-application/routing/dynamic-routes) query values or hidden href query values, you can provide the `href` parameter as an object:\n\n```jsx\nimport { useRouter } from 'next/router'\nconst router = useRouter()\nconst { pathname, asPath, query } = router\n// change just the locale and maintain all other route information including href's query\nrouter.push({ pathname, query }, asPath, { locale: nextLocale })\n```\n\nSee [here](/docs/pages/api-reference/functions/use-router#with-url-object) for more information on the object structure for `router.push`.\n\nIf you have a `href` that already includes the locale you can opt-out of automatically handling the locale prefixing:\n\n```jsx\nimport Link from 'next/link'\n\nexport default function IndexPage(props) {\n  return (\n    <Link href=\"/fr/another\" locale={false}>\n      To /fr/another\n    </Link>\n  )\n}\n```"
  },
  {
    "id": "internationalization.mdx#13",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "## Leveraging the `NEXT_LOCALE` cookie\n\nNext.js allows setting a `NEXT_LOCALE=the-locale` cookie, which takes priority over the accept-language header. This cookie can be set using a language switcher and then when a user comes back to the site it will leverage the locale specified in the cookie when redirecting from `/` to the correct locale location.\n\nFor example, if a user prefers the locale `fr` in their accept-language header but a `NEXT_LOCALE=en` cookie is set the `en` locale when visiting `/` the user will be redirected to the `en` locale location until the cookie is removed or expired.\n\n## Search Engine Optimization\n\nSince Next.js knows what language the user is visiting it will automatically add the `lang` attribute to the `<html>` tag.\n\nNext.js doesn't know about variants of a page so it's up to you to add the `hreflang` meta tags using [`next/head`](/docs/pages/api-reference/components/head). You can learn more about `hreflang` in the [Google Webmasters documentation](https://support.google.com/webmasters/answer/189077)."
  },
  {
    "id": "internationalization.mdx#14",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "## How does this work with Static Generation?\n\n> Note that Internationalized Routing does not integrate with [`output: 'export'`](/docs/pages/guides/static-exports) as it does not leverage the Next.js routing layer. Hybrid Next.js applications that do not use `output: 'export'` are fully supported."
  },
  {
    "id": "internationalization.mdx#15",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "### Dynamic Routes and `getStaticProps` Pages\n\nFor pages using `getStaticProps` with [Dynamic Routes](/docs/pages/building-your-application/routing/dynamic-routes), all locale variants of the page desired to be prerendered need to be returned from [`getStaticPaths`](/docs/pages/building-your-application/data-fetching/get-static-paths). Along with the `params` object returned for `paths`, you can also return a `locale` field specifying which locale you want to render. For example:\n\n```jsx filename=\"pages/blog/[slug].js\"\nexport const getStaticPaths = ({ locales }) => {\n  return {\n    paths: [\n      // if no `locale` is provided only the defaultLocale will be generated\n      { params: { slug: 'post-1' }, locale: 'en-US' },\n      { params: { slug: 'post-1' }, locale: 'fr' },\n    ],\n    fallback: true,\n  }\n}"
  },
  {
    "id": "internationalization.mdx#16",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "```\n\nFor [Automatically Statically Optimized](/docs/pages/building-your-application/rendering/automatic-static-optimization) and non-dynamic `getStaticProps` pages, **a version of the page will be generated for each locale**. This is important to consider because it can increase build times depending on how many locales are configured inside `getStaticProps`.\n\nFor example, if you have 50 locales configured with 10 non-dynamic pages using `getStaticProps`, this means `getStaticProps` will be called 500 times. 50 versions of the 10 pages will be generated during each build.\n\nTo decrease the build time of dynamic pages with `getStaticProps`, use a [`fallback` mode](/docs/pages/api-reference/functions/get-static-paths#fallback-true). This allows you to return only the most popular paths and locales from `getStaticPaths` for prerendering during the build. Then, Next.js will build the remaining pages at runtime as they are requested."
  },
  {
    "id": "internationalization.mdx#17",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "### Automatically Statically Optimized Pages\n\nFor pages that are [automatically statically optimized](/docs/pages/building-your-application/rendering/automatic-static-optimization), a version of the page will be generated for each locale.\n\n### Non-dynamic getStaticProps Pages\n\nFor non-dynamic `getStaticProps` pages, a version is generated for each locale like above. `getStaticProps` is called with each `locale` that is being rendered. If you would like to opt-out of a certain locale from being pre-rendered, you can return `notFound: true` from `getStaticProps` and this variant of the page will not be generated.\n\n```js\nexport async function getStaticProps({ locale }) {\n  // Call an external API endpoint to get posts.\n  // You can use any data fetching library\n  const res = await fetch(`https://.../posts?locale=${locale}`)\n  const posts = await res.json()\n\n  if (posts.length === 0) {\n    return {\n      notFound: true,\n    }\n  }\n\n  // By returning { props: posts }, the Blog component\n  // will receive `posts` as a prop at build time\n  return {\n    props: {\n      posts,\n    },\n  }\n}\n```"
  },
  {
    "id": "internationalization.mdx#18",
    "metadata": {
      "title": "How to implement internationalization in Next.js",
      "description": "Next.js has built-in support for internationalized routing and language detection. Learn more here."
    },
    "content": "## Limits for the i18n config\n\n- `locales`: 100 total locales\n- `domains`: 100 total locale domain items\n\n> **Good to know**: These limits have been added initially to prevent potential [performance issues at build time](#dynamic-routes-and-getstaticprops-pages). You can workaround these limits with custom routing using [Proxy](/docs/pages/api-reference/file-conventions/proxy) in Next.js 12."
  },
  {
    "id": "lazy-loading.mdx#0",
    "metadata": {
      "title": "How to lazy load Client Components and libraries",
      "description": "Lazy load imported libraries and React Components to improve your application's overall loading performance."
    },
    "content": "---\ntitle: How to lazy load Client Components and libraries\nnav_title: Lazy Loading\ndescription: Lazy load imported libraries and React Components to improve your application's overall loading performance.\nsource: app/guides/lazy-loading\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "mdx.mdx#0",
    "metadata": {
      "title": "How to use markdown and MDX in Next.js",
      "description": "Learn how to configure MDX to write JSX in your markdown files."
    },
    "content": "---\ntitle: How to use markdown and MDX in Next.js\nnav_title: MDX\ndescription: Learn how to configure MDX to write JSX in your markdown files.\nsource: app/guides/mdx\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "app-router-migration.mdx#0",
    "metadata": {
      "title": "How to migrate from Pages to the App Router",
      "description": "Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."
    },
    "content": "---\ntitle: How to migrate from Pages to the App Router\nnav_title: App Router\ndescription: Learn how to upgrade your existing Next.js application from the Pages Router to the App Router.\nsource: app/guides/migrating/app-router-migration\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "from-create-react-app.mdx#0",
    "metadata": {
      "title": "How to migrate from Create React App to Next.js",
      "description": "Learn how to migrate your existing React application from Create React App to Next.js."
    },
    "content": "---\ntitle: How to migrate from Create React App to Next.js\nnav_title: Create React App\ndescription: Learn how to migrate your existing React application from Create React App to Next.js.\nsource: app/guides/migrating/from-create-react-app\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "from-vite.mdx#0",
    "metadata": {
      "title": "How to migrate from Vite to Next.js",
      "description": "Learn how to migrate your existing React application from Vite to Next.js."
    },
    "content": "---\ntitle: How to migrate from Vite to Next.js\nnav_title: Vite\ndescription: Learn how to migrate your existing React application from Vite to Next.js.\nsource: app/guides/migrating/from-vite\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Migrating",
      "description": "Learn how to migrate from popular frameworks to Next.js"
    },
    "content": "---\ntitle: Migrating\ndescription: Learn how to migrate from popular frameworks to Next.js\n---"
  },
  {
    "id": "multi-zones.mdx#0",
    "metadata": {
      "title": "How to build micro-frontends using multi-zones and Next.js",
      "description": "Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain."
    },
    "content": "---\ntitle: How to build micro-frontends using multi-zones and Next.js\nnav_title: Multi-Zones\ndescription: Learn how to build micro-frontends using Next.js Multi-Zones to deploy multiple Next.js apps under a single domain.\nsource: app/guides/multi-zones\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "open-telemetry.mdx#0",
    "metadata": {
      "title": "How to instrument your Next.js app with OpenTelemetry",
      "description": "Learn how to instrument your Next.js app with OpenTelemetry."
    },
    "content": "---\ntitle: How to instrument your Next.js app with OpenTelemetry\nnav_title: OpenTelemetry\ndescription: Learn how to instrument your Next.js app with OpenTelemetry.\nsource: app/guides/open-telemetry\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "package-bundling.mdx#0",
    "metadata": {
      "title": "How to optimize package bundling",
      "description": "Learn how to optimize your application's server and client bundles."
    },
    "content": "---\ntitle: How to optimize package bundling\nnav_title: Package Bundling\ndescription: Learn how to optimize your application's server and client bundles.\nsource: app/guides/package-bundling\nrelated:\n  description: Learn more about optimizing your application for production.\n  links:\n    - pages/guides/production-checklist\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "post-css.mdx#0",
    "metadata": {
      "title": "How to configure PostCSS in Next.js",
      "description": "Extend the PostCSS config and plugins added by Next.js with your own."
    },
    "content": "---\ntitle: How to configure PostCSS in Next.js\nnav_title: PostCSS\ndescription: Extend the PostCSS config and plugins added by Next.js with your own.\n---"
  },
  {
    "id": "post-css.mdx#1",
    "metadata": {
      "title": "How to configure PostCSS in Next.js",
      "description": "Extend the PostCSS config and plugins added by Next.js with your own."
    },
    "content": "## Default Behavior\n\nNext.js compiles CSS for its [built-in CSS support](/docs/app/getting-started/css) using PostCSS.\n\nOut of the box, with no configuration, Next.js compiles CSS with the following transformations:\n\n- [Autoprefixer](https://github.com/postcss/autoprefixer) automatically adds vendor prefixes to CSS rules (back to IE11).\n- [Cross-browser Flexbox bugs](https://github.com/philipwalton/flexbugs) are corrected to behave like [the spec](https://www.w3.org/TR/css-flexbox-1/).\n- New CSS features are automatically compiled for Internet Explorer 11 compatibility:\n  - [`all` Property](https://developer.mozilla.org/docs/Web/CSS/all)\n  - [Break Properties](https://developer.mozilla.org/docs/Web/CSS/break-after)\n  - [`font-variant` Property](https://developer.mozilla.org/docs/Web/CSS/font-variant)\n  - [Gap Properties](https://developer.mozilla.org/docs/Web/CSS/gap)\n  - [Media Query Ranges](https://developer.mozilla.org/docs/Web/CSS/Media_Queries/Using_media_queries#Syntax_improvements_in_Level_4)"
  },
  {
    "id": "post-css.mdx#2",
    "metadata": {
      "title": "How to configure PostCSS in Next.js",
      "description": "Extend the PostCSS config and plugins added by Next.js with your own."
    },
    "content": "By default, [CSS Grid](https://www.w3.org/TR/css-grid-1/) and [Custom Properties](https://developer.mozilla.org/docs/Web/CSS/var) (CSS variables) are **not compiled** for IE11 support.\n\nTo compile [CSS Grid Layout](https://developer.mozilla.org/docs/Web/CSS/grid) for IE11, you can place the following comment at the top of your CSS file:\n\n```css\n/* autoprefixer grid: autoplace */"
  },
  {
    "id": "post-css.mdx#3",
    "metadata": {
      "title": "How to configure PostCSS in Next.js",
      "description": "Extend the PostCSS config and plugins added by Next.js with your own."
    },
    "content": "```\n\nYou can also enable IE11 support for [CSS Grid Layout](https://developer.mozilla.org/docs/Web/CSS/grid)\nin your entire project by configuring autoprefixer with the configuration shown below (collapsed).\nSee [\"Customizing Plugins\"](#customizing-plugins) below for more information.\n\n<details>\n  <summary>Click to view the configuration to enable CSS Grid Layout</summary>\n\n```json filename=\"postcss.config.json\"\n{\n  \"plugins\": [\n    \"postcss-flexbugs-fixes\",\n    [\n      \"postcss-preset-env\",\n      {\n        \"autoprefixer\": {\n          \"flexbox\": \"no-2009\",\n          \"grid\": \"autoplace\"\n        },\n        \"stage\": 3,\n        \"features\": {\n          \"custom-properties\": false\n        }\n      }\n    ]\n  ]\n}\n```\n\n</details>\n\nCSS variables are not compiled because it is [not possible to safely do so](https://github.com/MadLittleMods/postcss-css-variables#caveats).\nIf you must use variables, consider using something like [Sass variables](https://sass-lang.com/documentation/variables) which are compiled away by [Sass](https://sass-lang.com/)."
  },
  {
    "id": "post-css.mdx#4",
    "metadata": {
      "title": "How to configure PostCSS in Next.js",
      "description": "Extend the PostCSS config and plugins added by Next.js with your own."
    },
    "content": "## Customizing Target Browsers\n\nNext.js allows you to configure the target browsers (for [Autoprefixer](https://github.com/postcss/autoprefixer) and compiled css features) through [Browserslist](https://github.com/browserslist/browserslist).\n\nTo customize browserslist, create a `browserslist` key in your `package.json` like so:\n\n```json filename=\"package.json\"\n{\n  \"browserslist\": [\">0.3%\", \"not dead\", \"not op_mini all\"]\n}\n```\n\nYou can use the [browsersl.ist](https://browsersl.ist/?q=%3E0.3%25%2C+not+ie+11%2C+not+dead%2C+not+op_mini+all) tool to visualize what browsers you are targeting.\n\n## CSS Modules\n\nNo configuration is needed to support CSS Modules. To enable CSS Modules for a file, rename the file to have the extension `.module.css`.\n\nYou can learn more about [Next.js' CSS Module support here](/docs/app/getting-started/css)."
  },
  {
    "id": "post-css.mdx#5",
    "metadata": {
      "title": "How to configure PostCSS in Next.js",
      "description": "Extend the PostCSS config and plugins added by Next.js with your own."
    },
    "content": "## Customizing Plugins\n\n> **Warning**: When you define a custom PostCSS configuration file, Next.js **completely disables** the [default behavior](#default-behavior).\n> Be sure to manually configure all the features you need compiled, including [Autoprefixer](https://github.com/postcss/autoprefixer).\n> You also need to install any plugins included in your custom configuration manually, i.e. `npm install postcss-flexbugs-fixes postcss-preset-env`.\n\nTo customize the PostCSS configuration, create a `postcss.config.json` file in the root of your project.\n\nThis is the default configuration used by Next.js:\n\n```json filename=\"postcss.config.json\"\n{\n  \"plugins\": [\n    \"postcss-flexbugs-fixes\",\n    [\n      \"postcss-preset-env\",\n      {\n        \"autoprefixer\": {\n          \"flexbox\": \"no-2009\"\n        },\n        \"stage\": 3,\n        \"features\": {\n          \"custom-properties\": false\n        }\n      }\n    ]\n  ]\n}"
  },
  {
    "id": "post-css.mdx#6",
    "metadata": {
      "title": "How to configure PostCSS in Next.js",
      "description": "Extend the PostCSS config and plugins added by Next.js with your own."
    },
    "content": "```\n\n> **Good to know**: Next.js also allows the file to be named `.postcssrc.json`, or, to be read from the `postcss` key in `package.json`.\n\nIt is also possible to configure PostCSS with a `postcss.config.js` file, which is useful when you want to conditionally include plugins based on environment:\n\n```js filename=\"postcss.config.js\"\nmodule.exports = {\n  plugins:\n    process.env.NODE_ENV === 'production'\n      ? [\n          'postcss-flexbugs-fixes',\n          [\n            'postcss-preset-env',\n            {\n              autoprefixer: {\n                flexbox: 'no-2009',\n              },\n              stage: 3,\n              features: {\n                'custom-properties': false,\n              },\n            },\n          ],\n        ]\n      : [\n          // No transformations in development\n        ],\n}"
  },
  {
    "id": "post-css.mdx#7",
    "metadata": {
      "title": "How to configure PostCSS in Next.js",
      "description": "Extend the PostCSS config and plugins added by Next.js with your own."
    },
    "content": "```\n\n> **Good to know**: Next.js also allows the file to be named `.postcssrc.js`.\n\nDo **not use `require()`** to import the PostCSS Plugins. Plugins must be provided as strings.\n\n> **Good to know**: If your `postcss.config.js` needs to support other non-Next.js tools in the same project, you must use the interoperable object-based format instead:\n>\n> ```js\n> module.exports = {\n>   plugins: {\n>     'postcss-flexbugs-fixes': {},\n>     'postcss-preset-env': {\n>       autoprefixer: {\n>         flexbox: 'no-2009',\n>       },\n>       stage: 3,\n>       features: {\n>         'custom-properties': false,\n>       },\n>     },\n>   },\n> }\n> ```"
  },
  {
    "id": "preview-mode.mdx#0",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "---\ntitle: How to preview content with Preview Mode in Next.js\nnav_title: Preview Mode\ndescription: Next.js has the preview mode for statically generated pages. You can learn how it works here.\nversion: legacy\n---\n\n> **Note**: This feature is superseded by [Draft Mode](/docs/pages/guides/draft-mode).\n\n<details>\n  <summary>Examples</summary>"
  },
  {
    "id": "preview-mode.mdx#1",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "- [Agility CMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-agilitycms) ([Demo](https://next-blog-agilitycms.vercel.app/))\n- [Builder.io Example](https://github.com/vercel/next.js/tree/canary/examples/cms-builder-io) ([Demo](https://cms-builder-io.vercel.app/))\n- [ButterCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-buttercms) ([Demo](https://next-blog-buttercms.vercel.app/))\n- [Contentful Example](https://github.com/vercel/next.js/tree/canary/examples/cms-contentful) ([Demo](https://app-router-contentful.vercel.app/))\n- [Cosmic Example](https://github.com/vercel/next.js/tree/canary/examples/cms-cosmic) ([Demo](https://next-blog-cosmic.vercel.app/))\n- [DatoCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-datocms) ([Demo](https://next-blog-datocms.vercel.app/))\n- [DotCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-dotcms) ([Demo](https://nextjs-dotcms-blog.vercel.app/))\n- [Drupal Example](https://github.com/vercel/next.js/tree/canary/examples/cms-drupal) ([Demo](https://cms-drupal.vercel.app/))"
  },
  {
    "id": "preview-mode.mdx#2",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "- [Drupal Example](https://github.com/vercel/next.js/tree/canary/examples/cms-drupal) ([Demo](https://cms-drupal.vercel.app/))\n- [Enterspeed Example](https://github.com/vercel/next.js/tree/canary/examples/cms-enterspeed) ([Demo](https://next-blog-demo.enterspeed.com/))\n- [GraphCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-graphcms) ([Demo](https://next-blog-graphcms.vercel.app/))\n- [Keystone Example](https://github.com/vercel/next.js/tree/canary/examples/cms-keystonejs-embedded) ([Demo](https://nextjs-keystone-demo.vercel.app/))\n- [Kontent.ai Example](https://github.com/vercel/next.js/tree/canary/examples/cms-kontent-ai) ([Demo](https://next-blog-kontent-ai.vercel.app/))\n- [Makeswift Example](https://github.com/vercel/next.js/tree/canary/examples/cms-makeswift) ([Demo](https://nextjs-makeswift-example.vercel.app/))\n- [Plasmic Example](https://github.com/vercel/next.js/tree/canary/examples/cms-plasmic) ([Demo](https://nextjs-plasmic-example.vercel.app/))\n- [Prepr Example](https://github.com/vercel/next.js/tree/canary/examples/cms-prepr) ([Demo](https://next-blog-prepr.vercel.app/))"
  },
  {
    "id": "preview-mode.mdx#3",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "- [Prepr Example](https://github.com/vercel/next.js/tree/canary/examples/cms-prepr) ([Demo](https://next-blog-prepr.vercel.app/))\n- [Prismic Example](https://github.com/vercel/next.js/tree/canary/examples/cms-prismic) ([Demo](https://next-blog-prismic.vercel.app/))\n- [Sanity Example](https://github.com/vercel/next.js/tree/canary/examples/cms-sanity) ([Demo](https://next-blog.sanity.build/))\n- [Sitecore XM Cloud Example](https://github.com/vercel/next.js/tree/canary/examples/cms-sitecore-xmcloud) ([Demo](https://vercel-sitecore-xmcloud-demo.vercel.app/))\n- [Storyblok Example](https://github.com/vercel/next.js/tree/canary/examples/cms-storyblok) ([Demo](https://next-blog-storyblok.vercel.app/))\n- [Strapi Example](https://github.com/vercel/next.js/tree/canary/examples/cms-strapi) ([Demo](https://next-blog-strapi.vercel.app/))\n- [TakeShape Example](https://github.com/vercel/next.js/tree/canary/examples/cms-takeshape) ([Demo](https://next-blog-takeshape.vercel.app/))\n- [Tina Example](https://github.com/vercel/next.js/tree/canary/examples/cms-tina) ([Demo](https://cms-tina-example.vercel.app/))"
  },
  {
    "id": "preview-mode.mdx#4",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "- [Tina Example](https://github.com/vercel/next.js/tree/canary/examples/cms-tina) ([Demo](https://cms-tina-example.vercel.app/))\n- [Umbraco Example](https://github.com/vercel/next.js/tree/canary/examples/cms-umbraco) ([Demo](https://nextjs-umbraco-sample-blog.vercel.app/))\n- [Umbraco Heartcore Example](https://github.com/vercel/next.js/tree/canary/examples/cms-umbraco-heartcore) ([Demo](https://next-blog-umbraco-heartcore.vercel.app/))\n- [Webiny Example](https://github.com/vercel/next.js/tree/canary/examples/cms-webiny) ([Demo](https://webiny-headlesscms-nextjs-example.vercel.app/))\n- [WordPress Example](https://github.com/vercel/next.js/tree/canary/examples/cms-wordpress) ([Demo](https://next-blog-wordpress.vercel.app/))\n- [Blog Starter Example](https://github.com/vercel/next.js/tree/canary/examples/blog-starter) ([Demo](https://next-blog-starter.vercel.app/))"
  },
  {
    "id": "preview-mode.mdx#5",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "</details>\n\nIn the [Pages documentation](/docs/pages/building-your-application/routing/pages-and-layouts) and the [Data Fetching documentation](/docs/pages/building-your-application/data-fetching), we talked about how to pre-render a page at build time (**Static Generation**) using `getStaticProps` and `getStaticPaths`.\n\nStatic Generation is useful when your pages fetch data from a headless CMS. However, it’s not ideal when you’re writing a draft on your headless CMS and want to **preview** the draft immediately on your page. You’d want Next.js to render these pages at **request time** instead of build time and fetch the draft content instead of the published content. You’d want Next.js to bypass Static Generation only for this specific case.\n\nNext.js has a feature called **Preview Mode** which solves this problem. Here are instructions on how to use it."
  },
  {
    "id": "preview-mode.mdx#6",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "## Step 1: Create and access a preview API route\n\n> Take a look at the [API Routes documentation](/docs/pages/building-your-application/routing/api-routes) first if you’re not familiar with Next.js API Routes.\n\nFirst, create a **preview API route**. It can have any name - e.g. `pages/api/preview.js` (or `.ts` if using TypeScript).\n\nIn this API route, you need to call `setPreviewData` on the response object. The argument for `setPreviewData` should be an object, and this can be used by `getStaticProps` (more on this later). For now, we’ll use `{}`.\n\n```js\nexport default function handler(req, res) {\n  // ...\n  res.setPreviewData({})\n  // ...\n}"
  },
  {
    "id": "preview-mode.mdx#7",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "```\n\n`res.setPreviewData` sets some **cookies** on the browser which turns on the preview mode. Any requests to Next.js containing these cookies will be considered as the **preview mode**, and the behavior for statically generated pages will change (more on this later).\n\nYou can test this manually by creating an API route like below and accessing it from your browser manually:\n\n```js filename=\"pages/api/preview.js\"\n// simple example for testing it manually from your browser.\nexport default function handler(req, res) {\n  res.setPreviewData({})\n  res.end('Preview mode enabled')\n}\n```\n\nIf you open your browser’s developer tools and visit `/api/preview`, you’ll notice that the `__prerender_bypass` and `__next_preview_data` cookies will be set on this request."
  },
  {
    "id": "preview-mode.mdx#8",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "### Securely accessing it from your Headless CMS\n\nIn practice, you’d want to call this API route _securely_ from your headless CMS. The specific steps will vary depending on which headless CMS you’re using, but here are some common steps you could take.\n\nThese steps assume that the headless CMS you’re using supports setting **custom preview URLs**. If it doesn’t, you can still use this method to secure your preview URLs, but you’ll need to construct and access the preview URL manually.\n\n**First**, you should create a **secret token string** using a token generator of your choice. This secret will only be known by your Next.js app and your headless CMS. This secret prevents people who don’t have access to your CMS from accessing preview URLs.\n\n**Second**, if your headless CMS supports setting custom preview URLs, specify the following as the preview URL. This assumes that your preview API route is located at `pages/api/preview.js`.\n\n```bash filename=\"Terminal\"\nhttps://<your-site>/api/preview?secret=<token>&slug=<path>"
  },
  {
    "id": "preview-mode.mdx#9",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "```\n\n- `<your-site>` should be your deployment domain.\n- `<token>` should be replaced with the secret token you generated.\n- `<path>` should be the path for the page that you want to preview. If you want to preview `/posts/foo`, then you should use `&slug=/posts/foo`.\n\nYour headless CMS might allow you to include a variable in the preview URL so that `<path>` can be set dynamically based on the CMS’s data like so: `&slug=/posts/{entry.fields.slug}`\n\n**Finally**, in the preview API route:\n\n- Check that the secret matches and that the `slug` parameter exists (if not, the request should fail).\n-\n- Call `res.setPreviewData`.\n- Then redirect the browser to the path specified by `slug`. (The following example uses a [307 redirect](https://developer.mozilla.org/docs/Web/HTTP/Status/307)).\n\n```js\nexport default async (req, res) => {\n  // Check the secret and next parameters\n  // This secret should only be known to this API route and the CMS\n  if (req.query.secret !== 'MY_SECRET_TOKEN' || !req.query.slug) {\n    return res.status(401).json({ message: 'Invalid token' })\n  }"
  },
  {
    "id": "preview-mode.mdx#10",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "// Fetch the headless CMS to check if the provided `slug` exists\n  // getPostBySlug would implement the required fetching logic to the headless CMS\n  const post = await getPostBySlug(req.query.slug)\n\n  // If the slug doesn't exist prevent preview mode from being enabled\n  if (!post) {\n    return res.status(401).json({ message: 'Invalid slug' })\n  }\n\n  // Enable Preview Mode by setting the cookies\n  res.setPreviewData({})\n\n  // Redirect to the path from the fetched post\n  // We don't redirect to req.query.slug as that might lead to open redirect vulnerabilities\n  res.redirect(post.slug)\n}"
  },
  {
    "id": "preview-mode.mdx#11",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "```\n\nIf it succeeds, then the browser will be redirected to the path you want to preview with the preview mode cookies being set."
  },
  {
    "id": "preview-mode.mdx#12",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "## Step 2: Update `getStaticProps`\n\nThe next step is to update `getStaticProps` to support the preview mode.\n\nIf you request a page which has `getStaticProps` with the preview mode cookies set (via `res.setPreviewData`), then `getStaticProps` will be called at **request time** (instead of at build time).\n\nFurthermore, it will be called with a `context` object where:\n\n- `context.preview` will be `true`.\n- `context.previewData` will be the same as the argument used for `setPreviewData`.\n\n```js\nexport async function getStaticProps(context) {\n  // If you request this page with the preview mode cookies set:\n  //\n  // - context.preview will be true\n  // - context.previewData will be the same as\n  //   the argument used for `setPreviewData`.\n}\n```\n\nWe used `res.setPreviewData({})` in the preview API route, so `context.previewData` will be `{}`. You can use this to pass session information from the preview API route to `getStaticProps` if necessary.\n\nIf you’re also using `getStaticPaths`, then `context.params` will also be available."
  },
  {
    "id": "preview-mode.mdx#13",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "### Fetch preview data\n\nYou can update `getStaticProps` to fetch different data based on `context.preview` and/or `context.previewData`.\n\nFor example, your headless CMS might have a different API endpoint for draft posts. If so, you can use `context.preview` to modify the API endpoint URL like below:\n\n```js\nexport async function getStaticProps(context) {\n  // If context.preview is true, append \"/preview\" to the API endpoint\n  // to request draft data instead of published data. This will vary\n  // based on which headless CMS you're using.\n  const res = await fetch(`https://.../${context.preview ? 'preview' : ''}`)\n  // ...\n}\n```\n\nThat’s it! If you access the preview API route (with `secret` and `slug`) from your headless CMS or manually, you should now be able to see the preview content. And if you update your draft without publishing, you should be able to preview the draft.\n\nSet this as the preview URL on your headless CMS or access manually, and you should be able to see the preview.\n\n```bash filename=\"Terminal\"\nhttps://<your-site>/api/preview?secret=<token>&slug=<path>\n```"
  },
  {
    "id": "preview-mode.mdx#14",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "## More Details\n\n> **Good to know**: during rendering `next/router` exposes an `isPreview` flag, see the [router object docs](/docs/pages/api-reference/functions/use-router#router-object) for more info.\n\n### Specify the Preview Mode duration\n\n`setPreviewData` takes an optional second parameter which should be an options object. It accepts the following keys:\n\n- `maxAge`: Specifies the number (in seconds) for the preview session to last for.\n- `path`: Specifies the path the cookie should be applied under. Defaults to `/` enabling preview mode for all paths.\n\n```js\nsetPreviewData(data, {\n  maxAge: 60 * 60, // The preview mode cookies expire in 1 hour\n  path: '/about', // The preview mode cookies apply to paths with /about\n})\n```"
  },
  {
    "id": "preview-mode.mdx#15",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "### Clear the Preview Mode cookies\n\nBy default, no expiration date is set for Preview Mode cookies, so the preview session ends when the browser is closed.\n\nTo clear the Preview Mode cookies manually, create an API route that calls `clearPreviewData()`:\n\n```js filename=\"pages/api/clear-preview-mode-cookies.js\"\nexport default function handler(req, res) {\n  res.clearPreviewData({})\n}\n```\n\nThen, send a request to `/api/clear-preview-mode-cookies` to invoke the API Route. If calling this route using [`next/link`](/docs/pages/api-reference/components/link), you must pass `prefetch={false}` to prevent calling `clearPreviewData` during link prefetching.\n\nIf a path was specified in the `setPreviewData` call, you must pass the same path to `clearPreviewData`:\n\n```js filename=\"pages/api/clear-preview-mode-cookies.js\"\nexport default function handler(req, res) {\n  const { path } = req.query\n\n  res.clearPreviewData({ path })\n}\n```\n\n### `previewData` size limits\n\nYou can pass an object to `setPreviewData` and have it be available in `getStaticProps`. However, because the data will be stored in a cookie, there’s a size limitation. Currently, preview data is limited to 2KB."
  },
  {
    "id": "preview-mode.mdx#16",
    "metadata": {
      "title": "How to preview content with Preview Mode in Next.js",
      "description": "Next.js has the preview mode for statically generated pages. You can learn how it works here."
    },
    "content": "### Works with `getServerSideProps`\n\nThe preview mode works on `getServerSideProps` as well. It will also be available on the `context` object containing `preview` and `previewData`.\n\n> **Good to know**: You shouldn't set the `Cache-Control` header when using Preview Mode because it cannot be bypassed. Instead, we recommend using [ISR](/docs/pages/guides/incremental-static-regeneration).\n\n### Works with API Routes\n\nAPI Routes will have access to `preview` and `previewData` under the request object. For example:\n\n```js\nexport default function myApiRoute(req, res) {\n  const isPreview = req.preview\n  const previewData = req.previewData\n  // ...\n}\n```\n\n### Unique per `next build`\n\nBoth the bypass cookie value and the private key for encrypting the `previewData` change when `next build` is completed.\nThis ensures that the bypass cookie can’t be guessed.\n\n> **Good to know**: To test Preview Mode locally over HTTP your browser will need to allow third-party cookies and local storage access."
  },
  {
    "id": "production-checklist.mdx#0",
    "metadata": {
      "title": "How to optimize your Next.js application for production",
      "description": "Recommendations to ensure the best performance and user experience before taking your Next.js application to production."
    },
    "content": "---\ntitle: How to optimize your Next.js application for production\nnav_title: Production\ndescription: Recommendations to ensure the best performance and user experience before taking your Next.js application to production.\nsource: app/guides/production-checklist\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "redirecting.mdx#0",
    "metadata": {
      "title": "How to handle redirects in Next.js",
      "description": "Learn the different ways to handle redirects in Next.js."
    },
    "content": "---\ntitle: How to handle redirects in Next.js\nnav_title: Redirecting\ndescription: Learn the different ways to handle redirects in Next.js.\nsource: app/guides/redirecting\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "sass.mdx#0",
    "metadata": {
      "title": "How to use Sass in Next.js",
      "description": "Learn how to use Sass in your Next.js application."
    },
    "content": "---\ntitle: How to use Sass in Next.js\nnav_title: Sass\ndescription: Learn how to use Sass in your Next.js application.\nsource: app/guides/sass\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "scripts.mdx#0",
    "metadata": {
      "title": "How to load and optimize scripts",
      "description": "Optimize 3rd party scripts with the built-in Script component."
    },
    "content": "---\ntitle: How to load and optimize scripts\nnav_title: Scripts\ndescription: Optimize 3rd party scripts with the built-in Script component.\nsource: app/guides/scripts\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "self-hosting.mdx#0",
    "metadata": {
      "title": "How to self-host your Next.js application",
      "description": "Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports)."
    },
    "content": "---\ntitle: How to self-host your Next.js application\nnav_title: Self-Hosting\ndescription: Learn how to self-host your Next.js application on a Node.js server, Docker image, or static HTML files (static exports).\nsource: app/guides/self-hosting\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "static-exports.mdx#0",
    "metadata": {
      "title": "How to create a static export of your Next.js application",
      "description": "Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."
    },
    "content": "---\ntitle: How to create a static export of your Next.js application\nnav_title: Static Exports\ndescription: Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server.\nsource: app/guides/static-exports\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "tailwind-v3-css.mdx#0",
    "metadata": {
      "title": "Tailwind CSS",
      "description": "Style your Next.js Application using Tailwind CSS."
    },
    "content": "---\ntitle: Tailwind CSS\ndescription: Style your Next.js Application using Tailwind CSS.\nsource: app/guides/tailwind-v3-css\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "cypress.mdx#0",
    "metadata": {
      "title": "How to set up Cypress with Next.js",
      "description": "Learn how to set up Next.js with Cypress for End-to-End (E2E) and Component Testing."
    },
    "content": "---\ntitle: How to set up Cypress with Next.js\nnav_title: Cypress\ndescription: Learn how to set up Next.js with Cypress for End-to-End (E2E) and Component Testing.\nsource: app/guides/testing/cypress\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Testing",
      "description": "Learn how to set up Next.js with three commonly used testing tools — Cypress, Playwright, Vitest, and Jest."
    },
    "content": "---\ntitle: Testing\ndescription: Learn how to set up Next.js with three commonly used testing tools — Cypress, Playwright, Vitest, and Jest.\nsource: app/guides/testing\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "jest.mdx#0",
    "metadata": {
      "title": "How to set up Jest with Next.js",
      "description": "Learn how to set up Next.js with Jest for Unit Testing."
    },
    "content": "---\ntitle: How to set up Jest with Next.js\nnav_title: Jest\ndescription: Learn how to set up Next.js with Jest for Unit Testing.\nsource: app/guides/testing/jest\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "playwright.mdx#0",
    "metadata": {
      "title": "How to set up Playwright with Next.js",
      "description": "Learn how to set up Next.js with Playwright for End-to-End (E2E) and Integration testing."
    },
    "content": "---\ntitle: How to set up Playwright with Next.js\nnav_title: Playwright\ndescription: Learn how to set up Next.js with Playwright for End-to-End (E2E) and Integration testing.\nsource: app/guides/testing/playwright\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "vitest.mdx#0",
    "metadata": {
      "title": "How to set up Vitest with Next.js",
      "description": "Learn how to set up Next.js with Vitest and React Testing Library - two popular unit testing libraries."
    },
    "content": "---\ntitle: How to set up Vitest with Next.js\nnav_title: Vitest\ndescription: Learn how to set up Next.js with Vitest and React Testing Library - two popular unit testing libraries.\nsource: app/guides/testing/vitest\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "third-party-libraries.mdx#0",
    "metadata": {
      "title": "How to optimize third-party libraries",
      "description": "Optimize the performance of third-party libraries in your application with the `@next/third-parties` package."
    },
    "content": "---\ntitle: How to optimize third-party libraries\nnav_title: Third Party Libraries\ndescription: Optimize the performance of third-party libraries in your application with the `@next/third-parties` package.\nsource: app/guides/third-party-libraries\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "codemods.mdx#0",
    "metadata": {
      "title": "Codemods",
      "description": "Use codemods to upgrade your Next.js codebase when new features are released."
    },
    "content": "---\ntitle: Codemods\ndescription: Use codemods to upgrade your Next.js codebase when new features are released.\nsource: app/guides/upgrading/codemods\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Upgrading",
      "description": "Learn how to upgrade to the latest versions of Next.js."
    },
    "content": "---\ntitle: Upgrading\ndescription: Learn how to upgrade to the latest versions of Next.js.\n---\n\nLearn how to upgrade to the latest versions of Next.js following the versions-specific guides:"
  },
  {
    "id": "version-10.mdx#0",
    "metadata": {
      "title": "How to upgrade to version 10",
      "description": "Upgrade your Next.js Application from Version 9 to Version 10."
    },
    "content": "---\ntitle: How to upgrade to version 10\nnav_title: Version 10\ndescription: Upgrade your Next.js Application from Version 9 to Version 10.\n---\n\nThere were no breaking changes between versions 9 and 10.\n\nTo upgrade to version 10, run the following command:\n\n```bash filename=\"Terminal\"\nnpm i next@10\n```\n\n```bash filename=\"Terminal\"\nyarn add next@10\n```\n\n```bash filename=\"Terminal\"\npnpm up next@10\n```\n\n```bash filename=\"Terminal\"\nbun add next@10\n```\n\n> **Good to know:** If you are using TypeScript, ensure you also upgrade `@types/react` and `@types/react-dom` to their corresponding versions."
  },
  {
    "id": "version-11.mdx#0",
    "metadata": {
      "title": "How to upgrade to version 11",
      "description": "Upgrade your Next.js Application from Version 10 to Version 11."
    },
    "content": "---\ntitle: How to upgrade to version 11\nnav_title: Version 11\ndescription: Upgrade your Next.js Application from Version 10 to Version 11.\n---\n\nTo upgrade to version 11, run the following command:\n\n```bash filename=\"Terminal\"\nnpm i next@11 react@17 react-dom@17\n```\n\n```bash filename=\"Terminal\"\nyarn add next@11 react@17 react-dom@17\n```\n\n```bash filename=\"Terminal\"\npnpm up next@11 react@17 react-dom@17\n```\n\n```bash filename=\"Terminal\"\nbun add next@11 react@17 react-dom@17\n```\n\n> **Good to know:** If you are using TypeScript, ensure you also upgrade `@types/react` and `@types/react-dom` to their corresponding versions.\n\n### Webpack 5\n\nWebpack 5 is now the default for all Next.js applications. If you did not have a custom webpack configuration, your application is already using webpack 5. If you do have a custom webpack configuration, you can refer to the [Next.js webpack 5 documentation](/docs/messages/webpack5) for upgrade guidance."
  },
  {
    "id": "version-11.mdx#1",
    "metadata": {
      "title": "How to upgrade to version 11",
      "description": "Upgrade your Next.js Application from Version 10 to Version 11."
    },
    "content": "### Cleaning the `distDir` is now a default\n\nThe build output directory (defaults to `.next`) is now cleared by default except for the Next.js caches. You can refer to [the cleaning `distDir` RFC](https://github.com/vercel/next.js/discussions/6009) for more information.\n\nIf your application was relying on this behavior previously you can disable the new default behavior by adding the `cleanDistDir: false` flag in `next.config.js`.\n\n### `PORT` is now supported for `next dev` and `next start`\n\nNext.js 11 supports the `PORT` environment variable to set the port the application runs on. Using `-p`/`--port` is still recommended but if you were prohibited from using `-p` in any way you can now use `PORT` as an alternative:\n\nExample:\n\n```\nPORT=4000 next start\n```"
  },
  {
    "id": "version-11.mdx#2",
    "metadata": {
      "title": "How to upgrade to version 11",
      "description": "Upgrade your Next.js Application from Version 10 to Version 11."
    },
    "content": "### `next.config.js` customization to import images\n\nNext.js 11 supports static image imports with `next/image`. This new feature relies on being able to process image imports. If you previously added the `next-images` or `next-optimized-images` packages you can either move to the new built-in support using `next/image` or disable the feature:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    disableStaticImages: true,\n  },\n}\n```\n\n### Remove `super.componentDidCatch()` from `pages/_app.js`\n\nThe `next/app` component's `componentDidCatch` was deprecated in Next.js 9 as it's no longer needed and has since been a no-op. In Next.js 11, it was removed.\n\nIf your `pages/_app.js` has a custom `componentDidCatch` method you can remove `super.componentDidCatch` as it is no longer needed.\n\n### Remove `Container` from `pages/_app.js`\n\nThis export was deprecated in Next.js 9 as it's no longer needed and has since been a no-op with a warning during development. In Next.js 11 it was removed.\n\nIf your `pages/_app.js` imports `Container` from `next/app` you can remove `Container` as it was removed. Learn more in [the documentation](/docs/messages/app-container-deprecated)."
  },
  {
    "id": "version-11.mdx#3",
    "metadata": {
      "title": "How to upgrade to version 11",
      "description": "Upgrade your Next.js Application from Version 10 to Version 11."
    },
    "content": "### Remove `props.url` usage from page components\n\nThis property was deprecated in Next.js 4 and has since shown a warning during development. With the introduction of `getStaticProps` / `getServerSideProps` these methods already disallowed the usage of `props.url`. In Next.js 11, it was removed completely.\n\nYou can learn more in [the documentation](/docs/messages/url-deprecated).\n\n### Remove `unsized` property on `next/image`\n\nThe `unsized` property on `next/image` was deprecated in Next.js 10.0.1. You can use `layout=\"fill\"` instead. In Next.js 11 `unsized` was removed.\n\n### Remove `modules` property on `next/dynamic`\n\nThe `modules` and `render` option for `next/dynamic` were deprecated in Next.js 9.5. This was done in order to make the `next/dynamic` API closer to `React.lazy`. In Next.js 11, the `modules` and `render` options were removed.\n\nThis option hasn't been mentioned in the documentation since Next.js 8 so it's less likely that your application is using it.\n\nIf your application does use `modules` and `render` you can refer to [the documentation](/docs/messages/next-dynamic-modules)."
  },
  {
    "id": "version-11.mdx#4",
    "metadata": {
      "title": "How to upgrade to version 11",
      "description": "Upgrade your Next.js Application from Version 10 to Version 11."
    },
    "content": "### Remove `Head.rewind`\n\n`Head.rewind` has been a no-op since Next.js 9.5, in Next.js 11 it was removed. You can safely remove your usage of `Head.rewind`.\n\n### Moment.js locales excluded by default\n\nMoment.js includes translations for a lot of locales by default. Next.js now automatically excludes these locales by default to optimize bundle size for applications using Moment.js.\n\nTo load a specific locale use this snippet:\n\n```js\nimport moment from 'moment'\nimport 'moment/locale/ja'\n\nmoment.locale('ja')\n```\n\nYou can opt-out of this new default by adding `excludeDefaultMomentLocales: false` to `next.config.js` if you do not want the new behavior, do note it's highly recommended to not disable this new optimization as it significantly reduces the size of Moment.js."
  },
  {
    "id": "version-11.mdx#5",
    "metadata": {
      "title": "How to upgrade to version 11",
      "description": "Upgrade your Next.js Application from Version 10 to Version 11."
    },
    "content": "### Update usage of `router.events`\n\nIn case you're accessing `router.events` during rendering, in Next.js 11 `router.events` is no longer provided during pre-rendering. Ensure you're accessing `router.events` in `useEffect`:\n\n```js\nuseEffect(() => {\n  const handleRouteChange = (url, { shallow }) => {\n    console.log(\n      `App is changing to ${url} ${\n        shallow ? 'with' : 'without'\n      } shallow routing`\n    )\n  }\n\n  router.events.on('routeChangeStart', handleRouteChange)\n\n  // If the component is unmounted, unsubscribe\n  // from the event with the `off` method:\n  return () => {\n    router.events.off('routeChangeStart', handleRouteChange)\n  }\n}, [router])\n```\n\nIf your application uses `router.router.events` which was an internal property that was not public please make sure to use `router.events` as well."
  },
  {
    "id": "version-11.mdx#6",
    "metadata": {
      "title": "How to upgrade to version 11",
      "description": "Upgrade your Next.js Application from Version 10 to Version 11."
    },
    "content": "## React 16 to 17\n\nReact 17 introduced a new [JSX Transform](https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html) that brings a long-time Next.js feature to the wider React ecosystem: Not having to `import React from 'react'` when using JSX. When using React 17 Next.js will automatically use the new transform. This transform does not make the `React` variable global, which was an unintended side-effect of the previous Next.js implementation. A [codemod is available](/docs/pages/guides/upgrading/codemods#add-missing-react-import) to automatically fix cases where you accidentally used `React` without importing it.\n\nMost applications already use the latest version of React, with Next.js 11 the minimum React version has been updated to 17.0.2.\n\nTo upgrade you can run the following command:\n\n```\nnpm install react@latest react-dom@latest\n```\n\nOr using `yarn`:\n\n```\nyarn add react@latest react-dom@latest\n```"
  },
  {
    "id": "version-12.mdx#0",
    "metadata": {
      "title": "How to upgrade to version 12",
      "description": "Upgrade your Next.js Application from Version 11 to Version 12."
    },
    "content": "---\ntitle: How to upgrade to version 12\nnav_title: Version 12\ndescription: Upgrade your Next.js Application from Version 11 to Version 12.\n---\n\nTo upgrade to version 12, run the following command:\n\n```bash filename=\"Terminal\"\nnpm i next@12 react@17 react-dom@17 eslint-config-next@12\n```\n\n```bash filename=\"Terminal\"\nyarn add next@12 react@17 react-dom@17 eslint-config-next@12\n```\n\n```bash filename=\"Terminal\"\npnpm up next@12 react@17 react-dom@17 eslint-config-next@12\n```\n\n```bash filename=\"Terminal\"\nbun add next@12 react@17 react-dom@17 eslint-config-next@12\n```\n\n> **Good to know:** If you are using TypeScript, ensure you also upgrade `@types/react` and `@types/react-dom` to their corresponding versions.\n\n### Upgrading to 12.2\n\n[Middleware](/docs/messages/middleware-upgrade-guide) - If you were using Middleware prior to `12.2`, please see the [upgrade guide](/docs/messages/middleware-upgrade-guide) for more information."
  },
  {
    "id": "version-12.mdx#1",
    "metadata": {
      "title": "How to upgrade to version 12",
      "description": "Upgrade your Next.js Application from Version 11 to Version 12."
    },
    "content": "### Upgrading to 12.0\n\n[Minimum Node.js Version](https://nodejs.org/en/) - The minimum Node.js version has been bumped from `12.0.0` to `12.22.0` which is the first version of Node.js with native ES Modules support.\n\n[Minimum React Version](https://react.dev/learn/add-react-to-an-existing-project) - The minimum required React version is `17.0.2`. To upgrade you can run the following command in the terminal:\n\n```bash filename=\"Terminal\"\nnpm install react@latest react-dom@latest\n\nyarn add react@latest react-dom@latest\n\npnpm update react@latest react-dom@latest\n\nbun add react@latest react-dom@latest\n```"
  },
  {
    "id": "version-12.mdx#2",
    "metadata": {
      "title": "How to upgrade to version 12",
      "description": "Upgrade your Next.js Application from Version 11 to Version 12."
    },
    "content": "#### SWC replacing Babel\n\nNext.js now uses the Rust-based compiler [SWC](https://swc.rs/) to compile JavaScript/TypeScript. This new compiler is up to 17x faster than Babel when compiling individual files and up to 5x faster Fast Refresh.\n\nNext.js provides full backward compatibility with applications that have [custom Babel configuration](/docs/pages/guides/babel). All transformations that Next.js handles by default like styled-jsx and tree-shaking of `getStaticProps` / `getStaticPaths` / `getServerSideProps` have been ported to Rust.\n\nWhen an application has a custom Babel configuration, Next.js will automatically opt-out of using SWC for compiling JavaScript/Typescript and will fall back to using Babel in the same way that it was used in Next.js 11.\n\nMany of the integrations with external libraries that currently require custom Babel transformations will be ported to Rust-based SWC transforms in the near future. These include but are not limited to:\n\n- Styled Components\n- Emotion\n- Relay\n\nIn order to prioritize transforms that will help you adopt SWC, please provide your `.babelrc` on [this feedback thread](https://github.com/vercel/next.js/discussions/30174)."
  },
  {
    "id": "version-12.mdx#3",
    "metadata": {
      "title": "How to upgrade to version 12",
      "description": "Upgrade your Next.js Application from Version 11 to Version 12."
    },
    "content": "#### SWC replacing Terser for minification\n\nYou can opt-in to replacing Terser with SWC for minifying JavaScript up to 7x faster using a flag in `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  swcMinify: true,\n}\n```\n\nMinification using SWC is an opt-in flag to ensure it can be tested against more real-world Next.js applications before it becomes the default in Next.js 12.1. If you have feedback about minification, please leave it on [this feedback thread](https://github.com/vercel/next.js/discussions/30237).\n\n#### Improvements to styled-jsx CSS parsing\n\nOn top of the Rust-based compiler we've implemented a new CSS parser based on the one used for the styled-jsx Babel transform. This new parser has improved handling of CSS and now errors when invalid CSS is used that would previously slip through and cause unexpected behavior.\n\nBecause of this change invalid CSS will throw an error during development and `next build`. This change only affects styled-jsx usage."
  },
  {
    "id": "version-12.mdx#4",
    "metadata": {
      "title": "How to upgrade to version 12",
      "description": "Upgrade your Next.js Application from Version 11 to Version 12."
    },
    "content": "#### `next/image` changed wrapping element\n\n`next/image` now renders the `<img>` inside a `<span>` instead of `<div>`.\n\nIf your application has specific CSS targeting span such as `.container span`, upgrading to Next.js 12 might incorrectly match the wrapping element inside the `<Image>` component. You can avoid this by restricting the selector to a specific class such as `.container span.item` and updating the relevant component with that className, such as `<span className=\"item\" />`.\n\nIf your application has specific CSS targeting the `next/image` `<div>` tag, for example `.container div`, it may not match anymore. You can update the selector `.container span`, or preferably, add a new `<div className=\"wrapper\">` wrapping the `<Image>` component and target that instead such as `.container .wrapper`.\n\nThe `className` prop is unchanged and will still be passed to the underlying `<img>` element.\n\nSee the [documentation](/docs/pages/api-reference/components/image#styling-images) for more info."
  },
  {
    "id": "version-12.mdx#5",
    "metadata": {
      "title": "How to upgrade to version 12",
      "description": "Upgrade your Next.js Application from Version 11 to Version 12."
    },
    "content": "#### HMR connection now uses a WebSocket\n\nPreviously, Next.js used a [server-sent events](https://developer.mozilla.org/docs/Web/API/Server-sent_events) connection to receive HMR events. Next.js 12 now uses a WebSocket connection.\n\nIn some cases when proxying requests to the Next.js dev server, you will need to ensure the upgrade request is handled correctly. For example, in `nginx` you would need to add the following configuration:\n\n```nginx\nlocation /_next/webpack-hmr {\n    proxy_pass http://localhost:3000/_next/webpack-hmr;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n}"
  },
  {
    "id": "version-12.mdx#6",
    "metadata": {
      "title": "How to upgrade to version 12",
      "description": "Upgrade your Next.js Application from Version 11 to Version 12."
    },
    "content": "```\n\nIf you are using Apache (2.x), you can add the following configuration to enable web sockets to the server. Review the port, host name and server names.\n\n```\n<VirtualHost *:443>\n # ServerName yourwebsite.local\n ServerName \"${WEBSITE_SERVER_NAME}\"\n ProxyPass / http://localhost:3000/\n ProxyPassReverse / http://localhost:3000/\n # Next.js 12 uses websocket\n <Location /_next/webpack-hmr>\n    RewriteEngine On\n    RewriteCond %{QUERY_STRING} transport=websocket [NC]\n    RewriteCond %{HTTP:Upgrade} websocket [NC]\n    RewriteCond %{HTTP:Connection} upgrade [NC]\n    RewriteRule /(.*) ws://localhost:3000/_next/webpack-hmr/$1 [P,L]\n    ProxyPass ws://localhost:3000/_next/webpack-hmr retry=0 timeout=30\n    ProxyPassReverse ws://localhost:3000/_next/webpack-hmr\n </Location>\n</VirtualHost>\n```\n\nFor custom servers, such as `express`, you may need to use `app.all` to ensure the request is passed correctly, for example:\n\n```js\napp.all('/_next/webpack-hmr', (req, res) => {\n  nextjsRequestHandler(req, res)\n})\n```"
  },
  {
    "id": "version-12.mdx#7",
    "metadata": {
      "title": "How to upgrade to version 12",
      "description": "Upgrade your Next.js Application from Version 11 to Version 12."
    },
    "content": "#### Webpack 4 support has been removed\n\nIf you are already using webpack 5 you can skip this section.\n\nNext.js has adopted webpack 5 as the default for compilation in Next.js 11. As communicated in the [webpack 5 upgrading documentation](/docs/messages/webpack5) Next.js 12 removes support for webpack 4.\n\nIf your application is still using webpack 4 using the opt-out flag, you will now see an error linking to the [webpack 5 upgrading documentation](/docs/messages/webpack5).\n\n#### `target` option deprecated\n\nIf you do not have `target` in `next.config.js` you can skip this section.\n\nThe target option has been deprecated in favor of built-in support for tracing what dependencies are needed to run a page.\n\nDuring `next build`, Next.js will automatically trace each page and its dependencies to determine all of the files that are needed for deploying a production version of your application.\n\nIf you are currently using the `target` option set to `serverless`, please read the [documentation on how to leverage the new output](/docs/pages/api-reference/config/next-config-js/output)."
  },
  {
    "id": "version-13.mdx#0",
    "metadata": {
      "title": "How to upgrade to version 13",
      "description": "Upgrade your Next.js Application from Version 12 to 13."
    },
    "content": "---\ntitle: How to upgrade to version 13\nnav_title: Version 13\ndescription: Upgrade your Next.js Application from Version 12 to 13.\n---"
  },
  {
    "id": "version-13.mdx#1",
    "metadata": {
      "title": "How to upgrade to version 13",
      "description": "Upgrade your Next.js Application from Version 12 to 13."
    },
    "content": "## Upgrading from 12 to 13\n\nTo update to Next.js version 13, run the following command using your preferred package manager:\n\n```bash filename=\"Terminal\"\nnpm i next@13 react@latest react-dom@latest eslint-config-next@13\n```\n\n```bash filename=\"Terminal\"\nyarn add next@13 react@latest react-dom@latest eslint-config-next@13\n```\n\n```bash filename=\"Terminal\"\npnpm i next@13 react@latest react-dom@latest eslint-config-next@13\n```\n\n```bash filename=\"Terminal\"\nbun add next@13 react@latest react-dom@latest eslint-config-next@13\n```\n\n> **Good to know:** If you are using TypeScript, ensure you also upgrade `@types/react` and `@types/react-dom` to their latest versions."
  },
  {
    "id": "version-13.mdx#2",
    "metadata": {
      "title": "How to upgrade to version 13",
      "description": "Upgrade your Next.js Application from Version 12 to 13."
    },
    "content": "### v13 Summary\n\n- The [Supported Browsers](/docs/architecture/supported-browsers) have been changed to drop Internet Explorer and target modern browsers.\n- The minimum Node.js version has been bumped from 12.22.0 to 16.14.0, since 12.x and 14.x have reached end-of-life.\n- The minimum React version has been bumped from 17.0.2 to 18.2.0.\n- The `swcMinify` configuration property was changed from `false` to `true`. See [Next.js Compiler](/docs/architecture/nextjs-compiler) for more info.\n- The `next/image` import was renamed to `next/legacy/image`. The `next/future/image` import was renamed to `next/image`. A [codemod is available](/docs/pages/guides/upgrading/codemods#next-image-to-legacy-image) to safely and automatically rename your imports.\n- The `next/link` child can no longer be `<a>`. Add the `legacyBehavior` prop to use the legacy behavior or remove the `<a>` to upgrade. A [codemod is available](/docs/pages/guides/upgrading/codemods#new-link) to automatically upgrade your code.\n- The `target` configuration property has been removed and superseded by [Output File Tracing](/docs/pages/api-reference/config/next-config-js/output)."
  },
  {
    "id": "version-13.mdx#3",
    "metadata": {
      "title": "How to upgrade to version 13",
      "description": "Upgrade your Next.js Application from Version 12 to 13."
    },
    "content": "## Migrating shared features\n\nNext.js 13 introduces a new [`app` directory](/docs/app) with new features and conventions. However, upgrading to Next.js 13 does **not** require using the new `app` Router.\n\nYou can continue using `pages` with new features that work in both directories, such as the updated [Image component](#image-component), [Link component](#link-component), [Script component](#script-component), and [Font optimization](#font-optimization)."
  },
  {
    "id": "version-13.mdx#4",
    "metadata": {
      "title": "How to upgrade to version 13",
      "description": "Upgrade your Next.js Application from Version 12 to 13."
    },
    "content": "### `<Image/>` Component\n\nNext.js 12 introduced many improvements to the Image Component with a temporary import: `next/future/image`. These improvements included less client-side JavaScript, easier ways to extend and style images, better accessibility, and native browser lazy loading.\n\nStarting in Next.js 13, this new behavior is now the default for `next/image`.\n\nThere are two codemods to help you migrate to the new Image Component:"
  },
  {
    "id": "version-13.mdx#5",
    "metadata": {
      "title": "How to upgrade to version 13",
      "description": "Upgrade your Next.js Application from Version 12 to 13."
    },
    "content": "Starting in Next.js 13, this new behavior is now the default for `next/image`.\n\nThere are two codemods to help you migrate to the new Image Component:\n\n- [next-image-to-legacy-image](/docs/pages/guides/upgrading/codemods#next-image-to-legacy-image): This codemod will safely and automatically rename `next/image` imports to `next/legacy/image` to maintain the same behavior as Next.js 12. We recommend running this codemod to quickly update to Next.js 13 automatically.\n- [next-image-experimental](/docs/pages/guides/upgrading/codemods#next-image-experimental): After running the previous codemod, you can optionally run this experimental codemod to upgrade `next/legacy/image` to the new `next/image`, which will remove unused props and add inline styles. Please note this codemod is experimental and only covers static usage (such as `<Image src={img} layout=\"responsive\" />`) but not dynamic usage (such as `<Image {...props} />`).\n\nAlternatively, you can manually update by following the [migration guide](/docs/pages/guides/upgrading/codemods#next-image-experimental) and also see the [legacy comparison](/docs/pages/api-reference/components/image-legacy#comparison)."
  },
  {
    "id": "version-13.mdx#6",
    "metadata": {
      "title": "How to upgrade to version 13",
      "description": "Upgrade your Next.js Application from Version 12 to 13."
    },
    "content": "### `<Link>` Component\n\nThe [`<Link>` Component](/docs/pages/api-reference/components/link) no longer requires manually adding an `<a>` tag as a child. This behavior was added as an experimental option in [version 12.2](https://nextjs.org/blog/next-12-2) and is now the default. In Next.js 13, `<Link>` always renders `<a>` and allows you to forward props to the underlying tag.\n\nFor example:\n\n```jsx\nimport Link from 'next/link'\n\n// Next.js 12: `<a>` has to be nested otherwise it's excluded\n<Link href=\"/about\">\n  <a>About</a>\n</Link>\n\n// Next.js 13: `<Link>` always renders `<a>` under the hood\n<Link href=\"/about\">\n  About\n</Link>\n```\n\nTo upgrade your links to Next.js 13, you can use the [`new-link` codemod](/docs/pages/guides/upgrading/codemods#new-link).\n\n### `<Script>` Component\n\nThe behavior of [`next/script`](/docs/pages/api-reference/components/script) has been updated to support both `pages` and `app`. If incrementally adopting `app`, read the [upgrade guide](/docs/pages/guides/upgrading)."
  },
  {
    "id": "version-13.mdx#7",
    "metadata": {
      "title": "How to upgrade to version 13",
      "description": "Upgrade your Next.js Application from Version 12 to 13."
    },
    "content": "### Font Optimization\n\nPreviously, Next.js helped you optimize fonts by inlining font CSS. Version 13 introduces the new [`next/font`](/docs/pages/api-reference/components/font) module which gives you the ability to customize your font loading experience while still ensuring great performance and privacy.\n\nSee [Optimizing Fonts](/docs/pages/api-reference/components/font) to learn how to use `next/font`."
  },
  {
    "id": "version-14.mdx#0",
    "metadata": {
      "title": "How to upgrade to version 14",
      "description": "Upgrade your Next.js Application from Version 13 to 14."
    },
    "content": "---\ntitle: How to upgrade to version 14\nnav_title: Version 14\ndescription: Upgrade your Next.js Application from Version 13 to 14.\nsource: app/guides/upgrading/version-14\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "version-9.mdx#0",
    "metadata": {
      "title": "How to upgrade to version 9",
      "description": "Upgrade your Next.js Application from Version 8 to Version 9."
    },
    "content": "---\ntitle: How to upgrade to version 9\nnav_title: Version 9\ndescription: Upgrade your Next.js Application from Version 8 to Version 9.\n---\n\nTo upgrade to version 9, run the following command:\n\n```bash filename=\"Terminal\"\nnpm i next@9\n```\n\n```bash filename=\"Terminal\"\nyarn add next@9\n```\n\n```bash filename=\"Terminal\"\npnpm up next@9\n```\n\n```bash filename=\"Terminal\"\nbun add next@9\n```\n\n> **Good to know:** If you are using TypeScript, ensure you also upgrade `@types/react` and `@types/react-dom` to their corresponding versions."
  },
  {
    "id": "version-9.mdx#1",
    "metadata": {
      "title": "How to upgrade to version 9",
      "description": "Upgrade your Next.js Application from Version 8 to Version 9."
    },
    "content": "## Check your Custom App File (`pages/_app.js`)\n\nIf you previously copied the [Custom `<App>`](/docs/pages/building-your-application/routing/custom-app) example, you may be able to remove your `getInitialProps`.\n\nRemoving `getInitialProps` from `pages/_app.js` (when possible) is important to leverage new Next.js features!\n\nThe following `getInitialProps` does nothing and may be removed:\n\n```js\nclass MyApp extends App {\n  // Remove me, I do nothing!\n  static async getInitialProps({ Component, ctx }) {\n    let pageProps = {}\n\n    if (Component.getInitialProps) {\n      pageProps = await Component.getInitialProps(ctx)\n    }\n\n    return { pageProps }\n  }\n\n  render() {\n    // ... etc\n  }\n}\n```"
  },
  {
    "id": "version-9.mdx#2",
    "metadata": {
      "title": "How to upgrade to version 9",
      "description": "Upgrade your Next.js Application from Version 8 to Version 9."
    },
    "content": "## Breaking Changes\n\n### `@zeit/next-typescript` is no longer necessary\n\nNext.js will now ignore usage `@zeit/next-typescript` and warn you to remove it. Please remove this plugin from your `next.config.js`.\n\nRemove references to `@zeit/next-typescript/babel` from your custom `.babelrc` (if present).\n\nThe usage of [`fork-ts-checker-webpack-plugin`](https://github.com/Realytics/fork-ts-checker-webpack-plugin/issues) should also be removed from your `next.config.js`.\n\nTypeScript Definitions are published with the `next` package, so you need to uninstall `@types/next` as they would conflict.\n\nThe following types are different:\n\n> This list was created by the community to help you upgrade, if you find other differences please send a pull-request to this list to help other users.\n\nFrom:\n\n```tsx\nimport { NextContext } from 'next'\nimport { NextAppContext, DefaultAppIProps } from 'next/app'\nimport { NextDocumentContext, DefaultDocumentIProps } from 'next/document'\n```\n\nto\n\n```tsx\nimport { NextPageContext } from 'next'\nimport { AppContext, AppInitialProps } from 'next/app'\nimport { DocumentContext, DocumentInitialProps } from 'next/document'\n```"
  },
  {
    "id": "version-9.mdx#3",
    "metadata": {
      "title": "How to upgrade to version 9",
      "description": "Upgrade your Next.js Application from Version 8 to Version 9."
    },
    "content": "### The `config` key is now an export on a page\n\nYou may no longer export a custom variable named `config` from a page (i.e. `export { config }` / `export const config ...`).\nThis exported variable is now used to specify page-level Next.js configuration like Opt-in AMP and API Route features.\n\nYou must rename a non-Next.js-purposed `config` export to something different.\n\n### `next/dynamic` no longer renders \"loading...\" by default while loading\n\nDynamic components will not render anything by default while loading. You can still customize this behavior by setting the `loading` property:\n\n```jsx\nimport dynamic from 'next/dynamic'\n\nconst DynamicComponentWithCustomLoading = dynamic(\n  () => import('../components/hello2'),\n  {\n    loading: () => <p>Loading</p>,\n  }\n)\n```"
  },
  {
    "id": "version-9.mdx#4",
    "metadata": {
      "title": "How to upgrade to version 9",
      "description": "Upgrade your Next.js Application from Version 8 to Version 9."
    },
    "content": "### `withAmp` has been removed in favor of an exported configuration object\n\nNext.js now has the concept of page-level configuration, so the `withAmp` higher-order component has been removed for consistency.\n\nThis change can be **automatically migrated by running the following commands in the root of your Next.js project:**\n\n```bash filename=\"Terminal\"\ncurl -L https://github.com/vercel/next-codemod/archive/master.tar.gz | tar -xz --strip=2 next-codemod-master/transforms/withamp-to-config.js npx jscodeshift -t ./withamp-to-config.js pages/**/*.js\n```\n\nTo perform this migration by hand, or view what the codemod will produce, see below:\n\n**Before**\n\n```jsx\nimport { withAmp } from 'next/amp'\n\nfunction Home() {\n  return <h1>My AMP Page</h1>\n}\n\nexport default withAmp(Home)\n// or\nexport default withAmp(Home, { hybrid: true })\n```\n\n**After**\n\n```jsx\nexport default function Home() {\n  return <h1>My AMP Page</h1>\n}\n\nexport const config = {\n  amp: true,\n  // or\n  amp: 'hybrid',\n}\n```"
  },
  {
    "id": "version-9.mdx#5",
    "metadata": {
      "title": "How to upgrade to version 9",
      "description": "Upgrade your Next.js Application from Version 8 to Version 9."
    },
    "content": "### `next export` no longer exports pages as `index.html`\n\nPreviously, exporting `pages/about.js` would result in `out/about/index.html`. This behavior has been changed to result in `out/about.html`.\n\nYou can revert to the previous behavior by creating a `next.config.js` with the following content:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  trailingSlash: true,\n}\n```\n\n### `pages/api/` is treated differently\n\nPages in `pages/api/` are now considered [API Routes](https://nextjs.org/blog/next-9#api-routes).\nPages in this directory will no longer contain a client-side bundle."
  },
  {
    "id": "version-9.mdx#6",
    "metadata": {
      "title": "How to upgrade to version 9",
      "description": "Upgrade your Next.js Application from Version 8 to Version 9."
    },
    "content": "## Deprecated Features"
  },
  {
    "id": "version-9.mdx#7",
    "metadata": {
      "title": "How to upgrade to version 9",
      "description": "Upgrade your Next.js Application from Version 8 to Version 9."
    },
    "content": "### `next/dynamic` has deprecated loading multiple modules at once\n\nThe ability to load multiple modules at once has been deprecated in `next/dynamic` to be closer to React's implementation (`React.lazy` and `Suspense`).\n\nUpdating code that relies on this behavior is relatively straightforward! We've provided an example of a before/after to help you migrate your application:\n\n**Before**\n\n```jsx\nimport dynamic from 'next/dynamic'\n\nconst HelloBundle = dynamic({\n  modules: () => {\n    const components = {\n      Hello1: () => import('../components/hello1').then((m) => m.default),\n      Hello2: () => import('../components/hello2').then((m) => m.default),\n    }\n\n    return components\n  },\n  render: (props, { Hello1, Hello2 }) => (\n    <div>\n      <h1>{props.title}</h1>\n      <Hello1 />\n      <Hello2 />\n    </div>\n  ),\n})\n\nfunction DynamicBundle() {\n  return <HelloBundle title=\"Dynamic Bundle\" />\n}\n\nexport default DynamicBundle"
  },
  {
    "id": "version-9.mdx#8",
    "metadata": {
      "title": "How to upgrade to version 9",
      "description": "Upgrade your Next.js Application from Version 8 to Version 9."
    },
    "content": "```\n\n**After**\n\n```jsx\nimport dynamic from 'next/dynamic'\n\nconst Hello1 = dynamic(() => import('../components/hello1'))\nconst Hello2 = dynamic(() => import('../components/hello2'))\n\nfunction HelloBundle({ title }) {\n  return (\n    <div>\n      <h1>{title}</h1>\n      <Hello1 />\n      <Hello2 />\n    </div>\n  )\n}\n\nfunction DynamicBundle() {\n  return <HelloBundle title=\"Dynamic Bundle\" />\n}\n\nexport default DynamicBundle\n```"
  },
  {
    "id": "01-pages-and-layouts.mdx#0",
    "metadata": {
      "title": "Pages and Layouts",
      "description": "Create your first page and shared layout with the Pages Router."
    },
    "content": "---\ntitle: Pages and Layouts\ndescription: Create your first page and shared layout with the Pages Router.\n---\n\nThe Pages Router has a file-system based router built on the concept of pages.\n\nWhen a file is added to the `pages` directory, it's automatically available as a route.\n\nIn Next.js, a **page** is a [React Component](https://react.dev/learn/your-first-component) exported from a `.js`, `.jsx`, `.ts`, or `.tsx` file in the `pages` directory. Each page is associated with a route based on its file name.\n\n**Example**: If you create `pages/about.js` that exports a React component like below, it will be accessible at `/about`.\n\n```jsx\nexport default function About() {\n  return <div>About</div>\n}\n```\n\n## Index routes\n\nThe router will automatically route files named `index` to the root of the directory.\n\n- `pages/index.js` → `/`\n- `pages/blog/index.js` → `/blog`\n\n## Nested routes\n\nThe router supports nested files. If you create a nested folder structure, files will automatically be routed in the same way still.\n\n- `pages/blog/first-post.js` → `/blog/first-post`\n- `pages/dashboard/settings/username.js` → `/dashboard/settings/username`"
  },
  {
    "id": "01-pages-and-layouts.mdx#1",
    "metadata": {
      "title": "Pages and Layouts",
      "description": "Create your first page and shared layout with the Pages Router."
    },
    "content": "## Pages with Dynamic Routes\n\nNext.js supports pages with dynamic routes. For example, if you create a file called `pages/posts/[id].js`, then it will be accessible at `posts/1`, `posts/2`, etc.\n\n> To learn more about dynamic routing, check the [Dynamic Routing documentation](/docs/pages/building-your-application/routing/dynamic-routes).\n\n## Layout Pattern\n\nThe React model allows us to deconstruct a [page](/docs/pages/building-your-application/routing/pages-and-layouts) into a series of components. Many of these components are often reused between pages. For example, you might have the same navigation bar and footer on every page.\n\n```jsx filename=\"components/layout.js\"\nimport Navbar from './navbar'\nimport Footer from './footer'\n\nexport default function Layout({ children }) {\n  return (\n    <>\n      <Navbar />\n      <main>{children}</main>\n      <Footer />\n    </>\n  )\n}\n```"
  },
  {
    "id": "01-pages-and-layouts.mdx#2",
    "metadata": {
      "title": "Pages and Layouts",
      "description": "Create your first page and shared layout with the Pages Router."
    },
    "content": "## Examples\n\n### Single Shared Layout with Custom App\n\nIf you only have one layout for your entire application, you can create a [Custom App](/docs/pages/building-your-application/routing/custom-app) and wrap your application with the layout. Since the `<Layout />` component is re-used when changing pages, its component state will be preserved (e.g. input values).\n\n```jsx filename=\"pages/_app.js\"\nimport Layout from '../components/layout'\n\nexport default function MyApp({ Component, pageProps }) {\n  return (\n    <Layout>\n      <Component {...pageProps} />\n    </Layout>\n  )\n}\n```"
  },
  {
    "id": "01-pages-and-layouts.mdx#3",
    "metadata": {
      "title": "Pages and Layouts",
      "description": "Create your first page and shared layout with the Pages Router."
    },
    "content": "### Per-Page Layouts\n\nIf you need multiple layouts, you can add a property `getLayout` to your page, allowing you to return a React component for the layout. This allows you to define the layout on a _per-page basis_. Since we're returning a function, we can have complex nested layouts if desired.\n\n```jsx filename=\"pages/index.js\"\n\nimport Layout from '../components/layout'\nimport NestedLayout from '../components/nested-layout'\n\nexport default function Page() {\n  return (\n    /** Your content */\n  )\n}\n\nPage.getLayout = function getLayout(page) {\n  return (\n    <Layout>\n      <NestedLayout>{page}</NestedLayout>\n    </Layout>\n  )\n}\n```\n\n```jsx filename=\"pages/_app.js\"\nexport default function MyApp({ Component, pageProps }) {\n  // Use the layout defined at the page level, if available\n  const getLayout = Component.getLayout ?? ((page) => page)\n\n  return getLayout(<Component {...pageProps} />)\n}"
  },
  {
    "id": "01-pages-and-layouts.mdx#4",
    "metadata": {
      "title": "Pages and Layouts",
      "description": "Create your first page and shared layout with the Pages Router."
    },
    "content": "```\n\nWhen navigating between pages, we want to _persist_ page state (input values, scroll position, etc.) for a Single-Page Application (SPA) experience.\n\nThis layout pattern enables state persistence because the React component tree is maintained between page transitions. With the component tree, React can understand which elements have changed to preserve state.\n\n> **Good to know**: This process is called [reconciliation](https://react.dev/learn/preserving-and-resetting-state), which is how React understands which elements have changed."
  },
  {
    "id": "01-pages-and-layouts.mdx#5",
    "metadata": {
      "title": "Pages and Layouts",
      "description": "Create your first page and shared layout with the Pages Router."
    },
    "content": "### With TypeScript\n\nWhen using TypeScript, you must first create a new type for your pages which includes a `getLayout` function. Then, you must create a new type for your `AppProps` which overrides the `Component` property to use the previously created type.\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport type { ReactElement } from 'react'\nimport Layout from '../components/layout'\nimport NestedLayout from '../components/nested-layout'\nimport type { NextPageWithLayout } from './_app'\n\nconst Page: NextPageWithLayout = () => {\n  return <p>hello world</p>\n}\n\nPage.getLayout = function getLayout(page: ReactElement) {\n  return (\n    <Layout>\n      <NestedLayout>{page}</NestedLayout>\n    </Layout>\n  )\n}\n\nexport default Page\n```\n\n```jsx filename=\"pages/index.js\" switcher\nimport Layout from '../components/layout'\nimport NestedLayout from '../components/nested-layout'\n\nconst Page = () => {\n  return <p>hello world</p>\n}\n\nPage.getLayout = function getLayout(page) {\n  return (\n    <Layout>\n      <NestedLayout>{page}</NestedLayout>\n    </Layout>\n  )\n}\n\nexport default Page"
  },
  {
    "id": "01-pages-and-layouts.mdx#6",
    "metadata": {
      "title": "Pages and Layouts",
      "description": "Create your first page and shared layout with the Pages Router."
    },
    "content": "```\n\n```tsx filename=\"pages/_app.tsx\" switcher\nimport type { ReactElement, ReactNode } from 'react'\nimport type { NextPage } from 'next'\nimport type { AppProps } from 'next/app'\n\nexport type NextPageWithLayout<P = {}, IP = P> = NextPage<P, IP> & {\n  getLayout?: (page: ReactElement) => ReactNode\n}\n\ntype AppPropsWithLayout = AppProps & {\n  Component: NextPageWithLayout\n}\n\nexport default function MyApp({ Component, pageProps }: AppPropsWithLayout) {\n  // Use the layout defined at the page level, if available\n  const getLayout = Component.getLayout ?? ((page) => page)\n\n  return getLayout(<Component {...pageProps} />)\n}\n```\n\n```jsx filename=\"pages/_app.js\" switcher\nexport default function MyApp({ Component, pageProps }) {\n  // Use the layout defined at the page level, if available\n  const getLayout = Component.getLayout ?? ((page) => page)\n\n  return getLayout(<Component {...pageProps} />)\n}\n```"
  },
  {
    "id": "01-pages-and-layouts.mdx#7",
    "metadata": {
      "title": "Pages and Layouts",
      "description": "Create your first page and shared layout with the Pages Router."
    },
    "content": "### Data Fetching\n\nInside your layout, you can fetch data on the client-side using `useEffect` or a library like [SWR](https://swr.vercel.app/). Because this file is not a [Page](/docs/pages/building-your-application/routing/pages-and-layouts), you cannot use `getStaticProps` or `getServerSideProps` currently.\n\n```jsx filename=\"components/layout.js\"\nimport useSWR from 'swr'\nimport Navbar from './navbar'\nimport Footer from './footer'\n\nexport default function Layout({ children }) {\n  const { data, error } = useSWR('/api/navigation', fetcher)\n\n  if (error) return <div>Failed to load</div>\n  if (!data) return <div>Loading...</div>\n\n  return (\n    <>\n      <Navbar links={data.links} />\n      <main>{children}</main>\n      <Footer />\n    </>\n  )\n}\n```"
  },
  {
    "id": "02-dynamic-routes.mdx#0",
    "metadata": {
      "title": "Dynamic Routes",
      "description": "Dynamic Routes are pages that allow you to add custom params to your URLs. Start creating Dynamic Routes and learn more here."
    },
    "content": "---\ntitle: Dynamic Routes\ndescription: Dynamic Routes are pages that allow you to add custom params to your URLs. Start creating Dynamic Routes and learn more here.\nrelated:\n  title: Next Steps\n  description: For more information on what to do next, we recommend the following sections\n  links:\n    - pages/building-your-application/routing/linking-and-navigating\n    - pages/api-reference/functions/use-router\n---\n\nWhen you don't know the exact segment names ahead of time and want to create routes from dynamic data, you can use Dynamic Segments that are filled in at request time or [prerendered](/docs/pages/building-your-application/data-fetching/get-static-paths) at build time.\n\n## Convention\n\nA Dynamic Segment can be created by wrapping a file or folder name in square brackets: `[segmentName]`. For example, `[id]` or `[slug]`.\n\nDynamic Segments can be accessed from [`useRouter`](/docs/pages/api-reference/functions/use-router)."
  },
  {
    "id": "02-dynamic-routes.mdx#1",
    "metadata": {
      "title": "Dynamic Routes",
      "description": "Dynamic Routes are pages that allow you to add custom params to your URLs. Start creating Dynamic Routes and learn more here."
    },
    "content": "## Example\n\nFor example, a blog could include the following route `pages/blog/[slug].js` where `[slug]` is the Dynamic Segment for blog posts.\n\n```jsx\nimport { useRouter } from 'next/router'\n\nexport default function Page() {\n  const router = useRouter()\n  return <p>Post: {router.query.slug}</p>\n}\n```\n\n| Route                  | Example URL | `params`        |\n| ---------------------- | ----------- | --------------- |\n| `pages/blog/[slug].js` | `/blog/a`   | `{ slug: 'a' }` |\n| `pages/blog/[slug].js` | `/blog/b`   | `{ slug: 'b' }` |\n| `pages/blog/[slug].js` | `/blog/c`   | `{ slug: 'c' }` |"
  },
  {
    "id": "02-dynamic-routes.mdx#2",
    "metadata": {
      "title": "Dynamic Routes",
      "description": "Dynamic Routes are pages that allow you to add custom params to your URLs. Start creating Dynamic Routes and learn more here."
    },
    "content": "## Catch-all Segments\n\nDynamic Segments can be extended to **catch-all** subsequent segments by adding an ellipsis inside the brackets `[...segmentName]`.\n\nFor example, `pages/shop/[...slug].js` will match `/shop/clothes`, but also `/shop/clothes/tops`, `/shop/clothes/tops/t-shirts`, and so on.\n\n| Route                     | Example URL   | `params`                    |\n| ------------------------- | ------------- | --------------------------- |\n| `pages/shop/[...slug].js` | `/shop/a`     | `{ slug: ['a'] }`           |\n| `pages/shop/[...slug].js` | `/shop/a/b`   | `{ slug: ['a', 'b'] }`      |\n| `pages/shop/[...slug].js` | `/shop/a/b/c` | `{ slug: ['a', 'b', 'c'] }` |"
  },
  {
    "id": "02-dynamic-routes.mdx#3",
    "metadata": {
      "title": "Dynamic Routes",
      "description": "Dynamic Routes are pages that allow you to add custom params to your URLs. Start creating Dynamic Routes and learn more here."
    },
    "content": "## Optional Catch-all Segments\n\nCatch-all Segments can be made **optional** by including the parameter in double square brackets: `[[...segmentName]]`.\n\nFor example, `pages/shop/[[...slug]].js` will **also** match `/shop`, in addition to `/shop/clothes`, `/shop/clothes/tops`, `/shop/clothes/tops/t-shirts`.\n\nThe difference between **catch-all** and **optional catch-all** segments is that with optional, the route without the parameter is also matched (`/shop` in the example above).\n\n| Route                       | Example URL   | `params`                    |\n| --------------------------- | ------------- | --------------------------- |\n| `pages/shop/[[...slug]].js` | `/shop`       | `{ slug: undefined }`       |\n| `pages/shop/[[...slug]].js` | `/shop/a`     | `{ slug: ['a'] }`           |\n| `pages/shop/[[...slug]].js` | `/shop/a/b`   | `{ slug: ['a', 'b'] }`      |\n| `pages/shop/[[...slug]].js` | `/shop/a/b/c` | `{ slug: ['a', 'b', 'c'] }` |"
  },
  {
    "id": "03-linking-and-navigating.mdx#0",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how navigation works in Next.js, and how to use the Link Component and `useRouter` hook."
    },
    "content": "---\ntitle: Linking and Navigating\ndescription: Learn how navigation works in Next.js, and how to use the Link Component and `useRouter` hook.\n---\n\nThe Next.js router allows you to do client-side route transitions between pages, similar to a single-page application.\n\nA React component called `Link` is provided to do this client-side route transition.\n\n```jsx\nimport Link from 'next/link'\n\nfunction Home() {\n  return (\n    <ul>\n      <li>\n        <Link href=\"/\">Home</Link>\n      </li>\n      <li>\n        <Link href=\"/about\">About Us</Link>\n      </li>\n      <li>\n        <Link href=\"/blog/hello-world\">Blog Post</Link>\n      </li>\n    </ul>\n  )\n}\n\nexport default Home"
  },
  {
    "id": "03-linking-and-navigating.mdx#1",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how navigation works in Next.js, and how to use the Link Component and `useRouter` hook."
    },
    "content": "```\n\nThe example above uses multiple links. Each one maps a path (`href`) to a known page:\n\n- `/` → `pages/index.js`\n- `/about` → `pages/about.js`\n- `/blog/hello-world` → `pages/blog/[slug].js`\n\nAny `<Link />` in the viewport (initially or through scroll) will be prefetched by default (including the corresponding data) for pages using [Static Generation](/docs/pages/building-your-application/data-fetching/get-static-props). The corresponding data for [server-rendered](/docs/pages/building-your-application/data-fetching/get-server-side-props) routes is fetched _only when_ the `<Link />` is clicked."
  },
  {
    "id": "03-linking-and-navigating.mdx#2",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how navigation works in Next.js, and how to use the Link Component and `useRouter` hook."
    },
    "content": "## Linking to dynamic paths\n\nYou can also use interpolation to create the path, which comes in handy for [dynamic route segments](/docs/pages/building-your-application/routing/dynamic-routes). For example, to show a list of posts which have been passed to the component as a prop:\n\n```jsx\nimport Link from 'next/link'\n\nfunction Posts({ posts }) {\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.id}>\n          <Link href={`/blog/${encodeURIComponent(post.slug)}`}>\n            {post.title}\n          </Link>\n        </li>\n      ))}\n    </ul>\n  )\n}\n\nexport default Posts"
  },
  {
    "id": "03-linking-and-navigating.mdx#3",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how navigation works in Next.js, and how to use the Link Component and `useRouter` hook."
    },
    "content": "```\n\n> [`encodeURIComponent`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent) is used in the example to keep the path utf-8 compatible.\n\nAlternatively, using a URL Object:\n\n```jsx\nimport Link from 'next/link'\n\nfunction Posts({ posts }) {\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li key={post.id}>\n          <Link\n            href={{\n              pathname: '/blog/[slug]',\n              query: { slug: post.slug },\n            }}\n          >\n            {post.title}\n          </Link>\n        </li>\n      ))}\n    </ul>\n  )\n}\n\nexport default Posts\n```\n\nNow, instead of using interpolation to create the path, we use a URL object in `href` where:\n\n- `pathname` is the name of the page in the `pages` directory. `/blog/[slug]` in this case.\n- `query` is an object with the dynamic segment. `slug` in this case."
  },
  {
    "id": "03-linking-and-navigating.mdx#4",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how navigation works in Next.js, and how to use the Link Component and `useRouter` hook."
    },
    "content": "## Injecting the router\n\nTo access the [`router` object](/docs/pages/api-reference/functions/use-router#router-object) in a React component you can use [`useRouter`](/docs/pages/api-reference/functions/use-router) or [`withRouter`](/docs/pages/api-reference/functions/use-router#withrouter).\n\nIn general we recommend using [`useRouter`](/docs/pages/api-reference/functions/use-router).\n\n## Imperative Routing\n\n[`next/link`](/docs/pages/api-reference/components/link) should be able to cover most of your routing needs, but you can also do client-side navigations without it, take a look at the [documentation for `next/router`](/docs/pages/api-reference/functions/use-router).\n\nThe following example shows how to do basic page navigations with [`useRouter`](/docs/pages/api-reference/functions/use-router):\n\n```jsx\nimport { useRouter } from 'next/router'\n\nexport default function ReadMore() {\n  const router = useRouter()\n\n  return (\n    <button onClick={() => router.push('/about')}>\n      Click here to read more\n    </button>\n  )\n}\n```"
  },
  {
    "id": "03-linking-and-navigating.mdx#5",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how navigation works in Next.js, and how to use the Link Component and `useRouter` hook."
    },
    "content": "## Shallow Routing\n\n<details>\n  <summary>Examples</summary>\n\n- [Shallow Routing](https://github.com/vercel/next.js/tree/canary/examples/with-shallow-routing)\n\n</details>\n\nShallow routing allows you to change the URL without running data fetching methods again, that includes [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props), [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props), and [`getInitialProps`](/docs/pages/api-reference/functions/get-initial-props).\n\nYou'll receive the updated `pathname` and the `query` via the [`router` object](/docs/pages/api-reference/functions/use-router#router-object) (added by [`useRouter`](/docs/pages/api-reference/functions/use-router) or [`withRouter`](/docs/pages/api-reference/functions/use-router#withrouter)), without losing state.\n\nTo enable shallow routing, set the `shallow` option to `true`. Consider the following example:\n\n```jsx\nimport { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n\n// Current URL is '/'\nfunction Page() {\n  const router = useRouter()"
  },
  {
    "id": "03-linking-and-navigating.mdx#6",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how navigation works in Next.js, and how to use the Link Component and `useRouter` hook."
    },
    "content": "```jsx\nimport { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n\n// Current URL is '/'\nfunction Page() {\n  const router = useRouter()\n\n  useEffect(() => {\n    // Always do navigations after the first render\n    router.push('/?counter=10', undefined, { shallow: true })\n  }, [])\n\n  useEffect(() => {\n    // The counter changed!\n  }, [router.query.counter])\n}\n\nexport default Page"
  },
  {
    "id": "03-linking-and-navigating.mdx#7",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how navigation works in Next.js, and how to use the Link Component and `useRouter` hook."
    },
    "content": "```\n\nThe URL will get updated to `/?counter=10` and the page won't get replaced, only the state of the route is changed.\n\nYou can also watch for URL changes via [`componentDidUpdate`](https://react.dev/reference/react/Component#componentdidupdate) as shown below:\n\n```jsx\ncomponentDidUpdate(prevProps) {\n  const { pathname, query } = this.props.router\n  // verify props have changed to avoid an infinite loop\n  if (query.counter !== prevProps.router.query.counter) {\n    // fetch data based on the new query\n  }\n}\n```"
  },
  {
    "id": "03-linking-and-navigating.mdx#8",
    "metadata": {
      "title": "Linking and Navigating",
      "description": "Learn how navigation works in Next.js, and how to use the Link Component and `useRouter` hook."
    },
    "content": "### Caveats\n\nShallow routing **only** works for URL changes in the current page. For example, let's assume we have another page called `pages/about.js`, and you run this:\n\n```js\nrouter.push('/?counter=10', '/about?counter=10', { shallow: true })\n```\n\nSince that's a new page, it'll unload the current page, load the new one and wait for data fetching even though we asked to do shallow routing.\n\nWhen shallow routing is used with proxy it will not ensure the new page matches the current page like previously done without proxy. This is due to proxy being able to rewrite dynamically and can't be verified client-side without a data fetch which is skipped with shallow, so a shallow route change must always be treated as shallow."
  },
  {
    "id": "05-custom-app.mdx#0",
    "metadata": {
      "title": "Custom App",
      "description": "Control page initialization and add a layout that persists for all pages by overriding the default App component used by Next.js."
    },
    "content": "---\ntitle: Custom App\ndescription: Control page initialization and add a layout that persists for all pages by overriding the default App component used by Next.js.\n---\n\nNext.js uses the `App` component to initialize pages. You can override it and control the page initialization and:\n\n- Create a shared layout between page changes\n- Inject additional data into pages\n- [Add global CSS](/docs/app/getting-started/css)"
  },
  {
    "id": "05-custom-app.mdx#1",
    "metadata": {
      "title": "Custom App",
      "description": "Control page initialization and add a layout that persists for all pages by overriding the default App component used by Next.js."
    },
    "content": "## Usage\n\nTo override the default `App`, create the file `pages/_app` as shown below:\n\n```tsx filename=\"pages/_app.tsx\" switcher\nimport type { AppProps } from 'next/app'\n\nexport default function MyApp({ Component, pageProps }: AppProps) {\n  return <Component {...pageProps} />\n}\n```\n\n```jsx filename=\"pages/_app.jsx\" switcher\nexport default function MyApp({ Component, pageProps }) {\n  return <Component {...pageProps} />\n}"
  },
  {
    "id": "05-custom-app.mdx#2",
    "metadata": {
      "title": "Custom App",
      "description": "Control page initialization and add a layout that persists for all pages by overriding the default App component used by Next.js."
    },
    "content": "```\n\n```jsx filename=\"pages/_app.jsx\" switcher\nexport default function MyApp({ Component, pageProps }) {\n  return <Component {...pageProps} />\n}\n```\n\nThe `Component` prop is the active `page`, so whenever you navigate between routes, `Component` will change to the new `page`. Therefore, any props you send to `Component` will be received by the `page`.\n\n`pageProps` is an object with the initial props that were preloaded for your page by one of our [data fetching methods](/docs/pages/building-your-application/data-fetching), otherwise it's an empty object.\n\n> **Good to know**:\n>\n> - If your app is running and you added a custom `App`, you'll need to restart the development server. Only required if `pages/_app.js` didn't exist before.\n> - `App` does not support Next.js [Data Fetching methods](/docs/pages/building-your-application/data-fetching) like [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) or [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props)."
  },
  {
    "id": "05-custom-app.mdx#3",
    "metadata": {
      "title": "Custom App",
      "description": "Control page initialization and add a layout that persists for all pages by overriding the default App component used by Next.js."
    },
    "content": "## `getInitialProps` with `App`\n\nUsing [`getInitialProps`](/docs/pages/api-reference/functions/get-initial-props) in `App` will disable [Automatic Static Optimization](/docs/pages/building-your-application/rendering/automatic-static-optimization) for pages without [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props).\n\n**We do not recommend using this pattern.** Instead, consider [incrementally adopting](/docs/app/guides/migrating/app-router-migration) the App Router, which allows you to more easily fetch data for pages and layouts.\n\n```tsx filename=\"pages/_app.tsx\" switcher\nimport App, { AppContext, AppInitialProps, AppProps } from 'next/app'\n\ntype AppOwnProps = { example: string }\n\nexport default function MyApp({\n  Component,\n  pageProps,\n  example,\n}: AppProps & AppOwnProps) {\n  return (\n    <>\n      <p>Data: {example}</p>\n      <Component {...pageProps} />\n    </>\n  )\n}\n\nMyApp.getInitialProps = async (\n  context: AppContext\n): Promise<AppOwnProps & AppInitialProps> => {\n  const ctx = await App.getInitialProps(context)\n\n  return { ...ctx, example: 'data' }\n}"
  },
  {
    "id": "05-custom-app.mdx#4",
    "metadata": {
      "title": "Custom App",
      "description": "Control page initialization and add a layout that persists for all pages by overriding the default App component used by Next.js."
    },
    "content": "```\n\n```jsx filename=\"pages/_app.jsx\" switcher\nimport App from 'next/app'\n\nexport default function MyApp({ Component, pageProps, example }) {\n  return (\n    <>\n      <p>Data: {example}</p>\n      <Component {...pageProps} />\n    </>\n  )\n}\n\nMyApp.getInitialProps = async (context) => {\n  const ctx = await App.getInitialProps(context)\n\n  return { ...ctx, example: 'data' }\n}\n```"
  },
  {
    "id": "06-custom-document.mdx#0",
    "metadata": {
      "title": "Custom Document",
      "description": "Extend the default document markup added by Next.js."
    },
    "content": "---\ntitle: Custom Document\ndescription: Extend the default document markup added by Next.js.\n---\n\nA custom `Document` can update the `<html>` and `<body>` tags used to render a [Page](/docs/pages/building-your-application/routing/pages-and-layouts).\n\nTo override the default `Document`, create the file `pages/_document` as shown below:\n\n```tsx filename=\"pages/_document.tsx\" switcher\nimport { Html, Head, Main, NextScript } from 'next/document'\n\nexport default function Document() {\n  return (\n    <Html lang=\"en\">\n      <Head />\n      <body>\n        <Main />\n        <NextScript />\n      </body>\n    </Html>\n  )\n}\n```\n\n```jsx filename=\"pages/_document.jsx\" switcher\nimport { Html, Head, Main, NextScript } from 'next/document'\n\nexport default function Document() {\n  return (\n    <Html lang=\"en\">\n      <Head />\n      <body>\n        <Main />\n        <NextScript />\n      </body>\n    </Html>\n  )\n}\n```\n\n> **Good to know**:\n>\n> - `_document` is only rendered on the server, so event handlers like `onClick` cannot be used in this file.\n> - `<Html>`, `<Head />`, `<Main />` and `<NextScript />` are required for the page to be properly rendered."
  },
  {
    "id": "06-custom-document.mdx#1",
    "metadata": {
      "title": "Custom Document",
      "description": "Extend the default document markup added by Next.js."
    },
    "content": "## Caveats\n\n- The `<Head />` component used in `_document` is not the same as [`next/head`](/docs/pages/api-reference/components/head). The `<Head />` component used here should only be used for any `<head>` code that is common for all pages. For all other cases, such as `<title>` tags, we recommend using [`next/head`](/docs/pages/api-reference/components/head) in your pages or components.\n- React components outside of `<Main />` will not be initialized by the browser. Do _not_ add application logic here or custom CSS (like `styled-jsx`). If you need shared components in all your pages (like a menu or a toolbar), read [Layouts](/docs/pages/building-your-application/routing/pages-and-layouts#layout-pattern) instead.\n- `Document` currently does not support Next.js [Data Fetching methods](/docs/pages/building-your-application/data-fetching) like [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) or [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props)."
  },
  {
    "id": "06-custom-document.mdx#2",
    "metadata": {
      "title": "Custom Document",
      "description": "Extend the default document markup added by Next.js."
    },
    "content": "## Customizing `renderPage`\n\nCustomizing `renderPage` is advanced and only needed for libraries like CSS-in-JS to support server-side rendering. This is not needed for built-in `styled-jsx` support.\n\n**We do not recommend using this pattern.** Instead, consider [incrementally adopting](/docs/app/guides/migrating/app-router-migration) the App Router, which allows you to more easily fetch data for pages and layouts.\n\n```tsx filename=\"pages/_document.tsx\" switcher\nimport Document, {\n  Html,\n  Head,\n  Main,\n  NextScript,\n  DocumentContext,\n  DocumentInitialProps,\n} from 'next/document'\n\nclass MyDocument extends Document {\n  static async getInitialProps(\n    ctx: DocumentContext\n  ): Promise<DocumentInitialProps> {\n    const originalRenderPage = ctx.renderPage\n\n    // Run the React rendering logic synchronously\n    ctx.renderPage = () =>\n      originalRenderPage({\n        // Useful for wrapping the whole react tree\n        enhanceApp: (App) => App,\n        // Useful for wrapping in a per-page basis\n        enhanceComponent: (Component) => Component,\n      })"
  },
  {
    "id": "06-custom-document.mdx#3",
    "metadata": {
      "title": "Custom Document",
      "description": "Extend the default document markup added by Next.js."
    },
    "content": "// Run the parent `getInitialProps`, it now includes the custom `renderPage`\n    const initialProps = await Document.getInitialProps(ctx)\n\n    return initialProps\n  }\n\n  render() {\n    return (\n      <Html lang=\"en\">\n        <Head />\n        <body>\n          <Main />\n          <NextScript />\n        </body>\n      </Html>\n    )\n  }\n}\n\nexport default MyDocument"
  },
  {
    "id": "06-custom-document.mdx#4",
    "metadata": {
      "title": "Custom Document",
      "description": "Extend the default document markup added by Next.js."
    },
    "content": "```\n\n```jsx filename=\"pages/_document.jsx\" switcher\nimport Document, { Html, Head, Main, NextScript } from 'next/document'\n\nclass MyDocument extends Document {\n  static async getInitialProps(ctx) {\n    const originalRenderPage = ctx.renderPage\n\n    // Run the React rendering logic synchronously\n    ctx.renderPage = () =>\n      originalRenderPage({\n        // Useful for wrapping the whole react tree\n        enhanceApp: (App) => App,\n        // Useful for wrapping in a per-page basis\n        enhanceComponent: (Component) => Component,\n      })\n\n    // Run the parent `getInitialProps`, it now includes the custom `renderPage`\n    const initialProps = await Document.getInitialProps(ctx)\n\n    return initialProps\n  }\n\n  render() {\n    return (\n      <Html lang=\"en\">\n        <Head />\n        <body>\n          <Main />\n          <NextScript />\n        </body>\n      </Html>\n    )\n  }\n}\n\nexport default MyDocument"
  },
  {
    "id": "06-custom-document.mdx#5",
    "metadata": {
      "title": "Custom Document",
      "description": "Extend the default document markup added by Next.js."
    },
    "content": "```\n\n> **Good to know**:\n>\n> - `getInitialProps` in `_document` is not called during client-side transitions.\n> - The `ctx` object for `_document` is equivalent to the one received in [`getInitialProps`](/docs/pages/api-reference/functions/get-initial-props#context-object), with the addition of `renderPage`."
  },
  {
    "id": "07-api-routes.mdx#0",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "---\ntitle: API Routes\ndescription: Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here.\n---\n\n<details>\n  <summary>Examples</summary>\n\n- [API Routes Request Helpers](https://github.com/vercel/next.js/tree/canary/examples/api-routes-proxy)\n- [API Routes with GraphQL](https://github.com/vercel/next.js/tree/canary/examples/api-routes-graphql)\n- [API Routes with REST](https://github.com/vercel/next.js/tree/canary/examples/api-routes-rest)\n- [API Routes with CORS](https://github.com/vercel/next.js/tree/canary/examples/api-routes-cors)\n\n</details>\n\n> **Good to know**: If you are using the App Router, you can use [Server Components](/docs/app/getting-started/server-and-client-components) or [Route Handlers](/docs/app/api-reference/file-conventions/route) instead of API Routes.\n\nAPI routes provide a solution to build a **public API** with Next.js.\n\nAny file inside the folder `pages/api` is mapped to `/api/*` and will be treated as an API endpoint instead of a `page`. They are server-side only bundles and won't increase your client-side bundle size."
  },
  {
    "id": "07-api-routes.mdx#1",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "For example, the following API route returns a JSON response with a status code of `200`:\n\n```ts filename=\"pages/api/hello.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\ntype ResponseData = {\n  message: string\n}\n\nexport default function handler(\n  req: NextApiRequest,\n  res: NextApiResponse<ResponseData>\n) {\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}"
  },
  {
    "id": "07-api-routes.mdx#2",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "```\n\n```js filename=\"pages/api/hello.js\" switcher\nexport default function handler(req, res) {\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}\n```\n\n> **Good to know**:\n>\n> - API Routes [do not specify CORS headers](https://developer.mozilla.org/docs/Web/HTTP/CORS), meaning they are **same-origin only** by default. You can customize such behavior by wrapping the request handler with the [CORS request helpers](https://github.com/vercel/next.js/tree/canary/examples/api-routes-cors).\n\n- API Routes can't be used with [static exports](/docs/pages/guides/static-exports). However, [Route Handlers](/docs/app/api-reference/file-conventions/route) in the App Router can.\n  > - API Routes will be affected by [`pageExtensions` configuration](/docs/pages/api-reference/config/next-config-js/pageExtensions) in `next.config.js`."
  },
  {
    "id": "07-api-routes.mdx#3",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "## Parameters\n\n```tsx\nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  // ...\n}\n```\n\n- `req`: An instance of [http.IncomingMessage](https://nodejs.org/api/http.html#class-httpincomingmessage)\n- `res`: An instance of [http.ServerResponse](https://nodejs.org/api/http.html#class-httpserverresponse)\n\n## HTTP Methods\n\nTo handle different HTTP methods in an API route, you can use `req.method` in your request handler, like so:\n\n```ts filename=\"pages/api/hello.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  if (req.method === 'POST') {\n    // Process a POST request\n  } else {\n    // Handle any other HTTP method\n  }\n}\n```\n\n```js filename=\"pages/api/hello.js\" switcher\nexport default function handler(req, res) {\n  if (req.method === 'POST') {\n    // Process a POST request\n  } else {\n    // Handle any other HTTP method\n  }\n}\n```"
  },
  {
    "id": "07-api-routes.mdx#4",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "## Request Helpers\n\nAPI Routes provide built-in request helpers which parse the incoming request (`req`):\n\n- `req.cookies` - An object containing the cookies sent by the request. Defaults to `{}`\n- `req.query` - An object containing the [query string](https://en.wikipedia.org/wiki/Query_string). Defaults to `{}`\n- `req.body` - An object containing the body parsed by `content-type`, or `null` if no body was sent"
  },
  {
    "id": "07-api-routes.mdx#5",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "### Custom config\n\nEvery API Route can export a `config` object to change the default configuration, which is the following:\n\n```js\nexport const config = {\n  api: {\n    bodyParser: {\n      sizeLimit: '1mb',\n    },\n  },\n  // Specifies the maximum allowed duration for this function to execute (in seconds)\n  maxDuration: 5,\n}\n```\n\n`bodyParser` is automatically enabled. If you want to consume the body as a `Stream` or with [`raw-body`](https://www.npmjs.com/package/raw-body), you can set this to `false`.\n\nOne use case for disabling the automatic `bodyParsing` is to allow you to verify the raw body of a **webhook** request, for example [from GitHub](https://docs.github.com/en/developers/webhooks-and-events/webhooks/securing-your-webhooks#validating-payloads-from-github).\n\n```js\nexport const config = {\n  api: {\n    bodyParser: false,\n  },\n}\n```\n\n`bodyParser.sizeLimit` is the maximum size allowed for the parsed body, in any format supported by [bytes](https://github.com/visionmedia/bytes.js), like so:\n\n```js\nexport const config = {\n  api: {\n    bodyParser: {\n      sizeLimit: '500kb',\n    },\n  },\n}"
  },
  {
    "id": "07-api-routes.mdx#6",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "```\n\n`externalResolver` is an explicit flag that tells the server that this route is being handled by an external resolver like _express_ or _connect_. Enabling this option disables warnings for unresolved requests.\n\n```js\nexport const config = {\n  api: {\n    externalResolver: true,\n  },\n}\n```\n\n`responseLimit` is automatically enabled, warning when an API Routes' response body is over 4MB.\n\nIf you are not using Next.js in a serverless environment, and understand the performance implications of not using a CDN or dedicated media host, you can set this limit to `false`.\n\n```js\nexport const config = {\n  api: {\n    responseLimit: false,\n  },\n}\n```\n\n`responseLimit` can also take the number of bytes or any string format supported by `bytes`, for example `1000`, `'500kb'` or `'3mb'`.\nThis value will be the maximum response size before a warning is displayed. Default is 4MB. (see above)\n\n```js\nexport const config = {\n  api: {\n    responseLimit: '8mb',\n  },\n}\n```"
  },
  {
    "id": "07-api-routes.mdx#7",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "## Response Helpers\n\nThe [Server Response object](https://nodejs.org/api/http.html#http_class_http_serverresponse), (often abbreviated as `res`) includes a set of Express.js-like helper methods to improve the developer experience and increase the speed of creating new API endpoints.\n\nThe included helpers are:\n\n- `res.status(code)` - A function to set the status code. `code` must be a valid [HTTP status code](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes)\n- `res.json(body)` - Sends a JSON response. `body` must be a [serializable object](https://developer.mozilla.org/docs/Glossary/Serialization)\n- `res.send(body)` - Sends the HTTP response. `body` can be a `string`, an `object` or a `Buffer`\n- `res.redirect([status,] path)` - Redirects to a specified path or URL. `status` must be a valid [HTTP status code](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes). If not specified, `status` defaults to \"307\" \"Temporary redirect\".\n- `res.revalidate(urlPath)` - [Revalidate a page on demand](/docs/pages/guides/incremental-static-regeneration#on-demand-revalidation-with-revalidatepath) using `getStaticProps`. `urlPath` must be a `string`."
  },
  {
    "id": "07-api-routes.mdx#8",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "### Setting the status code of a response\n\nWhen sending a response back to the client, you can set the status code of the response.\n\nThe following example sets the status code of the response to `200` (`OK`) and returns a `message` property with the value of `Hello from Next.js!` as a JSON response:\n\n```ts filename=\"pages/api/hello.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\ntype ResponseData = {\n  message: string\n}\n\nexport default function handler(\n  req: NextApiRequest,\n  res: NextApiResponse<ResponseData>\n) {\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}\n```\n\n```js filename=\"pages/api/hello.js\" switcher\nexport default function handler(req, res) {\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}\n```"
  },
  {
    "id": "07-api-routes.mdx#9",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "### Sending a JSON response\n\nWhen sending a response back to the client you can send a JSON response, this must be a [serializable object](https://developer.mozilla.org/docs/Glossary/Serialization).\nIn a real world application you might want to let the client know the status of the request depending on the result of the requested endpoint.\n\nThe following example sends a JSON response with the status code `200` (`OK`) and the result of the async operation. It's contained in a try catch block to handle any errors that may occur, with the appropriate status code and error message caught and sent back to the client:\n\n```ts filename=\"pages/api/hello.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  try {\n    const result = await someAsyncOperation()\n    res.status(200).json({ result })\n  } catch (err) {\n    res.status(500).json({ error: 'failed to load data' })\n  }\n}"
  },
  {
    "id": "07-api-routes.mdx#10",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "```\n\n```js filename=\"pages/api/hello.js\" switcher\nexport default async function handler(req, res) {\n  try {\n    const result = await someAsyncOperation()\n    res.status(200).json({ result })\n  } catch (err) {\n    res.status(500).json({ error: 'failed to load data' })\n  }\n}\n```"
  },
  {
    "id": "07-api-routes.mdx#11",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "### Sending a HTTP response\n\nSending an HTTP response works the same way as when sending a JSON response. The only difference is that the response body can be a `string`, an `object` or a `Buffer`.\n\nThe following example sends a HTTP response with the status code `200` (`OK`) and the result of the async operation.\n\n```ts filename=\"pages/api/hello.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  try {\n    const result = await someAsyncOperation()\n    res.status(200).send({ result })\n  } catch (err) {\n    res.status(500).send({ error: 'failed to fetch data' })\n  }\n}\n```\n\n```js filename=\"pages/api/hello.js\" switcher\nexport default async function handler(req, res) {\n  try {\n    const result = await someAsyncOperation()\n    res.status(200).send({ result })\n  } catch (err) {\n    res.status(500).send({ error: 'failed to fetch data' })\n  }\n}\n```"
  },
  {
    "id": "07-api-routes.mdx#12",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "### Redirects to a specified path or URL\n\nTaking a form as an example, you may want to redirect your client to a specified path or URL once they have submitted the form.\n\nThe following example redirects the client to the `/` path if the form is successfully submitted:\n\n```ts filename=\"pages/api/hello.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const { name, message } = req.body\n\n  try {\n    await handleFormInputAsync({ name, message })\n    res.redirect(307, '/')\n  } catch (err) {\n    res.status(500).send({ error: 'Failed to fetch data' })\n  }\n}\n```\n\n```js filename=\"pages/api/hello.js\" switcher\nexport default async function handler(req, res) {\n  const { name, message } = req.body\n\n  try {\n    await handleFormInputAsync({ name, message })\n    res.redirect(307, '/')\n  } catch (err) {\n    res.status(500).send({ error: 'failed to fetch data' })\n  }\n}\n```"
  },
  {
    "id": "07-api-routes.mdx#13",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "### Adding TypeScript types\n\nYou can make your API Routes more type-safe by importing the `NextApiRequest` and `NextApiResponse` types from `next`, in addition to those, you can also type your response data:\n\n```ts\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\ntype ResponseData = {\n  message: string\n}\n\nexport default function handler(\n  req: NextApiRequest,\n  res: NextApiResponse<ResponseData>\n) {\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}\n```\n\n> **Good to know**: The body of `NextApiRequest` is `any` because the client may include any payload. You should validate the type/shape of the body at runtime before using it."
  },
  {
    "id": "07-api-routes.mdx#14",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "## Dynamic API Routes\n\nAPI Routes support [dynamic routes](/docs/pages/building-your-application/routing/dynamic-routes), and follow the same file naming rules used for `pages/`.\n\n```ts filename=\"pages/api/post/[pid].ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  const { pid } = req.query\n  res.end(`Post: ${pid}`)\n}\n```\n\n```js filename=\"pages/api/post/[pid].js\" switcher\nexport default function handler(req, res) {\n  const { pid } = req.query\n  res.end(`Post: ${pid}`)\n}\n```\n\nNow, a request to `/api/post/abc` will respond with the text: `Post: abc`."
  },
  {
    "id": "07-api-routes.mdx#15",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "### Catch all API routes\n\nAPI Routes can be extended to catch all paths by adding three dots (`...`) inside the brackets. For example:\n\n- `pages/api/post/[...slug].js` matches `/api/post/a`, but also `/api/post/a/b`, `/api/post/a/b/c` and so on.\n\n> **Good to know**: You can use names other than `slug`, such as: `[...param]`\n\nMatched parameters will be sent as a query parameter (`slug` in the example) to the page, and it will always be an array, so, the path `/api/post/a` will have the following `query` object:\n\n```json\n{ \"slug\": [\"a\"] }\n```\n\nAnd in the case of `/api/post/a/b`, and any other matching path, new parameters will be added to the array, like so:\n\n```json\n{ \"slug\": [\"a\", \"b\"] }\n```\n\nFor example:\n\n```ts filename=\"pages/api/post/[...slug].ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  const { slug } = req.query\n  res.end(`Post: ${slug.join(', ')}`)\n}\n```\n\n```js filename=\"pages/api/post/[...slug].js\" switcher\nexport default function handler(req, res) {\n  const { slug } = req.query\n  res.end(`Post: ${slug.join(', ')}`)\n}"
  },
  {
    "id": "07-api-routes.mdx#16",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "```\n\n```js filename=\"pages/api/post/[...slug].js\" switcher\nexport default function handler(req, res) {\n  const { slug } = req.query\n  res.end(`Post: ${slug.join(', ')}`)\n}\n```\n\nNow, a request to `/api/post/a/b/c` will respond with the text: `Post: a, b, c`."
  },
  {
    "id": "07-api-routes.mdx#17",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "### Optional catch all API routes\n\nCatch all routes can be made optional by including the parameter in double brackets (`[[...slug]]`).\n\nFor example, `pages/api/post/[[...slug]].js` will match `/api/post`, `/api/post/a`, `/api/post/a/b`, and so on.\n\nThe main difference between catch all and optional catch all routes is that with optional, the route without the parameter is also matched (`/api/post` in the example above).\n\nThe `query` objects are as follows:\n\n```json\n{ } // GET `/api/post` (empty object)\n{ \"slug\": [\"a\"] } // `GET /api/post/a` (single-element array)\n{ \"slug\": [\"a\", \"b\"] } // `GET /api/post/a/b` (multi-element array)\n```\n\n### Caveats\n\n- Predefined API routes take precedence over dynamic API routes, and dynamic API routes over catch all API routes. Take a look at the following examples:\n  - `pages/api/post/create.js` - Will match `/api/post/create`\n  - `pages/api/post/[pid].js` - Will match `/api/post/1`, `/api/post/abc`, etc. But not `/api/post/create`\n  - `pages/api/post/[...slug].js` - Will match `/api/post/1/2`, `/api/post/a/b/c`, etc. But not `/api/post/create`, `/api/post/abc`"
  },
  {
    "id": "07-api-routes.mdx#18",
    "metadata": {
      "title": "API Routes",
      "description": "Next.js supports API Routes, which allow you to build your API without leaving your Next.js app. Learn how it works here."
    },
    "content": "## Streaming responses\n\nWhile the Pages Router does support streaming responses with API Routes, we recommend incrementally adopting the App Router and using [Route Handlers](/docs/app/api-reference/file-conventions/route) if you are on Next.js 14+.\n\nHere's how you can stream a response from an API Route with `writeHead`:\n\n```ts filename=\"pages/api/hello.ts\" switcher\nimport { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  res.writeHead(200, {\n    'Content-Type': 'text/event-stream',\n    'Cache-Control': 'no-store',\n  })\n  let i = 0\n  while (i < 10) {\n    res.write(`data: ${i}\\n\\n`)\n    i++\n    await new Promise((resolve) => setTimeout(resolve, 1000))\n  }\n  res.end()\n}\n```\n\n```js filename=\"pages/api/hello.js\" switcher\nexport default async function handler(req, res) {\n  res.writeHead(200, {\n    'Content-Type': 'text/event-stream',\n    'Cache-Control': 'no-store',\n  })\n  let i = 0\n  while (i < 10) {\n    res.write(`data: ${i}\\n\\n`)\n    i++\n    await new Promise((resolve) => setTimeout(resolve, 1000))\n  }\n  res.end()\n}\n```"
  },
  {
    "id": "08-custom-error.mdx#0",
    "metadata": {
      "title": "Custom Errors",
      "description": "Override and extend the built-in Error page to handle custom errors."
    },
    "content": "---\ntitle: Custom Errors\ndescription: Override and extend the built-in Error page to handle custom errors.\n---\n\n## 404 Page\n\nA 404 page may be accessed very often. Server-rendering an error page for every visit increases the load of the Next.js server. This can result in increased costs and slow experiences.\n\nTo avoid the above pitfalls, Next.js provides a static 404 page by default without having to add any additional files.\n\n### Customizing The 404 Page\n\nTo create a custom 404 page you can create a `pages/404.js` file. This file is statically generated at build time.\n\n```jsx filename=\"pages/404.js\"\nexport default function Custom404() {\n  return <h1>404 - Page Not Found</h1>\n}\n```\n\n> **Good to know**: You can use [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) inside this page if you need to fetch data at build time."
  },
  {
    "id": "08-custom-error.mdx#1",
    "metadata": {
      "title": "Custom Errors",
      "description": "Override and extend the built-in Error page to handle custom errors."
    },
    "content": "## 500 Page\n\nServer-rendering an error page for every visit adds complexity to responding to errors. To help users get responses to errors as fast as possible, Next.js provides a static 500 page by default without having to add any additional files.\n\n### Customizing The 500 Page\n\nTo customize the 500 page you can create a `pages/500.js` file. This file is statically generated at build time.\n\n```jsx filename=\"pages/500.js\"\nexport default function Custom500() {\n  return <h1>500 - Server-side error occurred</h1>\n}\n```\n\n> **Good to know**: You can use [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) inside this page if you need to fetch data at build time."
  },
  {
    "id": "08-custom-error.mdx#2",
    "metadata": {
      "title": "Custom Errors",
      "description": "Override and extend the built-in Error page to handle custom errors."
    },
    "content": "### More Advanced Error Page Customizing\n\n500 errors are handled both client-side and server-side by the `Error` component. If you wish to override it, define the file `pages/_error.js` and add the following code:\n\n```jsx\nfunction Error({ statusCode }) {\n  return (\n    <p>\n      {statusCode\n        ? `An error ${statusCode} occurred on server`\n        : 'An error occurred on client'}\n    </p>\n  )\n}\n\nError.getInitialProps = ({ res, err }) => {\n  const statusCode = res ? res.statusCode : err ? err.statusCode : 404\n  return { statusCode }\n}\n\nexport default Error\n```\n\n> `pages/_error.js` is only used in production. In development you’ll get an error with the call stack to know where the error originated from."
  },
  {
    "id": "08-custom-error.mdx#3",
    "metadata": {
      "title": "Custom Errors",
      "description": "Override and extend the built-in Error page to handle custom errors."
    },
    "content": "### Reusing the built-in error page\n\nIf you want to render the built-in error page you can by importing the `Error` component:\n\n```jsx\nimport Error from 'next/error'\n\nexport async function getServerSideProps() {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const errorCode = res.ok ? false : res.status\n  const json = await res.json()\n\n  return {\n    props: { errorCode, stars: json.stargazers_count },\n  }\n}\n\nexport default function Page({ errorCode, stars }) {\n  if (errorCode) {\n    return <Error statusCode={errorCode} />\n  }\n\n  return <div>Next stars: {stars}</div>\n}\n```\n\nThe `Error` component also takes `title` as a property if you want to pass in a text message along with a `statusCode`.\n\nIf you have a custom `Error` component be sure to import that one instead. `next/error` exports the default component used by Next.js."
  },
  {
    "id": "08-custom-error.mdx#4",
    "metadata": {
      "title": "Custom Errors",
      "description": "Override and extend the built-in Error page to handle custom errors."
    },
    "content": "### Caveats\n\n- `Error` does not currently support Next.js [Data Fetching methods](/docs/pages/building-your-application/data-fetching) like [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) or [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props).\n- `_error`, like `_app`, is a reserved pathname. `_error` is used to define the customized layouts and behaviors of the error pages. `/_error` will render 404 when accessed directly via [routing](/docs/pages/building-your-application/routing) or rendering in a [custom server](/docs/pages/guides/custom-server)."
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Routing",
      "description": "Learn the fundamentals of routing for front-end applications with the Pages Router."
    },
    "content": "---\ntitle: Routing\ndescription: Learn the fundamentals of routing for front-end applications with the Pages Router.\n---\n\nThe Pages Router has a file-system based router built on concepts of pages. When a file is added to the `pages` directory it's automatically available as a route. Learn more about routing in the Pages Router:"
  },
  {
    "id": "01-server-side-rendering.mdx#0",
    "metadata": {
      "title": "Server-side Rendering (SSR)",
      "description": "Use Server-side Rendering to render pages on each request."
    },
    "content": "---\ntitle: Server-side Rendering (SSR)\ndescription: Use Server-side Rendering to render pages on each request.\n---\n\n> Also referred to as \"SSR\" or \"Dynamic Rendering\".\n\nIf a page uses **Server-side Rendering**, the page HTML is generated on **each request**.\n\nTo use Server-side Rendering for a page, you need to `export` an `async` function called `getServerSideProps`. This function will be called by the server on every request.\n\nFor example, suppose that your page needs to pre-render frequently updated data (fetched from an external API). You can write `getServerSideProps` which fetches this data and passes it to `Page` like below:\n\n```jsx\nexport default function Page({ data }) {\n  // Render data...\n}\n\n// This gets called on every request\nexport async function getServerSideProps() {\n  // Fetch data from external API\n  const res = await fetch(`https://.../data`)\n  const data = await res.json()\n\n  // Pass data to the page via props\n  return { props: { data } }\n}"
  },
  {
    "id": "01-server-side-rendering.mdx#1",
    "metadata": {
      "title": "Server-side Rendering (SSR)",
      "description": "Use Server-side Rendering to render pages on each request."
    },
    "content": "```\n\nAs you can see, `getServerSideProps` is similar to `getStaticProps`, but the difference is that `getServerSideProps` is run on every request instead of on build time.\n\nTo learn more about how `getServerSideProps` works, check out our [Data Fetching documentation](/docs/pages/building-your-application/data-fetching/get-server-side-props)."
  },
  {
    "id": "02-static-site-generation.mdx#0",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "---\ntitle: Static Site Generation (SSG)\ndescription: Use Static Site Generation (SSG) to pre-render pages at build time.\n---\n\n<details>\n  <summary>Examples</summary>"
  },
  {
    "id": "02-static-site-generation.mdx#1",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "- [Agility CMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-agilitycms) ([Demo](https://next-blog-agilitycms.vercel.app/))\n- [Builder.io Example](https://github.com/vercel/next.js/tree/canary/examples/cms-builder-io) ([Demo](https://cms-builder-io.vercel.app/))\n- [ButterCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-buttercms) ([Demo](https://next-blog-buttercms.vercel.app/))\n- [Contentful Example](https://github.com/vercel/next.js/tree/canary/examples/cms-contentful) ([Demo](https://app-router-contentful.vercel.app/))\n- [Cosmic Example](https://github.com/vercel/next.js/tree/canary/examples/cms-cosmic) ([Demo](https://next-blog-cosmic.vercel.app/))\n- [DatoCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-datocms) ([Demo](https://next-blog-datocms.vercel.app/))\n- [DotCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-dotcms) ([Demo](https://nextjs-dotcms-blog.vercel.app/))\n- [Drupal Example](https://github.com/vercel/next.js/tree/canary/examples/cms-drupal) ([Demo](https://cms-drupal.vercel.app/))"
  },
  {
    "id": "02-static-site-generation.mdx#2",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "- [Drupal Example](https://github.com/vercel/next.js/tree/canary/examples/cms-drupal) ([Demo](https://cms-drupal.vercel.app/))\n- [Enterspeed Example](https://github.com/vercel/next.js/tree/canary/examples/cms-enterspeed) ([Demo](https://next-blog-demo.enterspeed.com/))\n- [GraphCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-graphcms) ([Demo](https://next-blog-graphcms.vercel.app/))\n- [Keystone Example](https://github.com/vercel/next.js/tree/canary/examples/cms-keystonejs-embedded) ([Demo](https://nextjs-keystone-demo.vercel.app/))\n- [Kontent.ai Example](https://github.com/vercel/next.js/tree/canary/examples/cms-kontent-ai) ([Demo](https://next-blog-kontent-ai.vercel.app/))\n- [Makeswift Example](https://github.com/vercel/next.js/tree/canary/examples/cms-makeswift) ([Demo](https://nextjs-makeswift-example.vercel.app/))\n- [Plasmic Example](https://github.com/vercel/next.js/tree/canary/examples/cms-plasmic) ([Demo](https://nextjs-plasmic-example.vercel.app/))\n- [Prepr Example](https://github.com/vercel/next.js/tree/canary/examples/cms-prepr) ([Demo](https://next-blog-prepr.vercel.app/))"
  },
  {
    "id": "02-static-site-generation.mdx#3",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "- [Prepr Example](https://github.com/vercel/next.js/tree/canary/examples/cms-prepr) ([Demo](https://next-blog-prepr.vercel.app/))\n- [Prismic Example](https://github.com/vercel/next.js/tree/canary/examples/cms-prismic) ([Demo](https://next-blog-prismic.vercel.app/))\n- [Sanity Example](https://github.com/vercel/next.js/tree/canary/examples/cms-sanity) ([Demo](https://next-blog.sanity.build/))\n- [Sitecore XM Cloud Example](https://github.com/vercel/next.js/tree/canary/examples/cms-sitecore-xmcloud) ([Demo](https://vercel-sitecore-xmcloud-demo.vercel.app/))\n- [Storyblok Example](https://github.com/vercel/next.js/tree/canary/examples/cms-storyblok) ([Demo](https://next-blog-storyblok.vercel.app/))\n- [Strapi Example](https://github.com/vercel/next.js/tree/canary/examples/cms-strapi) ([Demo](https://next-blog-strapi.vercel.app/))\n- [TakeShape Example](https://github.com/vercel/next.js/tree/canary/examples/cms-takeshape) ([Demo](https://next-blog-takeshape.vercel.app/))\n- [Tina Example](https://github.com/vercel/next.js/tree/canary/examples/cms-tina) ([Demo](https://cms-tina-example.vercel.app/))"
  },
  {
    "id": "02-static-site-generation.mdx#4",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "- [Tina Example](https://github.com/vercel/next.js/tree/canary/examples/cms-tina) ([Demo](https://cms-tina-example.vercel.app/))\n- [Umbraco Example](https://github.com/vercel/next.js/tree/canary/examples/cms-umbraco) ([Demo](https://nextjs-umbraco-sample-blog.vercel.app/))\n- [Umbraco Heartcore Example](https://github.com/vercel/next.js/tree/canary/examples/cms-umbraco-heartcore) ([Demo](https://next-blog-umbraco-heartcore.vercel.app/))\n- [Webiny Example](https://github.com/vercel/next.js/tree/canary/examples/cms-webiny) ([Demo](https://webiny-headlesscms-nextjs-example.vercel.app/))\n- [WordPress Example](https://github.com/vercel/next.js/tree/canary/examples/cms-wordpress) ([Demo](https://next-blog-wordpress.vercel.app/))\n- [Blog Starter Example](https://github.com/vercel/next.js/tree/canary/examples/blog-starter) ([Demo](https://next-blog-starter.vercel.app/))\n- [Static Tweet (Demo)](https://react-tweet.vercel.app/)"
  },
  {
    "id": "02-static-site-generation.mdx#5",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "</details>\n\nIf a page uses **Static Generation**, the page HTML is generated at **build time**. That means in production, the page HTML is generated when you run `next build`. This HTML will then be reused on each request. It can be cached by a CDN.\n\nIn Next.js, you can statically generate pages **with or without data**. Let's take a look at each case."
  },
  {
    "id": "02-static-site-generation.mdx#6",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "### Static Generation without data\n\nBy default, Next.js pre-renders pages using Static Generation without fetching data. Here's an example:\n\n```jsx\nfunction About() {\n  return <div>About</div>\n}\n\nexport default About\n```\n\nNote that this page does not need to fetch any external data to be pre-rendered. In cases like this, Next.js generates a single HTML file per page during build time."
  },
  {
    "id": "02-static-site-generation.mdx#7",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "### Static Generation with data\n\nSome pages require fetching external data for pre-rendering. There are two scenarios, and one or both might apply. In each case, you can use these functions that Next.js provides:\n\n1. Your page **content** depends on external data: Use `getStaticProps`.\n2. Your page **paths** depend on external data: Use `getStaticPaths` (usually in addition to `getStaticProps`)."
  },
  {
    "id": "02-static-site-generation.mdx#8",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "#### Scenario 1: Your page content depends on external data\n\n**Example**: Your blog page might need to fetch the list of blog posts from a CMS (content management system).\n\n```jsx\n// TODO: Need to fetch `posts` (by calling some API endpoint)\n//       before this page can be pre-rendered.\nexport default function Blog({ posts }) {\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li>{post.title}</li>\n      ))}\n    </ul>\n  )\n}\n```\n\nTo fetch this data on pre-render, Next.js allows you to `export` an `async` function called `getStaticProps` from the same file. This function gets called at build time and lets you pass fetched data to the page's `props` on pre-render.\n\n```jsx\nexport default function Blog({ posts }) {\n  // Render posts...\n}\n\n// This function gets called at build time\nexport async function getStaticProps() {\n  // Call an external API endpoint to get posts\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n\n  // By returning { props: { posts } }, the Blog component\n  // will receive `posts` as a prop at build time\n  return {\n    props: {\n      posts,\n    },\n  }\n}"
  },
  {
    "id": "02-static-site-generation.mdx#9",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "```\n\nTo learn more about how `getStaticProps` works, check out the [Data Fetching documentation](/docs/pages/building-your-application/data-fetching/get-static-props)."
  },
  {
    "id": "02-static-site-generation.mdx#10",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "#### Scenario 2: Your page paths depend on external data\n\nNext.js allows you to create pages with **dynamic routes**. For example, you can create a file called `pages/posts/[id].js` to show a single blog post based on `id`. This will allow you to show a blog post with `id: 1` when you access `posts/1`.\n\n> To learn more about dynamic routing, check the [Dynamic Routing documentation](/docs/pages/building-your-application/routing/dynamic-routes).\n\nHowever, which `id` you want to pre-render at build time might depend on external data.\n\n**Example**: suppose that you've only added one blog post (with `id: 1`) to the database. In this case, you'd only want to pre-render `posts/1` at build time.\n\nLater, you might add the second post with `id: 2`. Then you'd want to pre-render `posts/2` as well.\n\nSo your page **paths** that are pre-rendered depend on external data. To handle this, Next.js lets you `export` an `async` function called `getStaticPaths` from a dynamic page (`pages/posts/[id].js` in this case). This function gets called at build time and lets you specify which paths you want to pre-render."
  },
  {
    "id": "02-static-site-generation.mdx#11",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "```jsx\n// This function gets called at build time\nexport async function getStaticPaths() {\n  // Call an external API endpoint to get posts\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n\n  // Get the paths we want to pre-render based on posts\n  const paths = posts.map((post) => ({\n    params: { id: post.id },\n  }))\n\n  // We'll pre-render only these paths at build time.\n  // { fallback: false } means other routes should 404.\n  return { paths, fallback: false }\n}"
  },
  {
    "id": "02-static-site-generation.mdx#12",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "```\n\nAlso in `pages/posts/[id].js`, you need to export `getStaticProps` so that you can fetch the data about the post with this `id` and use it to pre-render the page:\n\n```jsx\nexport default function Post({ post }) {\n  // Render post...\n}\n\nexport async function getStaticPaths() {\n  // ...\n}\n\n// This also gets called at build time\nexport async function getStaticProps({ params }) {\n  // params contains the post `id`.\n  // If the route is like /posts/1, then params.id is 1\n  const res = await fetch(`https://.../posts/${params.id}`)\n  const post = await res.json()\n\n  // Pass post data to the page via props\n  return { props: { post } }\n}\n```\n\nTo learn more about how `getStaticPaths` works, check out the [Data Fetching documentation](/docs/pages/building-your-application/data-fetching/get-static-paths)."
  },
  {
    "id": "02-static-site-generation.mdx#13",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "### When should I use Static Generation?\n\nWe recommend using **Static Generation** (with and without data) whenever possible because your page can be built once and served by CDN, which makes it much faster than having a server render the page on every request.\n\nYou can use Static Generation for many types of pages, including:\n\n- Marketing pages\n- Blog posts and portfolios\n- E-commerce product listings\n- Help and documentation\n\nYou should ask yourself: \"Can I pre-render this page **ahead** of a user's request?\" If the answer is yes, then you should choose Static Generation.\n\nOn the other hand, Static Generation is **not** a good idea if you cannot pre-render a page ahead of a user's request. Maybe your page shows frequently updated data, and the page content changes on every request.\n\nIn cases like this, you can do one of the following:"
  },
  {
    "id": "02-static-site-generation.mdx#14",
    "metadata": {
      "title": "Static Site Generation (SSG)",
      "description": "Use Static Site Generation (SSG) to pre-render pages at build time."
    },
    "content": "In cases like this, you can do one of the following:\n\n- Use Static Generation with **Client-side data fetching:** You can skip pre-rendering some parts of a page and then use client-side JavaScript to populate them. To learn more about this approach, check out the [Data Fetching documentation](/docs/pages/building-your-application/data-fetching/client-side).\n- Use **Server-Side Rendering:** Next.js pre-renders a page on each request. It will be slower because the page cannot be cached by a CDN, but the pre-rendered page will always be up-to-date. We'll talk about this approach below."
  },
  {
    "id": "04-automatic-static-optimization.mdx#0",
    "metadata": {
      "title": "Automatic Static Optimization",
      "description": "Next.js automatically optimizes your app to be static HTML whenever possible. Learn how it works here."
    },
    "content": "---\ntitle: Automatic Static Optimization\ndescription: Next.js automatically optimizes your app to be static HTML whenever possible. Learn how it works here.\n---\n\nNext.js automatically determines that a page is static (can be prerendered) if it has no blocking data requirements. This determination is made by the absence of `getServerSideProps` and `getInitialProps` in the page.\n\nThis feature allows Next.js to emit hybrid applications that contain **both server-rendered and statically generated pages**.\n\n> **Good to know**: Statically generated pages are still reactive. Next.js will hydrate your application client-side to give it full interactivity.\n\nOne of the main benefits of this feature is that optimized pages require no server-side computation, and can be instantly streamed to the end-user from multiple CDN locations. The result is an _ultra fast_ loading experience for your users."
  },
  {
    "id": "04-automatic-static-optimization.mdx#1",
    "metadata": {
      "title": "Automatic Static Optimization",
      "description": "Next.js automatically optimizes your app to be static HTML whenever possible. Learn how it works here."
    },
    "content": "## How it works\n\nIf `getServerSideProps` or `getInitialProps` is present in a page, Next.js will switch to render the page on-demand, per-request (meaning [Server-Side Rendering](/docs/pages/building-your-application/rendering/server-side-rendering)).\n\nIf the above is not the case, Next.js will **statically optimize** your page automatically by prerendering the page to static HTML.\n\nDuring prerendering, the router's `query` object will be empty since we do not have `query` information to provide during this phase. After hydration, Next.js will trigger an update to your application to provide the route parameters in the `query` object.\n\nThe cases where the query will be updated after hydration triggering another render are:\n\n- The page is a [dynamic-route](/docs/pages/building-your-application/routing/dynamic-routes).\n- The page has query values in the URL.\n- [Rewrites](/docs/pages/api-reference/config/next-config-js/rewrites) are configured in your `next.config.js` since these can have parameters that may need to be parsed and provided in the `query`."
  },
  {
    "id": "04-automatic-static-optimization.mdx#2",
    "metadata": {
      "title": "Automatic Static Optimization",
      "description": "Next.js automatically optimizes your app to be static HTML whenever possible. Learn how it works here."
    },
    "content": "To be able to distinguish if the query is fully updated and ready for use, you can leverage the `isReady` field on [`next/router`](/docs/pages/api-reference/functions/use-router#router-object).\n\n> **Good to know**: Parameters added with [dynamic routes](/docs/pages/building-your-application/routing/dynamic-routes) to a page that's using [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) will always be available inside the `query` object.\n\n`next build` will emit `.html` files for statically optimized pages. For example, the result for the page `pages/about.js` would be:\n\n```bash filename=\"Terminal\"\n.next/server/pages/about.html"
  },
  {
    "id": "04-automatic-static-optimization.mdx#3",
    "metadata": {
      "title": "Automatic Static Optimization",
      "description": "Next.js automatically optimizes your app to be static HTML whenever possible. Learn how it works here."
    },
    "content": "```\n\nAnd if you add `getServerSideProps` to the page, it will then be JavaScript, like so:\n\n```bash filename=\"Terminal\"\n.next/server/pages/about.js\n```"
  },
  {
    "id": "04-automatic-static-optimization.mdx#4",
    "metadata": {
      "title": "Automatic Static Optimization",
      "description": "Next.js automatically optimizes your app to be static HTML whenever possible. Learn how it works here."
    },
    "content": "## Caveats\n\n- If you have a [custom `App`](/docs/pages/building-your-application/routing/custom-app) with `getInitialProps` then this optimization will be turned off in pages without [Static Generation](/docs/pages/building-your-application/data-fetching/get-static-props).\n- If you have a [custom `Document`](/docs/pages/building-your-application/routing/custom-document) with `getInitialProps` be sure you check if `ctx.req` is defined before assuming the page is server-side rendered. `ctx.req` will be `undefined` for pages that are prerendered.\n- Avoid using the `asPath` value on [`next/router`](/docs/pages/api-reference/functions/use-router#router-object) in the rendering tree until the router's `isReady` field is `true`. Statically optimized pages only know `asPath` on the client and not the server, so using it as a prop may lead to mismatch errors. The [`active-class-name` example](https://github.com/vercel/next.js/tree/canary/examples/active-class-name) demonstrates one way to use `asPath` as a prop."
  },
  {
    "id": "05-client-side-rendering.mdx#0",
    "metadata": {
      "title": "Client-side Rendering (CSR)",
      "description": "Learn how to implement client-side rendering in the Pages Router."
    },
    "content": "---\ntitle: Client-side Rendering (CSR)\ndescription: Learn how to implement client-side rendering in the Pages Router.\nrelated:\n  description: Learn about the alternative rendering methods in Next.js.\n  links:\n    - pages/building-your-application/rendering/server-side-rendering\n    - pages/building-your-application/rendering/static-site-generation\n    - pages/guides/incremental-static-regeneration\n---\n\nIn Client-Side Rendering (CSR) with React, the browser downloads a minimal HTML page and the JavaScript needed for the page. The JavaScript is then used to update the DOM and render the page. When the application is first loaded, the user may notice a slight delay before they can see the full page, this is because the page isn't fully rendered until all the JavaScript is downloaded, parsed, and executed.\n\nAfter the page has been loaded for the first time, navigating to other pages on the same website is typically faster, as only necessary data needs to be fetched, and JavaScript can re-render parts of the page without requiring a full page refresh.\n\nIn Next.js, there are two ways you can implement client-side rendering:"
  },
  {
    "id": "05-client-side-rendering.mdx#1",
    "metadata": {
      "title": "Client-side Rendering (CSR)",
      "description": "Learn how to implement client-side rendering in the Pages Router."
    },
    "content": "In Next.js, there are two ways you can implement client-side rendering:\n\n1. Using React's `useEffect()` hook inside your pages instead of the server-side rendering methods ([`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) and [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props)).\n2. Using a data fetching library like [SWR](https://swr.vercel.app/) or [TanStack Query](https://tanstack.com/query/latest/) to fetch data on the client (recommended).\n\nHere's an example of using `useEffect()` inside a Next.js page:\n\n```jsx filename=\"pages/index.js\"\nimport React, { useState, useEffect } from 'react'\n\nexport function Page() {\n  const [data, setData] = useState(null)\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const response = await fetch('https://api.example.com/data')\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n      const result = await response.json()\n      setData(result)\n    }"
  },
  {
    "id": "05-client-side-rendering.mdx#2",
    "metadata": {
      "title": "Client-side Rendering (CSR)",
      "description": "Learn how to implement client-side rendering in the Pages Router."
    },
    "content": "fetchData().catch((e) => {\n      // handle the error as needed\n      console.error('An error occurred while fetching the data: ', e)\n    })\n  }, [])\n\n  return <p>{data ? `Your data: ${data}` : 'Loading...'}</p>\n}"
  },
  {
    "id": "05-client-side-rendering.mdx#3",
    "metadata": {
      "title": "Client-side Rendering (CSR)",
      "description": "Learn how to implement client-side rendering in the Pages Router."
    },
    "content": "```\n\nIn the example above, the component starts by rendering `Loading...`. Then, once the data is fetched, it re-renders and displays the data.\n\nAlthough fetching data in a `useEffect` is a pattern you may see in older React Applications, we recommend using a data-fetching library for better performance, caching, optimistic updates, and more. Here's a minimum example using [SWR](https://swr.vercel.app/) to fetch data on the client:\n\n```jsx filename=\"pages/index.js\"\nimport useSWR from 'swr'\n\nexport function Page() {\n  const { data, error, isLoading } = useSWR(\n    'https://api.example.com/data',\n    fetcher\n  )\n\n  if (error) return <p>Failed to load.</p>\n  if (isLoading) return <p>Loading...</p>\n\n  return <p>Your Data: {data}</p>\n}"
  },
  {
    "id": "05-client-side-rendering.mdx#4",
    "metadata": {
      "title": "Client-side Rendering (CSR)",
      "description": "Learn how to implement client-side rendering in the Pages Router."
    },
    "content": "```\n\n> **Good to know**:\n>\n> Keep in mind that CSR can impact SEO. Some search engine crawlers might not execute JavaScript and therefore only see the initial empty or loading state of your application. It can also lead to performance issues for users with slower internet connections or devices, as they need to wait for all the JavaScript to load and run before they can see the full page. Next.js promotes a hybrid approach that allows you to use a combination of [server-side rendering](/docs/pages/building-your-application/rendering/server-side-rendering), [static site generation](/docs/pages/building-your-application/rendering/static-site-generation), and client-side rendering, **depending on the needs of each page** in your application. In the App Router, you can also use [Loading UI with Suspense](/docs/app/api-reference/file-conventions/loading) to show a loading indicator while the page is being rendered."
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Rendering",
      "description": "Learn the fundamentals of rendering in React and Next.js."
    },
    "content": "---\ntitle: Rendering\ndescription: Learn the fundamentals of rendering in React and Next.js.\n---\n\nBy default, Next.js **pre-renders** every page. This means that Next.js generates HTML for each page in advance, instead of having it all done by client-side JavaScript. Pre-rendering can result in better performance and SEO.\n\nEach generated HTML is associated with minimal JavaScript code necessary for that page. When a page is loaded by the browser, its JavaScript code runs and makes the page fully interactive (this process is called [hydration](https://react.dev/reference/react-dom/client/hydrateRoot) in React)."
  },
  {
    "id": "index.mdx#1",
    "metadata": {
      "title": "Rendering",
      "description": "Learn the fundamentals of rendering in React and Next.js."
    },
    "content": "### Pre-rendering\n\nNext.js has two forms of pre-rendering: **Static Generation** and **Server-side Rendering**. The difference is in **when** it generates the HTML for a page.\n\n- Static Generation: The HTML is generated at **build time** and will be reused on each request.\n- Server-side Rendering: The HTML is generated on **each request**.\n\nImportantly, Next.js lets you choose which pre-rendering form you'd like to use for each page. You can create a \"hybrid\" Next.js app by using Static Generation for most pages and using Server-side Rendering for others.\n\nWe recommend using Static Generation over Server-side Rendering for performance reasons. Statically generated pages can be cached by CDN with no extra configuration to boost performance. However, in some cases, Server-side Rendering might be the only option.\n\nYou can also use client-side data fetching along with Static Generation or Server-side Rendering. That means some parts of a page can be rendered entirely by clientside JavaScript. To learn more, take a look at the [Data Fetching](/docs/pages/building-your-application/data-fetching/client-side) documentation."
  },
  {
    "id": "01-get-static-props.mdx#0",
    "metadata": {
      "title": "getStaticProps",
      "description": "Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."
    },
    "content": "---\ntitle: getStaticProps\ndescription: Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js.\n---\n\nIf you export a function called `getStaticProps` (Static Site Generation) from a page, Next.js will pre-render this page at build time using the props returned by `getStaticProps`.\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport type { InferGetStaticPropsType, GetStaticProps } from 'next'\n\ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n\nexport const getStaticProps = (async (context) => {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}) satisfies GetStaticProps<{\n  repo: Repo\n}>\n\nexport default function Page({\n  repo,\n}: InferGetStaticPropsType<typeof getStaticProps>) {\n  return repo.stargazers_count\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nexport async function getStaticProps() {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}\n\nexport default function Page({ repo }) {\n  return repo.stargazers_count\n}"
  },
  {
    "id": "01-get-static-props.mdx#1",
    "metadata": {
      "title": "getStaticProps",
      "description": "Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."
    },
    "content": "```\n\n> Note that irrespective of rendering type, any `props` will be passed to the page component and can be viewed on the client-side in the initial HTML. This is to allow the page to be [hydrated](https://react.dev/reference/react-dom/hydrate) correctly. Make sure that you don't pass any sensitive information that shouldn't be available on the client in `props`.\n\nThe [`getStaticProps` API reference](/docs/pages/api-reference/functions/get-static-props) covers all parameters and props that can be used with `getStaticProps`."
  },
  {
    "id": "01-get-static-props.mdx#2",
    "metadata": {
      "title": "getStaticProps",
      "description": "Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."
    },
    "content": "## When should I use getStaticProps?\n\nYou should use `getStaticProps` if:\n\n- The data required to render the page is available at build time ahead of a user’s request\n- The data comes from a headless CMS\n- The page must be pre-rendered (for SEO) and be very fast — `getStaticProps` generates `HTML` and `JSON` files, both of which can be cached by a CDN for performance\n- The data can be publicly cached (not user-specific). This condition can be bypassed in certain specific situation by using a Proxy to rewrite the path."
  },
  {
    "id": "01-get-static-props.mdx#3",
    "metadata": {
      "title": "getStaticProps",
      "description": "Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."
    },
    "content": "## When does getStaticProps run\n\n`getStaticProps` always runs on the server and never on the client. You can validate code written inside `getStaticProps` is removed from the client-side bundle [with this tool](https://next-code-elimination.vercel.app/).\n\n- `getStaticProps` always runs during `next build`\n- `getStaticProps` runs in the background when using [`fallback: true`](/docs/pages/api-reference/functions/get-static-paths#fallback-true)\n- `getStaticProps` is called before initial render when using [`fallback: blocking`](/docs/pages/api-reference/functions/get-static-paths#fallback-blocking)\n- `getStaticProps` runs in the background when using `revalidate`\n- `getStaticProps` runs on-demand in the background when using [`revalidate()`](/docs/pages/guides/incremental-static-regeneration#on-demand-revalidation-with-revalidatepath)\n\nWhen combined with [Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration), `getStaticProps` will run in the background while the stale page is being revalidated, and the fresh page served to the browser."
  },
  {
    "id": "01-get-static-props.mdx#4",
    "metadata": {
      "title": "getStaticProps",
      "description": "Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."
    },
    "content": "`getStaticProps` does not have access to the incoming request (such as query parameters or HTTP headers) as it generates static HTML. If you need access to the request for your page, consider using [Proxy](/docs/pages/api-reference/file-conventions/proxy) in addition to `getStaticProps`."
  },
  {
    "id": "01-get-static-props.mdx#5",
    "metadata": {
      "title": "getStaticProps",
      "description": "Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."
    },
    "content": "## Using getStaticProps to fetch data from a CMS\n\nThe following example shows how you can fetch a list of blog posts from a CMS.\n\n```tsx filename=\"pages/blog.tsx\" switcher\n// posts will be populated at build time by getStaticProps()\nexport default function Blog({ posts }) {\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li>{post.title}</li>\n      ))}\n    </ul>\n  )\n}\n\n// This function gets called at build time on server-side.\n// It won't be called on client-side, so you can even do\n// direct database queries.\nexport async function getStaticProps() {\n  // Call an external API endpoint to get posts.\n  // You can use any data fetching library\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n\n  // By returning { props: { posts } }, the Blog component\n  // will receive `posts` as a prop at build time\n  return {\n    props: {\n      posts,\n    },\n  }\n}"
  },
  {
    "id": "01-get-static-props.mdx#6",
    "metadata": {
      "title": "getStaticProps",
      "description": "Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."
    },
    "content": "```\n\n```jsx filename=\"pages/blog.js\" switcher\n// posts will be populated at build time by getStaticProps()\nexport default function Blog({ posts }) {\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li>{post.title}</li>\n      ))}\n    </ul>\n  )\n}\n\n// This function gets called at build time on server-side.\n// It won't be called on client-side, so you can even do\n// direct database queries.\nexport async function getStaticProps() {\n  // Call an external API endpoint to get posts.\n  // You can use any data fetching library\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n\n  // By returning { props: { posts } }, the Blog component\n  // will receive `posts` as a prop at build time\n  return {\n    props: {\n      posts,\n    },\n  }\n}\n```\n\nThe [`getStaticProps` API reference](/docs/pages/api-reference/functions/get-static-props) covers all parameters and props that can be used with `getStaticProps`."
  },
  {
    "id": "01-get-static-props.mdx#7",
    "metadata": {
      "title": "getStaticProps",
      "description": "Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."
    },
    "content": "## Write server-side code directly\n\nAs `getStaticProps` runs only on the server-side, it will never run on the client-side. It won’t even be included in the JS bundle for the browser, so you can write direct database queries without them being sent to browsers.\n\nThis means that instead of fetching an **API route** from `getStaticProps` (that itself fetches data from an external source), you can write the server-side code directly in `getStaticProps`.\n\nTake the following example. An API route is used to fetch some data from a CMS. That API route is then called directly from `getStaticProps`. This produces an additional call, reducing performance. Instead, the logic for fetching the data from the CMS can be shared by using a `lib/` directory. Then it can be shared with `getStaticProps`.\n\n```js filename=\"lib/load-posts.js\"\n// The following function is shared\n// with getStaticProps and API routes\n// from a `lib/` directory\nexport async function loadPosts() {\n  // Call an external API endpoint to get posts\n  const res = await fetch('https://.../posts/')\n  const data = await res.json()\n\n  return data\n}"
  },
  {
    "id": "01-get-static-props.mdx#8",
    "metadata": {
      "title": "getStaticProps",
      "description": "Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."
    },
    "content": "```\n\n```jsx filename=\"pages/blog.js\"\n// pages/blog.js\nimport { loadPosts } from '../lib/load-posts'\n\n// This function runs only on the server side\nexport async function getStaticProps() {\n  // Instead of fetching your `/api` route you can call the same\n  // function directly in `getStaticProps`\n  const posts = await loadPosts()\n\n  // Props returned will be passed to the page component\n  return { props: { posts } }\n}\n```\n\nAlternatively, if you are **not** using API routes to fetch data, then the [`fetch()`](https://developer.mozilla.org/docs/Web/API/Fetch_API) API _can_ be used directly in `getStaticProps` to fetch data.\n\nTo verify what Next.js eliminates from the client-side bundle, you can use the [next-code-elimination tool](https://next-code-elimination.vercel.app/)."
  },
  {
    "id": "01-get-static-props.mdx#9",
    "metadata": {
      "title": "getStaticProps",
      "description": "Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."
    },
    "content": "## Statically generates both HTML and JSON\n\nWhen a page with `getStaticProps` is pre-rendered at build time, in addition to the page HTML file, Next.js generates a JSON file holding the result of running `getStaticProps`.\n\nThis JSON file will be used in client-side routing through [`next/link`](/docs/pages/api-reference/components/link) or [`next/router`](/docs/pages/api-reference/functions/use-router). When you navigate to a page that’s pre-rendered using `getStaticProps`, Next.js fetches this JSON file (pre-computed at build time) and uses it as the props for the page component. This means that client-side page transitions will **not** call `getStaticProps` as only the exported JSON is used.\n\nWhen using Incremental Static Generation, `getStaticProps` will be executed in the background to generate the JSON needed for client-side navigation. You may see this in the form of multiple requests being made for the same page, however, this is intended and has no impact on end-user performance."
  },
  {
    "id": "01-get-static-props.mdx#10",
    "metadata": {
      "title": "getStaticProps",
      "description": "Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."
    },
    "content": "## Where can I use getStaticProps\n\n`getStaticProps` can only be exported from a **page**. You **cannot** export it from non-page files, `_app`, `_document`, or `_error`.\n\nOne of the reasons for this restriction is that React needs to have all the required data before the page is rendered.\n\nAlso, you must use export `getStaticProps` as a standalone function — it will **not** work if you add `getStaticProps` as a property of the page component.\n\n> **Good to know**: if you have created a [custom app](/docs/pages/building-your-application/routing/custom-app), ensure you are passing the `pageProps` to the page component as shown in the linked document, otherwise the props will be empty.\n\n## Runs on every request in development\n\nIn development (`next dev`), `getStaticProps` will be called on every request.\n\n## Preview Mode\n\nYou can temporarily bypass static generation and render the page at **request time** instead of build time using [**Preview Mode**](/docs/pages/guides/preview-mode). For example, you might be using a headless CMS and want to preview drafts before they're published."
  },
  {
    "id": "02-get-static-paths.mdx#0",
    "metadata": {
      "title": "getStaticPaths",
      "description": "Fetch data and generate static pages with `getStaticPaths`. Learn more about this API for data fetching in Next.js."
    },
    "content": "---\ntitle: getStaticPaths\ndescription: Fetch data and generate static pages with `getStaticPaths`. Learn more about this API for data fetching in Next.js.\n---\n\nIf a page has [Dynamic Routes](/docs/pages/building-your-application/routing/dynamic-routes) and uses `getStaticProps`, it needs to define a list of paths to be statically generated.\n\nWhen you export a function called `getStaticPaths` (Static Site Generation) from a page that uses dynamic routes, Next.js will statically pre-render all the paths specified by `getStaticPaths`.\n\n```tsx filename=\"pages/repo/[name].tsx\" switcher\nimport type {\n  InferGetStaticPropsType,\n  GetStaticProps,\n  GetStaticPaths,\n} from 'next'\n\ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n\nexport const getStaticPaths = (async () => {\n  return {\n    paths: [\n      {\n        params: {\n          name: 'next.js',\n        },\n      }, // See the \"paths\" section below\n    ],\n    fallback: true, // false or \"blocking\"\n  }\n}) satisfies GetStaticPaths"
  },
  {
    "id": "02-get-static-paths.mdx#1",
    "metadata": {
      "title": "getStaticPaths",
      "description": "Fetch data and generate static pages with `getStaticPaths`. Learn more about this API for data fetching in Next.js."
    },
    "content": "export const getStaticProps = (async (context) => {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}) satisfies GetStaticProps<{\n  repo: Repo\n}>\n\nexport default function Page({\n  repo,\n}: InferGetStaticPropsType<typeof getStaticProps>) {\n  return repo.stargazers_count\n}"
  },
  {
    "id": "02-get-static-paths.mdx#2",
    "metadata": {
      "title": "getStaticPaths",
      "description": "Fetch data and generate static pages with `getStaticPaths`. Learn more about this API for data fetching in Next.js."
    },
    "content": "```\n\n```jsx filename=\"pages/repo/[name].js\" switcher\nexport async function getStaticPaths() {\n  return {\n    paths: [\n      {\n        params: {\n          name: 'next.js',\n        },\n      }, // See the \"paths\" section below\n    ],\n    fallback: true, // false or \"blocking\"\n  }\n}\n\nexport async function getStaticProps() {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}\n\nexport default function Page({ repo }) {\n  return repo.stargazers_count\n}\n```\n\nThe [`getStaticPaths` API reference](/docs/pages/api-reference/functions/get-static-paths) covers all parameters and props that can be used with `getStaticPaths`."
  },
  {
    "id": "02-get-static-paths.mdx#3",
    "metadata": {
      "title": "getStaticPaths",
      "description": "Fetch data and generate static pages with `getStaticPaths`. Learn more about this API for data fetching in Next.js."
    },
    "content": "## When should I use getStaticPaths?\n\nYou should use `getStaticPaths` if you’re statically pre-rendering pages that use dynamic routes and:\n\n- The data comes from a headless CMS\n- The data comes from a database\n- The data comes from the filesystem\n- The data can be publicly cached (not user-specific)\n- The page must be pre-rendered (for SEO) and be very fast — `getStaticProps` generates `HTML` and `JSON` files, both of which can be cached by a CDN for performance\n\n## When does getStaticPaths run\n\n`getStaticPaths` will only run during build in production, it will not be called during runtime. You can validate code written inside `getStaticPaths` is removed from the client-side bundle [with this tool](https://next-code-elimination.vercel.app/).\n\n### How does getStaticProps run with regards to getStaticPaths\n\n- `getStaticProps` runs during `next build` for any `paths` returned during build\n- `getStaticProps` runs in the background when using `fallback: true`\n- `getStaticProps` is called before initial render when using `fallback: blocking`"
  },
  {
    "id": "02-get-static-paths.mdx#4",
    "metadata": {
      "title": "getStaticPaths",
      "description": "Fetch data and generate static pages with `getStaticPaths`. Learn more about this API for data fetching in Next.js."
    },
    "content": "## Where can I use getStaticPaths\n\n- `getStaticPaths` **must** be used with `getStaticProps`\n- You **cannot** use `getStaticPaths` with [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props)\n- You can export `getStaticPaths` from a [Dynamic Route](/docs/pages/building-your-application/routing/dynamic-routes) that also uses `getStaticProps`\n- You **cannot** export `getStaticPaths` from non-page file (e.g. your `components` folder)\n- You must export `getStaticPaths` as a standalone function, and not a property of the page component\n\n## Runs on every request in development\n\nIn development (`next dev`), `getStaticPaths` will be called on every request."
  },
  {
    "id": "02-get-static-paths.mdx#5",
    "metadata": {
      "title": "getStaticPaths",
      "description": "Fetch data and generate static pages with `getStaticPaths`. Learn more about this API for data fetching in Next.js."
    },
    "content": "## Generating paths on-demand\n\n`getStaticPaths` allows you to control which pages are generated during the build instead of on-demand with [`fallback`](/docs/pages/api-reference/functions/get-static-paths#fallback-blocking). Generating more pages during a build will cause slower builds.\n\nYou can defer generating all pages on-demand by returning an empty array for `paths`. This can be especially helpful when deploying your Next.js application to multiple environments. For example, you can have faster builds by generating all pages on-demand for previews (but not production builds). This is helpful for sites with hundreds/thousands of static pages.\n\n```jsx filename=\"pages/posts/[id].js\"\nexport async function getStaticPaths() {\n  // When this is true (in preview environments) don't\n  // prerender any static pages\n  // (faster builds, but slower initial page load)\n  if (process.env.SKIP_BUILD_STATIC_GENERATION) {\n    return {\n      paths: [],\n      fallback: 'blocking',\n    }\n  }\n\n  // Call an external API endpoint to get posts\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()"
  },
  {
    "id": "02-get-static-paths.mdx#6",
    "metadata": {
      "title": "getStaticPaths",
      "description": "Fetch data and generate static pages with `getStaticPaths`. Learn more about this API for data fetching in Next.js."
    },
    "content": "// Call an external API endpoint to get posts\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n\n  // Get the paths we want to prerender based on posts\n  // In production environments, prerender all pages\n  // (slower builds, but faster initial page load)\n  const paths = posts.map((post) => ({\n    params: { id: post.id },\n  }))\n\n  // { fallback: false } means other routes should 404\n  return { paths, fallback: false }\n}\n```"
  },
  {
    "id": "03-forms-and-mutations.mdx#0",
    "metadata": {
      "title": "Forms and Mutations",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "---\ntitle: Forms and Mutations\nnav_title: Forms and Mutations\ndescription: Learn how to handle form submissions and data mutations with Next.js.\n---\n\nForms enable you to create and update data in web applications. Next.js provides a powerful way to handle form submissions and data mutations using **API Routes**.\n\n> **Good to know:**\n>\n> - We will soon recommend [incrementally adopting](/docs/app/guides/migrating/app-router-migration) the App Router and using [Server Actions](/docs/app/getting-started/updating-data) for handling form submissions and data mutations. Server Actions allow you to define asynchronous server functions that can be called directly from your components, without needing to manually create an API Route.\n> - API Routes [do not specify CORS headers](https://developer.mozilla.org/docs/Web/HTTP/CORS), meaning they are same-origin only by default.\n> - Since API Routes run on the server, we're able to use sensitive values (like API keys) through [Environment Variables](/docs/pages/guides/environment-variables) without exposing them to the client. This is critical for the security of your application."
  },
  {
    "id": "03-forms-and-mutations.mdx#1",
    "metadata": {
      "title": "Forms and Mutations",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "## Examples\n\n### Redirecting\n\nIf you would like to redirect the user to a different route after a mutation, you can [`redirect`](/docs/pages/building-your-application/routing/api-routes#response-helpers) to any absolute or relative URL:\n\n```ts filename=\"pages/api/submit.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const id = await addPost()\n  res.redirect(307, `/post/${id}`)\n}\n```\n\n```js filename=\"pages/api/submit.js\" switcher\nexport default async function handler(req, res) {\n  const id = await addPost()\n  res.redirect(307, `/post/${id}`)\n}\n```"
  },
  {
    "id": "03-forms-and-mutations.mdx#2",
    "metadata": {
      "title": "Forms and Mutations",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "### Setting cookies\n\nYou can set cookies inside an API Route using the `setHeader` method on the response:\n\n```ts filename=\"pages/api/cookie.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  res.setHeader('Set-Cookie', 'username=lee; Path=/; HttpOnly')\n  res.status(200).send('Cookie has been set.')\n}\n```\n\n```js filename=\"pages/api/cookie.js\" switcher\nexport default async function handler(req, res) {\n  res.setHeader('Set-Cookie', 'username=lee; Path=/; HttpOnly')\n  res.status(200).send('Cookie has been set.')\n}\n```"
  },
  {
    "id": "03-forms-and-mutations.mdx#3",
    "metadata": {
      "title": "Forms and Mutations",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "### Reading cookies\n\nYou can read cookies inside an API Route using the [`cookies`](/docs/pages/building-your-application/routing/api-routes#request-helpers) request helper:\n\n```ts filename=\"pages/api/cookie.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const auth = req.cookies.authorization\n  // ...\n}\n```\n\n```js filename=\"pages/api/cookie.js\" switcher\nexport default async function handler(req, res) {\n  const auth = req.cookies.authorization\n  // ...\n}\n```"
  },
  {
    "id": "03-forms-and-mutations.mdx#4",
    "metadata": {
      "title": "Forms and Mutations",
      "description": "Learn how to handle form submissions and data mutations with Next.js."
    },
    "content": "### Deleting cookies\n\nYou can delete cookies inside an API Route using the `setHeader` method on the response:\n\n```ts filename=\"pages/api/cookie.ts\" switcher\nimport type { NextApiRequest, NextApiResponse } from 'next'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  res.setHeader('Set-Cookie', 'username=; Path=/; HttpOnly; Max-Age=0')\n  res.status(200).send('Cookie has been deleted.')\n}\n```\n\n```js filename=\"pages/api/cookie.js\" switcher\nexport default async function handler(req, res) {\n  res.setHeader('Set-Cookie', 'username=; Path=/; HttpOnly; Max-Age=0')\n  res.status(200).send('Cookie has been deleted.')\n}\n```"
  },
  {
    "id": "03-get-server-side-props.mdx#0",
    "metadata": {
      "title": "getServerSideProps",
      "description": "Fetch data on each request with `getServerSideProps`."
    },
    "content": "---\ntitle: getServerSideProps\ndescription: Fetch data on each request with `getServerSideProps`.\n---\n\n`getServerSideProps` is a Next.js function that can be used to fetch data and render the contents of a page at request time."
  },
  {
    "id": "03-get-server-side-props.mdx#1",
    "metadata": {
      "title": "getServerSideProps",
      "description": "Fetch data on each request with `getServerSideProps`."
    },
    "content": "## Example\n\nYou can use `getServerSideProps` by exporting it from a Page Component. The example below shows how you can fetch data from a 3rd party API in `getServerSideProps`, and pass the data to the page as props:\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport type { InferGetServerSidePropsType, GetServerSideProps } from 'next'\n\ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n\nexport const getServerSideProps = (async () => {\n  // Fetch data from external API\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo: Repo = await res.json()\n  // Pass data to the page via props\n  return { props: { repo } }\n}) satisfies GetServerSideProps<{ repo: Repo }>\n\nexport default function Page({\n  repo,\n}: InferGetServerSidePropsType<typeof getServerSideProps>) {\n  return (\n    <main>\n      <p>{repo.stargazers_count}</p>\n    </main>\n  )\n}"
  },
  {
    "id": "03-get-server-side-props.mdx#2",
    "metadata": {
      "title": "getServerSideProps",
      "description": "Fetch data on each request with `getServerSideProps`."
    },
    "content": "```\n\n```jsx filename=\"pages/index.js\" switcher\nexport async function getServerSideProps() {\n  // Fetch data from external API\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  // Pass data to the page via props\n  return { props: { repo } }\n}\n\nexport default function Page({ repo }) {\n  return (\n    <main>\n      <p>{repo.stargazers_count}</p>\n    </main>\n  )\n}\n```"
  },
  {
    "id": "03-get-server-side-props.mdx#3",
    "metadata": {
      "title": "getServerSideProps",
      "description": "Fetch data on each request with `getServerSideProps`."
    },
    "content": "## When should I use `getServerSideProps`?\n\nYou should use `getServerSideProps` if you need to render a page that relies on personalized user data, or information that can only be known at request time. For example, `authorization` headers or a geolocation.\n\nIf you do not need to fetch the data at request time, or would prefer to cache the data and pre-rendered HTML, we recommend using [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props)."
  },
  {
    "id": "03-get-server-side-props.mdx#4",
    "metadata": {
      "title": "getServerSideProps",
      "description": "Fetch data on each request with `getServerSideProps`."
    },
    "content": "## Behavior\n\n- `getServerSideProps` runs on the server.\n- `getServerSideProps` can only be exported from a **page**.\n- `getServerSideProps` returns JSON.\n- When a user visits a page, `getServerSideProps` will be used to fetch data at request time, and the data is used to render the initial HTML of the page.\n- `props` passed to the page component can be viewed on the client as part of the initial HTML. This is to allow the page to be [hydrated](https://react.dev/reference/react-dom/hydrate) correctly. Make sure that you don't pass any sensitive information that shouldn't be available on the client in `props`.\n- When a user visits the page through [`next/link`](/docs/pages/api-reference/components/link) or [`next/router`](/docs/pages/api-reference/functions/use-router), Next.js sends an API request to the server, which runs `getServerSideProps`.\n- You do not have to call a Next.js [API Route](/docs/pages/building-your-application/routing/api-routes) to fetch data when using `getServerSideProps` since the function runs on the server. Instead, you can call a CMS, database, or other third-party APIs directly from inside `getServerSideProps`."
  },
  {
    "id": "03-get-server-side-props.mdx#5",
    "metadata": {
      "title": "getServerSideProps",
      "description": "Fetch data on each request with `getServerSideProps`."
    },
    "content": "> **Good to know:**\n>\n> - See [`getServerSideProps` API reference](/docs/pages/api-reference/functions/get-server-side-props) for parameters and props that can be used with `getServerSideProps`.\n> - You can use the [next-code-elimination tool](https://next-code-elimination.vercel.app/) to verify what Next.js eliminates from the client-side bundle."
  },
  {
    "id": "03-get-server-side-props.mdx#6",
    "metadata": {
      "title": "getServerSideProps",
      "description": "Fetch data on each request with `getServerSideProps`."
    },
    "content": "## Error Handling\n\nIf an error is thrown inside `getServerSideProps`, it will show the `pages/500.js` file. Check out the documentation for [500 page](/docs/pages/building-your-application/routing/custom-error#500-page) to learn more on how to create it. During development, this file will not be used and the development error overlay will be shown instead."
  },
  {
    "id": "03-get-server-side-props.mdx#7",
    "metadata": {
      "title": "getServerSideProps",
      "description": "Fetch data on each request with `getServerSideProps`."
    },
    "content": "## Edge Cases\n\n### Caching with Server-Side Rendering (SSR)\n\nYou can use caching headers (`Cache-Control`) inside `getServerSideProps` to cache dynamic responses. For example, using [`stale-while-revalidate`](https://web.dev/stale-while-revalidate/).\n\n```jsx\n// This value is considered fresh for ten seconds (s-maxage=10).\n// If a request is repeated within the next 10 seconds, the previously\n// cached value will still be fresh. If the request is repeated before 59 seconds,\n// the cached value will be stale but still render (stale-while-revalidate=59).\n//\n// In the background, a revalidation request will be made to populate the cache\n// with a fresh value. If you refresh the page, you will see the new value.\nexport async function getServerSideProps({ req, res }) {\n  res.setHeader(\n    'Cache-Control',\n    'public, s-maxage=10, stale-while-revalidate=59'\n  )\n\n  return {\n    props: {},\n  }\n}\n```\n\nHowever, before reaching for `cache-control`, we recommend seeing if [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) with [ISR](/docs/pages/guides/incremental-static-regeneration) is a better fit for your use case."
  },
  {
    "id": "05-client-side.mdx#0",
    "metadata": {
      "title": "Client-side Fetching",
      "description": "Learn about client-side data fetching, and how to use SWR, a data fetching React Hook library that handles caching, revalidation, focus tracking, refetching on interval and more."
    },
    "content": "---\ntitle: Client-side Fetching\ndescription: Learn about client-side data fetching, and how to use SWR, a data fetching React Hook library that handles caching, revalidation, focus tracking, refetching on interval and more.\n---\n\nClient-side data fetching is useful when your page doesn't require SEO indexing, when you don't need to pre-render your data, or when the content of your pages needs to update frequently. Unlike the server-side rendering APIs, you can use client-side data fetching at the component level.\n\nIf done at the page level, the data is fetched at runtime, and the content of the page is updated as the data changes. When used at the component level, the data is fetched at the time of the component mount, and the content of the component is updated as the data changes.\n\nIt's important to note that using client-side data fetching can affect the performance of your application and the load speed of your pages. This is because the data fetching is done at the time of the component or pages mount, and the data is not cached."
  },
  {
    "id": "05-client-side.mdx#1",
    "metadata": {
      "title": "Client-side Fetching",
      "description": "Learn about client-side data fetching, and how to use SWR, a data fetching React Hook library that handles caching, revalidation, focus tracking, refetching on interval and more."
    },
    "content": "## Client-side data fetching with useEffect\n\nThe following example shows how you can fetch data on the client side using the useEffect hook.\n\n```jsx\nimport { useState, useEffect } from 'react'\n\nfunction Profile() {\n  const [data, setData] = useState(null)\n  const [isLoading, setLoading] = useState(true)\n\n  useEffect(() => {\n    fetch('/api/profile-data')\n      .then((res) => res.json())\n      .then((data) => {\n        setData(data)\n        setLoading(false)\n      })\n  }, [])\n\n  if (isLoading) return <p>Loading...</p>\n  if (!data) return <p>No profile data</p>\n\n  return (\n    <div>\n      <h1>{data.name}</h1>\n      <p>{data.bio}</p>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "05-client-side.mdx#2",
    "metadata": {
      "title": "Client-side Fetching",
      "description": "Learn about client-side data fetching, and how to use SWR, a data fetching React Hook library that handles caching, revalidation, focus tracking, refetching on interval and more."
    },
    "content": "## Client-side data fetching with SWR\n\nThe team behind Next.js has created a React Hook library for data fetching called [**SWR**](https://swr.vercel.app/). It is **highly recommended** if you are fetching data on the client-side. It handles caching, revalidation, focus tracking, refetching on intervals, and more.\n\nUsing the same example as above, we can now use SWR to fetch the profile data. SWR will automatically cache the data for us and will revalidate the data if it becomes stale.\n\nFor more information on using SWR, check out the [SWR docs](https://swr.vercel.app/docs/getting-started).\n\n```jsx\nimport useSWR from 'swr'\n\nconst fetcher = (...args) => fetch(...args).then((res) => res.json())\n\nfunction Profile() {\n  const { data, error } = useSWR('/api/profile-data', fetcher)\n\n  if (error) return <div>Failed to load</div>\n  if (!data) return <div>Loading...</div>\n\n  return (\n    <div>\n      <h1>{data.name}</h1>\n      <p>{data.bio}</p>\n    </div>\n  )\n}\n```"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Data Fetching",
      "description": "Next.js allows you to fetch data in multiple ways, with pre-rendering, server-side rendering or static-site generation, and incremental static regeneration. Learn how to manage your application data in Next.js."
    },
    "content": "---\ntitle: Data Fetching\ndescription: Next.js allows you to fetch data in multiple ways, with pre-rendering, server-side rendering or static-site generation, and incremental static regeneration. Learn how to manage your application data in Next.js.\n---\n\nData fetching in Next.js allows you to render your content in different ways, depending on your application's use case. These include pre-rendering with **Server-side Rendering** or **Static Generation**, and updating or creating content at runtime with **Incremental Static Regeneration**."
  },
  {
    "id": "index.mdx#1",
    "metadata": {
      "title": "Data Fetching",
      "description": "Next.js allows you to fetch data in multiple ways, with pre-rendering, server-side rendering or static-site generation, and incremental static regeneration. Learn how to manage your application data in Next.js."
    },
    "content": "## Examples"
  },
  {
    "id": "index.mdx#2",
    "metadata": {
      "title": "Data Fetching",
      "description": "Next.js allows you to fetch data in multiple ways, with pre-rendering, server-side rendering or static-site generation, and incremental static regeneration. Learn how to manage your application data in Next.js."
    },
    "content": "- [Agility CMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-agilitycms) ([Demo](https://next-blog-agilitycms.vercel.app/))\n- [Builder.io Example](https://github.com/vercel/next.js/tree/canary/examples/cms-builder-io) ([Demo](https://cms-builder-io.vercel.app/))\n- [ButterCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-buttercms) ([Demo](https://next-blog-buttercms.vercel.app/))\n- [Contentful Example](https://github.com/vercel/next.js/tree/canary/examples/cms-contentful) ([Demo](https://app-router-contentful.vercel.app/))\n- [Cosmic Example](https://github.com/vercel/next.js/tree/canary/examples/cms-cosmic) ([Demo](https://next-blog-cosmic.vercel.app/))\n- [DatoCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-datocms) ([Demo](https://next-blog-datocms.vercel.app/))\n- [DotCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-dotcms) ([Demo](https://nextjs-dotcms-blog.vercel.app/))\n- [Drupal Example](https://github.com/vercel/next.js/tree/canary/examples/cms-drupal) ([Demo](https://cms-drupal.vercel.app/))"
  },
  {
    "id": "index.mdx#3",
    "metadata": {
      "title": "Data Fetching",
      "description": "Next.js allows you to fetch data in multiple ways, with pre-rendering, server-side rendering or static-site generation, and incremental static regeneration. Learn how to manage your application data in Next.js."
    },
    "content": "- [Drupal Example](https://github.com/vercel/next.js/tree/canary/examples/cms-drupal) ([Demo](https://cms-drupal.vercel.app/))\n- [Enterspeed Example](https://github.com/vercel/next.js/tree/canary/examples/cms-enterspeed) ([Demo](https://next-blog-demo.enterspeed.com/))\n- [GraphCMS Example](https://github.com/vercel/next.js/tree/canary/examples/cms-graphcms) ([Demo](https://next-blog-graphcms.vercel.app/))\n- [Keystone Example](https://github.com/vercel/next.js/tree/canary/examples/cms-keystonejs-embedded) ([Demo](https://nextjs-keystone-demo.vercel.app/))\n- [Kontent.ai Example](https://github.com/vercel/next.js/tree/canary/examples/cms-kontent-ai) ([Demo](https://next-blog-kontent-ai.vercel.app/))\n- [Makeswift Example](https://github.com/vercel/next.js/tree/canary/examples/cms-makeswift) ([Demo](https://nextjs-makeswift-example.vercel.app/))\n- [Plasmic Example](https://github.com/vercel/next.js/tree/canary/examples/cms-plasmic) ([Demo](https://nextjs-plasmic-example.vercel.app/))\n- [Prepr Example](https://github.com/vercel/next.js/tree/canary/examples/cms-prepr) ([Demo](https://next-blog-prepr.vercel.app/))"
  },
  {
    "id": "index.mdx#4",
    "metadata": {
      "title": "Data Fetching",
      "description": "Next.js allows you to fetch data in multiple ways, with pre-rendering, server-side rendering or static-site generation, and incremental static regeneration. Learn how to manage your application data in Next.js."
    },
    "content": "- [Prepr Example](https://github.com/vercel/next.js/tree/canary/examples/cms-prepr) ([Demo](https://next-blog-prepr.vercel.app/))\n- [Prismic Example](https://github.com/vercel/next.js/tree/canary/examples/cms-prismic) ([Demo](https://next-blog-prismic.vercel.app/))\n- [Sanity Example](https://github.com/vercel/next.js/tree/canary/examples/cms-sanity) ([Demo](https://next-blog.sanity.build/))\n- [Sitecore XM Cloud Example](https://github.com/vercel/next.js/tree/canary/examples/cms-sitecore-xmcloud) ([Demo](https://vercel-sitecore-xmcloud-demo.vercel.app/))\n- [Storyblok Example](https://github.com/vercel/next.js/tree/canary/examples/cms-storyblok) ([Demo](https://next-blog-storyblok.vercel.app/))\n- [Strapi Example](https://github.com/vercel/next.js/tree/canary/examples/cms-strapi) ([Demo](https://next-blog-strapi.vercel.app/))\n- [TakeShape Example](https://github.com/vercel/next.js/tree/canary/examples/cms-takeshape) ([Demo](https://next-blog-takeshape.vercel.app/))\n- [Tina Example](https://github.com/vercel/next.js/tree/canary/examples/cms-tina) ([Demo](https://cms-tina-example.vercel.app/))"
  },
  {
    "id": "index.mdx#5",
    "metadata": {
      "title": "Data Fetching",
      "description": "Next.js allows you to fetch data in multiple ways, with pre-rendering, server-side rendering or static-site generation, and incremental static regeneration. Learn how to manage your application data in Next.js."
    },
    "content": "- [Tina Example](https://github.com/vercel/next.js/tree/canary/examples/cms-tina) ([Demo](https://cms-tina-example.vercel.app/))\n- [Umbraco Example](https://github.com/vercel/next.js/tree/canary/examples/cms-umbraco) ([Demo](https://nextjs-umbraco-sample-blog.vercel.app/))\n- [Umbraco Heartcore Example](https://github.com/vercel/next.js/tree/canary/examples/cms-umbraco-heartcore) ([Demo](https://next-blog-umbraco-heartcore.vercel.app/))\n- [Webiny Example](https://github.com/vercel/next.js/tree/canary/examples/cms-webiny) ([Demo](https://webiny-headlesscms-nextjs-example.vercel.app/))\n- [WordPress Example](https://github.com/vercel/next.js/tree/canary/examples/cms-wordpress) ([Demo](https://next-blog-wordpress.vercel.app/))\n- [Blog Starter Example](https://github.com/vercel/next.js/tree/canary/examples/blog-starter) ([Demo](https://next-blog-starter.vercel.app/))\n- [Static Tweet (Demo)](https://react-tweet.vercel.app/)"
  },
  {
    "id": "12-error-handling.mdx#0",
    "metadata": {
      "title": "Error Handling",
      "description": "Handle errors in your Next.js app."
    },
    "content": "---\ntitle: Error Handling\ndescription: Handle errors in your Next.js app.\n---\n\nThis documentation explains how you can handle development, server-side, and client-side errors.\n\n## Handling Errors in Development\n\nWhen there is a runtime error during the development phase of your Next.js application, you will encounter an **overlay**. It is a modal that covers the webpage. It is **only** visible when the development server runs using `next dev` via `pnpm dev`, `npm run dev`, `yarn dev`, or `bun dev` and will not be shown in production. Fixing the error will automatically dismiss the overlay.\n\nHere is an example of an overlay:\n\n{/* TODO UPDATE SCREENSHOT */}\n![Example of an overlay when in development mode](https://assets.vercel.com/image/upload/v1645118290/docs-assets/static/docs/error-handling/overlay.png)"
  },
  {
    "id": "12-error-handling.mdx#1",
    "metadata": {
      "title": "Error Handling",
      "description": "Handle errors in your Next.js app."
    },
    "content": "## Handling Server Errors\n\nNext.js provides a static 500 page by default to handle server-side errors that occur in your application. You can also [customize this page](/docs/pages/building-your-application/routing/custom-error#customizing-the-500-page) by creating a `pages/500.js` file.\n\nHaving a 500 page in your application does not show specific errors to the app user.\n\nYou can also use [404 page](/docs/pages/building-your-application/routing/custom-error#404-page) to handle specific runtime error like `file not found`."
  },
  {
    "id": "12-error-handling.mdx#2",
    "metadata": {
      "title": "Error Handling",
      "description": "Handle errors in your Next.js app."
    },
    "content": "## Handling Client Errors\n\nReact [Error Boundaries](https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary) is a graceful way to handle a JavaScript error on the client so that the other parts of the application continue working. In addition to preventing the page from crashing, it allows you to provide a custom fallback component and even log error information.\n\nTo use Error Boundaries for your Next.js application, you must create a class component `ErrorBoundary` and wrap the `Component` prop in the `pages/_app.js` file. This component will be responsible to:\n\n- Render a fallback UI after an error is thrown\n- Provide a way to reset the Application's state\n- Log error information\n\nYou can create an `ErrorBoundary` class component by extending `React.Component`. For example:\n\n```jsx\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props)\n\n    // Define a state variable to track whether is an error or not\n    this.state = { hasError: false }\n  }\n  static getDerivedStateFromError(error) {\n    // Update state so the next render will show the fallback UI"
  },
  {
    "id": "12-error-handling.mdx#3",
    "metadata": {
      "title": "Error Handling",
      "description": "Handle errors in your Next.js app."
    },
    "content": "return { hasError: true }\n  }\n  componentDidCatch(error, errorInfo) {\n    // You can use your own error logging service here\n    console.log({ error, errorInfo })\n  }\n  render() {\n    // Check if the error is thrown\n    if (this.state.hasError) {\n      // You can render any custom fallback UI\n      return (\n        <div>\n          <h2>Oops, there is an error!</h2>\n          <button\n            type=\"button\"\n            onClick={() => this.setState({ hasError: false })}\n          >\n            Try again?\n          </button>\n        </div>\n      )\n    }\n\n    // Return children components in case of no error\n\n    return this.props.children\n  }\n}\n\nexport default ErrorBoundary"
  },
  {
    "id": "12-error-handling.mdx#4",
    "metadata": {
      "title": "Error Handling",
      "description": "Handle errors in your Next.js app."
    },
    "content": "```\n\nThe `ErrorBoundary` component keeps track of an `hasError` state. The value of this state variable is a boolean. When the value of `hasError` is `true`, then the `ErrorBoundary` component will render a fallback UI. Otherwise, it will render the children components.\n\nAfter creating an `ErrorBoundary` component, import it in the `pages/_app.js` file to wrap the `Component` prop in your Next.js application.\n\n```jsx\n// Import the ErrorBoundary component\nimport ErrorBoundary from '../components/ErrorBoundary'\n\nfunction MyApp({ Component, pageProps }) {\n  return (\n    // Wrap the Component prop with ErrorBoundary component\n    <ErrorBoundary>\n      <Component {...pageProps} />\n    </ErrorBoundary>\n  )\n}\n\nexport default MyApp\n```\n\nYou can learn more about [Error Boundaries](https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary) in React's documentation."
  },
  {
    "id": "12-error-handling.mdx#5",
    "metadata": {
      "title": "Error Handling",
      "description": "Handle errors in your Next.js app."
    },
    "content": "### Reporting Errors\n\nTo monitor client errors, use a service like [Sentry](https://github.com/vercel/next.js/tree/canary/examples/with-sentry), Bugsnag or Datadog."
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Configuring",
      "description": "Learn how to configure your Next.js application."
    },
    "content": "---\ntitle: Configuring\ndescription: Learn how to configure your Next.js application.\n---\n\nNext.js allows you to customize your project to meet specific requirements. This includes integrations with TypeScript, ESlint, and more, as well as internal configuration options such as Absolute Imports and Environment Variables."
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Building Your Application",
      "description": "Learn how to use Next.js features to build your application."
    },
    "content": "---\ntitle: Building Your Application\ndescription: Learn how to use Next.js features to build your application.\n---"
  },
  {
    "id": "font.mdx#0",
    "metadata": {
      "title": "Font Module",
      "description": "API Reference for the Font Module"
    },
    "content": "---\ntitle: Font Module\nnav_title: Font\ndescription: API Reference for the Font Module\nsource: app/api-reference/components/font\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "form.mdx#0",
    "metadata": {
      "title": "Form",
      "description": "Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation."
    },
    "content": "---\ntitle: Form\ndescription: Learn how to use the `<Form>` component to handle form submissions and search params updates with client-side navigation.\nsource: app/api-reference/components/form\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "head.mdx#0",
    "metadata": {
      "title": "Head",
      "description": "Add custom elements to the `head` of your page with the built-in Head component."
    },
    "content": "---\ntitle: Head\ndescription: Add custom elements to the `head` of your page with the built-in Head component.\n---\n\nWe expose a built-in component for appending elements to the `head` of the page:\n\n```jsx\nimport Head from 'next/head'\n\nfunction IndexPage() {\n  return (\n    <div>\n      <Head>\n        <title>My page title</title>\n      </Head>\n      <p>Hello world!</p>\n    </div>\n  )\n}\n\nexport default IndexPage\n```"
  },
  {
    "id": "head.mdx#1",
    "metadata": {
      "title": "Head",
      "description": "Add custom elements to the `head` of your page with the built-in Head component."
    },
    "content": "## Avoid duplicated tags\n\nTo avoid duplicate tags in your `head` you can use the `key` property, which will make sure the tag is only rendered once, as in the following example:\n\n```jsx\nimport Head from 'next/head'\n\nfunction IndexPage() {\n  return (\n    <div>\n      <Head>\n        <title>My page title</title>\n        <meta property=\"og:title\" content=\"My page title\" key=\"title\" />\n      </Head>\n      <Head>\n        <meta property=\"og:title\" content=\"My new title\" key=\"title\" />\n      </Head>\n      <p>Hello world!</p>\n    </div>\n  )\n}\n\nexport default IndexPage\n```\n\nIn this case only the second `<meta property=\"og:title\" />` is rendered. `meta` tags with duplicate `key` attributes are automatically handled.\n\n> **Good to know**: `<title>` and `<base>` tags are automatically checked for duplicates by Next.js, so using key is not necessary for these tags.\n\n> The contents of `head` get cleared upon unmounting the component, so make sure each page completely defines what it needs in `head`, without making assumptions about what other pages added."
  },
  {
    "id": "head.mdx#2",
    "metadata": {
      "title": "Head",
      "description": "Add custom elements to the `head` of your page with the built-in Head component."
    },
    "content": "## Use minimal nesting\n\n`title`, `meta` or any other elements (e.g. `script`) need to be contained as **direct** children of the `Head` element,\nor wrapped into maximum one level of `<React.Fragment>` or arrays—otherwise the tags won't be correctly picked up on client-side navigations.\n\n## Use `next/script` for scripts\n\nWe recommend using [`next/script`](/docs/pages/guides/scripts) in your component instead of manually creating a `<script>` in `next/head`.\n\n## No `html` or `body` tags\n\nYou **cannot** use `<Head>` to set attributes on `<html>` or `<body>` tags. This will result in an `next-head-count is missing` error. `next/head` can only handle tags inside the HTML `<head>` tag."
  },
  {
    "id": "image-legacy.mdx#0",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "---\ntitle: Image (Legacy)\ndescription: Backwards compatible Image Optimization with the Legacy Image component.\nversion: legacy\n---\n\nStarting with Next.js 13, the `next/image` component was rewritten to improve both the performance and developer experience. In order to provide a backwards compatible upgrade solution, the old `next/image` was renamed to `next/legacy/image`.\n\n> **Warning**: `next/legacy/image` is deprecated and will be removed in a future version of Next.js. Please use [`next/image`](/docs/app/api-reference/components/image) instead."
  },
  {
    "id": "image-legacy.mdx#1",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "## Comparison\n\nCompared to `next/legacy/image`, the new `next/image` component has the following changes:\n\n- Removes `<span>` wrapper around `<img>` in favor of [native computed aspect ratio](https://caniuse.com/mdn-html_elements_img_aspect_ratio_computed_from_attributes)\n- Adds support for canonical `style` prop\n  - Removes `layout` prop in favor of `style` or `className`\n  - Removes `objectFit` prop in favor of `style` or `className`\n  - Removes `objectPosition` prop in favor of `style` or `className`\n- Removes `IntersectionObserver` implementation in favor of [native lazy loading](https://caniuse.com/loading-lazy-attr)\n  - Removes `lazyBoundary` prop since there is no native equivalent\n  - Removes `lazyRoot` prop since there is no native equivalent\n- Removes `loader` config in favor of [`loader`](#loader) prop\n- Changed `alt` prop from optional to required\n- Changed `onLoadingComplete` callback to receive reference to `<img>` element"
  },
  {
    "id": "image-legacy.mdx#2",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "## Required Props\n\nThe `<Image />` component requires the following properties.\n\n### src\n\nMust be one of the following:\n\n- A [statically imported](/docs/pages/api-reference/components/image#src) image file\n- A path string. This can be either an absolute external URL, or an internal path depending on the [loader](#loader) prop or [loader configuration](#loader-configuration).\n\nWhen using the default [loader](#loader), also consider the following for source images:\n\n- When src is an external URL, you must also configure [remotePatterns](#remote-patterns)\n- When src is [animated](#animated-images) or not a known format (JPEG, PNG, WebP, AVIF, GIF, TIFF) the image will be served as-is\n- When src is SVG format, it will be blocked unless `unoptimized` or `dangerouslyAllowSVG` is enabled"
  },
  {
    "id": "image-legacy.mdx#3",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### width\n\nThe `width` property can represent either the _rendered_ width or _original_ width in pixels, depending on the [`layout`](#layout) and [`sizes`](#sizes) properties.\n\nWhen using `layout=\"intrinsic\"` or `layout=\"fixed\"` the `width` property represents the _rendered_ width in pixels, so it will affect how large the image appears.\n\nWhen using `layout=\"responsive\"`, `layout=\"fill\"`, the `width` property represents the _original_ width in pixels, so it will only affect the aspect ratio.\n\nThe `width` property is required, except for [statically imported images](/docs/pages/api-reference/components/image#src), or those with `layout=\"fill\"`."
  },
  {
    "id": "image-legacy.mdx#4",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### height\n\nThe `height` property can represent either the _rendered_ height or _original_ height in pixels, depending on the [`layout`](#layout) and [`sizes`](#sizes) properties.\n\nWhen using `layout=\"intrinsic\"` or `layout=\"fixed\"` the `height` property represents the _rendered_ height in pixels, so it will affect how large the image appears.\n\nWhen using `layout=\"responsive\"`, `layout=\"fill\"`, the `height` property represents the _original_ height in pixels, so it will only affect the aspect ratio.\n\nThe `height` property is required, except for [statically imported images](/docs/pages/api-reference/components/image#src), or those with `layout=\"fill\"`."
  },
  {
    "id": "image-legacy.mdx#5",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "## Optional Props\n\nThe `<Image />` component accepts a number of additional properties beyond those which are required. This section describes the most commonly-used properties of the Image component. Find details about more rarely-used properties in the [Advanced Props](#advanced-props) section."
  },
  {
    "id": "image-legacy.mdx#6",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### layout\n\nThe layout behavior of the image as the viewport changes size."
  },
  {
    "id": "image-legacy.mdx#7",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "| `layout`              | Behavior                                                 | `srcSet`                                                                                                    | `sizes` | Has wrapper and sizer |\n| --------------------- | -------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- | ------- | --------------------- |\n| `intrinsic` (default) | Scale _down_ to fit width of container, up to image size | `1x`, `2x` (based on [imageSizes](#image-sizes))                                                            | N/A     | yes                   |\n| `fixed`               | Sized to `width` and `height` exactly                    | `1x`, `2x` (based on [imageSizes](#image-sizes))                                                            | N/A     | yes                   |\n| `responsive`          | Scale to fit width of container                          | `640w`, `750w`, ... `2048w`, `3840w` (based on [imageSizes](#image-sizes) and [deviceSizes](#device-sizes)) | `100vw` | yes                   |"
  },
  {
    "id": "image-legacy.mdx#8",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "| `fill`                | Grow in both X and Y axes to fill container              | `640w`, `750w`, ... `2048w`, `3840w` (based on [imageSizes](#image-sizes) and [deviceSizes](#device-sizes)) | `100vw` | yes                   |"
  },
  {
    "id": "image-legacy.mdx#9",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "- [Demo the `intrinsic` layout (default)](https://image-legacy-component.nextjs.gallery/layout-intrinsic)\n  - When `intrinsic`, the image will scale the dimensions down for smaller viewports, but maintain the original dimensions for larger viewports.\n- [Demo the `fixed` layout](https://image-legacy-component.nextjs.gallery/layout-fixed)\n  - When `fixed`, the image dimensions will not change as the viewport changes (no responsiveness) similar to the native `img` element.\n- [Demo the `responsive` layout](https://image-legacy-component.nextjs.gallery/layout-responsive)\n  - When `responsive`, the image will scale the dimensions down for smaller viewports and scale up for larger viewports.\n  - Ensure the parent element uses `display: block` in their stylesheet.\n- [Demo the `fill` layout](https://image-legacy-component.nextjs.gallery/layout-fill)\n  - When `fill`, the image will stretch both width and height to the dimensions of the parent element, provided the parent element is relative.\n  - This is usually paired with the [`objectFit`](#objectfit) property.\n  - Ensure the parent element has `position: relative` in their stylesheet."
  },
  {
    "id": "image-legacy.mdx#10",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "- This is usually paired with the [`objectFit`](#objectfit) property.\n  - Ensure the parent element has `position: relative` in their stylesheet.\n- [Demo background image](https://image-legacy-component.nextjs.gallery/background)"
  },
  {
    "id": "image-legacy.mdx#11",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### loader\n\nA custom function used to resolve URLs. Setting the loader as a prop on the Image component overrides the default loader defined in the [`images` section of `next.config.js`](#loader-configuration).\n\nA `loader` is a function returning a URL string for the image, given the following parameters:\n\n- [`src`](#src)\n- [`width`](#width)\n- [`quality`](#quality)\n\nHere is an example of using a custom loader:\n\n```js\nimport Image from 'next/legacy/image'\n\nconst myLoader = ({ src, width, quality }) => {\n  return `https://example.com/${src}?w=${width}&q=${quality || 75}`\n}\n\nconst MyImage = (props) => {\n  return (\n    <Image\n      loader={myLoader}\n      src=\"me.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    />\n  )\n}\n```"
  },
  {
    "id": "image-legacy.mdx#12",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### sizes\n\nA string that provides information about how wide the image will be at different breakpoints. The value of `sizes` will greatly affect performance for images using `layout=\"responsive\"` or `layout=\"fill\"`. It will be ignored for images using `layout=\"intrinsic\"` or `layout=\"fixed\"`.\n\nThe `sizes` property serves two important purposes related to image performance:\n\nFirst, the value of `sizes` is used by the browser to determine which size of the image to download, from `next/legacy/image`'s automatically-generated source set. When the browser chooses, it does not yet know the size of the image on the page, so it selects an image that is the same size or larger than the viewport. The `sizes` property allows you to tell the browser that the image will actually be smaller than full screen. If you don't specify a `sizes` value, a default value of `100vw` (full screen width) is used."
  },
  {
    "id": "image-legacy.mdx#13",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "Second, the `sizes` value is parsed and used to trim the values in the automatically-created source set. If the `sizes` property includes sizes such as `50vw`, which represent a percentage of the viewport width, then the source set is trimmed to not include any values which are too small to ever be necessary.\n\nFor example, if you know your styling will cause an image to be full-width on mobile devices, in a 2-column layout on tablets, and a 3-column layout on desktop displays, you should include a sizes property such as the following:\n\n```js\nimport Image from 'next/legacy/image'\nconst Example = () => (\n  <div className=\"grid-element\">\n    <Image\n      src=\"/example.png\"\n      layout=\"fill\"\n      sizes=\"(max-width: 768px) 100vw,\n              (max-width: 1200px) 50vw,\n              33vw\"\n    />\n  </div>\n)"
  },
  {
    "id": "image-legacy.mdx#14",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "```\n\nThis example `sizes` could have a dramatic effect on performance metrics. Without the `33vw` sizes, the image selected from the server would be 3 times as wide as it needs to be. Because file size is proportional to the square of the width, without `sizes` the user would download an image that's 9 times larger than necessary.\n\nLearn more about `srcset` and `sizes`:\n\n- [web.dev](https://web.dev/learn/design/responsive-images/#sizes)\n- [mdn](https://developer.mozilla.org/docs/Web/HTML/Element/img#attr-sizes)"
  },
  {
    "id": "image-legacy.mdx#15",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### quality\n\nThe quality of the optimized image, an integer between `1` and `100` where `100` is the best quality. Defaults to `75`.\n\n### priority\n\nWhen true, the image will be considered high priority and\n[preload](https://web.dev/preload-responsive-images/). Lazy loading is automatically disabled for images using `priority`.\n\nYou should use the `priority` property on any image detected as the [Largest Contentful Paint (LCP)](https://nextjs.org/learn/seo/web-performance/lcp) element. It may be appropriate to have multiple priority images, as different images may be the LCP element for different viewport sizes.\n\nShould only be used when the image is visible above the fold. Defaults to `false`."
  },
  {
    "id": "image-legacy.mdx#16",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### placeholder\n\nA placeholder to use while the image is loading. Possible values are `blur` or `empty`. Defaults to `empty`.\n\nWhen `blur`, the [`blurDataURL`](#blurdataurl) property will be used as the placeholder. If `src` is an object from a [static import](/docs/pages/api-reference/components/image#src) and the imported image is `.jpg`, `.png`, `.webp`, or `.avif`, then `blurDataURL` will be automatically populated.\n\nFor dynamic images, you must provide the [`blurDataURL`](#blurdataurl) property. Solutions such as [Plaiceholder](https://github.com/joe-bell/plaiceholder) can help with `base64` generation.\n\nWhen `empty`, there will be no placeholder while the image is loading, only empty space.\n\nTry it out:\n\n- [Demo the `blur` placeholder](https://image-legacy-component.nextjs.gallery/placeholder)\n- [Demo the shimmer effect with `blurDataURL` prop](https://image-legacy-component.nextjs.gallery/shimmer)\n- [Demo the color effect with `blurDataURL` prop](https://image-legacy-component.nextjs.gallery/color)"
  },
  {
    "id": "image-legacy.mdx#17",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "## Advanced Props\n\nIn some cases, you may need more advanced usage. The `<Image />` component optionally accepts the following advanced properties.\n\n### style\n\nAllows [passing CSS styles](https://developer.mozilla.org/docs/Web/HTML/Element/style) to the underlying image element.\n\nNote that all `layout` modes apply their own styles to the image element, and these automatic styles take precedence over the `style` prop.\n\nAlso keep in mind that the required `width` and `height` props can interact with your styling. If you use styling to modify an image's `width`, you must set the `height=\"auto\"` style as well, or your image will be distorted.\n\n### objectFit\n\nDefines how the image will fit into its parent container when using `layout=\"fill\"`.\n\nThis value is passed to the [object-fit CSS property](https://developer.mozilla.org/docs/Web/CSS/object-fit) for the `src` image.\n\n### objectPosition\n\nDefines how the image is positioned within its parent element when using `layout=\"fill\"`.\n\nThis value is passed to the [object-position CSS property](https://developer.mozilla.org/docs/Web/CSS/object-position) applied to the image."
  },
  {
    "id": "image-legacy.mdx#18",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### onLoadingComplete\n\nA callback function that is invoked once the image is completely loaded and the [placeholder](#placeholder) has been removed.\n\nThe `onLoadingComplete` function accepts one parameter, an object with the following properties:\n\n- [`naturalWidth`](https://developer.mozilla.org/docs/Web/API/HTMLImageElement/naturalWidth)\n- [`naturalHeight`](https://developer.mozilla.org/docs/Web/API/HTMLImageElement/naturalHeight)\n\n### loading\n\nThe loading behavior of the image. Defaults to `lazy`.\n\nWhen `lazy`, defer loading the image until it reaches a calculated distance from\nthe viewport.\n\nWhen `eager`, load the image immediately.\n\n[Learn more](https://developer.mozilla.org/docs/Web/HTML/Element/img#attr-loading)"
  },
  {
    "id": "image-legacy.mdx#19",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### blurDataURL\n\nA [Data URL](https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/Data_URIs) to\nbe used as a placeholder image before the `src` image successfully loads. Only takes effect when combined\nwith [`placeholder=\"blur\"`](#placeholder).\n\nMust be a base64-encoded image. It will be enlarged and blurred, so a very small image (10px or\nless) is recommended. Including larger images as placeholders may harm your application performance.\n\nTry it out:\n\n- [Demo the default `blurDataURL` prop](https://image-legacy-component.nextjs.gallery/placeholder)\n- [Demo the shimmer effect with `blurDataURL` prop](https://image-legacy-component.nextjs.gallery/shimmer)\n- [Demo the color effect with `blurDataURL` prop](https://image-legacy-component.nextjs.gallery/color)\n\nYou can also [generate a solid color Data URL](https://png-pixel.com) to match the image."
  },
  {
    "id": "image-legacy.mdx#20",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### lazyBoundary\n\nA string (with similar syntax to the margin property) that acts as the bounding box used to detect the intersection of the viewport with the image and trigger lazy [loading](#loading). Defaults to `\"200px\"`.\n\nIf the image is nested in a scrollable parent element other than the root document, you will also need to assign the [lazyRoot](#lazyroot) prop.\n\n[Learn more](https://developer.mozilla.org/docs/Web/API/IntersectionObserver/rootMargin)"
  },
  {
    "id": "image-legacy.mdx#21",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### lazyRoot\n\nA React [Ref](https://react.dev/learn/referencing-values-with-refs) pointing to the scrollable parent element. Defaults to `null` (the document viewport).\n\nThe Ref must point to a DOM element or a React component that [forwards the Ref](https://react.dev/reference/react/forwardRef) to the underlying DOM element.\n\n**Example pointing to a DOM element**\n\n```jsx\nimport Image from 'next/legacy/image'\nimport React from 'react'\n\nconst Example = () => {\n  const lazyRoot = React.useRef(null)\n\n  return (\n    <div ref={lazyRoot} style={{ overflowX: 'scroll', width: '500px' }}>\n      <Image lazyRoot={lazyRoot} src=\"/one.jpg\" width=\"500\" height=\"500\" />\n      <Image lazyRoot={lazyRoot} src=\"/two.jpg\" width=\"500\" height=\"500\" />\n    </div>\n  )\n}"
  },
  {
    "id": "image-legacy.mdx#22",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "```\n\n**Example pointing to a React component**\n\n```jsx\nimport Image from 'next/legacy/image'\nimport React from 'react'\n\nconst Container = React.forwardRef((props, ref) => {\n  return (\n    <div ref={ref} style={{ overflowX: 'scroll', width: '500px' }}>\n      {props.children}\n    </div>\n  )\n})\n\nconst Example = () => {\n  const lazyRoot = React.useRef(null)\n\n  return (\n    <Container ref={lazyRoot}>\n      <Image lazyRoot={lazyRoot} src=\"/one.jpg\" width=\"500\" height=\"500\" />\n      <Image lazyRoot={lazyRoot} src=\"/two.jpg\" width=\"500\" height=\"500\" />\n    </Container>\n  )\n}\n```\n\n[Learn more](https://developer.mozilla.org/docs/Web/API/IntersectionObserver/root)"
  },
  {
    "id": "image-legacy.mdx#23",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### unoptimized\n\nWhen true, the source image will be served as-is from the `src` instead of changing quality, size, or format. Defaults to `false`.\n\nThis is useful for images that do not benefit from optimization such as small images (less than 1KB), vector images (SVG), or animated images (GIF).\n\n```js\nimport Image from 'next/image'\n\nconst UnoptimizedImage = (props) => {\n  return <Image {...props} unoptimized />\n}\n```\n\nSince Next.js 12.3.0, this prop can be assigned to all images by updating `next.config.js` with the following configuration:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    unoptimized: true,\n  },\n}\n```"
  },
  {
    "id": "image-legacy.mdx#24",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "## Other Props\n\nOther properties on the `<Image />` component will be passed to the underlying\n`img` element with the exception of the following:\n\n- `srcSet`. Use\n  [Device Sizes](#device-sizes)\n  instead.\n- `ref`. Use [`onLoadingComplete`](#onloadingcomplete) instead.\n- `decoding`. It is always `\"async\"`."
  },
  {
    "id": "image-legacy.mdx#25",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "## Configuration Options"
  },
  {
    "id": "image-legacy.mdx#26",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### Remote Patterns\n\nTo protect your application from malicious users, configuration is required in order to use external images. This ensures that only external images from your account can be served from the Next.js Image Optimization API. These external images can be configured with the `remotePatterns` property in your `next.config.js` file, as shown below:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 'example.com',\n        port: '',\n        pathname: '/account123/**',\n        search: '',\n      },\n    ],\n  },\n}"
  },
  {
    "id": "image-legacy.mdx#27",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "```\n\n> **Good to know**: The example above will ensure the `src` property of `next/legacy/image` must start with `https://example.com/account123/` and must not have a query string. Any other protocol, hostname, port, or unmatched path will respond with 400 Bad Request.\n\nBelow is an example of the `remotePatterns` property in the `next.config.js` file using a wildcard pattern in the `hostname`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: '**.example.com',\n        port: '',\n        search: '',\n      },\n    ],\n  },\n}"
  },
  {
    "id": "image-legacy.mdx#28",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "```\n\n> **Good to know**: The example above will ensure the `src` property of `next/legacy/image` must start with `https://img1.example.com` or `https://me.avatar.example.com` or any number of subdomains. It cannot have a port or query string. Any other protocol or unmatched hostname will respond with 400 Bad Request.\n\nWildcard patterns can be used for both `pathname` and `hostname` and have the following syntax:\n\n- `*` match a single path segment or subdomain\n- `**` match any number of path segments at the end or subdomains at the beginning\n\nThe `**` syntax does not work in the middle of the pattern.\n\n> **Good to know**: When omitting `protocol`, `port`, `pathname`, or `search` then the wildcard `**` is implied. This is not recommended because it may allow malicious actors to optimize urls you did not intend.\n\nBelow is an example of the `remotePatterns` property in the `next.config.js` file using `search`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 'assets.example.com',\n        search: '?v=1727111025337',\n      },\n    ],\n  },\n}"
  },
  {
    "id": "image-legacy.mdx#29",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "```\n\n> **Good to know**: The example above will ensure the `src` property of `next/legacy/image` must start with `https://assets.example.com` and must have the exact query string `?v=1727111025337`. Any other protocol or query string will respond with 400 Bad Request."
  },
  {
    "id": "image-legacy.mdx#30",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### Domains\n\n> **Warning**: Deprecated since Next.js 14 in favor of strict [`remotePatterns`](#remote-patterns) in order to protect your application from malicious users. Only use `domains` if you own all the content served from the domain.\n\nSimilar to [`remotePatterns`](#remote-patterns), the `domains` configuration can be used to provide a list of allowed hostnames for external images.\n\nHowever, the `domains` configuration does not support wildcard pattern matching and it cannot restrict protocol, port, or pathname.\n\nBelow is an example of the `domains` property in the `next.config.js` file:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    domains: ['assets.acme.com'],\n  },\n}\n```"
  },
  {
    "id": "image-legacy.mdx#31",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### Loader Configuration\n\nIf you want to use a cloud provider to optimize images instead of using the Next.js built-in Image Optimization API, you can configure the `loader` and `path` prefix in your `next.config.js` file. This allows you to use relative URLs for the Image [`src`](#src) and automatically generate the correct absolute URL for your provider.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    loader: 'imgix',\n    path: 'https://example.com/myaccount/',\n  },\n}\n```\n\n#### Customizing the Built-in Image Path\n\nIf you want to change or prefix the default path for the built-in Next.js image optimization, you can do so with the `path` property. The default value for `path` is `/_next/image`.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    path: '/my-prefix/_next/image',\n  },\n}\n```"
  },
  {
    "id": "image-legacy.mdx#32",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### Built-in Loaders\n\nThe following Image Optimization cloud providers are included:\n\n- Default: Works automatically with `next dev`, `next start`, or a custom server\n- [Vercel](https://vercel.com): Works automatically when you deploy on Vercel, no configuration necessary. [Learn more](https://vercel.com/docs/concepts/image-optimization?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)\n- [Imgix](https://www.imgix.com): `loader: 'imgix'`\n- [Cloudinary](https://cloudinary.com): `loader: 'cloudinary'`\n- [Akamai](https://www.akamai.com): `loader: 'akamai'`\n- Custom: `loader: 'custom'` use a custom cloud provider by implementing the [`loader`](#loader) prop on the `next/legacy/image` component\n\nIf you need a different provider, you can use the [`loader`](#loader) prop with `next/legacy/image`.\n\n> Images can not be optimized at build time using [`output: 'export'`](/docs/pages/guides/static-exports), only on-demand. To use `next/legacy/image` with `output: 'export'`, you will need to use a different loader than the default. [Read more in the discussion.](https://github.com/vercel/next.js/discussions/19065)"
  },
  {
    "id": "image-legacy.mdx#33",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "## Advanced\n\nThe following configuration is for advanced use cases and is usually not necessary. If you choose to configure the properties below, you will override any changes to the Next.js defaults in future updates.\n\n### Device Sizes\n\nIf you know the expected device widths of your users, you can specify a list of device width breakpoints using the `deviceSizes` property in `next.config.js`. These widths are used when the `next/legacy/image` component uses `layout=\"responsive\"` or `layout=\"fill\"` to ensure the correct image is served for user's device.\n\nIf no configuration is provided, the default below is used.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],\n  },\n}\n```"
  },
  {
    "id": "image-legacy.mdx#34",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### Image Sizes\n\nYou can specify a list of image widths using the `images.imageSizes` property in your `next.config.js` file. These widths are concatenated with the array of [device sizes](#device-sizes) to form the full array of sizes used to generate image [srcset](https://developer.mozilla.org/docs/Web/API/HTMLImageElement/srcset)s.\n\nThe reason there are two separate lists is that imageSizes is only used for images which provide a [`sizes`](#sizes) prop, which indicates that the image is less than the full width of the screen. **Therefore, the sizes in imageSizes should all be smaller than the smallest size in deviceSizes.**\n\nIf no configuration is provided, the default below is used.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    imageSizes: [32, 48, 64, 96, 128, 256, 384],\n  },\n}\n```"
  },
  {
    "id": "image-legacy.mdx#35",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### Acceptable Formats\n\nThe default [Image Optimization API](#loader-configuration) will automatically detect the browser's supported image formats via the request's `Accept` header in order to determine the best output format.\n\nIf the `Accept` header matches more than one of the configured formats, the first match in the array is used. Therefore, the array order matters. If there is no match (or the source image is [animated](#animated-images)), the Image Optimization API will fallback to the original image's format.\n\nIf no configuration is provided, the default below is used.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    formats: ['image/webp'],\n  },\n}\n```\n\nYou can enable AVIF support, which will fallback to the original format of the src image if the browser [does not support AVIF](https://caniuse.com/avif):\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    formats: ['image/avif'],\n  },\n}"
  },
  {
    "id": "image-legacy.mdx#36",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "```\n\n> **Good to know**:\n>\n> - We still recommend using WebP for most use cases.\n> - AVIF generally takes 50% longer to encode but it compresses 20% smaller compared to WebP. This means that the first time an image is requested, it will typically be slower and then subsequent requests that are cached will be faster.\n> - If you self-host with a Proxy/CDN in front of Next.js, you must configure the Proxy to forward the `Accept` header."
  },
  {
    "id": "image-legacy.mdx#37",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "## Caching Behavior\n\nThe following describes the caching algorithm for the default [loader](#loader). For all other loaders, please refer to your cloud provider's documentation.\n\nImages are optimized dynamically upon request and stored in the `<distDir>/cache/images` directory. The optimized image file will be served for subsequent requests until the expiration is reached. When a request is made that matches a cached but expired file, the expired image is served stale immediately. Then the image is optimized again in the background (also called revalidation) and saved to the cache with the new expiration date.\n\nThe cache status of an image can be determined by reading the value of the `x-nextjs-cache` (`x-vercel-cache` when deployed on Vercel) response header. The possible values are the following:\n\n- `MISS` - the path is not in the cache (occurs at most once, on the first visit)\n- `STALE` - the path is in the cache but exceeded the revalidate time so it will be updated in the background\n- `HIT` - the path is in the cache and has not exceeded the revalidate time"
  },
  {
    "id": "image-legacy.mdx#38",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "The expiration (or rather Max Age) is defined by either the [`minimumCacheTTL`](#minimum-cache-ttl) configuration or the upstream image `Cache-Control` header, whichever is larger. Specifically, the `max-age` value of the `Cache-Control` header is used. If both `s-maxage` and `max-age` are found, then `s-maxage` is preferred. The `max-age` is also passed-through to any downstream clients including CDNs and browsers.\n\n- You can configure [`minimumCacheTTL`](#minimum-cache-ttl) to increase the cache duration when the upstream image does not include `Cache-Control` header or the value is very low.\n- You can configure [`deviceSizes`](#device-sizes) and [`imageSizes`](#image-sizes) to reduce the total number of possible generated images.\n- You can configure [formats](#acceptable-formats) to disable multiple formats in favor of a single image format."
  },
  {
    "id": "image-legacy.mdx#39",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### Minimum Cache TTL\n\nYou can configure the Time to Live (TTL) in seconds for cached optimized images. In many cases, it's better to use a [Static Image Import](/docs/pages/api-reference/components/image#src) which will automatically hash the file contents and cache the image forever with a `Cache-Control` header of `immutable`.\n\nIf no configuration is provided, the default below is used.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    minimumCacheTTL: 14400, // 4 hours\n  },\n}\n```\n\nYou can increase the TTL to reduce the number of revalidations and potentially lower cost:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    minimumCacheTTL: 2678400, // 31 days\n  },\n}"
  },
  {
    "id": "image-legacy.mdx#40",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "```\n\nThe expiration (or rather Max Age) of the optimized image is defined by either the `minimumCacheTTL` or the upstream image `Cache-Control` header, whichever is larger.\n\nIf you need to change the caching behavior per image, you can configure [`headers`](/docs/pages/api-reference/config/next-config-js/headers) to set the `Cache-Control` header on the upstream image (e.g. `/some-asset.jpg`, not `/_next/image` itself).\n\nThere is no mechanism to invalidate the cache at this time, so its best to keep `minimumCacheTTL` low. Otherwise you may need to manually change the [`src`](#src) prop or delete `<distDir>/cache/images`."
  },
  {
    "id": "image-legacy.mdx#41",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### Disable Static Imports\n\nThe default behavior allows you to import static files such as `import icon from './icon.png'` and then pass that to the `src` property.\n\nIn some cases, you may wish to disable this feature if it conflicts with other plugins that expect the import to behave differently.\n\nYou can disable static image imports inside your `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    disableStaticImages: true,\n  },\n}\n```"
  },
  {
    "id": "image-legacy.mdx#42",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### Dangerously Allow SVG\n\nThe default [loader](#loader) does not optimize SVG images for a few reasons. First, SVG is a vector format meaning it can be resized losslessly. Second, SVG has many of the same features as HTML/CSS, which can lead to vulnerabilities without proper [Content Security Policy (CSP) headers](/docs/app/api-reference/config/next-config-js/headers#content-security-policy).\n\nTherefore, we recommended using the [`unoptimized`](#unoptimized) prop when the [`src`](#src) prop is known to be SVG. This happens automatically when `src` ends with `\".svg\"`.\n\nHowever, if you need to serve SVG images with the default Image Optimization API, you can set `dangerouslyAllowSVG` inside your `next.config.js`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    dangerouslyAllowSVG: true,\n    contentDispositionType: 'attachment',\n    contentSecurityPolicy: \"default-src 'self'; script-src 'none'; sandbox;\",\n  },\n}\n```\n\nIn addition, it is strongly recommended to also set `contentDispositionType` to force the browser to download the image, as well as `contentSecurityPolicy` to prevent scripts embedded in the image from executing."
  },
  {
    "id": "image-legacy.mdx#43",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "### `contentDispositionType`\n\nThe default [loader](#loader) sets the [`Content-Disposition`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition#as_a_response_header_for_the_main_body) header to `attachment` for added protection since the API can serve arbitrary remote images.\n\nThe default value is `attachment` which forces the browser to download the image when visiting directly. This is particularly important when [`dangerouslyAllowSVG`](#dangerously-allow-svg) is true.\n\nYou can optionally configure `inline` to allow the browser to render the image when visiting directly, without downloading it.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  images: {\n    contentDispositionType: 'inline',\n  },\n}\n```\n\n### Animated Images\n\nThe default [loader](#loader) will automatically bypass Image Optimization for animated images and serve the image as-is.\n\nAuto-detection for animated files is best-effort and supports GIF, APNG, and WebP. If you want to explicitly bypass Image Optimization for a given animated image, use the [unoptimized](#unoptimized) prop."
  },
  {
    "id": "image-legacy.mdx#44",
    "metadata": {
      "title": "Image (Legacy)",
      "description": "Backwards compatible Image Optimization with the Legacy Image component."
    },
    "content": "## Version History\n\n| Version   | Changes                                                                                                             |\n| --------- | ------------------------------------------------------------------------------------------------------------------- |\n| `v16.0.0` | `next/legacy/image` deprecated and will be removed in a future version of Next.js. Please use `next/image` instead. |\n| `v13.0.0` | `next/image` renamed to `next/legacy/image`                                                                         |"
  },
  {
    "id": "image.mdx#0",
    "metadata": {
      "title": "Image",
      "description": "Optimize Images in your Next.js Application using the built-in `next/image` Component."
    },
    "content": "---\ntitle: Image\ndescription: Optimize Images in your Next.js Application using the built-in `next/image` Component.\nsource: app/api-reference/components/image\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Components",
      "description": "API Reference for Next.js built-in components in the Pages Router."
    },
    "content": "---\ntitle: Components\ndescription: API Reference for Next.js built-in components in the Pages Router.\nsource: app/api-reference/components\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "link.mdx#0",
    "metadata": {
      "title": "Link",
      "description": "API reference for the `<Link>` component."
    },
    "content": "---\ntitle: Link\ndescription: API reference for the `<Link>` component.\nsource: app/api-reference/components/link\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "script.mdx#0",
    "metadata": {
      "title": "Script",
      "description": "Optimize third-party scripts in your Next.js application using the built-in `next/script` Component."
    },
    "content": "---\ntitle: Script\ndescription: Optimize third-party scripts in your Next.js application using the built-in `next/script` Component.\nsource: app/api-reference/components/script\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "File-system conventions",
      "description": "API Reference for Next.js file-system conventions."
    },
    "content": "---\ntitle: File-system conventions\ndescription: API Reference for Next.js file-system conventions.\n---"
  },
  {
    "id": "instrumentation.mdx#0",
    "metadata": {
      "title": "instrumentation.js",
      "description": "API reference for the instrumentation.js file."
    },
    "content": "---\ntitle: instrumentation.js\ndescription: API reference for the instrumentation.js file.\nsource: app/api-reference/file-conventions/instrumentation\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "proxy.mdx#0",
    "metadata": {
      "title": "Proxy",
      "description": "Learn how to use Proxy to run code before a request is completed."
    },
    "content": "---\ntitle: Proxy\ndescription: Learn how to use Proxy to run code before a request is completed.\nsource: app/api-reference/file-conventions/proxy\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "public-folder.mdx#0",
    "metadata": {
      "title": "public Folder",
      "description": "Next.js allows you to serve static files, like images, in the public directory. You can learn how it works here."
    },
    "content": "---\ntitle: public Folder\nnav_title: public\ndescription: Next.js allows you to serve static files, like images, in the public directory. You can learn how it works here.\nsource: app/api-reference/file-conventions/public-folder\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "src-folder.mdx#0",
    "metadata": {
      "title": "src Directory",
      "description": "Save pages under the `src` folder as an alternative to the root `pages` directory."
    },
    "content": "---\ntitle: src Directory\ndescription: Save pages under the `src` folder as an alternative to the root `pages` directory.\nsource: app/api-reference/file-conventions/src-folder\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "get-initial-props.mdx#0",
    "metadata": {
      "title": "getInitialProps",
      "description": "Fetch dynamic data on the server for your React component with getInitialProps."
    },
    "content": "---\ntitle: getInitialProps\ndescription: Fetch dynamic data on the server for your React component with getInitialProps.\n---\n\n> **Good to know**: `getInitialProps` is a legacy API. We recommend using [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props) or [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props) instead.\n\n`getInitialProps` is an `async` function that can be added to the default exported React component for the page. It will run on both the server-side and again on the client-side during page transitions. The result of the function will be forwarded to the React component as `props`.\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport { NextPageContext } from 'next'\n\nPage.getInitialProps = async (ctx: NextPageContext) => {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const json = await res.json()\n  return { stars: json.stargazers_count }\n}\n\nexport default function Page({ stars }: { stars: number }) {\n  return stars\n}"
  },
  {
    "id": "get-initial-props.mdx#1",
    "metadata": {
      "title": "getInitialProps",
      "description": "Fetch dynamic data on the server for your React component with getInitialProps."
    },
    "content": "```\n\n```jsx filename=\"pages/index.js\" switcher\nPage.getInitialProps = async (ctx) => {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const json = await res.json()\n  return { stars: json.stargazers_count }\n}\n\nexport default function Page({ stars }) {\n  return stars\n}\n```\n\n> **Good to know**:\n>\n> - Data returned from `getInitialProps` is serialized when server rendering. Ensure the returned object from `getInitialProps` is a plain `Object`, and not using `Date`, `Map` or `Set`.\n> - For the initial page load, `getInitialProps` will run on the server only. `getInitialProps` will then also run on the client when navigating to a different route with the [`next/link`](/docs/pages/api-reference/components/link) component or by using [`next/router`](/docs/pages/api-reference/functions/use-router).\n> - If `getInitialProps` is used in a custom `_app.js`, and the page being navigated to is using `getServerSideProps`, then `getInitialProps` will also run on the server."
  },
  {
    "id": "get-initial-props.mdx#2",
    "metadata": {
      "title": "getInitialProps",
      "description": "Fetch dynamic data on the server for your React component with getInitialProps."
    },
    "content": "## Context Object\n\n`getInitialProps` receives a single argument called `context`, which is an object with the following properties:\n\n| Name       | Description                                                                                           |\n| ---------- | ----------------------------------------------------------------------------------------------------- |\n| `pathname` | Current route, the path of the page in `/pages`                                                       |\n| `query`    | Query string of the URL, parsed as an object                                                          |\n| `asPath`   | `String` of the actual path (including the query) shown in the browser                                |\n| `req`      | [HTTP request object](https://nodejs.org/api/http.html#http_class_http_incomingmessage) (server only) |\n| `res`      | [HTTP response object](https://nodejs.org/api/http.html#http_class_http_serverresponse) (server only) |\n| `err`      | Error object if any error is encountered during the rendering                                         |"
  },
  {
    "id": "get-initial-props.mdx#3",
    "metadata": {
      "title": "getInitialProps",
      "description": "Fetch dynamic data on the server for your React component with getInitialProps."
    },
    "content": "## Caveats\n\n- `getInitialProps` can only be used in `pages/` top level files, and not in nested components. To have nested data fetching at the component level, consider exploring the [App Router](/docs/app/getting-started/fetching-data).\n- Regardless of whether your route is static or dynamic, any data returned from `getInitialProps` as `props` will be able to be examined on the client-side in the initial HTML. This is to allow the page to be [hydrated](https://react.dev/reference/react-dom/hydrate) correctly. Make sure that you don't pass any sensitive information that shouldn't be available on the client in `props`."
  },
  {
    "id": "get-server-side-props.mdx#0",
    "metadata": {
      "title": "getServerSideProps",
      "description": "API reference for `getServerSideProps`. Learn how to fetch data on each request with Next.js."
    },
    "content": "---\ntitle: getServerSideProps\ndescription: API reference for `getServerSideProps`. Learn how to fetch data on each request with Next.js.\n---\n\nWhen exporting a function called `getServerSideProps` (Server-Side Rendering) from a page, Next.js will pre-render this page on each request using the data returned by `getServerSideProps`. This is useful if you want to fetch data that changes often, and have the page update to show the most current data.\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport type { InferGetServerSidePropsType, GetServerSideProps } from 'next'\n\ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n\nexport const getServerSideProps = (async () => {\n  // Fetch data from external API\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo: Repo = await res.json()\n  // Pass data to the page via props\n  return { props: { repo } }\n}) satisfies GetServerSideProps<{ repo: Repo }>\n\nexport default function Page({\n  repo,\n}: InferGetServerSidePropsType<typeof getServerSideProps>) {\n  return (\n    <main>\n      <p>{repo.stargazers_count}</p>\n    </main>\n  )\n}"
  },
  {
    "id": "get-server-side-props.mdx#1",
    "metadata": {
      "title": "getServerSideProps",
      "description": "API reference for `getServerSideProps`. Learn how to fetch data on each request with Next.js."
    },
    "content": "```\n\n```jsx filename=\"pages/index.js\" switcher\nexport async function getServerSideProps() {\n  // Fetch data from external API\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  // Pass data to the page via props\n  return { props: { repo } }\n}\n\nexport default function Page({ repo }) {\n  return (\n    <main>\n      <p>{repo.stargazers_count}</p>\n    </main>\n  )\n}\n```\n\nYou can import modules in top-level scope for use in `getServerSideProps`. Imports used will **not be bundled for the client-side**. This means you can write **server-side code directly in `getServerSideProps`**, including fetching data from your database."
  },
  {
    "id": "get-server-side-props.mdx#2",
    "metadata": {
      "title": "getServerSideProps",
      "description": "API reference for `getServerSideProps`. Learn how to fetch data on each request with Next.js."
    },
    "content": "## Context parameter\n\nThe `context` parameter is an object containing the following keys:"
  },
  {
    "id": "get-server-side-props.mdx#3",
    "metadata": {
      "title": "getServerSideProps",
      "description": "API reference for `getServerSideProps`. Learn how to fetch data on each request with Next.js."
    },
    "content": "| Name            | Description                                                                                                                                                                                                           |\n| --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `params`        | If this page uses a [dynamic route](/docs/pages/building-your-application/routing/dynamic-routes), `params` contains the route parameters. If the page name is `[id].js`, then `params` will look like `{ id: ... }`. |\n| `req`           | [The `HTTP` IncomingMessage object](https://nodejs.org/api/http.html#http_class_http_incomingmessage), with an additional `cookies` prop, which is an object with string keys mapping to string values of cookies.    |\n| `res`           | [The `HTTP` response object](https://nodejs.org/api/http.html#http_class_http_serverresponse).                                                                                                                        |"
  },
  {
    "id": "get-server-side-props.mdx#4",
    "metadata": {
      "title": "getServerSideProps",
      "description": "API reference for `getServerSideProps`. Learn how to fetch data on each request with Next.js."
    },
    "content": "| `query`         | An object representing the query string, including dynamic route parameters.                                                                                                                                          |\n| `preview`       | (Deprecated for `draftMode`) `preview` is `true` if the page is in the [Preview Mode](/docs/pages/guides/preview-mode) and `false` otherwise.                                                                         |\n| `previewData`   | (Deprecated for `draftMode`) The [preview](/docs/pages/guides/preview-mode) data set by `setPreviewData`.                                                                                                             |\n| `draftMode`     | `draftMode` is `true` if the page is in the [Draft Mode](/docs/pages/guides/draft-mode) and `false` otherwise.                                                                                                        |\n| `resolvedUrl`   | A normalized version of the request `URL` that strips the `_next/data` prefix for client transitions and includes original query values.                                                                              |"
  },
  {
    "id": "get-server-side-props.mdx#5",
    "metadata": {
      "title": "getServerSideProps",
      "description": "API reference for `getServerSideProps`. Learn how to fetch data on each request with Next.js."
    },
    "content": "| `locale`        | Contains the active locale (if enabled).                                                                                                                                                                              |\n| `locales`       | Contains all supported locales (if enabled).                                                                                                                                                                          |\n| `defaultLocale` | Contains the configured default locale (if enabled).                                                                                                                                                                  |"
  },
  {
    "id": "get-server-side-props.mdx#6",
    "metadata": {
      "title": "getServerSideProps",
      "description": "API reference for `getServerSideProps`. Learn how to fetch data on each request with Next.js."
    },
    "content": "## getServerSideProps return values\n\nThe `getServerSideProps` function should return an object with **any one of the following** properties:\n\n### `props`\n\nThe `props` object is a key-value pair, where each value is received by the page component. It should be a [serializable object](https://developer.mozilla.org/docs/Glossary/Serialization) so that any props passed, could be serialized with [`JSON.stringify`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify).\n\n```jsx\nexport async function getServerSideProps(context) {\n  return {\n    props: { message: `Next.js is awesome` }, // will be passed to the page component as props\n  }\n}\n```"
  },
  {
    "id": "get-server-side-props.mdx#7",
    "metadata": {
      "title": "getServerSideProps",
      "description": "API reference for `getServerSideProps`. Learn how to fetch data on each request with Next.js."
    },
    "content": "### `notFound`\n\nThe `notFound` boolean allows the page to return a `404` status and [404 Page](/docs/pages/building-your-application/routing/custom-error#404-page). With `notFound: true`, the page will return a `404` even if there was a successfully generated page before. This is meant to support use cases like user-generated content getting removed by its author.\n\n```js\nexport async function getServerSideProps(context) {\n  const res = await fetch(`https://.../data`)\n  const data = await res.json()\n\n  if (!data) {\n    return {\n      notFound: true,\n    }\n  }\n\n  return {\n    props: { data }, // will be passed to the page component as props\n  }\n}\n```"
  },
  {
    "id": "get-server-side-props.mdx#8",
    "metadata": {
      "title": "getServerSideProps",
      "description": "API reference for `getServerSideProps`. Learn how to fetch data on each request with Next.js."
    },
    "content": "### `redirect`\n\nThe `redirect` object allows redirecting to internal and external resources. It should match the shape of `{ destination: string, permanent: boolean }`. In some rare cases, you might need to assign a custom status code for older `HTTP` clients to properly redirect. In these cases, you can use the `statusCode` property instead of the `permanent` property, but not both.\n\n```js\nexport async function getServerSideProps(context) {\n  const res = await fetch(`https://.../data`)\n  const data = await res.json()\n\n  if (!data) {\n    return {\n      redirect: {\n        destination: '/',\n        permanent: false,\n      },\n    }\n  }\n\n  return {\n    props: {}, // will be passed to the page component as props\n  }\n}\n```"
  },
  {
    "id": "get-server-side-props.mdx#9",
    "metadata": {
      "title": "getServerSideProps",
      "description": "API reference for `getServerSideProps`. Learn how to fetch data on each request with Next.js."
    },
    "content": "## Version History\n\n| Version   | Changes                                                                                           |\n| --------- | ------------------------------------------------------------------------------------------------- |\n| `v13.4.0` | [App Router](/docs/app/getting-started/fetching-data) is now stable with simplified data fetching |\n| `v10.0.0` | `locale`, `locales`, `defaultLocale`, and `notFound` options added.                               |\n| `v9.3.0`  | `getServerSideProps` introduced.                                                                  |"
  },
  {
    "id": "get-static-paths.mdx#0",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "---\ntitle: getStaticPaths\ndescription: API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`.\n---\n\nWhen exporting a function called `getStaticPaths` from a page that uses [Dynamic Routes](/docs/pages/building-your-application/routing/dynamic-routes), Next.js will statically pre-render all the paths specified by `getStaticPaths`.\n\n```tsx filename=\"pages/repo/[name].tsx\" switcher\nimport type {\n  InferGetStaticPropsType,\n  GetStaticProps,\n  GetStaticPaths,\n} from 'next'\n\ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n\nexport const getStaticPaths = (async () => {\n  return {\n    paths: [\n      {\n        params: {\n          name: 'next.js',\n        },\n      }, // See the \"paths\" section below\n    ],\n    fallback: true, // false or \"blocking\"\n  }\n}) satisfies GetStaticPaths\n\nexport const getStaticProps = (async (context) => {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}) satisfies GetStaticProps<{\n  repo: Repo\n}>"
  },
  {
    "id": "get-static-paths.mdx#1",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "export default function Page({\n  repo,\n}: InferGetStaticPropsType<typeof getStaticProps>) {\n  return repo.stargazers_count\n}"
  },
  {
    "id": "get-static-paths.mdx#2",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "```\n\n```jsx filename=\"pages/repo/[name].js\" switcher\nexport async function getStaticPaths() {\n  return {\n    paths: [\n      {\n        params: {\n          name: 'next.js',\n        },\n      }, // See the \"paths\" section below\n    ],\n    fallback: true, // false or \"blocking\"\n  }\n}\n\nexport async function getStaticProps() {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}\n\nexport default function Page({ repo }) {\n  return repo.stargazers_count\n}\n```"
  },
  {
    "id": "get-static-paths.mdx#3",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "## getStaticPaths return values\n\nThe `getStaticPaths` function should return an object with the following **required** properties:"
  },
  {
    "id": "get-static-paths.mdx#4",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "### `paths`\n\nThe `paths` key determines which paths will be pre-rendered. For example, suppose that you have a page that uses [Dynamic Routes](/docs/pages/building-your-application/routing/dynamic-routes) named `pages/posts/[id].js`. If you export `getStaticPaths` from this page and return the following for `paths`:\n\n```js\nreturn {\n  paths: [\n    { params: { id: '1' }},\n    {\n      params: { id: '2' },\n      // with i18n configured the locale for the path can be returned as well\n      locale: \"en\",\n    },\n  ],\n  fallback: ...\n}"
  },
  {
    "id": "get-static-paths.mdx#5",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "```\n\nThen, Next.js will statically generate `/posts/1` and `/posts/2` during `next build` using the page component in `pages/posts/[id].js`.\n\nThe value for each `params` object must match the parameters used in the page name:\n\n- If the page name is `pages/posts/[postId]/[commentId]`, then `params` should contain `postId` and `commentId`.\n- If the page name uses [catch-all routes](/docs/pages/building-your-application/routing/dynamic-routes#catch-all-segments) like `pages/[...slug]`, then `params` should contain `slug` (which is an array). If this array is `['hello', 'world']`, then Next.js will statically generate the page at `/hello/world`.\n- If the page uses an [optional catch-all route](/docs/pages/building-your-application/routing/dynamic-routes#optional-catch-all-segments), use `null`, `[]`, `undefined` or `false` to render the root-most route. For example, if you supply `slug: false` for `pages/[[...slug]]`, Next.js will statically generate the page `/`."
  },
  {
    "id": "get-static-paths.mdx#6",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "The `params` strings are **case-sensitive** and ideally should be normalized to ensure the paths are generated correctly. For example, if `WoRLD` is returned for a param it will only match if `WoRLD` is the actual path visited, not `world` or `World`.\n\nSeparate of the `params` object a `locale` field can be returned when [i18n is configured](/docs/pages/guides/internationalization), which configures the locale for the path being generated."
  },
  {
    "id": "get-static-paths.mdx#7",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "### `fallback: false`\n\nIf `fallback` is `false`, then any paths not returned by `getStaticPaths` will result in a **404 page**.\n\nWhen `next build` is run, Next.js will check if `getStaticPaths` returned `fallback: false`, it will then build **only** the paths returned by `getStaticPaths`. This option is useful if you have a small number of paths to create, or new page data is not added often. If you find that you need to add more paths, and you have `fallback: false`, you will need to run `next build` again so that the new paths can be generated.\n\nThe following example pre-renders one blog post per page called `pages/posts/[id].js`. The list of blog posts will be fetched from a CMS and returned by `getStaticPaths`. Then, for each page, it fetches the post data from a CMS using [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props).\n\n```jsx filename=\"pages/posts/[id].js\"\nfunction Post({ post }) {\n  // Render post...\n}\n\n// This function gets called at build time\nexport async function getStaticPaths() {\n  // Call an external API endpoint to get posts\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()"
  },
  {
    "id": "get-static-paths.mdx#8",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "// Get the paths we want to pre-render based on posts\n  const paths = posts.map((post) => ({\n    params: { id: post.id },\n  }))\n\n  // We'll pre-render only these paths at build time.\n  // { fallback: false } means other routes should 404.\n  return { paths, fallback: false }\n}\n\n// This also gets called at build time\nexport async function getStaticProps({ params }) {\n  // params contains the post `id`.\n  // If the route is like /posts/1, then params.id is 1\n  const res = await fetch(`https://.../posts/${params.id}`)\n  const post = await res.json()\n\n  // Pass post data to the page via props\n  return { props: { post } }\n}\n\nexport default Post\n```"
  },
  {
    "id": "get-static-paths.mdx#9",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "### `fallback: true`\n\n<details>\n  <summary>Examples</summary>\n\n- [Static generation of a large number of pages](https://react-tweet.vercel.app/)\n\n</details>\n\nIf `fallback` is `true`, then the behavior of `getStaticProps` changes in the following ways:"
  },
  {
    "id": "get-static-paths.mdx#10",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "- The paths returned from `getStaticPaths` will be rendered to `HTML` at build time by `getStaticProps`.\n- The paths that have not been generated at build time will **not** result in a 404 page. Instead, Next.js will serve a [“fallback”](#fallback-pages) version of the page on the first request to such a path. Web crawlers, such as Google, won't be served a fallback and instead the path will behave as in [`fallback: 'blocking'`](#fallback-blocking).\n- When a page with `fallback: true` is navigated to through `next/link` or `next/router` (client-side) Next.js will _not_ serve a fallback and instead the page will behave as [`fallback: 'blocking'`](#fallback-blocking).\n- In the background, Next.js will statically generate the requested path `HTML` and `JSON`. This includes running `getStaticProps`.\n- When complete, the browser receives the `JSON` for the generated path. This will be used to automatically render the page with the required props. From the user’s perspective, the page will be swapped from the fallback page to the full page."
  },
  {
    "id": "get-static-paths.mdx#11",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "- At the same time, Next.js adds this path to the list of pre-rendered pages. Subsequent requests to the same path will serve the generated page, like other pages pre-rendered at build time."
  },
  {
    "id": "get-static-paths.mdx#12",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "> **Good to know**: `fallback: true` is not supported when using [`output: 'export'`](/docs/pages/guides/static-exports)."
  },
  {
    "id": "get-static-paths.mdx#13",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "#### When is `fallback: true` useful?\n\n`fallback: true` is useful if your app has a very large number of static pages that depend on data (such as a very large e-commerce site). If you want to pre-render all product pages, the builds would take a very long time.\n\nInstead, you may statically generate a small subset of pages and use `fallback: true` for the rest. When someone requests a page that is not generated yet, the user will see the page with a loading indicator or skeleton component.\n\nShortly after, `getStaticProps` finishes and the page will be rendered with the requested data. From now on, everyone who requests the same page will get the statically pre-rendered page.\n\nThis ensures that users always have a fast experience while preserving fast builds and the benefits of Static Generation.\n\n`fallback: true` will not _update_ generated pages, for that take a look at [Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration)."
  },
  {
    "id": "get-static-paths.mdx#14",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "### `fallback: 'blocking'`\n\nIf `fallback` is `'blocking'`, new paths not returned by `getStaticPaths` will wait for the `HTML` to be generated, identical to SSR (hence why _blocking_), and then be cached for future requests so it only happens once per path.\n\n`getStaticProps` will behave as follows:\n\n- The paths returned from `getStaticPaths` will be rendered to `HTML` at build time by `getStaticProps`.\n- The paths that have not been generated at build time will **not** result in a 404 page. Instead, Next.js will SSR on the first request and return the generated `HTML`.\n- When complete, the browser receives the `HTML` for the generated path. From the user’s perspective, it will transition from \"the browser is requesting the page\" to \"the full page is loaded\". There is no flash of loading/fallback state.\n- At the same time, Next.js adds this path to the list of pre-rendered pages. Subsequent requests to the same path will serve the generated page, like other pages pre-rendered at build time."
  },
  {
    "id": "get-static-paths.mdx#15",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "`fallback: 'blocking'` will not _update_ generated pages by default. To update generated pages, use [Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration) in conjunction with `fallback: 'blocking'`.\n\n> **Good to know**: `fallback: 'blocking'` is not supported when using [`output: 'export'`](/docs/pages/guides/static-exports)."
  },
  {
    "id": "get-static-paths.mdx#16",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "### Fallback pages\n\nIn the “fallback” version of a page:\n\n- The page’s props will be empty.\n- Using the [router](/docs/pages/api-reference/functions/use-router), you can detect if the fallback is being rendered, `router.isFallback` will be `true`.\n\nThe following example showcases using `isFallback`:\n\n```jsx filename=\"pages/posts/[id].js\"\nimport { useRouter } from 'next/router'\n\nfunction Post({ post }) {\n  const router = useRouter()\n\n  // If the page is not yet generated, this will be displayed\n  // initially until getStaticProps() finishes running\n  if (router.isFallback) {\n    return <div>Loading...</div>\n  }\n\n  // Render post...\n}\n\n// This function gets called at build time\nexport async function getStaticPaths() {\n  return {\n    // Only `/posts/1` and `/posts/2` are generated at build time\n    paths: [{ params: { id: '1' } }, { params: { id: '2' } }],\n    // Enable statically generating additional pages\n    // For example: `/posts/3`\n    fallback: true,\n  }\n}"
  },
  {
    "id": "get-static-paths.mdx#17",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "// This also gets called at build time\nexport async function getStaticProps({ params }) {\n  // params contains the post `id`.\n  // If the route is like /posts/1, then params.id is 1\n  const res = await fetch(`https://.../posts/${params.id}`)\n  const post = await res.json()\n\n  // Pass post data to the page via props\n  return {\n    props: { post },\n    // Re-generate the post at most once per second\n    // if a request comes in\n    revalidate: 1,\n  }\n}\n\nexport default Post\n```"
  },
  {
    "id": "get-static-paths.mdx#18",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "## Version History"
  },
  {
    "id": "get-static-paths.mdx#19",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "| Version   | Changes                                                                                                                                                                                           |\n| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `v13.4.0` | [App Router](/docs/app/getting-started/fetching-data) is now stable with simplified data fetching, including [`generateStaticParams()`](/docs/app/api-reference/functions/generate-static-params) |\n| `v12.2.0` | [On-Demand Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration#on-demand-revalidation-with-revalidatepath) is stable.                                             |\n| `v12.1.0` | [On-Demand Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration#on-demand-revalidation-with-revalidatepath) added (beta).                                          |"
  },
  {
    "id": "get-static-paths.mdx#20",
    "metadata": {
      "title": "getStaticPaths",
      "description": "API reference for `getStaticPaths`. Learn how to fetch data and generate static pages with `getStaticPaths`."
    },
    "content": "| `v9.5.0`  | Stable [Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration)                                                                                                      |\n| `v9.3.0`  | `getStaticPaths` introduced.                                                                                                                                                                      |"
  },
  {
    "id": "get-static-props.mdx#0",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "---\ntitle: getStaticProps\ndescription: API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js.\n---\n\nExporting a function called `getStaticProps` will pre-render a page at build time using the props returned from the function:\n\n```tsx filename=\"pages/index.tsx\" switcher\nimport type { InferGetStaticPropsType, GetStaticProps } from 'next'\n\ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n\nexport const getStaticProps = (async (context) => {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}) satisfies GetStaticProps<{\n  repo: Repo\n}>\n\nexport default function Page({\n  repo,\n}: InferGetStaticPropsType<typeof getStaticProps>) {\n  return repo.stargazers_count\n}\n```\n\n```jsx filename=\"pages/index.js\" switcher\nexport async function getStaticProps() {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}\n\nexport default function Page({ repo }) {\n  return repo.stargazers_count\n}"
  },
  {
    "id": "get-static-props.mdx#1",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "```\n\nYou can import modules in top-level scope for use in `getStaticProps`. Imports used will **not be bundled for the client-side**. This means you can write **server-side code directly in `getStaticProps`**, including fetching data from your database."
  },
  {
    "id": "get-static-props.mdx#2",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "## Context parameter\n\nThe `context` parameter is an object containing the following keys:"
  },
  {
    "id": "get-static-props.mdx#3",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "| Name               | Description                                                                                                                                                                                                                                                                                                                                                                                                                          |\n| ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |"
  },
  {
    "id": "get-static-props.mdx#4",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "| `params`           | Contains the route parameters for pages using [dynamic routes](/docs/pages/building-your-application/routing/dynamic-routes). For example, if the page name is `[id].js`, then `params` will look like `{ id: ... }`. You should use this together with `getStaticPaths`, which we'll explain later.                                                                                                                                 |\n| `preview`          | (Deprecated for `draftMode`) `preview` is `true` if the page is in the [Preview Mode](/docs/pages/guides/preview-mode) and `false` otherwise.                                                                                                                                                                                                                                                                                        |"
  },
  {
    "id": "get-static-props.mdx#5",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "| `previewData`      | (Deprecated for `draftMode`) The [preview](/docs/pages/guides/preview-mode) data set by `setPreviewData`.                                                                                                                                                                                                                                                                                                                            |\n| `draftMode`        | `draftMode` is `true` if the page is in the [Draft Mode](/docs/pages/guides/draft-mode) and `false` otherwise.                                                                                                                                                                                                                                                                                                                       |"
  },
  {
    "id": "get-static-props.mdx#6",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "| `locale`           | Contains the active locale (if enabled).                                                                                                                                                                                                                                                                                                                                                                                             |\n| `locales`          | Contains all supported locales (if enabled).                                                                                                                                                                                                                                                                                                                                                                                         |"
  },
  {
    "id": "get-static-props.mdx#7",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "| `defaultLocale`    | Contains the configured default locale (if enabled).                                                                                                                                                                                                                                                                                                                                                                                 |\n| `revalidateReason` | Provides a reason for why the function was called. Can be one of: \"build\" (run at build time), \"stale\" (revalidate period expired, or running in [development mode](/docs/pages/building-your-application/data-fetching/get-static-props#runs-on-every-request-in-development)), \"on-demand\" (triggered via [on-demand revalidation](/docs/pages/guides/incremental-static-regeneration#on-demand-revalidation-with-revalidatepath)) |"
  },
  {
    "id": "get-static-props.mdx#8",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "## getStaticProps return values\n\nThe `getStaticProps` function should return an object containing either `props`, `redirect`, or `notFound` followed by an **optional** `revalidate` property.\n\n### `props`\n\nThe `props` object is a key-value pair, where each value is received by the page component. It should be a [serializable object](https://developer.mozilla.org/docs/Glossary/Serialization) so that any props passed, could be serialized with [`JSON.stringify`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify).\n\n```jsx\nexport async function getStaticProps(context) {\n  return {\n    props: { message: `Next.js is awesome` }, // will be passed to the page component as props\n  }\n}\n```"
  },
  {
    "id": "get-static-props.mdx#9",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "### `revalidate`\n\nThe `revalidate` property is the amount in seconds after which a page re-generation can occur (defaults to `false` or no revalidation).\n\n```js\n// This function gets called at build time on server-side.\n// It may be called again, on a serverless function, if\n// revalidation is enabled and a new request comes in\nexport async function getStaticProps() {\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n\n  return {\n    props: {\n      posts,\n    },\n    // Next.js will attempt to re-generate the page:\n    // - When a request comes in\n    // - At most once every 10 seconds\n    revalidate: 10, // In seconds\n  }\n}"
  },
  {
    "id": "get-static-props.mdx#10",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "```\n\nLearn more about [Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration).\n\nThe cache status of a page leveraging ISR can be determined by reading the value of the `x-nextjs-cache` response header. The possible values are the following:\n\n- `MISS` - the path is not in the cache (occurs at most once, on the first visit)\n- `STALE` - the path is in the cache but exceeded the revalidate time so it will be updated in the background\n- `HIT` - the path is in the cache and has not exceeded the revalidate time"
  },
  {
    "id": "get-static-props.mdx#11",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "### `notFound`\n\nThe `notFound` boolean allows the page to return a `404` status and [404 Page](/docs/pages/building-your-application/routing/custom-error#404-page). With `notFound: true`, the page will return a `404` even if there was a successfully generated page before. This is meant to support use cases like user-generated content getting removed by its author. Note, `notFound` follows the same `revalidate` behavior [described here](#revalidate).\n\n```js\nexport async function getStaticProps(context) {\n  const res = await fetch(`https://.../data`)\n  const data = await res.json()\n\n  if (!data) {\n    return {\n      notFound: true,\n    }\n  }\n\n  return {\n    props: { data }, // will be passed to the page component as props\n  }\n}\n```\n\n> **Good to know**: `notFound` is not needed for [`fallback: false`](/docs/pages/api-reference/functions/get-static-paths#fallback-false) mode as only paths returned from `getStaticPaths` will be pre-rendered."
  },
  {
    "id": "get-static-props.mdx#12",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "### `redirect`\n\nThe `redirect` object allows redirecting to internal or external resources. It should match the shape of `{ destination: string, permanent: boolean }`.\n\nIn some rare cases, you might need to assign a custom status code for older `HTTP` clients to properly redirect. In these cases, you can use the `statusCode` property instead of the `permanent` property, **but not both**. You can also set `basePath: false` similar to redirects in `next.config.js`.\n\n```js\nexport async function getStaticProps(context) {\n  const res = await fetch(`https://...`)\n  const data = await res.json()\n\n  if (!data) {\n    return {\n      redirect: {\n        destination: '/',\n        permanent: false,\n        // statusCode: 301\n      },\n    }\n  }\n\n  return {\n    props: { data }, // will be passed to the page component as props\n  }\n}\n```\n\nIf the redirects are known at build-time, they should be added in [`next.config.js`](/docs/pages/api-reference/config/next-config-js/redirects) instead."
  },
  {
    "id": "get-static-props.mdx#13",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "## Reading files: Use `process.cwd()`\n\nFiles can be read directly from the filesystem in `getStaticProps`.\n\nIn order to do so you have to get the full path to a file.\n\nSince Next.js compiles your code into a separate directory you can't use `__dirname` as the path it returns will be different from the Pages Router.\n\nInstead you can use `process.cwd()` which gives you the directory where Next.js is being executed.\n\n```jsx\nimport { promises as fs } from 'fs'\nimport path from 'path'\n\n// posts will be populated at build time by getStaticProps()\nfunction Blog({ posts }) {\n  return (\n    <ul>\n      {posts.map((post) => (\n        <li>\n          <h3>{post.filename}</h3>\n          <p>{post.content}</p>\n        </li>\n      ))}\n    </ul>\n  )\n}\n\n// This function gets called at build time on server-side.\n// It won't be called on client-side, so you can even do\n// direct database queries.\nexport async function getStaticProps() {\n  const postsDirectory = path.join(process.cwd(), 'posts')\n  const filenames = await fs.readdir(postsDirectory)"
  },
  {
    "id": "get-static-props.mdx#14",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "const posts = filenames.map(async (filename) => {\n    const filePath = path.join(postsDirectory, filename)\n    const fileContents = await fs.readFile(filePath, 'utf8')\n\n    // Generally you would parse/transform the contents\n    // For example you can transform markdown to HTML here\n\n    return {\n      filename,\n      content: fileContents,\n    }\n  })\n  // By returning { props: { posts } }, the Blog component\n  // will receive `posts` as a prop at build time\n  return {\n    props: {\n      posts: await Promise.all(posts),\n    },\n  }\n}\n\nexport default Blog\n```"
  },
  {
    "id": "get-static-props.mdx#15",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "## Version History"
  },
  {
    "id": "get-static-props.mdx#16",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "| Version   | Changes                                                                                                                                                  |\n| --------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `v13.4.0` | [App Router](/docs/app/getting-started/fetching-data) is now stable with simplified data fetching                                                        |\n| `v12.2.0` | [On-Demand Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration#on-demand-revalidation-with-revalidatepath) is stable.    |\n| `v12.1.0` | [On-Demand Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration#on-demand-revalidation-with-revalidatepath) added (beta). |\n| `v10.0.0` | `locale`, `locales`, `defaultLocale`, and `notFound` options added.                                                                                      |\n| `v10.0.0` | `fallback: 'blocking'` return option added.                                                                                                              |"
  },
  {
    "id": "get-static-props.mdx#17",
    "metadata": {
      "title": "getStaticProps",
      "description": "API reference for `getStaticProps`. Learn how to use `getStaticProps` to generate static pages with Next.js."
    },
    "content": "| `v10.0.0` | `fallback: 'blocking'` return option added.                                                                                                              |\n| `v9.5.0`  | Stable [Incremental Static Regeneration](/docs/pages/guides/incremental-static-regeneration)                                                             |\n| `v9.3.0`  | `getStaticProps` introduced.                                                                                                                             |"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Functions",
      "description": "API Reference for Functions and Hooks in Pages Router."
    },
    "content": "---\ntitle: Functions\ndescription: API Reference for Functions and Hooks in Pages Router.\nsource: app/api-reference/functions\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "next-request.mdx#0",
    "metadata": {
      "title": "NextRequest",
      "description": "API Reference for NextRequest."
    },
    "content": "---\ntitle: NextRequest\ndescription: API Reference for NextRequest.\nsource: app/api-reference/functions/next-request\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "next-response.mdx#0",
    "metadata": {
      "title": "NextResponse",
      "description": "API Reference for NextResponse."
    },
    "content": "---\ntitle: NextResponse\ndescription: API Reference for NextResponse.\nsource: app/api-reference/functions/next-response\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "use-report-web-vitals.mdx#0",
    "metadata": {
      "title": "useReportWebVitals",
      "description": "useReportWebVitals"
    },
    "content": "---\ntitle: useReportWebVitals\ndescription: useReportWebVitals\nsource: app/api-reference/functions/use-report-web-vitals\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "use-router.mdx#0",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "---\ntitle: useRouter\ndescription: Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook.\n---\n\nIf you want to access the [`router` object](#router-object) inside any function component in your app, you can use the `useRouter` hook, take a look at the following example:\n\n```jsx\nimport { useRouter } from 'next/router'\n\nfunction ActiveLink({ children, href }) {\n  const router = useRouter()\n  const style = {\n    marginRight: 10,\n    color: router.asPath === href ? 'red' : 'black',\n  }\n\n  const handleClick = (e) => {\n    e.preventDefault()\n    router.push(href)\n  }\n\n  return (\n    <a href={href} onClick={handleClick} style={style}>\n      {children}\n    </a>\n  )\n}\n\nexport default ActiveLink\n```\n\n> `useRouter` is a [React Hook](https://react.dev/learn#using-hooks), meaning it cannot be used with classes. You can either use [withRouter](#withrouter) or wrap your class in a function component."
  },
  {
    "id": "use-router.mdx#1",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "## `router` object\n\nThe following is the definition of the `router` object returned by both [`useRouter`](#top) and [`withRouter`](#withrouter):"
  },
  {
    "id": "use-router.mdx#2",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "- `pathname`: `String` - The path for current route file that comes after `/pages`. Therefore, `basePath`, `locale` and trailing slash (`trailingSlash: true`) are not included.\n- `query`: `Object` - The query string parsed to an object, including [dynamic route](/docs/pages/building-your-application/routing/dynamic-routes) parameters. It will be an empty object during prerendering if the page doesn't use [Server-side Rendering](/docs/pages/building-your-application/data-fetching/get-server-side-props). Defaults to `{}`\n- `asPath`: `String` - The path as shown in the browser including the search params and respecting the `trailingSlash` configuration. `basePath` and `locale` are not included.\n- `isFallback`: `boolean` - Whether the current page is in [fallback mode](/docs/pages/api-reference/functions/get-static-paths#fallback-true).\n- `basePath`: `String` - The active [basePath](/docs/app/api-reference/config/next-config-js/basePath) (if enabled).\n- `locale`: `String` - The active locale (if enabled).\n- `locales`: `String[]` - All supported locales (if enabled).\n- `defaultLocale`: `String` - The current default locale (if enabled)."
  },
  {
    "id": "use-router.mdx#3",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "- `locale`: `String` - The active locale (if enabled).\n- `locales`: `String[]` - All supported locales (if enabled).\n- `defaultLocale`: `String` - The current default locale (if enabled).\n- `domainLocales`: `Array<{domain, defaultLocale, locales}>` - Any configured domain locales.\n- `isReady`: `boolean` - Whether the router fields are updated client-side and ready for use. Should only be used inside of `useEffect` methods and not for conditionally rendering on the server. See related docs for use case with [automatically statically optimized pages](/docs/pages/building-your-application/rendering/automatic-static-optimization)\n- `isPreview`: `boolean` - Whether the application is currently in [preview mode](/docs/pages/guides/preview-mode)."
  },
  {
    "id": "use-router.mdx#4",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "> Using the `asPath` field may lead to a mismatch between client and server if the page is rendered using server-side rendering or [automatic static optimization](/docs/pages/building-your-application/rendering/automatic-static-optimization). Avoid using `asPath` until the `isReady` field is `true`.\n\nThe following methods are included inside `router`:"
  },
  {
    "id": "use-router.mdx#5",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "### router.push\n\nHandles client-side transitions, this method is useful for cases where [`next/link`](/docs/pages/api-reference/components/link) is not enough.\n\n```js\nrouter.push(url, as, options)"
  },
  {
    "id": "use-router.mdx#6",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "```\n\n- `url`: `UrlObject | String` - The URL to navigate to (see [Node.JS URL module documentation](https://nodejs.org/api/url.html#legacy-urlobject) for `UrlObject` properties).\n- `as`: `UrlObject | String` - Optional decorator for the path that will be shown in the browser URL bar. Before Next.js 9.5.3 this was used for dynamic routes.\n- `options` - Optional object with the following configuration options:\n  - `scroll` - Optional boolean, controls scrolling to the top of the page after navigation. Defaults to `true`\n  - [`shallow`](/docs/pages/building-your-application/routing/linking-and-navigating#shallow-routing): Update the path of the current page without rerunning [`getStaticProps`](/docs/pages/building-your-application/data-fetching/get-static-props), [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props) or [`getInitialProps`](/docs/pages/api-reference/functions/get-initial-props). Defaults to `false`\n  - `locale` - Optional string, indicates locale of the new page"
  },
  {
    "id": "use-router.mdx#7",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "> You don't need to use `router.push` for external URLs. [window.location](https://developer.mozilla.org/docs/Web/API/Window/location) is better suited for those cases.\n\nNavigating to `pages/about.js`, which is a predefined route:\n\n```jsx\nimport { useRouter } from 'next/router'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button type=\"button\" onClick={() => router.push('/about')}>\n      Click me\n    </button>\n  )\n}"
  },
  {
    "id": "use-router.mdx#8",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "```\n\nNavigating `pages/post/[pid].js`, which is a dynamic route:\n\n```jsx\nimport { useRouter } from 'next/router'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button type=\"button\" onClick={() => router.push('/post/abc')}>\n      Click me\n    </button>\n  )\n}\n```\n\nRedirecting the user to `pages/login.js`, useful for pages behind [authentication](/docs/pages/guides/authentication):\n\n```jsx\nimport { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n\n// Here you would fetch and return the user\nconst useUser = () => ({ user: null, loading: false })\n\nexport default function Page() {\n  const { user, loading } = useUser()\n  const router = useRouter()\n\n  useEffect(() => {\n    if (!(user || loading)) {\n      router.push('/login')\n    }\n  }, [user, loading])\n\n  return <p>Redirecting...</p>\n}\n```"
  },
  {
    "id": "use-router.mdx#9",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "#### Resetting state after navigation\n\nWhen navigating to the same page in Next.js, the page's state **will not** be reset by default as React does not unmount unless the parent component has changed.\n\n```jsx filename=\"pages/[slug].js\"\nimport Link from 'next/link'\nimport { useState } from 'react'\nimport { useRouter } from 'next/router'\n\nexport default function Page(props) {\n  const router = useRouter()\n  const [count, setCount] = useState(0)\n  return (\n    <div>\n      <h1>Page: {router.query.slug}</h1>\n      <p>Count: {count}</p>\n      <button onClick={() => setCount(count + 1)}>Increase count</button>\n      <Link href=\"/one\">one</Link> <Link href=\"/two\">two</Link>\n    </div>\n  )\n}\n```\n\nIn the above example, navigating between `/one` and `/two` **will not** reset the count . The `useState` is maintained between renders because the top-level React component, `Page`, is the same.\n\nIf you do not want this behavior, you have a couple of options:\n\n- Manually ensure each state is updated using `useEffect`. In the above example, that could look like:\n\n  ```jsx\n  useEffect(() => {\n    setCount(0)\n  }, [router.query.slug])"
  },
  {
    "id": "use-router.mdx#10",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "```\n\n- Use a React `key` to [tell React to remount the component](https://react.dev/learn/rendering-lists#keeping-list-items-in-order-with-key). To do this for all pages, you can use a custom app:\n\n  ```jsx filename=\"pages/_app.js\"\n  import { useRouter } from 'next/router'\n\n  export default function MyApp({ Component, pageProps }) {\n    const router = useRouter()\n    return <Component key={router.asPath} {...pageProps} />\n  }\n  ```"
  },
  {
    "id": "use-router.mdx#11",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "#### With URL object\n\nYou can use a URL object in the same way you can use it for [`next/link`](/docs/pages/api-reference/components/link#passing-a-url-object). Works for both the `url` and `as` parameters:\n\n```jsx\nimport { useRouter } from 'next/router'\n\nexport default function ReadMore({ post }) {\n  const router = useRouter()\n\n  return (\n    <button\n      type=\"button\"\n      onClick={() => {\n        router.push({\n          pathname: '/post/[pid]',\n          query: { pid: post.id },\n        })\n      }}\n    >\n      Click here to read more\n    </button>\n  )\n}\n```"
  },
  {
    "id": "use-router.mdx#12",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "### router.replace\n\nSimilar to the `replace` prop in [`next/link`](/docs/pages/api-reference/components/link), `router.replace` will prevent adding a new URL entry into the `history` stack.\n\n```js\nrouter.replace(url, as, options)\n```\n\n- The API for `router.replace` is exactly the same as the API for [`router.push`](#routerpush).\n\nTake a look at the following example:\n\n```jsx\nimport { useRouter } from 'next/router'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button type=\"button\" onClick={() => router.replace('/home')}>\n      Click me\n    </button>\n  )\n}\n```"
  },
  {
    "id": "use-router.mdx#13",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "### router.prefetch\n\nPrefetch pages for faster client-side transitions. This method is only useful for navigations without [`next/link`](/docs/pages/api-reference/components/link), as `next/link` takes care of prefetching pages automatically.\n\n> This is a production only feature. Next.js doesn't prefetch pages in development.\n\n```js\nrouter.prefetch(url, as, options)"
  },
  {
    "id": "use-router.mdx#14",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "```\n\n- `url` - The URL to prefetch, including explicit routes (e.g. `/dashboard`) and dynamic routes (e.g. `/product/[id]`)\n- `as` - Optional decorator for `url`. Before Next.js 9.5.3 this was used to prefetch dynamic routes.\n- `options` - Optional object with the following allowed fields:\n  - `locale` - allows providing a different locale from the active one. If `false`, `url` has to include the locale as the active locale won't be used.\n\nLet's say you have a login page, and after a login, you redirect the user to the dashboard. For that case, we can prefetch the dashboard to make a faster transition, like in the following example:\n\n```jsx\nimport { useCallback, useEffect } from 'react'\nimport { useRouter } from 'next/router'\n\nexport default function Login() {\n  const router = useRouter()\n  const handleSubmit = useCallback((e) => {\n    e.preventDefault()\n\n    fetch('/api/login', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        /* Form data */\n      }),\n    }).then((res) => {\n      // Do a fast client-side transition to the already prefetched dashboard page\n      if (res.ok) router.push('/dashboard')\n    })\n  }, [])"
  },
  {
    "id": "use-router.mdx#15",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "useEffect(() => {\n    // Prefetch the dashboard page\n    router.prefetch('/dashboard')\n  }, [router])\n\n  return (\n    <form onSubmit={handleSubmit}>\n      {/* Form fields */}\n      <button type=\"submit\">Login</button>\n    </form>\n  )\n}\n```"
  },
  {
    "id": "use-router.mdx#16",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "### router.beforePopState\n\nIn some cases (for example, if using a [Custom Server](/docs/pages/guides/custom-server)), you may wish to listen to [popstate](https://developer.mozilla.org/docs/Web/API/Window/popstate_event) and do something before the router acts on it.\n\n```js\nrouter.beforePopState(cb)"
  },
  {
    "id": "use-router.mdx#17",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "```\n\n- `cb` - The function to run on incoming `popstate` events. The function receives the state of the event as an object with the following props:\n  - `url`: `String` - the route for the new state. This is usually the name of a `page`\n  - `as`: `String` - the url that will be shown in the browser\n  - `options`: `Object` - Additional options sent by [router.push](#routerpush)\n\nIf `cb` returns `false`, the Next.js router will not handle `popstate`, and you'll be responsible for handling it in that case. See [Disabling file-system routing](/docs/pages/guides/custom-server#disabling-file-system-routing).\n\nYou could use `beforePopState` to manipulate the request, or force a SSR refresh, as in the following example:\n\n```jsx\nimport { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n\nexport default function Page() {\n  const router = useRouter()\n\n  useEffect(() => {\n    router.beforePopState(({ url, as, options }) => {\n      // I only want to allow these two routes!\n      if (as !== '/' && as !== '/other') {\n        // Have SSR render bad routes as a 404.\n        window.location.href = as\n        return false\n      }\n\n      return true\n    })\n  }, [router])"
  },
  {
    "id": "use-router.mdx#18",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "return true\n    })\n  }, [router])\n\n  return <p>Welcome to the page</p>\n}\n```"
  },
  {
    "id": "use-router.mdx#19",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "### router.back\n\nNavigate back in history. Equivalent to clicking the browser’s back button. It executes `window.history.back()`.\n\n```jsx\nimport { useRouter } from 'next/router'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button type=\"button\" onClick={() => router.back()}>\n      Click here to go back\n    </button>\n  )\n}\n```\n\n### router.reload\n\nReload the current URL. Equivalent to clicking the browser’s refresh button. It executes `window.location.reload()`.\n\n```jsx\nimport { useRouter } from 'next/router'\n\nexport default function Page() {\n  const router = useRouter()\n\n  return (\n    <button type=\"button\" onClick={() => router.reload()}>\n      Click here to reload\n    </button>\n  )\n}\n```"
  },
  {
    "id": "use-router.mdx#20",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "### router.events\n\nYou can listen to different events happening inside the Next.js Router. Here's a list of supported events:\n\n- `routeChangeStart(url, { shallow })` - Fires when a route starts to change\n- `routeChangeComplete(url, { shallow })` - Fires when a route changed completely\n- `routeChangeError(err, url, { shallow })` - Fires when there's an error when changing routes, or a route load is cancelled\n  - `err.cancelled` - Indicates if the navigation was cancelled\n- `beforeHistoryChange(url, { shallow })` - Fires before changing the browser's history\n- `hashChangeStart(url, { shallow })` - Fires when the hash will change but not the page\n- `hashChangeComplete(url, { shallow })` - Fires when the hash has changed but not the page\n\n> **Good to know**: Here `url` is the URL shown in the browser, including the [`basePath`](/docs/app/api-reference/config/next-config-js/basePath).\n\nFor example, to listen to the router event `routeChangeStart`, open or create `pages/_app.js` and subscribe to the event, like so:\n\n```jsx\nimport { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n\nexport default function MyApp({ Component, pageProps }) {\n  const router = useRouter()"
  },
  {
    "id": "use-router.mdx#21",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "```jsx\nimport { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n\nexport default function MyApp({ Component, pageProps }) {\n  const router = useRouter()\n\n  useEffect(() => {\n    const handleRouteChange = (url, { shallow }) => {\n      console.log(\n        `App is changing to ${url} ${\n          shallow ? 'with' : 'without'\n        } shallow routing`\n      )\n    }\n\n    router.events.on('routeChangeStart', handleRouteChange)\n\n    // If the component is unmounted, unsubscribe\n    // from the event with the `off` method:\n    return () => {\n      router.events.off('routeChangeStart', handleRouteChange)\n    }\n  }, [router])\n\n  return <Component {...pageProps} />\n}"
  },
  {
    "id": "use-router.mdx#22",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "```\n\n> We use a [Custom App](/docs/pages/building-your-application/routing/custom-app) (`pages/_app.js`) for this example to subscribe to the event because it's not unmounted on page navigations, but you can subscribe to router events on any component in your application.\n\nRouter events should be registered when a component mounts ([useEffect](https://react.dev/reference/react/useEffect) or [componentDidMount](https://react.dev/reference/react/Component#componentdidmount) / [componentWillUnmount](https://react.dev/reference/react/Component#componentwillunmount)) or imperatively when an event happens.\n\nIf a route load is cancelled (for example, by clicking two links rapidly in succession), `routeChangeError` will fire. And the passed `err` will contain a `cancelled` property set to `true`, as in the following example:\n\n```jsx\nimport { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n\nexport default function MyApp({ Component, pageProps }) {\n  const router = useRouter()\n\n  useEffect(() => {\n    const handleRouteChangeError = (err, url) => {\n      if (err.cancelled) {\n        console.log(`Route to ${url} was cancelled!`)\n      }\n    }"
  },
  {
    "id": "use-router.mdx#23",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "useEffect(() => {\n    const handleRouteChangeError = (err, url) => {\n      if (err.cancelled) {\n        console.log(`Route to ${url} was cancelled!`)\n      }\n    }\n\n    router.events.on('routeChangeError', handleRouteChangeError)\n\n    // If the component is unmounted, unsubscribe\n    // from the event with the `off` method:\n    return () => {\n      router.events.off('routeChangeError', handleRouteChangeError)\n    }\n  }, [router])\n\n  return <Component {...pageProps} />\n}\n```"
  },
  {
    "id": "use-router.mdx#24",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "## The `next/compat/router` export\n\nThis is the same `useRouter` hook, but can be used in both `app` and `pages` directories.\n\nIt differs from `next/router` in that it does not throw an error when the pages router is not mounted, and instead has a return type of `NextRouter | null`.\nThis allows developers to convert components to support running in both `app` and `pages` as they transition to the `app` router.\n\nA component that previously looked like this:\n\n```jsx\nimport { useRouter } from 'next/router'\nconst MyComponent = () => {\n  const { isReady, query } = useRouter()\n  // ...\n}"
  },
  {
    "id": "use-router.mdx#25",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "```\n\nWill error when converted over to `next/compat/router`, as `null` can not be destructured. Instead, developers will be able to take advantage of new hooks:\n\n```jsx\nimport { useEffect } from 'react'\nimport { useRouter } from 'next/compat/router'\nimport { useSearchParams } from 'next/navigation'\nconst MyComponent = () => {\n  const router = useRouter() // may be null or a NextRouter instance\n  const searchParams = useSearchParams()\n  useEffect(() => {\n    if (router && !router.isReady) {\n      return\n    }\n    // In `app/`, searchParams will be ready immediately with the values, in\n    // `pages/` it will be available after the router is ready.\n    const search = searchParams.get('search')\n    // ...\n  }, [router, searchParams])\n  // ...\n}\n```\n\nThis component will now work in both `pages` and `app` directories. When the component is no longer used in `pages`, you can remove the references to the compat router:\n\n```jsx\nimport { useSearchParams } from 'next/navigation'\nconst MyComponent = () => {\n  const searchParams = useSearchParams()\n  // As this component is only used in `app/`, the compat router can be removed.\n  const search = searchParams.get('search')\n  // ...\n}\n```"
  },
  {
    "id": "use-router.mdx#26",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "### Using `useRouter` outside of Next.js context in pages\n\nAnother specific use case is when rendering components outside of a Next.js application context, such as inside `getServerSideProps` on the `pages` directory. In this case, the compat router can be used to avoid errors:\n\n```jsx\nimport { renderToString } from 'react-dom/server'\nimport { useRouter } from 'next/compat/router'\nconst MyComponent = () => {\n  const router = useRouter() // may be null or a NextRouter instance\n  // ...\n}\nexport async function getServerSideProps() {\n  const renderedComponent = renderToString(<MyComponent />)\n  return {\n    props: {\n      renderedComponent,\n    },\n  }\n}\n```"
  },
  {
    "id": "use-router.mdx#27",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "## Potential ESLint errors\n\nCertain methods accessible on the `router` object return a Promise. If you have the ESLint rule, [no-floating-promises](https://typescript-eslint.io/rules/no-floating-promises) enabled, consider disabling it either globally, or for the affected line.\n\nIf your application needs this rule, you should either `void` the promise – or use an `async` function, `await` the Promise, then void the function call. **This is not applicable when the method is called from inside an `onClick` handler**.\n\nThe affected methods are:\n\n- `router.push`\n- `router.replace`\n- `router.prefetch`"
  },
  {
    "id": "use-router.mdx#28",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "### Potential solutions\n\n```jsx\nimport { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n\n// Here you would fetch and return the user\nconst useUser = () => ({ user: null, loading: false })\n\nexport default function Page() {\n  const { user, loading } = useUser()\n  const router = useRouter()\n\n  useEffect(() => {\n    // disable the linting on the next line - This is the cleanest solution\n    // eslint-disable-next-line no-floating-promises\n    router.push('/login')\n\n    // void the Promise returned by router.push\n    if (!(user || loading)) {\n      void router.push('/login')\n    }\n    // or use an async function, await the Promise, then void the function call\n    async function handleRouteChange() {\n      if (!(user || loading)) {\n        await router.push('/login')\n      }\n    }\n    void handleRouteChange()\n  }, [user, loading])\n\n  return <p>Redirecting...</p>\n}\n```"
  },
  {
    "id": "use-router.mdx#29",
    "metadata": {
      "title": "useRouter",
      "description": "Learn more about the API of the Next.js Router, and access the router instance in your page with the useRouter hook."
    },
    "content": "## withRouter\n\nIf [`useRouter`](#router-object) is not the best fit for you, `withRouter` can also add the same [`router` object](#router-object) to any component.\n\n### Usage\n\n```jsx\nimport { withRouter } from 'next/router'\n\nfunction Page({ router }) {\n  return <p>{router.pathname}</p>\n}\n\nexport default withRouter(Page)\n```\n\n### TypeScript\n\nTo use class components with `withRouter`, the component needs to accept a router prop:\n\n```tsx\nimport React from 'react'\nimport { withRouter, NextRouter } from 'next/router'\n\ninterface WithRouterProps {\n  router: NextRouter\n}\n\ninterface MyComponentProps extends WithRouterProps {}\n\nclass MyComponent extends React.Component<MyComponentProps> {\n  render() {\n    return <p>{this.props.router.pathname}</p>\n  }\n}\n\nexport default withRouter(MyComponent)\n```"
  },
  {
    "id": "userAgent.mdx#0",
    "metadata": {
      "title": "userAgent",
      "description": "The userAgent helper extends the Web Request API with additional properties and methods to interact with the user agent object from the request."
    },
    "content": "---\ntitle: userAgent\ndescription: The userAgent helper extends the Web Request API with additional properties and methods to interact with the user agent object from the request.\nsource: app/api-reference/functions/userAgent\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "adapterPath.mdx#0",
    "metadata": {
      "title": "experimental.adapterPath",
      "description": "Configure a custom adapter for Next.js to hook into the build process with modifyConfig and buildComplete callbacks."
    },
    "content": "---\ntitle: experimental.adapterPath\ndescription: Configure a custom adapter for Next.js to hook into the build process with modifyConfig and buildComplete callbacks.\nsource: app/api-reference/config/next-config-js/adapterPath\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "allowedDevOrigins.mdx#0",
    "metadata": {
      "title": "allowedDevOrigins",
      "description": "Use `allowedDevOrigins` to configure additional origins that can request the dev server."
    },
    "content": "---\ntitle: allowedDevOrigins\ndescription: Use `allowedDevOrigins` to configure additional origins that can request the dev server.\nsource: app/api-reference/config/next-config-js/allowedDevOrigins\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "assetPrefix.mdx#0",
    "metadata": {
      "title": "assetPrefix",
      "description": "Learn how to use the assetPrefix config option to configure your CDN."
    },
    "content": "---\ntitle: assetPrefix\ndescription: Learn how to use the assetPrefix config option to configure your CDN.\nsource: app/api-reference/config/next-config-js/assetPrefix\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "basePath.mdx#0",
    "metadata": {
      "title": "basePath",
      "description": "Use `basePath` to deploy a Next.js application under a sub-path of a domain."
    },
    "content": "---\ntitle: basePath\ndescription: Use `basePath` to deploy a Next.js application under a sub-path of a domain.\nsource: app/api-reference/config/next-config-js/basePath\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "bundlePagesRouterDependencies.mdx#0",
    "metadata": {
      "title": "bundlePagesRouterDependencies",
      "description": "Enable automatic dependency bundling for Pages Router"
    },
    "content": "---\ntitle: bundlePagesRouterDependencies\ndescription: Enable automatic dependency bundling for Pages Router\n---\n\nEnable automatic server-side dependency bundling for Pages Router applications. Matches the automatic dependency bundling in App Router.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  bundlePagesRouterDependencies: true,\n}\n\nmodule.exports = nextConfig\n```\n\nExplicitly opt-out certain packages from being bundled using the [`serverExternalPackages`](/docs/pages/api-reference/config/next-config-js/serverExternalPackages) option.\n\n## Version History\n\n| Version   | Changes                                                                                                   |\n| --------- | --------------------------------------------------------------------------------------------------------- |\n| `v15.0.0` | Moved from experimental to stable. Renamed from `bundlePagesExternals` to `bundlePagesRouterDependencies` |"
  },
  {
    "id": "compress.mdx#0",
    "metadata": {
      "title": "compress",
      "description": "Next.js provides gzip compression to compress rendered content and static files, it only works with the server target. Learn more about it here."
    },
    "content": "---\ntitle: compress\ndescription: Next.js provides gzip compression to compress rendered content and static files, it only works with the server target. Learn more about it here.\nsource: app/api-reference/config/next-config-js/compress\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "crossOrigin.mdx#0",
    "metadata": {
      "title": "crossOrigin",
      "description": "Use the `crossOrigin` option to add a crossOrigin tag on the `script` tags generated by `next/script` and `next/head`."
    },
    "content": "---\ntitle: crossOrigin\ndescription: Use the `crossOrigin` option to add a crossOrigin tag on the `script` tags generated by `next/script` and `next/head`.\nsource: app/api-reference/config/next-config-js/crossOrigin\n---\n\n{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "devIndicators.mdx#0",
    "metadata": {
      "title": "devIndicators",
      "description": "Optimized pages include an indicator to let you know if it's being statically optimized. You can opt-out of it here."
    },
    "content": "---\ntitle: devIndicators\ndescription: Optimized pages include an indicator to let you know if it's being statically optimized. You can opt-out of it here.\nsource: app/api-reference/config/next-config-js/devIndicators\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "distDir.mdx#0",
    "metadata": {
      "title": "distDir",
      "description": "Set a custom build directory to use instead of the default .next directory."
    },
    "content": "---\ntitle: distDir\ndescription: Set a custom build directory to use instead of the default .next directory.\nsource: app/api-reference/config/next-config-js/distDir\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "env.mdx#0",
    "metadata": {
      "title": "env",
      "description": "Learn to add and access environment variables in your Next.js application at build time."
    },
    "content": "---\ntitle: env\ndescription: Learn to add and access environment variables in your Next.js application at build time.\nsource: app/api-reference/config/next-config-js/env\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "exportPathMap.mdx#0",
    "metadata": {
      "title": "exportPathMap",
      "description": "Customize the pages that will be exported as HTML files when using `next export`."
    },
    "content": "---\ntitle: exportPathMap\ndescription: Customize the pages that will be exported as HTML files when using `next export`.\nsource: app/api-reference/config/next-config-js/exportPathMap\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "generateBuildId.mdx#0",
    "metadata": {
      "title": "generateBuildId",
      "description": "Configure the build id, which is used to identify the current build in which your application is being served."
    },
    "content": "---\ntitle: generateBuildId\ndescription: Configure the build id, which is used to identify the current build in which your application is being served.\nsource: app/api-reference/config/next-config-js/generateBuildId\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "generateEtags.mdx#0",
    "metadata": {
      "title": "generateEtags",
      "description": "Next.js will generate etags for every page by default. Learn more about how to disable etag generation here."
    },
    "content": "---\ntitle: generateEtags\ndescription: Next.js will generate etags for every page by default. Learn more about how to disable etag generation here.\nsource: app/api-reference/config/next-config-js/generateEtags\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "headers.mdx#0",
    "metadata": {
      "title": "headers",
      "description": "Add custom HTTP headers to your Next.js app."
    },
    "content": "---\ntitle: headers\ndescription: Add custom HTTP headers to your Next.js app.\nsource: app/api-reference/config/next-config-js/headers\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "httpAgentOptions.mdx#0",
    "metadata": {
      "title": "httpAgentOptions",
      "description": "Next.js will automatically use HTTP Keep-Alive by default. Learn more about how to disable HTTP Keep-Alive here."
    },
    "content": "---\ntitle: httpAgentOptions\ndescription: Next.js will automatically use HTTP Keep-Alive by default. Learn more about how to disable HTTP Keep-Alive here.\nsource: app/api-reference/config/next-config-js/httpAgentOptions\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "images.mdx#0",
    "metadata": {
      "title": "images",
      "description": "Custom configuration for the next/image loader"
    },
    "content": "---\ntitle: images\ndescription: Custom configuration for the next/image loader\nsource: app/api-reference/config/next-config-js/images\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "next.config.js Options",
      "description": "Learn about the options available in next.config.js for the Pages Router."
    },
    "content": "---\ntitle: next.config.js Options\ndescription: Learn about the options available in next.config.js for the Pages Router.\nsource: app/api-reference/config/next-config-js\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "isolatedDevBuild.mdx#0",
    "metadata": {
      "title": "isolatedDevBuild",
      "description": "Use isolated directories for development builds to prevent conflicts with production builds."
    },
    "content": "---\ntitle: isolatedDevBuild\ndescription: Use isolated directories for development builds to prevent conflicts with production builds.\nsource: app/api-reference/config/next-config-js/isolatedDevBuild\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "onDemandEntries.mdx#0",
    "metadata": {
      "title": "onDemandEntries",
      "description": "Configure how Next.js will dispose and keep in memory pages created in development."
    },
    "content": "---\ntitle: onDemandEntries\ndescription: Configure how Next.js will dispose and keep in memory pages created in development.\nsource: app/api-reference/config/next-config-js/onDemandEntries\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "optimizePackageImports.mdx#0",
    "metadata": {
      "title": "optimizePackageImports",
      "description": "API Reference for optimizePackageImports Next.js Config Option"
    },
    "content": "---\ntitle: optimizePackageImports\ndescription: API Reference for optimizePackageImports Next.js Config Option\nsource: app/api-reference/config/next-config-js/optimizePackageImports\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "output.mdx#0",
    "metadata": {
      "title": "output",
      "description": "Next.js automatically traces which files are needed by each page to allow for easy deployment of your application. Learn how it works here."
    },
    "content": "---\ntitle: output\ndescription: Next.js automatically traces which files are needed by each page to allow for easy deployment of your application. Learn how it works here.\nsource: app/api-reference/config/next-config-js/output\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "pageExtensions.mdx#0",
    "metadata": {
      "title": "pageExtensions",
      "description": "Extend the default page extensions used by Next.js when resolving pages in the Pages Router."
    },
    "content": "---\ntitle: pageExtensions\ndescription: Extend the default page extensions used by Next.js when resolving pages in the Pages Router.\nsource: app/api-reference/config/next-config-js/pageExtensions\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "poweredByHeader.mdx#0",
    "metadata": {
      "title": "poweredByHeader",
      "description": "Next.js will add the `x-powered-by` header by default. Learn to opt-out of it here."
    },
    "content": "---\ntitle: poweredByHeader\ndescription: Next.js will add the `x-powered-by` header by default. Learn to opt-out of it here.\nsource: app/api-reference/config/next-config-js/poweredByHeader\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "productionBrowserSourceMaps.mdx#0",
    "metadata": {
      "title": "productionBrowserSourceMaps",
      "description": "Enables browser source map generation during the production build."
    },
    "content": "---\ntitle: productionBrowserSourceMaps\ndescription: Enables browser source map generation during the production build.\nsource: app/api-reference/config/next-config-js/productionBrowserSourceMaps\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "proxyClientMaxBodySize.mdx#0",
    "metadata": {
      "title": "experimental.proxyClientMaxBodySize",
      "description": "Configure the maximum request body size when using proxy."
    },
    "content": "---\ntitle: experimental.proxyClientMaxBodySize\ndescription: Configure the maximum request body size when using proxy.\nsource: app/api-reference/config/next-config-js/proxyClientMaxBodySize\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "reactStrictMode.mdx#0",
    "metadata": {
      "title": "reactStrictMode",
      "description": "The complete Next.js runtime is now Strict Mode-compliant, learn how to opt-in"
    },
    "content": "---\ntitle: reactStrictMode\ndescription: The complete Next.js runtime is now Strict Mode-compliant, learn how to opt-in\nsource: app/api-reference/config/next-config-js/reactStrictMode\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "redirects.mdx#0",
    "metadata": {
      "title": "redirects",
      "description": "Add redirects to your Next.js app."
    },
    "content": "---\ntitle: redirects\ndescription: Add redirects to your Next.js app.\nsource: app/api-reference/config/next-config-js/redirects\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "rewrites.mdx#0",
    "metadata": {
      "title": "rewrites",
      "description": "Add rewrites to your Next.js app."
    },
    "content": "---\ntitle: rewrites\ndescription: Add rewrites to your Next.js app.\nsource: app/api-reference/config/next-config-js/rewrites\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "serverExternalPackages.mdx#0",
    "metadata": {
      "title": "serverExternalPackages",
      "description": "Opt-out specific dependencies from the dependency bundling enabled by `bundlePagesRouterDependencies`."
    },
    "content": "---\ntitle: serverExternalPackages\ndescription: Opt-out specific dependencies from the dependency bundling enabled by `bundlePagesRouterDependencies`.\n---\n\nOpt-out specific dependencies from being included in the automatic bundling of the [`bundlePagesRouterDependencies`](/docs/pages/api-reference/config/next-config-js/bundlePagesRouterDependencies) option.\n\nThese pages will then use native Node.js `require` to resolve the dependency.\n\n```js filename=\"next.config.js\"\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  serverExternalPackages: ['@acme/ui'],\n}\n\nmodule.exports = nextConfig"
  },
  {
    "id": "serverExternalPackages.mdx#1",
    "metadata": {
      "title": "serverExternalPackages",
      "description": "Opt-out specific dependencies from the dependency bundling enabled by `bundlePagesRouterDependencies`."
    },
    "content": "```\n\nNext.js includes a [short list of popular packages](https://github.com/vercel/next.js/blob/canary/packages/next/src/lib/server-external-packages.json) that currently are working on compatibility and automatically opt-ed out:"
  },
  {
    "id": "serverExternalPackages.mdx#2",
    "metadata": {
      "title": "serverExternalPackages",
      "description": "Opt-out specific dependencies from the dependency bundling enabled by `bundlePagesRouterDependencies`."
    },
    "content": "- `@appsignal/nodejs`\n- `@aws-sdk/client-s3`\n- `@aws-sdk/s3-presigned-post`\n- `@blockfrost/blockfrost-js`\n- `@highlight-run/node`\n- `@huggingface/transformers`\n- `@jpg-store/lucid-cardano`\n- `@libsql/client`\n- `@mikro-orm/core`\n- `@mikro-orm/knex`\n- `@node-rs/argon2`\n- `@node-rs/bcrypt`\n- `@prisma/client`\n- `@react-pdf/renderer`\n- `@sentry/profiling-node`\n- `@sparticuz/chromium`\n- `@sparticuz/chromium-min`\n- `@statsig/statsig-node-core`\n- `@swc/core`\n- `@xenova/transformers`\n- `argon2`\n- `autoprefixer`\n- `aws-crt`\n- `bcrypt`\n- `better-sqlite3`\n- `canvas`\n- `chromadb-default-embed`\n- `config`\n- `cpu-features`\n- `cypress`\n- `dd-trace`\n- `eslint`\n- `express`\n- `firebase-admin`\n- `htmlrewriter`\n- `import-in-the-middle`\n- `isolated-vm`\n- `jest`\n- `jsdom`\n- `keyv`\n- `libsql`\n- `mdx-bundler`\n- `mongodb`\n- `mongoose`\n- `newrelic`\n- `next-mdx-remote`\n- `next-seo`\n- `node-cron`\n- `node-pty`\n- `node-web-audio-api`\n- `onnxruntime-node`\n- `oslo`\n- `pg`\n- `playwright`\n- `playwright-core`\n- `postcss`\n- `prettier`\n- `prisma`\n- `puppeteer-core`\n- `puppeteer`\n- `ravendb`\n- `require-in-the-middle`\n- `rimraf`\n- `sharp`\n- `shiki`\n- `sqlite3`\n- `ts-node`\n- `ts-morph`\n- `typescript`"
  },
  {
    "id": "serverExternalPackages.mdx#3",
    "metadata": {
      "title": "serverExternalPackages",
      "description": "Opt-out specific dependencies from the dependency bundling enabled by `bundlePagesRouterDependencies`."
    },
    "content": "- `postcss`\n- `prettier`\n- `prisma`\n- `puppeteer-core`\n- `puppeteer`\n- `ravendb`\n- `require-in-the-middle`\n- `rimraf`\n- `sharp`\n- `shiki`\n- `sqlite3`\n- `ts-node`\n- `ts-morph`\n- `typescript`\n- `vscode-oniguruma`\n- `webpack`\n- `websocket`\n- `zeromq`"
  },
  {
    "id": "trailingSlash.mdx#0",
    "metadata": {
      "title": "trailingSlash",
      "description": "Configure Next.js pages to resolve with or without a trailing slash."
    },
    "content": "---\ntitle: trailingSlash\ndescription: Configure Next.js pages to resolve with or without a trailing slash.\nsource: app/api-reference/config/next-config-js/trailingSlash\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "transpilePackages.mdx#0",
    "metadata": {
      "title": "transpilePackages",
      "description": "Automatically transpile and bundle dependencies from local packages (like monorepos) or from external dependencies (`node_modules`)."
    },
    "content": "---\ntitle: transpilePackages\ndescription: Automatically transpile and bundle dependencies from local packages (like monorepos) or from external dependencies (`node_modules`).\nsource: app/api-reference/config/next-config-js/transpilePackages\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "turbopack.mdx#0",
    "metadata": {
      "title": "turbopack",
      "description": "Configure Next.js with Turbopack-specific options"
    },
    "content": "---\ntitle: turbopack\ndescription: Configure Next.js with Turbopack-specific options\nversion: experimental\nsource: app/api-reference/config/next-config-js/turbopack\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "typescript.mdx#0",
    "metadata": {
      "title": "typescript",
      "description": "Next.js reports TypeScript errors by default. Learn to opt-out of this behavior here."
    },
    "content": "---\ntitle: typescript\ndescription: Next.js reports TypeScript errors by default. Learn to opt-out of this behavior here.\nsource: app/api-reference/config/next-config-js/typescript\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "urlImports.mdx#0",
    "metadata": {
      "title": "urlImports",
      "description": "Configure Next.js to allow importing modules from external URLs."
    },
    "content": "---\ntitle: urlImports\ndescription: Configure Next.js to allow importing modules from external URLs.\nversion: experimental\nsource: app/api-reference/config/next-config-js/urlImports\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "useLightningcss.mdx#0",
    "metadata": {
      "title": "useLightningcss",
      "description": "Enable experimental support for Lightning CSS."
    },
    "content": "---\ntitle: useLightningcss\ndescription: Enable experimental support for Lightning CSS.\nversion: experimental\nsource: app/api-reference/config/next-config-js/useLightningcss\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "webVitalsAttribution.mdx#0",
    "metadata": {
      "title": "webVitalsAttribution",
      "description": "Learn how to use the webVitalsAttribution option to pinpoint the source of Web Vitals issues."
    },
    "content": "---\ntitle: webVitalsAttribution\ndescription: Learn how to use the webVitalsAttribution option to pinpoint the source of Web Vitals issues.\nsource: app/api-reference/config/next-config-js/webVitalsAttribution\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "webpack.mdx#0",
    "metadata": {
      "title": "Custom Webpack Config",
      "description": "Learn how to customize the webpack config used by Next.js"
    },
    "content": "---\ntitle: Custom Webpack Config\nnav_title: webpack\ndescription: Learn how to customize the webpack config used by Next.js\nsource: app/api-reference/config/next-config-js/webpack\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "01-typescript.mdx#0",
    "metadata": {
      "title": "TypeScript",
      "description": "Next.js provides a TypeScript-first development experience for building your React application."
    },
    "content": "---\ntitle: TypeScript\ndescription: Next.js provides a TypeScript-first development experience for building your React application.\nsource: app/api-reference/config/typescript\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "02-eslint.mdx#0",
    "metadata": {
      "title": "ESLint",
      "description": "Next.js reports ESLint errors and warnings during builds by default. Learn how to opt-out of this behavior here."
    },
    "content": "---\ntitle: ESLint\ndescription: Next.js reports ESLint errors and warnings during builds by default. Learn how to opt-out of this behavior here.\nsource: app/api-reference/config/eslint\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Configuration",
      "description": "Learn how to configure your Next.js application."
    },
    "content": "---\ntitle: Configuration\ndescription: Learn how to configure your Next.js application.\n---"
  },
  {
    "id": "create-next-app.mdx#0",
    "metadata": {
      "title": "create-next-app CLI",
      "description": "Create Next.js apps using one command with the create-next-app CLI."
    },
    "content": "---\ntitle: create-next-app CLI\ndescription: Create Next.js apps using one command with the create-next-app CLI.\nsource: app/api-reference/cli/create-next-app\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "CLI",
      "description": "API Reference for the Next.js Command Line Interface (CLI) tools."
    },
    "content": "---\ntitle: CLI\ndescription: API Reference for the Next.js Command Line Interface (CLI) tools.\nsource: app/api-reference/cli\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "next.mdx#0",
    "metadata": {
      "title": "next CLI",
      "description": "Learn how to run and build your application with the Next.js CLI."
    },
    "content": "---\ntitle: next CLI\ndescription: Learn how to run and build your application with the Next.js CLI.\nsource: app/api-reference/cli/next\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "06-edge.mdx#0",
    "metadata": {
      "title": "Edge Runtime",
      "description": "API Reference for the Edge Runtime."
    },
    "content": "---\ntitle: Edge Runtime\ndescription: API Reference for the Edge Runtime.\nsource: app/api-reference/edge\n---\n\n{/* DO NOT EDIT. The content of this doc is generated from the source above. To edit the content of this page, navigate to the source page in your editor. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}"
  },
  {
    "id": "08-turbopack.mdx#0",
    "metadata": {
      "title": "Turbopack",
      "description": "Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js."
    },
    "content": "---\ntitle: Turbopack\ndescription: Turbopack is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js.\nsource: app/api-reference/turbopack\n---"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "API Reference",
      "description": "Next.js API Reference for the Pages Router."
    },
    "content": "---\ntitle: API Reference\ndescription: Next.js API Reference for the Pages Router.\n---"
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Pages Router",
      "description": "Before Next.js 13, the Pages Router was the main way to create routes in Next.js with an intuitive file-system router."
    },
    "content": "---\ntitle: Pages Router\ndescription: Before Next.js 13, the Pages Router was the main way to create routes in Next.js with an intuitive file-system router.\n---\n\n> You're viewing the documentation for the Pages Router. See the [App Router](/docs/app) documentation for the latest features.\n\nThe **Pages Router** uses an intuitive file-system router to map each file to a route.\n\nBefore Next.js 13, the Pages Router was the main way to create routes in Next.js. It's still supported in newer versions of Next.js, but we recommend migrating to the new [App Router](/docs/app) to leverage React's latest features."
  },
  {
    "id": "accessibility.mdx#0",
    "metadata": {
      "title": "Accessibility",
      "description": "The built-in accessibility features of Next.js."
    },
    "content": "---\ntitle: Accessibility\ndescription: The built-in accessibility features of Next.js.\n---\n\nThe Next.js team is committed to making Next.js accessible to all developers (and their end-users). By adding accessibility features to Next.js by default, we aim to make the Web more inclusive for everyone.\n\n## Route Announcements\n\nWhen transitioning between pages rendered on the server (e.g. using the `<a href>` tag) screen readers and other assistive technology announce the page title when the page loads so that users understand that the page has changed.\n\nIn addition to traditional page navigations, Next.js also supports client-side transitions for improved performance (using `next/link`). To ensure that client-side transitions are also announced to assistive technology, Next.js includes a route announcer by default.\n\nThe Next.js route announcer looks for the page name to announce by first inspecting `document.title`, then the `<h1>` element, and finally the URL pathname. For the most accessible user experience, ensure that each page in your application has a unique and descriptive title."
  },
  {
    "id": "accessibility.mdx#1",
    "metadata": {
      "title": "Accessibility",
      "description": "The built-in accessibility features of Next.js."
    },
    "content": "## Linting\n\nNext.js provides an [integrated ESLint experience](/docs/pages/api-reference/config/eslint) out of the box, including custom rules for Next.js. By default, Next.js includes `eslint-plugin-jsx-a11y` to help catch accessibility issues early, including warning on:\n\n- [aria-props](https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/aria-props.md?rgh-link-date=2021-06-04T02%3A10%3A36Z)\n- [aria-proptypes](https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/aria-proptypes.md?rgh-link-date=2021-06-04T02%3A10%3A36Z)\n- [aria-unsupported-elements](https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/aria-unsupported-elements.md?rgh-link-date=2021-06-04T02%3A10%3A36Z)\n- [role-has-required-aria-props](https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/role-has-required-aria-props.md?rgh-link-date=2021-06-04T02%3A10%3A36Z)\n- [role-supports-aria-props](https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/role-supports-aria-props.md?rgh-link-date=2021-06-04T02%3A10%3A36Z)"
  },
  {
    "id": "accessibility.mdx#2",
    "metadata": {
      "title": "Accessibility",
      "description": "The built-in accessibility features of Next.js."
    },
    "content": "For example, this plugin helps ensure you add alt text to `img` tags, use correct `aria-*` attributes, use correct `role` attributes, and more."
  },
  {
    "id": "accessibility.mdx#3",
    "metadata": {
      "title": "Accessibility",
      "description": "The built-in accessibility features of Next.js."
    },
    "content": "## Accessibility Resources\n\n- [WebAIM WCAG checklist](https://webaim.org/standards/wcag/checklist)\n- [WCAG 2.2 Guidelines](https://www.w3.org/TR/WCAG22/)\n- [The A11y Project](https://www.a11yproject.com/)\n- Check [color contrast ratios](https://developer.mozilla.org/docs/Web/Accessibility/Understanding_WCAG/Perceivable/Color_contrast) between foreground and background elements\n- Use [`prefers-reduced-motion`](https://web.dev/prefers-reduced-motion/) when working with animations"
  },
  {
    "id": "fast-refresh.mdx#0",
    "metadata": {
      "title": "Fast Refresh",
      "description": "Fast Refresh is a hot module reloading experience that gives you instantaneous feedback on edits made to your React components."
    },
    "content": "---\ntitle: Fast Refresh\ndescription: Fast Refresh is a hot module reloading experience that gives you instantaneous feedback on edits made to your React components.\n---\n\nFast refresh is a React feature integrated into Next.js that allows you to live reload the browser page while maintaining temporary client-side state when you save changes to a file. It's enabled by default in all Next.js applications on **9.4 or newer**. With Fast Refresh enabled, most edits should be visible within a second."
  },
  {
    "id": "fast-refresh.mdx#1",
    "metadata": {
      "title": "Fast Refresh",
      "description": "Fast Refresh is a hot module reloading experience that gives you instantaneous feedback on edits made to your React components."
    },
    "content": "## How It Works\n\n- If you edit a file that **only exports React component(s)**, Fast Refresh will\n  update the code only for that file, and re-render your component. You can edit\n  anything in that file, including styles, rendering logic, event handlers, or\n  effects.\n- If you edit a file with exports that _aren't_ React components, Fast Refresh\n  will re-run both that file, and the other files importing it. So if both\n  `Button.js` and `Modal.js` import `theme.js`, editing `theme.js` will update\n  both components.\n- Finally, if you **edit a file** that's **imported by files outside of the\n  React tree**, Fast Refresh **will fall back to doing a full reload**. You\n  might have a file which renders a React component but also exports a value\n  that is imported by a **non-React component**. For example, maybe your\n  component also exports a constant, and a non-React utility file imports it. In\n  that case, consider migrating the constant to a separate file and importing it\n  into both files. This will re-enable Fast Refresh to work. Other cases can\n  usually be solved in a similar way."
  },
  {
    "id": "fast-refresh.mdx#2",
    "metadata": {
      "title": "Fast Refresh",
      "description": "Fast Refresh is a hot module reloading experience that gives you instantaneous feedback on edits made to your React components."
    },
    "content": "## Error Resilience\n\n### Syntax Errors\n\nIf you make a syntax error during development, you can fix it and save the file\nagain. The error will disappear automatically, so you won't need to reload the\napp. **You will not lose component state**.\n\n### Runtime Errors\n\nIf you make a mistake that leads to a runtime error inside your component,\nyou'll be greeted with a contextual overlay. Fixing the error will automatically\ndismiss the overlay, without reloading the app.\n\nComponent state will be retained if the error did not occur during rendering. If\nthe error did occur during rendering, React will remount your application using\nthe updated code.\n\nIf you have [error boundaries](https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary)\nin your app (which is a good idea for graceful failures in production), they\nwill retry rendering on the next edit after a rendering error. This means having\nan error boundary can prevent you from always getting reset to the root app\nstate. However, keep in mind that error boundaries shouldn't be _too_ granular.\nThey are used by React in production, and should always be designed\nintentionally."
  },
  {
    "id": "fast-refresh.mdx#3",
    "metadata": {
      "title": "Fast Refresh",
      "description": "Fast Refresh is a hot module reloading experience that gives you instantaneous feedback on edits made to your React components."
    },
    "content": "## Limitations\n\nFast Refresh tries to preserve local React state in the component you're\nediting, but only if it's safe to do so. Here's a few reasons why you might see\nlocal state being reset on every edit to a file:\n\n- Local state is not preserved for class components (only function components\n  and Hooks preserve state).\n- The file you're editing might have _other_ exports in addition to a React\n  component.\n- Sometimes, a file would export the result of calling a higher-order component\n  like `HOC(WrappedComponent)`. If the returned component is a\n  class, its state will be reset.\n- Anonymous arrow functions like `export default () => <div />;` cause Fast Refresh to not preserve local component state. For large codebases you can use our [`name-default-component` codemod](/docs/pages/guides/upgrading/codemods#name-default-component).\n\nAs more of your codebase moves to function components and Hooks, you can expect\nstate to be preserved in more cases."
  },
  {
    "id": "fast-refresh.mdx#4",
    "metadata": {
      "title": "Fast Refresh",
      "description": "Fast Refresh is a hot module reloading experience that gives you instantaneous feedback on edits made to your React components."
    },
    "content": "## Tips\n\n- Fast Refresh preserves React local state in function components (and Hooks) by\n  default.\n- Sometimes you might want to _force_ the state to be reset, and a component to\n  be remounted. For example, this can be handy if you're tweaking an animation\n  that only happens on mount. To do this, you can add `// @refresh reset`\n  anywhere in the file you're editing. This directive is local to the file, and\n  instructs Fast Refresh to remount components defined in that file on every\n  edit.\n- You can put `console.log` or `debugger;` into the components you edit during\n  development.\n- Remember that imports are case sensitive. Both fast and full refresh can fail,\n  when your import doesn't match the actual filename.\n  For example, `'./header'` vs `'./Header'`."
  },
  {
    "id": "fast-refresh.mdx#5",
    "metadata": {
      "title": "Fast Refresh",
      "description": "Fast Refresh is a hot module reloading experience that gives you instantaneous feedback on edits made to your React components."
    },
    "content": "## Fast Refresh and Hooks\n\nWhen possible, Fast Refresh attempts to preserve the state of your component\nbetween edits. In particular, `useState` and `useRef` preserve their previous\nvalues as long as you don't change their arguments or the order of the Hook\ncalls.\n\nHooks with dependencies—such as `useEffect`, `useMemo`, and `useCallback`—will\n_always_ update during Fast Refresh. Their list of dependencies will be ignored\nwhile Fast Refresh is happening.\n\nFor example, when you edit `useMemo(() => x * 2, [x])` to\n`useMemo(() => x * 10, [x])`, it will re-run even though `x` (the dependency)\nhas not changed. If React didn't do that, your edit wouldn't reflect on the\nscreen!\n\nSometimes, this can lead to unexpected results. For example, even a `useEffect`\nwith an empty array of dependencies would still re-run once during Fast Refresh.\n\nHowever, writing code resilient to occasional re-running of `useEffect` is a good practice even\nwithout Fast Refresh. It will make it easier for you to introduce new dependencies to it later on\nand it's enforced by [React Strict Mode](/docs/pages/api-reference/config/next-config-js/reactStrictMode),\nwhich we highly recommend enabling."
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Architecture",
      "description": "How Next.js Works"
    },
    "content": "---\ntitle: Architecture\ndescription: How Next.js Works\n---\n\nLearn about the Next.js architecture and how it works under the hood."
  },
  {
    "id": "nextjs-compiler.mdx#0",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "---\ntitle: Next.js Compiler\ndescription: Next.js Compiler, written in Rust, which transforms and minifies your Next.js application.\n---\n\nThe Next.js Compiler, written in Rust using [SWC](https://swc.rs/), allows Next.js to transform and minify your JavaScript code for production. This replaces Babel for individual files and Terser for minifying output bundles.\n\nCompilation using the Next.js Compiler is 17x faster than Babel and enabled by default since Next.js version 12. If you have an existing Babel configuration or are using [unsupported features](#unsupported-features), your application will opt-out of the Next.js Compiler and continue using Babel."
  },
  {
    "id": "nextjs-compiler.mdx#1",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "## Why SWC?\n\n[SWC](https://swc.rs/) is an extensible Rust-based platform for the next generation of fast developer tools.\n\nSWC can be used for compilation, minification, bundling, and more – and is designed to be extended. It's something you can call to perform code transformations (either built-in or custom). Running those transformations happens through higher-level tools like Next.js.\n\nWe chose to build on SWC for a few reasons:\n\n- **Extensibility:** SWC can be used as a Crate inside Next.js, without having to fork the library or workaround design constraints.\n- **Performance:** We were able to achieve ~3x faster Fast Refresh and ~5x faster builds in Next.js by switching to SWC, with more room for optimization still in progress.\n- **WebAssembly:** Rust's support for WASM is essential for supporting all possible platforms and taking Next.js development everywhere.\n- **Community:** The Rust community and ecosystem are amazing and still growing."
  },
  {
    "id": "nextjs-compiler.mdx#2",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "## Supported Features"
  },
  {
    "id": "nextjs-compiler.mdx#3",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "### Styled Components\n\nWe're working to port `babel-plugin-styled-components` to the Next.js Compiler.\n\nFirst, update to the latest version of Next.js: `npm install next@latest`. Then, update your `next.config.js` file:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  compiler: {\n    styledComponents: true,\n  },\n}"
  },
  {
    "id": "nextjs-compiler.mdx#4",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "```\n\nFor advanced use cases, you can configure individual properties for styled-components compilation.\n\n> Note: `ssr` and `displayName` transforms are the main requirement for using `styled-components` in Next.js.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  compiler: {\n    // see https://styled-components.com/docs/tooling#babel-plugin for more info on the options.\n    styledComponents: {\n      // Enabled by default in development, disabled in production to reduce file size,\n      // setting this will override the default for all environments.\n      displayName?: boolean,\n      // Enabled by default.\n      ssr?: boolean,\n      // Enabled by default.\n      fileName?: boolean,\n      // Empty by default.\n      topLevelImportPaths?: string[],\n      // Defaults to [\"index\"].\n      meaninglessFileNames?: string[],\n      // Enabled by default.\n      minify?: boolean,\n      // Enabled by default.\n      transpileTemplateLiterals?: boolean,\n      // Empty by default.\n      namespace?: string,\n      // Disabled by default.\n      pure?: boolean,\n      // Enabled by default.\n      cssProp?: boolean,\n    },\n  },\n}\n```"
  },
  {
    "id": "nextjs-compiler.mdx#5",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "### Jest\n\nThe Next.js Compiler transpiles your tests and simplifies configuring Jest together with Next.js including:\n\n- Auto mocking of `.css`, `.module.css` (and their `.scss` variants), and image imports\n- Automatically sets up `transform` using SWC\n- Loading `.env` (and all variants) into `process.env`\n- Ignores `node_modules` from test resolving and transforms\n- Ignoring `.next` from test resolving\n- Loads `next.config.js` for flags that enable experimental SWC transforms\n\nFirst, update to the latest version of Next.js: `npm install next@latest`. Then, update your `jest.config.js` file:\n\n```js filename=\"jest.config.js\"\nconst nextJest = require('next/jest')\n\n// Providing the path to your Next.js app which will enable loading next.config.js and .env files\nconst createJestConfig = nextJest({ dir: './' })\n\n// Any custom config you want to pass to Jest\nconst customJestConfig = {\n  setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],\n}\n\n// createJestConfig is exported in this way to ensure that next/jest can load the Next.js configuration, which is async\nmodule.exports = createJestConfig(customJestConfig)\n```"
  },
  {
    "id": "nextjs-compiler.mdx#6",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "### Relay\n\nTo enable [Relay](https://relay.dev/) support:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  compiler: {\n    relay: {\n      // This should match relay.config.js\n      src: './',\n      artifactDirectory: './__generated__',\n      language: 'typescript',\n      eagerEsModules: false,\n    },\n  },\n}\n```\n\n> **Good to know**: In Next.js, all JavaScript files in `pages` directory are considered routes. So, for `relay-compiler` you'll need to specify `artifactDirectory` configuration settings outside of the `pages`, otherwise `relay-compiler` will generate files next to the source file in the `__generated__` directory, and this file will be considered a route, which will break production builds."
  },
  {
    "id": "nextjs-compiler.mdx#7",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "### Remove React Properties\n\nAllows to remove JSX properties. This is often used for testing. Similar to `babel-plugin-react-remove-properties`.\n\nTo remove properties matching the default regex `^data-test`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  compiler: {\n    reactRemoveProperties: true,\n  },\n}\n```\n\nTo remove custom properties:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  compiler: {\n    // The regexes defined here are processed in Rust so the syntax is different from\n    // JavaScript `RegExp`s. See https://docs.rs/regex.\n    reactRemoveProperties: { properties: ['^data-custom$'] },\n  },\n}\n```\n\n### Remove Console\n\nThis transform allows for removing all `console.*` calls in application code (not `node_modules`). Similar to `babel-plugin-transform-remove-console`.\n\nRemove all `console.*` calls:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  compiler: {\n    removeConsole: true,\n  },\n}\n```\n\nRemove `console.*` output except `console.error`:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  compiler: {\n    removeConsole: {\n      exclude: ['error'],\n    },\n  },\n}\n```"
  },
  {
    "id": "nextjs-compiler.mdx#8",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "### Legacy Decorators\n\nNext.js will automatically detect `experimentalDecorators` in `jsconfig.json` or `tsconfig.json`. Legacy decorators are commonly used with older versions of libraries like `mobx`.\n\nThis flag is only supported for compatibility with existing applications. We do not recommend using legacy decorators in new applications.\n\nFirst, update to the latest version of Next.js: `npm install next@latest`. Then, update your `jsconfig.json` or `tsconfig.json` file:\n\n```js\n{\n  \"compilerOptions\": {\n    \"experimentalDecorators\": true\n  }\n}\n```\n\n### importSource\n\nNext.js will automatically detect `jsxImportSource` in `jsconfig.json` or `tsconfig.json` and apply that. This is commonly used with libraries like [Theme UI](https://theme-ui.com).\n\nFirst, update to the latest version of Next.js: `npm install next@latest`. Then, update your `jsconfig.json` or `tsconfig.json` file:\n\n```js\n{\n  \"compilerOptions\": {\n    \"jsxImportSource\": \"theme-ui\"\n  }\n}\n```"
  },
  {
    "id": "nextjs-compiler.mdx#9",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "### Emotion\n\nWe're working to port `@emotion/babel-plugin` to the Next.js Compiler.\n\nFirst, update to the latest version of Next.js: `npm install next@latest`. Then, update your `next.config.js` file:\n\n```js filename=\"next.config.js\""
  },
  {
    "id": "nextjs-compiler.mdx#10",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "module.exports = {\n  compiler: {\n    emotion: boolean | {\n      // default is true. It will be disabled when build type is production.\n      sourceMap?: boolean,\n      // default is 'dev-only'.\n      autoLabel?: 'never' | 'dev-only' | 'always',\n      // default is '[local]'.\n      // Allowed values: `[local]` `[filename]` and `[dirname]`\n      // This option only works when autoLabel is set to 'dev-only' or 'always'.\n      // It allows you to define the format of the resulting label.\n      // The format is defined via string where variable parts are enclosed in square brackets [].\n      // For example labelFormat: \"my-classname--[local]\", where [local] will be replaced with the name of the variable the result is assigned to.\n      labelFormat?: string,\n      // default is undefined.\n      // This option allows you to tell the compiler what imports it should\n      // look at to determine what it should transform so if you re-export\n      // Emotion's exports, you can still use transforms.\n      importMap?: {\n        [packageName: string]: {\n          [exportName: string]: {\n            canonicalImport?: [string, string],\n            styledBaseImport?: [string, string],\n          }"
  },
  {
    "id": "nextjs-compiler.mdx#11",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "importMap?: {\n        [packageName: string]: {\n          [exportName: string]: {\n            canonicalImport?: [string, string],\n            styledBaseImport?: [string, string],\n          }\n        }\n      },\n    },\n  },\n}\n```"
  },
  {
    "id": "nextjs-compiler.mdx#12",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "### Minification\n\nNext.js' swc compiler is used for minification by default since v13. This is 7x faster than Terser.\n\n> **Good to know:** Starting with v15, minification cannot be customized using `next.config.js`. Support for the `swcMinify` flag has been removed.\n\n### Module Transpilation\n\nNext.js can automatically transpile and bundle dependencies from local packages (like monorepos) or from external dependencies (`node_modules`). This replaces the `next-transpile-modules` package.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  transpilePackages: ['@acme/ui', 'lodash-es'],\n}\n```\n\n### Modularize Imports\n\nThis option has been superseded by [`optimizePackageImports`](/docs/app/api-reference/config/next-config-js/optimizePackageImports) in Next.js 13.5. We recommend upgrading to use the new option that does not require manual configuration of import paths."
  },
  {
    "id": "nextjs-compiler.mdx#13",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "### Define (Replacing variables during build)\n\nThe `define` option allows you to statically replace variables in your code at build-time.\nThe option takes an object as key-value pairs, where the keys are the variables that should be replaced with the corresponding values.\n\nUse the `compiler.define` field in `next.config.js` to define variables for all environments (server, edge, and client). Or, use `compiler.defineServer` to define variables only for server-side (server and edge) code:\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  compiler: {\n    define: {\n      MY_VARIABLE: 'my-string',\n      'process.env.MY_ENV_VAR': 'my-env-var',\n    },\n    defineServer: {\n      MY_SERVER_VARIABLE: 'my-server-var',\n    },\n  },\n}\n```"
  },
  {
    "id": "nextjs-compiler.mdx#14",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "### Build Lifecycle Hooks\n\nThe Next.js Compiler supports lifecycle hooks that allow you to run custom code at specific points during the build process. Currently, the following hook is supported:\n\n#### runAfterProductionCompile\n\nA hook function that executes after production build compilation finishes, but before running post-compilation tasks such as type checking and static page generation. This hook provides access to project metadata including the project directory and build output directory, making it useful for third-party tools to collect build outputs like sourcemaps.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  compiler: {\n    runAfterProductionCompile: async ({ distDir, projectDir }) => {\n      // Your custom code here\n    },\n  },\n}\n```\n\nThe hook receives an object with the following properties:\n\n- `distDir`: The build output directory (defaults to `.next`)\n- `projectDir`: The root directory of the project"
  },
  {
    "id": "nextjs-compiler.mdx#15",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "## Experimental Features\n\n### SWC Trace profiling\n\nYou can generate SWC's internal transform traces as chromium's [trace event format](https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/preview?mode=html#%21=).\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  experimental: {\n    swcTraceProfiling: true,\n  },\n}\n```\n\nOnce enabled, swc will generate trace named as `swc-trace-profile-${timestamp}.json` under `.next/`. Chromium's trace viewer (chrome://tracing/, https://ui.perfetto.dev/), or compatible flamegraph viewer (https://www.speedscope.app/) can load & visualize generated traces."
  },
  {
    "id": "nextjs-compiler.mdx#16",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "### SWC Plugins (experimental)\n\nYou can configure swc's transform to use SWC's experimental plugin support written in wasm to customize transformation behavior.\n\n```js filename=\"next.config.js\"\nmodule.exports = {\n  experimental: {\n    swcPlugins: [\n      [\n        'plugin',\n        {\n          ...pluginOptions,\n        },\n      ],\n    ],\n  },\n}\n```\n\n`swcPlugins` accepts an array of tuples for configuring plugins. A tuple for the plugin contains the path to the plugin and an object for plugin configuration. The path to the plugin can be an npm module package name or an absolute path to the `.wasm` binary itself."
  },
  {
    "id": "nextjs-compiler.mdx#17",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "## Unsupported Features\n\nWhen your application has a `.babelrc` file, Next.js will automatically fall back to using Babel for transforming individual files. This ensures backwards compatibility with existing applications that leverage custom Babel plugins.\n\nIf you're using a custom Babel setup, [please share your configuration](https://github.com/vercel/next.js/discussions/30174). We're working to port as many commonly used Babel transformations as possible, as well as supporting plugins in the future."
  },
  {
    "id": "nextjs-compiler.mdx#18",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "## Version History"
  },
  {
    "id": "nextjs-compiler.mdx#19",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "| Version   | Changes                                                                                                                                                                                                  |\n| --------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `v13.1.0` | [Module Transpilation](https://nextjs.org/blog/next-13-1#built-in-module-transpilation-stable) and [Modularize Imports](https://nextjs.org/blog/next-13-1#import-resolution-for-smaller-bundles) stable. |\n| `v13.0.0` | SWC Minifier enabled by default.                                                                                                                                                                         |\n| `v12.3.0` | SWC Minifier [stable](https://nextjs.org/blog/next-12-3#swc-minifier-stable).                                                                                                                            |"
  },
  {
    "id": "nextjs-compiler.mdx#20",
    "metadata": {
      "title": "Next.js Compiler",
      "description": "Next.js Compiler, written in Rust, which transforms and minifies your Next.js application."
    },
    "content": "| `v12.2.0` | [SWC Plugins](#swc-plugins-experimental) experimental support added.                                                                                                                                     |\n| `v12.1.0` | Added support for Styled Components, Jest, Relay, Remove React Properties, Legacy Decorators, Remove Console, and jsxImportSource.                                                                       |\n| `v12.0.0` | Next.js Compiler [introduced](https://nextjs.org/blog/next-12).                                                                                                                                          |"
  },
  {
    "id": "supported-browsers.mdx#0",
    "metadata": {
      "title": "Supported Browsers",
      "description": "Browser support and which JavaScript features are supported by Next.js."
    },
    "content": "---\ntitle: Supported Browsers\ndescription: Browser support and which JavaScript features are supported by Next.js.\n---\n\nNext.js supports **modern browsers** with zero configuration.\n\n- Chrome 111+\n- Edge 111+\n- Firefox 111+\n- Safari 16.4+\n\n## Browserslist\n\nIf you would like to target specific browsers or features, Next.js supports [Browserslist](https://browsersl.ist) configuration in your `package.json` file. Next.js uses the following Browserslist configuration by default:\n\n```json filename=\"package.json\"\n{\n  \"browserslist\": [\"chrome 111\", \"edge 111\", \"firefox 111\", \"safari 16.4\"]\n}\n```"
  },
  {
    "id": "supported-browsers.mdx#1",
    "metadata": {
      "title": "Supported Browsers",
      "description": "Browser support and which JavaScript features are supported by Next.js."
    },
    "content": "## Polyfills\n\nWe inject [widely used polyfills](https://github.com/vercel/next.js/blob/canary/packages/next-polyfill-nomodule/src/index.js), including:\n\n- [**fetch()**](https://developer.mozilla.org/docs/Web/API/Fetch_API) — Replacing: `whatwg-fetch` and `unfetch`.\n- [**URL**](https://developer.mozilla.org/docs/Web/API/URL) — Replacing: the [`url` package (Node.js API)](https://nodejs.org/api/url.html).\n- [**Object.assign()**](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/assign) — Replacing: `object-assign`, `object.assign`, and `core-js/object/assign`.\n\nIf any of your dependencies include these polyfills, they’ll be eliminated automatically from the production build to avoid duplication.\n\nIn addition, to reduce bundle size, Next.js will only load these polyfills for browsers that require them. The majority of the web traffic globally will not download these polyfills."
  },
  {
    "id": "supported-browsers.mdx#2",
    "metadata": {
      "title": "Supported Browsers",
      "description": "Browser support and which JavaScript features are supported by Next.js."
    },
    "content": "### Custom Polyfills\n\nIf your own code or any external npm dependencies require features not supported by your target browsers (such as IE 11), you need to add polyfills yourself.\n\n#### In App Router\n\nTo include polyfills, you can import them into the [`instrumentation-client.js` file](/docs/app/api-reference/file-conventions/instrumentation-client).\n\n```ts filename=\"instrumentation-client.ts\"\nimport './polyfills'\n```\n\n#### In Pages Router\n\nIn this case, you should add a top-level import for the **specific polyfill** you need in your [Custom `<App>`](/docs/pages/building-your-application/routing/custom-app) or the individual component.\n\n```tsx filename=\"pages/_app.tsx\" switcher\nimport './polyfills'\n\nimport type { AppProps } from 'next/app'\n\nexport default function MyApp({ Component, pageProps }: AppProps) {\n  return <Component {...pageProps} />\n}\n```\n\n```jsx filename=\"pages/_app.jsx\" switcher\nimport './polyfills'\n\nexport default function MyApp({ Component, pageProps }) {\n  return <Component {...pageProps} />\n}\n```"
  },
  {
    "id": "supported-browsers.mdx#3",
    "metadata": {
      "title": "Supported Browsers",
      "description": "Browser support and which JavaScript features are supported by Next.js."
    },
    "content": "#### Conditionally loading polyfills\n\nThe best approach is to isolate unsupported features to specific UI sections and conditionally load the polyfill if needed.\n\n```ts filename=\"hooks/analytics.ts\" switcher\nimport { useCallback } from 'react'\n\nexport const useAnalytics = () => {\n  const tracker = useCallback(async (data: unknown) => {\n    if (!('structuredClone' in globalThis)) {\n      import('polyfills/structured-clone').then((mod) => {\n        globalThis.structuredClone = mod.default\n      })\n    }\n\n    /* Do some work that uses structured clone */\n  }, [])\n\n  return tracker\n}\n```\n\n```js filename=\"hooks/analytics.js\" switcher\nimport { useCallback } from 'react'\n\nexport const useAnalytics = () => {\n  const tracker = useCallback(async (data) => {\n    if (!('structuredClone' in globalThis)) {\n      import('polyfills/structured-clone').then((mod) => {\n        globalThis.structuredClone = mod.default\n      })\n    }\n\n    /* Do some work that uses structured clone */\n  }, [])\n\n  return tracker\n}\n```"
  },
  {
    "id": "supported-browsers.mdx#4",
    "metadata": {
      "title": "Supported Browsers",
      "description": "Browser support and which JavaScript features are supported by Next.js."
    },
    "content": "## JavaScript Language Features\n\nNext.js allows you to use the latest JavaScript features out of the box. In addition to [ES6 features](https://github.com/lukehoban/es6features), Next.js also supports:\n\n- [Async/await](https://github.com/tc39/ecmascript-asyncawait) (ES2017)\n- [Object Rest/Spread Properties](https://github.com/tc39/proposal-object-rest-spread) (ES2018)\n- [Dynamic `import()`](https://github.com/tc39/proposal-dynamic-import) (ES2020)\n- [Optional Chaining](https://github.com/tc39/proposal-optional-chaining) (ES2020)\n- [Nullish Coalescing](https://github.com/tc39/proposal-nullish-coalescing) (ES2020)\n- [Class Fields](https://github.com/tc39/proposal-class-fields) and [Static Properties](https://github.com/tc39/proposal-static-class-features) (ES2022)\n- and more!\n\n### TypeScript Features\n\nNext.js has built-in TypeScript support. [Learn more here](/docs/pages/api-reference/config/typescript).\n\n### Customizing Babel Config (Advanced)\n\nYou can customize babel configuration. [Learn more here](/docs/pages/guides/babel)."
  },
  {
    "id": "01-contribution-guide.mdx#0",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "---\ntitle: Docs Contribution Guide\nnav_title: Contribution Guide\ndescription: Learn how to contribute to Next.js Documentation\n---\n\nWelcome to the Next.js Docs Contribution Guide! We're excited to have you here.\n\nThis page provides instructions on how to edit the Next.js documentation. Our goal is to ensure that everyone in the community feels empowered to contribute and improve our docs.\n\n## Why Contribute?\n\nOpen-source work is never done, and neither is documentation. Contributing to docs is a good way for beginners to get involved in open-source and for experienced developers to clarify more complex topics while sharing their knowledge with the community.\n\nBy contributing to the Next.js docs, you're helping us build a more robust learning resource for all developers. Whether you've found a typo, a confusing section, or you've realized that a particular topic is missing, your contributions are welcomed and appreciated."
  },
  {
    "id": "01-contribution-guide.mdx#1",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "## How to Contribute\n\nThe docs content can be found on the [Next.js repo](https://github.com/vercel/next.js/tree/canary/docs). To contribute, you can edit the files directly on GitHub or clone the repo and edit the files locally.\n\n### GitHub Workflow\n\nIf you're new to GitHub, we recommend reading the [GitHub Open Source Guide](https://opensource.guide/how-to-contribute/#opening-a-pull-request) to learn how to fork a repository, create a branch, and submit a pull request.\n\n> **Good to know**: The underlying docs code lives in a private codebase that is synced to the Next.js public repo. This means that you can't preview the docs locally. However, you'll see your changes on [nextjs.org](https://nextjs.org/docs) after merging a pull request.\n\n### Writing MDX\n\nThe docs are written in [MDX](https://mdxjs.com/), a markdown format that supports JSX syntax. This allows us to embed React components in the docs. See the [GitHub Markdown Guide](https://docs.github.com/en/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax) for a quick overview of markdown syntax."
  },
  {
    "id": "01-contribution-guide.mdx#2",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "### VSCode\n\n#### Previewing Changes Locally\n\nVSCode has a built-in markdown previewer that you can use to see your edits locally. To enable the previewer for MDX files, you'll need to add a configuration option to your user settings.\n\nOpen the command palette (`⌘ + ⇧ + P` on Mac or `Ctrl + Shift + P` on Windows) and search from `Preferences: Open User Settings (JSON)`.\n\nThen, add the following line to your `settings.json` file:\n\n```json filename=\"settings.json\"\n{\n  \"files.associations\": {\n    \"*.mdx\": \"markdown\"\n  }\n}\n```\n\nNext, open the command palette again, and search for `Markdown: Preview File` or `Markdown: Open Preview to the Side`. This will open a preview window where you can see your formatted changes.\n\n#### Extensions\n\nWe also recommend the following extensions for VSCode users:\n\n- [MDX](https://marketplace.visualstudio.com/items?itemName=unifiedjs.vscode-mdx): Intellisense and syntax highlighting for MDX.\n- [Prettier](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode): Format MDX files on save."
  },
  {
    "id": "01-contribution-guide.mdx#3",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "### Review Process\n\nOnce you've submitted your contribution, the Next.js or Developer Experience teams will review your changes, provide feedback, and merge the pull request when it's ready.\n\nPlease let us know if you have any questions or need further assistance in your PR's comments. Thank you for contributing to the Next.js docs and being a part of our community!\n\n> **Tip:** Run `pnpm prettier-fix` to run Prettier before submitting your PR."
  },
  {
    "id": "01-contribution-guide.mdx#4",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "## File Structure\n\nThe docs use **file-system routing**. Each folder and files inside [`/docs`](https://github.com/vercel/next.js/tree/canary/docs) represent a route segment. These segments are used to generate the URL paths, navigation, and breadcrumbs.\n\nThe file structure reflects the navigation that you see on the site, and by default, navigation items are sorted alphabetically. However, we can change the order of the items by prepending a two-digit number (`00-`) to the folder or file name.\n\nFor example, in the [functions API Reference](/docs/app/api-reference/functions), the pages are sorted alphabetically because it makes it easier for developers to find a specific function:\n\n```txt\n04-functions\n├── after.mdx\n├── cacheLife.mdx\n├── cacheTag.mdx\n└── ...\n```\n\nBut, in the [routing section](/docs/app), the files are prefixed with a two-digit number, sorted in the order developers should learn these concepts:\n\n```txt\n01-routing\n├── 01-defining-routes.mdx\n├── 02-pages.mdx\n├── 03-layouts-and-templates.mdx\n└── ..."
  },
  {
    "id": "01-contribution-guide.mdx#5",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "```\n\nTo quickly find a page, you can use `⌘ + P` (Mac) or `Ctrl + P` (Windows) to open the search bar on VSCode. Then, type the slug of the page you're looking for. E.g. `defining-routes`\n\n> **Why not use a manifest?**\n>\n> We considered using a manifest file (another popular way to generate the docs navigation), but we found that a manifest would quickly get out of sync with the files. File-system routing forces us to think about the structure of the docs and feels more native to Next.js."
  },
  {
    "id": "01-contribution-guide.mdx#6",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "## Metadata\n\nEach page has a metadata block at the top of the file separated by three dashes.\n\n### Required Fields\n\nThe following fields are **required**:\n\n| Field         | Description                                                                  |\n| ------------- | ---------------------------------------------------------------------------- |\n| `title`       | The page's `<h1>` title, used for SEO and OG Images.                         |\n| `description` | The page's description, used in the `<meta name=\"description\">` tag for SEO. |\n\n```yaml filename=\"required-fields.mdx\"\n---\ntitle: Page Title\ndescription: Page Description\n---\n```\n\nIt's good practice to limit the page title to 2-3 words (e.g. Optimizing Images) and the description to 1-2 sentences (e.g. Learn how to optimize images in Next.js)."
  },
  {
    "id": "01-contribution-guide.mdx#7",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "### Optional Fields\n\nThe following fields are **optional**:\n\n| Field       | Description                                                                                                                                        |\n| ----------- | -------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `nav_title` | Overrides the page's title in the navigation. This is useful when the page's title is too long to fit. If not provided, the `title` field is used. |\n| `source`    | Pulls content into a shared page. See [Shared Pages](#shared-pages).                                                                               |\n| `related`   | A list of related pages at the bottom of the document. These will automatically be turned into cards. See [Related Links](#related-links).         |\n| `version`   | A stage of development. e.g. `experimental`,`legacy`,`unstable`,`RC`                                                                               |"
  },
  {
    "id": "01-contribution-guide.mdx#8",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "```yaml filename=\"optional-fields.mdx\"\n---\nnav_title: Nav Item Title\nsource: app/building-your-application/optimizing/images\nrelated:\n  description: See the image component API reference.\n  links:\n    - app/api-reference/components/image\nversion: experimental\n---\n```"
  },
  {
    "id": "01-contribution-guide.mdx#9",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "## `App` and `Pages` Docs\n\nSince most of the features in the **App Router** and **Pages Router** are completely different, their docs for each are kept in separate sections (`02-app` and `03-pages`). However, there are a few features that are shared between them."
  },
  {
    "id": "01-contribution-guide.mdx#10",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "### Shared Pages\n\nTo avoid content duplication and risk the content becoming out of sync, we use the `source` field to pull content from one page into another. For example, the `<Link>` component behaves _mostly_ the same in **App** and **Pages**. Instead of duplicating the content, we can pull the content from `app/.../link.mdx` into `pages/.../link.mdx`:\n\n```mdx filename=\"app/.../link.mdx\"\n---\ntitle: <Link>\ndescription: API reference for the <Link> component.\n---\n\nThis API reference will help you understand how to use the props\nand configuration options available for the Link Component.\n```\n\n```mdx filename=\"pages/.../link.mdx\"\n---\ntitle: <Link>\ndescription: API reference for the <Link> component.\nsource: app/api-reference/components/link\n---\n\n{/* DO NOT EDIT THIS PAGE. */}\n{/* The content of this page is pulled from the source above. */}\n```\n\nWe can therefore edit the content in one place and have it reflected in both sections."
  },
  {
    "id": "01-contribution-guide.mdx#11",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "### Shared Content\n\nIn shared pages, sometimes there might be content that is **App Router** or **Pages Router** specific. For example, the `<Link>` component has a `shallow` prop that is only available in **Pages** but not in **App**.\n\nTo make sure the content only shows in the correct router, we can wrap content blocks in an `<AppOnly>` or `<PagesOnly>` components:\n\n```mdx filename=\"app/.../link.mdx\"\nThis content is shared between App and Pages.\n\n<PagesOnly>\n\nThis content will only be shown on the Pages docs.\n\n</PagesOnly>\n\nThis content is shared between App and Pages.\n```\n\nYou'll likely use these components for examples and code blocks."
  },
  {
    "id": "01-contribution-guide.mdx#12",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "## Code Blocks\n\nCode blocks should contain a minimum working example that can be copied and pasted. This means that the code should be able to run without any additional configuration.\n\nFor example, if you're showing how to use the `<Link>` component, you should include the `import` statement and the `<Link>` component itself.\n\n```tsx filename=\"app/page.tsx\"\nimport Link from 'next/link'\n\nexport default function Page() {\n  return <Link href=\"/about\">About</Link>\n}\n```\n\nAlways run examples locally before committing them. This will ensure that the code is up-to-date and working."
  },
  {
    "id": "01-contribution-guide.mdx#13",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "### Language and Filename\n\nCode blocks should have a header that includes the language and the `filename`. Add a `filename` prop to render a special Terminal icon that helps orientate users where to input the command. For example:\n\n````mdx filename=\"code-example.mdx\"\n```bash filename=\"Terminal\"\nnpx create-next-app\n```\n````\n\nMost examples in the docs are written in `tsx` and `jsx`, and a few in `bash`. However, you can use any supported language, here's the [full list](https://github.com/shikijs/shiki/blob/main/docs/languages.md#all-languages).\n\nWhen writing JavaScript code blocks, we use the following language and extension combinations.\n\n|                                | Language | Extension |\n| ------------------------------ | -------- | --------- |\n| JavaScript files with JSX code | ```jsx   | .js       |\n| JavaScript files without JSX   | ```js    | .js       |\n| TypeScript files with JSX      | ```tsx   | .tsx      |\n| TypeScript files without JSX   | ```ts    | .ts       |\n\n> **Good to know**:\n>\n> - Make sure to use **`.js`** extension for JavaScript files with **JSX** code.\n> - For example, ```jsx filename=\"app/layout.js\""
  },
  {
    "id": "01-contribution-guide.mdx#14",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "### TS and JS Switcher\n\nAdd a language switcher to toggle between TypeScript and JavaScript. Code blocks should be TypeScript first with a JavaScript version to accommodate users.\n\nCurrently, we write TS and JS examples one after the other, and link them with `switcher` prop:\n\n````mdx filename=\"code-example.mdx\"\n```tsx filename=\"app/page.tsx\" switcher\n\n```\n\n```jsx filename=\"app/page.js\" switcher\n\n```\n````\n\n> **Good to know**: We plan to automatically compile TypeScript snippets to JavaScript in the future. In the meantime, you can use [transform.tools](https://transform.tools/typescript-to-javascript)."
  },
  {
    "id": "01-contribution-guide.mdx#15",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "### Line Highlighting\n\nCode lines can be highlighted. This is useful when you want to draw attention to a specific part of the code. You can highlight lines by passing a number to the `highlight` prop.\n\n**Single Line:** `highlight={1}`\n\n```tsx filename=\"app/page.tsx\" {1}\nimport Link from 'next/link'\n\nexport default function Page() {\n  return <Link href=\"/about\">About</Link>\n}\n```\n\n**Multiple Lines:** `highlight={1,3}`\n\n```tsx filename=\"app/page.tsx\" highlight={1,3}\nimport Link from 'next/link'\n\nexport default function Page() {\n  return <Link href=\"/about\">About</Link>\n}\n```\n\n**Range of Lines:** `highlight={1-5}`\n\n```tsx filename=\"app/page.tsx\" highlight={1-5}\nimport Link from 'next/link'\n\nexport default function Page() {\n  return <Link href=\"/about\">About</Link>\n}\n```"
  },
  {
    "id": "01-contribution-guide.mdx#16",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "## Icons\n\nThe following icons are available for use in the docs:\n\n```mdx filename=\"mdx-icon.mdx\"\n<Check size={18} />\n<Cross size={18} />\n```\n\n**Output:**\n\n<Check size={18} />\n<Cross size={18} />\n\nWe do not use emojis in the docs.\n\n## Notes\n\nFor information that is important but not critical, use notes. Notes are a good way to add information without distracting the user from the main content.\n\n```mdx filename=\"notes.mdx\"\n> **Good to know**: This is a single line note.\n\n> **Good to know**:\n>\n> - We also use this format for multi-line notes.\n> - There are sometimes multiple items worth knowing or keeping in mind.\n```\n\n**Output:**\n\n> **Good to know**: This is a single line note.\n\n> **Good to know**:\n>\n> - We also use this format for multi-line notes.\n> - There are sometimes multiple items worth knowing or keeping in mind."
  },
  {
    "id": "01-contribution-guide.mdx#17",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "## Related Links\n\nRelated Links guide the user's learning journey by adding links to logical next steps.\n\n- Links will be displayed in cards under the main content of the page.\n- Links will be automatically generated for pages that have child pages.\n\nCreate related links using the `related` field in the page's metadata.\n\n```yaml filename=\"example.mdx\"\n---\nrelated:\n  description: Learn how to quickly get started with your first application.\n  links:\n    - app/building-your-application/routing/defining-routes\n    - app/building-your-application/data-fetching\n    - app/api-reference/file-conventions/page\n---\n```"
  },
  {
    "id": "01-contribution-guide.mdx#18",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "### Nested Fields\n\n| Field         | Required? | Description                                                                                                                                               |\n| ------------- | --------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| `title`       | Optional  | The title of the card list. Defaults to **Next Steps**.                                                                                                   |\n| `description` | Optional  | The description of the card list.                                                                                                                         |\n| `links`       | Required  | A list of links to other doc pages. Each list item should be a relative URL path (without a leading slash) e.g. `app/api-reference/file-conventions/page` |"
  },
  {
    "id": "01-contribution-guide.mdx#19",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "## Diagrams\n\nDiagrams are a great way to explain complex concepts. We use [Figma](https://www.figma.com/) to create diagrams, following Vercel's design guide.\n\nThe diagrams currently live in the `/public` folder in our private Next.js site. If you'd like to update or add a diagram, please open a [GitHub issue](https://github.com/vercel/next.js/issues/new?assignees=&labels=template%3A+documentation&projects=&template=4.docs_request.yml&title=Docs%3A+) with your ideas.\n\n## Custom Components and HTML\n\nThese are the React Components available for the docs: `<Image />` (next/image), `<PagesOnly />`, `<AppOnly />`, `<Cross />`, and `<Check />`. We do not allow raw HTML in the docs besides the `<details>` tag.\n\nIf you have ideas for new components, please open a [GitHub issue](https://github.com/vercel/next.js/issues/new/choose)."
  },
  {
    "id": "01-contribution-guide.mdx#20",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "## Style Guide\n\nThis section contains guidelines for writing docs for those who are new to technical writing.\n\n### Page Templates\n\nWhile we don't have a strict template for pages, there are page sections you'll see repeated across the docs:\n\n- **Overview:** The first paragraph of a page should tell the user what the feature is and what it's used for. Followed by a minimum working example or its API reference.\n- **Convention:** If the feature has a convention, it should be explained here.\n- **Examples**: Show how the feature can be used with different use cases.\n- **API Tables**: API Pages should have an overview table at the of the page with jump-to-section links (when possible).\n- **Next Steps (Related Links)**: Add links to related pages to guide the user's learning journey.\n\nFeel free to add these sections as needed."
  },
  {
    "id": "01-contribution-guide.mdx#21",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "### Page Types\n\nDocs pages are also split into two categories: Conceptual and Reference.\n\n- **Conceptual** pages are used to explain a concept or feature. They are usually longer and contain more information than reference pages. In the Next.js docs, conceptual pages are found in the **Building Your Application** section.\n- **Reference** pages are used to explain a specific API. They are usually shorter and more focused. In the Next.js docs, reference pages are found in the **API Reference** section.\n\n> **Good to know**: Depending on the page you're contributing to, you may need to follow a different voice and style. For example, conceptual pages are more instructional and use the word _you_ to address the user. Reference pages are more technical, they use more imperative words like \"create, update, accept\" and tend to omit the word _you_."
  },
  {
    "id": "01-contribution-guide.mdx#22",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "### Voice\n\nHere are some guidelines to maintain a consistent style and voice across the docs:"
  },
  {
    "id": "01-contribution-guide.mdx#23",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "- Write clear, concise sentences. Avoid tangents.\n  - If you find yourself using a lot of commas, consider breaking the sentence into multiple sentences or use a list.\n  - Swap out complex words for simpler ones. For example, _use_ instead of _utilize_.\n- Be mindful with the word _this_. It can be ambiguous and confusing, don't be afraid to repeat the subject of the sentence if unclear.\n  - For example, _Next.js uses React_ instead of _Next.js uses this_.\n- Use an active voice instead of passive. An active sentence is easier to read.\n  - For example, _Next.js uses React_ instead of _React is used by Next.js_. If you find yourself using words like _was_ and _by_ you may be using a passive voice.\n- Avoid using words like _easy_, _quick_, _simple_, _just_, etc. This is subjective and can be discouraging to users.\n- Avoid negative words like _don't_, _can't_, _won't_, etc. This can be discouraging to readers.\n  - For example, _\"You can use the `Link` component to create links between pages\"_ instead of _\"Don't use the `<a>` tag to create links between pages\"_.\n- Write in second person (you/your). This is more personal and engaging."
  },
  {
    "id": "01-contribution-guide.mdx#24",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "- Write in second person (you/your). This is more personal and engaging.\n- Use gender-neutral language. Use _developers_, _users_, or _readers_, when referring to the audience.\n- If adding code examples, ensure they are properly formatted and working."
  },
  {
    "id": "01-contribution-guide.mdx#25",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "While these guidelines are not exhaustive, they should help you get started. If you'd like to dive deeper into technical writing, check out the [Google Technical Writing Course](https://developers.google.com/tech-writing/overview)."
  },
  {
    "id": "01-contribution-guide.mdx#26",
    "metadata": {
      "title": "Docs Contribution Guide",
      "description": "Learn how to contribute to Next.js Documentation"
    },
    "content": "---\n\nThank you for contributing to the docs and being part of the Next.js community!\n\n{/* To do: Latest Contributors Component */}"
  },
  {
    "id": "02-rspack.mdx#0",
    "metadata": {
      "title": "Rspack Integration",
      "description": "Use the `next-rspack` plugin to bundle your Next.js with Rspack."
    },
    "content": "---\ntitle: Rspack Integration\nnav_title: Rspack\ndescription: Use the `next-rspack` plugin to bundle your Next.js with Rspack.\nversion: experimental\n---\n\nThe Rspack team has created a community plugin for Next.js, which is part of a [partnering effort](https://rspack.rs/blog/rspack-next-partner) with the Rspack team.\n\nThis plugin is currently experimental. Please use this [discussion thread](https://github.com/vercel/next.js/discussions/77800) to give feedback on any issues you encounter.\n\nLearn more on the [Rspack docs](https://rspack.rs/guide/tech/next) and try out [this example](https://github.com/vercel/next.js/tree/canary/examples/with-rspack)."
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Next.js Community",
      "description": "Get involved in the Next.js community."
    },
    "content": "---\ntitle: Next.js Community\nnav_title: Community\ndescription: Get involved in the Next.js community.\n---\n\nWith over 5 million weekly downloads, Next.js has a large and active community of developers across the world. Here's how you can get involved in our community:\n\n## Contributing\n\nThere are a couple of ways you can contribute to the development of Next.js:\n\n- [Documentation](/docs/community/contribution-guide): Suggest improvements or even write new sections to help our users understand how to use Next.js.\n- [Examples](https://github.com/vercel/next.js/tree/canary/contributing/examples): Help developers integrate Next.js with other tools and services by creating a new example or improving an existing one.\n- [Codebase](https://github.com/vercel/next.js/tree/canary/contributing/core): Learn more about the underlying architecture, contribute to bug fixes, errors, and suggest new features.\n\n## Discussions\n\nIf you have a question about Next.js, or want to help others, you're always welcome to join the conversation:\n\n- [GitHub Discussions](https://github.com/vercel/next.js/discussions)\n- [Discord](https://discord.com/invite/bUG2bvbtHy)\n- [Reddit](https://www.reddit.com/r/nextjs)"
  },
  {
    "id": "index.mdx#1",
    "metadata": {
      "title": "Next.js Community",
      "description": "Get involved in the Next.js community."
    },
    "content": "## Social Media\n\nFollow Next.js on [Twitter](https://x.com/nextjs) for the latest updates, and subscribe to the [Vercel YouTube channel](https://www.youtube.com/@VercelHQ) for Next.js videos.\n\n## Code of Conduct\n\nWe believe in creating an inclusive, welcoming community. As such, we ask all members to adhere to our [Code of Conduct](https://github.com/vercel/next.js/blob/canary/CODE_OF_CONDUCT.md). This document outlines our expectations for participant behavior. We invite you to read it and help us maintain a safe and respectful environment."
  },
  {
    "id": "index.mdx#0",
    "metadata": {
      "title": "Next.js Docs",
      "description": "Welcome to the Next.js Documentation."
    },
    "content": "---\ntitle: Next.js Docs\ndescription: Welcome to the Next.js Documentation.\nrelated:\n  title: Next Steps\n  description: Create your first application and learn the core Next.js features.\n  links:\n    - app/getting-started\n---\n\nWelcome to the Next.js documentation!\n\n## What is Next.js?\n\nNext.js is a React framework for building full-stack web applications. You use React Components to build user interfaces, and Next.js for additional features and optimizations.\n\nIt also automatically configures lower-level tools like bundlers and compilers. You can instead focus on building your product and shipping quickly.\n\nWhether you're an individual developer or part of a larger team, Next.js can help you build interactive, dynamic, and fast React applications."
  },
  {
    "id": "index.mdx#1",
    "metadata": {
      "title": "Next.js Docs",
      "description": "Welcome to the Next.js Documentation."
    },
    "content": "## How to use the docs\n\nThe docs are organized into 3 sections:\n\n- [Getting Started](/docs/app/getting-started): Step-by-step tutorials to help you create a new application and learn the core Next.js features.\n- [Guides](/docs/app/guides): Tutorials on specific use cases, choose what's relevant to you.\n- [API Reference](/docs/app/api-reference): Detailed technical reference for every feature.\n\nUse the sidebar to navigate through the sections, or search (`Ctrl+K` or `Cmd+K`) to quickly find a page."
  },
  {
    "id": "index.mdx#2",
    "metadata": {
      "title": "Next.js Docs",
      "description": "Welcome to the Next.js Documentation."
    },
    "content": "## App Router and Pages Router\n\nNext.js has two different routers:\n\n- **App Router**: The newer router that supports new React features like Server Components.\n- **Pages Router**: The original router, still supported and being improved.\n\nAt the top of the sidebar, you'll notice a dropdown menu that allows you to switch between the [App Router](/docs/app) and the [Pages Router](/docs/pages) docs.\n\n### React version handling\n\nThe App Router and Pages Router handle React versions differently:\n\n- **App Router**: Uses [React canary releases](https://react.dev/blog/2023/05/03/react-canaries) built-in, which include all the stable React 19 changes, as well as newer features being validated in frameworks, prior to a new React release.\n\n- **Pages Router**: Uses the React version installed in your project's `package.json`.\n\nThis approach ensures new React features work reliably in the App Router while maintaining backwards compatibility for existing Pages Router applications."
  },
  {
    "id": "index.mdx#3",
    "metadata": {
      "title": "Next.js Docs",
      "description": "Welcome to the Next.js Documentation."
    },
    "content": "## Pre-requisite knowledge\n\nOur documentation assumes some familiarity with web development. Before getting started, it'll help if you're comfortable with:\n\n- HTML\n- CSS\n- JavaScript\n- React\n\nIf you're new to React or need a refresher, we recommend starting with our [React Foundations course](/learn/react-foundations), and the [Next.js Foundations course](/learn/dashboard-app) that has you building an application as you learn.\n\n## Accessibility\n\nFor the best experience when using a screen reader, we recommend using Firefox and NVDA, or Safari and VoiceOver.\n\n## Join our Community\n\nIf you have questions about anything related to Next.js, you're always welcome to ask our community on [GitHub Discussions](https://github.com/vercel/next.js/discussions), [Discord](https://discord.com/invite/bUG2bvbtHy), [X (Twitter)](https://x.com/nextjs), and [Reddit](https://www.reddit.com/r/nextjs)."
  }
]